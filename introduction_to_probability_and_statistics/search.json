[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Introduction to Probability and Statistics for Engineers and Scientists（中文版）",
    "section": "",
    "text": "欢迎阅读\nIntroduction to Probability and Statistics for Engineers and Scientists (Sixth Edition) 是一本为工程师和科学家而作的有关概率论和数理统计方面的书籍。\n本书的第六版继续展示了如何应用概率论来洞察现实生活中的统计问题。与之前的版本一样，本书精心设计的概率论相关的内容将真实现象的概率模型和其统计程序关联起来，以便读者能够更直观的理解实践工程师和科学家最常用的统计程序和策略。\n本书是为工程学、计算机科学、数学、统计学和自然科学专业的学生编写的统计学和概率统计入门课程。当然，科学家、工程师和其他专业人员也可以从本书中找到灵感。\n关于书中的各章最后的 习题 部分，可以参见：www.chegg.com/homework-help。",
    "crumbs": [
      "欢迎阅读"
    ]
  },
  {
    "objectID": "index.html#翻译进度",
    "href": "index.html#翻译进度",
    "title": "Introduction to Probability and Statistics for Engineers and Scientists（中文版）",
    "section": "翻译进度",
    "text": "翻译进度\n11/16....-.......----",
    "crumbs": [
      "欢迎阅读"
    ]
  },
  {
    "objectID": "index.html#版权声明",
    "href": "index.html#版权声明",
    "title": "Introduction to Probability and Statistics for Engineers and Scientists（中文版）",
    "section": "版权声明",
    "text": "版权声明\n本翻译稿是笔者在阅读原书过程中的笔记，采用“保持署名—非商用”创意共享 4.0 许可证。只要保持署名和非商用，您可以自由地阅读、分享本书。\n您可以：\n\n下载、保存以及打印本翻译稿\n网络链接、转载本翻译稿的部分或者全部内容，但是必须在明显处提供读者访问本翻译稿发布网站的链接\n\n您不可以：\n\n以任何形式出售本翻译稿的电子版或者打印版\n擅自印刷、出版本翻译稿\n以纸媒出版为目的，改写、改编以及摘抄本翻译稿的内容",
    "crumbs": [
      "欢迎阅读"
    ]
  },
  {
    "objectID": "preface_17.html",
    "href": "preface_17.html",
    "title": "译者序",
    "section": "",
    "text": "翻译稿中的样式惯例\n最近的几年从事评估评测的工作比较多，随着对评测工作的不断深入，对评测的认知也发生了非常大的变化。我们之前总认为评测无非就是开发一套工具或者平台，再者就是做一些没有什么技术含量的评估，然后得出一个结论，仅此而已。\n我在评测上的大部分工作都是数据分析：分析结果的差异性、合理性、正确性，分析结果的可解释性（例如为什么不同的人对同一个视频的画质给出了截然不同的打分），分析结果的可重复性……\n得出一个评测结论非常容易，但是如何才能让评测像论文中的实验一样做到可重复执行确实是一件非常难的事情。招募用户开展评测也不是一件难事，关键是如何才能有效的从结果数据中的出有效的结论。\n标准如何执行，变量如何控制、样本如何选择、结果如何解释等因素都是我们需要考虑的事情，而这些也才是真正隐藏于评测背后的最惊艳的技术。\n因此，在经过这么多年的评测工作的实践积累，我总结出有价值的评测需要具备的三大能力：\n对于工程师而言，业务认知能力和工程技术能力相对较为容易。我们只要随着业务共同成长，自己的工程能力和业务认知，肯定会取得非常大的进步和成就。但是，强大的数据分析能力不见得我们会随业务的发展而成长起来，这需要我们具备数据分析的基础知识（例如概率论和梳理统计），还需要具备对应工具的熟练应用能力，更需要我们在实践中不断地将理论、工具、数据加以闭环整合以不断迭代、提升自己的数据分析能力。\n对于数据分析而言，工作之后才发现，大学时期老师教授的相关基础内容在多年之后，也已经全部归还给了老师。脑海里仅存的知识也就只剩下了正态分布的基本概念和抛硬币计算各种概率等的一些基本知识。置信区间、\\(p\\) 值、大数定律等等概念在大脑中也就只剩下了一个名字而已，至于这个名字背后所蕴含的内容也被时间稀释的荡然无存。\n为了能够获得更为准确的评测结果，在工作中零零点点的、不断地又恶补了概率统计的相关知识。例如，在音频评测中，在 ABX 测试方法 的研究过程中才又学习了置信区间、二项分布、\\(p\\) 值分析、假设检验等内容。\n总想着更系统的学习一下概率论和梳理统计的相关知识，但是苦于没有找到合适的教程，所以迟迟没有启动自己的学习计划。直到今年无意中发现了 Sheldon M. Ross 教授的这本书（当时书的名称吸引了我，我更喜欢理论和实践相结合的书籍，例如 in Action 系列书籍），才下定决心要启动自己对统计学的系统学习计划。\n就我的经验而言，如果想真正的领会某项技术，最好的方式就先读懂英文原本内容、然后用中文复述原书内容、最后把内容讲给别人听。因此，在学习的过程中，同步启动了这本书的翻译，主要的目的在于自己可以通过翻译过程不断优化自己的知识体系。\n与之前翻译 数字视频概念，方法和测量指标 和 从单体到微服务：如何迁移我们的单体架构到微服务 的不同之处在于，现在有类似 文心一言 和 ChatGPT 等生成式大模型工具的帮助，我无疑加速了我的学习过程。\n本书的示例主要是基于 R，很高兴本书开启了我的 R 学习之旅，在整个的学习过程中真的发现利用 文心一言、KIMI 等生成式大模型工具真的可以事半功倍。\n翻译版本中的大部分图表均是由 R 生成，所以该翻译版本也可以视为 R 的实践入门书籍。您可以直接点击 \\(\\blacktriangleright 代码\\) 展开详细的代码，并复制以生成如下图所示的直方图。\n在翻译稿中，遵循以下的排版约定：",
    "crumbs": [
      "译者序"
    ]
  },
  {
    "objectID": "preface_17.html#翻译稿中的样式惯例",
    "href": "preface_17.html#翻译稿中的样式惯例",
    "title": "译者序",
    "section": "",
    "text": "斜体：表示英文术语、URL、电子邮件地址、文件名、文件扩展名。\n固定宽度：用于程序列表、段落中引用程序元素，如变量或函数名称、数据库、数据类型、环境变量、语句和关键字。\n粗体：突出显示重要文本和中文术语。\n\n\n\n\n\n\n笔记\n\n\n\n该部分内容是原书中没有的内容，是笔者在阅读过程中补充的相关资料和笔者的个人理解。",
    "crumbs": [
      "译者序"
    ]
  },
  {
    "objectID": "preface_17.html#其它",
    "href": "preface_17.html#其它",
    "title": "译者序",
    "section": "其它",
    "text": "其它\n\n抛骰子、抛硬币是概率论中经常用到的例子，对于类似的场景，若无特殊说明，我们均指的是均匀的骰子或硬币（可以得到的任何结果都是等概率的）。\n凡是标题中带有 \\(^*\\) 的章节都属于选修章节，您可以根据自己的需要来自主选择是否学习这些章节的内容。",
    "crumbs": [
      "译者序"
    ]
  },
  {
    "objectID": "preface.html",
    "href": "preface.html",
    "title": "序言",
    "section": "",
    "text": "本书的组织结构和内容范围\n本书的第六版继续展示了如何应用概率论来洞察现实生活中的统计问题。与之前的版本一样，本书精心设计的概率论相关的内容将真实现象的概率模型和其统计程序关联起来，以便读者能够更直观的理解实践工程师和科学家最常用的统计程序和策略。\n本书是为工程学、计算机科学、数学、统计学和自然科学专业的学生编写的统计学和概率统计入门课程。因此，我们假定读者具备一定的微积分知识。\n1  统计学简介 对 统计学 进行了简要介绍，介绍了 统计学 的两大分支：描述统计、推论统计，然后介绍了 统计学 的一小段历史和为当今统计学的发展奠定基础的先驱人物。\n2  描述统计 的主要内容是 描述统计。本章介绍了描述数据集的图表，以及用于总结数据集某些关键属性的统计量（quantities）。\n3  概率论基础 的内容主要是概率实验，事件概率的基本概念，概率的相关公理。我们必须了解数据的来源，以从数据中得出结论。例如，我们通常假设，数据是从某个群体中抽取的 “随机样本”。为了准确理解这样的假设意味着什么，也为了准确理解将样本数据的属性与总体的属性联系起来会产生什么结果，我们有必要了解一些概率知识。\n4  随机变量和期望 将继续研究概率，本章会进一步介绍随机变量（random variables）和期望（expectation）等重要概念。\n5  特殊的随机变量 会介绍应用中经常出现的一些特殊类型的随机变量，包括：二项分布、泊松分布、超几何分布、正态分布、均匀分布、伽马分布、卡方分布、\\(t\\) 分布和 \\(F\\) 分布……\n6  抽样分布 会研究样本均值（mean）和样本方差（variance）等抽样统计数据的概率分布。本章将介绍如何使用显著概率理论结果（中心极限定理）来近似样本均值的概率分布。此外，在某些重要的特殊场景下，当抽样的数据来自符合正态分布的总体时，本章也给出了样本均值和样本方差的联合概率分布。\n7  参数估计 介绍了如何使用数据来估计感兴趣的参数。例如，科学家可能想要确定受到酸雨影响的中西部湖泊的比例。本章会研究两种参数估计方法。第一种估计方法用一个数字来估计感兴趣的统计量（例如，中西部湖泊中有 47% 的湖泊受到了酸雨的影响）。第二种则是以一个数值区间的形式来估计总体参数的范围（例如，中西部湖泊中有 45% ~ 49% 的湖泊受到了酸雨的影响）。第二种估计方法还告诉我们对其估计结果的 “置信水平”（level of confidence）。例如，尽管我们并不能肯定 47% 就是受影响的湖泊的确切比例，但我们很可能有 95% 的信心认为实际受影响的湖泊比例在 45% ~ 49% 之间。\n8  假设检验 介绍了统计假设检验这一重要内容，该部分关注的是利用数据来检验特定假设的合理性。例如，假设检验可能会拒绝 “中西部受酸雨影响的湖泊少于 44%” 这样的假设。本章引入了 \\(p\\) 值的概念来衡量在观察到数据后假设的合理性程度。本章还会介绍关于一个和两个正态总体参数的各种假设检验方法，以及关于伯努利分布和泊松分布的参数的假设检验。\n9  回归 会涉及 回归（regression） 这个重要的课题。简单线性回归（包括平均数回归、残差分析、加权最小二乘法等）和多元线性回归的内容都将在本章中进行介绍。\n10  方差分析 介绍了方差分析。本章具体介绍了一维方差分析（one-way analysis of variance）和二维方差分析（two-way analysis of variance）。\n11  拟合优度检验和分类数据分析 关注的是拟合优度检验（goodness of fit tests）。拟合优度检验可以用来检验所提出的模型是否与观察到的数据一致。在本章中，我们介绍了经典的卡方拟合优度检验（Chi-squared goodness of fit test），并将其应用于检验列联表（contingency tables）中变量的独立性。本章的最后一节介绍了可用于检验数据是否来自特定连续概率分布的 Kolmogorov-Smirnov 检验方法。\n12  非参数假设检验 涉及到非参数假设检验，当我们无法假设潜在的数据分布具有某种特定的参数形式（如正态分布）时，可以使用非参数假设检验。\n13  质量控制 主要考虑质量控制（quality control）这一主题。质量控制是制造和生产过程中的一项关键统计技术。本章会介绍多种控制图，不仅包括 Shewhart 控制图，还包括基于 移动平均（Moving Averages） 和 累积和（Cumulative Sums）的更复杂的控制图。\n14  Life testing 介绍了与寿命测试相关的问题。在寿命测试中，起关键作用的不是正态分布，而是指数分布。\n15  Simulation, bootstrap statistical methods, and permutation tests 介绍了 bootstrap 统计方法和排列检验（permutation tests）的统计推断技术。本章首先介绍了如何通过模拟（simulation）获得概率，然后介绍了如何在这些统计推断方法中使用模拟。\n16  Machine learning and big data 是本书第 6 版中新增的内容，本章介绍了机器学习和大数据的相关技术。当拥有较大的数据量时，我们可以使用机器学习和大数据技术在无需假设任何特定概率模型下来估计概率。例如，我们想要估计一个由向量 \\((x_1, ..., x_n)\\) 表示的实验成功的概率。当该特征向量是对自然属性（qualitative in nature）（例如，动物的分类）的描述时，可以使用朴素贝叶斯方法和最近邻规则等技术。当特征向量的是量化数据（quantitative）（例如身高、体重）时，我们还研究了逻辑回归模型。\n本书的第六版不但新增了 16  Machine learning and big data ，最重要的变化是引入了统计软件 R。我们会在书中介绍 R 的使用方法，因此没有 R 使用经验的读者也无需担心。除此之外，我们还新增了 2.7 洛伦兹曲线和基尼系数 来讨论 洛伦兹曲线（Lorenz Curves）和 基尼指数（Gini Index）。第六版还增加了很多新的示例和问题。为了进一步提高本书文本表述和论证的清晰度，该版本对书中很多内容作了些许调整。",
    "crumbs": [
      "序言"
    ]
  },
  {
    "objectID": "preface.html#补充材料",
    "href": "preface.html#补充材料",
    "title": "序言",
    "section": "补充材料",
    "text": "补充材料\n可以从 https://educate.elsevier.com/book/details/9780128243466 处获取教师解答手册。",
    "crumbs": [
      "序言"
    ]
  },
  {
    "objectID": "preface.html#致谢",
    "href": "preface.html#致谢",
    "title": "序言",
    "section": "致谢",
    "text": "致谢\n感谢对第六版的内容提出有益意见的人们：\n\nGideon Weiss, University of Haifa\nN. Balakrishnan, McMaster University\nMark Brown, Columbia University\nRohitha Goonatilake, Texas A and M University\nSteve From, University of Nebraska at Omaha\nSubhash Kochar, Portland State University\nSumona Mondal, Mathematics, Clarkson University\nKamel Belbahri, Mathematics and Statistics, Université de Montréal\nAnil Aswani, Industrial Engineering and Operations Research, University of California, Berkeley\n\n对于希望保持匿名的所有审稿人，也在此表示感谢。",
    "crumbs": [
      "序言"
    ]
  },
  {
    "objectID": "chapter_1/1.html",
    "href": "chapter_1/1.html",
    "title": "1  统计学简介",
    "section": "",
    "text": "1.1 引言\n如今，人们普遍接受了这样的事实：为了了解某个事物，我们必须首先收集和该事物相关的数据。统计学（Statistics）是一门从数据中学习的艺术，它包括数据的收集，也包括通过后续的数据描述和数据分析来获得结论。",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>统计学简介</span>"
    ]
  },
  {
    "objectID": "chapter_1/1.html#sec-1_2",
    "href": "chapter_1/1.html#sec-1_2",
    "title": "1  统计学简介",
    "section": "1.2 数据收集和描述统计",
    "text": "1.2 数据收集和描述统计\n\n\n\n\n\n\n描述统计\n\n\n\n描述统计（descriptive statistics）是统计学的一个重要分支，另一个重要的分支是 小节 1.3 中介绍的 推断统计（Inferential statistics）。\n描述统计 主要关注于数据的收集、处理、汇总、图表描述、概括与分析，包括统计数据的收集方法、数据的加工处理方法、数据的显示方法、数据的分布特征与分析方法等。描述统计 的目的是将数据转化为有意义的信息，并帮助我们理解数据的特征和规律。常见的 描述统计 包括直方图、平均数、中位数、众数等。\n推断统计 主要关注如何利用样本数据来推断总体特征，包括参数估计（例如平均数、标准差的估计）和假设检验两种类型。推断统计 允许我们根据部分数据来推断总体特征，从而提高研究的效率和准确性。常用的 推断统计 包括置信区间、t 检验、方差分析等。\n描述统计 是统计学的基础，其主要处理样本数据；而 推断统计 则是描述统计的升华，其利用样本数据来推测总体特征。\n\n\n有时候，我们会从一个给定的数据集合为起点来启动统计分析：例如，政府会定期收集和公布相关年份的降水量、地震发生次数、失业率、国内生产总值以及通货膨胀率。我们可以使用 统计学 来描述、总结并分析如上的数据。\n在有些场景下，我们可能还没有可用于分析的数据，此时需要利用统计理论来设计合适的实验以生成分析所需的数据。实验方案的选择取决于我们如何使用这些数据。\n\n\n教学方式的实验\n\n对于计算机编程课而言，假设一名老师想要确定哪种教学方法对初学者更好。\n\n为了研究这个问题，该老师可以把学生分成两组，然后针对不同组的学生采用不同的教学方法。在课程结束时，对学生的学习效果进行测试，并比较不同分组的学生成绩。如果其中一组学生的成绩明显高于另一组，那么我们假定该组使用的教学方法更优越的想法就更为合理。\n\n然而，为了从数据中得出有效的结论，对学生进行分组的方式至关重要，分组时应确保两组学生的编程资质是一致的。这一点，我们我们需要特别关注。我们不应该将男生分为一组，而把女生分为另一组。如果按照性别分组，即使女生组的测试成绩明显高于男生组，我们也无法确定成绩差异是源自教学方法的不同，还是因为女性在学习编程技能方面可能更具天赋。为了避免这个陷阱，我们可以 随机 把学生分成两组。“随机” 这个词意味着分组的方式应确保每个学生有同等的机会被分配到不同的组。\n在实验的最后，我们应该对数据进行描述（例如，两个分组的测试成绩）。此外，我们还应呈现数据的汇总指标（例如，不同分组的平均成绩）。在 统计学 中，涉及数据描述和数据汇总的部分称之为 描述统计。",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>统计学简介</span>"
    ]
  },
  {
    "objectID": "chapter_1/1.html#sec-1_3",
    "href": "chapter_1/1.html#sec-1_3",
    "title": "1  统计学简介",
    "section": "1.3 推断统计和概率模型",
    "text": "1.3 推断统计和概率模型\n当我们完成了 小节 1.2 中所述的、教学方式的实验，并对实验数据进行了描述和汇总后，我们希望可以得出哪种教学方法更好的结论。在 统计学 中，涉及到得出结论的这一部分称之为 推断统计。\n为了能够从数据中得出结论，我们必须考虑偶然事件发生的可能性。例如，对于 小节 1.2 中提到的教学方式的实验，假设第一组学生的平均成绩稍高于第二组，我们能断定成绩的增加是因为教学方法吗？或者是否存在这种可能：教学方法并不是成绩增加的原因，第一组学生的成绩较高只是偶然发生的？例如，抛 10 次硬币，其中有 7 次正面朝上，这并不意味着在以后的实验中，这枚硬币正面朝上的概率会高于反面朝上。实际上，这枚硬币可能只是一枚普通的硬币，只是碰巧在10 次抛掷中出现了 7 次正面朝上。（另一方面，如果在 50 次抛掷中出现了 47 次正面朝上，那么我们就可以非常确定这不是一枚普通硬币。）\n为了从数据中得到正确的结论，我们通常会对可以获取到的、不同数据的可能性（或概率）做某些假设。这些假设的总和称之为数据的 概率模型。\n有时，数据的性质（nature）暗含了我们所假设的 概率模型 的形式。例如，假设一名工程师想要了解使用新的生产方式生产的计算机芯片的缺陷率。该工程师可能会从新生产方式生产的芯片中选择一组芯片，然后可以得到所抽取的这组芯片中的缺陷芯片数量。只要这组芯片是 “随机” 选择而产生的，那么假设这组芯片中的每一个芯片存在缺陷的概率为 \\(p\\) 就是合理的，其中 \\(p\\) 是使用新方法生产的所有芯片的缺陷率。因为我们无法抽查所有芯片以获得 \\(p\\)，因此 \\(p\\) 是未知的，我们可以用“随机”抽取的芯片所得到的数据来推断 \\(p\\)。\n在其他情况下，概率模型 在给定数据集上的表现并不明显。然而，对数据的仔细描述和呈现有时能帮助我们推断出合理的 概率模型，然后我们可以使用其它的数据来验证推断的 概率模型。\n统计推断 的基础是通过构建 概率模型 来描述数据，因此需要具备一定的概率论基础才能理解 统计推断。换句话说，统计推断 源自这样的假设：我们可以用概率来描述研究对象，然后我们可以基于该假设通过数据来推断这些概率，从而得出结论。",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>统计学简介</span>"
    ]
  },
  {
    "objectID": "chapter_1/1.html#sec-1_4",
    "href": "chapter_1/1.html#sec-1_4",
    "title": "1  统计学简介",
    "section": "1.4 总体与样本",
    "text": "1.4 总体与样本\n在 统计学 中，我们对获取研究对象中的所有个体的集合的信息感兴趣。研究对象中所有个体的集合我们称之为 总体。总体 的规模往往太大，所以我们无法检查 总体 中的每个成员。例如，我们可能有某个州的所有居民数据，或者某个制造商去年生产的所有电视机数据，亦或者某个社区的所有家庭数据。在这些情况下，我们试图通过选择总体元素的一个子分组并对该子分组进行检查来了解 总体，这个子分组我们称其为 样本。\n如果 样本 需要提供有关 总体 的信息，那么，在某种意义上而言，样本 必须具有代表性。\n\n\n市民的平均年龄\n\n假设我们对某市居民的年龄分布感兴趣，并且我们获得了进入城镇图书馆（town library）的前 100 个市民的年龄。如果这 100 人的平均年龄为 46.2 岁，我们是否可以依次为依据得出结论：该市居民的平均年龄为 46.2 岁？\n\n可能并非如此。当然，我们可以认为，在这种情况下选择的 样本 可能并不能代表 总体，因为通常而言，年轻学生和老年市民去图书馆的可能性要大于上班族。\n\n\n\n\n\n\ntown library\n\n\n\n在美国，“town library” 是指位于城镇内的公共图书馆。这些图书馆由城镇或地方政府资助，为当地社区提供各种书籍、资料和服务。城镇图书馆通常提供免费的借阅服务，包括书籍、期刊、报纸、音像资料等，并提供学习空间、研究帮助、电脑和互联网接入等资源。它们也可能举办各种活动和课程，以满足社区居民的教育、文化和娱乐需求。\n\n\n在某些情况下，我们得到了一个 样本，然后我们必须判断该 样本 是否能够代表 总体，例如如上的市民平均年龄的示例。在实践中，如果样本不是以“随机“的方式进行选择，那么通常不能假定给定的 样本 可以代表 总体。任何特定的、非随机的抽样规则往往会导致 样本 对某些数据存在固有的偏好，这也意味着会天然的反对另外的数据。\n因此，对于待选择的个体而言，在没有任何先验知识的情况下，通过完全”随机“的方式来选择 样本，我们更有可能获得有代表性的 样本。尽管这听起来可能有些矛盾，但这确实如此。换句话说，我们不需要刻意选择样本，以便 样本 中的人的性别比例和职业比例与 总体 是一致的。相反，我们应该把 样本 的特性留给 “可能性” 或者 ”概率“，以获得大致正确的百分比。一旦选好了随机样本，我们就可以通过研究 样本 并使用 统计推断 来得出和 总体 有关的结论。",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>统计学简介</span>"
    ]
  },
  {
    "objectID": "chapter_1/1.html#统计学简史",
    "href": "chapter_1/1.html#统计学简史",
    "title": "1  统计学简介",
    "section": "1.5 统计学简史",
    "text": "1.5 统计学简史\n在文艺复兴时期，意大利的威尼斯和佛罗伦萨开始对人口和经济方面的数据进行系统化的收集。统计学（statistics） 一词来源于国家（state）这个单词，通常用来描述和国家有关的数据收集。这种收集数据的想法不断从意大利传播到西欧的其他国家。事实上，在 16 世纪上半叶，欧洲国家的政府普遍要求教区居民登记出生、婚姻和死亡情况。由于公共卫生条件差，政府尤其关注居民登记的死亡信息统计。\n\n\n\n\n\n\nstatistics 一词的来源\n\n\n\n在 Statistics, History of 这篇论文中，作者提到了 statistics 一词的来源。\n\nIt is widely believed that the term statistics originated from the Latin Status (situation, condition) of population and economics; in late Latin, the same term meant State. Another root of the term comes from the Italian word stato (state), and a statista (a person who deals with affairs of state).\nAccording to Kendall (1960:447) the first use of the word statistics “occurs in a work by an Italian historian Girolamo Ghilini, who in 1589 refers to an account of civile, politica, statistica e militare scienza.”\n\n\n\n19 世纪之前，欧洲的高死亡率主要源自流行病、战争和饥荒。对于流行病而言，最严重的是瘟疫。从 1348 年的黑死病开始，瘟疫在近 400 年的时间里频繁在欧洲发生。1562 年，为了让英国的王室成员意识到需要搬迁到乡下，伦敦市开始每周公布死亡人数。最初，这些死亡人数的清单中会列出死亡地点以及是否因瘟疫而死亡。从 1625 年开始，该清单中的信息扩展到所有的死亡原因。\n1662 年，英国商人 John Graunt 出版了一本名为 Natural and Political Observations Made upon the Bills of Mortality 的书。表 1.1 摘录了该书中所列出的英格兰五个不同瘟疫年份的总死亡人数和因瘟疫死亡的人数。\n\n\n\n表 1.1: 不同年份的英格兰死亡人数表\n\n\n\n\n\n年份\n死亡人数\n瘟疫致死人数\n\n\n\n\n1592\n25,886\n11,503\n\n\n1593\n17,844\n10,662\n\n\n1603\n37,294\n30,561\n\n\n1625\n51,758\n35,417\n\n\n1636\n23,359\n10,400\n\n\n\n\n\n\nGraunt 利用伦敦的死亡人数来估算该市的人口总数。例如，为了估算 1660 年伦敦的人口，Graunt 对伦敦某些教区 (或社区) 家庭进行了调查，并发现平均每 88 人中大约有 3 人死亡。这意味着平均每 88/3 个人就会有 1 个人死亡。伦敦的死亡人数清单显示 1660 年伦敦有 13200 人死亡，所以 Graunt 估计当年伦敦的人口大约为：\n\\[\n13200 × 88/3 = 387200\n\\]\nGraunt 利用这种估计方法来预测整个英格兰的人口数量。他在书中指出，政府会对这些数据感兴趣，因为这些数据可以作为应征入伍人数和应纳税人数的指标。\nGraunt 还利用伦敦的死亡人数清单，以及关于何种疾病会导致何人、在什么年龄死亡的一些合理猜测，来推断死亡年龄。(回想一下，前面提到的死亡人数清单只列出了死亡原因和地点，其并没有列出死者的年龄。) 然后，格兰特利用这些信息计算出不同年龄段的死亡人口比例。表 1.2 是 Graunt 计算的死亡率表之一。例如，表 1.2 指出，在 100 名新生儿中，有 36 人将在 6 岁之前死亡，24 人将在 6~15 岁之间死亡，……\n\n\n\n表 1.2: John Graunt 的死亡率表\n\n\n\n\n\n死亡年龄\n每 100 新生儿中的死亡人数\n\n\n\n\n0-6\n36\n\n\n6-16\n24\n\n\n16-26\n15\n\n\n26-36\n9\n\n\n36-46\n6\n\n\n46-56\n4\n\n\n56-66\n3\n\n\n66-76\n2\n\n\n&gt;=76\n1\n\n\n\n\n\n\n从事 年金 行业的人对 Graunt 的死亡年龄表非常感兴趣。年金 与人寿保险不同，人们会一次性支付一笔款项作为投资，然后在有生之年定期从 年金 中获得收益。\n\n\n\n\n\n\n年金\n\n\n\n年金（annuity）是一种金融产品，通常由保险公司或金融机构提供。年金是一种长期投资工具，旨在为购买者提供一定期间内的收入。购买者通常向保险公司或金融机构支付一笔或多笔资金，而作为回报，购买者将在未来的一段时间内获得一定的收益。\n\n\n受到 Graunt 死亡率表的启发，1693 年，Edmund Halley 又做了更进一步的工作。Halley 是哈雷彗星的发现者（同时，Halley 也是对《自然哲学的数学原理》一书的出版贡献最大的人，他不但鼓励牛顿把自己的发现编写成书，更是为该书的出版提供了资金支持），他利用死亡率表来计算任何年龄段的人活到任何特定年龄的概率。Halley 说服了当时的保险公司，让他们相信年度人寿保险保费应该取决于被保险人的年龄。\n继 Graunt 和 Halley 之后，从 17 世纪末到 18 世纪，对数据的收集呈现稳步增长的趋势。例如，1667年，巴黎开始收集死亡人数清单；到 1730 年时，在欧洲，记录死亡年龄已成为一件非常普遍的事情。\n18 世纪之前，“statistics” 这个词被用作对国家或地区进行描述性分析的科学方法的简称。从 1800 年左右开始，西欧国家和美国政府开始系统地收集和公布类似的人口普查数据，这积累了大量的、可用的人口普查记录和相关的表格数据，这也导致了 “statistics” 一词在含义上发生了变化。19 世纪时，“statistics” 越来越多地与数字联系在一起，到 19 世纪 30 年代，在英国和法国，人们普遍将 “statistics” 一词与社会“数字科学”（numerical science）视为同等含义。\n贯穿整个 19 世纪，在 Jacob Bernoulli、Karl Friedrich Gauss 和 Pierre Simon Laplace 等数学家的推动下，尽管 概率论 已经发展起来，但在研究统计结果方面，概率论 几乎没有任何应用。此中的原因在于，当时的大多数社会统计学家都满足于让数据自己说话。特别是，当时的统计学家对个体推断并不感兴趣，他们更关心整个社会。因此，在当时，统计学家并不关心抽样，而是试图获得全部的人口普查数据。因此，在 19 世纪的社会统计学中，通过样本来推断总体概率的事情几乎没有发生过。\n直到 19 世纪末，统计学才开始关注如何从数值数据中推断结论。推断统计 这一运动始于 Francis Galton 关于 遗传天才 的分析工作，在这项分析中， Francis Galton 使用了我们现在所说的回归分析和相关性分析（章节 9）。Francis Galton 的工作极大的推动了 Karl Pearson 为统计学所做的贡献。Karl Pearson 是卡方检验（章节 11）的发明者，也是由 Francis Galton 于1904 年资助建立的高尔顿实验室的第一任负责人。在高尔顿实验室，Karl Pearson 发起了一个旨在发明一种用统计数据进行推断的新方法的研究项目。Pearson 邀请科学和工业领域的高年级学生到实验室来学习统计方法，然后将对应的方法应用于各自的领域。化学家 W.S. Gosset 是高尔顿实验室最早的访问学者之一，他以 “Student” 的名义出版了自己的研究发现，并以此表达了对皮尔逊的敬意。（有一个比较有名的故事是说，Gosset 害怕他所在的吉尼斯酿酒厂的老板在发现他们的一位化学家正在做统计学研究时会不高兴，因此不敢以自己的名义出版著作）。Gosset 因为他所发明的 t 检验而名声大振（章节 8）。\n20 世纪初，群体生物学（population biology）和农业是应用统计学的两个最重要的领域。统计学这这些领域的应用主要源自 Pearson 和他的实验室的其他人的研究，也源自英国科学家 Ronald A. Fisher 在统计学中的显著成就。在如上所介绍的先驱者以及其他研究者（例如， Karl Pearson 的儿子 Egon 和出生于波兰的数理统计学家 Jerzy Neyman 等）的推动下，他们所发明的推理理论已经通用到可以处理广泛的量化问题和实践问题。因此，在 20 世纪初之后的几年里，越来越多的科学家、商人和政界人士开始将统计学视为能够为科学问题和实践问题提供定量解决方案的工具（见 表 1.3）。\n\n\n\n表 1.3: Statistics 定义的变化\n\n\n\n\n\n\n\n\n\n时间\n定义\n\n\n\n\nQuetelet, 1849\nStatistics has then for its object that of presenting a faithful representation of a state at a determined epoch.\n\n\nGalton, 1889\nStatistics are the only tools by which an opening can be cut through the formidable thicket of difficulties that bars the path of those who pursue the Science of man.\n\n\nFisher, 1925\nStatistics may be regarded (i) as the study of populations, (ii) as the study of variation, and (iii) as the study of methods of the reduction of data.\n\n\nE. Pearson, 1936\nStatistics is a scientific discipline concerned with collection, analysis, and interpretation of data obtained from observation or experiment. The subject has a coherent structure based on the theory of Probability and includes many different procedures which contribute to research and development throughout the whole of Science and Technology.\n\n\nWeaver, 1952\nStatistics is the name for that science and art which deals with uncertain inferences — which uses numbers to find out something about nature and experience.\n\n\nPorter, 1986\nStatistics has become known in the 20th century as the mathematical tool for analyzing experimental and observational data.\n\n\nthis book, 2020\nStatistics is the art of learning from data.\n\n\n\n\n\n\n如今，统计学的思想无处不在。在每一份报纸和杂志上，描述统计学 的特点都有所体现。在公共卫生、医学研究、工程研究、科学研究、市场营销、质量控制、教育、会计、经济、气象预报、投票和调查、体育、保险、赌博以及所有声称是科学的研究领域，统计推断 都是不可或缺的。的确，统计学已经深深植根于人类的知识遗产（intellectual heritage）之中。\n\n\n\n\n\n\n知识遗产\n\n\n\n知识遗产（intellectual heritage）是指社会所拥有的知识、思想、传统、技能和价值观的集合，这些资源被传承下来并世代相传。知识遗产包括各种形式的人类智慧，如文学作品、艺术品、哲学理论、科学发现、宗教信仰、法律体系、技术创新等。知识遗产不仅仅是一种资产，更是一种社会、文化和历史的遗产，它反映了人类的智慧、经验和创造力，对于塑造社会的认同感、价值观和意识形态具有重要意义。",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>统计学简介</span>"
    ]
  },
  {
    "objectID": "chapter_1/1.html#习题",
    "href": "chapter_1/1.html#习题",
    "title": "1  统计学简介",
    "section": "习题",
    "text": "习题\n\n下周将举行选举，我们试图通过对总体选民进行抽样来预测共和党候选人或民主党候选人谁会获胜。以下哪种抽样方法可能产生有代表性的样本？\n\n\n对参加大学篮球比赛的所有达到投票年龄的人进行民意调查。\n\n\n对去市中心一家高档餐厅用餐的所有达到投票年龄的人进行民意调查。\n\n\n获取一份选民登记名单，随机选择100个名字，并对他们进行提问。\n\n\n使用电视台的电话投票民意调查结果，电视台会要求听众打电话进来并说出他们的选择。\n\n\n从电话簿中选择名字，并给这些人打电话。\n\n\n在1936年的美国总统竞选中，第 1 题的 (e) 选项使用的方法导致了及其糟糕的预测结果。在那次竞选中，富兰克林·罗斯福以压倒性优势击败了阿尔弗雷德·兰登。该杂志从汽车用户和电话用户名单中抽取选民样本，基于对这些选民的调研，Literary Digest 杂志预测兰登会获胜。\n\n\n你认为 Literary Digest 杂志的预测为何如此离谱？\n\n\n从 1936 年到现在，有没有什么变化让你相信 Literary Digest 杂志使用的方法在今天会更有效？\n\n\n一位研究人员正试图发现当今美国人死亡时的平均年龄。为了获得数据，研究人员阅读了 30 期的《纽约时报》的讣告专栏，并记录了美国人的死亡年龄。你认为这种方法会得到一个有代表性的样本吗？\n为了确定镇上吸烟者的比例，现决定在当地的以下地点之一进行民意调查。这些民意调查地点中，哪一个最有可能得出合理的结果？为什么？\n\n\n台球厅\n\n\n保龄球馆\n\n\n购物中心\n\n\n图书馆\n\n\n一所大学计划对其近期毕业的学生进行调查，以确定他们的年薪信息。该学校随机选择了 200 名近期要毕业的学生，并向他们发送了和他们目前工作有关的调查问卷。然而，在这 200 人中，只有 86 人返回了问卷。假设这返回的 86 份问卷显示的平均年薪为 75000 美元。\n\n\n该学校认为 75000 美元是所有毕业生平均工资水平的比较好的近似值，这种想法对吗？解释你的回答背后的理由。\n\n\n如果你对 (a) 的回答是否定的，你能想到，在什么条件下，返回的问卷所显示的工资水平将会是一个不错的毕业生平均工资水平的近似值？\n\n\n一篇文章报道称，对夜间交通事故中丧生的行人所穿衣服的调查显示，约 80% 的受害者穿着深色衣服，20% 的受害者穿着浅色衣服。文章得出的结论是，晚上穿浅色衣服更安全。\n\n\n这个结论合理吗？请解释下你的回答。\n\n\n如果你对 (a) 的回答是否定的，那么在得出最终结论之前，还需要什么其他信息？\n\n\n如何评判 Graunt 估算伦敦人口的方法？他的方法是有什么隐含的假设？\n1658 年，伦敦的死亡率清单记录了 12246 人死亡。假设对伦敦教区的调查显示，该年的人口死亡率大约为 2%，使用 Graunt 的方法来估算 1658 年伦敦的人口总数。\n1662 年，当 Graunt 的书出版时，假设你是一名年金销售员。解释一下，你将如何利用 Graunt 给出的关于人们死亡年龄的数据。\n基于 Graunt 的死亡率表（表 1.2）：\n\n\n活到 6 岁的人的占比是多少？\n\n\n活到 46 岁的人的占比是多少？\n\n\n死于 6 岁到 36 岁之间的人的占比是多少？",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>统计学简介</span>"
    ]
  },
  {
    "objectID": "chapter_2/2.html",
    "href": "chapter_2/2.html",
    "title": "2  描述统计",
    "section": "",
    "text": "2.1 引言\n本章将介绍 描述统计 的相关内容，在介绍 描述统计 的过程中，我们将学习如何描述和总结数据。\n小节 2.2 会讨论如何描述数据集。如果一个数据集中的数据差异相对较小，小节 2.2.1 和 小节 2.2.2 介绍了如何使用 频率表（frequency tables）来描述这样的数据集，小节 2.2.3 则介绍如何将数据集划分到不同的分组。\n小节 2.3 会讨论如何使用统计量来总结数据集，统计量往往是由数据集确定的量化数值。小节 2.3.1 介绍了用于描述数据集中心（center）的三个统计量：样本均值（sample mean）、样本中位数（sample median）和样本众数（sample mode）。小节 2.3.2 会介绍样本方差（sample variance）及样本标准差（sample standard deviation）。样本均值、样本中位数、样本众数、样本方差和标准差这些统计数据用于描述数据集中数值的分布。小节 2.3.3 会介绍样本的百分位数（sample percentiles），样本百分位数这个统计量可以告诉我们数据集中哪个值大于所有数据的 95%。\n小节 2.4 节会介绍数据样本集中的切比雪夫不等式（Chebyshev’s inequality），切比雪夫不等式给出了与样本均值相差超过 \\(k\\) 倍样本标准差的数据比例的上限。虽然切比雪夫不等式适用于所有数据集，但在某些情况下（例如 小节 2.5 中讨论的正态分布数据集），我们可以获得更精准的数据比例。\n在 小节 2.5 中，我们注意到，当数据分布符合钟形（bell-shaped）时，我们认为该数据集是近似正态的，此时，位于样本均值 \\(k\\) 个样本标准差内的数据比例可以根据所谓的经验法则（empirical rule）给出更精确的估计。\n小节 2.6 中关注的是成对数据（paired data），并介绍了如何使用散点图（scatter diagram）来描述成对数据以及样本相关系数（sample correlation coefficient）。样本相关系数是一个统计量，该值表示成对数据中第一个值与第二个值之间相关联的程度。\n小节 2.7 会介绍国民收入分配，洛伦兹曲线（Lorenz curve）（ L(p)）和基尼系数（Gini index）。洛伦兹曲线给出了收入较低的百分之 \\(p\\) 的居民收入占总收入的比例，基尼系数则是用于衡量收入分配不平等程度的指标。\n小节 2.8 会介绍如何使用 R 来分析数据集。",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>描述统计</span>"
    ]
  },
  {
    "objectID": "chapter_2/2.html#sec-2_2",
    "href": "chapter_2/2.html#sec-2_2",
    "title": "2  描述统计",
    "section": "2.2 描述数据集",
    "text": "2.2 描述数据集\n应当用数据清晰、简洁的显示研究结果，以便研究者可以迅速把握数据的关键特征。多年来，人们发现，对于展示数据而言，表格和图是特别有用的方式。图表常常可以揭示数据的重要特征，如数据的范围、集中程度和对称性。本节将介绍一些常见的数据图表展示方式。\n\n2.2.1 频率表和图\n如果一个数据集中的数据差异较小，我们便可以以频率表（frequency table）的形式来方便的展现该数据集。例如，表 2.1 就是一个数据集的频率表，该数据集由 42 名最近毕业的电子工程专业的大学生的起始年薪（以千美元为单位，四舍五入）构成。表 2.1 告诉我们，最低起薪为 57000 美元，并且有四名毕业生的起薪为 57000 美元；最高起薪为 70000 美元，并且有一名学生的起薪为 70000 美元；最为普遍的起薪为 62000 美元，并且有 10 名学生拿到了 62000 美元的起薪。\n\n\n代码\nlibrary(knitr)\nss &lt;- c(57, 58, 59, 60, 61, 62, 63, 64, 66, 67, 70)\nf &lt;- c(4, 1, 3, 5, 8, 10, 0, 5, 2, 3, 1)\ndf &lt;- data.frame(\"Starting Salary\" = ss, \"Frequency\" = f)\nkable(df, align = \"l\")\n\n\n\n\n表 2.1: 起薪分布\n\n\n\n\n\n\nStarting.Salary\nFrequency\n\n\n\n\n57\n4\n\n\n58\n1\n\n\n59\n3\n\n\n60\n5\n\n\n61\n8\n\n\n62\n10\n\n\n63\n0\n\n\n64\n5\n\n\n66\n2\n\n\n67\n3\n\n\n70\n1\n\n\n\n\n\n\n\n\n可以用线图（line graph）来直观地显示频率表中的数据。如 图 2.1，在线图中，水平坐标轴用于绘制不同的数据值，而垂直直线的高度用于表示对应数据值出现的频率。\n\n\n代码\nlibrary(ggplot2)  \n\ndf &lt;- data.frame(  \n  salary = c(57, 58, 59, 60, 61, 62, 63, 64, 66, 67, 70),  \n  value_end = c(4, 1, 3, 5, 8, 10, 0, 5, 2, 3, 1),  \n  value_start = rep(0, 11) \n)  \n\n# 将类别转换为因子，以确保正确的顺序  \ndf$salary &lt;- factor(df$salary, levels = df$salary, ordered = TRUE)  \n \nggplot(df, aes(x = salary, y = value_start, yend = value_end, color = salary)) +  \n  geom_segment(size = 2) +                    # 绘制水平线表示每个“条形”  \n  geom_point(aes(y = value_end), size = 3) +  # 在每个“条形”的末端添加点  \n  theme_minimal() +  \n  labs(x = \"Starting Salary\", y = \"Frequency\") +  \n  scale_y_continuous(breaks = seq(1, 10, by = 1)) +  \n  theme(legend.position = \"none\")           # 调整图例位置\n\n\n\n\n\n\n\n\n图 2.1: 起薪线图\n\n\n\n\n\n当为 图 2.1 中的线条增加厚度时，图 2.1 就变成了 图 2.2 所示的条形图（bar graph）。\n\n\n代码\nlibrary(ggplot2)  \n\ndf &lt;- data.frame(  \n  salary = c(57, 58, 59, 60, 61, 62, 63, 64, 66, 67, 70),  \n  value = c(4, 1, 3, 5, 8, 10, 0, 5, 2, 3, 1)\n)  \n\n# 将类别转换为因子，以确保正确的顺序  \ndf$salary &lt;- factor(df$salary, levels = df$salary, ordered = TRUE)  \n \nggplot(df, aes(x = salary, y = value)) +  \n  geom_bar(stat = \"identity\", fill = \"steelblue\") +  \n  theme_minimal() +  \n  xlab(\"Starting Salary\") +  \n  ylab(\"Frequency\") +\n  scale_y_continuous(breaks = seq(1, 10, by = 2))\n\n\n\n\n\n\n\n\n图 2.2: 起薪条形图\n\n\n\n\n\n另一种用于表示频数表的图形是折线图（frequency polygon），在折线图中，对于在数据集中出现的不同的数据值，其出现的次数为纵坐标，以此画出对应的点，然后用直线将这些点依次连接起来。图 2.3 给出了 表 2.1 对应的折线图。\n\n\n代码\nlibrary(ggplot2)  \n\ndf &lt;- data.frame(  \n  salary = c(57, 58, 59, 60, 61, 62, 63, 64, 66, 67, 70),  \n  value = c(4, 1, 3, 5, 8, 10, 0, 5, 2, 3, 1)\n)  \n\nggplot(df, aes(x=salary, y=value)) +   \n  geom_line() +  \n  labs(x=\"Starting Salary\", y=\"Frequency\") + \n  scale_y_continuous(breaks = seq(1, 10, by = 2)) + \n  theme_minimal()\n\n\n\n\n\n\n\n\n图 2.3: 起薪折线图\n\n\n\n\n\n\n\n2.2.2 相对频率表和图\n一个数据集中有 \\(n\\) 个值，如果 \\(f\\) 是某个特定值的频率，那么\\(\\frac{f}{n}\\) 为该特定值的相对频率（relative frequency）。也就是说，一个值的相对频率是数据集中具有该值的数据所占的比例。可以用线图、条形图、折线图来表示相对频率。事实上，在相对频率图中，除了纵坐标的值是绝对频率图中的值除以数据点总数外，相对频率图看起来和绝对频率图没什么不同。\n\n例 2.1 表 2.2 是 表 2.1 的相对频率表。将 表 2.1 中相应的频率除以数据集的大小（42） 得到其对应的相对频率表。\n\n\n\n代码\nlibrary(knitr)\nss &lt;- c(57, 58, 59, 60, 61, 62, 63, 64, 66, 67, 70)\nf &lt;- c(4, 1, 3, 5, 8, 10, 0, 5, 2, 3, 1)\ncnt = sum(f)\nf &lt;- f / cnt\n\ndf &lt;- data.frame(\"Starting Salary\" = ss, \"Relative Frequency\" = f)\nkable(df, align = \"l\")\n\n\n\n\n表 2.2: 起薪分布相对频率表\n\n\n\n\n\n\nStarting.Salary\nRelative.Frequency\n\n\n\n\n57\n0.0952381\n\n\n58\n0.0238095\n\n\n59\n0.0714286\n\n\n60\n0.1190476\n\n\n61\n0.1904762\n\n\n62\n0.2380952\n\n\n63\n0.0000000\n\n\n64\n0.1190476\n\n\n66\n0.0476190\n\n\n67\n0.0714286\n\n\n70\n0.0238095\n\n\n\n\n\n\n\n\n当数据集中的数据不是数值型数据时，通常使用饼图（pie chart）来表示相对频率。首先画一个圆，然后将其切分成不同的扇形区域，每一个扇区对应数据集中的一种数据类型。在饼图中，扇区的面积表示数据值的相对频率，其面积等于圆的总面积乘以数据值的相对频率。\n\n例 2.2 根据一家肿瘤专科诊所登记的最近 200 名患者的数据，得到了一个关于不同类型肿瘤患者数的数据集。图 2.4 使用饼图的形式来显示如上的数据集。\n\n\n代码\nlibrary(knitr)\n\ntype &lt;- c(\"Melanoma\", \"Bladder\", \"Colon\", \"Lung\", \"Breast\", \"Prostate\")\nnum &lt;- c(9, 12, 32, 42, 50, 55)  \nvalue &lt;- num / sum(num)\n\ndf &lt;- data.frame(\"Type of Cancer\" = type, \"Number of New Cases\" = num, \"Relative Frequency\" = value)\n\nkable(df, align = \"l\")\n\n\n\n\n\nType.of.Cancer\nNumber.of.New.Cases\nRelative.Frequency\n\n\n\n\nMelanoma\n9\n0.045\n\n\nBladder\n12\n0.060\n\n\nColon\n32\n0.160\n\n\nLung\n42\n0.210\n\n\nBreast\n50\n0.250\n\n\nProstate\n55\n0.275\n\n\n\n\n\n\n\n\n代码\nlibrary(ggplot2)\n  \n# 提供的数据  \ntype &lt;- c(\"Melanoma\", \"Bladder\", \"Colon\", \"Lung\", \"Breast\", \"Prostate\")\nnum &lt;- c(9, 12, 32, 42, 50, 55)  \nvalue &lt;- num / sum(num)\n\ndf &lt;- data.frame(type = type, num = num, value = value)\ndf$label &lt;- paste(df$type, \"\\n\", round(df$value * 100, 1), \"%\", sep=\"\") \n\n# 绘制饼图  \nggplot(df, aes(x = \"\", y = value, fill = type)) +  \n  geom_bar(width = 1, stat = \"identity\") +  \n  coord_polar(\"y\", start = 0) +  \n  theme_void() +  \n  theme(legend.title = element_blank()) +  \n  scale_fill_brewer(palette = \"Pastel1\") +  \n  labs(fill = \"type\") +  \n  geom_text(aes(label = label),   \n            position = position_stack(vjust = 0.5)) + # 添加百分比标签\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\n图 2.4: 诊所数据饼图\n\n\n\n\n\n\n\n\n\n\n\n注记\n\n\n\n虽然我们经常使用饼图，尤其是在商业分析中，饼图更是得到了广泛的使用，但是统计学家则一直很排斥使用饼图。因为人们对长度的判断比面积更为精确，因此统计学家更倾向于使用条形图。在 R 中，对饼图的支持要比其他的工具差很多。\n\n\n\n\n2.2.3 分组数据，直方图，肩形图和茎叶图\n如 小节 2.2.2 所述，使用线图或条形图绘制数据值的频率通常是描述数据集的有效方法。然而，对于那些不同数值数量太多的数据集而言，就无法使用线图或条形图的方法来对数据进行描述。在这种情况下，我们可以先将数值分组或按类别进行分类，然后绘制落在每个分组中的数据值的数量。分组数量的选取需要在以下两者之间进行取舍：\n\n较少的分组，但是将会丢失实际数据值中的很多信息；\n较多多的分组，但是将导致每个分组中的数值频率太小，以至于无法从图中辨别出数据模型。\n\n尽管典型的分组数为 5 ~ 10 个，但是适当的分组数量来自主观选择。当然，我们可以尝试不同的分组数，并对比看看哪张图表的效果最好。尽管不是必须的，但是在选择分组数时，通常会让不同分组之间的间隔长度保持一致。\n分组的端点（endpoint）称之为分组边界（class boundaries）。我们将会采用左端包含原则，该原则规定分组中的数据包含其左端点，但不包含其右端。因此，例如，20–30 这个分组包含所有 \\(\\ge\\) 20 且 \\(&lt;\\) 30 的值。\n表 2.3 给出了 200 只白炽灯的使用寿命。表 2.4 为 表 2.3 数据的分组频率表，其分组的间隔长度为 100，第一个分组从 500 开始。\n\n\n代码\nlibrary(knitr)\n\ndata &lt;- c(1067, 919, 855, 1092, 1157, 1195, 1022, 978, 923, 1333, 521, 933, 930, 807, 999, 932, 901, 1324, 996, 780, 1187, 1067, 824, 653, 844, 814, 1037, 1151, 1026, 1147, 1039, 1083, 1023, 984, 1134, 932, 998, 996, 610, 916, 1196, 785, 1162, 1170, 1195, 1340, 832, 1009, 811, 1217, 928, 1153, 954, 1063, 1035, 944, 818, 1250, 900, 1106, 1118, 1037, 980, 935, 1103, 1000, 863, 990, 883, 867, 1040, 1289, 856, 924, 938, 1078, 1133, 765, 1001, 895, 1126, 936, 929, 950, 1122, 938, 1157, 1151, 1085, 896, 946, 858, 1002, 909, 1049, 940, 1203, 1078, 704, 621, 958, 760, 878, 934, 788, 1143, 1035, 1112, 990, 1258, 699, 1083, 801, 1122, 1180, 1106, 775, 1105, 709, 860, 918, 1156, 920, 948, 905, 972, 1035, 1045, 970, 1237, 956, 1102, 1009, 765, 958, 902, 958, 1311, 1037, 702, 1071, 1069, 830, 1063, 1077, 1021, 1062, 1157, 1122, 1115, 833, 1320, 890, 1303, 1011, 1102, 854, 1178, 1138, 951, 1101, 949, 992, 966, 910, 1058, 730, 980, 935, 1069, 1170, 1067, 931, 970, 932, 904, 1192, 922, 1150, 1091, 880, 1029, 658, 912, 1292, 1116, 880, 1173, 1184, 954, 824, 529, 1081, 1171, 705, 1425, 1110, 1149, 972, 1002)\n\nkable(matrix(data, nrow = 20, ncol = 10, byrow = TRUE))\n\n\n\n\n表 2.3: 200 个 白炽灯的寿命（Hour）\n\n\n\n\n\n\n1067\n919\n855\n1092\n1157\n1195\n1022\n978\n923\n1333\n\n\n521\n933\n930\n807\n999\n932\n901\n1324\n996\n780\n\n\n1187\n1067\n824\n653\n844\n814\n1037\n1151\n1026\n1147\n\n\n1039\n1083\n1023\n984\n1134\n932\n998\n996\n610\n916\n\n\n1196\n785\n1162\n1170\n1195\n1340\n832\n1009\n811\n1217\n\n\n928\n1153\n954\n1063\n1035\n944\n818\n1250\n900\n1106\n\n\n1118\n1037\n980\n935\n1103\n1000\n863\n990\n883\n867\n\n\n1040\n1289\n856\n924\n938\n1078\n1133\n765\n1001\n895\n\n\n1126\n936\n929\n950\n1122\n938\n1157\n1151\n1085\n896\n\n\n946\n858\n1002\n909\n1049\n940\n1203\n1078\n704\n621\n\n\n958\n760\n878\n934\n788\n1143\n1035\n1112\n990\n1258\n\n\n699\n1083\n801\n1122\n1180\n1106\n775\n1105\n709\n860\n\n\n918\n1156\n920\n948\n905\n972\n1035\n1045\n970\n1237\n\n\n956\n1102\n1009\n765\n958\n902\n958\n1311\n1037\n702\n\n\n1071\n1069\n830\n1063\n1077\n1021\n1062\n1157\n1122\n1115\n\n\n833\n1320\n890\n1303\n1011\n1102\n854\n1178\n1138\n951\n\n\n1101\n949\n992\n966\n910\n1058\n730\n980\n935\n1069\n\n\n1170\n1067\n931\n970\n932\n904\n1192\n922\n1150\n1091\n\n\n880\n1029\n658\n912\n1292\n1116\n880\n1173\n1184\n954\n\n\n824\n529\n1081\n1171\n705\n1425\n1110\n1149\n972\n1002\n\n\n\n\n\n\n\n\n\n\n代码\nlibrary(knitr)\n\ndata &lt;- c(1067, 919, 855, 1092, 1157, 1195, 1022, 978, 923, 1333, 521, 933, 930, 807, 999, 932, 901, 1324, 996, 780, 1187, 1067, 824, 653, 844, 814, 1037, 1151, 1026, 1147, 1039, 1083, 1023, 984, 1134, 932, 998, 996, 610, 916, 1196, 785, 1162, 1170, 1195, 1340, 832, 1009, 811, 1217, 928, 1153, 954, 1063, 1035, 944, 818, 1250, 900, 1106, 1118, 1037, 980, 935, 1103, 1000, 863, 990, 883, 867, 1040, 1289, 856, 924, 938, 1078, 1133, 765, 1001, 895, 1126, 936, 929, 950, 1122, 938, 1157, 1151, 1085, 896, 946, 858, 1002, 909, 1049, 940, 1203, 1078, 704, 621, 958, 760, 878, 934, 788, 1143, 1035, 1112, 990, 1258, 699, 1083, 801, 1122, 1180, 1106, 775, 1105, 709, 860, 918, 1156, 920, 948, 905, 972, 1035, 1045, 970, 1237, 956, 1102, 1009, 765, 958, 902, 958, 1311, 1037, 702, 1071, 1069, 830, 1063, 1077, 1021, 1062, 1157, 1122, 1115, 833, 1320, 890, 1303, 1011, 1102, 854, 1178, 1138, 951, 1101, 949, 992, 966, 910, 1058, 730, 980, 935, 1069, 1170, 1067, 931, 970, 932, 904, 1192, 922, 1150, 1091, 880, 1029, 658, 912, 1292, 1116, 880, 1173, 1184, 954, 824, 529, 1081, 1171, 705, 1425, 1110, 1149, 972, 1002)\n\nintervals &lt;- seq(500, 1500, by = 100)\ngroup &lt;- cut(data, intervals, right=FALSE)\nkable(table(\"Class Interval\" = group))\n\n\n\n\n表 2.4: 200 个 白炽灯的寿命（Hour）分布表\n\n\n\n\n\n\nClass.Interval\nFreq\n\n\n\n\n[500,600)\n2\n\n\n[600,700)\n5\n\n\n[700,800)\n12\n\n\n[800,900)\n25\n\n\n[900,1e+03)\n58\n\n\n[1e+03,1.1e+03)\n41\n\n\n[1.1e+03,1.2e+03)\n43\n\n\n[1.2e+03,1.3e+03)\n7\n\n\n[1.3e+03,1.4e+03)\n6\n\n\n[1.4e+03,1.5e+03)\n1\n\n\n\n\n\n\n\n\n分组数据的条形图中，其不同的分组彼此相邻，我们称之为直方图（histogram）。直方图的纵坐标可以表示分组的频率或相对频率，当表示分组频率时该图为频率直方图，当表示分组相对频率时为相对频率直方图。图 2.5 给出了 表 2.4 中数据的频率直方图。\n\n\n代码\nlibrary(ggplot2)\n\ndata &lt;- c(1067, 919, 855, 1092, 1157, 1195, 1022, 978, 923, 1333, 521, 933, 930, 807, 999, 932, 901, 1324, 996, 780, 1187, 1067, 824, 653, 844, 814, 1037, 1151, 1026, 1147, 1039, 1083, 1023, 984, 1134, 932, 998, 996, 610, 916, 1196, 785, 1162, 1170, 1195, 1340, 832, 1009, 811, 1217, 928, 1153, 954, 1063, 1035, 944, 818, 1250, 900, 1106, 1118, 1037, 980, 935, 1103, 1000, 863, 990, 883, 867, 1040, 1289, 856, 924, 938, 1078, 1133, 765, 1001, 895, 1126, 936, 929, 950, 1122, 938, 1157, 1151, 1085, 896, 946, 858, 1002, 909, 1049, 940, 1203, 1078, 704, 621, 958, 760, 878, 934, 788, 1143, 1035, 1112, 990, 1258, 699, 1083, 801, 1122, 1180, 1106, 775, 1105, 709, 860, 918, 1156, 920, 948, 905, 972, 1035, 1045, 970, 1237, 956, 1102, 1009, 765, 958, 902, 958, 1311, 1037, 702, 1071, 1069, 830, 1063, 1077, 1021, 1062, 1157, 1122, 1115, 833, 1320, 890, 1303, 1011, 1102, 854, 1178, 1138, 951, 1101, 949, 992, 966, 910, 1058, 730, 980, 935, 1069, 1170, 1067, 931, 970, 932, 904, 1192, 922, 1150, 1091, 880, 1029, 658, 912, 1292, 1116, 880, 1173, 1184, 954, 824, 529, 1081, 1171, 705, 1425, 1110, 1149, 972, 1002)\n\ndf &lt;- data.frame(value = data)\nbreaks_vector &lt;- seq(from = 500, to = 1500, by = 100)\n\nggplot(df, aes(x = value)) +  \n  geom_histogram(breaks = breaks_vector, fill = \"lightblue\", color = \"black\") +  \n  xlab(\"incandescent lamps lifetime(Hour)\") +  \n  ylab(\"Frequency\")\n\n\n\n\n\n\n\n\n图 2.5: 200 个 白炽灯的寿命（Hour）分布直方图\n\n\n\n\n\n很多时候，我们需要绘制累积频率图（cumulative frequency graph）或者累积相对频率图（cumulative relative frequency graph）。在累积频率（相对频率）图的横坐标上，一个点代表一个可能的数据值，其对应的纵坐标为值小于或等于该数据值的数据数量（或比例）。图 2.6 给出了 表 2.3 中所示数据的累积相对频率图。从这个图中我们可以发现，使用寿命小于 1500（小时） 的白炽灯占比为 100%，使用寿命 \\(\\le\\) 900 的占比大约为 40% ，使用寿命 \\(\\le\\) 1100 的占比大约为 80%，……我们通常又把累积频率图称为肩形图（ogive）。\n\n\n代码\nlibrary(ggplot2)\n\ndata &lt;- c(1067, 919, 855, 1092, 1157, 1195, 1022, 978, 923, 1333, 521, 933, 930, 807, 999, 932, 901, 1324, 996, 780, 1187, 1067, 824, 653, 844, 814, 1037, 1151, 1026, 1147, 1039, 1083, 1023, 984, 1134, 932, 998, 996, 610, 916, 1196, 785, 1162, 1170, 1195, 1340, 832, 1009, 811, 1217, 928, 1153, 954, 1063, 1035, 944, 818, 1250, 900, 1106, 1118, 1037, 980, 935, 1103, 1000, 863, 990, 883, 867, 1040, 1289, 856, 924, 938, 1078, 1133, 765, 1001, 895, 1126, 936, 929, 950, 1122, 938, 1157, 1151, 1085, 896, 946, 858, 1002, 909, 1049, 940, 1203, 1078, 704, 621, 958, 760, 878, 934, 788, 1143, 1035, 1112, 990, 1258, 699, 1083, 801, 1122, 1180, 1106, 775, 1105, 709, 860, 918, 1156, 920, 948, 905, 972, 1035, 1045, 970, 1237, 956, 1102, 1009, 765, 958, 902, 958, 1311, 1037, 702, 1071, 1069, 830, 1063, 1077, 1021, 1062, 1157, 1122, 1115, 833, 1320, 890, 1303, 1011, 1102, 854, 1178, 1138, 951, 1101, 949, 992, 966, 910, 1058, 730, 980, 935, 1069, 1170, 1067, 931, 970, 932, 904, 1192, 922, 1150, 1091, 880, 1029, 658, 912, 1292, 1116, 880, 1173, 1184, 954, 824, 529, 1081, 1171, 705, 1425, 1110, 1149, 972, 1002)\n\ndf &lt;- data.frame(value = data)\ndf$value &lt;- df$value[order(df$value)]\ndf$cumulative_freq &lt;- cumsum(rep(1/nrow(df), nrow(df))) \n\nggplot(df, aes(x = value, y = cumulative_freq)) +  \n  geom_step(direction = \"vh\", color = \"blue\") +  \n  xlab(\"incandescent lamps lifetime\") +  \n  ylab(\"Cumulative Relative Frequency\") +   \n  theme_minimal()\n\n\n\n\n\n\n\n\n图 2.6: 200 个 白炽灯的寿命（Hour）累积频率图\n\n\n\n\n\n对于中小型数据集而言，茎叶图（stem-leaf plot）是一种有效的数据组织方式。可以把每个数据值分为茎和叶两部分来获得茎叶图。例如，如果数据都是两位整数值，那么我们可以把十位数作为茎，个位数作为叶。例如，值 62 的茎叶图表示为：\n\n\n62 的茎叶图\n\nStem Leaf\n  6   2\n\n62，67 两个数据的茎叶图表示为：\n\n\n62，67 的茎叶图\n\nStem Leaf\n  6  2,7\n\n\n例 2.3 表 2.5 给出了美国 35 个城市的每日最低气温的月平均值和年平均值。表 2.5 中的每日最低温度的年平均值可以用下面的茎叶图表示。\n\n\n代码\ndf &lt;- read.table(\"../misc/US_minimum_temperature.csv\", header=TRUE, sep=\",\")\nstem(df$Annual.avg.)\n\n\n\n  The decimal point is 1 digit(s) to the right of the |\n\n  2 | 9\n  3 | 034\n  3 | 56699\n  4 | 0001244\n  4 | 55567899\n  5 | 112\n  5 | 677899\n  6 | \n  6 | 9\n  7 | 0\n\n\n\n\n\n\n\n\n\n注记\n\n\n\n由于 R 中的 stem() 并不支持小数，因此对于 表 2.5 中所示的年平均值会先进行四舍五入转成整数，然后再画茎叶图。因此，这里给的茎叶图和原书中的不一致。\n\n\n\n\n代码\nlibrary(knitr)\ndf &lt;- read.table(\"../misc/US_minimum_temperature.csv\", header=TRUE, sep=\",\")\nkable(df)\n\n\n\n\n表 2.5: 1961年~1990年，美国指定城市的每日最低气温表。数据来源：Source: U.S. National Oceanic and Atmospheric Administration, Climatography of the United States, No. 81。\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nState\nStation\nJan.\nFeb.\nMar.\nApr.\nMay\nJune\nJuly\nAug.\nSept.\nOct.\nNov.\nDec.\nAnnual.avg.\n\n\n\n\nAL\nMobile\n40.0\n42.7\n50.1\n57.1\n64.4\n70.7\n73.2\n72.9\n68.7\n57.3\n49.1\n43.1\n57.4\n\n\nAK\nJuneau\n19.0\n22.7\n26.7\n32.1\n38.9\n45.0\n48.1\n47.3\n42.9\n37.2\n27.2\n22.6\n34.1\n\n\nAZ\nPhoenix\n41.2\n44.7\n48.8\n55.3\n63.9\n72.9\n81.0\n79.2\n72.8\n60.8\n48.9\n41.8\n59.3\n\n\nAR\nLittle Rock\n29.1\n33.2\n42.2\n50.7\n59.0\n67.4\n71.5\n69.8\n63.5\n50.9\n41.5\n33.1\n51.0\n\n\nCA\nLos Angeles\n47.8\n49.3\n50.5\n52.8\n56.3\n59.5\n62.8\n64.2\n63.2\n59.2\n52.8\n47.9\n55.5\n\n\nCA\nSacramento\n37.7\n41.4\n43.2\n45.5\n50.3\n55.3\n58.1\n58.0\n55.7\n50.4\n43.4\n37.8\n48.1\n\n\nCA\nSan Diego\n48.9\n50.7\n52.8\n55.6\n59.1\n61.9\n65.7\n67.3\n65.6\n60.9\n53.9\n48.8\n57.6\n\n\nCA\nSan Francisco\n41.8\n45.0\n45.8\n47.2\n49.7\n52.6\n53.9\n55.0\n55.2\n51.8\n47.1\n42.7\n49.0\n\n\nCO\nDenver\n16.1\n20.2\n25.8\n34.5\n43.6\n52.4\n58.6\n56.9\n47.6\n36.4\n25.4\n17.4\n36.2\n\n\nCT\nHartford\n15.8\n18.6\n28.1\n37.5\n47.6\n56.9\n62.2\n60.4\n51.8\n40.7\n32.8\n21.3\n39.5\n\n\nDE\nWilmington\n22.4\n24.8\n33.1\n41.8\n52.2\n61.6\n67.1\n65.9\n58.2\n45.7\n37.0\n27.6\n44.8\n\n\nDC\nWashington\n26.8\n29.1\n37.7\n46.4\n56.6\n66.5\n71.4\n70.0\n62.5\n50.3\n41.1\n31.7\n49.2\n\n\nFL\nJacksonville\n40.5\n43.3\n49.2\n54.9\n62.1\n69.1\n71.9\n71.8\n69.0\n59.3\n50.2\n43.4\n57.1\n\n\nFL\nMiami\n59.2\n60.4\n64.2\n67.8\n72.1\n75.1\n76.2\n76.7\n75.9\n72.1\n66.7\n61.5\n69.0\n\n\nGA\nAtlanta\n31.5\n34.5\n42.5\n50.2\n58.7\n66.2\n69.5\n69.0\n63.5\n51.9\n42.8\n35.0\n51.3\n\n\nHI\nHonolulu\n65.6\n65.4\n67.2\n68.7\n70.3\n72.2\n73.5\n74.2\n73.5\n72.3\n70.3\n67.0\n70.0\n\n\nID\nBoise\n21.6\n27.5\n31.9\n36.7\n43.9\n52.1\n57.7\n56.8\n48.2\n39.0\n31.1\n22.5\n39.1\n\n\nIL\nChicago\n12.9\n17.2\n28.5\n38.6\n47.7\n57.5\n62.6\n61.6\n53.9\n42.2\n31.6\n19.1\n39.5\n\n\nIL\nPeoria\n13.2\n17.7\n29.8\n40.8\n50.9\n60.7\n65.4\n63.1\n55.2\n43.1\n32.5\n19.3\n41.0\n\n\nIN\nIndianapolis\n17.2\n20.9\n31.9\n41.5\n51.7\n61.0\n65.2\n62.8\n55.6\n43.5\n34.1\n23.2\n42.4\n\n\nIA\nDes Moines\n10.7\n15.6\n27.6\n40.0\n51.5\n61.2\n66.5\n63.6\n54.5\n42.7\n29.9\n16.1\n40.0\n\n\nKS\nWichita\n19.2\n23.7\n33.6\n44.5\n54.3\n64.6\n69.9\n67.9\n59.2\n46.6\n33.9\n23.0\n45.0\n\n\nKY\nLouisville\n23.2\n26.5\n36.2\n45.4\n54.7\n62.9\n67.3\n65.8\n58.7\n45.8\n37.3\n28.6\n46.0\n\n\nLA\nNew Orleans\n41.8\n44.4\n51.6\n58.4\n65.2\n70.8\n73.1\n72.8\n69.5\n58.7\n51.0\n44.8\n58.5\n\n\nME\nPortland\n11.4\n13.5\n24.5\n34.1\n43.4\n52.1\n58.3\n57.1\n48.9\n38.3\n30.4\n17.8\n35.8\n\n\nMD\nBaltimore\n23.4\n25.9\n34.1\n42.5\n52.6\n61.8\n66.8\n65.7\n58.4\n45.9\n37.1\n28.2\n45.2\n\n\nMA\nBoston\n21.6\n23.0\n31.3\n40.2\n49.8\n59.1\n65.1\n64.0\n56.8\n46.9\n38.3\n26.7\n43.6\n\n\nMI\nDetroit\n15.6\n17.6\n27.0\n36.8\n47.1\n56.3\n61.3\n59.6\n52.5\n40.9\n32.2\n21.4\n39.0\n\n\nMI\nSault Ste. Marie\n4.6\n4.8\n15.3\n28.4\n38.4\n45.5\n51.3\n51.3\n44.3\n36.2\n25.9\n11.8\n29.8\n\n\nMN\nDuluth\n-2.2\n2.8\n15.7\n28.9\n39.6\n48.5\n55.1\n53.3\n44.5\n35.1\n21.5\n4.9\n29.0\n\n\nMN\nMinneapolis-St. Paul\n2.8\n9.2\n22.7\n36.2\n47.6\n57.6\n63.1\n60.3\n50.3\n38.8\n25.2\n10.2\n35.3\n\n\nMS\nJackson\n32.7\n35.7\n44.1\n51.9\n60.0\n67.1\n70.5\n69.7\n63.7\n50.3\n42.3\n36.1\n52.0\n\n\nMO\nKansas City\n16.7\n21.8\n32.6\n43.8\n53.9\n63.1\n68.2\n65.7\n56.9\n45.7\n33.6\n21.9\n43.7\n\n\nMO\nSt. Louis\n20.8\n25.1\n35.5\n46.4\n56.0\n65.7\n70.4\n67.9\n60.5\n48.3\n37.7\n26.0\n46.7\n\n\nMT\nGreat Falls\n11.6\n17.2\n22.8\n31.9\n40.9\n48.6\n53.2\n52.2\n43.5\n35.8\n24.3\n14.6\n33.1",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>描述统计</span>"
    ]
  },
  {
    "objectID": "chapter_2/2.html#sec-2_3",
    "href": "chapter_2/2.html#sec-2_3",
    "title": "2  描述统计",
    "section": "2.3 对数据集进行汇总",
    "text": "2.3 对数据集进行汇总\n如今的实验涉及到的数据规模通常比较大。例如，为了了解某些行为习惯对健康的影响，1951 年，医学统计学家 R. Doll 和 A. B. Hill 向英国的所有医生发起了一项调查问卷，并且回收到了大约 40,000 份问卷。问卷的问题涉及年龄、饮食习惯和吸烟习惯。随后，Doll 和 Hill 对问卷回复者进行了为期 10 年的跟踪调查，并对其中的死亡人员的死因进行了监测。为了感知如此大量的数据，需要选择适当的方法对数据进行总结。在本节中，我们将介绍一些汇总数据的统计量，其中统计量是一个数值，数据集决定了其统计量的具体数值。\n\n\n\n\n\n\nThe British Doctors’ Study (1951–2001)\n\n\n\n1951 年，R. Doll 和 A. B. Hill 向英国的 6 万名医生发出调查问卷，并跟踪他们的吸烟情况和健康情况。根据跟踪情况，Doll 和 Hill 提交了两份报告（统称为英国医生研究）：1954 年提交的 The Mortality of Doctors in Relation to Their Smoking Habits 和 1956 年提交的 Lung Cancer and Other Causes of Death in Relation to Smoking。报告中公布了吸烟与疾病发病率的确凿科学证据，报告一经发布就震惊了世界，就连 Doll 本人也吓得戒掉了自己的重度烟瘾。\n针对英国医生的跟踪调查一直持续到 2001 年，当时参与问卷的大多数参与者已经故去，并且还在世的最年轻的参与者也已经七十多岁了。在近 50 年的研究中，研究人员公布了多项报告，这些报告强化了公众对吸烟会导致呼吸道疾病和心血管疾病的认知。\n关于这项研究的内容可以参阅：The British Doctors’ Study (1951–2001)。\n\n\n\n2.3.1 样本均值，样本中位数和样本众数\n在这一节中，我们将介绍一些用于描述数据集中心（center）的统计量。首先，假设我们有一个由 \\(n\\) 个数据构成的数据集：\\(x_1，x_2，...，x_n\\) 。这 \\(n\\) 个数的算术平均数（arithmetic average）就是样本均值（sample mean）。\n\n定义 2.1 样本均值（sample mean） \\(\\overline{x}\\) 的定义如下：\n\\[\n\\overline{x} = \\frac{\\sum_{i=1}^{n}{x_i}}{n}\n\\tag{2.1}\\]\n\n如果 \\(a\\)，\\(b\\) 为常数，并且\n\\(y_i = ax_i+b, i\\in[1,n]\\)\n那么，数据集 \\(y_1,...,y_n\\) 的样本均值为：\n\\[\n\\begin{align}\n\\overline{y}&=\\frac{\\sum_{i=1}^{n}{ax_i+b}}{n} \\\\\n&= \\frac{\\sum_{i=1}^{n}{ax_i}}{n} + \\frac{\\sum_{i=1}^{n}{b}}{n} \\\\\n&= a\\overline{x}+b\n\\end{align}\n\\tag{2.2}\\]\n\n习题 2.1 2004 年至 2013 年，美国高尔夫球大师赛的获胜分数如下：\n\\(280, 278, 272, 276, 281, 279, 276, 281, 289, 280\\)\n请计算如上分数的 样本均值。\n\n\n解 2.1. 比起直接将这些分数相加，对于每个分数而言，先减去 280 以获得新值 \\(y_i = x_i - 280\\) 会更容易计算其样本均值：\n\\(0, −2, −8, −4, 1, −1, −4, 1, 9, 0\\)\n\n\\(y_i\\) 的算术平均数为 \\(-\\frac{8}{10}\\)，因此 \\(\\overline{y}=-\\frac{8}{10}\\)，所以 \\(\\overline{x}=\\overline{y}+280=279.2\\)。\n有时，我们想要确定一个用频率表来描述的数据集的样本均值，在频率表中存在 \\(k\\) 个不同的值 \\(v_1,...,v_k\\)，以及它们对应的频率 \\(f_1,...,f_k\\)。该数据集由 \\(n=\\sum_{i=1}^{k}{f_i}\\) 个值组成，其中值 \\(v_i\\) 出现 \\(f_i\\) 次，因此这 \\(n\\) 个数据的样本均值为：\n\\[\n\\overline{x}=\\sum_{i=1}^{k}{\\frac{v_if_i}{n}}\n\\tag{2.3}\\]\n对上述计算进行展开，得到：\n\\(\\overline{x}=\\frac{f_1}{n}{v_1} + \\frac{f_2}{n}{v_2} + ... + \\frac{f_k}{n}{v_k}\\)\n因此，样本均值是数据集中不同值的加权平均数，其中 \\(v_i\\) 的权重等于 \\(n\\) 个数据中值等于 \\(v_i\\) 的数据的占比。\n\n习题 2.2 如下的频率表给出了青少年交响乐团的成员年龄分布。\n\n\n代码\nlibrary(knitr)\n\ndf &lt;-data.frame(\n  Age = c(15, 16, 17, 18, 19, 20),\n  Frequency = c(2, 5, 11, 9, 14, 13)\n)\n\nkable(df, align = \"l\")\n\n\n\n\n\nAge\nFrequency\n\n\n\n\n15\n2\n\n\n16\n5\n\n\n17\n11\n\n\n18\n9\n\n\n19\n14\n\n\n20\n13\n\n\n\n\n\n计算该交响乐团中 54 位成员的年龄的样本均值。\n\n\n解 2.2. \\(\\overline{x} = (15·2 + 16·5 + 17·11 + 18·9 + 19·14 + 20·13) / 54 ≈ 18.24\\)\n\n另一个用于表示数据集中心的统计量是样本中位数（sample median），简单来说，中位数就是当数据集中的数据按递增顺序排列后，位于数据集中间的数。\n\n定义 2.2 把大小为 \\(n\\) 的数据集中的数据从小到大排序。如果 \\(n\\) 是奇数，则 样本中位数 就是第 \\(\\frac{(n + 1)}{2}\\) 个数；如果 \\(n\\) 是偶数，则 样本中位数 就是第 \\(\\frac{n}{2}\\) 个数和第 \\(\\frac{n}{2} + 1\\) 个数的平均值。\n\n因此，3 个数的样本中位数是其第 2 小的数；4 个数的样本中位数是第 2 小和第 3 小的数的平均值。\n\n习题 2.3 找出 习题 2.2 中的样本中位数。\n\n\n解 2.3. 由于有 54 个数，因此当数据按递增顺序排列后，样本中位数是第 27 个数和第 28 个数的平均值。因此，样本中位数是 18.5。\n\n样本均值和样本中位数都是描述数据集中心趋势的、非常有用的统计量。样本均值的计算会用到数据集中的所有数据，并且容易受到数据集中极端值（远远大于或小于数据集中大多数数据的数据）的影响。样本中位数的计算只会到数据集中的一个或两个数据，因此样本中位数不受数据集中的极端值的影响。样本均值更好还是样本中位数更好，取决于我们试图从数据中学习什么。\n\n如果政府有统一的个人所得税税率，并试图估计税收总额，那么可以使用居民收入的样本均值作为统计量指标。\n如果政府正在考虑建造保障房，并希望确定能够负担得起这种住房的居民人口比例，那么更好的方式则是使用样本中位数。\n\n\n习题 2.4 1972 年，Hoel, D. G. 发表了一篇论文 A representation of mor- tality data by competing risks。在这篇论文中，Hoel 首先让一组 5 周大的小白鼠接受 300rad 的辐射剂量，然后把这些小白鼠分成两组：第一组置于无菌环境中，第二组则置于常规的实验室环境。随后，Hoel 观察并记录这些小白鼠的生存天数。以下的茎叶图（茎以百天为单位）记录了因胸腺淋巴瘤死亡的小白鼠的数据：第一张图是生活在无菌条件下的小白鼠，第二张图是生活在普通实验室条件下的小白鼠。\n\n\n\n表 2.6: 不同环境下的小白鼠实验\n\n\n\n\n\n无菌环境下的小白鼠\n\n\nStem\nLeaf\n\n\n\n\n1\n58, 92, 93, 94, 95\n\n\n2\n02, 12, 15, 29, 30, 37, 40, 44, 47, 59\n\n\n3\n01, 01, 21, 37\n\n\n4\n15, 34, 44, 85, 96\n\n\n5\n29,37\n\n\n6\n24\n\n\n7\n07\n\n\n8\n00\n\n\n\n\n\n\n正常实验室环境下的小白鼠\n\n\nStem\nLeaf\n\n\n\n\n1\n59, 89, 91, 98\n\n\n2\n35, 45, 50, 56, 61, 65, 66, 80\n\n\n3\n43, 56, 83\n\n\n4\n03, 14, 28, 32\n\n\n\n\n\n\n\n\n计算两组小白鼠的生存时间的样本均值和样本中位数。\n\n\n解 2.4. 从茎叶图中可以清晰地看出，无菌环境下小白鼠的样本均值（344.07）大于常规实验室环境下小白鼠的样本均值（292.32）。另一方面，由于无菌环境下的小白鼠有 29 个数据值，所以其样本中位数是第 15-最大 的数据值，即 259。另一组小白鼠的样本中位数是第 10-最大 的数据值，即 265。因此，尽管第一组数据的样本均值大于第二组，但这两组数据的样本中位数却大致基本一致。其中的原因在于，第一组数据中大于 500 的 5 个数据对其样本均值的影响较大，但对其样本中位数的影响要小得多。事实上，如果把大于 500 的 5 个数据替换为任何其他五个大于或等于 259 的数据，其样本中位数将保持不变。从茎叶图来看，无菌环境可能延长了五只寿命最长的小白鼠的寿命，但无法确定无菌环境是否对其他小白鼠的寿命产生了什么别的影响。\n\n另一个用于表示数据集中心趋势的统计量是 样本众数（sample mode）。在数据集中，出现频率最高的值为 样本众数。如果出现频率最高的值有多个，那么所有出现频率最高的这些数值都是 样本众数。\n\n习题 2.5 以下的频率表为抛 40 次骰子获得的结果。\n\n\n代码\nlibrary(knitr)\n\ndf &lt;- data.frame(\n    Value = c(1, 2, 3, 4, 5, 6),\n    Frequency = c(9, 8, 5, 5, 6, 7)\n)\nkable(df, align = \"l\")\n\n\n\n\n\nValue\nFrequency\n\n\n\n\n1\n9\n\n\n2\n8\n\n\n3\n5\n\n\n4\n5\n\n\n5\n6\n\n\n6\n7\n\n\n\n\n\n\n计算其样本均值\n计算其样本中位数\n计算器样本众数\n\n\n\n解 2.5. \n\n样本均值为 \\(\\overline{x}=(9 + 16 + 15 + 20 + 30 + 42) / 40 = 3.05\\)\n样本中位数为 第 20-最小 和 第 21-最小 的平均数 3\n样本众数为 1\n\n\n\n\n2.3.2 样本方差和样本标准差\n虽然我们已经介绍了用于描述数据集中心趋势的统计量，但我们也对描述数据波动的统计量感兴趣。可以通过计算数据值与样本均值之间距离的平方的平均值来描述数据集中数据的波动，这就是样本方差（sample variance）。出于技术原因，在计算样本方差时，需要除以 \\(n-1\\) 而不是 \\(n\\)（\\(n\\) 是数据集的大小）。\n\n定义 2.3 对于数据集 \\({x_1,...,x_n}\\)，其 样本方差 \\(s^2\\) 的定义如下：\n\\[\ns^2 = \\frac{\\sum_{i=1}^{n}{(x_i-\\overline{x})^2}}{n - 1}\n\\tag{2.4}\\]\n\n\n习题 2.6 计算如下两个数据集的样本方差：\n\nA: 3, 4, 6, 7, 10\nB: -20, 5, 15, 24\n\n\n\n解 2.6. 对于 A 而言，其样本均值 \\(\\overline{x} = (3 + 4 + 6 + 7 + 10) / 5 = 6\\)，因此，其样本方差为： \\(s^2 = [(−3)^2 + (−2)^2 + 0^2 + 1^2 + 4^2] / 4 = 7.5\\)\n对于 B 而言，其样本均值也是 6，因此，其样本方差为： \\(s^2 = [(−26)^2 + (−1)^2 + 9^2 + (18)^2] / 3 ≈ 360.67\\)\n\n通过 Solution 2.6 可发现，虽然 A 和 B 的样本均值是一样的，但是 B 的样本方差远大于 A。\n在计算样本方差时，会经常用到如下的数学等式：\n\\[\n\\sum_{i=1}^{n}{(x_i-\\overline{x})^2} = \\sum_{i=1}^{n}{x_i^2} - n\\overline{x}^2\n\\tag{2.5}\\]\n式 2.5 的证明过程如下：\n\\[\n\\begin{align}  \n\\sum_{i=1}^{n}{(x_i-\\overline{x})^2} &= \\sum_{i=1}^{n}{(x_i^2 - 2x_i\\overline{x} + \\overline{x}^2)} \\\\\n&=\\sum_{i=1}^{n}{x_i^2} - 2\\overline{x}\\sum_{i=1}^{n}{x_i} + \\sum_{i=1}^{n}{\\overline{x}^2} \\\\\n&=\\sum_{i=1}^{n}{x_i^2} - 2n\\overline{x}^2 + n\\overline{x}^2 \\\\\n&=\\sum_{i=1}^{n}{x_i^2} - n\\overline{x}^2\n\\end{align}\n\\]\n如果 \\(y_i = ax_i + b\\)，\\(i = 1,...,n\\)，则 \\(\\overline{y} = a\\overline{x} + b\\)，因此：\n\\(\\sum_{i=1}^{n}{(y_i - \\overline{y})^2} = a^2\\sum_{i=1}^{n}{(x_i-\\overline{x})^2}\\)\n所以：\n\\[\ns_y^2 = a^2s_x^2\n\\tag{2.6}\\]\n换句话说，为数据集中的每个数据增加一个常数不会改变其样本方差；而让数据集中的每个数据乘以一个常数则会得到一个新的样本方差，新的样本方差等于原来的样本方差乘以该常数的平方。\n\n习题 2.7 下表给出了 1997 年至 2005 年间全球商业航空运输中导致人员死亡的事故数量。\n\n\n代码\nlibrary(knitr)\n\ndf &lt;- data.frame(\n    Year=seq(1997, 2005, by=1),\n    Accidents = c(25, 20, 21, 18, 13, 13, 7, 9, 18))\n\nkable(df, align=\"l\")\n\n\n\n\n\nYear\nAccidents\n\n\n\n\n1997\n25\n\n\n1998\n20\n\n\n1999\n21\n\n\n2000\n18\n\n\n2001\n13\n\n\n2002\n13\n\n\n2003\n7\n\n\n2004\n9\n\n\n2005\n18\n\n\n\n\n\n根据如上的数据，计算航工事故的样本方差。\n\n\n解 2.7. 将数据集中的数据都减去 18，我们得到一个新的数据集：\n\\(y = \\{7,2,3,0,−5,−5,−11,−9,0\\}\\)\n\\(\\overline{y} = \\sum_{i=1}^{9}{y_i} / 9 = -2\\)\n\\(\\sum_{i=1}^{9}{y_i^2} = 49 + 4 + 9 + 25 + 25 + 121 + 81 = 314\\)\n因为新的数据集的方差和原数据集是一样的，因此根据 式 2.5：\n\\(s^2 = \\frac{\\sum_{i=1}^{9}{y_i^2} - n\\overline{x}^2}{n - 1} = \\frac{314 - 9·4}{8} = 34.75\\)\n\n\n\n\n\n\n\n注记\n\n\n\n因为 \\(y_i = x_i - 20\\)，因此，根据 式 2.6， \\(y\\) 和 \\(x\\) 的方差是一样的。\n\n\n样本方差的平方根称之为 样本标准差（sample standard deviation）。\n\n定义 2.4 样本标准差 \\(s\\)的定义如下所示：\n\\[\ns = \\sqrt{\\frac{\\sum_{i=1}^{n}{(x_i-\\overline{x})^2}}{n - 1}}\n\\tag{2.7}\\]\n\n\n\n2.3.3 样本百分位数和箱线图\n简单来说，数据集的 样本\\(100p\\)-百分位数 是指小于或等于数据集中 \\(100p\\%\\) 的数据所对应的数据值，其中 \\(0 \\le p \\le 1\\)。\n\n定义 2.5 样本\\(100p\\)-百分位数 是数据集中的一个数据值，这个值满足至少 \\(100p\\%\\) 的数据小于或等于它，并且至少 \\(100(1-p)\\%\\) 的数据大于或等于它。如果存在两个数据值满足这个条件，那么该数据集的 样本\\(100p\\)-百分位数 是这两个值的算术平均数。\n\n为了确定大小为 \\(n\\) 的数据集的样本\\(100p\\)-百分位数，我们需要确定这样的数据值，以使得该值满足如下的条件：\n\n至少有 \\(np\\) 个数据小于或等于该值\n至少有 \\(n(1-p)\\) 个数据大于或等于该值\n\n为了计算样本\\(100p\\)-百分位数，首先要对数据集进行升序排列。\n\n如果 \\(np\\) 不是整数，那么唯一满足前述条件的数据值是数据从小到大排序后，位置大于 \\(np\\) 的最小整数所对应的值。例如，如果 \\(n=22\\)，\\(p=0.8\\)，那么我们需要一个数据值，使得至少有 17.6 个数据小于或等于它，并且至少有 4.4 个数据大于或等于它。显然，只有第 18 小的值同时满足这两个条件，这就是 样本80-百分位数。\n如果 \\(np\\) 是整数，那么很容易发现 \\(np\\) 和 \\(np+1\\) 这两个位置的数据都满足前述条件，因此样本 \\(100p\\)-百分位数就是这两个数据值的算术平均数。例如，如果我们想计算大小为 20 的数据集的 90-百分位数，那么第 18-小 和第 19-小 的值都会使得至少有 90% 的数据小于或等于它们，并且至少有 10% 的数据大于或等于它们。因此，90-百分位数是这两个值的平均数。\n\n\n习题 2.8 表 2.7 列出了 2006 年美国人口最多的 25 个城市的人口数。对于这组数据，找出：\n\n样本10-百分位数\n样本80-百分位数。\n\n\n\n\n代码\nlibrary(knitr)\ndf &lt;- read.table(\"../misc/US_population.csv\", header=TRUE, sep=\",\")\nkable(df, align=\"l\")\n\n\n\n\n表 2.7: 2006 年 7 月，美国 25 个最大城市的人口数据\n\n\n\n\n\n\nRank\nCity\nPopulation\n\n\n\n\n1\nNew York, NY\n8250567\n\n\n2\nLos Angeles, CA\n3849378\n\n\n3\nChicago, IL\n2833321\n\n\n4\nHouston, TX\n2144491\n\n\n5\nPhoenix, AR\n1512986\n\n\n6\nPhiladelphia, PA\n1448394\n\n\n7\nSan Antonio, TX\n1296682\n\n\n8\nSan Diego, CA\n1256951\n\n\n9\nDallas, TX\n1232940\n\n\n10\nSan Jose, CA\n929936\n\n\n11\nDetroit, MI\n918849\n\n\n12\nJacksonville, FL\n794555\n\n\n13\nIndianapolis, IN\n785597\n\n\n14\nSan Francisco, CA\n744041\n\n\n15\nColumbus, OH\n733203\n\n\n16\nAustin, TX\n709893\n\n\n17\nMemphis, TN\n670902\n\n\n18\nFort Worth, TX\n653320\n\n\n19\nBaltimore, MD\n640961\n\n\n20\nCharlotte, NC\n630478\n\n\n21\nEl Paso, TX\n609415\n\n\n22\nMilwaukee, WI\n602782\n\n\n23\nBoston, MA\n590763\n\n\n24\nSeattle, WA\n582454\n\n\n25\nWashington, DC\n581530\n\n\n\n\n\n\n\n\n\n解 2.8. \n\n因为样本的大小是 25，25·0.1 = 2.5，因此，样本10-百分位数就是样本第 3-小的数据，也就是 590763。\n因为 25·0.8 = 20，因此，样本80-百分位数是第 20-小和第 21-小的算术平均数，\\(\\frac{1512986 + 1448394}{2}\\)，也就是 1480690。\n\n\n样本50-百分位数，就是样本中位数。样本25-百分位数、样本50-百分位数、样本75-百分位数一起构成了样本四分位数（sample quartiles）。\n\n定义 2.6 样本25-百分位数称之为 第一四分位数（the first quartile），样本50-百分位数称之为 样本中位数 或 第二四分位数（the second quartile），样本75-百分位数称之为 第三四分位数（the third quartile）\n\n\n\n\n\n\n\n注记\n\n\n\n有时，也会把样本四分位数称为下四分位数和上四分位数：下四分位数（25-百分位数），中位数（50-百分位数），上四分位数（75-百分位数）。\n\n\n四分位数把数据集分为四个部分，大约 25% 的数据小于第一四分位数，25% 的数据位于第一四分位数和第二四分位数之间，25% 的数据位于第二四分位数和第三四分位数之间，剩余的 25% 的数据大于第三四分位数。\n\n习题 2.9 我们使用分贝（dB）来测量噪音。听力正常的人在安静环境下能听到的最弱的声音大约是 1dB，窃窃私语时的声音大约是 30dB，人们正常交谈时的声音大约是 70dB，收音机的音量大约是 100dB。当声音超过 120 dB 时，耳朵就开始感知到不适了。\n曼哈顿中央车站外测量到的 36 个不同时间点的噪音水平如下所示：\n\n\n曼哈顿中央车站噪音水平\n\n82, 89, 94, 110, 74, 122, 112, 95, 100, 78, 65, 60, 90, 83, 87, 75, 114, 85 69, 94, 124, 115, 107, 88, 97, 74, 72, 68, 83, 91, 90, 102, 77, 125, 108, 65\n\n计算如上数据的四分位数。\n\n\n解 2.9. 因为 \\(n = 36\\)，所以四分位数对应的 \\(np\\) 均为整数，因此其对应的四分位数值为第 \\(np\\)-小和第 \\((np+1)\\)-小的平均数。\n\n第一四分位数（\\(p=0.25\\)）：第 9-小和第 10-小的平均值，也就是 74.5。\n第二四分位数（\\(p=0.5\\)）：第 18-小和第 19-小的平均值，也就是 89.5。\n第三四分位数（\\(p=0.75\\)）：第 27-小和第 28-小的平均值，也就是 104.5。\n\n\n我们经常用箱线图（box plot）绘制数据集的汇总统计量。\n\n在横坐标轴上绘制一条从最小值到最大值的直线段。\n在这条直线上叠加一个 “箱子”，该箱子从第一四分位数开始一直延伸到第三四分位数，并用垂直线表示第二四分位数。\n\n例如，表 2.1 中给出的 42 个起薪数据覆盖了从最低值 57000$ 到最高值 70000$ 之间的数。第一四分位数（第 11-小的值）是 60000\\(，第二四分位数（第 21-小和第 22-小的平均值）是 61500\\)，第三四分位数（第 32-小的值）是 64000$。该数据集的箱线图如 图 2.7 所示。\n\n\n代码\nlibrary(ggplot2)\nss &lt;- c(57, 58, 59, 60, 61, 62, 63, 64, 66, 67, 70)\nf &lt;- c(4, 1, 3, 5, 8, 10, 0, 5, 2, 3, 1)\ndf &lt;- data.frame(value=rep(ss, f))\nggplot(df, aes(x=value, y=\"\")) +\n  geom_boxplot() + \n  labs(x=\"Starting Salary\", y=\"\")\n\n\n\n\n\n\n\n\n图 2.7: 起薪线图\n\n\n\n\n\n\n\n\n\n\n\n注记\n\n\n\n图 2.7 中的箱线图和文中对各四分位数的计算并不一致，这主要是因为该图使用 R 的 ggplot2 包绘制，对于该包而言，在绘制箱线图时，会剔除数据中可能的离群点（\\(\\pm 1.5IQR\\)），离群点在图中显示为一个点。\n\n\n箱线图上直线的长度等于数据集中的最大值减去数据集中的最小值，称为数据范围。箱线图中箱子的长度等于第三四分位数减去第一四分位数，称为四分位距（IQR: inter quaritle range）。",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>描述统计</span>"
    ]
  },
  {
    "objectID": "chapter_2/2.html#sec-2_4",
    "href": "chapter_2/2.html#sec-2_4",
    "title": "2  描述统计",
    "section": "2.4 切比雪夫不等式",
    "text": "2.4 切比雪夫不等式\n设 \\(\\overline {x}\\) 和 \\(s\\) 分别是数据集的样本均值和样本标准差。假设 \\(s &gt; 0\\)，切比雪夫不等式表明，对于 \\(\\forall k \\ge 1\\) ，至少有 \\((100 \\cdot (1−\\frac {1}{k^2})) \\%\\) 的数据位于 \\([ \\overline {x} − ks, \\overline {x} + ks]\\) 的区间内。\n\n令 \\(k = \\frac {3}{2}\\)，根据切比雪夫不等式，至少有 \\(55.56\\%\\) 的数据会位于 \\(\\overline {x} \\pm 1.5s\\) 的范围内。\n令 \\(k=2\\)，则至少有 \\(75\\%\\) 的数据位于 \\(\\overline {x} \\pm 2s\\) 的范围内。\n令 \\(k=3\\)，则至少有 \\(88.9\\%\\) 的数据位于 \\(\\overline {x} \\pm 3s\\) 的范围内。\n\n\n2.4.1 切比雪夫不等式\n对于数据集 \\(\\{x_1,...,x_n\\}\\) 而言，令 \\(\\overline{x}\\) 和 \\(s\\) 分别是其样本均值和样本标准差，其中 \\(s \\gt 0\\)。\n令 \\(S_k=\\{|x_i - \\overline{x}| \\lt ks, i \\in [1, n]\\}\\)，即 \\(S_k\\) 为距离 \\(\\overline{x}\\) \\(k\\) 个标准差以内的数据构成的集合。\n令 \\(|S_k|\\) 为集合 \\(S_k\\) 中的元素个数。\n则有：\n\\[\n\\frac{|S_k|}{n} \\ge {1 - \\frac{n-1}{nk^2}} \\gt {1 - \\frac{1}{k^2}}, \\ \\ \\forall k \\ge 1\n\\tag{2.8}\\]\n式 2.8 就是切比雪夫不等式，其证明过程如下：\n\\[\n\\begin{align}\n(n-1)s^2 &= \\sum_{i=1}^{n}{(x_i-\\overline{x})^2} \\\\\n&= \\sum_{i \\in S_k}{{(x_i-\\overline{x})^2}} + \\sum_{i \\notin S_k}{{(x_i-\\overline{x})^2}} \\\\\n& \\ge \\sum_{i \\notin S_k}{{(x_i-\\overline{x})^2}}\n\\end{align}\n\\]\n\\[\n\\begin{align}\n&\\because \\forall i \\in S_k, \\ \\ |x_i - \\overline{x}| \\lt ks, \\\\\n&\\therefore \\forall i \\notin S_k, \\ \\ |x_i - \\overline{x}| \\ge ks, \\\\\n&\\therefore \\sum_{i \\notin S_k}{{(x_i-\\overline{x})^2}} \\ge \\sum_{i \\notin S_k}{k^2s^2} \\\\\n&=k^2s^2(n-|S_k|)\n\\end{align}\n\\]\n\\[\n\\therefore (n-1)s^2 \\ge k^2s^2(n-|S_k|)\n\\tag{2.9}\\]\n当 \\(s^2 \\ne 0\\) 时，对于 式 2.9 的等式两边都除以 \\(nk^2s^2\\)，得到：\n\\[\n\\begin{align}\n&\\frac{n-1}{nk^2} \\ge \\frac{n-|S_k|}{n}, \\\\\n&\\therefore \\frac{n-1}{nk^2} \\ge 1-\\frac{|S_k|}{n} \\\\\n&\\therefore \\frac{|S_k|}{n} \\ge 1-\\frac{n}{nk^2}+\\frac{1}{nk^2} \\\\\n&\\therefore \\frac{|S_k|}{n} \\ge 1-\\frac{1}{k^2}\n\\end{align}\n\\]\n由于切比雪夫不等式的通用性，对于给定的数据集，实际位于 \\([\\overline{x}-ks, \\overline{x}+ks]\\) 区间内的数据的百分比可能比切比雪夫不等式给出的下限要大一点。\n\n例 2.4 表 2.8 给出了 2013 年 6 月美国最畅销的 10 款汽车。根据数据可知：\\(\\overline{x}=35.33\\)，\\(s=11.86\\)，当 \\(k=\\frac{3}{2}\\) 时，至少有 55.55%（\\(100(1-\\frac{1}{k^2})\\%\\)）的数据位于 [17.54, 53.12]（\\([\\overline{x}-ks, \\overline{x}+ks]\\)）区间内。而实际上，对于表中的数据而言，有 \\(90\\%\\) 的数据落在了这个区间。\n\n\n\n代码\nlibrary(knitr)\ndf &lt;- read.table(\"../misc/US_cars.csv\", header=TRUE, sep=\",\")\nkable(df, align=\"l\")\n\n\n\n\n表 2.8: 2013 年 6 月美国最畅销的 10 款汽车\n\n\n\n\n\n\nRank\nModel\nSales.Volume.in.thousands.of.vehicles.\n\n\n\n\n1\nFord F Series\n68.0\n\n\n2\nChevrolet Silverado\n43.3\n\n\n3\nToyota Camry\n35.9\n\n\n4\nChevrolet Cruze\n32.9\n\n\n5\nHonda Accord\n31.7\n\n\n6\nHonda Civic\n29.7\n\n\n7\nDodge Ram\n29.6\n\n\n8\nFord Escape\n28.7\n\n\n9\nNissan Altima\n26.9\n\n\n10\nHonda CR-V\n26.6\n\n\n\n\n\n\n\n\n对于数据集 \\(\\{x_1,...,x_n\\}\\) 而言，令 \\(\\overline{x}\\) 和 \\(s\\) 分别是其样本均值和样本标准差，其中 \\(s \\gt 0\\)。那么，\\(\\{x_i - \\overline{x} \\ge ks, i \\in [1, n]\\}\\) 的数据占比是多少呢？\n假设令 \\(N_k=\\{x_i - \\overline{x} \\ge ks, i \\in [1, n]\\}\\)，我们是否可以计算出 \\(\\frac{|N_k|}{n}\\)？\n当然！！！\n根据 式 2.8，我们可以得到：\n\\[\n\\frac{|N_k|}{n} \\le \\frac{1}{k^2}\n\\tag{2.10}\\]\n不过，利用接下来要介绍的单边切比雪夫不等式，我们可以得到一个更为精准的数据。\n\n\n2.4.2 单边切比雪夫不等式\n对于数据集 \\(\\{x_1,...,x_n\\}\\) 而言，令 \\(\\overline{x}\\) 和 \\(s\\) 分别是其样本均值和样本标准差，其中 \\(s \\gt 0\\)。\n令 \\(N_k=\\{x_i - \\overline{x} \\ge ks, i \\in [1, n]\\}\\)， \\(|N_k|\\) 为集合 \\(N_k\\) 中的元素个数，则有：\n\\[\n\\frac{|N_k|}{n} \\le \\frac{1}{1+k^2}\n\\tag{2.11}\\]\n我们称 式 2.11 为单边切比雪夫不等式（one-sided Chebyshev inequality），其证明过程如下：\n令 \\(y_i=x_i-\\overline{x}\\)，\\(i \\in [1,n]\\)，对于 \\(\\forall b \\gt 0\\)，有：\n\\[\n\\begin{align}\n\\sum_{i=1}^{n}{(y_i+b)^2} &\\ge \\sum_{i:y_i \\ge ks}{(y_i+b)^2} \\\\\n& \\ge \\sum_{i:y_i \\ge ks}{(ks+b)^2} \\\\\n& = |N_k| \\cdot (ks+b)^2\n\\end{align}\n\\tag{2.12}\\]\n因为 \\(|N_k|\\) 为 \\(y_i \\ge ks\\) 的元素个数，\\(ks\\) 和 \\(b\\) 都是正数，因此有： \\[\n\\begin{align}\n\\sum_{i=1}^{n}{(y_i+b)^2} &= \\sum_{i=1}^{n}{(y_i^2 + 2by_i + b^2)} \\\\\n&= \\sum_{i=1}^{n}{y_i^2} + 2b\\sum_{i=1}^{n}{y_i} + nb^2\n\\end{align}\n\\]\n\\[\n\\begin{align}\n&\\because y_i = x_i - \\overline{x} \\\\\n&\\therefore \\sum_{i=1}^{n}{y_i} = \\sum_{i=1}^{n}{(x_i - \\overline{x})} = \\sum_{i=1}^{n}{x_i} - n\\overline{x} = 0\n\\end{align}\n\\]\n所以有：\n\\[\n\\begin{align}\n\\sum_{i=1}^{n}{(y_i+b)^2} &= \\sum_{i=1}^{n}{y_i^2} + nb^2 \\\\\n&=(n-1)s^2 + nb^2\n\\end{align}\n\\tag{2.13}\\]\n根据 式 2.12 和 式 2.13，有：\n\\[\n(n-1)s^2 + nb^2 \\ge |N_k| \\cdot (ks+b)^2\n\\]\n进而得到：\n\\[\n\\frac{|N_k|}{n} \\le \\frac{s^2 + b^2}{(ks + b)^2}\n\\tag{2.14}\\]\n因为 \\(b\\) 是任意大于 0 的数，因此我们可以令：\n\\[\nb=\\frac{s}{k}\n\\tag{2.15}\\]\n把 式 2.15 代入 式 2.14 得到 式 2.11：\n\\[\n\\frac{|N_k|}{n} \\le \\frac{1}{k^2 + 1}\n\\]\n根据 式 2.10，我们可以发现，在一个数据集中，超过样本均值的 2 倍标准差的数据最多占比 25%。但是利用 式 2.11 所示的单边切比雪夫不等式，我们可以将这个比例精确到最多占比 20%。",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>描述统计</span>"
    ]
  },
  {
    "objectID": "chapter_2/2.html#sec-2_5",
    "href": "chapter_2/2.html#sec-2_5",
    "title": "2  描述统计",
    "section": "2.5 正态分布数据集",
    "text": "2.5 正态分布数据集\n我们在实践中观察到的许多大数据集都具有形状相似的直方图。通常，这些直方图在样本中位数处达到峰值，然后在中位数的两侧以钟形对称的形式下降。我们称这样的数据集为正态数据集，称其直方图为正态直方图。图 2.8 (a) 展示了一个正态数据集的直方图。\n如果一个数据集的直方图接近正态直方图，我们说该数据集近似正态分布。例如，我们会说图 图 2.8 (b) 给出的直方图来自一个近似正态的数据集，而图 图 2.8 (c) 和图 图 2.8 (d) 给出的直方图则不是近似正态的数据集（因为每个直方图都太不对称）。与样本中位数不是近似对称的任何数据集都是偏态（skewed）分布。如果数据集的长尾在中位数右侧，则称为 “右偏”；如果数据集的长尾在中位数左侧，则称为 “左偏”。因此，图 图 2.8 (c) 中的数据集为左偏分布，而 图 2.8 (d) 中的数据集为右偏分布。\n\n代码\nlibrary(ggplot2)\n\nx &lt;- seq(1, 19)\ny &lt;- 100 - 10 * abs(x - mean(x))\ndf &lt;- data.frame(value=rep(x, y))\n\nggplot(df, aes(x=value)) +\n  geom_histogram(bins=19)\n\n\nx &lt;- seq(1, 19)\ny &lt;- 100 - 10 * abs(x - mean(x))\nvalue &lt;- rep(x, y)\nvalue &lt;- value[value != 17]\ndf &lt;- data.frame(value=value)\n\nggplot(df, aes(x=value)) +\n  geom_histogram(bins=19)\n\ndf &lt;- data.frame(value=rbeta(10000, 5, 2))\nggplot(df, aes(x=value)) +\n  geom_histogram(bins=19)\n\ndf &lt;- data.frame(value=rbeta(10000, 1, 5))\nggplot(df, aes(x=value)) +\n  geom_histogram(bins=19)\n\n\n\n\n\n\n\n\n\n\n\n\n(a) 正态分布\n\n\n\n\n\n\n\n\n\n\n\n(b) 近似正态分布\n\n\n\n\n\n\n\n\n\n\n\n\n\n(c) 左偏分布\n\n\n\n\n\n\n\n\n\n\n\n(d) 右偏分布\n\n\n\n\n\n\n\n图 2.8: 不同数据集的直方图\n\n\n\n从正态直方图的对称性可以看出，一个近似正态分布的数据集，其样本均值和样本中位数大致相等。\n假设 \\(\\overline{x}\\) 和 \\(s\\) 分别是近似正态分布数据集的样本均值和样本标准差。经验法则（empirical rule）指定了观察到的数据位于 \\(s\\)、\\(2s\\)、\\(3s\\) 个样本均值 \\(x\\overline{x}\\) 内的大致比例。\n\n2.5.1 经验法则\n如果一个数据集是一个近似正态分布的数据集，其样本均值和样本标准差分别是 \\(\\overline{x}\\) 和 \\(s\\)，那么有如下的正确结论：\n\n大约有 68% 的观察数据会位于 \\(\\overline{x} \\pm s\\) 区间内\n大约有 95% 的观察数据会位于 \\(\\overline{x} \\pm 2s\\) 区间内\n大约有 99% 的观察数据会位于 \\(\\overline{x} \\pm 3s\\) 区间内\n\n\n如下的数据是工业工程专业的学生在统计学考试中的分数：\n43, 46, 52, 55, 55, 56, 58, 60, 62, 63, 64, 66, 66, 72, 74, 74, 75, 77, 77, 78, 83, 85, 85, 87, 88, 90, 91, 94\n通过其茎叶图，我们会发现如上数据的直方图近似正态分布。接下来我们用这份数据来评估一下经验法则。\n\n\n代码\nscores &lt;- c(43, 46, 52, 55, 55, 56, 58, 60, 62, 63, 64, 66, 66, 72, 74, 74, 75, 77, 77, 78, 83, 85, 85, 87, 88, 90, 91, 94)\nstem(scores)\n\n\n\n  The decimal point is 1 digit(s) to the right of the |\n\n  4 | 36\n  5 | 25568\n  6 | 023466\n  7 | 2445778\n  8 | 35578\n  9 | 014\n\n\n\n\n解 2.10. 计算得到数据集的样本均值和样本方差：\\(\\overline{x} \\thickapprox 70.571\\)，\\(s \\thickapprox 14.354\\)。因此，根据经验法则：\n\n有 68% 的数据会位于 56.2~84.9 之间，但是实际上，数据集中只有 \\(\\frac{15}{28} \\%\\) 也就是 53.6% 的数据位于56.2~84.9 之间。\n有 95% 的数据会位于 41.68~99.28 之间，但是实际上，数据集中所有的数据都位于 41.68~99.28 之间。\n\n\n如果一个总体是由多个不同类型的子总体而构成，那么从这个总体中抽样得到的数据集通常不是正态分布。这种数据集的直方图通常看起来像是多个正态直方图的组合或叠加，因此在这种直方图上通常会有多个局部峰值。由于这些局部峰值处的直方图比其邻近值更高，因此这些峰值类似于众数。如 图 2.9 所示，在直方图中，具有两个局部峰值的数据集称之为双峰分布。\n\n\n代码\nsamples1 &lt;- rnorm(10000, mean=1, sd=1)  \nsamples2 &lt;- rnorm(10000, mean=5, sd=1)\ndf &lt;- data.frame(value=c(samples1, samples2))\n\nggplot(df, aes(x=value)) +\n    geom_histogram()\n\n\n\n\n\n\n\n\n图 2.9: 双峰分布直方图",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>描述统计</span>"
    ]
  },
  {
    "objectID": "chapter_2/2.html#sec-2_6",
    "href": "chapter_2/2.html#sec-2_6",
    "title": "2  描述统计",
    "section": "2.6 成对数据集和样本相关系数",
    "text": "2.6 成对数据集和样本相关系数\n我们经常关注由成对数据值构成的数据集，这些数据集中的成对数据之间存在着某种关系。在这样的数据集中，如果每个成对数据都有一个 \\(x\\) 值和一个 \\(y\\) 值，那么我们就用 \\((x_i, y_i)\\) 表示第 \\(i\\) 个数据。例如，为了确定每天中午的温度（以摄氏度为单位）与当天生产的不合格零件数量之间的关系，一家公司记录了 表 2.9 中的数据。对于这个数据集，\\(x_i\\) 代表第 \\(i\\) 天中午的摄氏温度，\\(y_i\\) 代表第 \\(i\\) 天生产的不合格零件数量。\n\n\n代码\nlibrary(knitr)\ndf &lt;- read.table(\"../misc/temp_defect.csv\", header=TRUE, sep=\",\")\nkable(df, align=\"l\")\n\n\n\n\n表 2.9: 天气温度和产品缺陷量数据\n\n\n\n\n\n\nDay\nTemperature\nNumber.of.Defects\n\n\n\n\n1\n24.2\n25\n\n\n2\n22.7\n31\n\n\n3\n30.5\n36\n\n\n4\n28.6\n33\n\n\n5\n25.5\n19\n\n\n6\n32.0\n24\n\n\n7\n28.6\n27\n\n\n8\n26.5\n25\n\n\n9\n25.3\n16\n\n\n10\n26.0\n14\n\n\n11\n24.4\n22\n\n\n12\n24.8\n23\n\n\n13\n20.6\n20\n\n\n14\n25.1\n25\n\n\n15\n21.4\n25\n\n\n16\n23.7\n23\n\n\n17\n23.9\n27\n\n\n18\n25.2\n30\n\n\n19\n27.4\n33\n\n\n20\n28.3\n32\n\n\n21\n28.8\n35\n\n\n22\n26.6\n24\n\n\n\n\n\n\n\n\n在二维图上绘制成对数据集中的数据是一种表示成对数据集的有效方法，其中 \\(x\\) 轴代表成对数据的 \\(x\\) 值，\\(y\\) 轴代表成对数据的 \\(y\\) 值，这样的图称之为散点图（scatter diagram）。图 2.10 为 表 2.9 中数据的散点图。\n\n\n代码\nlibrary(ggplot2)\ndf &lt;- read.table(\"../misc/temp_defect.csv\", header=TRUE, sep=\",\")\nggplot(df, aes(x=Temperature, y=Number.of.Defects)) + \n    geom_point()\n\n\n\n\n\n\n\n\n图 2.10: 天气温度和产品缺陷量散点图\n\n\n\n\n\n对于成对数据集而言，一个有趣问题是，比较大的 \\(x\\) 值是否倾向于与比较大的 \\(y\\) 值配对，小的 \\(x\\) 值是否与小的 \\(y\\) 值配对？如果情况并非如此，那么我们可能会质疑其中一个变量的较大的值是否倾向于与另一个变量的较小的值配对。通常，可以通过散点图来大致回答这些问题。例如，图 2.10 表明，高温和缺陷产品数量高之间似乎存在某种联系。为了对成对数据之间的这种关系进行定量度量，我们需要开发一个新的统计量，以衡量 \\(x\\) 值与 \\(y\\) 值之间的配对程度。\n假设数据集由 \\(\\{(x_i, y_i)\\}\\) 组成，其中 \\(i = 1,...,n\\)，\\(\\overline{x}\\) 和 \\(\\overline{y}\\) 分别是 \\(x\\) 和 \\(y\\) 的样本均值。对于第 \\(i\\) 对数据，使用 \\(x_i - \\overline{x}\\) 作为 \\(x_i\\) 与其样本均值的偏差，使用 \\(y_i - \\overline{y}\\) 作为 \\(y_i\\) 与其样本均值的偏差。如果 \\(x_i\\) 的值比较大，那么 \\(x_i \\gt \\overline{x}\\)，所以 \\(x_i - \\overline{x} \\gt 0\\)。类似地， 如果 \\(x_i\\) 的值比较小，那么 \\(x_i \\lt \\overline{x}\\)，所以 \\(x_i - \\overline{x} \\lt 0\\)。对于 \\(y_i\\) 而言，同样如此。于是，我们可以得出以下结论：\n\n\n\n\n\n\n重要\n\n\n\n当 \\(x\\) 的较大值趋向于和 \\(y\\) 的较大值相关联，\\(x\\) 的较小值趋向于和 \\(y\\) 的较小值相关联时，则 \\(x_i - \\overline{x}\\) 和 \\(y_i- \\overline{y}\\) 的符号（无论正负）都将趋于相同。\n\n\n如果 \\(x_i - \\overline{x}\\) 和 \\(y_i - \\overline{y}\\) 的符号相同（无论正负），那么它们的乘积 \\((x_i - \\overline{x})(\\)y_i - )$ 是正数。因此，当 \\(x\\) 的较大值趋向于和 \\(y\\) 的较大值相关联，\\(x\\) 的较小值趋向于和 \\(y\\) 的较小值相关联时，\\(\\sum_{i=1}^{n}{(x_i - \\overline{x})(y_i - \\overline{y})}\\) 将趋向于一个较大的正数。事实上，当较大（小）的 \\(x\\) 与较大（小）的 \\(y\\) 配对时，不但所有的 \\((x_i - \\overline{x})(y_i - \\overline{y})\\) 的符号都是正的，而且当 \\((x_i - \\overline{x})\\) 的最大值与 \\((y_i - \\overline{y})\\) 的最大值配对、其对应的次大值配对、依次类推对 \\((x_i - \\overline{x})\\) 和 \\((y_i - \\overline{y})\\) 配对时，\\(\\sum_{i=1}^{n}{(x_i - \\overline{x})(y_i - \\overline{y})}\\) 将获得最大值。同理，当 \\(x_i\\) 的较大值倾向于和 \\(y_i\\) 的较小值配对时，\\(x_i - \\overline{x}\\) 和 \\(y_i - \\overline{y}\\) 的符号相反，所以 \\(\\sum_{i=1}^{n}{(x_i - \\overline{x})(y_i - \\overline{y})}\\) 将是一个较大的负数。\n\n定义 2.7 对于成对数据集 \\(\\{(x_i, y_i), i = 1,...,n\\}\\)，\\(s_x\\) 和 \\(s_y\\) 分别表示 \\(x\\) 和 \\(y\\) 的样本标准差，则 \\((x_i, y_i)\\) 的样本相关系数（sample correlation coefficient）\\(r\\) 的定义如下：\n\\[\n\\begin{align}\nr&=\\frac{\\sum_{i=1}^{n}{(x_i-\\overline{x})(y_i-\\overline{y})}}{(n-1)s_xs_y} \\\\\n&=\\frac{\\sum_{i=1}^{n}{(x_i-\\overline{x})(y_i-\\overline{y})}}{\\sqrt{\\sum_{i=1}^{n}{(x_i-\\overline{x})^2} \\cdot \\sum_{i=1}^{n}{(y_i-\\overline{y})^2}}}\n\\end{align}\n\\tag{2.16}\\]\n\n当 \\(r \\gt 0\\) 时，成对数据集中的样本成正相关（positively correlated），当 \\(r \\lt 0\\) 时，样本成负相关（negatively correlated）。\n成对数据集的样本相关系数 \\(r\\) 具备如下的特性：\n\n\\(-1 \\le r \\le 1\\)\n\\(\\forall a&gt;0\\)， 如果 \\(y_i = ax_i + b\\)，则 \\(r=1\\)\n\\(\\forall a&lt;0\\)， 如果 \\(y_i = ax_i + b\\)，则 \\(r=-1\\)\n\\(\\forall a\\) 和 \\(\\forall c\\)，且 \\(a \\cdot c \\gt 0\\)，如果 \\(r\\) 是 \\(\\{(x_i, y_i)\\}\\) 的相关系数，则 \\(r\\) 也是 \\(\\{(ax_i + b, cy_i + d)\\}\\) 的相关系数\n\n\n特性 1 说明样本相关系数 \\(r\\) 总是介于 -1 和 +1 之间。\n特性 2 说明当成对数据之间存在线性关系并且 \\(x\\) 的较大（小）值趋向于和 \\(y\\) 的较大（小）值相关联时，\\(r\\) 等于 +1。\n特性 3 说明当成对数据之间存在线性关系并且 \\(x\\) 的较大（小）值趋向于和 \\(y\\) 的较小（大）值相关联时，\\(r\\) 等于 -1。\n特性 4 指出，当给每个 \\(x\\)（或 \\(y\\)） 变量加上一个常数，或将每个 \\(x\\)（或 \\(y\\)） 变量都乘以一个正数时，\\(r\\) 的值保持不变。特性 4 意味着 \\(r\\) 不依赖于测量数据的单位。例如，无论身高数据的测量单位是英尺还是英寸，也无论体重数据的测量单位是磅还是千克，一个人的身高和体重之间的样本相关系数都是一致的。此外，如果成对数据中的一个值是温度，那么无论该值是华氏温度还是摄氏温度，样本相关系数都是相同的。\n\n样本相关系数 \\(r\\) 的绝对值 \\(|r|\\) 用于表示 \\(x\\) 和 \\(y\\) 之间线性关系的强度。\\(|r| = 1\\) 意味着完美的线性关系，也就是说，可以用一条直线穿过 \\(\\{(xi,yi), i = 1, ..., n\\}\\) 中的所有数据点 。\\(|r| \\thickapprox 0.8\\) 意味着相对较强的线性关系，此时虽然没有任何一条直线可以穿过所有的数据点，但存在一条直线 “接近” 穿过所有的数据点。\\(|r| \\thickapprox 0.3\\) 意味着成对数据之间的线性关系相对较弱。\n\\(r\\) 的符号给定了相关性的方向。当较小的 \\(y\\) 倾向于和较小的 \\(x\\) 配对，而较大的 \\(y\\) 倾向于和较大的 \\(x\\) 配对时，对于这样的线性关系，\\(r \\gt 0\\)。而当较小的 \\(y\\) 倾向于和较大的 \\(x\\) 配对，而较大的 \\(y\\) 倾向于和较小的 \\(x\\) 配对时，对于这样的线性关系，\\(r \\lt 0\\)。图 2.11 显示了具有不同 \\(r\\) 值的数据集的散点图。\n\n代码\nlibrary(MASS)  \nlibrary(ggplot2)\n\n# 设置你想要的相关系数  \nrho &lt;- -0.5  # 例如，我们想要的相关系数是0.5  \n\n# 创建一个协方差矩阵。假设两个变量的方差都是1（对于标准化数据）  \n# 协方差矩阵的对角线元素是方差，非对角线元素是协方差（与相关系数相关）  \nSigma &lt;- matrix(c(1, rho, rho, 1), nrow = 2)  \ndata &lt;- mvrnorm(n = 100, mu = c(0, 0), Sigma = Sigma)\ndf1 &lt;- as.data.frame(data)\ncolnames(df1) &lt;- c(\"X\", \"Y\")\n\nrho &lt;- 0   \nSigma &lt;- matrix(c(1, rho, rho, 1), nrow = 2)  \ndata &lt;- mvrnorm(n = 100, mu = c(0, 0), Sigma = Sigma)\ndf2 &lt;- as.data.frame(data)\ncolnames(df2) &lt;- c(\"X\", \"Y\")\n\nrho &lt;- 0.9   \nSigma &lt;- matrix(c(1, rho, rho, 1), nrow = 2)  \ndata &lt;- mvrnorm(n = 100, mu = c(0, 0), Sigma = Sigma)\ndf3 &lt;- as.data.frame(data)\ncolnames(df3) &lt;- c(\"X\", \"Y\")\n\nrho &lt;- 1\nSigma &lt;- matrix(c(1, rho, rho, 1), nrow = 2)  \ndata &lt;- mvrnorm(n = 100, mu = c(0, 0), Sigma = Sigma)\ndf4 &lt;- as.data.frame(data)\ncolnames(df4) &lt;- c(\"X\", \"Y\")\n\nggplot(df1, aes(x=X, y=Y)) +\n    geom_point()\n\nggplot(df2, aes(x=X, y=Y)) +\n    geom_point()\n\nggplot(df3, aes(x=X, y=Y)) +\n    geom_point()\n\nggplot(df4, aes(x=X, y=Y)) +\n    geom_point()\n\n\n\n\n\n\n\n\n\n\n\n\n(a) r = -0.5\n\n\n\n\n\n\n\n\n\n\n\n(b) r = 0\n\n\n\n\n\n\n\n\n\n\n\n\n\n(c) r = 0.9\n\n\n\n\n\n\n\n\n\n\n\n(d) r = 1\n\n\n\n\n\n\n\n图 2.11: 不同样本相关系数的数据散点图\n\n\n\n\n习题 2.10 计算 表 2.9 所示的样本相关系数。\n\n\n解 2.11. \n\n\n代码\ndf &lt;- read.table(\"../misc/temp_defect.csv\", header=TRUE, sep=\",\")\nr &lt;- cor(df$Temperature, df$Number.of.Defects)\nprint(r)\n\n\n[1] 0.418944\n\n\n这意味着气温和当天的缺陷产品数量之间存在着弱正相关性。\n\n\n例 2.5 以下数据表给出了 10 个学生的静息心率（每分钟心跳次数）和其对应的受教育年限。图 2.12 展现了这些数据的散点图。这些数据的样本相关系数 \\(r=−0.7638\\)。负相关系数表明，对于这个数据集来说，高静息心率与低受教育年限紧密相关，而低静息心率则与高受教育年限紧密相关。\n\n\n代码\nlibrary(knitr)\nperson &lt;- seq(1:10)\nYears &lt;- c(12, 16, 13, 18, 19, 12, 18, 19, 12, 14)\nBPM &lt;- c(73, 67, 74, 63, 73, 84, 60, 62, 76, 71)\ndf &lt;- data.frame(Person=person, Years.of.School=Years, BPM=BPM)\n\nkable(df, align=\"l\")\n\n\n\n\n\nPerson\nYears.of.School\nBPM\n\n\n\n\n1\n12\n73\n\n\n2\n16\n67\n\n\n3\n13\n74\n\n\n4\n18\n63\n\n\n5\n19\n73\n\n\n6\n12\n84\n\n\n7\n18\n60\n\n\n8\n19\n62\n\n\n9\n12\n76\n\n\n10\n14\n71\n\n\n\n\n\n\n\n代码\nlibrary(ggplot2)\nperson &lt;- seq(1:10)\nYears &lt;- c(12, 16, 13, 18, 19, 12, 18, 19, 12, 14)\nBPM &lt;- c(73, 67, 74, 63, 73, 84, 60, 62, 76, 71)\ndf &lt;- data.frame(Person=person, Years.of.School=Years, BPM=BPM)\n\nggplot(df, aes(x=Years.of.School, y=BPM)) +\n    geom_point()\n\n\n\n\n\n\n\n\n图 2.12: 不同数据集的直方图\n\n\n\n\n\n\n\n\n\n\n\n\n相关性衡量的是变量之间的关联关系，而不是因果关系\n\n\n\n例 2.5 中的数据集仅考虑了 10 名学生，因此不足以让人对受教育年限和心率之间的关系得出任何确凿的结论。此外，即使有更大规模的数据集，并且受教育年限高低与其静息心率之间同样存在着较强的负相关性，我们也没有理由得出 多接受几年教育会直接降低一个人的心率 的结论。也就是说，尽管高受教育年限往往与较低的静息心率有关联，但这并不意味着多受几年教育是导致较低心率的直接原因。通常，对这种关联性的解释在于，存在一个与所考虑的这两个变量都有相关性的隐藏因素。\n在 例 2.5 中，可能是受教育年限高的人更了解健康领域的最新发现，因此可能更了解锻炼和良好营养的重要性。亦或者，可能不是知识在起作用，而是受过更多教育的人所从事的工作会让他们有更多时间进行锻炼，同时也可以获取更多薪水以补充良好的营养。受教育年限和静息心率之间的强烈负相关性可能是由受教育年限以及其他潜在因素的综合结果。\n\n\n接下来，我们将证明样本相关系数 \\(r\\) 的第一个特性：\\(|r| \\le 1\\)，当且仅当所有的数据点都在一条直线上时，\\(=\\) 成立。\n\\[\n\\begin{align}\n\\because &\\sum{(\\frac{x_i - \\overline{x}}{s_x} - \\frac{y_i - \\overline{y}}{s_y})^2} \\ge 0 \\\\\n\\therefore & \\sum{\\frac{(x_i - \\overline{x})^2}{s_x}} + \\sum{\\frac{(x_i - \\overline{x})^2}{s_x}} - 2 \\sum{\\frac{(x_i - \\overline{x})(y_i - \\overline{y})}{s_xs_y}} \\\\\n\\therefore & (n - 1) + (n - 1) -2(n - 1)r \\ge 0 \\\\\n\\therefore & 2(n - 1)(1 - r) \\ge 0 \\\\\n\\therefore & r \\le 1\n\\end{align}\n\\tag{2.17}\\]\n假设所有的数据点 \\({(x_i, y_i), i=1,...,n}\\) 都位于直线 \\(y_i = ax_i + b;\\ i=1,...n \\ \\& \\ a&gt;0\\) 上，则：\n\\[\n\\begin{align}\n& s_y^2=a^2s_x^2 \\\\\n& \\overline{y}=a\\overline{x} + b \\\\\n\\therefore & a = \\frac{s_y}{s_x}, \\ b = \\overline{y} - \\frac{s_y}{s_x}\\overline{x}\n\\end{align}\n\\tag{2.18}\\]\n根据 式 2.17， 当且仅当 \\(r = 1\\) 时，\\(\\sum{(\\frac{x_i - \\overline{x}}{s_x} - \\frac{y_i - \\overline{y}}{s_y})^2} = 0\\)。\n也即当且仅当 \\(r = 1\\) 时，\\(\\frac{y_i - \\overline{y}}{s_y} = \\frac{x_i - \\overline{x}}{s_x}\\)。\n所以，当且仅当 \\(r = 1\\) 时，\\(y_i = \\overline{y} - \\frac{s_y}{s_x}\\overline{x} + \\frac{s_y}{s_x}x_i\\)，把 式 2.18 代入得到 \\(y_i=ax_i + b\\)。\n因此，当且仅当 \\(r = 1\\) 时，\\((x_i, y_i)\\) 的所有的点都位于直线 \\(y_i = ax_i + b, a&gt;0\\)。\n同理，我们可以证明，当且仅当 \\(r = -1\\) 时，\\((x_i, y_i)\\) 的所有的点都位于直线 \\(y_i = ax_i + b, a&lt;0\\)。",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>描述统计</span>"
    ]
  },
  {
    "objectID": "chapter_2/2.html#sec-2_7",
    "href": "chapter_2/2.html#sec-2_7",
    "title": "2  描述统计",
    "section": "2.7 洛伦兹曲线和基尼系数",
    "text": "2.7 洛伦兹曲线和基尼系数\n洛伦兹曲线（Lorenz Curve）\\(L(p), 0 \\le p \\le 1\\)，是与群体中成员的收入相关的图表。\\(L(p)\\) 表示群体中，收入最低的 \\(100p\\%\\) 的人的总收入在群体总收入中的收入占比。例如，\\(L(0.3)\\) 是收入最低的 30% 的人的总收入在群体中的收入占比。一般来说，假设群体中有 \\(n\\) 个人，其个体收入按升序排列为 \\(x_1 \\le x_2 \\le x_3 ... \\le x_n\\)。因为 \\(x_1 + ... + x_j\\) 是收入最低的 \\(j\\) 个人的总收入，而 \\(x_1 + ... + x_n\\) 是该群体所有人的总收入。因此，收入最低的 \\(100\\frac{j}{n}\\%\\) 的人的收入占比就是：\n\\[\nL(\\frac{j}{n}) = \\frac{x_1 + ... + x_j}{x_1 + ... + x_n},\\ j = 1, ..., n\n\\]\n一般而言，令 \\(L(0) = 0\\)，并通过直线连接 \\(\\frac{j}{n}\\) 和 \\(\\frac{j + 1}{n}\\) 来绘制洛伦兹曲线。\n\n例 2.6 假设我们想绘制 \\(n=5\\) 的洛伦兹曲线，其中该群体的收入分别是：9，7，22，5，17。该群体的收入按照升序排序后是：5，7，9，17，22。因为群体的总收入是 60，因此：\n\nL(0.2) = 5 / 60\nL(0.4) = 12 / 60\nL(0.6) = 21 / 60\nL(0.8) = 38 / 60\nL(1) = 60 /60\n\n将如上的点用直线连接起来就形成了洛伦兹曲线，如 图 2.13。\n\n\n\n代码\nlibrary(ggplot2)\nx &lt;- seq(0, 1, 0.2)\ny &lt;- c(0, 5, 7, 9, 17, 22)\ny &lt;- cumsum(y)\ndf &lt;- data.frame(x=x, y=y, yf=(y / 60))\nggplot(df, aes(x=x, y=yf)) +\n  geom_line() + \n  scale_x_continuous(limits=c(0, 1), breaks=seq(0, 1, 0.2)) +\n  scale_y_continuous(limits=c(0, 1), breaks=seq(0, 1, 0.2)) +\n  geom_point(color = \"black\", size = 1) + \n  labs(x=\"people proportion\", y=\"incomes proportion\")\n\n\n\n\n\n\n\n\n图 2.13: 例 2.6 的洛伦兹曲线\n\n\n\n\n\n也可以用洛伦茨曲线来展现群体中的个体财富，其中 \\(L(p)\\) 代表最贫穷的 \\(100p%\\) 的人所拥有的全部财富的比例。例如，如果全部人口由 1000 人组成，那么 \\(L(0.22)\\) 就是 220 个最贫穷的人所拥有的财富比例。\n现在，当向集合中添加一个大于之前所有值的新值时，集合的平均值总是会增加。因此，如果群体成员的收入递增排序后是 \\(x_1 \\le x_2 \\le x_3... \\le x_n\\)，那么 \\(\\forall j = 1,...,n\\)，有：\n\\[\n\\begin{align}\n& \\frac{x_1 + ... + x_j}{j} \\le \\frac{x_1 + ... + x_{j+1}}{j + 1} \\le \\frac{x_1 + ... + x_n}{n} \\\\\n\\therefore & \\frac{x_1 + ... + x_j}{x_1 + ... + x_n} \\le \\frac{j}{n} \\\\\n\\therefore & L{(\\frac{j}{n}}) \\le \\frac{j}{n}\n\\end{align}\n\\]\n此外，可以验证，当且仅当所有人的收入都相等时，\\(L(\\frac{j}{n}) = \\frac{j}{n}, j=1,...,n\\)。因此，除非所有人的收入都相等，否则洛伦茨曲线总是位于 \\((0,0)\\) 和 \\((1,1)\\) 构成的直线之下。对于 例 2.6，图 2.14 正说明了这一点。\n\n\n代码\nlibrary(ggplot2)\n\nx &lt;- seq(0, 1, 0.2)\ny &lt;- c(0, 5, 7, 9, 17, 22)\ny &lt;- cumsum(y)\ndf &lt;- data.frame(x=x, y=y, yf=(y / 60))\nggplot(df, aes(x=x, y=yf)) +\n  geom_line() + \n  scale_x_continuous(limits=c(0, 1), breaks=seq(0, 1, 0.2)) +\n  scale_y_continuous(limits=c(0, 1), breaks=seq(0, 1, 0.2)) +\n  geom_point(color = \"black\", size = 1) + \n  geom_segment(x=df$x[1], y=df$yf[1], xend=df$x[length(df$x)], yend=df$yf[length(df$yf)], color=\"red\") +\n  labs(x=\"people proportion\", y=\"incomes proportion\")\n\n\n\n\n\n\n\n\n图 2.14: 例 2.6 的包含直线的洛伦兹曲线\n\n\n\n\n\n因此，当所有人的收入都相等时，洛伦茨曲线与从 \\((0, 0)\\) 到 \\((1, 1)\\) 的直线重合；而当群体中不同个体收入不相等时，洛伦茨曲线则位于该直线的下方。当群体成员的收入越不平等，\\((0, 0)\\) 到 \\((1, 1)\\) 的直线和洛伦茨曲线之间的区域则越大（如 图 2.15 中的阴影区域所示）。\n\n\n代码\nlibrary(ggplot2)\nx &lt;- seq(0, 1, 0.2)\ny &lt;- c(0, 5, 7, 9, 17, 22)\ny &lt;- cumsum(y)\ndf &lt;- data.frame(x=x, y=y, yf=(y / 60))\nggplot(df, aes(x=x, y=yf)) +\n  geom_line() + \n  scale_x_continuous(limits=c(0, 1), breaks=seq(0, 1, 0.2)) +\n  scale_y_continuous(limits=c(0, 1), breaks=seq(0, 1, 0.2)) +\n  geom_point(color = \"black\", size = 1) + \n  geom_polygon(aes(x=x, y=yf), fill=\"grey\", alpha=0.7) +\n  geom_segment(x=df$x[1], y=df$yf[1], xend=df$x[length(df$x)], yend=df$yf[length(df$yf)], color=\"red\") + \n  annotate(\"text\", x = 0.75, y = 0.25, label = \"B\", hjust = 1, vjust = 0, size = 6) +\n  labs(x=\"people proportion\", y=\"incomes proportion\")\n\n\n\n\n\n\n\n\n图 2.15: 直线[(0, 0), (1, 1)]和洛伦兹曲线之间的面积\n\n\n\n\n\n可以用基尼系数（Gini Index）衡量 \\((0, 0)\\) 到 \\((1, 1)\\) 的直线和洛伦茨曲线之间的区域大小，进而衡量群体中成员的收入不平等性。基尼系数等于 图 2.15 中阴影区域面积与直线下方区域的面积之比。由于三角形的面积是底乘以高的一半，所以从 \\((0, 0)\\) 到 \\((1, 1)\\) 的直线下方的面积等于 \\(\\frac{1}{2}\\)。\n因此，基尼系数 \\(G\\) 的定义如下：\n\\[\nG = \\frac{L(p) 曲线和直线围成的区域面积}{\\frac{1}{2}}\n\\]\n令洛伦兹曲线下方的区域为 \\(B\\)，则洛伦兹曲线和直线围成的面积就是直线下方的面积减去洛伦兹曲线下方的面积。因此，基尼系数\n\\[\nG=\\frac{\\frac{1}{2} - B}{\\frac{1}{2}} = 1 - 2B\n\\tag{2.19}\\]\n\n习题 2.11 计算 例 2.6 中的数据的基尼系数。\n\n\n\n代码\nx &lt;- seq(0, 1, 0.2)\ny &lt;- c(0, 5, 7, 9, 17, 22)\ny &lt;- cumsum(y)\ndf &lt;- data.frame(x=x, y=y, yf=(y / 60))\nggplot(df, aes(x=x, y=yf)) +\n  geom_line() + \n  scale_x_continuous(limits=c(0, 1), breaks=seq(0, 1, 0.2)) +\n  scale_y_continuous(limits=c(0, 1), breaks=seq(0, 1, 0.2)) +\n  geom_point(color = \"black\", size = 1) + \n  geom_polygon(aes(x=x, y=yf), fill=\"grey\", alpha=0.7) +\n  geom_segment(x=df$x[1], y=df$yf[1], xend=df$x[length(df$x)], yend=df$yf[length(df$yf)], color=\"red\") + \n  geom_segment(x=df$x[2], y=df$yf[2], xend=df$x[2], yend=0) +\n  geom_segment(x=df$x[3], y=df$yf[3], xend=df$x[3], yend=0) +\n  geom_segment(x=df$x[4], y=df$yf[4], xend=df$x[4], yend=0) +\n  geom_segment(x=df$x[5], y=df$yf[5], xend=df$x[5], yend=0) +\n  geom_segment(x=df$x[6], y=df$yf[6], xend=df$x[6], yend=0) +\n  annotate(\"text\", x = 0.15, y = 0.02, label = \"B1\", hjust = 1, vjust = 0, size = 3) +\n  annotate(\"text\", x = 0.3, y = 0.1, label = \"B2\", hjust = 1, vjust = 0, size = 3) +\n  annotate(\"text\", x = 0.5, y = 0.2, label = \"B3\", hjust = 1, vjust = 0, size = 3) +\n  annotate(\"text\", x = 0.7, y = 0.4, label = \"B4\", hjust = 1, vjust = 0, size = 3) +\n  annotate(\"text\", x = 0.9, y = 0.6, label = \"B5\", hjust = 1, vjust = 0, size = 3) +\n  labs(x=\"people proportion\", y=\"incomes proportion\")\n\n\n\n\n\n\n\n\n图 2.16: 求解 B 的面积\n\n\n\n\n\n\n解 2.12. 为了计算 \\(B\\) 的面积（即洛伦兹曲线下的面积），如 图 2.16 所示，我们令 \\(B = B1 + B2 + B3 + B4 + B5\\)，其中 \\(B1\\) 是0~0.2 的洛伦兹曲线下的区域面积，\\(B2\\) 是 0.2~0.4 之间的区域面积，\\(B3\\) 是 0.4~0.6 之间的区域面积，\\(B4\\) 是 0.6~0.8 之间的区域面积；\\(B5\\) 是 0.8~1 之间的区域面积。现在，\\(B1\\) 是一个三角形的面积，其底为 0.2，高为 5/60，因此：\n\\[\nB1 = \\frac{1}{2} \\cdot 0.2 \\cdot \\frac{5}{60} = \\frac{5}{600}\n\\]\n对于 \\(B2, B3, B4, B5\\) 而言，这些区域的面积由两部区域构成：顶部的三角形的面积和底部的矩形面积。如下图所示，以 \\(B2\\) 为例，其面积由 \\(B2-1\\) 和 \\(B2-2\\) 两部分构成：\n\n\n代码\nx &lt;- seq(0, 1, 0.2)\ny &lt;- c(0, 5, 7, 9, 17, 22)\ny &lt;- cumsum(y)\ndf &lt;- data.frame(x=x, y=y, yf=(y / 60))\nggplot(df, aes(x=x, y=yf)) +\n  scale_x_continuous(limits=c(0, 0.6), breaks=seq(0, 0.6, 0.2)) +\n  scale_y_continuous(limits=c(0, 0.25), breaks=seq(0, 0.25, 0.05)) +\n  geom_segment(x=df$x[2], y=df$yf[2], xend=df$x[3], yend=df$yf[3]) + \n  geom_segment(x=df$x[2], y=df$yf[2], xend=df$x[2], yend=0) +\n  geom_segment(x=df$x[3], y=df$yf[3], xend=df$x[3], yend=0) +\n  geom_segment(x=df$x[2], y=df$yf[2], xend=df$x[3], yend=df$yf[2], linetype=\"dashed\") +\n  annotate(\"text\", x = 0.3, y = 0.1, label = \"B2-1\", hjust = 1, vjust = 0, size = 3) +\n  annotate(\"text\", x = 0.3, y = 0.03, label = \"B2-2\", hjust = 1, vjust = 0, size = 3) +\n  labs(x=\"people proportion\", y=\"incomes proportion\")\n\n\n\n\n\n\n\n\n\n因此，所有的三角形的底的长度都是 0.2，其对应的高分别为 \\(\\frac{5}{60}, \\frac{7}{60}, \\frac{9}{60}, \\frac{17}{60}, \\frac{22}{60}\\)。因此，所有的三角形的面积为：\n\\[\nS_\\triangle = \\frac{1}{2} \\cdot 0.2 \\cdot \\frac{5+7+9+17+22}{60} = 0.1\n\\]\n四个矩形的长均是 0.2，其对应的高分别是 \\(\\frac{5}{60}, \\frac{12}{60}, \\frac{21}{60}, \\frac{38}{60}\\)。因此，所有的矩形的面积为：\n\\[\nS_\\square = 0.2 \\cdot \\frac{5 + 12 + 21 + 38}{60} \\thickapprox 0.25333\n\\]\n所以 \\(B = S_\\triangle + S_\\square =\\) \\(0.1 + 0.25333 = 0.35333\\)，故而 \\(G = 1 - 2B =\\) \\(1 - 2 \\cdot 0.35333 =\\) \\(0.29334\\)。\n\n一般而言，收入数据以升序进行排列，\\(x_1 \\le x_2 \\le x_3 \\le ... \\le x_n\\)，令 \\(s_j = x_1 + ... + x_j, j=1,...,n\\)，则洛伦兹曲线下方的所有三角形的底均是 \\(\\frac{1}{n}\\)，且其对应的高分别为 \\(\\frac{x_1}{s_n}\\)，\\(\\frac{x_2}{s_n}\\)，……，\\(\\frac{x_n}{s_n}\\)。\n因此，所有三角形的面积为：\n\\[\nS_\\triangle=\\frac{1}{2n}\\frac{(x_1 + ... + x_n)}{s_n}=\\frac{1}{2n}\n\\]\n所有的矩形的长均为 \\(\\frac{1}{n}\\)，且其对应的高分别为 \\(\\frac{s_1}{s_n}\\)，\\(\\frac{s_2}{s_n}\\)，……，\\(\\frac{s_{n-1}}{s_n}\\)。\n因此，所有矩形的面积为：\n\\[\nS_\\square = \\frac{s_1 + s_2 + ... + s_{n-1}}{ns_n}\n\\]\n所以：\n\\[\nB = \\frac{1}{2n} +  \\frac{s_1 + s_2 + ... + s_{n-1}}{ns_n}\n\\tag{2.20}\\]\n当所有人的收入都相等时，基尼系数为 0，因此直线与洛伦兹曲线之间的面积为 0。另一个极端的情况就是，当群体的 \\(n\\) 个人中，只有一个人有收入，那么此时基尼系数达到最大值。对于第二种场景，洛伦兹曲线下的面积是一个三角形的面积，其底边长度为 \\(\\frac{1}{n}\\)，高度为 1（如 图 2.17）。此时 \\(B=\\frac{1}{2n}\\)，因此 \\(G=1-\\frac{1}{n}\\)。\n\n\n代码\nx &lt;- seq(0, 1, 0.2)\ny &lt;- c(0, 0, 0, 0, 0, 60)\ny &lt;- cumsum(y)\ndf &lt;- data.frame(x=x, y=y, yf=(y / 60))\nggplot(df, aes(x=x, y=yf)) +\n  geom_line() + \n  scale_x_continuous(limits=c(0, 1), breaks=seq(0, 1, 0.2)) +\n  scale_y_continuous(limits=c(0, 1), breaks=seq(0, 1, 0.2)) +\n  geom_point(color = \"black\", size = 1) + \n  geom_polygon(aes(x=x, y=yf), fill=\"grey\", alpha=0.7) +\n  geom_segment(x=df$x[1], y=df$yf[1], xend=df$x[length(df$x)], yend=df$yf[length(df$yf)], color=\"red\") + \n  geom_segment(x=df$x[2], y=df$yf[2], xend=df$x[2], yend=0) +\n  geom_segment(x=df$x[3], y=df$yf[3], xend=df$x[3], yend=0) +\n  geom_segment(x=df$x[4], y=df$yf[4], xend=df$x[4], yend=0) +\n  geom_segment(x=df$x[5], y=df$yf[5], xend=df$x[5], yend=0) +\n  geom_segment(x=df$x[6], y=df$yf[6], xend=df$x[6], yend=0) +\n  labs(x=\"people proportion\", y=\"incomes proportion\") +\n  theme(  \n    axis.text.x = element_blank(),   \n    axis.text.y = element_blank(), \n  ) + \n  annotate(\"text\", x = 0.9, y = 0.25, label = \"B\", hjust = 1, vjust = 0, size = 6) +\n  annotate(\"text\", x = 0.8, y = 0, label = \"1-(1/n)\", hjust = 1, vjust = 0, size = 3) + \n  annotate(\"text\", x = 1, y = 0, label = \"1\", hjust = 1, vjust = 0, size = 3) + \n  annotate(\"text\", x = 0, y = 1, label = \"1\", hjust = 1, vjust = 0, size = 3)\n\n\n\n\n\n\n\n\n图 2.17: 最大基尼系数",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>描述统计</span>"
    ]
  },
  {
    "objectID": "chapter_2/2.html#sec-2_8",
    "href": "chapter_2/2.html#sec-2_8",
    "title": "2  描述统计",
    "section": "2.8 R",
    "text": "2.8 R\n如果我们要计算 \\(x_1,...,x_n\\) 的样本均值和样本方差，我们可以在 R 中输入：\nx &lt;- c(x_1,...,x_n)\n然后可以按下 回车 键，并输入 mean(x)，然后当再次按下 回车 时，就会打印出样本均值。当输入 var(x)，然后按下 回车 时，就会打印出样本方差。\n例如，我们要计算：4，6，12，9，21，14 的样本均值和样本方差，我们可以用 R 按照如下方式获取：\n&gt; x &lt;- c(4,6,12,9,21,14)\n&gt; mean(x)\n[1] 11\n&gt; var(x)\n[1] 37.6\n&gt; \n在 R 中，我们不需要输入行首的 &gt;，R 会自动为每一行补充提示符 &gt;，以提示我们输入代码。R 中的命令还有：\n\nsum(x)：返回向量 x 中所有数据的和。\nmedian(x)：返回向量 x 中的所有数据的中位数。\nsd(x)：返回向量 x 中所有数据的标准差。\n\n如果 \\(x=c(x_1,...,x_n)\\)，\\(y=c(y_1,...,y_n)\\)，则：\n\n\\(x+y=c(x_1+y_1,...,x_n+y_n)\\)\n\\(x-y=c(x_1-y_1,...,x_n-y_n)\\)\n\\(x^2=c(x_1^2,...,x_n^2)\\)\n\\(\\frac{x}{y}=c(\\frac{x_1}{y_1},...,\\frac{x_n}{y_n}), \\ \\forall y_i \\ne 0\\)\n\n如果 \\(a\\) 是一个实数，则：\n\n\\(a + x = c(a+x_1,...,a+x_n)\\)\n\\(ax = c(ax_1,...,ax_n)\\)\n\\(\\frac{x}{a}=c(\\frac{x_1}{a},...,\\frac{x_n}{a}), \\ \\forall a \\ne 0\\)\n\\(\\frac{a}{x}=c(\\frac{a}{x_1},...,\\frac{a}{x_n}), \\ \\forall x_i \\ne 0\\)\n\n对于成对数据 \\(\\{(x_i,y_i)\\}, \\ i=1,...,n\\)，我们可以使用如下命令获取其相关系数：\n&gt; x &lt;- c(x1,...,xn) \n&gt; y &lt;- c(y1,...,yn) \n&gt; cor(x, y)\n可以用 plot(x, y) 获取 \\(\\{(x_i,y_i)\\}\\) 的散点图：\n&gt; plot(x, y)\n假设我们有如下的数据：(4,10), (6,13), (12,22), (9,15), (21,30), (14,15)，我们可以使用如下的 R 命令获取其样本相关系数和散点图：\n\n\n代码\nx &lt;- c(4, 6, 12, 9, 21, 14)\ny &lt;- c(10, 13, 22, 15, 30, 15) \ncor(x, y)\n\n\n[1] 0.9041494\n\n\n代码\nplot(x, y)\n\n\n\n\n\n\n\n\n\nR 还可以用于数学计算，例如我们可以使用如下命令计算 \\(\\frac{18\\sqrt{177}}{677}\\)：\n\n\n代码\n18*sqrt(177)/677 \n\n\n[1] 0.3537288\n\n\n\n如果我们从向量 x &lt;- c(x1, ..., xn) 中选择第 \\(i\\) 个位置的元素 \\(x_i\\)，我们可以使用命令 x[i]。\n如果希望从向量 x 中选择 \\(i\\) 到 \\(j\\) 的元素并构成一个新的向量，我们可以使用命令 x[i:j]。\n\n\n\n代码\nx &lt;- c(3, 18, 9, 7, 22, 5, 17)\nx[3]\n\n\n[1] 9\n\n\n代码\nx[2:5]\n\n\n[1] 18  9  7 22\n\n\n我们可以使用 R 计算基尼系数。对于向量 x &lt;- c(x1, ..., xn)，先利用 sort(x) 得到 关于向量 x 中数据的递增排序。\n\n\n代码\nx &lt;- c(9, 7, 22, 5, 17)\nsort(x)\n\n\n[1]  5  7  9 17 22\n\n\n如果我们想使用 式 2.19 和 式 2.20 来计算 习题 2.11 中的基尼系数，我们可以使用如下的代码：\n\n\n代码\ny &lt;- c(9, 7, 22, 5, 17)\nx &lt;- sort(y)\ns &lt;- cumsum(x)[1:4]\nB &lt;- 1/10 + sum(s) / (5 * sum(x))\nG &lt;- 1 - 2 * B\nG \n\n\n[1] 0.2933333\n\n\n我们也可以在 R 中定义 函数。例如，我们想在 R 中定义函数 \\(f\\) 以实现 \\(f(x) = x^2\\)，可以使用如下的代码：\n\n\n代码\nf = function(x){x * x}\nf(4)\n\n\n[1] 16\n\n\n如果我们想实现 \\(f(x) = e^x\\)，可以使用如下的代码：\n\n\n代码\nf = function(x){exp(x)}\nf(1)\n\n\n[1] 2.718282\n\n\n使用 函数 的概念，我们可以使用如下的代码以获取 9, 7, 22, 5, 17 的基尼系数：\n\n\n代码\ns = function(x, j){sum(x[1:j])}\n\ny &lt;- c(9, 7, 22, 5, 17)\nx &lt;- sort(y)\nB &lt;- 1/10 + (s(x, 1) + s(x, 2) + s(x, 3) + s(x, 4)) / (5 * s(x, 5))\nG &lt;- 1 - 2 * B\nG \n\n\n[1] 0.2933333",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>描述统计</span>"
    ]
  },
  {
    "objectID": "chapter_2/2.html#习题",
    "href": "chapter_2/2.html#习题",
    "title": "2  描述统计",
    "section": "习题",
    "text": "习题\n\n以下是 1997 年 6 月，旧金山湾区每加仑标准无铅汽油的价格的样本数据。\n3.88, 3.90, 3.93, 3.90, 3.93, 3.96, 3.88, 3.94, 3.96, 3.88, 3.94, 3.99, 3.98\n使用如下的方式对数据进行描述：\n\n频率表\n相对频率的线图\n\n解释一下如何构建一个饼图。如果数据集中的某个数据值的相对频率为 r，那么在饼图中，该扇区将会位于什么角度？\n以下是西半球四个地区的石油储量估计数据（以十亿桶为单位）：\n\nUnited States 38.7\nSouth America 22.6\nCanada 8.8\nMexico 60.0\n\n请使用饼图来描述如上的数据。\n选择一本书或一篇文章，计算前 100 个句子中每个句子的单词数，并使用茎叶图来展现这些数据。现在选择另一本由不同作者撰写的书或文章，并做同样的操作。这两个茎叶图看起来是否相似？你认为这种方法能否有效地判断不同的文章是否由不同的作者所写？\n以下是每日上班通勤时间（以分钟为单位）的频率表：\n\n\n\nTravel time\nFrequency\n\n\n\n\n15\n6\n\n\n18\n5\n\n\n22\n4\n\n\n23\n3\n\n\n24\n4\n\n\n25\n2\n\n\n26\n4\n\n\n32\n3\n\n\n36\n1\n\n\n48\n1\n\n\n\n\n频率表中的数据包含了几天的数据？\n频率表中的总的通勤时间是多少？\n\n表 2.10 列出了 1985 年至 2006 年间，美国商业航空事故的次数以及由此造成的死亡总人数。\n\n绘制事故数的频率表\n绘制事故数的折线图\n绘制事故数的累积相对频率图\n计算事故数的样本均值\n计算事故数的样本中位数\n找出事故数的样本众数\n计算事故数的样本标准差\n\n\n\n\n代码\nlibrary(knitr)\ndf &lt;- read.table(\"../misc/US_airline.csv\", header=TRUE, sep=\",\")\nkable(df, align=\"l\")\n\n\n\n\n表 2.10: 美国商业航空公司 1985~2006 安全数据，数据来源： National Transportation Safety Board。\n\n\n\n\n\n\nYear\nDepartures..millions.\nAccidents\nFatalities\n\n\n\n\n1985\n6.1\n4\n197\n\n\n1986\n6.4\n2\n5\n\n\n1987\n6.6\n4\n231\n\n\n1988\n6.7\n3\n285\n\n\n1989\n6.6\n11\n278\n\n\n1990\n7.8\n6\n39\n\n\n1991\n7.5\n4\n62\n\n\n1992\n7.5\n4\n33\n\n\n1993\n7.7\n1\n1\n\n\n1994\n7.8\n4\n239\n\n\n1995\n8.1\n2\n166\n\n\n1996\n7.9\n3\n342\n\n\n1997\n9.9\n3\n3\n\n\n1998\n10.5\n1\n1\n\n\n1999\n10.9\n2\n12\n\n\n2000\n11.1\n2\n89\n\n\n2001\n10.6\n6\n531\n\n\n2002\n10.3\n0\n0\n\n\n2003\n10.2\n2\n22\n\n\n2004\n10.8\n1\n13\n\n\n2005\n10.9\n3\n22\n\n\n2006\n11.2\n2\n50\n\n\n\n\n\n\n\n\n\n根据 表 2.10 的数据，\n\n绘制事故导致的死亡人数的直方图\n绘制事故导致的死亡人数的茎叶图\n计算事故导致的死亡人数的的样本均值\n计算事故导致的死亡人数的的样本中位数\n计算事故导致的死亡人数的的样本标准差\n\nA 镇成年女性的体重样本均值大于 B 镇成年女性的体重样本均值。此外，A 镇成年男性的体重样本均值也大于 B 镇成年男性的体重样本均值。我们是否可以得出结论：A 镇成年人的体重样本均值大于 B 镇成年人的体重样本均值？请给出你的解释。\n首位数定律（Benford’s law for first digits）指出：在许多现实生活中的数值数据集中，首位数字并不是以相等的比例出现，而是偏向于较小的数字。更具体地说，首位数定律指出，首位非零数字为 \\(i, i=1,...,9\\) 的数据比例大约为 \\(log_{10}{(i+1)}\\)。例如，\\(log_{10}{(2)}=0.301\\)，这表明大约 30.1% 的数据的首位数字是 1。表 2.11 给出了首位数定律中以 1~9 作为首位数字的数据的比例。\n有趣的是，首位数定律已被证明可以适用于各种现实生活数据集，包括电费账单、街道地址、股票价格、人口数量、死亡率、河流长度、物理和数学常数，并且当数据值广泛分布时似乎最为准确。首位数定律最初是由美国天文学家西蒙・纽科姆（Simon Newcomb）在 1881 年发表的。1938 年，物理学家弗兰克・本福德（Frank Benford）在 20 个不同领域的数据集上测试了首位数定律，并表明在大多数情况下它都是一个很好的拟合。弗兰克・本福德测试的数据包括：河流的表面积、美国城市的人口规模、物理常数和分子量（molecular weights）等。\n物理考试中的一个多选题为：以下哪个是 20℃ 下，100% 过氧化氢溶液的密度（单位为 \\(g/{cm}^3\\)），(a) 7.3316、(b) 6.2421、(c) 1.4512、(d) 8.1818。如果你对过氧化氢一无所知，你会猜哪个答案是正确的？\n\n\n\n表 2.11: 首位数定律\n\n\n\n\n\nFirst digit\nProportion of data having it as first digit\n\n\n\n\n1\n0.301\n\n\n2\n0.176\n\n\n3\n0.125\n\n\n4\n0.097\n\n\n5\n0.079\n\n\n6\n0.067\n\n\n7\n0.058\n\n\n8\n0.051\n\n\n9\n0.046\n\n\n\n\n\n\nA 公司总共有 100 名员工，而 B 公司总共有 110 名员工。假设 A 公司的所有员工的薪水总和比 B 公司高。\n\n对于 A 公司工资的中位数与 B 公司工资的中位数来说意味着什么？\n对于 A 公司工资的平均数与 B 公司工资的平均数来说意味着什么？\n\n一个包含 198 个数据的数据集中，前 99 个数据的样本均值等于 120，而后 99 个数据的样本均值等于 100。关于整个数据集的样本均值，你能得出什么结论？\n\n关于整个数据集的样本中位数，你能得出什么结论？\n关于整个数据集的样本众数，你能得出什么结论？\n\n下表给出了 1922 年英格兰的重大道路交通事故中，按照年龄、性别汇总的行人死亡人数数据。\n\n估算男性年龄的样本均值\n估算女性年龄的样本均值\n估算死亡男性的四分位数\n估算死亡女性的四分位数\n\n\n\n\nAge Range\nNumber of Males\nNumber of Females\n\n\n\n\n0-5\n120\n67\n\n\n5-10\n184\n120\n\n\n10-15\n44\n22\n\n\n15-20\n24\n15\n\n\n20-30\n23\n25\n\n\n30-40\n50\n22\n\n\n40-50\n60\n40\n\n\n50-60\n102\n76\n\n\n60-70\n167\n104\n\n\n70-80\n150\n90\n\n\n80-100\n49\n27\n\n\n\n以下是 12 个相邻位置发现的煤炭样本中的含灰量占比数据：\n9.2, 14.1, 9.8, 12.4, 16.0, 12.6, 22.7, 18.9, 21.0, 14.5, 20.4, 16.9\n\n计算如上数据的样本均值\n计算如上数据的样本标准差\n\n5 个数据的样本均值和样本方差分别是 \\(\\overline{x} = 104\\)，\\(s^2 = 16\\)，如果其中的 3 个数是 102， 100， 105，另外两个数是什么？\n假设你得到了美国 50 个州中每个州所有工人的平均工资。\n\n你认为这 50 个州的平均工资的样本均值会等于整个美国的工人平均工资吗？\n如果对（a）的回答是否定的，请解释除了这 50 个平均值之外，还需要什么其他信息来确定整个国家的样本平均薪资。同时，解释你将如何使用这些额外信息来计算这个整个美国的工人平均工资。\n\n如下是 40 个晶体管的使用寿命（单位为小时）：\n112, 121, 126, 108, 141, 104, 136, 134, \n121, 118, 143, 116, 108, 122, 127, 140,\n113, 117, 126, 130, 134, 120, 131, 133,\n118, 125, 151, 147, 137, 140, 132, 119,\n110, 124, 132, 152, 135, 130, 136, 128\n\n计算如上数据的样本均值、样本中位数、样本众数\n给出如上数据的累积相对频率图\n\n一个实验测量了 50 个粘土样本干燥后的收缩比率，并记录了以下数据：\n18.2 21.2 23.1 18.5 15.6 20.8 19.4 15.4 21.2 13.4 \n16.4 18.7 18.2 19.6 14.3 16.6 24.0 17.6 17.8 20.2 \n17.4 23.6 17.5 20.3 16.6 19.3 18.5 19.3 21.2 13.9 \n20.5 19.0 17.6 22.3 18.4 21.2 20.4 21.4 20.3 20.1 \n19.6 20.6 14.8 19.7 20.5 18.0 20.8 15.8 23.1 17.0\n\n\n画出如上数据的茎叶图\n\n\n计算样本均值，样本中位数，样本众数\n\n\n计算样本方差\n\n\n从 13% 开始，以 1% 为间隔将如上的数据进行分组，并绘制直方图\n\n\n对于分组数据而言，假设每个数据点实际上位于其所在区间的中点，计算样本均值和样本方差，并与 (b) 和 (c) 的结果进行比较。为什么它们会不同？\n\n\n如下是计算 \\(\\{x_i;\\ i=1,...,n\\}\\) 样本均值和样本方差的一种快速算法。首先计算前 \\(j(j \\ge 2)\\) 个数据的样本均值和方差：\\(\\overline{x}_j = \\frac{\\sum_{i=1}^{j}{x_i}}{j}\\)，\\(s_j^2=\\frac{\\sum_{i=1}^{j}{(x_i - \\overline{x})^2}}{j - 1}\\)。其中，\\(\\overline{x}_1 = x_1\\)，\\(s_1^2 = 0\\)。则：\n\\[\n\\begin{align}\n& \\overline{x}_{j+1} = \\overline{x}_j + \\frac{x_{j + 1} - \\overline{x}}{j + 1} \\\\\n& s_{j+1}^2 = (1 - \\frac{1}{j})s_j^2 + (j + 1)(\\overline{x}_{j+1} - \\overline{x}_j)^2\n\\end{align}\n\\]\n\n\n使用如上的算法计算 3, 4, 7, 2, 9, 6 的样本均值和样本方差\n\n\n使用普通的计算方式来校验 (a) 的结果\n\n\n验证如上算法中的 \\(\\overline{x}_{j+1}\\) 和 \\(\\overline{x}_{j}\\) 的关系\n\n\n对于 表 2.5 的数据，\n\n计算 1 月的平均气温的 90-分位值\n计算 7 月的平均气温的 75-分位值\n\n根据 《纽约时报》在 2013 年 8 月 1 日两周前发布的讣告，找出如下的死亡年龄的四分位数。\n92, 90, 92, 74, 69, 80, 94, 98, 65, 96, \n84, 69, 86, 91, 88, 74, 97, 85, 88, 68, \n77, 94, 88, 65, 76, 75, 60, 69, 97, 92, \n85, 70, 80, 93, 91, 68, 82, 78, 89\n我们按照各个大学在谷歌上的月搜索量对大学进行月度排名，在截止到 2013 年 6 月的 114 个月中，获得过月榜单 TOP 10 的大学的上榜次数如下表所示。\n\n\n\n\n\n\n\nUniversity\nNumber of Months in Top 10\n\n\n\n\nHarvard University\n114\n\n\nUniversity of Texas, Austin\n114\n\n\nUniversity of Michigan\n114\n\n\nStanford University\n113\n\n\nUniversity of California Los Angeles (UCLA)\n111\n\n\nUniversity of California Berkeley\n97\n\n\nPenn State University\n94\n\n\nMassachusetts Institute of Technology (MIT)\n66\n\n\nUniversity of Southern California (USC)\n63\n\n\nOhio State University\n52\n\n\nYale University\n48\n\n\nUniversity of Washington\n33\n\n\n\n\n计算样本均值\n计算样本方差\n计算样本的四分位数\n\n填写缺失的单词或短语以完成以下句子：“如果向一组数字中增加一个新的数字，如果新的数字____，则该数组的样本均值将增加。”\n用箱线图表示第 20 题中的数据。\n在一个石油化工企业中，在 36 个随机选择的时间点测量了平均颗粒物浓度（单位为 \\(mg/m^3\\)），得到了如下的浓度数据：\n5, 18,  15, 7,  23, 220, 130, 85, 103, 25, \n80, 7,  24, 6,  13, 65,  37,  25, 24,  65, \n82, 95, 77, 15, 70, 110, 44,  28, 33,  81, \n29, 14, 45, 92, 17, 53\n\n使用直方图描述如上数据\n如上的直方图是近似正态直方图吗？\n\n一位化学工程师想要研究盐水蒸发池中水的蒸发率，他获得了 4 年中盐水蒸发池 7 月份每天蒸发英寸数的 55 个数据。这些数据以下面的茎叶图给出，其最小数据为 0.02 英寸，最大数据为 0.56 英寸。\n.0    2,6\n.1    1,4\n.2    1,1,1,3,3,4,5,5,5,6,9\n.3    0,0,2,2,2,3,3,3,3,4,4,5,5,5,6,6,7,8,9 \n.4    0,1,2,2,2,3,4,4,4,5,5,5,7,8,8,8,9,9 \n.5    2,5,6\n计算如上数据的：\n\n样本均值\n样本中位数\n样本标准差\n如上的数据看起来符合近似正态分布吗？\n位于样本均值 1 个标准差以内的数据占比是多少？\n\n以下是加利福尼亚大学伯克利分校工业工程与运筹学系录取的最近 30 名学生的 GPA（grade point averages）。\n3.46, 3.72, 3.95, 3.55, 3.62, 3.80, 3.86, 3.71, 3.56, 3.49, \n3.96, 3.90, 3.70, 3.61, 3.72, 3.65, 3.48, 3.87, 3.82, 3.91, \n3.69, 3.67, 3.72, 3.66, 3.79, 3.75, 3.93, 3.74, 3.50, 3.83\n\n\n使用茎叶图来绘制如上的数据\n\n\n计算样本均值 \\(\\overline{x}\\)\n\n\n计算样本标准差 \\(s\\)\n\n\n计算位于 \\([\\overline{x} - 1.5s, \\overline{x} + 1.5s]\\) 的数据比例，并和切比雪夫不等式给出的下限比例进行对比\n\n\n计算位于 \\([\\overline{x} - 2s, \\overline{x} + 2s]\\) 的数据比例，并和切比雪夫不等式给出的下限比例进行对比\n\n\n第 26 题中的数据是否近似于正态分布？对于第 26 题的 (d) 和 (e) ，请使用经验法则给出的近似占比与实际占比进行比较。\n你是否期望一个健身俱乐部所有会员的体重直方图会近似于正态分布？\n对于第 16 题中的数据：\n\n\n计算样本均值和样本中位数\n\n\n这些数据符合近似正态分布吗？\n\n\n计算样本标准差 \\(s\\)\n\n\n计算位于 \\([\\overline{x} - 1.5s, \\overline{x} + 1.5]\\) 区间的数据的占比\n\n\n对比 (d) 的结果和经验法则给出的结果\n\n\n对比 (d) 的结果和切比雪夫不等式给出的结果\n\n\n以下是 12 名考试成绩大致相同的法学院学生的身高和起薪数据：\n\n\n\nHeight (inches)\nSalary\n\n\n\n\n64\n91\n\n\n65\n94\n\n\n66\n88\n\n\n67\n103\n\n\n69\n77\n\n\n70\n96\n\n\n72\n105\n\n\n72\n88\n\n\n74\n122\n\n\n74\n102\n\n\n75\n90\n\n\n76\n114\n\n\n\n\n绘制数据的散点图\n计算样本相关系数\n\n根据人们的站立姿势数据形成一个随机样本。针对样本中的人，还额外记录了每个人在过去一年中经历背痛的天数。令研究人员惊讶的是，这些数据表明良好的站姿与背痛天数之间存在正相关关系。这是否意味着良好的站姿会导致背痛？\n如果我们把美国 50 个州中每个州的居民平均收入和居住在该州的外国出生的移民数量绘制为成对的数据图，那么这些成对数据将呈现正相关关系。我们能否得出结论，移民居民往往比土生土长的美国人的收入更高？如果不是，还能如何解释这个现象？\n随机抽取 12 名高中三年级学生，并要求他们估算自己每周平均学习的小时数。以下的数据给出了估算结果和学生的 GPA。\n\n\n\nHours\nGPA\n\n\n\n\n6\n2.8\n\n\n14\n3.2\n\n\n3\n3.1\n\n\n22\n3.6\n\n\n9\n3.0\n\n\n11\n3.3\n\n\n12\n3.4\n\n\n5\n2.7\n\n\n18\n3.1\n\n\n24\n3.8\n\n\n15\n3.0\n\n\n17\n3.9\n\n\n\n\n计算学习小时数和 GPA 之间的样本相关系数。\n\n验证样本相关系数的特性 3。\n验证样本相关系数的特性 4。\n在一项针对二至四年级的儿童研究中，研究人员针对每个学生都做了阅读测试。在研究结果数据时，研究人员注意到学生的阅读测试分数和身高之间存在正相关关系。研究人员得出结论，身高较高的孩子阅读能力更好，因为他们可以更容易地看到黑板。你认为呢？\n最近的一项研究发现，母乳喂养的婴儿与 6 岁时进行的词汇测试分数之间存在正相关关系。讨论在解释这项研究结果时可能遇到的困难。\n一个群体的收入分别为 25、32、60、40、38、50，绘制其洛伦茨曲线并计算其基尼系数。\n根据如下的年收入（以千美元为单位）频率表，绘制该群体的洛伦茨曲线并计算其基尼系数：\n\n\n\nValue\nFrequency\n\n\n\n\n30\n2\n\n\n50\n4\n\n\n60\n5\n\n\n90\n4\n\n\n100\n3\n\n\n120\n2\n\n\n\n如果样本中所有的数据都乘以一个大于 0 的常数 \\(c\\)，基尼系数将会发生什么变化？如果样本中所有的数据都加上一个大于 0 的常数 \\(c\\)，基尼系数又会发生什么变化？下降，保持不变，还是不好说？",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>描述统计</span>"
    ]
  },
  {
    "objectID": "chapter_3/3.html",
    "href": "chapter_3/3.html",
    "title": "3  概率论基础",
    "section": "",
    "text": "3.1 引言\n对于一个实验中特定 事件（event）发生的概率（probability）而言，概率 这个概念具有多种含义或解释。例如，如果一位地质学家说 “某地区有 60% 的可能性存在石油”，对于地质学家的这一说法，我们可能都会有一些先入为主的观点。事实上，我们中的大多数人可能会用以下两种方式中的一种来解释地质学家的这一说法：\n对事件概率（the probability of an event ）的上述两种解释分别是：频率解释（frequency interpretation）和 主观解释（subjective interpretation）。\n然而，无论给予概率哪种解释，人们一致认为在这两种情况下概率的数学理论都是相同的。例如，如果你认为明天下雨的概率是 0.3，明天多云但不下雨的概率是 0.2，那么你会认为明天多云或下雨的概率就是 0.5。并且 0.5 的结果与我们对概率的主观解释无关。\n在本章中，我们会先研究如下的概念：样本空间（sample space）、实验中的 事件（events），然后介绍概率论中公认的规则（rules）和公理（axioms）。",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>概率论基础</span>"
    ]
  },
  {
    "objectID": "chapter_3/3.html#sec-3_1",
    "href": "chapter_3/3.html#sec-3_1",
    "title": "3  概率论基础",
    "section": "",
    "text": "地质学家认为，从长远来看，在外部环境与所考虑地区非常相似的地区中，有 60% 的地区存在石油。\n地质学家认为该地区含有石油的可能性大于不含有石油的可能性，而且实际上，60% 是地质学家对该地区含有石油这一假设的信心度量。\n\n\n\n在 频率解释 中，我们把实验中一个给定结果的概率看作是该结果的一个 “属性”（property）。我们认为，可以通过不断的、重复实验来确定结果出现的”概率”——在实验中，观察到的、该结果出现的比例就是其概率。普遍情况下，科学家眼中的概率就是 频率解释。\n在 主观解释 中，我们并不把概率看作是给定实验结果的“属性”，而是看作引用该概率的人对结果发生的可能性的信念。因此，在 主观解释 中，概率成了一个主观概念，此时，概率除了表达个人的信心程度外并没有其他意义。哲学家和某些经济决策者往往对 主观解释 青睐有加。",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>概率论基础</span>"
    ]
  },
  {
    "objectID": "chapter_3/3.html#sec-3_2",
    "href": "chapter_3/3.html#sec-3_2",
    "title": "3  概率论基础",
    "section": "3.2 样本空间和事件",
    "text": "3.2 样本空间和事件\n让我们思考这样的一个实验，在该实验中，我们无法提前确切的预测实验结果。虽然我们无法提前知晓实验结果，但我们可以假定该实验的、所有可能的、结果集合是已知的。所有可能的实验结果的集合，我们称之为实验的 样本空间（sample space），并用 \\(S\\) 来表示 样本空间。\n样本空间 的例子如下所示：\n\n例 3.1 对于确定新生儿性别的实验，\\(S=\\{g,\\ b\\}\\)，其中，\\(g\\) 表示小孩为女孩，\\(b\\) 表示小孩为男孩。\n\n\n例 3.2 对于确定已编号的 7 匹马（编号为 1~7 号）之间的赛马实验，\\(S=\\{(1, 2, 3, 4, 5, 6, 7)的所有排序\\}\\)。(2, 3, 1, 6, 5, 4, 7) 的实验结果意味着 2 号马排在第一名，3 号马排在第二名，然后是 1 号马，依此类推……\n\n\n例 3.3 假如我们想确定患者的最小有效用药剂量，则这个实验的一个可能的样本空间就是让 \\(S\\) 包含所有的正数，即 \\(S=(0,\\ \\infty)\\)。如果用药剂量为 \\(x\\) 时开始对患者有效，但是任何低于 \\(x\\) 的用药剂量均对患者无效，那么此次试验的结果就是 \\(x\\)。\n\n样本空间 的任何子集 \\(E\\) 称之为一个 事件（event）。也就是说，一个 事件 是由实验的可能结果组成的集合。如果实验的结果存在于 \\(E\\) 中，那么我们就说， \\(E\\) 已经发生。如下是 事件 的一些例子：\n\n在 例 3.1 中，如果 \\(E = \\{g\\}\\)，那么 \\(E\\) 表示的事件为：新生儿为女孩。类似的，如果 \\(F = \\{b\\}\\)，那么 \\(F\\) 表示的事件为：新生儿为男孩。\n在 例 3.2 中，如果 \\(E=\\{以 3 为首的所有排序\\}\\)，则 \\(E\\) 表示的事件为：3 号马赢得比赛。\n\n对于样本空间 \\(S\\) 中的任意两个事件 \\(E\\) 和 \\(F\\)，我们定义一个新事件 \\(E \\cup F\\)，并称其为事件 \\(E\\) 和 \\(F\\) 的并集。\\(E \\cup F\\) 由所有属于 \\(E\\) 或 \\(F\\) 或同时属于 \\(E\\) 和 \\(F\\) 的结果组成。也就是说，如果 事件 \\(E\\) 或 事件 \\(F\\) 发生，那么事件 \\(E \\cup F\\) 就会发生。例如，在 例 3.1 中，如果 \\(E = \\{g\\}\\) 且 \\(F = \\{b\\}\\)，那么 \\(E \\cup F = \\{g, b\\}\\)。也就是说，\\(E \\cup F\\) 是整个样本空间 \\(S\\)。在 例 3.2 中，如果 \\(E = \\{所有以 6 为首的比赛结果\\}\\) 是 6 号马赢得比赛的事件，而 \\(F = \\{所有第二名是 6 的比赛结果\\}\\) 是 6 号马获得第二名的事件，那么 \\(E \\cup F\\) 就是6 号马获得前两名的事件。\n类似地，对于样本空间 \\(S\\) 中的任意两个事件 \\(E\\) 和 \\(F\\)，我们也可以定义一个新事件 \\(EF\\)（有时也记作 \\(E \\cap F\\)），并称之为事件 \\(E\\) 和 \\(F\\) 的交集。\\(E \\cap F\\) 由属于 \\(E\\) 并且同时属于 \\(F\\) 的所有结果组成。也就是说，只有当事件 \\(E\\) 和 \\(F\\) 都发生时，事件 \\(EF\\) 才会发生。例如，在 例 3.3 中，如果 \\(E = (0, 5)\\) 是药品所需剂量小于 5 的事件，而 \\(F = (2, 10)\\) 是所需剂量在 2~10 之间的事件，那么 \\(EF = (2, 5)\\) 就是所需剂量在 2~5 之间的事件。在 例 3.2 中，如果 \\(E = \\{所有以 5 结尾的结果\\}\\) 是5 号马获得最后一名的事件，而 \\(F = \\{所有以 5 为首的结果\\}\\) 是 5 号马获得第一名的事件，那么事件 \\(EF\\) 则不包含任何结果，因此事件 \\(EF\\) 不可能发生。对于不可能发生的事件，我们称其为 空事件，并用 \\(\\emptyset\\) 表示。因此，\\(\\emptyset\\) 指的是不包含任何实验结果的事件。如果 \\(EF = \\emptyset\\)，则意味着 \\(E\\) 和 \\(F\\) 不能同时发生，此时我们称 \\(E\\) 和 \\(F\\) 为 互斥事件。\n对于 \\(\\forall E\\)，我们定义事件 \\(E^c\\) 为事件 \\(E\\) 的补集。事件 \\(E^c\\) 由样本空间 \\(S\\) 中不属于 \\(E\\) 的所有结果组成。也就是说，当且仅当事件 \\(E\\) 不发生时，\\(E^c\\) 才会发生。在 例 3.1 中，如果 \\(E = \\{b\\}\\) 是小孩为男孩的事件，那么 \\(E^c = \\{g\\}\\) 就是小孩为女孩的事件。需要注意，由于实验必须会产生某种结果，因此 \\(S^c = \\emptyset\\)。\n\n\n\n\n\n\n注记\n\n\n\n\\(E^c=\\{\\forall F \\subset S,\\ E \\cap F = \\emptyset 且 E \\cup F = S\\}\\)\n\n\n对于任意两个事件 \\(E\\) 和 \\(F\\)，如果事件 \\(E\\) 中的所有结果在事件 \\(F\\) 中都存在，那么我们说事件 \\(E\\) 包含在事件 \\(F\\) 中，并记作 \\(E \\subset F\\)。因此，如果 \\(E \\subset F\\)，那么事件 \\(E\\) 的发生意味着事件 \\(F\\) 必然发生。如果 \\(E \\subset F\\) 且 \\(F \\subset E\\)，那么我们说 \\(E\\) 和 \\(F\\) 相等（或相同），并记作 \\(E = F\\)。\n我们也可以定义超过两个事件的并集和交集。特别是，事件 \\(E_1, E_2, ..., E_n\\) 的并集，记作 \\(E_1 \\cup E_2 \\cup ... \\cup E_n\\) 或者 \\(\\cup_1^n{E_i}\\)。事件 \\(\\cup_1^n{E_i}\\) 至少包含一个 \\(E_i(i = 1, 2, ..., n)\\) 中的所有结果。类似地，事件 \\(E_i(i = 1, 2, ..., n)\\)的交集，记作 \\(E_1E_2...E_n\\)，为同时出现在所有事件 \\(E_i(i = 1, 2, ..., n)\\) 中的结果组成的事件。换句话说，当至少有一个事件 \\(E_i\\) 发生时，\\(E_i\\) 的并集就会发生；当所有事件 \\(E_i\\) 都发生时，则 \\(E_i\\) 的交集就会发生。",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>概率论基础</span>"
    ]
  },
  {
    "objectID": "chapter_3/3.html#sec-3_3",
    "href": "chapter_3/3.html#sec-3_3",
    "title": "3  概率论基础",
    "section": "3.3 事件的代数运算和韦恩图表示",
    "text": "3.3 事件的代数运算和韦恩图表示\n韦恩图（Venn DIagram）是一种用来描述事件之间逻辑关系的、非常有用的图形化表示。用一个矩形表示样本空间 \\(S\\)，而用矩形内的圆表示样本空间中的事件 \\(E\\), \\(F\\), \\(G\\),… 对图中的特定区域进行着色以表示我们感兴趣的事件。例如，在 图 3.1 所示的三个韦恩图中，着色区域分别表示事件 \\(E \\cup F\\)（\\(E\\) 和 \\(F\\) 的并集），\\(EF\\)（\\(E\\) 和 \\(F\\) 的交集），以及 \\(E^c\\)（\\(E\\) 的补集）。图 3.2 所示的韦恩图表示 \\(E \\subset F\\)（\\(E\\) 是 \\(F\\) 的子集）。\n\n\n\n\n\n\n\n\n\n\n\n(a) \\(E \\cup F\\)\n\n\n\n\n\n\n\n\n\n\n\n(b) \\(EF\\)\n\n\n\n\n\n\n\n\n\n\n\n(c) \\(E^c\\)\n\n\n\n\n\n\n\n图 3.1: 韦恩图\n\n\n\n\n\n\n\n\n\n图 3.2: \\(E \\subset F\\) 的韦恩图\n\n\n\n事件的并集、交集和补集操作类似于代数中的规则，例如：\n\n交换律：\\(E \\cup F = F \\cup E\\)，\\(EF=FE\\)\n结合律：\\((E \\cup F) \\cup G = E \\cup (F \\cup G)\\)，\\((EF)G=E(FG)\\)\n分配率：\\((E \\cup F)G = EG \\cup FG\\)，\\(E(F \\cup G) = (E \\cup G)(F \\cup G)\\)\n\n可以通过证明等式左侧事件中的任何结果也包含在等式右侧的事件中来验证如上的事件操作规则。可以通过韦恩图来证明这如上的规则，例如，可以通过 图 3.3 中所示的一系列韦恩图来证明分配率。\n\n\n\n\n\n\n\n\n\n\n\n(a) \\(EG\\)\n\n\n\n\n\n\n\n\n\n\n\n(b) \\(FG\\)\n\n\n\n\n\n\n\n\n\n\n\n(c) \\((E \\cup F )G\\)\n\n\n\n\n\n\n\n图 3.3: 利用韦恩图证明分配率： \\((E \\cup F )G = EG \\cup FG\\)\n\n\n\n基于事件的并集、交集和补集形成的如下的关系称之为德摩根定律（DeMorgan’s laws）。\n\n\\((E \\cup F)^c = E^cF^c\\)\n\\((FE)^c = E^c \\cup F^c\\)",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>概率论基础</span>"
    ]
  },
  {
    "objectID": "chapter_3/3.html#sec-3_4",
    "href": "chapter_3/3.html#sec-3_4",
    "title": "3  概率论基础",
    "section": "3.4 概率论公理",
    "text": "3.4 概率论公理\n如果一个实验在完全相同的条件下不断重复，那么对于任何事件 \\(E\\)，随着重复次数的增加，包含与 \\(E\\) 中结果的比例会接近某个常数。例如，如果不断抛一枚硬币，随着抛掷次数的增加，正面​向上的比例将接近某个值。当我们谈到某个事件的概率时，我们通常指的是这种恒定的极限频率（constant limiting frequency）。\n纯从数学观点来看，对于具有样本空间 \\(S\\) 的实验中的每个事件 \\(E\\)，我们都假设存在一个数字 \\(P (E)\\) ，\\(P(E)\\) 满足以下三个公理（axiom）：\n\n公理1：\\(0 \\le P(E) \\le 1\\)\n公理2：\\(P(S) = 1\\)\n公理3：对于任何的互斥事件序列 \\(E_1\\)，\\(E_2\\)，……，\\(P\\bigg(\\bigcup_{i=1}^{n}E_i\\bigg) = \\sum_{i=1}^{n}{P(E_i)}\\)，\\(n = 1,2,...,\\infty\\)\n\n我们称 \\(P(E)\\) 为事件 \\(E\\) 的概率。\n因此，公理 1 表明实验的结果位于 \\(E\\) 中的概率是一个介于 0 和 1 之间的数。公理 2 表明实验结果将是样本空间 \\(S\\)（概率为 1） 的一中情况。公理 3 表明，对于任何一组互斥事件，至少一个事件发生的概率等于这组事件各自概率的和。\n应该注意的是，如果我们把 \\(P(E)\\) 看作大量重复执行实验时事件 \\(E\\) 的相对频率，那么 \\(P(E)\\) 确实会满足上述公理。例如，位于 \\(E\\) 中的实验结果的比例显然在 0 和 1 之间，而位于 \\(S\\) 中实验结果的比例是 1（因为所有结果都在 \\(S\\) 中）。此外，如果位于 \\(E\\) 和 \\(F\\) 中的结果没有交集，那么结果在 \\(E\\) 或 \\(F\\) 中的比例是它们各自频率的和。对于 公理 3，例如，假设实验为抛掷一对骰子，同时假设事件 \\(E\\) 为两枚骰子的点数总和是 2、3 或 12，事件 \\(F\\) 为点数总和是 7 或 11。如果 \\(E\\) 发生的概率为 11%，\\(F\\) 发生的概率为 22%，那么有 33% 的结果将是 2、3、12、7 或 11。\n现在，我们将使用这些公理来证明关于概率的两个简单命题（proposition）。首先，\\(E\\) 和 \\(E^c\\) 始终是互斥的，并且由于 \\(E \\cup E^c = S\\)，根据 公理 2 和 公理 3 有：\n\\[\n1 = P(S) = P(E \\cup E^c) = P(E) + P(E^c)\n\\]\n根据如上等式，我们有：\n\n命题 3.1 \\(P(E^c) = 1 - P(E)\\)\n\n换句话说，命题 3.1 表明，一个事件不发生的概率等于 1 减去它发生的概率。例如，如果抛一枚硬币，正面向上的概率是 3/8，那么反面向上的概率必须是 5/8。\n我们将证明的第二个命题给出了两个事件并集的概率与它们各自的概率以及他们的交集的概率之间的关系。\n\n命题 3.2 \\(P(E \\cup F) = P(E) + P(F) - P(EF)\\)\n\n\n\n\n\n\n\n证明 命题 3.2\n\n\n\n图 3.4 所示的韦恩图是证明 命题 3.2 的最简单的方法。在 图 3.4 中，区域 I、II、III 是互斥的，因此：\n\\[\n\\begin{align}\nP(E \\cup F) &= P(I) + P(II) + P(III) \\\\\nP(E) &= P(I) + P(II) \\\\\nP(F) & = P(II) + P(III) \\\\\n\\therefore P(E \\cup F) &= P(E) +P(F) - P(II) \\\\\n\\because P(II) &= P(EF) \\\\\n\\therefore P(E \\cup F) &= P(E) +P(F) - P(EF)\n\\end{align}\n\\]\n\n\n\n\n\n\n图 3.4: 韦恩图\n\n\n\n\n\n\n习题 3.1 内华达州有 28% 的男性吸烟，6% 的男性吸雪茄，3% 的男性既吸雪茄又吸烟。那么，有既不吸雪茄也不吸烟的男性占比是多少？\n\n\n解 3.1. 设 \\(E\\) 为事件——随机选择的一名男性吸香烟，设 \\(F\\) 为事件——该男性吸雪茄。那么，这个人要么吸香烟，要么吸雪茄的概率是：\n\\[\nP(E \\cup F ) = P (E) + P (F ) − P (EF) = 0.28 + 0.06 − 0.03 = 0.31\n\\]\n则，该男性既不吸雪茄也不吸烟的概率为 1 - 0.31 = 0.69，这意味着有 69% 的男性既不吸雪茄也不吸烟。\n\n事件 A 的 赔率（odds）定义如下：\n\\[\n\\frac{P(A)}{P(A^c)} = \\frac{P(A)}{1 - P(A)}\n\\]\n因此，事件 \\(A\\) 的赔率表示 \\(A\\) 发生的可能性比它不发生的可能性多多少。例如，如果 \\(P(A) = \\frac{3}{4}\\)，那么 \\(\\frac{P(A)}{1 − P (A)} = 3\\)，所以其赔率是 3。因此，\\(A\\) 发生的可能性是它不发生的可能性的 3 倍。（通常的说法是，事件 \\(A\\) 的赔率是 3 比 1。）",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>概率论基础</span>"
    ]
  },
  {
    "objectID": "chapter_3/3.html#sec-3_5",
    "href": "chapter_3/3.html#sec-3_5",
    "title": "3  概率论基础",
    "section": "3.5 等概率样本空间",
    "text": "3.5 等概率样本空间\n对于执行大量次数的实验来说，我们会很自然地假设：样本空间中的每个结果发生的可能性是相等的。也就是说，对于许多实验而言，其样本空间 \\(S\\) 是一个有限集合，\\(S = \\{1,2,...,N\\}\\)，通常很自然地假设：\n\\[\nP(\\{1\\}) = P(\\{2\\}) = ··· = P(\\{N\\}) = p\n\\]\n根据 公理 2 和 公理 3，我们有：\\(1 = P(S) = P(\\{1\\}) + P(\\{2\\}) + ··· + P(\\{N\\}) = Np\\)，故而有：\n\\[\nP(\\{i\\}) = p = \\frac{1}{N}\n\\]\n由此，根据 公理 3，对于任意事件 \\(E\\)：\\(P(E)=\\frac{位于\\ E\\ 中的结果数}{N}\\)。\n也就是说，如果我们假设实验的每个结果发生的可能性是相等的，那么任何事件 \\(E\\) 的概率就等于样本空间中包含在 \\(E\\) 中的结果的比例。\n因此，为了计算概率，通常需要有效地计算出给定事件可以以多少种不同的方式发生。为此，我们将使用以下规则。\n\n3.5.1 计数的基本原理\n假设要执行两个实验，如果实验 1 可能有 \\(m\\) 种可能的结果，并且对于实验 1 的每一种结果，实验 2 都有 \\(n\\) 种可能的结果，那么这两个实验总共有 \\(mn\\) 种可能的结果。\n\n\n\n\n\n\n计数的基本原理的证明\n\n\n\n可以使用如下的方式来枚举所有可能的实验结果：\n\\[\n\\begin{array}{ccc}\n    (1,1), & (1,2), & ..., &(1,n) \\\\\n    (2,1), & (2,2), & ..., &(2,n) \\\\\n    \\ \\ \\ ... & \\\\\n    (m,1), & (m,2), & ..., &(m,n) \\\\\n\\end{array}\n\\]\n如果实验 1 产生了第 \\(i\\) 种可能的结果，并且实验 2 产生了第 \\(j\\) 种可能的结果，我们称实验结果为 \\((i, j)\\)。因此，可能的结果集由 \\(m\\) 行组成，其中每行包含 \\(n\\) 个元素。\n\n\n\n习题 3.2 从一个包含 6 个白球和 5 个黑球的碗中 “随机抽取” 两个球。其中一个球是白色的，另一个是黑色的概率是多少？\n\n\n解 3.2. 如果我们认为选球的顺序非常重要，那么第一个抽取的球可能是 11 个中的任何一个，第二个抽取的球可能是剩下的 10 个中的任何一个，因此样本空间包含 11 × 10 = 110 个点。此外，有 6 × 5 = 30 种方式使得第一个球是白色的，第二个球是黑色的。同样地，有 5 × 6 = 30 种方式使得第一个球是黑色的，第二个球是白色的。因此，假设 “随机抽取” 意味着样本空间中的每个点都有相同的可能性，那么我们可以看出需要计算的概率是：\n\\[\n\\frac{30 + 30}{110} = \\frac{6}{11}\n\\]\n\n对于两个以上的实验，计数的基本原理 可以按如下的方式泛化（generalized）：\n\n\n\n\n\n\n计数基本原理的泛化\n\n\n\n如果要执行 \\(r\\) 个实验，其中第一个实验有 \\(n_1\\) 种可能的结果，如果对于这 \\(n_1\\) 种可能的结果，第二个实验有 \\(n_2\\) 种可能的结果，如果对于前两个实验的每种可能的结果，第三个实验有 \\(n_3\\) 种可能的结果，以此类推，那么这 \\(r\\) 个实验总共有 \\(n_1 \\cdot n_2 \\cdot \\cdot \\cdot n_r\\) 种可能的结果。\n\n\n为了说明 基本计数原理，让我们来确定 \\(n\\) 个不同对象的线性序（linear order）排列的方式的数量。例如，字母 a、b、c 有多少种不同的排列方式？\n通过直接枚举，我们可以发现有 6 种，即 abc、acb、bac、bca、cab、cba，其中的每一个都称为一个 排列（permutation）。因此，3 个对象有 6 种可能的 排列。如上的结果也可以从基本原理中得出，因为第一个对象可以是 3 个字母中的任何一个，第二个对象可以从剩下的 2 个字母中选择，第三个对象则从剩下的一个字母中选择。因此，有 3・2・1 = 6 种可能的 排列。\n以此类推，对于 \\(n\\) 个对象，其不同的排列种类为：\\(n \\cdot (n-1) \\cdot (n-2) \\cdot \\cdot \\cdot 3 \\cdot 2 \\cdot 1\\)。为了方便，我们将如上的式子记为 \\(n!\\)，读作“\\(n\\) 的阶乘”。为了方便，我们令 \\(0!=1\\)。\n\\[\nn! = n \\cdot (n-1) \\cdot (n-2) \\cdot \\cdot \\cdot 3 \\cdot 2 \\cdot 1\n\\]\n例如：\n\n\\(1! = 1\\)\n\\(2! = 2 \\cdot 1 = 2\\)\n\\(3! = 3 \\cdot 2 \\cdot 1 = 6\\)\n\\(4! = 4 \\cdot 3 \\cdot 2 \\cdot 1 = 24\\)\n\n\n习题 3.3 琼斯先生有 10 本书要放在他的书架上。其中，有 4 本是数学书，3 本是化学书，2 本是历史书，还有 1 本是语言书。琼斯想把这些书按主题分类放在一起排列在书架上。有多少种不同的排列方式？\n\n\n解 3.3. 有 4! 3! 2! 1! 种排列方式使得数学书排在最前面，然后是化学书，接着是历史书，最后是语言书。同样地，对于每个可能的主题顺序，都有 4! 3! 2! 1! 种可能的排列方式。因此，由于有 4! 种可能的主题顺序，所以所求的答案是 4! × 4! × 3! × 2! × 1! = 6912。\n\n\n习题 3.4 一个概率论课程的班级由 6 名男生和 4 名女生组成。在一次考试中，根据学生的考试成绩进行了排名。假设 10 名学生的考试成绩都不相同：\n\n（a）学生的排名有多少种不同的可能？\n（b）如果所有排名的可能性都相同，那么女生获得前 4 名的概率是多少？\n\n\n\n解 3.4. \n\n（a）因为每个排名都对应着 10 个人的一个特定有序排列，所以学生的排名可能性有 10! = 3,628,800 种。\n（b）由于女生有 4! 种可能的排名方式，男生有 6! 种可能的排名方式，根据 基本计数原理，女生获得前 4 名的可能排名有 (6!)(4!) = (720)(24) = 17,280 种。因此，所求的概率为：\\(\\frac{6!4!}{10!}=\\frac{4 \\cdot 3 \\cdot 2 \\cdot 1}{10 \\cdot 9 \\cdot 8 \\cdot 7} = \\frac{1}{210}\\)。\n\n\n现在，假设我们想要从 \\(n\\) 个对象中选择 \\(r\\) 个对象，并确定这 \\(r\\) 个不同对象所形成的排列方式的数量。例如，从五个物品 A、B、C、D、E 中选择 3 个物品，总共有多少种不同的选择方式？为了回答这个问题，由于有 5 种方式来选择第一个物品，4 种方式来选择下一个物品，3 种方式来选择最后一个物品。因此，当选择的物品存在顺序依赖时，有 5・4・3 种方式来选择这 3 个物品。然而，在存在顺序依赖时，任意选择的 3 个物品（比如 A、B 和 C ）都会被计算 6 次（ABC、ACB、BAC、BCA、CAB、CBA），因此可以形成的不同选择的总数是：(5・4・3)/(3・2・1) = 10。\n一般来说，\\(n (n − 1)・・・(n − r + 1)\\) 表示在顺序依赖条件下，从 \\(n\\) 个物品中选择 \\(r\\) 个物品的不同选择方式的数量。由于在这种计数中，每 \\(r\\) 个物品的选择方式都会被计算 \\(r!\\) 次，因此，从 \\(n\\) 个物品中可以形成的 \\(r\\) 个不同物品的数量是：\n\\[\n\\frac{n \\cdot (n-1) \\cdot \\cdot \\cdot(n-r+1)}{r!} = \\frac{n!}{(n-r)!r!}\n\\]\n\n\n3.5.2 组合的符号和术语\n\n定义 3.1 定义 \\(\\left(\\begin{array}{cc} n \\\\ r  \\end{array}\\right), \\forall r \\le n\\) 为一次性从 \\(n\\) 个物品中选择 \\(r\\) 个物品的组合数量，则：\n\\[\n\\left(\\begin{array}{cc}\nn \\\\\nr  \n\\end{array}\\right) = \\frac{n!}{(n-r)!r!}\n\\]\n\n\\(\\left(\\begin{array}{cc} n \\\\ r  \\end{array}\\right)\\) 表示在不考虑抽取顺序的情况下，从 \\(n\\) 个元素中选择 \\(r\\) 个元素的不同组合数。例如：\n\n从 8 个人中选择 2 个人的方式：\\(\\left(\\begin{array}{cc} 8 \\\\ 2  \\end{array}\\right) = \\frac{8 \\cdot 7}{2 \\cdot 1}=28\\)。\n从 10 个人中选择 2 个人的方式：\\(\\left(\\begin{array}{cc} 10 \\\\ 2  \\end{array}\\right) = \\frac{10 \\cdot 9}{2 \\cdot 1}=45\\)。\n\n特别注意的是，\\(\\left(\\begin{array}{cc} n \\\\ 0  \\end{array}\\right)\\) = \\(\\left(\\begin{array}{cc} n \\\\ n  \\end{array}\\right)\\) = 1。\n\n习题 3.5 要从 6 名男性和 9 名女性中随机选取 5 人组成一个委员会。如果是随机选择的话，这个委员会由 3 名男性和 2 名女性组成的概率是多少？\n\n\n解 3.5. 随机选取意味着 \\(\\left(\\begin{array}{cc} 15 \\\\ 5  \\end{array}\\right)\\) 种可能的组合数中的任何一组被选取的可能性都是一致的。因为，3 名男性的选择方式有 \\(\\left(\\begin{array}{cc} 6 \\\\ 3  \\end{array}\\right)\\) 种，2 名女性的选择方式有 \\(\\left(\\begin{array}{cc} 9 \\\\ 2  \\end{array}\\right)\\) 种，根据 基本计数原理，委员会由 3 名男性和 2 名女性组成的概率为：\n\\[\n\\frac{\\left(\\begin{array}{cc} 6 \\\\ 3  \\end{array}\\right) \\cdot \\left(\\begin{array}{cc} 9 \\\\ 2  \\end{array}\\right)}{\\left(\\begin{array}{cc} 15 \\\\ 5  \\end{array}\\right)} = \\frac{240}{1001}\n\\]\n\n\n习题 3.6 从一个具有 \\(n\\) 个物品的集合中随机抽取大小为 \\(k\\) 的样本，则某个给定的物品被抽取到的概率是多少？\n\n\n解 3.6. 如果某个给定的物品位于 \\(k\\) 中，则意味着 \\(k\\) 由给定的 1 个物品和剩余的 \\(k-1\\) 个物品（从 \\(n-1\\) 个物品中抽取的）组成，则 \\(k\\) 个物品的抽取方式为 \\(\\left(\\begin{array}{cc}  {n-1} \\\\ {k-1}  \\end{array}\\right)\\)。另外，从 \\(n\\) 个物品中抽取 \\(k\\) 个物品的方式总共有 \\(\\left(\\begin{array}{cc}  n \\\\ k  \\end{array}\\right)\\)。因此，从 \\(n\\) 个物品的集合中随机抽取大小为 \\(k\\) 的样本，则某个给定的物品被抽取到的概率为：\n\\[\n\\frac{\\left(\\begin{array}{cc}  {n-1} \\\\ {k-1}  \\end{array}\\right)}{\\left(\\begin{array}{cc}  n \\\\ k  \\end{array}\\right)} = \\frac{\\frac{(n-1)!}{(n-k)!(k-1)!}}{\\frac{n!}{(n-k)!k!}} = \\frac{k}{n}\n\\]\n\n\n习题 3.7 一个篮球队由 6 名黑人球员和 6 名白人球员组成。需要对这些球员随机地两两配对，以确定他们的室友。如果配对是随机进行的，那么黑人球员与白人球员不是室友的概率是多少？\n\n\n解 3.7. 首先，我们设想对这 6 对球员进行编号，分别是：第 1 对，第 2 对，……。对于第 1 对 球员，有 \\(\\left(\\begin{array}{cc}  12 \\\\ 2  \\end{array}\\right)\\) 种配对方式。然后，第 2 对球员则有 \\(\\left(\\begin{array}{cc}  10 \\\\ 2  \\end{array}\\right)\\) 种配对方式。对于第 3 对球员，则有 \\(\\left(\\begin{array}{cc}  8 \\\\ 2  \\end{array}\\right)\\) 种配对方式，……因此，根据 基本计数原理的泛化规则，这 6 对球员的配对方式总共有 \\(\\left(\\begin{array}{cc}  12 \\\\ 2  \\end{array}\\right) \\left(\\begin{array}{cc}  10 \\\\ 2  \\end{array}\\right) \\left(\\begin{array}{cc}  8 \\\\  2 \\end{array}\\right) \\left(\\begin{array}{cc}  6 \\\\ 2  \\end{array}\\right) \\left(\\begin{array}{cc}  4 \\\\ 2  \\end{array}\\right) \\left(\\begin{array}{cc}  2 \\\\ 2  \\end{array}\\right) = \\frac{12!}{(2!)^6}\\)。所以，不考虑分组序号的情况下，配对方式总共有 \\(\\frac{12!}{2^6 \\cdot 6!}\\)。\n同理，6 名黑（白）人球员之间配对的方式均有 \\(\\frac{ 6! }{ 2^3 \\cdot 3! }\\)。因此，黑人球员与白人球员不是室友的概率为：\\(\\frac{ (\\frac{ 6! }{ 2^3 \\cdot 3! })^2 }{ \\frac{ 12! }{ 2^6 \\cdot 6! } } = \\frac{ 5 }{ 231 } = 0.0216\\)\n\n\n习题 3.8 房间里有 \\(n\\) 个人，则他们的生日不在同一天的概率是多少？如果这个概率要低于 50%，那么 \\(n\\) 至少是多少？\n\n\n解 3.8. 在不考虑闰年的情况下，每个人的生日可以为一年 365 天中的任何一天，所以 \\(n\\) 个人的生日的可能性为 \\(365^n\\)。如果他们的生日均不在同一天，则其可能性为 \\(365 \\cdot 364 \\cdot \\cdot \\cdot (365 - n + 1)\\)。这是因为第一个人的生日可以是 365 天中的任何一天，第二个人的生日可以是剩下的 364 天中的任何一天，第三个人的生日可以是剩下的 363 天中的任何一天，以此类推。因此，他们的生日不在同一天的概率为 \\(\\frac{ 365 \\cdot 364 \\cdot \\cdot \\cdot (365 - n + 1) }{ (365)^n }\\)。\n令人惊讶的事实是，当 \\(n \\ge 23\\) 时，这个概率小于 50%。也就是说，如果房间里至少有 23 个人的时候，那么他们之中至少有两个人的生日相同的概率将超过 50%。对这个结果，许多人最初会感到惊讶，因为与 365（一年的天数）相比，23 这个数字显得如此之小。然而，每两个人其生日相同的概率是 \\(\\frac{ 365 }{ (365)^2 }=\\frac{ 1 }{ 365 }\\)。而在一个由 23 人组成的群体中，有 \\(\\left(\\begin{array}{cc}  23 \\\\ 2  \\end{array}\\right) = 253\\) 对不同的分组。从这个角度来看，这个结果就不再那么令人惊讶了。",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>概率论基础</span>"
    ]
  },
  {
    "objectID": "chapter_3/3.html#sec-3_6",
    "href": "chapter_3/3.html#sec-3_6",
    "title": "3  概率论基础",
    "section": "3.6 条件概率",
    "text": "3.6 条件概率\n在本节中，我们将介绍概率论中最重要的概念之一 ——条件概率（conditional probability）。条件概率 的重要性体现在两个方面。首先，当涉及到实验结果的部分信息可用时，或者需要根据额外信息重新计算概率时，我们经常需要利用 条件概率 来计算概率。其次，事实证明，计算事件概率的最简单的方法通常是以另一事件是否发生作为先决条件。\n如下是一个 条件概率 的例子：假设某人抛了一对骰子，该实验的样本空间 \\(S\\) 可以看作是以下 36 个结果的集合：\n\\[\nS = \\{(i, j), \\ \\ i,j \\in [1,6] \\}\n\\]\n当第一个骰子为 \\(i\\) 点并且第二个骰子为 \\(j\\) 点时，我们称对应的实验结果为 \\((i,j)\\)。假设这 36 个结果发生的可能性都是一样的，则其概率为 \\(\\frac{ 1 }{ 36 }\\)。接下来，我们观察到第一个骰子的点数是 3，那么在这种情况下，两个骰子的点数之和为 8 的概率是多少？为了计算概率，我们做如下的推理：\n\n在第一个骰子的点数是 3 的情况下，我们的实验结果最多有 6 种可能：(3,1)，(3,2)，(3,3)，(3,4)，(3,5)，(3,6)。\n因为每种结果出现的概率都是相同的，因此在第一个骰子为 3 点的条件下，其 6 种可能出现的结果的每种结果出现的概率都是 \\(\\frac{ 1 }{ 6 }\\)。\n因此，两个骰子的点数之和为 8 的结果为 (3, 5)，其概率为 \\(\\frac{ 1 }{ 6 }\\)。\n\n如果我们令 \\(E\\) 表示两个骰子的点数之和为 8 这一事件，令 \\(F\\) 表示第一个骰子的点数为 3 这一事件，则我们刚才获取到的概率称之为在 \\(F\\) 发生的条件下，\\(E\\) 的 条件概率，并记作 \\(P(E|F)\\)。\n作为一个通用的公式，\\(P(E|F)\\) 可以应用于所有的事件 \\(E\\) 和 \\(F\\)。具体来说，如果事件 \\(F\\) 发生，那么为了使得 \\(E\\) 也发生，则实际发生的事件必须同时位于 \\(E\\) 和 \\(F\\) 中，也就是说，必须在 \\(EF\\) 中。然而，由于我们知道 \\(F\\) 已经发生，因此我们可以将 \\(F\\) 视为新的样本空间，因此事件 \\(P(E|F)\\) 发生的概率将等于 \\(EF\\) 相对于 \\(F\\) 的概率。即：\n\\[\np(E|F)=\\frac{ P(EF) }{ P(F) }\n\\tag{3.1}\\]\n如 图 3.5 所示，仅当 \\(P(F) &gt; 0\\) 时，式 3.1 才有意义，这意味着，当且仅当 \\(P(F) &gt; 0\\) 时，\\(P(E|F)\\) 才有意义。\n\n\n\n\n\n\n图 3.5: \\(P(E|F)=\\frac{ EF }{ F }\\)\n\n\n\n式 3.1 给出的条件概率的定义与在大量重复试验下使用相对频率作为概率的解释是一致的。为了理解这一点，假设重复执行实验 \\(n\\) 次，由于 \\(P(F)\\) 是多次执行条件下 \\(F\\) 发生的比例，因此 \\(F\\) 大约会发生 \\(n \\cdot P(F)\\) 次。类似地，在实验中，大约有 \\(n \\cdot P(EF)\\) 次实验会出现 \\(E\\) 和 \\(F\\) 都发生的情况。因此，在大约 \\(n \\cdot P (F)\\) 次 \\(F\\) 发生的实验中，大约有 \\(n \\cdot P(EF)\\) 次 \\(E\\) 也会发生。也就是说，对于那些结果属于事件 \\(F\\) 的实验，其结果也属于事件 \\(E\\) 的比例大约是：\\(\\frac{ n \\cdot P(EF) }{ n \\cdot P(F) } = \\frac{ P(EF) }{ P(F) }\\)。\n由于当 \\(n\\) 变得越来越大时，如上的近似计算会变得越来越精确，因此 式 3.1 给出了在 \\(F\\) 已经发生的情况下 \\(E\\) 也发生的 条件概率 的适当定义。\n\n习题 3.9 一个箱子里有 40 个晶体管，其中有 5 个残品（一开始就无法使用），10 个次品（使用几个小时后才无法使用），以及 25 个合格品。从箱子里随机选取一个晶体管并投入使用，如果该晶体管没有立即失效，那么它是合格品的概率是多少？\n\n\n解 3.9. 因为抽取的晶体管没有立即失效，因此该晶体管不属于 5 个残品，因此待求解的概率为：\n\\[\n\\begin{align}\nP(合格品|非残品) &= \\frac{ P(合格品, 非残品) }{ P(非残品) } \\\\\n&= \\frac{ P(合格品) }{ P(非残品) } \\\\\n&= \\frac{ \\frac{ 25 }{ 40 } }{ \\frac{ 35 }{ 40 } } \\\\\n&= \\frac{ 5 }{ 7 }\n\\end{align}\n\\]\n应该注意的是，我们也可以通过直接处理缩减后的样本空间来获得结果。也就是说，由于我们知道所选的晶体管不是残品，问题就简化为：从包含 25 个合格品和 10 个次品的箱子中随机选择一个晶体管，该晶体管是合格品的概率是多少？显然，概率等于 \\(\\frac{ 25 }{ 35 }\\)。\n\n\n习题 3.10 琼斯所在的部门正在为那些至少有一个儿子的员工举办一场父子晚宴。这些员工都将受邀参加该晚宴，并会带上他们最小的儿子一起参加晚宴。如果已知琼斯有两个孩子，那么在他受邀参加晚宴的条件下，他的两个孩子都是男孩的概率是多少？假设样本空间为 \\(S\\) 且 \\(S =\\{(b,b),(b,g),(g,b),(g,g)\\}\\)，同时所有结果出现的可能性都相等（例如，\\((b,g)\\) 表示较小的孩子是男孩，较大的孩子是女孩）。\n\n\n解 3.10. 琼斯受邀参加晚宴这一事实相当于知道他至少有一个儿子。因此，设 \\(B\\) 为两个孩子都是男孩的事件，\\(A\\) 为至少有一个孩子是男孩的事件，我们要求的概率 \\(P(B|A)\\) 为：\\(P(B|A)=\\frac{ P(AB) }{ P(A) }\\) \\(=\\) \\(\\frac{ P(\\{(b, b)\\}) }{ P(\\{(b, b), (b, g), (g, b)\\}) }\\) \\(=\\) \\(\\frac{ \\frac{ 1 }{ 4 } }{ \\frac{ 3 }{ 4 } }\\) \\(=\\) \\(\\frac{ 1 }{ 3 }\\)。\n许多读者错误地认为，在至少有一个男孩的条件下，有两个男孩的概率是 \\(\\frac{1}{2}\\)，而不是正确答案 \\(\\frac{1}{3}\\)。因为他们认为琼斯无法参加晚宴等价于其孩子是男孩或女孩的概率。然而，这个假设本身就是错误的。务必记住，最初有四种等可能的结果，现在，至少有一个孩子是男孩的信息等价于知道结果不是 \\((g, g)\\)。因此，我们只剩下三种等可能的结果：\\((b, b)\\)、\\((b, g)\\)、\\((g, b)\\)，从而表明琼斯参加晚宴时其另外一个孩子为女孩的可能性是为男孩的两倍。\n\n对 式 3.1 的两边都乘以 \\(P(F)\\)，我们得到：\n\\[\nP(EF) = P(F) \\cdot P(E|F)\n\\tag{3.2}\\]\n式 3.2 表明事件 \\(E\\) 和 \\(F\\) 同时发生的概率等于 \\(F\\) 发生的概率乘以在 \\(F\\) 发生条件下 \\(E\\) 发生的条件概率。在计算事件交集的概率时，式 3.2 通常非常有用。习题 3.11 所示的例子说明了这一点。\n\n习题 3.11 佩雷斯女士估计，她所在的公司有 30% 的可能性会在菲尼克斯设立分公司。如果设立了公司真的在菲尼克斯设立分公司，她有 60% 的把握让公司任命其为新的分公司的经理。那么，佩雷斯女士成为菲尼克斯分公司经理的概率是多少？\n\n\n解 3.11. 令 \\(B\\) 表示公司会在菲尼克斯设立分公司，\\(M\\) 表示任命佩雷斯女士为新的分公司的经理，则待求解的概率为 \\(P(BM)\\)，根据 式 3.2 有：\\(P(BM) = P(B)P(M|B) = 0.3 \\cdot 0.6 = 0.18\\)。因此，佩雷斯女士有 18% 的概率成为菲尼克斯分公司的经理。",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>概率论基础</span>"
    ]
  },
  {
    "objectID": "chapter_3/3.html#sec-3_7",
    "href": "chapter_3/3.html#sec-3_7",
    "title": "3  概率论基础",
    "section": "3.7 贝叶斯公式",
    "text": "3.7 贝叶斯公式\n令 \\(E\\) 和 \\(F\\) 为事件，则我们可以用如下的式子表示 \\(E\\)：\\(E = EF \\cup EF^c\\)。如 图 3.6 为了让一个点位于 \\(E\\) 中，要么这个点即位于 \\(E\\) 又位于 \\(F\\) 中，要么这个点位于 \\(E\\) 中但是不位于 \\(F\\) 中。\n\n\n\n\n\n\n图 3.6: \\(E=EF \\cup EF^c\\)\n\n\n\n因为 \\(EF\\) 和 \\(EF^c\\) 是互斥的，根据 公理3 有：\n\\[\n\\begin{align}\nP(E)&=P(EF) + P(EF^c) \\\\\n&=P(E|F)P(F) + P(E|F^c)P(F^c) \\\\\n&=P(E|F)P(F) + P(E|F^c)[1 - P(F)]\n\\end{align}\n\\tag{3.3}\\]\n式 3.3 表明，事件 \\(E\\) 的概率是 \\(F\\) 发生时 \\(E\\) 发生的条件概率和 \\(F\\) 不发生时 \\(E\\) 发生的条件概率的加权平均数，其中，每个条件概率的权重与它所基于的事件发生的概率相同。式 3.3 是一个极其有用的公式，因为 式 3.3 允许我们通过某个事件的先决条件事件是否发生来计算该事件的概率。也就是说，在许多情况下，直接计算事件的概率非常困难，但一旦我们知道某个第二事件是否发生，计算该事件的概率就变得比较简单了。\n\n习题 3.12 一家保险公司认为人可以分为两类——容易出意外的人和不容易出意外的人。他们的统计数据显示，一个容易出意外的人在固定的 1 年期内某个时间点发生意外的概率是 0.4，而对于一个不容易出意外的人来说，这个概率则降低到了 0.2。如果我们假设 30% 的人容易出意外，那么新购买保险的人在购买保险后一年内发生意外的概率是多少？\n\n\n解 3.12. 首先根据新购买保险的人是否容易出意外进行条件化，以获得所需的概率。设 \\(A_1\\) 表示事件：新购买保险的人在购买后一年内会发生意外，设 \\(A\\) 表示新购买保险的人容易出意外事件。因此：\\(P(A_1)=P(A_1|A)P(A) + P(A_1|A^c)P(A^c) = 0.26\\)。\n\n在接下来的一系列示例中，我们将展示如何根据新的信息重新评估初始概率。也就是说，我们将展示如何将新信息与初始概率相结合，以获得新的概率。\n\n习题 3.13 双胞胎可以是同卵双胞胎，也可以是异卵双胞胎。同卵双胞胎，也称为单卵双胞胎，是由一个受精卵分裂成两个遗传上完全相同的胚胎。因此，同卵双胞胎总是拥有相同的基因组。异卵双胞胎，也称为双卵双胞胎，是由两个单独的卵子受精并进入到子宫所形成。异卵双胞胎之间的遗传联系与在不同时间出生的兄弟姐妹一样。洛杉矶某县的一位科学家想知道：目前该县出生的双胞胎中同卵双胞胎的比例，于是他委托该县的一位统计学家来研究这个问题。该统计学家最初要求县里的每家医院记录所有双胞胎的出生情况，并注明这些双胞胎是否是同卵双胞胎。然而，医院告诉她，确定新生双胞胎是否为同卵双胞胎并不是一项简单的任务，因为这需要双胞胎父母的许可，并执行复杂且昂贵的 DNA 研究，但是医院无力承担这些研究费用。经过一些讨论，统计学家只要求医院提供所有双胞胎出生情况的清单数据，并注明这些双胞胎是否是同性别。当统计学家收集到的数据表明，大约 64% 的双胞胎出生时是同性别时，统计学家宣称：大约 28% 的双胞胎是同卵双胞胎。统计学家是怎么得出这个结论的？\n\n\n解 3.13. 统计学家认为同卵双胞胎总是同性别，而异卵双胞胎，就像任何一对兄弟姐妹一样，有 \\(\\frac{1}{2}\\) 的概率是同性别。设 \\(I\\) 为一对双胞胎是同卵双胞胎的事件，\\(SS\\) 为一对双胞胎是同性别的事件。则，\n\\[\n\\begin{align}\nP(SS) &= P(SS|I)P(I) + P(SS|I^c)P(I^c) \\\\\n&=1 \\cdot P(I) + \\frac{1}{2} \\cdot \\bigg(1 - P(I)\\bigg) \\\\\n&= \\frac{1}{2} + \\frac{1}{2}P(I) \\\\\n&\\approx 0.64 \\\\\n\\therefore P(I) &\\approx 0.28\n\\end{align}\n\\]\n\n\n习题 3.14 让我们重新思考 习题 3.12，假设一名新购买保险的人在购买保险后一年内发生了意外，则该人属于容易出意外的分类的概率是多少？\n\n\n解 3.14. 最初，在购买保险的那一刻，我们假设他有 30% 的几率是属于容易出意外的分类。也就是说，\\(P(A) = 0.3\\)。然而，基于他在一年内发生了意外的事实，我们现在需要重新评估他容易出意外的概率：\n\\[\n\\begin{align}\nP(A|A_1)&=\\frac{ P(AA_1) }{ P(A_1) } \\\\\n&= \\frac{ P(A)P(A_1|A) }{ P(A_1) } \\\\\n&= \\frac{ 0.3 \\cdot 0.4 }{ 0.26 } \\\\\n&= 0.4615\n\\end{align}\n\\]\n\n\n习题 3.15 在回答一个多项选择题时，一个学生要么知道答案，要么猜答案。设 \\(p\\) 为她知道答案的概率，\\(1-p\\) 为她猜答案的概率。假设一个学生猜对的概率是 \\(\\frac{1}{m}\\)，其中 \\(m\\) 是多项选择题的选项数量。如果一个学生的回答是正确的，那么她知道问题答案的概率是多少？\n\n\n解 3.15. 令 \\(C\\) 为事件：该学生回答对了该问题，\\(K\\) 为事件：该学生知道答案，则该学生回答正确时，她知道问题答案的概率为：\\(P(K|C) = \\frac{P(KC)}{P(C)}\\)。\n\\[\n\\begin{align}\n\\because P(KC) &= P(C|K)P(K) \\\\\n&=1 \\cdot p \\\\\n&=p\n\\end{align}\n\\]\n为了计算最终的概率，我们还需要计算 \\(P(C)\\) （该学生可以回答正确的概率）： \\[\n\\begin{align}\nP(C) &= P(C|K)P(K) + P(C|K^c)P(K^c) \\\\\n&=p + \\frac{1}{m} \\cdot (1-p) \\\\\n\\therefore P(K|C)&= \\frac{p}{p + \\frac{1}{m} \\cdot (1-p)} \\\\\n&=\\frac{mp}{1+(m-1)p}\n\\end{align}\n\\]\n因此，如果 \\(m=5\\)，\\(p=\\frac{1}{2}\\)，则如果该学生回答正确时，他知道答案的概率为 \\(\\frac{5}{6}\\)。\n\n\n习题 3.16 对于某种疾病的检测而言，实验室的血液检测有 99% 的准确率。然而，该血液检测也会对 1% 的健康受检者产生 “假阳性” 结果（也就是说，如果一个健康的人接受检测，那么检测结果会有 0.01 的概率显示他或她患有该疾病）。如果人群中有 0.5% 的人确实患有这种疾病，那么一个人的检测结果为阳性时，他患有这种疾病的概率是多少？\n\n\n解 3.16. 令 \\(D\\) 为事件：受检测的人患有该疾病，\\(E\\) 为事件：检测结果为阳性。则：\n\\[\n\\begin{align}\nP(D|E) &= \\frac{P(DE)}{P(E)} \\\\\n&= \\frac{P(E|D)P(D)}{P(E|D)P(D) + P(E|D^c)P(D^c)} \\\\\n&=\\frac{0.99 \\cdot 0.005}{0.99 \\cdot 0.005 + 0.01 \\cdot 0.995} \\\\\n&= 0.3322\n\\end{align}\n\\]\n因此，如果检测结果为阳性，则该人实际上患有该疾病的概率只有 33%。因为血液检测似乎是一种很好的方式，因此很多学生认为这个比例应该会更高，所以他们经常对这个结果感到惊讶。因此是时候提出第二个论点了，尽管第二个论点不如前面的论点严格，但它可能更具启发性。\n由于实际患有这种疾病的人口比例为 0.5%，因此平均而言，每 200 个接受检测的人中就有 1 人患有这种疾病。该检测将以 0.99 的概率确认这个人患有疾病。因此，平均而言，每 200 个接受检测的人中，该检测将确认 0.99 人患有疾病。另一方面，在（平均）199 个健康人中，该检测将错误地认为有 \\(199 \\cdot 0.01\\) 的人患有疾病。因此，对于该检测确认的患有疾病的每 0.99 个病人而言，平均有 1.99 个健康人被错误地认为患有该疾病。因此，当检测结果显示一个人患病时，其结果是正确的比例是：\\(\\frac{0.99}{0.99 + 1.99}=0.3322\\)\n\n当需要根据新的信息更新概率时，式 3.3 非常有用。本章接下来的例子将体现这一点。\n\n习题 3.17 在刑事调查的某个阶段，负责调查的警官有 60% 的信心认为某个嫌疑人有罪。假设现在发现了新的证据，显示罪犯具有某种特征（如左撇子、秃头、棕色头发等）。如果有 20% 的人具有这种特征，那么如果嫌疑人具有犯罪特征时，警官对嫌疑人有罪的信心应该是多少？\n\n\n解 3.17. 令 \\(G\\) 表示事件：嫌疑人有罪，\\(C\\) 表示事件：嫌疑人具有罪犯特征。则：\n\\[\n\\begin{align}\nP(G|C)&=\\frac{P(GC)}{P(C)} \\\\\n\\because P(GC) &= P(G)P(C|G) \\\\\n&= 0.6 \\cdot 1 \\\\\n&= 0.6 \\\\\n\\because P(C) &= P(C|G)P(G) + P(C|G^c)P(G^c) \\\\\n&=1 \\cdot 0.6 + 0.2 \\cdot 0.4 \\\\\n&=0.68\n\\end{align}\n\\]\n\\(P(C|G^c)\\) 表示如果嫌疑人实际上是清白的，那么他具有犯罪特征的概率，我们假设该概率和等于具有这种特征的人比例一致，也就是 0.2。于是：\\(P(G|C) = \\frac{0.6}{0.68} = 0.882\\)。\n\n\n习题 3.18 现在让我们假设犯罪者拥有犯罪特定的可能性为 90%，那么在这种情况下，嫌疑人犯罪的可能性有多大？\n\n\n解 3.18. 在这种情况下，情况与以前相同，只是现在嫌疑人在犯罪的情况下具有该特征的概率是0.9，而不是1。于是：\n\\[\n\\begin{align}\nP(G|C)&=\\frac{P(GC)}{P(C)} \\\\\n\\because P(GC) &= P(G)P(C|G) \\\\\n&= 0.6 \\cdot 0.9 \\\\\n&= 0.54 \\\\\n\\because P(C) &= P(C|G)P(G) + P(C|G^c)P(G^c) \\\\\n&=0.9 \\cdot 0.6 + 0.2 \\cdot 0.4 \\\\\n&=0.62 \\\\\n\\therefore P(G|C) &= \\frac{0.54}{0.62} \\\\\n&=0.871\n\\end{align}\n\\]\n\n假设 \\(F_1, F_2, ..., F_n\\) 是互斥事件，则 \\(\\bigcup_{i=1}^{n}{F_i} = S\\)。换句话说，\\(F_i\\) 中有且仅有一个事件会发生。则有：\n\\[\nE = \\bigcup_{i=1}^{n}{(EF_i)}\n\\]\n基于 \\(EF_i\\) 为互斥事件的事实，我们有：\n\\[\n\\begin{align}\nP(E)&=\\sum_{i=1}^{n}{P(EF_i)} \\\\\n&=\\sum_{i=1}^{n}{\\big(P(E|F_i)P(F_i)\\big)}\n\\end{align}\n\\tag{3.4}\\]\n对于 \\(n\\) 个互斥事件而言，式 3.3 可以泛化为 式 3.4。式 3.4 表示在给定一组互斥事件 \\(F_1,F_2,...,F_n\\) 时，我们如何通过 \\(F_i\\) 发生时的 \\(E\\) 的条件概率来计算 \\(P(E)\\)。也就是说，\\(P(E)\\) 等于 \\(P(E|F_i)\\) 的加权平均值，其权重为对应的 \\(F_i\\) 发生的概率。\n现在假设 \\(E\\) 已经发生，我们希望确定哪一个 \\(F_j\\) 发生了。根据 式 3.4，我们有：\n\\[\n\\begin{align}\nP(F_j|E)&=\\frac{P(EF_j)}{P(E)} \\\\\n&=\\frac{P(E|F_j)P(F_j)}{\\sum_{i=1}^{n}{\\big(P(E|F_i)P(F_i)\\big)}}\n\\end{align}\n\\tag{3.5}\\]\n式 3.5 就是 贝叶斯公式（Bayes’ formula），其以英国哲学家 Thomas Bayes 的名字命名。 如果我们把事件 \\(F_j\\) 看作是关于某个主题的可能的“假设”（hypotheses），那么 贝叶斯公式 可以解释为：如何通过实验的证据来修改实验前对这些假设（\\(P(F_j)\\)）的看法。\n\n习题 3.19 一架飞机失踪了，人们推测它坠毁在三个可能区域的概率是相等的。假设 \\(1 - \\alpha_i\\) 表示当飞机确实坠毁在区域 \\(i\\) 时，搜索该区域能发现飞机的概率，其中 \\(i = 1, 2, 3\\)。（常数 \\(\\alpha_i\\) 被称为 忽视概率（overlook probabilities），因为它们代表忽视飞机的概率。\\(\\alpha_i\\) 通常归因于这些区域的地理和环境条件。在区域 1 没有搜索到飞机的情况下，飞机位于区域 \\(i\\) 的条件概率是多少（\\(i = 1, 2, 3\\)）？\n\n\n解 3.19. 令 \\(R_i\\) 为事件：飞机位于区域 \\(i\\)，令 \\(E\\) 为事件：在区域 1 没有搜索到飞机。根据贝叶斯公式，我们有：\n\\[\n\\begin{align}\nP(R_1|E)&=\\frac{P(ER_1)}{P(E)} \\\\\n&=\\frac{P(E|R_1)P(R1)}{\\sum_{i=1}^{3}(P(E|R_i)P(R_i))} \\\\\n&=\\frac{\\alpha_1 \\cdot \\frac{1}{3}}{\\alpha_1 \\cdot \\frac{1}{3} + 1 \\cdot \\frac{1}{3} + 1 \\cdot \\frac{1}{3}} \\\\\n&=\\frac{\\alpha_1}{\\alpha_2 + 2} \\\\\nFor\\ j=&2,3: \\\\\nP(R_j|E)&=\\frac{P(E|R_j)P(R_j)}{P(E)} \\\\\n&=\\frac{1 \\cdot \\frac{1}{3}}{\\alpha_1 \\cdot \\frac{1}{3} + \\frac{1}{3} + \\frac{1}{3}} \\\\\n&=\\frac{1}{\\alpha_1 + 2}\n\\end{align}\n\\]\n因此，例如，如果 \\(\\alpha_1\\) = 0.4，那么在该区域搜索后未发现飞机的情况下，飞机位于区域 1 的条件概率为 \\(\\frac{1}{6}\\)，而飞机位于区域 2 和区域 3 的条件概率都等于 \\(\\frac{1}{2.4}=\\frac{5}{12}\\)。",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>概率论基础</span>"
    ]
  },
  {
    "objectID": "chapter_3/3.html#sec-3_8",
    "href": "chapter_3/3.html#sec-3_8",
    "title": "3  概率论基础",
    "section": "3.8 独立事件",
    "text": "3.8 独立事件\n本章之前的例子表明，给定 \\(F\\) 时，\\(E\\) 的条件概率 \\(P(E|F)\\) 通常不等于 \\(E\\) 的无条件概率 \\(P(E)\\)。换句话说，如果 \\(F\\) 发生了，那么通常会改变 \\(E\\) 发生的可能性。对于特殊的场景下，当 \\(P(E|F)\\) 等于 \\(P(E)\\) 时，我们说 \\(E\\) 与 \\(F\\) 是 独立 的。也就是说，如果 \\(F\\) 是否发生不会改变 \\(E\\) 发生的概率，那么 \\(E\\) 就是 独立 于 \\(F\\) 的。\n因为 \\(P(E|F)=\\frac{ P(EF) }{ P(F) }\\)，如果\n\\[\nP(EF)=P(E)P(F)\n\\tag{3.6}\\]\n则 \\(E\\) 和 \\(F\\) 是 独立 的。\n因为 式 3.6 中，\\(E\\) 和 \\(F\\) 是对称的，因此如果 \\(E\\) 和 \\(F\\) 是 独立 的，那么 \\(F\\) 和 \\(E\\) 也是 独立 的。\n\n定义 3.2 如果两个事件 \\(E\\) 和 \\(F\\) 满足 \\(P(EF)=P(E)P(F)\\)，则 \\(E\\) 和 \\(F\\) 是 独立事件（independent events）。如果两个事件不是 独立事件，则他们之间是 相关的（dependent）。\n\n\n例 3.4 从一副普通的扑克牌（52 张，去掉大小王）中随机抽取一张牌。如果 \\(A\\) 表示抽到的牌是 A，\\(H\\) 表示抽到的牌是红桃，那么 \\(A\\) 和 \\(H\\) 是独立的，因为 \\(P(AH) = \\frac{1}{52}\\)，而 \\(P(A) = \\frac{4}{52}\\) 且 \\(P(H) = \\frac{13}{52}\\)。\n\n\n例 3.5 如果我们用 \\(E\\) 来表示下一任美国总统是共和党人，用 \\(F\\) 来表示未来一年内会发生大地震，那么大多数人可能都会假设 \\(E\\) 和 \\(F\\) 是独立的。然而，如果 \\(G\\) 表示未来两年内会发生经济衰退，则 \\(E\\) 与 \\(G\\) 是否是 独立事件 可能就会存在一些争议。\n\n接下来我们将说明：如果 \\(E\\) 和 \\(F\\) 是独立的，则 \\(E\\) 和 \\(F^c\\) 也是独立的。\n\n命题 3.3 如果 \\(E\\) 和 \\(F\\) 是 独立 的，则 \\(E\\) 和 \\(F^c\\) 也是 独立 的。\n\n\n\n\n\n\n\n命题 3.3 的证明过程\n\n\n\n假设 \\(E\\) 和 \\(F\\) 是 独立事件。因为 \\(E = EF \\cup EF^c\\)，并且显然， \\(EF\\) 和 \\(EF^c\\) 是互斥事件，于是有：\n\\[\n\\begin{align}\nP(E)&=P(EF) + P(EF^c) \\\\\n&=P(E)P(F) + P(EF^c) \\\\\n\\therefore P(EF^c)&= P(E)(1-P(F)) \\\\\n&=P(E)P(F^c)\n\\end{align}\n\\]\n\n\n因此，如果 \\(E\\) 独立于 \\(F\\)，那么 \\(E\\) 发生的概率不会因 \\(F\\) 是否发生而改变。\n现在假设 \\(E\\) 即独立于 \\(F\\)，也独立于 \\(G\\)。那么 \\(E\\) 是否肯定独立于 \\(FG\\)？令人惊讶的是，答案是否定的。\n\n例 3.6 抛两颗公平（骰子的点是等概率事件）的骰子。令 \\(E_7\\) 表示两颗骰子的点数之和为 7，令 \\(F\\) 表示第一颗骰子的点数为 4，令 \\(T\\) 表示第二颗骰子的点数为 3。可以证明（习题 36）\\(E_7\\) 独立于 \\(F\\)，且 \\(E_7\\) 也独立于 \\(T\\)，但显然 \\(E_7\\) 不独立于 \\(FT\\)（因为 \\(P(E_7|FT) = 1\\)）。\n\n根据 例 3.6，看起来，对于 3 个事件之间的独立性的定义，仅仅满足 \\(\\left(\\begin{array}{cc}  3 \\\\ 2  \\end{array}\\right)\\) 对事件之间是独立的是不够的。\n\n定义 3.3 对于三个事件：\\(E\\), \\(F\\), \\(G\\)，如果他们满足：\n\\[\n\\begin{align}\nP(EFG) &= P(E)P(F)P(G) \\\\\nP(EF) &= P(E)P(F) \\\\\nP(EG) &= P(E)P(G) \\\\\nP(FG) &= P(F)P(G)\n\\end{align}\n\\]\n则 \\(E\\)，\\(F\\)，\\(G\\) 是相互独立的。\n\n需要注意的是，如果事件 \\(E\\)、\\(F\\)、\\(G\\) 是独立的，那么 \\(E\\) 和由 \\(F\\) 和 \\(G\\) 形成的任何事件之间也是独立的。例如，\\(E\\) 与 \\(F \\cup G\\) 独立，因为：\n\\[\n\\begin{align}\nP\\bigg(E(F \\cup G)\\bigg) &= P(EF \\cup EG) \\\\\n&=P(EF) + P(EG) - P(EFG) \\\\\n&=P(E)P(F) + P(E)P(G) - P(E)P(FG) \\\\\n&=P(E)\\bigg(P(F) + P(G) - P(FG)\\bigg) \\\\\n&=P(E)P(F \\cup G)\n\\end{align}\n\\]\n当然，我们可以将 定义 3.3 扩展到大于 3 个事件的范围。对于 \\(n\\) 个事件 \\(E_1, E_2, ..., E_n\\)，如果这 \\(n\\) 个事件的所有的子集 \\(E_{1}, E_{2}, ..., E_{r},\\ r \\le n\\) 都满足 \\(P(E_{1}E_{2}...E_{r})\\) = \\(P(E_1)P(E_2)...P(E_r)\\)，则这 n 个事件是相互独立的。\n有时，我们所考虑的实验需要执行一系列子实验。例如，如果实验为连续抛掷硬币，那么我们可以将每次抛掷都视为一个子实验。在许多情况下，我们会假设任何一个子实验的结果对其他子实验没有影响，此时，我们说这些子实验之间是 独立 的。\n\n习题 3.20 如果一个系统由 \\(n\\) 个独立组件构成，且当至少有一个组件工作时，该系统就能工作，那么我们就称这个系统为并行系统，如 图 3.7。对于这样一个系统，如果组件 \\(i\\) 与其他组件独立，并以\\(p_i, i=1,2,...,n\\) 的概率发挥作用，那么整个系统可工作的概率是多少？\n\n\n\n\n\n\n图 3.7: 并行系统示意图\n\n\n\n\n\n解 3.20. 令 \\(A_i\\) 表示事件：组件 \\(i\\) 可以工作，则：\n\\[\n\\begin{align}\nP(系统可工作) &= 1 - P(系统不可工作) \\\\\n&= 1 - P(所有组件均无法工作) \\\\\n&= 1 - P(A_1^c A_2^c \\cdot \\cdot \\cdot A_n^c) \\\\\n&= 1 - \\prod_{i=1}^{n}{P(A_i^c)} \\\\\n&= 1 - \\prod_{i=1}^{n}{(1-p_i)}\n\\end{align}\n\\]\n\n\n习题 3.21 有 \\(n\\) 张优惠券，每张优惠券的类型均不同且相互独立，第 \\(j\\) 张优惠券的类型为 \\(j\\)，且其出现的概率为 \\(p_j\\)，\\(\\sum_{j=1}^{n}{p_j}=1\\)。我们从其中选取 \\(k\\) 张优惠券，计算在第 \\(i\\) 类优惠券存在的情况下，第 \\(j\\) 类优惠券也存在的概率（\\(i \\ne j\\)）。\n\n\n解 3.21. 令 \\(A_r\\) 为事件：我们收集的优惠券中存在类型为 \\(r\\) 的优惠券，则 \\(P(A_j|A_i)=\\frac{ P(A_jA_i) }{ P(A_i) }\\)。可以考虑使用补集来计算 \\(P(A_i)\\) 和 \\(P(A_jA_i)\\)：\n\\[\n\\begin{align}\nP(A_i) &= 1-P(A_i^c) \\\\\n&= 1-P\\{k张优惠券均不是第 i 类优惠券\\} \\\\\n&= 1 - \\prod_{l=1}^{k}{\\big(1 - P(A_i)\\big)} \\\\\n&= 1 - (1 - p_i)^k \\\\\nP(A_iA_j) &= 1 - P(A_i^c \\cup A_j^c) \\\\\n&= 1 - \\bigg(P(A_i^c) + P(A_j^c) - P(A_i^c A_j^c)\\bigg) \\\\\n&= 1 - (1-p_i)^k - (1 - p_j)^k + (1 - p_i - p_j)^k\n\\end{align}\n\\]\n因此，\\(P(A_j|A_i)=\\frac{ 1 - (1-p_i)^k - (1 - p_j)^k + (1 - p_i - p_j)^k }{ 1 - (1 - p_i)^k }\\)。\n\n\n\n\n\n\n\n务必区分 独立事件 和 互斥事件\n\n\n\n在 小节 3.2 中，我们提到：\n\n如果 \\(EF = \\emptyset\\)，则意味着 \\(E\\) 和 \\(F\\) 不能同时发生，此时我们称 \\(E\\) 和 \\(F\\) 为 互斥事件。\n\n在本节中，我们提到：\n\n如果 \\(F\\) 是否发生不会改变 \\(E\\) 发生的概率，那么 \\(E\\) 和 \\(F\\) 就是 相互独立 的。且 \\(P(EF)=P(E)P(F)\\)。\n\n我们往往会混淆 独立事件 和 互斥事件 的概念，互斥指的是两个随机事件没有共同的基本事件，也即这两个事件不可能同时发生。从集合观点看，即两个事件没有交集，即 \\(EF = \\emptyset\\)。\n那么，如果 \\(E\\) 和 \\(F\\) 独立，是否意味着：\n\\[\nE和F相互独立 \\Longleftrightarrow E和F没有关联 \\Longleftrightarrow E \\cap F = \\emptyset\n\\]\n显然，这是不对的。比如，生一个孩子，现有两事件：\n\n\\(E\\)：孩子是男孩\n\\(F\\)：孩子是女孩\n\n显然，\\(E\\) 和 \\(F\\) 是互斥的。\n如果生两个孩子，也有两个事件：\n\n\\(A\\)：第一个孩子是男孩\n\\(B\\)：第二个孩子是女孩\n\n此时，\\(A\\) 和 \\(B\\) 是相互独立的，因为第一个孩子的性别肯定和第二个孩子的性别是没有关联的。那么事件 \\(AB\\)（也就是生两个孩子，第一个孩子是男孩且第二个孩子是女孩）的概率是多少 呢？\n显然，\\(P(AB)=\\frac{ 1 }{ 4 }\\)。此时，即 \\(A\\) 和 \\(B\\) 是相互独立的，\\(A \\cap B\\) 也是存在的。",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>概率论基础</span>"
    ]
  },
  {
    "objectID": "chapter_3/3.html#习题",
    "href": "chapter_3/3.html#习题",
    "title": "3  概率论基础",
    "section": "习题",
    "text": "习题\n\n一个盒子里有三个弹珠——一个红色，一个绿色，和一个蓝色。考虑一个实验：从盒子里取出一个弹珠，然后将其放回盒子中，再从中抽取第二个弹珠。\n\n\n描述该实验的样本空间。\n在取出第一个弹珠后不将其放回盒子，然后取出第二个弹珠，在该场景下，描述该实验的样本空间。\n\n\n一个实验为抛三次硬币，则这个实验的样本空间是什么？实验结果中正面朝上的次数多于反面朝上的次数的事件是什么？\n令 \\(S = \\{1,2,3,4,5,6,7\\}\\)，\\(E = \\{1,3,5,7\\}\\)，\\(F = \\{7,4,6\\}\\)，\\(G = \\{1,4\\}\\)，计算如下事件：\n\n\n\\(EF\\)\n\\(EG^c\\)\n\\(E^c(F \\cup G)\\)\n\\(E \\cup FG\\)\n\\(EF^c \\cup G\\)\n\\(EG \\cup FG\\)\n\n\n抛两枚骰子，设 \\(E\\) 为事件：两枚骰子点数之和为奇数；\\(F\\) 为事件：第一枚骰子点数为 1；\\(G\\) 为事件：两枚骰子点数之和为 5。描述如下的事件：\\(EF\\)、\\(E \\cup F\\)、\\(FG\\)、\\(EF\\) 的补集（\\(EF^c\\)）以及 \\(EFG\\)。\n一个系统由四个组件组成，每个组件要么正常工作，要么不工作。考虑一个实验，该实验包括观察每个组件的状态，并将实验的结果表示为向量 \\((x_1, x_2, x_3, x_4)\\)，如果第 \\(i\\) 个组件正在工作，则 \\(x_i\\) 等于 1，否则 \\(x_i\\) 等于 0。\n\n\n这个实验的样本空间中有多少种结果？\n假设系统将在以下情况下工作：如果组件 1 和 2 都正常工作，或者如果组件 3 和 4 都正常工作。则系统可以工作的事件中所有的结果是什么？\n设 \\(E\\) 为事件：组件 1 和 3 都不工作，则事件 \\(E\\) 中包含多少种结果？\n\n\n\\(E\\)，\\(F\\)，\\(G\\) 是三个事件，给出如下事件的表达式：\n\n\n只有 \\(E\\) 发生\n只有 \\(E\\) 和 \\(F\\) 发生，但是 \\(F\\) 不发生\n至少有一个事件发生\n至少有两个事件发生\n三个事件都发生\n三个事件都不发生\n最多有一个事件发生\n最多有两个事件发生\n只有两个事件发生\n最多三个事件都发生\n\n\n给出如下的表达式所表示的事件：\n\n\n\\(E \\cup E^c\\)\n\\(EE^c\\)\n\\((E \\cup F)(E \\cup F^c)\\)\n\\((E \\cup F)(E^c \\cup F)(E \\cup F^c)\\)\n\\((E \\cup F)(F \\cup G)\\)\n\n\n用韦恩图来表示如下的关系：\n\n\n如果 \\(EF \\subset E\\)， 则 \\(E \\subset E \\cup F\\)\n如果 \\(E \\subset F\\)，则 \\(F^c \\subset E^c\\)\n交换律是正确的\n结合律是正确的\n\\(F = FE \\cup FE^c\\)\n\\(E \\cup F = E \\cup E^cF\\)\n德摩根定律是正确的\n\n\n对于如下的韦恩图，用 \\(E\\)、\\(F\\) 和 \\(G\\) 来描述图中罗马数字 I~VII 表示的事件。\n\n\n10.证明：如果 \\(E \\subset F\\)，则 \\(P(E) \\le P(F)\\)。\n\n证明如下所示的布尔不等式（Boole’s inequality）：\n\n\\[\nP\\bigg(\\bigcup_{i=1}^{n}{E_i}\\bigg) \\le \\sum_{i=1}^{n}{P(E_i)}\n\\]\n\n证明：如果 \\(P(E)=0.9\\)，\\(P(F)=0.9\\)，则 \\(P(EF) \\ge 0.8\\)。\n\n\n证明邦费罗尼不等式（Bonferroni’s inequality）：\\(P(EF) \\ge P(E) + P(F) -1\\)。\n\n\n证明：\n\n\n\\(P(EF^c)=P(E) - P(EF)\\)\n\\(P(E^cF^c) = 1 - P(E) -P(F) + P(EF)\\)\n\n\n证明：事件 \\(E\\) 或 \\(F\\) 中恰好有一个发生的概率等于 \\(P(E) + P(F) - 2P(EF)\\)。\n计算表达式的值：\\(\\left(\\begin{array}{cc}  9 \\\\ 3  \\end{array}\\right)\\)，\\(\\left(\\begin{array}{cc}  9 \\\\ 6  \\end{array}\\right)\\)，\\(\\left(\\begin{array}{cc}  7 \\\\ 2  \\end{array}\\right)\\)，\\(\\left(\\begin{array}{cc}  7 \\\\ 5  \\end{array}\\right)\\)，\\(\\left(\\begin{array}{cc}  10 \\\\ 7  \\end{array}\\right)\\)。\n证明：\\(\\left(\\begin{array}{cc}  n \\\\ r  \\end{array}\\right)\\) = \\(\\left(\\begin{array}{cc}  n \\\\ n-r  \\end{array}\\right)\\)。\n证明：\\(\\left(\\begin{array}{cc}  n \\\\ r  \\end{array}\\right)\\) = \\(\\left(\\begin{array}{cc}  n-1 \\\\ r-1  \\end{array}\\right) + \\left(\\begin{array}{cc}  n-1 \\\\ r  \\end{array}\\right)\\)。\n5 个男孩和 10 个女孩随机排成一行——也就是说，15! 中的每种排列的可能性都是一样的。\n\n\n第 4 个位置的人是男孩的概率是多少？\n第 12 个位置的人是男孩的概率是多少？\n某个男孩排在第 3 个位置的概率是多少？\n\n\n考虑一个由 23 个不相关的人组成的集合。因为每两个人在同一天出生的概率为 ，并且总共有 \\(\\left(\\begin{array}{cc}  23 \\\\ 2  \\end{array}\\right)\\) = 253 对组合方式。那么，为什么至少两个人在同一天出生的概率不是 \\(\\frac{253}{365}\\)？\n把 3 个不同的整数值分别写在 3 张不同的卡片上，并随机地将卡片标记为 A、B 和 C。比较 A 卡片和 B 卡片上的值，这两个值中较小的值所在的卡片与 C 卡片上的值比较，那么 A、B 两张卡片中较小数值的卡片的数值小于 C 卡片上的数值的概率是多少？\n事件 \\(A\\) 发生的可能性是 60%。如果 \\(A\\) 不发生，那么 \\(B\\) 发生的可能性是 10%。\n\n\nA 或 B 中至少有一个发生的概率是多少？\n如果 \\(A\\) 是事件：民主党在 2012 年赢得总统竞选，\\(B\\) 是事件：2013 年洛杉矶发生 6.2 级或更高级别地震，你认为 \\(A\\) 和 \\(B\\) 同时发生的概率是多少？你做出了什么假设？\n\n\n一个大型会计公司的 100 名会计师的年薪样本均值为 130000 美元，样本标准差为 20000 美元。如果从这个群体中随机选择一名会计师，则：\n\n\n其年薪在 90000 美元和 170000 美元之间的概率是多少？\n其年薪超过 150,000 美元的概率是多少？\n\n\n提示：使用切比雪夫不等式。\n\n\n有三张卡片，一张两面都涂成红色，一张两面都涂成黑色，还有一张一面涂成红色、另一面涂成黑色。随机选择一张卡片放在桌子上，如果朝上的一面是红色，那么另一面也是红色的概率是多少？\n一对夫妇有两个孩子。如果老大是女孩，那么两个孩子都是女孩的概率是多少？\n某大学的学生中有 52% 是女性。这所大学中，主修计算机科学的学生占比 5%，主修计算机科学的女生占比 2%。如果随机选择一名学生，计算以下条件概率：\n\n\n如果该学生主修计算机科学，该该学生是女生的概率。\n如果该学生是女生，该学生主修计算机科学的概率。\n\n\n调研 500 对参加工作的已婚夫妇的年薪，得到了以下信息：\n\n\n\n\n\n\n\n\n\n\nHusband &lt; $50,000\nHusband &gt; $50,000\n\n\n\n\nWife &lt; $50,000\n212\n198\n\n\nWife &gt; $50,000\n36\n54\n\n\n\n从上表中可以看出，妻子的收入超过丈夫，并且丈夫的收入低于 50000 美元的夫妇数量为 36。\n如果从这 500 对夫妇中随机选择一对，那么：\n\n丈夫的收入低于 50000 美元的概率是多少？\n丈夫收入超过 50000 美元的情况下，妻子收入超过 50000 美元的条件概率是多少？\n丈夫收入低于 50000 美元的情况下，妻子收入超过 50000 美元的条件概率是多少？\n\n\n当地有两家工厂生产微波炉。A 工厂生产的每个微波炉有 0.05 的概率是次品，B 工厂生产的每个微波炉有 0.01 的概率是次品。假设你购买了两台在同一工厂生产的微波炉，这两台微波炉是这两家工作生产的可能性是相同的。如果你发现第一台微波炉是次品，那么另一台也是次品的条件概率是多少？\n抛三个骰子，其中一个红色、一个蓝色、一个黄色。我们关注的是蓝色骰子的点数小于黄色骰子的点数，而黄色骰子的点数又小于红色骰子的点数的概率。（也就是说，如果 B、R、Y 分别代表蓝色、红色、黄色骰子的点数，那么我们关心的是 P(B &lt; Y &lt; R) 的概率。\n\n\n三个骰子的点数都不同的概率是多少？\n三个骰子的点数都不同时，B &lt; Y &lt; R 的条件概率是多少？\n\\(P(B&lt;Y&lt;R)\\) 是多少？\n如果我们将实验的结果视为向量 \\((B, R, Y)\\)，那么样本空间中有多少种可能的结果？\n不使用 (c) 的答案，计算 B &lt; Y &lt; R 的结果数量。\n使用 (d) 和 (e) 部分的结果来验证你对 (c) 的答案。\n\n\n在你度假的时候，你让邻居帮忙给一棵生病的植物浇水。如果没有水，这颗植物的死亡概率是 0.8，如果有水，它的死亡概率是 0.15。你有 90% 的把握确认你的邻居会记得给植物浇水。\n\n\n当你回来时，植物存活的概率是多少？\n如果植物死了，你的邻居忘记浇水的概率是多少？\n\n\n有两个球，每个球都有相同的可能性被染成红色或蓝色，把这两个球放入一个瓮中。从翁中随机选择一个球，记下球的颜色，然后将其放回瓮中。如果前两次抽取到的球都是红色，那么\n\n\n瓮中两个球都是红色的概率是多少？\n下一次选中红球的概率是多少？\n\n\n一个养老院社区总共有 1000 人，其中 600 人为共和党人，而其他人为民主党人。在一次地方选举中，养老院的所有人都投了票，其中 60 名共和党人把票投给了民主党候选人，50 名民主党人把票投给了共和党候选人。如果随机选择的一名社区成员把票投给了共和党候选人，那么她是民主党的概率是多少？\n有两个涂成黑色或者金色的球放入一个瓮中。假设每个球涂成黑色的概率是 $，且这些事件是相互独立的。\n\n\n假设你得知至少有一个球是金色的，计算两个球都被涂成金色的条件概率。\n假设现在瓮发生了倾斜，然后一个球掉了出来。如果这个球是金色的，那么两个球都是金色的概率是多少？请解释。\n\n\n有两个外观相同的柜子，每个柜子都有两个抽屉。柜子 A 的每个抽屉里都有一个银币，而柜子 B 的一个抽屉里有银币，另一个抽屉里有金币。随机选择一个柜子，打开其中一个抽屉，发现了一枚银币。则打开该柜子的另一个抽屉，里面有银币的概率是多少？\n前列腺癌是男性中最常见的癌症类型。医生通常会进行一项测试——测量仅由前列腺腺产生的 PSA 蛋白（前列腺特异性抗原）水平——来作为男性是否患有前列腺癌的指标。尽管较高的 PSA 水平表明有癌症，但这项测试非常不可靠。事实上，正常男性的 PSA 水平升高的概率约为 0.135；如果男性确实患有癌症，这一概率将增加到约 0.268。基于其他因素，如果医生有 70% 的把握确定男性患有前列腺癌，那么给定以下条件，他患有癌症的条件概率是多少？\n\n\n测试显示 PSA 水平升高\n测试显示 PSA 水平没有升高\n假设医生最初认为该男性有 30% 的可能性患有前列腺癌，则他患有癌症的条件概率是多少？\n\n测试显示 PSA 水平升高\n测试显示 PSA 水平没有升高\n\n\n\n假设一家保险公司将人们分为三类：低风险、平均风险和高风险。根据他们的记录，低风险、平均风险和高风险的人在一年内发生事故的概率分别为 0.05、0.15 和 0.30。如果 20% 的人口是 “低风险” 人群，50% 是 “平均风险”人群，30% 是 “高风险”人群，那么在固定年份中，有多少人会发生事故？如果购买保险者 A 在 1987 年没有发生事故，那么该人是低风险或者平均风险的概率是多少？\n抛两枚骰子，令 \\(E\\) 表示事件：骰子点数之和等于 7。\n\n\n证明 \\(E\\) 与第一个骰子的点数是 4 之间是独立的。\n证明 \\(E\\) 与第二个骰子的点数是 3 之间是独立的。\n\n\n下图所示电路中，第 \\(i\\) 个继电器关闭的概率为 \\(p_i\\)。如果所有继电器都是独立工作的，那么对于各自的电路，A 和 B 之间有电流的概率是多少？\n\n\n\n\n\n\n\n\n\n\n\n(a) A\n\n\n\n\n\n\n\n\n\n\n\n(b) B\n\n\n\n\n\n\n\n\n\n\n\n\n\n(c) C\n\n\n\n\n\n\n\n图 3.8\n\n\n\n一个工程系统由 \\(n\\) 个组件组成，当且仅当至少有 \\(k\\) 个组件正常工作时，系统才能正常工作，这种工程系统称之为 k-out-of-n 系统（k ≤ n）。假设系统中的所有组件都独立工作。\n\n\n如果第 \\(i\\) 个组件正常工作的概率为 \\(P_i\\)，计算一个 2-out-of-4 系统正常工作的概率。\n如果第 \\(i\\) 个组件正常工作的概率为 \\(P_i\\)，计算一个 3-out-of-5 系统正常工作的概率。\n\n\n抛 5 次硬币，计算以下情况的概率：\n\n\n前三次结果相同的概率。\n前三次结果相同或者后三次结果相同的概率。\n前三次中至少有两次正面向上，并且最后三次中至少有两次反面向上的概率。\n\n\n假设进行 \\(n\\) 次独立试验，每次试验的结果为 0、1、2，其对应的概率分别为 0.3、0.5、0.2。计算结果 1 和结果 2 都至少发生一次的概率。\n一个并行系统，至少有一个组件可以工作该系统就可以正常工作。一个由 \\(n\\) 个组件组成的并行系统，假设每个组件独立工作的概率为 \\(\\frac{1}{2}\\)。计算系统正常工作时，组件 1 也正常工作的条件概率。\n某种生物拥有 5 种不同基因对（我们用英文字母表的前 5 个字母来表示）。每种基因都有两种形式（我们用小写字母和大写字母表示）。大写字母表示显性基因，这意味着：如果一个生物拥有基因对 \\(xX\\)，它将在外表上呈现出 \\(X\\) 基因的特征。例如，如果 \\(X\\) 代表棕色眼睛，\\(x\\) 代表蓝色眼睛，那么拥有基因对 \\(XX\\) 或 \\(xX\\) 的个体将拥有棕色眼睛，而拥有基因对 \\(xx\\) 的个体将是蓝眼睛。生物的外观特征被称为其表型（phenotype），而其遗传构成（即基因对）被称为其基因型。（因此，具有不同基因型 \\(aA, bB, cc, dD, ee\\) 和 \\(AA, BB, cc, DD, ee\\) 的两个生物体具有相同的表现型。）在两个生物体交配时，对于每个基因对，每个生物体会随机贡献其基因对中的一个。假设一个生物体的 5 个基因对是独立的，并且与其伴侣的基因贡献无关。在具有基因型 \\(aA, bB, cC, dD, eE\\) 和 \\(aa, bB, cc, Dd, ee\\) 的两个生物体交配时，则其后代：\n\n\n在表现型上，类似于：\n\n第一个亲本；\n第二个亲本；\n任意一个亲本；\n两个亲本都不像？\n\n在基因型上，类似于：\n\n第一个亲本；\n第二个亲本；\n任意一个亲本；\n两个亲本都不像？\n\n\n\n狱卒告知三名囚犯，会从他们三人中随机选择一个处决，而释放其他两人。囚犯 A 要求狱卒私下告诉他哪一位同伴将被释放，并声称透露这一信息并无害处，因为他已经知道另外两人中至少有一人会被释放。狱卒拒绝回答这个问题，并指出如果 A 知道哪一位同伴将被释放，那么他自己被处决的概率将从三分之一上升到二分之一，因为那时他将是剩下的两个囚犯中的一个。你如何看待狱卒的推理？\n尽管我的父母都有棕色的眼睛，但我的眼睛是蓝色的。你认为我妹妹有蓝色眼睛的概率是多少？（如习题 42 所述，一个从父母双方都获得蓝色眼睛基因的人会有蓝色的眼睛，而一个从父母一方获得蓝色眼睛基因、另一方获得棕色眼睛基因的人会有棕色的眼睛。）\n在一个 7 局 4 胜制的比赛中，首先赢得 4 局比赛的队伍将是获胜者。假设每局比赛中，A 获胜的概率为 \\(p\\)，\n\n\n如果一方以 3 比 0 领先，那么领先的是队伍 A 的概率是多少？\n如果一方以 3 比 0 领先，那么该队伍赢得比赛的概率是多少？\n如果 \\(p = \\frac{1}{2}\\)，那么赢得第一局比赛的队伍赢得整场比赛的概率是多少？\n\n\n假设 3 张卡片上分别写有互不相同的整数值。假设这些卡片将以随机顺序提供给你。当提供给你一张卡片时，你必须立即决定是否接受它。一旦你接受了一张卡片，整个过程就结束了。如果你拒绝了一张卡片，那么将提供下一张卡片给你（如果还有的话）。如果你拒绝了前两张卡片，那么你必须接受最后一张卡片。\n\n\n如果你打算接受第一张牌，那么你接受的牌上的数值最大的概率是多少？\n如果你打算拒绝第一张牌，并且只有在第二张牌的数值大于第一张牌时才接受第二张牌，那么你接受的牌上其数值最大的概率是多少？\n\n\n假设 \\(A, B, C\\) 是三个事件，\\(P (A) = 0.2\\)，\\(P (B) = 0.3\\)，\\(P (C) = 0.4\\)。\n\n\n计算以下情况下事件 \\(A\\) 和 \\(B\\) 中至少有一个发生的概率：\n\n如果 A 和 B 是互斥的。\n如果 A 和 B 是独立的。\n\n找出以下情况下事件 \\(A, B, C\\) 都发生的概率：\n\n如果 A, B, C 是独立的；\n如果 A, B, C 是互斥的。\n\n\n\n在参与常规筛查的 45 岁女性中，有 2% 的女性患有乳腺癌。在这些患有乳腺癌的女性中，有 90% 的女性的乳腺 X 光检查呈阳性。而正常女性中，也有 10% 的女性的乳腺 X 光检查会呈阳性。已知一个女性的乳腺 X 光检查呈阳性，她患有乳腺癌的概率是多少？\n12% 的美国家庭居住在加利福尼亚州。总共有 3.3% 的美国家庭年收入超过 250000 美元，而加利福尼亚州总共有 6.3% 的家庭年收入超过 250000 美元。如果随机选择一个年收入超过 250000 美元的美国家庭，它来自加利福尼亚州的概率是多少？\n事件 \\(A\\) 发生的概率是 60%。如果 \\(A\\) 不发生，事件 \\(B\\) 发生的概率是 10%。事件 \\(A\\) 或 \\(B\\) 中至少有一个发生的概率是多少？\n假设三张卡片上分别写有不同的数值，然后随机将这三张卡片标记为 A、B、C 。比较卡片 A 和 B 上的值，这两个值中较小的那个值也小于卡片 C 上的值的概率是多少？",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>概率论基础</span>"
    ]
  },
  {
    "objectID": "chapter_4/4.html",
    "href": "chapter_4/4.html",
    "title": "4  随机变量和期望",
    "section": "",
    "text": "4.1 随机变量\n当执行随机实验时，我们并不总是对实验结果的全部细节都感兴趣，我们仅对由结果确定的某些 数值量（numerical quantity）的值感兴趣。例如，在抛骰子时，对于每个骰子的点数而言，我们并不感兴趣；我们通常对两个骰子的点数之和感兴趣。也就是说，我们可能想知道点数总和是 7 的情况，而并不关心实际结果是否是：（1, 6）、（2, 5）、（3, 4）、（4, 3）、（5, 2）、（6, 1）。此外，对于土木工程师而言，他们可能不关心水库水位的日常涨落（我们可以将水库水位的日常涨落数据视为实验结果），他们只关心雨季结束时的水位。由实验结果确定的我们感兴趣的这些 量化指标（quantities），我们称为 随机变量（random variables）。\n因为 随机变量 的值是由实验结果确定的，因此，对于 随机变量 的可能的值，我们可以对其给与概率赋值。\n换句话说，随机变量 \\(X\\) 的取值为 2~12 之间的任何整数值，其每个取值的概率由 式 4.1 给出。由于 \\(X\\) 必须为某个取值，因此我们必有：\n\\[\n1 = P(S) = P\\Bigg( \\bigcup_{i=2}^{12}{\\{X=i\\}} \\Bigg) = \\sum_{i=2}^{12}{P\\{X=i\\}}\n\\tag{4.2}\\]\n利用 式 4.1 可以非常简单的验证 式 4.2。\n在这个实验中，我们感兴趣的另一个 随机变量 是第一个骰子的点数。令 \\(Y\\) 表示 随机变量：抛两个骰子时第一个骰子的点数。则 \\(Y\\) 的取值为 1~6 之间的任何值。也就是说：\n\\[\nP\\{Y=i\\} = \\frac{1}{6}, i=1,2,3,4,5,6 \\quad \\blacksquare\n\\tag{4.3}\\]\n我们令 \\(X\\) 表示购买的两个电子元器件中没有缺陷的元器件数量，那么 \\(X\\) 是一个 随机变量，且其取值为 0、1、2 中的一个：\n\\[\n\\begin{align}\nP\\{X=0\\} &= 0.09 \\\\\nP\\{X=1\\} &= 0.42 \\\\\nP\\{X=2\\} &= 0.49\n\\end{align}\n\\tag{4.4}\\]\n如果我们主要关注这两个电子元器件是否至少有一个没有缺陷，则我们可以对 随机变量 \\(I\\) 作如下定义：\n\\[\nI = \\begin{cases}\n1, \\quad & if \\ X=1, 2 \\\\\n0, \\quad & if \\ X=0\n\\end{cases}\n\\tag{4.5}\\]\n如果 \\(A\\) 表示事件：至少一个元器件没有缺陷，则根据 \\(A\\) 是否发生，\\(I\\) 将等于 1 或 0。因此，我们称 随机变量 \\(I\\) 为 事件 \\(A\\) 的 指示随机变量（indicator random variable）。\\(I\\) 的可能取值的概率为：\n\\[\n\\begin{align}\n&P\\{I=1\\}=0.91 \\\\\n&P\\{I=0\\}=0.09 \\qquad \\blacksquare\n\\end{align}\n\\tag{4.6}\\]\n在 例 4.1 和 例 4.2 这两个例子中，我们感兴趣的 随机变量 的可能取值的数量是有限的。对于那些取值可以写成有限序列 \\(x_1,..., x_n\\) 或者无限序列 \\(x_1,...\\) 的 随机变量 称为 离散随机变量（discrete random variables）。例如，一个取值集合为非负整数的 随机变量 就是 离散随机变量。然而，也存在取值为连续数值的 随机变量，我们称这种 随机变量 为 连续随机变量（continous random variables）。例如，假定汽车的寿命位于某个区间 \\((a,b)\\) 时，表示汽车寿命的 随机变量 就是 连续随机变量。\n随机变量 \\(X\\) 的累积分布函数（cumulative distribution function）\\(F\\) 的定义如下：\n\\[\nF(x) = P\\{X \\le x\\}\n\\tag{4.7}\\]\n也就是说，\\(F(x)\\) 是 随机变量 \\(X\\) 取值小于或等于 \\(x\\) 的概率。\n我们可以用 随机变量 \\(X\\) 的分布函数 \\(F\\) 来回答所有关于 \\(X\\) 的概率问题。例如，假如我们想计算 \\(P\\{a \\lt X \\le b\\}\\)。要计算该概率，我们首先注意到 事件 \\({X \\le b}\\) 可以表示为两个 互斥事件 \\({X \\le a}\\) 和 \\({a \\lt X \\le b}\\) 的并集。因此，根据 公理3（小节 3.4），我们得到：\n\\[\n\\begin{align}\nP\\{X \\le b\\}&=P\\{X \\le a\\} + P\\{a \\lt X \\le b\\} \\\\\n\\therefore P\\{a \\lt X \\le b\\} &= F(b) - F(a)\n\\end{align}\n\\tag{4.8}\\]",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>随机变量和期望</span>"
    ]
  },
  {
    "objectID": "chapter_4/4.html#随机变量",
    "href": "chapter_4/4.html#随机变量",
    "title": "4  随机变量和期望",
    "section": "",
    "text": "例 4.1 令 \\(X\\) 表示随机变量：抛 2 个骰子的点数之和，则：\n\\[\n\\begin{align}\nP\\{X=2\\} &= P(\\{(1,1)\\}) = \\frac{1}{36} \\\\\nP\\{X=3\\} &= P(\\{(1,2), (2,1)\\}) = \\frac{2}{36} \\\\\nP\\{X=4\\} &= P(\\{(1,3), (2,2), (3,1)\\}) = \\frac{3}{36} \\\\\nP\\{X=5\\} &= P(\\{(1,4), (2,3), (3,2), (4,1)\\}) = \\frac{4}{36} \\\\\nP\\{X=6\\} &= P(\\{(1,5), (2,4), (3,3), (4,2), (5,1)\\}) = \\frac{5}{36} \\\\\nP\\{X=7\\} &= P(\\{(1,6), (2,5), (3,4), (4,3), (5,2), (6,1)\\}) = \\frac{6}{36} \\\\\nP\\{X=8\\} &= P(\\{(2,6), (3,5), (4,4), (5,3), (6,2)\\}) = \\frac{5}{36} \\\\\nP\\{X=9\\} &= P(\\{(3,6), (4,5), (5,4), (6,3)\\}) = \\frac{4}{36} \\\\\nP\\{X=10\\} &= P(\\{(4,6), (5,5), (6,4)\\}) = \\frac{3}{36} \\\\\nP\\{X=11\\} &= P(\\{(5,6), (6,5)\\}) = \\frac{2}{36} \\\\\nP\\{X=12\\} &= P(\\{(6,6)\\}) = \\frac{1}{36}\n\\end{align}\n\\tag{4.1}\\]\n\n\n\n\n\n\n\n例 4.2 假设一个人购买了两个电子元器件，每个电子元器件或者有缺陷（用 d 表示）或者没有缺陷（用 a 表示）。则这两个电子元器件有四种可能的结果：(d, d)、(d, a)、(a, d)、(a, a)，假设这四种结果的概率分别为：0.09、0.21、0.21、0.49（其中 (d, d) 表示两个元器件都有缺陷，(d, a) 表示第一个元器件有缺陷、第二个元件没有缺陷，依此类推）。\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n注记\n\n\n\n随机变量 的累积分布函数也可简称为 分布函数（distribution function）。\n\n\n\n\n\n\n\n\n提示\n\n\n\n我们将使用 \\(X \\thicksim F\\) 来表示 \\(F\\) 是 随机变量 \\(X\\) 的分布函数。\n\n\n\n\n\n习题 4.1 假设 随机变量 \\(X\\) 的分布函数为：\n\\[\nF(x) = \\begin{cases}\n0, \\quad & x \\le 0 \\\\\n1-e^{-x^2}, \\quad & x \\gt 0\n\\end{cases}\n\\]\n计算 \\(P\\{X \\gt 1\\}\\)？\n\n\n解 4.1. \\[\n\\begin{align}\nP\\{X \\gt 1\\} &= 1 - P\\{X \\le 1\\} \\\\\n&= 1 - F(1) \\\\\n&= e^{-1} \\\\\n&= 0.368 \\qquad \\blacksquare\n\\end{align}\n\\]",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>随机变量和期望</span>"
    ]
  },
  {
    "objectID": "chapter_4/4.html#随机变量的类型",
    "href": "chapter_4/4.html#随机变量的类型",
    "title": "4  随机变量和期望",
    "section": "4.2 随机变量的类型",
    "text": "4.2 随机变量的类型\n如前所述，取值为一个序列集的 随机变量 称为 离散随机变量。对于 离散随机变量 \\(X\\)，我们定义其 概率质量函数 \\(p(a)\\)（probability mass function）为：\n\\[\np(a) = P\\{X=a\\}\n\\tag{4.9}\\]\n对于 \\(a\\) 的可数个取值，其 概率质量函数 \\(p(a)\\) 为正数。也就是说，如果 \\(X\\) 的取值必须为 \\(x_1,x_2,...,x_n\\)，则 \\(p(x_i) \\gt 0\\)，\\(i=1,2,...\\)；对于其他的取值，\\(p(x)=0\\)。\n因为 \\(X\\) 必须为 \\(x_i\\) 中的某个值，所以 \\(\\sum_{i=1}^{\\infty}{p(x_i)}=1\\)。\n\n例 4.3 随机变量 \\(X\\) = 1，2，3，如果已知：\\(p(1)=\\frac{1}{2}\\)，\\(p(2)=\\frac{1}{3}\\)，则 \\(p(3)=\\frac{1}{6}\\)。\\(p(x)\\) 的线图如 图 4.1。 \\(\\blacksquare\\)\n\n\n\n代码\nlibrary(ggplot2)\n\ndf &lt;- data.frame(\n    value = c(1, 2, 3),\n    p = c(1/2, 1/3, 1/6),\n    start = rep(0, 3)\n)\n\ndf$value &lt;- factor(df$value, levels = df$value, ordered = TRUE)\n\nggplot(df, aes(x = value, y = start, yend = p, color = value)) +  \n  geom_segment(size = 2) +                    # 绘制水平线表示每个“条形”  \n  geom_point(aes(y = p), size = 3) +          # 在每个“条形”的末端添加点  \n  theme_minimal() +  \n  labs(x = \"x\", y = \"p(x)\") +  \n  scale_y_continuous(breaks = seq(0, 1, by = 0.1)) +  \n  theme(legend.position = \"none\")           # 调整图例位置\n\n\n\n\n\n\n\n\n图 4.1: \\(p(x)\\) 的线图，例 4.3\n\n\n\n\n\n可以使用 \\(p(x)\\) 来表示 随机变量 \\(X\\) 的累积分布函数 \\(F\\)：\n\\[\nF(a) = \\sum_{all \\ x \\le a}{p(x)}\n\\tag{4.10}\\]\n如果 \\(X\\) 是一个离散随机变量，其可能的取值是 \\(x_1,x_2,x_3,...\\)，其中 \\(x_1&lt;x_2&lt;x_3&lt;...\\)，那么 \\(X\\) 的分布函数 \\(F\\) 是一个阶跃函数（step function）。也就是说，\\(F\\) 的值在区间 \\([x_{i−1},x_i)\\) 是恒定的，然后在 \\(x_i\\) 处有大小为 \\(p(x_i)\\) 的跃变。\n例如，假设 \\(X\\) 的概率质量函数（如 例 4.3）为：\\(p(1)=\\frac{1}{2}\\)，\\(p(2)=\\frac{1}{3}\\)，\\(p(3)=\\frac{1}{6}\\)。则 \\(X\\) 的累积分布函数 \\(F\\) 为：\n\\[\nF(a) = \\begin{cases}\n0, \\quad & a \\lt 1 \\\\\n\\frac{1}{2}, \\quad & 1 \\le a \\lt 2 \\\\\n\\frac{5}{6}, \\quad & 2 \\le a \\lt 3 \\\\\n1, \\quad & 3 \\le a\n\\end{cases}\n\\tag{4.11}\\]\n式 4.11 如 图 4.2 所示。\n\n\n代码\nlibrary(ggplot2)\n\ndf &lt;- data.frame(\n  value = c(1, 2, 3),\n  p = c(1/2, 1/3, 1/6)\n)\n\ndf$cpf &lt;- cumsum(df$p)\n\ndf1 &lt;- data.frame(\n  value = c(0, 1, 1, 2, 2, 3, 3, 4),\n  cpf = c(0, 0, df$cpf[1], df$cpf[1], df$cpf[2], df$cpf[2], df$cpf[3], df$cpf[3])\n)\n#df1$value &lt;- factor(df$value, levels = df$value, ordered = TRUE)\n\nggplot(df1, aes(x = value, y = cpf)) +  \n  geom_line() +\n  labs(x = \"x\", y = \"F(x)\") +  \n  scale_y_continuous(breaks = seq(0, 1, by = 0.1)) +  \n  theme(legend.position = \"none\")           # 调整图例位置\n\n\n\n\n\n\n\n\n图 4.2: \\(F(x)\\) 的折线图\n\n\n\n\n\n离散随机变量 的可能取值是一个序列集合，但是我们通常必须考虑那些取值是一个区间的 随机变量。假设 \\(X\\) 为一个取值是一个区间的 随机变量。如果存在一个定义域为所有实数 \\(x \\in (−\\infty, \\infty)\\) 的非负函数 \\(f(x)\\)，且对于任意实数集 \\(B\\)，\\(f(x)\\) 都满足：\n\\[\nP\\{X \\in B\\} = \\int_{B}{f(x)\\mathrm{d} x}\n\\tag{4.12}\\]\n则我们称 \\(X\\) 是一个 连续随机变量（continous random variable），而函数 \\(f(x)\\) 为 随机变量 \\(X\\) 的 概率密度函数（probability density function）。\n换句话说，式 4.12 指出，对集合 \\(B\\) 上的概率密度函数进行积分运算可以得到 \\(X\\) 在 \\(B\\) 中的概率。由于 \\(X\\) 必须为某个值，所以 \\(f(x)\\) 必须满足：\n\\[\n1 = P\\{X \\in (-\\infty, \\infty)\\} = \\int_{-\\infty}^{\\infty}{f(x)\\mathrm{d} x}\n\\tag{4.13}\\]\n概率密度函数 \\(f(x)\\) 可以用于回答所有关于 随机变量 \\(X\\) 的概率问题，例如，令 \\(B=[a,b]\\)，根据 式 4.12，我们有：\n\\[\nP\\{a \\le X \\le b\\}=\\int_{a}^{b}{f(x)\\mathrm{d} x}\n\\tag{4.14}\\]\n在 式 4.14 中，如果令 \\(a=b\\)，则：\n\\[\nP\\{X=a\\}=\\int_{a}^{a}{f(x)\\mathrm{d} x} = 0\n\\tag{4.15}\\]\n换句话说，对于 连续随机变量 而言，其取值为某个特殊值的概率为 0，如 图 4.3 所示。\n\n\n代码\nlibrary(ggplot2)\n\nx &lt;- seq(0, 5, 0.1)\ny &lt;- exp(-x)\ndf &lt;- data.frame(x=x, y=y)\n\nggplot(df, aes(x=x, y=y)) + \n  geom_line() + \n  geom_segment(x=1, y=exp(-1), xend=1, yend=0) + \n  geom_segment(x=3, y=exp(-3), xend=3, yend=0) +\n  geom_ribbon(data = subset(df, x &gt;= 1 & x &lt;= 3), aes(ymin = 0, ymax = y), fill = \"gray\") +\n  annotate(\"text\", x = 1, y = -0.02, label = \"a\", hjust = 1, vjust = 0, size = 3) +\n  annotate(\"text\", x = 3, y = -0.02, label = \"b\", hjust = 1, vjust = 0, size = 3) + \n  annotate(\"text\", x = 2.2, y = 0.05, label = \"P{a&lt;X&lt;b}\", hjust = 1, vjust = 0, size = 5)  \n\n\n\n\n\n\n\n\n图 4.3: 概率密度函数 \\(f(x)=\\begin{cases} e^{-x}, \\quad & x \\ge 0 \\\\ 0, \\quad & x \\lt 0 \\end{cases}\\)\n\n\n\n\n\n\n\n\n\n\n\n注记\n\n\n\n连续随机变量的概率是其密度函数 \\(f(x)\\) 在某个区间上积分的结果，因此对于某个特殊的取值，其结果必然为 0。\n\n\n累积分布函数 \\(F(\\cdot)\\) 和概率密度函数 \\(f(\\cdot)\\) 之间的关系如下所示：\n\\[\n\\begin{align}\nF(a)&=P\\{X \\in (-\\infty,a]\\} = \\int_{-\\infty}^{a}{f(x)\\mathrm{d} x} \\\\\n两边&求微分得：\\\\\n\\frac{dF(a)}{da}&=f(a)\n\\end{align}\n\\tag{4.16}\\]\n也就是说，概率密度函数是累积分布函数的导数。根据 式 4.14，概率密度函数的更直观的解释如下：\n\\[\nP\\{a - \\frac{\\varepsilon}{2} \\le X \\le a + \\frac{\\varepsilon}{2}\\} = \\int_{a-\\frac{\\varepsilon}{2}}^{a+\\frac{\\varepsilon}{2}}{f(x)\\mathrm{d} x} \\approx \\varepsilon f(a)\n\\tag{4.17}\\]\n其中，\\(\\varepsilon\\) 是一个非常小的数。也就是说，\\(X\\) 的取值位于区间 \\([a - \\frac{\\varepsilon}{2},a + \\frac{\\varepsilon}{2}]\\) 内时的概率大约为 \\(\\varepsilon f(a)\\)。由此，我们可以看出，\\(f(a)\\) 是对随机变量 \\(X\\) 的取值接近 \\(a\\) 的可能性大小的一种度量。\n\n习题 4.2 假设 \\(X\\) 是一个连续随机变量，其概率密度函数为：\n\\[\nf(x)=\\begin{cases}\nC(4x - 2x^2), \\quad &0 \\lt x \\lt 2 \\\\\n0, \\quad &其它\n\\end{cases}\n\\]\n则：\n\n计算 \\(C\\) 的值？\n计算 \\(P\\{X \\gt 1\\}\\)？\n\n\n\n解 4.2. 因为 \\(f(x)\\) 是一个概率密度函数，因此必有：\\(\\int_{-\\infty}^{\\infty}{f(x)\\mathrm{d} x}=1\\)。因此，有：\n\\[\n\\begin{align}\nC\\int_0^2{(4x-2x^2)\\mathrm{d} x} &=1 \\\\\nC\\bigg(2x^2-\\frac{2}{3}x^3\\bigg)\\Bigg|_{x=0}^{x=2} &= 1\n\\end{align}\n\\]\n所以，\\(C = \\frac{3}{8}\\)。所以，\\(P\\{X \\gt 1\\}=\\int_{1}^{\\infty}{f(x)\\mathrm{d} x}=\\frac{3}{8}\\int_1^2{(4x-2x^2)\\mathrm{d} x}=\\frac{1}{2}\\)。 \\(\\blacksquare\\)",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>随机变量和期望</span>"
    ]
  },
  {
    "objectID": "chapter_4/4.html#联合分布",
    "href": "chapter_4/4.html#联合分布",
    "title": "4  随机变量和期望",
    "section": "4.3 联合分布",
    "text": "4.3 联合分布\n对于一个给定的实验，我们不仅对单个 随机变量 的概率分布函数感兴趣；对两个或多个 随机变量 之间的关系，我们同样感兴趣。例如，在一项关于癌症可能原因的实验中，我们可能对每天平均吸烟数量与个体患癌症年龄之间的关系感兴趣。同样，工程师可能对钢板样品的抗剪强度和点焊直径之间的关系感兴趣。\n为了描述两个 随机变量 之间的关系，我们定义 \\(X\\) 和 \\(Y\\) 的联合累积概率分布函数（joint cumulative probability distribution function）：\n\\[\nF(x,y) = P\\{X \\le x,Y \\le y\\}\n\\tag{4.18}\\]\n至少在理论上，可以根据联合概率分布函数来计算任何关于 \\(X\\) 和 \\(Y\\) 的概率。例如，可以从 \\(X\\) 和 \\(Y\\) 的联合分布函数 \\(F\\) 中得到 \\(X\\) 的分布函数 \\(F_X\\)：\n\\[\n\\begin{align}\nF_X(x) &= P\\{X \\le x\\} \\\\\n&= P\\{X \\le x, Y \\le \\infty \\} \\\\\n&= F(x, \\infty)\n\\end{align}\n\\tag{4.19}\\]\n同理，\\(Y\\) 的累积分布函数为 \\(F_Y(y) = F(\\infty, y)\\)。\n如果 \\(X\\) 和 \\(Y\\) 都是 离散随机变量，且其可能的取值分别为：\\(x_1, x_2, ...\\) 和 \\(y_1, y_2, ...\\)，定义 \\(X\\) 和 \\(Y\\) 的联合概率质量函数（joint probability mass function）\\(p(x_i, y_j)\\) 为：\n\\[\np(x_i, y_j) = P\\{X = x_i, Y = y_j\\}\n\\tag{4.20}\\]\n由于 \\(Y\\) 必须取某个值 \\(y_j\\)，并且所有的 \\(y_j\\) 之间都是 互斥事件，因此 事件 \\(\\{X = x_i\\}\\) 可以写作 \\(\\{X = x_i, Y = Y_j\\}\\) 在所有 \\(j\\) 上的并集。即：\n\\[\n\\{X = x_i\\} = \\bigcup_{all\\ j}{\\{X = x_i, Y = y_j\\}}\n\\tag{4.21}\\]\n根据 公理3（小节 3.4），有：\n\\[\n\\begin{align}\nP\\{X = x_i\\} &= P\\bigg(\\bigcup_{all\\ j}{\\{X = x_i, Y = y_j\\}}\\bigg) \\\\\n&= \\sum_{all \\ j}{P\\{X = x_i, Y = y_j\\}} \\\\\n&= \\sum_{all \\ j}{p(x_i, y_j)}\n\\end{align}\n\\tag{4.22}\\]\n同理，我们可以得到 \\(P\\{Y = y_j\\}\\)：\n\\[\n\\begin{align}\nP\\{Y = y_i\\} &= \\sum_{all \\ i}{P\\{X = x_i, Y = y_j\\}} \\\\\n&= \\sum_{all \\ i}{p(x_i, y_j)}\n\\end{align}\n\\tag{4.23}\\]\n因此，随机变量 的联合概率质量函数总是可以决定单个 随机变量 的概率质量函数。然而，需要注意的是：反之，并不成立。即，即便知道 \\(P\\{X = x_i\\}\\) 和 \\(P\\{Y = y_j\\}\\) 的值也不能决定 \\(P\\{X = x_i, Y = y_j\\}\\) 的值。\n\n例 4.4 假设共有 12 块电池，其中包含 3 块新电池、4 块用过的但还有电量的电池、5 块没有电量的电池。现在，我们从这 12 块电池中随机抽取 3 块。令 \\(X\\) 为抽取的电池中的新电池的数量，令 \\(Y\\) 为抽取的电池中用过但还有电量的电池的数量。则 \\(X\\) 和 \\(Y\\) 的联合概率质量函数 \\(p(i, j) = P\\{X = i, Y = j\\}\\) 为：\n\\[\np(i, j) = \\frac{\\left(\\begin{array}{cc}  3 \\\\ i  \\end{array}\\right) \\left(\\begin{array}{cc}  4 \\\\ j  \\end{array}\\right) \\left(\\begin{array}{cc}  5 \\\\ 3 - i -j  \\end{array}\\right) }{\\left(\\begin{array}{cc}  12 \\\\ 3  \\end{array}\\right)}\n\\]\n从 12 块电池里随机抽取 3 块电池的抽取方式为 \\(\\left(\\begin{array}{cc}  12 \\\\ 3  \\end{array}\\right)\\)。根据 小节 3.5.1 中的 计数基本原理，抽取的 3 块电池中恰好有 \\(i\\) 块新电池、\\(j\\) 块用过但还有电量的电池、\\(3 - i - j\\) 块没有电量的电池的抽取方式为 \\(\\left(\\begin{array}{cc}  3 \\\\ i  \\end{array}\\right) \\left(\\begin{array}{cc}  4 \\\\ j  \\end{array}\\right) \\left(\\begin{array}{cc}  5 \\\\ 3 - i -j  \\end{array}\\right)\\)。因此：\n\\[\n\\begin{align}\np(0, 0) &= \\frac{\\left(\\begin{array}{cc}  5 \\\\ 3  \\end{array}\\right)}{\\left(\\begin{array}{cc}  12 \\\\ 3  \\end{array}\\right)} = \\frac{10}{220} \\\\\np(0, 1) &= \\frac{\\left(\\begin{array}{cc}  4 \\\\ 1  \\end{array}\\right) \\left(\\begin{array}{cc}  5 \\\\ 2  \\end{array}\\right)}{\\left(\\begin{array}{cc}  12 \\\\ 3  \\end{array}\\right)} = \\frac{40}{220} \\\\\np(0, 2) &= \\frac{\\left(\\begin{array}{cc}  4 \\\\ 2  \\end{array}\\right) \\left(\\begin{array}{cc}  5 \\\\ 1  \\end{array}\\right)}{\\left(\\begin{array}{cc}  12 \\\\ 3  \\end{array}\\right)} = \\frac{30}{220} \\\\\np(0, 3) &= \\frac{\\left(\\begin{array}{cc}  4 \\\\ 3  \\end{array}\\right)}{\\left(\\begin{array}{cc}  12 \\\\ 3  \\end{array}\\right)} = \\frac{4}{220} \\\\\np(1, 0) &= \\frac{\\left(\\begin{array}{cc}  3 \\\\ 1  \\end{array}\\right) \\left(\\begin{array}{cc}  5 \\\\ 2  \\end{array}\\right)}{\\left(\\begin{array}{cc}  12 \\\\ 3  \\end{array}\\right)} = \\frac{30}{220} \\\\\np(1, 1) &= \\frac{\\left(\\begin{array}{cc}  3 \\\\ 1  \\end{array}\\right) \\left(\\begin{array}{cc}  4 \\\\ 1  \\end{array}\\right) \\left(\\begin{array}{cc}  5 \\\\ 1  \\end{array}\\right)}{\\left(\\begin{array}{cc}  12 \\\\ 3  \\end{array}\\right)} = \\frac{60}{220} \\\\\np(1, 2) &= \\frac{\\left(\\begin{array}{cc}  3 \\\\ 1  \\end{array}\\right) \\left(\\begin{array}{cc}  4 \\\\ 2  \\end{array}\\right)}{\\left(\\begin{array}{cc}  12 \\\\ 3  \\end{array}\\right)} = \\frac{18}{220} \\\\\np(2, 0) &= \\frac{\\left(\\begin{array}{cc}  3 \\\\ 2  \\end{array}\\right) \\left(\\begin{array}{cc}  5 \\\\ 1  \\end{array}\\right)}{\\left(\\begin{array}{cc}  12 \\\\ 3  \\end{array}\\right)} = \\frac{15}{220} \\\\\np(2, 1) &= \\frac{\\left(\\begin{array}{cc}  3 \\\\ 2  \\end{array}\\right) \\left(\\begin{array}{cc}  4 \\\\ 1  \\end{array}\\right)}{\\left(\\begin{array}{cc}  12 \\\\ 3  \\end{array}\\right)} = \\frac{12}{220} \\\\\np(3, 0) &= \\frac{\\left(\\begin{array}{cc}  3 \\\\ 3  \\end{array}\\right)}{\\left(\\begin{array}{cc}  12 \\\\ 3  \\end{array}\\right)} = \\frac{1}{220}\n\\end{align}\n\\]\n可以通过 表 4.1 的表格格式来更简单的表示如上的概率。\n\n\n\n表 4.1: \\(P\\{X=i, Y=j\\}\\)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\(j\\) = 0\n\\(j\\) = 1\n\\(j\\) = 2\n\\(j\\) = 3\n\\(P\\{X = i\\}\\)\n\n\n\n\n\\(i\\) = 0\n\\(\\frac{10}{220}\\)\n\\(\\frac{40}{220}\\)\n\\(\\frac{30}{220}\\)\n\\(\\frac{4}{220}\\)\n\\(\\frac{84}{220}\\)\n\n\n\\(i\\) = 1\n\\(\\frac{30}{220}\\)\n\\(\\frac{60}{220}\\)\n\\(\\frac{10}{220}\\)\n0\n\\(\\frac{108}{220}\\)\n\n\n\\(i\\) = 2\n\\(\\frac{15}{220}\\)\n\\(\\frac{12}{220}\\)\n0\n0\n\\(\\frac{27}{220}\\)\n\n\n\\(i\\) = 3\n\\(\\frac{1}{220}\\)\n0\n0\n0\n\\(\\frac{1}{220}\\)\n\n\n\\(P\\{Y = j\\}\\)\n\\(\\frac{56}{220}\\)\n\\(\\frac{112}{220}\\)\n\\(\\frac{48}{220}\\)\n\\(\\frac{4}{220}\\)\n\n\n\n\n\n\n\n读者应该注意，通过计算行的和所得到的 \\(X\\) 的概率质量函数和 式 4.22 的结果是一致的；同时，通过计算列的和所得到的 \\(Y\\) 的概率质量函数和 式 4.23 的结果也是一致的。因为 \\(X\\) 和 \\(Y\\) 的各自的概率质量函数出现在 表 4.1 所示的联合概率分布表的边缘（margin），因此，我们又常常称 \\(X\\) 和 \\(Y\\) 的各自的概率质量函数为 边缘概率质量函数（marginal probability mass function）。应该注意的是，为了检查类似 表 4.1 这样的表的正确性，我们可以对表中的最后一行（或最右一列）求和，并验证其结果是否为 1。（为什么最后一行或最右一列的和必须等于 1？） \\(\\blacksquare\\)\n\n\n例 4.5 假设某个社区中，15% 的家庭没有孩子，20% 的家庭有 1 个孩子，35% 的家庭有 2 个孩子，30% 的家庭有 3 个孩子。又假设对于每个家庭而言，每个孩子是男孩或女孩的可能性相等并且独立。\n如果从这个社区中随机选择一个家庭，那么这个家庭中男孩的数量 \\(B\\) 和女孩的数量 \\(G\\) 具有 表 4.2 所示的联合概率质量函数。\n\n\n\n表 4.2: \\(P\\{B=i, G=j\\}\\)\n\n\n\n\n\n\n\\(j\\) = 0\n\\(j\\) = 1\n\\(j\\) = 2\n\\(j\\) = 3\n\\(P\\{B = i\\}\\)\n\n\n\n\n\\(i\\) = 0\n0.15\n0.10\n0.0875\n0.0375\n0.3750\n\n\n\\(i\\) = 1\n0.10\n0.175\n0.1125\n0\n0.3875\n\n\n\\(i\\) = 2\n0.0875\n0.1125\n0\n0\n0.2000\n\n\n\\(i\\) = 3\n0.0375\n0\n0\n0\n0.0375\n\n\n\\(P\\{G = j\\}\\)\n0.3750\n0.3875\n0.2000\n0.0375\n\n\n\n\n\n\n\n于是，我们可以得到如下的概率：\n\\[\n\\begin{align}\nP\\{B=0, G=0\\} &= P\\{没有孩子\\} = 0.20 \\cdot \\frac{1}{2} = 0.15 \\\\\nP\\{B=0, G=1\\} &= P\\{有 1 个孩子且为女孩\\} = 0.35 \\cdot (\\frac{1}{2})^2 = 0.1 \\\\\nP\\{B=0, G=3\\} &= P\\{有 3 个孩子且都为女孩\\} = = 0.30 \\cdot (\\frac{1}{2})^3 = 0.0375 \\\\\n\\end{align}\n\\]\n您可以验证 表 4.2 的其余部分，通过 表 4.2 我们可以知道，所选择的家庭至少有一个女孩的概率为 0.625（\\(1-P\\{B=i, G=0\\}\\)）。\\(\\blacksquare\\)\n\n\\(X\\) 和 \\(Y\\) 是两个连续 随机变量，对于 \\(x \\in (-\\infty, \\infty)\\) 和 \\(y \\in (-\\infty, \\infty)\\)，对于任何一个 \\(x\\) 和 \\(y\\) 构成的 数据对 集合 \\(C\\)（\\(C\\) 是一个二维平面中的集合），如果存在函数 \\(f(x,y)\\)，使得：\n\\[\nP\\{(X,Y) \\in C\\} = \\iint_{(x,y) \\in C}{f(x,y)\\mathrm{d} x \\mathrm{d} y}\n\\tag{4.24}\\]\n我们称 \\(X\\) 和 \\(Y\\) 是联合连续随机变量，称函数 \\(f(x,y)\\) 为 \\(X\\) 和 \\(Y\\) 的 联合概率密度函数（joint probability density function）。如果令 \\(A\\) 和 \\(B\\) 为两个实数集，并令 \\(C = \\{(x,y): x \\in A, y \\in B\\}\\)，则 式 4.24 可以写作：\n\\[\nP\\{X \\in A, Y \\in B\\} = \\int_{B} \\int_{A} {f(x,y)\\mathrm{d} x \\mathrm{d} y}\n\\tag{4.25}\\]\n因为：\n\\[\n\\begin{align}\nF(a,b) &= P\\{X \\in (-\\infty, a], Y \\in (-\\infty, b]\\} \\\\\n&= \\int_{-\\infty}^{b} \\int_{-\\infty}^{a} {f(x,y)\\mathrm{d} x \\mathrm{d} y}\n\\end{align}\n\\tag{4.26}\\]\n所以，对 式 4.26 两边微分得到：\n\\[\n\\frac{\\partial^{2}{F(a,b)}}{\\partial a \\ \\partial b} = f(a,b)\n\\tag{4.27}\\]\n也就是说，联合概率密度函数 \\(f(\\cdot)\\) 是联合概率分布函数 \\(F(\\cdot)\\) 的偏微分。根据 式 4.25，我们有：\n\\[\n\\begin{align}\nP\\{a \\lt X \\lt a + \\Delta a, b \\lt Y \\lt b + \\Delta b\\} &= \\int_{b}^{b + \\Delta b} \\int_{a}^{a + \\Delta a} {f(x,y)\\mathrm{d} x \\mathrm{d} y} \\\\\n&\\approx f(a,b) \\Delta a \\Delta b\n\\end{align}\n\\tag{4.28}\\]\n因为 \\(\\Delta a\\) 和 \\(\\Delta b\\) 都是非常小的数，并且 \\(f(x,y)\\) 在 \\((a,b)\\) 处是连续的。因此 \\(f(a,b)\\) 是对 \\((X,Y)\\) 靠近 \\((a,b)\\) 的可能性大小的一种度量。\n如果 \\(X\\) 和 \\(Y\\) 是联合连续随机变量，则 \\(X\\) 和 \\(Y\\) 各自都是连续随机变量，则 \\(X\\) 的概率密度函数为：\n\\[\n\\begin{align}\nP\\{X \\in A\\} &= P\\{X \\in A, Y \\in (-\\infty, \\infty)\\} \\\\\n&= \\int_{A} \\int_{-\\infty}^{\\infty} {f(x,y) \\mathrm{d} y\\mathrm{d} x} \\\\\n&= \\int_{A}{f_X{(x)\\mathrm{d} x}} \\\\\n其中\\ f_X{(x)} &= \\int_{-\\infty}^{\\infty}{f(x,y) \\mathrm{d} y}\n\\end{align}\n\\tag{4.29}\\]\n同理，\\(Y\\) 的概率密度函数为：\n\\[\n\\begin{align}\nP\\{Y \\in B\\} &= P\\{X \\in (-\\infty, \\infty), Y \\in B\\} \\\\\n&= \\int_{B} \\int_{-\\infty}^{\\infty} {f(x,y)\\mathrm{d} x \\mathrm{d} y} \\\\\n&= \\int_{B}{f_Y{(y) \\mathrm{d} y}} \\\\\n其中\\ f_Y{(y)} &= \\int_{-\\infty}^{\\infty}{f(x,y)\\mathrm{d} x}\n\\end{align}\n\\tag{4.30}\\]\n\n习题 4.3 \\(X\\) 和 \\(Y\\) 的联合概率密度函数如下：\n\\[\nf(x,y) = \\begin{cases}\n2e^{-x}e^{-2y}, \\quad & 0 \\lt x \\lt \\infty, 0 \\lt y \\lt \\infty \\\\\n0, \\quad & otherwise\n\\end{cases}\n\\]\n计算：\n\n\\(P\\{X \\gt 1, Y \\lt 1\\}\\)\n\\(P\\{X \\lt Y\\}\\)\n\\(P\\{X \\lt a\\}\\)\n\n\n\n解 4.3. \n\n\n\n\n\n\n\\(P\\{X \\gt 1, Y \\lt 1\\}\\)\n\n\n\n\\[\n\\begin{align}\nP\\{X \\gt 1, Y \\lt 1\\} &= \\int_{0}^{1} \\int_{1}^{\\infty} {2e^{-x}e^{-2y}\\mathrm{d} x \\mathrm{d} y} \\\\\n&= \\int_{0}^{1}{2e^{-2y}(-e^{-x} \\big |_{1}^{\\infty})} \\mathrm{d} y \\\\\n&= e^{-1}\\int_{0}^{1}2e^{-2y} \\mathrm{d} y \\\\\n&= e^{-1}(1-e^{-2})\n\\end{align}\n\\]\n\n\n\n\n\n\n\n\n\\(P\\{X \\lt Y\\}\\)\n\n\n\n\\[\n\\begin{align}\nP\\{X \\lt Y\\} &= \\iint_{(x,y):x \\lt y}{2e^{-x}e^{-2y}\\mathrm{d} x \\mathrm{d} y} \\\\\n&= \\int_{0}^{\\infty} \\int_{0}^{y} {2e^{-x}e^{-2y}\\mathrm{d} x \\mathrm{d} y} \\\\\n&= \\int_{0}^{\\infty}{2e^{-2y}(1-e^{-y}) \\mathrm{d} y} \\\\\n&= \\int_{0}^{\\infty}{2e^{-2y} \\mathrm{d} y} - \\int_{0}^{\\infty}{2e^{-3y} \\mathrm{d} y} \\\\\n&= 1-\\frac{2}{3} \\\\\n&= \\frac{1}{3}\n\\end{align}\n\\]\n\n\n\n\n\n\n\n\n\\(P\\{X \\lt a\\}\\)\n\n\n\n\\[\n\\begin{align}\nP\\{X \\lt a\\} &= \\int_{0}^{a} \\int_{0}^{\\infty}{2e^{-2y}e^{-x} \\mathrm{d} y\\mathrm{d} x} \\\\\n&= \\int_{0}^{a}{e^{-x}\\mathrm{d} x} \\\\\n&= 1-e^{-a}\n\\end{align}\n\\]\n\n\n\\(\\blacksquare\\)\n\n\n4.3.1 独立随机变量\n对于任意的两个实数集 \\(A\\) 和 \\(B\\)，如果随机变量 \\(X\\) 和 \\(Y\\) 满足 式 4.31，我们称 \\(X\\) 和 \\(Y\\) 是相互独立的。\n\\[\nP\\{X \\in A, Y \\in B\\} = P\\{X \\in A\\}P\\{Y \\in B\\}\n\\tag{4.31}\\]\n换句话说，对于所有的 \\(A\\)、\\(B\\)，如果事件 \\(E_A={X \\in A}\\) 和 \\(E_B={Y \\in B}\\) 是相互独立的，那么 随机变量 \\(X\\) 和 \\(Y\\) 也是相互独立的。\n根据 小节 3.4 中的概率论 三大公理，对于所有的 \\(a\\)、\\(b\\)，式 4.31 满足：\n\\[\nP\\{X \\le a, Y \\le b\\} = P\\{X \\le a\\}P\\{Y \\le b\\}\n\\tag{4.32}\\]\n因此，就 \\(X\\) 和 \\(Y\\) 的联合分布函数 \\(F\\) 而言，如果 \\(F(a,b) = F_X(a)F_Y(b)\\)，则 \\(X\\) 和 \\(Y\\) 是独立的。\n当 \\(X\\) 和 \\(Y\\) 是离散随机变量时，式 4.31 等价于：\n\\[\np(x,y)=p_X{(x)}p_Y{(y)} \\quad for \\ all \\ x,y\n\\tag{4.33}\\]\n其中，\\(p_X\\) 和 \\(p_Y\\) 分别为 \\(X\\) 和 \\(Y\\) 的概率质量函数。\n如果 式 4.31 成立，那么我们令 \\(A={x}\\)，\\(B={y}\\)，于是我们能够得到 式 4.33。此外，如果 式 4.33 成立，那么对于任何集合 \\(X \\in A\\)、\\(Y \\in B\\)，都有：\n\\[\n\\begin{align}\nP\\{X \\in A, Y \\in B\\} &= \\sum_{y \\in B}\\sum_{x \\in A}{p(x,y)} \\\\\n&= \\sum_{y \\in B}\\sum_{x \\in A}{p_X{(x)}p_Y{(y)}} \\\\\n&= \\sum_{y \\in B}{p_Y{(y)}} \\sum_{x \\in A}{p_X{(x)}} \\\\\n&= P\\{Y \\in B\\}P\\{X \\in A\\} \\\\\n&= P\\{X \\in A\\}P\\{Y \\in B\\}\n\\end{align}\n\\]\n即，式 4.33 成立也意味着 式 4.31 成立。因此，式 4.31 和 式 4.33 是等价的。\n同理，当 \\(X\\) 和 \\(Y\\) 是连续随机变量时，式 4.31 等价于：对于所有的 \\(x\\)、\\(y\\)，都有 \\(f(x,y) = f_X(x)f_Y(y)\\)。如果一个随机变量 \\(X\\) 的取值不会改变另一个随机变量 \\(Y\\) 的分布，那么我们可以大致认为 \\(X\\) 和 \\(Y\\) 是独立的。不独立的随机变量称为 依赖随机变量。\n\n习题 4.4 假设 \\(X\\) 和 \\(Y\\) 是两个独立随机变量，其概率密度函数均为：\n\\[\nf(x)=\\begin{cases}\ne^{-x}, \\quad & x \\gt 0 \\\\\n0, \\quad & otherwise\n\\end{cases}\n\\]\n求 随机变量 \\(\\frac{X}{Y}\\) 的概率密度函数？\n\n\n解 4.4. 首先，求 \\(\\frac{X}{Y}\\) 的概率分布函数 \\(F\\)：\n\\[\n\\begin{align}\n\\forall a & \\gt 0, \\\\\nF_{\\frac{X}{Y}}{(a)} &= P\\{\\frac{X}{Y} \\le a\\} \\\\\n&= \\iint_{\\frac{x}{y} \\le a}{f(x,y)\\mathrm{d} x \\mathrm{d} y} \\\\\n&= \\iint_{\\frac{x}{y} \\le a}{e^{-x}e^{-y}\\mathrm{d} x \\mathrm{d} y} \\\\\n&= \\int_{0}^{\\infty} \\int_{0}^{ay} {e^{-x}e^{-y}\\mathrm{d} x \\mathrm{d} y} \\\\\n&= \\int_{0}^{\\infty} {(1-e^{-ay})e^{-y} \\mathrm{d} y} \\\\\n&= \\bigg(-e^{-y} + \\frac{e^{-(a+1)y}}{a+1}\\bigg) \\bigg | _{0}^{\\infty} \\\\\n&= 1 - \\frac{1}{a+1}\n\\end{align}\n\\]\n对 \\(F_{\\frac{X}{Y}}{(a)}\\) 求导得到 \\(f_{\\frac{X}{Y}(a)} = \\frac{1}{(1+a)^2}\\)。 \\(\\blacksquare\\)\n\n我们可以用定义 2 个 随机变量 的联合概率分布函数的方式来定义 \\(n\\) 个 随机变量的联合概率分布函数。对于 \\(n\\) 个 随机变量 \\(X_1,X_2,...,X_n\\)，其联合累积概率分布函数 \\(F(a_1,a_2,...,a_n)\\) 为：\n\\[\nF(a_1,a_2,...,a_n) = P\\{X_1 \\le a_1, X_2 \\le a_2,..., X_n \\le a_n\\}\n\\tag{4.34}\\]\n对于离散随机变量，则其联合概率质量函数 \\(p(x_1,x_2,...,x_n)\\) 为：\n\\[\np(x_1,x_2,...,x_n) = P\\{X_1=x_1, X_2=x_2,..., X_n=x_n\\}\n\\tag{4.35}\\]\n此外，对于 \\(n\\) 维空间中的集合 \\(C\\)，如果存在一个函数 \\(f(\\cdot)\\) 使得：\n\\[\nP\\{(X_1,X_2,...,X_n) \\in C\\} = \\idotsint_{(x_1,...,x_n) \\in C}{f(x_1,...,x_n)\\mathrm{d} x_1 \\cdots \\mathrm{d} x_n}\n\\tag{4.36}\\]\n我们称 \\(f(x_1,...,x_n)\\) 为这 \\(n\\) 个联合连续随机变量的联合概率密度函数。\n特殊的，对于任意的 \\(n\\) 个实数集 \\(A_1,A_2,...,A_n\\)：\n\\[\n\\begin{align}\nP\\{X_1 \\in A_1, X_2 \\in A_2, ..., X_n \\in A_n\\} &= \\\\\n\\int_{A_n} \\int_{A_{n-1}} \\cdots \\int_{A_1}{f(x_1,...,x_n)\\mathrm{d} x_1\\mathrm{d} x_2 \\cdots \\mathrm{d} x_n} &\n\\end{align}\n\\tag{4.37}\\]\n当然，也可以为两个之上的 随机变量 定义独立性。一般来的，对于 \\(n\\) 个 随机变量 \\(X_1,X_2,...,X_n\\)，如果对于所有实数集 \\(A_1,A_2,...,A_n\\) 都有：\n\\[\nP\\{X_1 \\in A_1, X_2 \\in A_2, ..., X_n \\in A_n\\} = \\Pi_{i=1}^{n}{P\\{X_i \\in A_i\\}}\n\\tag{4.38}\\]\n则我们称这 \\(n\\) 个随机变量时相互独立的。正如 式 4.31 和 式 4.33 所述，式 4.38 等价于 式 4.39：\n\\[\nP\\{X_1 \\le a_1, X_2 \\le a_2, ..., X_n \\le a_n\\} = \\Pi_{i=1}^{n}{P\\{X_i \\in a_i\\}}\n\\tag{4.39}\\]\n对于一个随机变量的无限集合 \\(S\\)，如果 \\(S\\) 的所有的子集中的 随机变量 均是独立的，我们说 \\(S\\) 中的所有随机变量之间是相互独立的。（定义 3.3 的一般形式）\n\n例 4.6 假设某支股票的股价的连续每日变化是一个独立且同分布的随机变量，其概率质量函数为：\n\\[\nP\\{第 i 日变化\\} = \\begin{cases}\n-3, \\quad &概率为 0.05 \\\\\n-2, \\quad &概率为 0.10 \\\\\n-1, \\quad &概率为 0.20 \\\\\n0, \\quad &概率为 0.30 \\\\\n1, \\quad &概率为 0.20 \\\\\n2, \\quad &概率为 0.10 \\\\\n3, \\quad &概率为 0.05\n\\end{cases}\n\\]\n令 \\(X_i\\) 表示第 \\(i\\) 天的股价变化，那么，这只股票在未来的连续 3 天里，股价分别上涨 1%、2%、0% 的概率为：\n\\[\nP\\{X_1=1, X_2=2, X_3=0\\} = 0.20 \\cdot 0.10 \\cdot 0.30 = 0.006 \\quad \\blacksquare\n\\]\n\n\n\n4.3.2 条件分布\n对于两个 随机变量，通常可以利用其中一个变量在另一个变量的给定值的情况下的条件分布来确定这两个 随机变量 之间的关系。回顾一下，对于任意两个事件 \\(E\\) 和 \\(F\\)，只要 \\(P(F)&gt;0\\)，则在给定 \\(F\\) 条件下 \\(E\\) 的条件概率为：\n\\[\nP(E|F)=\\frac{P(EF)}{P(F)}\n\\]\n因此，如果 \\(X\\) 和 \\(Y\\) 是两个离散随机变量，那么在给定 \\(Y=y\\) 的条件下，\\(X\\) 的条件概率质量函数为：\n\\[\n\\begin{align}\np_{X|Y}(x|y) &= P\\{X=x | Y=y\\} \\\\\n&= \\frac{P\\{X=x, Y=y\\}}{P\\{Y=y\\}} \\\\\n&= \\frac{p(x,y)}{p_Y(y)}\n\\end{align}\n\\]\n其中，对于所有的 \\(y\\)，\\(p_Y(y) \\gt 0\\)。\n\n习题 4.5 在 例 4.5 中，如果我们知道所选择的这个家庭有 1 个女孩，计算该家庭的小孩中男孩数量的条件概率质量函数。\n\n\n解 4.5. 首先，根据 表 4.2，\\(P\\{G=1\\}=0.3875\\)，因此，\n\\[\n\\begin{align}\nP\\{B=0 | G=1\\} &= \\frac{P\\{B=0, G=1\\}}{P\\{G=1\\}} = \\frac{0.10}{0.3875} = \\frac{8}{31} \\\\\nP\\{B=1 | G=1\\} &= \\frac{P\\{B=1, G=1\\}}{P\\{G=1\\}} = \\frac{0.175}{0.3875} = \\frac{14}{31} \\\\\nP\\{B=2 | G=1\\} &= \\frac{P\\{B=2, G=1\\}}{P\\{G=1\\}} = \\frac{0.1125}{0.3875} = \\frac{9}{31} \\\\\nP\\{B=3 | G=1\\} &= \\frac{P\\{B=3, G=1\\}}{P\\{G=1\\}} = 0 \\\\\n\\end{align}\n\\]\n因此，在有 1 个女孩的条件下，该家庭至少有 1 个男孩的概率为 \\(\\frac{23}{31}\\)。\\(\\blacksquare\\)\n\n\n习题 4.6 假设 随机变量 \\(X\\)、\\(Y\\) 的联合概率质量函数 \\(p(x,y)\\) 为：\n\\[\np(0,0)=0.4, \\quad p(0,1)=0.2, \\quad p(1,0)=0.1, \\quad p(1,1)=0.3\n\\]\n计算 \\(P\\{X|Y=1\\}\\)？\n\n\n解 4.6. \\[\n\\begin{align}\n\\because\\ P\\{Y = 1\\} &= \\sum_{x}p(x,1) = p(0,1) + p(1,1) = 0.5 \\\\\n\\therefore\\ P\\{X=0|Y=1\\} &= \\frac{p(0,1)}{P\\{Y=1\\}} = \\frac{2}{5} \\\\\nP\\{X=1|Y=1\\} &= \\frac{p(1,1)}{P\\{Y=1\\}} = \\frac{3}{5} \\qquad \\blacksquare\n\\end{align}\n\\]\n\n如果 \\(X\\) 和 \\(Y\\) 的联合概率密度函数为 \\(f(x,y)\\)，则在 \\(Y=y\\) 的条件下，\\(X\\) 的条件概率密度函数为：\n\\[\nf_{X|Y}(x|y) = \\frac{f(x,y)}{f_Y{(y)}}, \\quad \\forall y: \\ f_Y(y) \\gt 0\n\\tag{4.40}\\]\n在 式 4.40 的左边乘以 \\(\\Delta x\\)，右边乘以 \\(\\frac{\\Delta x \\Delta y}{\\Delta y}\\) 得到：\n\\[\n\\begin{align}\nf_{X|Y}(x|y) \\Delta x &= \\frac{f(x,y) \\Delta x \\Delta y}{f_Y{(y)} \\Delta y} \\\\\n& \\approx \\frac{P\\{x \\le X \\le x + \\Delta x, y \\le Y \\le y + \\Delta y\\}}{P\\{y \\le Y \\le y + \\Delta y\\}} \\\\\n&= P\\{x \\le X \\le x + \\Delta x\\ | y \\le Y \\le y + \\Delta y\\}\n\\end{align}\n\\tag{4.41}\\]\n也就是说，对于非常小的 \\(\\Delta x\\) 和 \\(\\Delta y\\) ，\\(f_{X|Y}(x|y) \\Delta x\\) 表示在 \\(Y \\in [y, y + \\Delta y]\\) 的条件下，\\(X \\in [x, x + \\Delta x]\\) 的条件概率。\n我们可以使用条件概率密度函数来定义：在给定一个随机变量的值下，另一个随机变量的条件概率。也就是说，如果 \\(X\\) 和 \\(Y\\) 都是连续 随机变量，那么，对于任何集合 \\(A\\)，都有：\n\\[\nP\\{X \\in A, Y=y\\} = \\int_{A}f_{X|Y}(x|y)\\mathrm{d} x\n\\]\n\n习题 4.7 \\(X\\) 和 \\(Y\\) 的联合概率密度函数为：\n\\[\nf(x,y) = \\begin{cases}\n\\frac{12}{5}x(2-x-y), \\quad & 0 \\lt x \\lt 1, 0 \\lt y \\lt 1\\\\\n0, \\quad & otherwise\n\\end{cases}\n\\]\n计算 \\(Y=y: 0 \\lt y \\lt 1\\) 下，\\(X\\) 的条件密度函数 \\(f_{X|Y}(x|y)\\)。\n\n\n解 4.7. 对于 \\(0 \\lt x \\lt 1\\)，\\(0 \\lt y \\lt 1\\)，我们有：\n\\[\n\\begin{align}\nf_{X|Y}(x|y) &= \\frac{f(x,y)}{f_Y(y)} \\\\\n&= \\frac{f(x,y)}{\\int_{-\\infty}^{\\infty}{f(x,y)\\mathrm{d} x}} \\\\\n&= \\frac{x(2-x-y)}{\\int_0^1{x(2-x-y)\\mathrm{d} x}} \\\\\n&= \\frac{x(2-x-y)}{\\frac{2}{3} - \\frac{y}{2}} \\\\\n&= \\frac{6x(2-x-y)}{4-3y} \\quad \\blacksquare\n\\end{align}\n\\]",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>随机变量和期望</span>"
    ]
  },
  {
    "objectID": "chapter_4/4.html#期望",
    "href": "chapter_4/4.html#期望",
    "title": "4  随机变量和期望",
    "section": "4.4 期望",
    "text": "4.4 期望\n随机变量 的 期望（expectation）是概率论中最重要的概念之一。如果 \\(X\\) 是一个离散 随机变量，其可能的取值为 \\(x_1\\)，\\(x_2\\)，……那么 \\(X\\) 的 期望 或 期望值 \\(E[X]\\) 为：\n\\[\nE[X] = \\sum_{i}{x_iP\\{X = x_i\\}}\n\\tag{4.42}\\]\n换句话说，\\(X\\) 的 期望 是其可能取值的加权平均数，其中每个可能取值的权重为该值对应的概率。\n例如，如果 \\(X\\) 的概率质量函数为 \\(p(0)=p(1)=\\frac{1}{2}\\)，则 \\(E[X]\\) 只是 \\(X\\) 的两个可能取值（0、1）的平均数：\n\\[\nE[X] = 0 \\cdot \\frac{1}{2} + 1 \\cdot \\frac{1}{2} = \\frac{1}{2}\n\\]\n如果 \\(p(0)=\\frac{1}{3}\\)，\\(p(1)=\\frac{2}{3}\\)，则 \\(E[X]\\) 是其两个可能取值（0、1）的加权平均值，其中 1 的权重是 0 的 2 倍（因为 \\(p(1)=2p(0)\\)）：\n\\[\nE[X] = 0 \\cdot \\frac{1}{3} + 1 \\cdot \\frac{2}{3} = \\frac{2}{3}\n\\]\n我们也可以利用概率的频率解释（小节 3.1）来定义随机变量的 期望。概率的评率解释认为，如果独立的重复执行一个实验无数次，那么对于任何事件 \\(E\\)，\\(E\\) 发生的概率 \\(P(E)\\) 就是其发生的次数的占比。现在，考虑一个随机变量 \\(X\\)，它的取值为 \\(x_1,x_2,...,x_n\\)，其概率分别为 \\(p(x_1),p(x_2),...,p(x_n)\\)。把 \\(X\\) 想象成我们在一个 机会游戏（game of chance）中得到的奖金，也就是说，我们将赢得 \\(x_i\\) 单位奖金的概率为 \\(p(x_i)\\)。根据概率的频率解释，如果我们继续玩这个游戏，那么我们赢得 \\(x_i\\) 的次数占比将是 \\(p(x_i)\\)。因此，我们在 \\(n\\) 次比赛中的平均奖金将是：\n\\[\n\\sum_{i=1}^{n}{x_ip(x_i)} = E[X]\n\\tag{4.43}\\]\n为了更清楚地看到 式 4.43 所示的结论，假设我们玩 \\(N\\) 次游戏，其中 \\(N\\) 是一个非常大的数。在这些游戏中，我们将赢得 \\(x_i\\) 的次数大约为 \\(Np(x_i)\\)，因此我们在 \\(N\\) 次比赛中的总奖金将是：\n\\[\n\\sum_{i=1}^{n}{x_i \\cdot Np(x_i)}\n\\]\n所以，我们可以获得的平均奖金为：\n\\[\n\\sum_{i=1}^{n}{\\frac{x_i \\cdot Np(x_i)}{N}} = \\sum_{i=1}^{n}{x_ip(x_i)} = E[X]\n\\]\n\n习题 4.8 令 随机变量 \\(X\\) 为我们抛一个骰子所获得的点数，计算 \\(E[X]\\)。\n\n\n解 4.8. \\[\n\\begin{align}\n\\because\\ & p(1)=p(2)=p(3)=p(4)=p(5)=p(6)=\\frac{1}{6} \\\\\n\\therefore\\ & E[X] = 1 \\cdot \\frac{1}{6} + 2 \\cdot \\frac{1}{6} + 3 \\cdot \\frac{1}{6} + 4 \\cdot \\frac{1}{6} + 5 \\cdot \\frac{1}{6} + 6 \\cdot \\frac{1}{6} = \\frac{7}{2}\n\\end{align}\n\\]\n读者应该注意，在 习题 4.8 中，\\(X\\) 的期望值并不是 \\(X\\) 的可能取值（也就是说，抛一个骰子，我们不可能得到 的点数）。因此，即使我们称 \\(E[X]\\) 为 \\(X\\) 的期望，我们也不能应该把 \\(E[X]\\) 看作我们期望 \\(X\\) 具有的值，而应该看作在大量重复实验中 \\(X\\) 的平均值。也就是说，如果我们连续抛一个骰子，那么在抛了很多次之后，所得结果的平均点数将大约是 \\(\\frac{7}{2}\\)。（感兴趣的读者可以尝试一下这个实验。）\\(\\blacksquare\\)\n\n\n例 4.7 如果一个事件 \\(A\\) 的 指示随机变量 为 \\(I\\)，如果\n\\[\nI = \\begin{cases}\n1, \\quad & 如果 A 发生\\\\\n0, \\quad & 如果 A 不发生\n\\end{cases}\n\\]\n则 \\(E[I] = 1 \\cdot P(A) + 0 \\cdot P(A^c) = P(A)\\)。因此，指示随机变量 的期望就是对应的事件发生的概率。\\(\\blacksquare\\)\n\n\n例 4.8 熵（Entropy）。给定一个 随机变量 \\(X\\)，\\(X=x\\) 传递了多少信息（information）？让我们通过如下的方式来开始尝试量化 \\(X=x\\) 中所传递的信息：\\(X=x\\) 的信息量应该取决于 \\(X\\) 等于 \\(x\\) 的可能性。\\(X\\) 等于 \\(x\\) 的可能性越小，他所包含的信息就越多，这看起来是合理的。例如：如果 \\(X\\) 表示抛两个骰子的点数之和，则 \\(X = 12\\) 包含的信息量比 \\(X = 7\\) 包含的信息量要大（因为 \\(P\\{X=12\\}=\\frac{1}{36}\\)，而 \\(P\\{X=7\\}=\\frac{1}{6}\\)）。\n让我们用 \\(I(p)\\) 来表示一个概率为 \\(p\\) 的事件发生时的信息量。显然，\\(I(p)\\) 应该是 \\(p\\) 的非负递减函数。为了确定 \\(I(p)\\)，令 \\(X\\) 和 \\(Y\\) 是独立 随机变量，假设 \\(P\\{X=x\\}=p\\)、\\(P\\{Y=y\\}=q\\)。那么 \\(X=x\\)、\\(Y=y\\) 包含多少信息量？\n\n首先，\\(X=x\\) 中包含的信息量是 \\(I(p)\\)。\n此外，由于我们已经知道 \\(Y=y\\) 的概率并不受 \\(X=x\\) 的影响（因为 \\(X\\) 和 \\(Y\\) 是独立的），所以 \\(Y=y\\) 中包含的额外信息量应该等于 $I(q)。\n因此，\\(X=x\\)、\\(Y=y\\) 中的信息量为 \\(I(p)+I(q)\\)。\n另一方面，我们有 \\(P\\{X=x, Y=y\\}=P\\{X=x\\}P\\{Y=y\\}=pq\\)，这意味着 \\(X=x\\)、\\(Y=y\\) 中的信息量为 \\(I(pq)\\)。\n因此，看起来，\\(I\\) 应该满足：\\(I(pq) = I(p) + I(q)\\)。\n如果我们定义函数 \\(G\\) 为：\\(G(p)=I(2^{-p})\\)，于是有：\n\\[\n\\begin{align}\nG(p+q) &= I(2^{-(p+q)}) \\\\\n&= I(2^{-p} \\cdot 2^{-q}) \\\\\n&= I(2^{-p}) + I(2^{-q}) \\\\\n&= G(p) + G(q)\n\\end{align}\n\\]\n可以证明，满足上述关系的唯一的单调函数 \\(G\\) 是 \\(G(p) = cp\\)，其中 \\(c\\) 为常数。\n于是，我们有 \\(I(2^{-p}) = cp\\)，令 \\(q=2^{-p}\\)，则 \\(I(q) = -c \\log_2{q}\\)（其中，\\(c\\) 是一个大于 0 的常数）。我们经常令 \\(c=1\\)，并且说：用 位（bits） 来测量信息量。\n\n现在，考虑一个随机变量 \\(X\\)，它的取值为 \\(x_1,x_2,...,x_n\\)，其概率分别为 \\(p_1,p_2,...,p_n\\)。因为 \\(X=x\\) 的信息量为 \\(-\\log_2(p_i)\\)，因此，\\(X=x_i\\) 所包含的信息量的 期望 为：\n\\[\nH(X) = - \\sum_{i=1}^{n}{p_i \\log_2{p_i}}\n\\]\n在信息论中，\\(H(X)\\) 就是众所周知的 随机变量 \\(X\\) 的 熵（entropy）。 \\(\\blacksquare\\)\n\n我们还可以定义连续 随机变量 的 期望。假设 \\(X\\) 是一个概率密度函数为 \\(f\\) 的连续 随机变量。对于一个较小的数 \\(\\Delta x\\)，有：\n\\[\nf(x) \\Delta x \\approx P\\{x \\lt X \\lt x + \\Delta x\\}\n\\]\n如果 \\(x\\) 的权重等于 \\(X\\) 在 \\(x\\) 附近的概率，则 \\(X\\) 的所有可能值的加权平均数就是 \\(xf(x) \\Delta x\\) 在所有 \\(x\\) 上的积分。通常，定义 \\(X\\) 的期望为：\n\\[\nE[X] = \\int_{-\\infty}^{\\infty}{xf(x) \\mathrm{d} x}\n\\]\n\n例 4.9 假设您在下午 5 点后的某个时间期待一条消息。根据经验，您知道在下午 5 点后的 \\(X\\) 个小时内会收到消息，并且 \\(X\\) 是一个 随机变量，其概率密度函数为：\n\\[\nf(x) = \\begin{cases}\n\\frac{1}{1.5}, \\quad & 0 \\lt x \\lt 1.5 \\\\\n0, \\quad & otherwise\n\\end{cases}\n\\]\n则下午 5 点之后可以收到消息的期望时间为：\\(E[X] = \\int_{0}^{1.5}{\\frac{1}{1.5} \\mathrm{d} x} = 0.75\\)。因此，您等待消息的时间平均为 45 分钟。 \\(\\blacksquare\\)\n\n\n\n\n\n\n\n备注\n\n\n\n\n期望 的概念类似于物理中的 重心 的概念。考虑一个离散 随机变量 \\(X\\)，其概率质量函数为 \\(p(x_i), i \\ge 1\\)。如果我们现在想象一个质量可以忽略不计的杆（weightless rod），在这根杆上的 \\(x_i\\) 处的质量为 \\(p(x_i)\\)（\\(i \\ge 1\\))（见 图 4.4）。那么这根杆处于平衡状态的点称为重心（the center fo gravity）。对于那些熟悉统计学基础的读者来说，很容易证明这根杆的重心位于 \\(E[X]\\) 1。\n\n\n\n\n\n\n图 4.4: 重心位于 0.9 处\n\n\n\n\\(E[X]\\) 的计量单位与 \\(X\\) 相同。",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>随机变量和期望</span>"
    ]
  },
  {
    "objectID": "chapter_4/4.html#sec-4_5",
    "href": "chapter_4/4.html#sec-4_5",
    "title": "4  随机变量和期望",
    "section": "4.5 期望的特征",
    "text": "4.5 期望的特征\n假设我们给定一个 随机变量 \\(X\\) 和其 概率分布。又假设，我们对计算 \\(X\\) 的 期望 不感兴趣，而对计算关于 \\(X\\) 的某个函数 \\(g(X)\\) 的 期望 感兴趣。如何计算 \\(g(X)\\) 的 期望？如下就是一种计算方法。由于 \\(g(X)\\) 本身是一个 随机变量，因此 \\(g(X)\\) 必存在一个概率分布，并且这个概率分布可以通过 \\(X\\) 的概率分布来计算。一旦我们得到了 \\(g(X)\\) 的分布，我们就可以通过期望的定义来计算 \\(E[g(X)]\\)。\n\n\n\n\n\n\n概率分布\n\n\n\n概率分布即——离散 随机变量 的 概率质量函数 或连续 随机变量 的 概率密度函数。\n\n\n\n习题 4.9 假设 \\(X\\) 的概率质量函数函数为：\\(p(0)=0.2\\)，\\(p(1)=0.5\\)，\\(p(2)=0.3\\)，计算 \\(E[X^2]\\)。\n\n\n解 4.9. 令 \\(Y=X^2\\)，则 \\(Y\\) 是一个取值为 \\(0^2\\)，\\(1^2\\)，\\(2^2\\) 的 随机变量，并且其可能取值的概率分别为：\n\\(p_Y(0) = P\\{Y = 0^2\\} = 0.2\\)\n\\(p_Y(1) = P\\{Y = 1^2\\} = 0.5\\)\n\\(p_Y(2) = P\\{Y = 2^2\\} = 0.3\\)\n因此，\\(E[X^2] = E[Y] = 0 \\cdot 0.2 + 1 \\cdot 0.5 + 4 \\cdot 0.3 = 1.7\\)。\\(\\blacksquare\\)\n\n\n习题 4.10 定位并修复某工厂的电气故障所需的时间（以小时为单位）是一个 随机变量 \\(X\\)，其概率密度函数为：\n\\[\nf_X(x) = \\begin{cases}\n1, \\quad & 0 \\lt x \\lt 1 \\\\\n0, \\quad & otherwise\n\\end{cases}\n\\]\n如果对修复时间 \\(x\\) 的细分成本是 \\(x^3\\)，那么这种细分的期望成本是多少？\n\n\n解 4.10. 令 \\(Y = X^3\\)，我们首先计算 \\(Y\\) 的分布函数：\n\\[\n\\begin{align}\nF_Y(a) &= P\\{Y \\le a\\} \\\\\n&= P\\{X^3 \\le a\\} \\\\\n&= P\\{X \\le a^{\\frac{1}{3}}\\} \\\\\n&= \\int_{0}^{a^{\\frac{1}{3}}}{1  \\mathrm{d} x} \\\\\n&= a^{\\frac{1}{3}} \\\\\n其中，& 0 \\le a \\le 1\n\\end{align}\n\\]\n对 \\(F_Y(a)\\) 求导得到概率密度函数 \\(f_Y(a)=\\frac{1}{3}a^{-\\frac{2}{3}},\\ 0 \\le a \\le 1\\)。因此：\n\\[\n\\begin{align}\nE[X^3] &= E[Y] = \\int_{-\\infty}^{\\infty}{a \\cdot f_Y(a) da} \\\\\n&= \\int_{0}^{1}{a \\cdot a^{-\\frac{2}{3}} da} \\\\\n&= \\frac{1}{3} \\int_{0}^{1}{a^{\\frac{1}{3}}da} \\\\\n&= (\\frac{1}{3} \\cdot \\frac{3}{4} \\cdot a^{\\frac{4}{3}}) \\big |_{0}^{1} \\\\\n&= \\frac{1}{4} \\quad \\blacksquare\n\\end{align}\n\\]\n\n虽然上述过程允许我们可以在理论上利用 \\(X\\) 的分布来计算 \\(X\\) 的任何函数的 期望，但我们还有一种更简单的方法。例如，假设我们想计算 \\(g(X)\\) 的 期望。当 \\(X=x\\) 时，\\(g(X)\\) 的取值为 $g(x)，因此 \\(E[g(X)]\\) 应该是 \\(g(X)\\) 的加权平均数，其中 \\(g(x)\\) 的权重就是 \\(X=x\\) 的概率（或概率密度）。事实上，我们可以证明上述过程是正确的，因此我们有以下的命题。\n\n命题 4.1 一个 随机变量 的函数的 期望：\n\n如果一个离散 随机变量 \\(X\\) 的概率质量函数为 \\(p(x)\\)，则对于任一函数 \\(g\\)，\\(E[g(X)] = \\sum_{x}{g(x)p(x)}\\)。\n如果一个连续 随机变量 \\(X\\) 的概率密度函数为 \\(f(x)\\)，则对于任一函数 \\(g\\)，\\(E[g(X)] = \\int_{-\\infty}^{\\infty}{g(x)f(x) \\mathrm{d} x}\\)。\n\n\n\n例 4.10 利用 命题 4.1 来计算 习题 4.9 有：\n\\(E[X^2] = 0^2 \\cdot 0.2 + 1^2 \\cdot 0.5 + 2^2 \\cdot 0.3 = 1.7\\)。\\(\\blacksquare\\)\n\n\n例 4.11 利用 命题 4.1 来计算 习题 4.10 有：\n\\(E[X^3] = \\int_{0}^{1}{x^3} \\mathrm{d} x = \\frac{1}{4}\\)。 \\(\\blacksquare\\)\n\n根据 命题 4.1，我们有 推论 4.1。\n\n推论 4.1 如果 \\(a\\) 和 \\(b\\) 是常数，则 \\(E[aX + b] = aE[X] + b\\)。\n\n\n证. \n\n对于离散随机变量： \\[\n\\begin{align}\nE[aX + b] &= \\sum_{x}{(ax + b)p(x)} \\\\\n&= a\\sum_{x}{xp(x)} + b\\sum_{x}{p(x)} \\\\\n&= aE[X] + b\n\\end{align}\n\\]\n对于连续随机变量： \\[\n\\begin{align}\nE[aX + b] &= \\int_{-\\infty}^{\\infty}{(ax + b)f(x) \\mathrm{d} x} \\\\\n&= a\\int_{-\\infty}^{\\infty}{xf(x) \\mathrm{d} x} + b\\int_{-\\infty}^{\\infty}{f(x) \\mathrm{d} x} \\\\\n&= aE[X] + b \\quad \\blacksquare\n\\end{align}\n\\]\n\n\n如果令 \\(a=0\\)，则根据 推论 4.1 有：\\(E[b] = b\\)。也就是说，常量的 期望 就是它本身。（这符合你的直觉吗？）另外，如果我们令 \\(b=0\\)，那么我们得到 \\(E[aX] = aE[X]\\)。\n换句话说，常数乘以 随机变量 的 期望 就是该常数乘以这个 随机变量 的期望。随机变量 \\(X\\) 的 期望 \\(E[X]\\) 也称为 \\(X\\) 的平均值或一阶矩（the first moment）。当 \\(n \\ge 1\\) 时，\\(E[X^n]\\) 称为 \\(X\\) 的 \\(n\\)-阶矩。根据 命题 4.1，我们有：\n\\[\nE[X^n] = \\begin{cases}\n\\sum_{x}{x^np(x)}, \\quad & X 为离散随机变量\\\\\n& \\\\\n& \\\\\n\\int_{-\\infty}^{\\infty}{x^nf(x) \\mathrm{d} x}, \\quad & X 为连续随机变量\n\\end{cases}\n\\]\n\n4.5.1 随机变量和的期望\n对于 命题 4.1 而言，如果有两个 随机变量 \\(X\\)、\\(Y\\)，并且 \\(g\\) 为关于 \\(X\\)、\\(Y\\) 的函数，那么有：\n\\[\nE[g(X,Y)] = \\begin{cases}\n\\sum_{y} \\sum_{x} g(x,y)p(x,y), \\quad & 离散随机变量\\\\\n& \\\\\n& \\\\\n\\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty}g(x,y)f(x,y) \\mathrm{d} x \\mathrm{d} y, \\quad & 连续随机变量\n\\end{cases}\n\\]\n例如，如果 \\(g(X,Y)=X+Y\\) 且 \\(X\\)、\\(Y\\) 为连续 随机变量，则：\n\\[\n\\begin{align}\nE[X+Y] &= \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty}(x+y)f(x,y) \\mathrm{d} x \\mathrm{d} y \\\\\n&= \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty}xf(x,y) \\mathrm{d} x \\mathrm{d} y + \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty}yf(x,y) \\mathrm{d} x \\mathrm{d} y \\\\\n&= E[X] + E[Y]\n\\end{align}\n\\]\n类似的，对于离散随机变量而言，也有：\n\\[\nE[X+Y]=E[X] + E[Y]\n\\tag{4.44}\\]\n重复应用 式 4.44，我们可以证明：任意数量的 随机变量 之和的 期望 等于它们各自 期望 的和。例如，\n\\[\n\\begin{align}\nE[X+Y+Z] &= E[(X+Y)+Z] \\\\\n&= E[X+Y] + E[Z]  \\\\\n&= E[X] + E[Y] + E[Z]  \n\\end{align}\n\\]\n更一般的，对于任意的 \\(n\\)，\n\\[\nE[X_1 + X_2 + ... + X_n] = E[X_1] + E[X_2] + ... + E[X_n]\n\\tag{4.45}\\]\n式 4.45 是一个非常有用的公式，接下来，我们将通过一系列的例子来说明其作用。\n\n习题 4.11 抛两个骰子，计算两个骰子的和的期望值。\n\n\n解 4.11. 如果令 \\(X\\) 是两个骰子的和，则\n\\(E[X]=\\sum_{i=2}^{12}{iP\\{X=i\\}}\\)\n我们令 \\(X_1\\)、\\(X_2\\) 分别表示这两个骰子的点数，则有 \\(X = X_1 + X_2\\)，于是有：\n\\(E[X] = E[X_1 + X_2] = E[X_1] + E[X_2]\\)，根据 式 4.45 有 \\(E[X] = 7\\)。\\(\\blacksquare\\)\n\n\n习题 4.12 一家建筑公司最近投标了三个项目，这三个项目可以获得的利润分别为 1 万美元、2 万美元、4 万美元。对这三个项目，如果该公司中标的概率分别为 0.2、0.8、0.3，那么该公司的预期总利润是多少？\n\n\n解 4.12. 令 \\(X_i\\) 表示投标的第 \\(i\\) 个项目的利润，其中 \\(i=1,2,3\\)。令 \\(X\\) 表示总利润，则 \\(X = X_1 + X_2 + X_3\\)。所以，\n\\(E[X] = E[X_1 + X_2 + X_3] = E[X_1] + E[X_2] + E[X_3] = 3 万美元\\)。\\(\\blacksquare\\)\n\n\n习题 4.13 秘书打印出了 \\(N\\) 封信件以及信件对应的信封。当信封掉在地板上时，他们会混在一起。如果这 \\(N\\) 封信件以完全随机的方式放在已经混淆的信封里（每封信件放在任何一个信封的概率相同），则放到正确的信封中的信件数量的期望值是多少？\n\n\n解 4.13. 令 \\(X\\) 表示放到正确的信封中的信件数量，则：\n\\(X = X_1 + X_2 + ... + X_N\\)，其中 \\(X_i = \\begin{cases} 1, \\quad & 第 i 封信放在了第 i 个信封中\\\\ 0, \\quad & 其他 \\end{cases}\\)。\n由于第 \\(i\\) 封信放入 \\(N\\) 个信封中的可能性是相同的，因此，\\(P\\{X_i=1\\}=\\frac{1}{N}\\)。\n所以有：\\(E[X_i]=1 \\cdot P\\{X_i = 1\\} + 0 \\cdot P\\{X_i = 0\\} = \\frac{1}{N}\\)，根据 式 4.45 有：\n\\(E[X] = E[X_1] + ... + E[X_N] = \\frac{1}{N} N =1\\)。\n因此，不管有多少封信，平均来说，只有一封信会放在正确的信封里。\\(\\blacksquare\\)\n\n\n习题 4.14 假设有 20 种不同类型的优惠券，并且每次获取优惠券时得到每一种优惠券的可能性都是相等的。如果现在获得了 10 张优惠券，计算其中包含的优惠券种类的预期数量。\n\n\n解 4.14. 令 \\(X\\) 表示这 10 张优惠券中包含的优惠券类型的数量，则：\n\\(X = X_1 + ... + X_20\\)，其中 \\(X_i = \\begin{cases} 1, \\quad & 至少有 1 张第 i 种优惠券\\\\ 0, \\quad & 其他 \\end{cases}\\)。\n所以有：\n\\[\n\\begin{align}\nE[X_i] &= P\\{X_i = 1\\} \\\\\n&= P\\{在 10 张优惠券中至少有 1 张第 i 种优惠券\\} \\\\\n&= 1 - P\\{在 10 张优惠券中不存在第 i 种优惠券\\} \\\\\n&= 1 - \\bigg(\\frac{19}{20}\\bigg)^{10}\n\\end{align}\n\\]\n所以 \\(E[X] = E[X_1] + ... + E[X_20] = 20 \\cdot \\Bigg(1 - \\big(\\frac{19}{20}\\big)^{10}\\Bigg) = 8.025\\)。\\(\\blacksquare\\)\n\n当我们必须预测一个 随机变量 的值时，均值（mean）的一个重要属性就显现出来了。也就是说，假设要预测一个 随机变量 \\(X\\) 的值，如果我们预测 \\(X\\) 将等于 \\(c\\)，那么预测“误差”（或者称为：残差）的平方将是 \\((X−c)^2\\)。接下来，我们将证明：当 \\(X\\) 的预测值等于它的均值 \\(\\mu\\) 时，均方误差的值是最小的。\n对于任何常数 \\(c\\) 有：\n\\[\n\\begin{align}\nE[(X-c)^2] &= E[(X - \\mu + \\mu - c)^2] \\\\\n&= E[(X - \\mu)^2 + 2(X - \\mu)(\\mu - c) + (\\mu -c)^2] \\\\\n&= E[(X - \\mu)^2] + 2(\\mu - c)E[(X - \\mu)] + (\\mu -c)^2 \\\\\n&= E[(X - \\mu)^2] + (\\mu -c)^2, \\qquad \\because E[X - \\mu] = E[X] - \\mu = 0 \\\\\n&\\ge E[(X - \\mu)^2]\n\\end{align}\n\\tag{4.46}\\]\n因此，当 随机变量 的平方误差的期望最小时，可以得到 随机变量 的最佳预测器——即其平均值。",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>随机变量和期望</span>"
    ]
  },
  {
    "objectID": "chapter_4/4.html#方差",
    "href": "chapter_4/4.html#方差",
    "title": "4  随机变量和期望",
    "section": "4.6 方差",
    "text": "4.6 方差\n给定一个 随机变量 \\(X\\) 及其概率分布函数，如果我们能够定义某些合适的度量并用来总结质量函数的基本特征，那将是非常有用的。期望 \\(E[X]\\) 就是其中的一个度量。虽然 \\(E[X]\\) 生成了 \\(X\\) 的可能值的加权平均数，但 \\(E[X]\\) 却没有告诉我们 \\(X\\) 的这些可能值的变化。例如，当 随机变量 \\(W\\)、\\(Y\\)、\\(Z\\) 的概率质量函数分别为：\n\\(W=0 \\quad 概率为 1\\)\n\\(Y=\\begin{cases} -1, \\quad & 概率为 \\frac{1}{2}\\\\ 1, \\quad & 概率为 \\frac{1}{2} \\end{cases}\\)\n\\(Y=\\begin{cases} -100, \\quad & 概率为 \\frac{1}{2}\\\\ 100, \\quad & 概率为 \\frac{1}{2} \\end{cases}\\)\n虽然这三个 随机变量 的期望都是 0，但是 \\(Y\\) 的变化幅度比 \\(W\\) 要大，同时 \\(Z\\) 的变化幅度比 \\(Y\\) 也要大。\n因为我们期望 \\(X\\) 在其平均值 \\(E[X]\\) 附近取值，所以可以利用 \\(X\\) 的实际取值与 \\(E[X]\\) 之间的距离来测量 \\(X\\) 的变化。可以同过量化 \\(E[|X − \\mu|]\\) 来计算 \\(X\\) 的实际取值与 \\(E[X]\\) 之间的距离，其中 \\(\\mu = E[X]\\)，\\(|X − \\mu|\\) 代表 \\(X - \\mu\\) 的绝对值。然而，事实证明，在数学上处理 \\(E[|X − \\mu|]\\) 极其麻烦。因此，我们通常会用一个更容易处理的数据——即 \\(X\\) 与其平均值之差的平方的期望。\n\n定义 4.1 如果 \\(X\\) 是一个均值为 \\(\\mu\\) 的 随机变量，则 \\(X\\) 的 方差（variance）\\(\\textup{Var}(X)\\) 为：\\(\\textup{Var}(X) = E[(X - \\mu)^2]\\)。\n\n于是，我们有如下的推导：\n\\[\n\\begin{align}\n\\textup{Var}(X) &= E[(X - \\mu)^2] \\\\\n&= E[X^2 - 2 \\mu X + \\mu ^2] \\\\\n&= E[X^2] - 2 \\mu E[X] + \\mu ^2 \\\\\n&= E[X^2] - (E[X])^2 \\quad \\because E[X] = \\mu \\\\\n\\end{align}\n\\]\n所以有：\n\\[\n\\textup{Var}(X) = E[X^2] - (E[X])^2\n\\tag{4.47}\\]\n换句话说，\\(X\\) 的方差等于 \\(X\\) 的平方的期望减去 \\(X\\) 的期望的平方。实际上，通常，式 4.47 是计算 \\(\\textup{Var}(X)\\) 的最简单的方法。\n\n习题 4.15 令 \\(X\\) 为抛一个骰子的点数，计算 \\(\\textup{Var}(X)\\)。\n\n\n解 4.15. 因为 \\(P\\{X=i\\}=\\frac{1}{6}\\)，\\(i=1,2,...,6\\)，因此：\n\\(E[X^2] = \\sum_{i=1}^{6}{i^2 \\cdot P\\{X=i\\}} = \\frac{91}{6}\\)。\n在 习题 4.8 中，我们知道 \\(E[X]=\\frac{7}{2}\\)，根据 式 4.47：\n\\(\\textup{Var}(X)=E[X^2] - (E[X])^2 = \\frac{91}{6} - (\\frac{7}{2})^2 = \\frac{35}{12}\\)。\\(\\blacksquare\\)\n\n\n例 4.12 指示随机变量的方差，对于事件 \\(A\\)，指示随机变量 \\(I\\) 为：\n\\(I = \\begin{cases} 1, \\quad & 如果 A 发生\\\\ 0, \\quad & 如果 A 不发生 \\end{cases}\\)\n根据 例 4.7 有，\\(E[I] = P(A)\\)，所以有： \\[\n\\begin{align}\n\\textup{Var}(I) &= E[I^2] - (E(I))^2 \\\\\n&= E[I] - (E[I])^2 \\quad \\because I^2=I \\\\\n&= E[I](1-E[I]) \\\\\n&= P(A)(1-P(A)) \\qquad \\blacksquare\n\\end{align}\n\\]\n\n因为 \\((X - \\mu)^2 \\ge 0\\)，因此，\\(\\textup{Var}(X) = E[(X - \\mu)^2] \\ge 0\\)，根据 式 4.47 有：\n\\[\nE[X^2] \\ge \\mu^2\n\\tag{4.48}\\]\n也就是说，一个 随机变量 的平方的 期望 至少与其 期望 的平方一样大。\n\n例 4.13 友谊悖论（friendship paradox）表明：平均而言，你的朋友的朋友数量比你的朋友数量要更多。更正式地，假设某个人群中有 \\(n\\) 个人，标记为 \\(1,2,...,n\\)，这些人中的某些人之间是朋友。这个 朋友网络 （friendship network）可以用 图（graphic）来表示：用顶点表示每个人，然后用顶点与顶点之间的连线表示这些人是朋友。例如，如 图 4.5 所示，该社区中有 4 个人，第 1 个人和第 2 个人是朋友，第 1 个人和第 3 个人是朋友，第 1 个人和第 4 个人是朋友，第 2 个人和第 4 个人是朋友。\n\n\n代码\nlibrary(igraph)\n \nvertices &lt;- c(1, 2, 3, 4)  \nedges &lt;- cbind(c(1, 1, 1, 2), c(3, 2, 4, 4))  \ng &lt;- graph_from_edgelist(edges, directed = FALSE)  \nV(g)$label &lt;- vertices\n\nplot(g, vertex.label.cex = 1.5)\n\n\n\n\n\n\n\n\n图 4.5: 一个朋友网络图\n\n\n\n\n\n令 \\(f(i)\\) 表示第 \\(i\\) 个人的朋友数，令 \\(f=\\sum_{i=1}^{n}{f(i)}\\)。在 图 4.5 中，\\(f(1)=3\\)，\\(f(2)=2\\)，\\(f(3)=1\\)，\\(f(4)=2\\)，\\(f = 8\\)。\n我们随机选择一个人，并用 \\(X\\) 表示，\\(X\\) 可以是 \\(1,2,...,n\\) 中的任何一个，并且选取到的概率是一致的。也就是说，\n\\(P(X=i)=\\frac{1}{n}\\)\n根据 命题 4.1，\\(X\\) 的朋友数量的期望 \\(E[f(X)]\\) 为：\n\\(E[f(X)] = \\sum_{i=1}^{n}{f(i)P(X=i)}=\\sum_{i=1}^{n}{\\frac{f(i)}{n}} = \\frac{f}{n}\\)\n假设这 \\(n\\) 个人中的每个人都将他所有朋友的名字分别写在了一张单独的纸上（一个名字一张纸）。因此，一个有 \\(k\\) 个朋友的人将使用 \\(k\\) 张纸。因为第 \\(i\\) 个人有 \\(f(i)\\) 个朋友，因此总共会有 \\(\\sum_{i=1}^{n{f(i)}}\\) 张纸来记录名字。\n现在随机选择一张纸，令 \\(Y\\) 表示纸上的名字，并计算所选纸上的人的朋友数量的期望 \\(E[f(Y)]\\)。\n\n首先，因为第 \\(i\\) 个人有 \\(f(i)\\) 个朋友， 所以有 \\(f(i)\\) 张纸上的名字写的是 \\(i\\)，因此，所选择的纸上的名字为 \\(i\\) 的概率为 \\(\\frac{f(i)}{f}\\)，即：\n\\(P(Y=i)=\\frac{f(i)}{f}, i = 1,...,n\\)\n于是，\\(E[f(Y)] = \\sum_{i=1}^{n}{f(i)P(Y=i)} = \\frac{\\sum_{i=1}^{n}{f^2(i)}}{f}\\)。\n因为 \\(P(X=i)=\\frac{1}{n}\\)，\\(E[f(X)] = \\frac{f}{n}\\)，所以 \\(f = \\frac{E[f(x)]}{P(X=i)}\\)，所以有：\n\\[\n\\begin{align}\nE[f(Y)] &= \\frac{\\sum_{i=1}^{n}{f^2(i)}}{f} \\\\\n&= \\frac{\\sum_{i=1}^{n}{f^2(i)P(X=i)}}{E[f(X)]} \\\\\n&= \\frac{E[f^2(X)]}{E[f(X)]} \\\\\n&\\ge E[f(X)], \\ \\because E[X^2] \\ge \\mu^2\n\\end{align}\n\\]\n\n因此，\\(E[f(X)] \\le E[f(Y)]\\)，这表明随机选择的某个人的平均朋友数量小于或等于其朋友的平均朋友数量。\n\n\n\n\n\n\n备注\n\n\n\n从直觉上讲，友谊悖论的原因在于：\n\n选择 \\(X\\) 的概率是相同的（\\(X\\) 为 \\(n\\) 个人中的任何一个的概率是相同）。\n选择 \\(Y\\) 的概率与其朋友数量成正比。\n所以，一个人拥有的朋友越多，这个人就越有可能是 \\(Y\\)。因此，\\(Y\\) 偏向于拥有大量朋友的那个人。\n因此，\\(Y\\) 拥有的平均朋友数量大于 \\(X\\) 拥有的平均朋友数量也就不足为奇了。\n\n\n\n\n\n\n\n\n\n注记\n\n\n\n“友谊悖论”（friendship paradox）这一现象由社会学家斯科特·费尔德（Scott L. Feld）于1991年发现，其原因在于，那些在社交网络中连接较为广泛的人（即拥有较多朋友的人）更容易被其他人选为朋友，从而使得在统计上呈现出这样看似矛盾的结果。\n\n\n\\(\\blacksquare\\)\n\n对于任意的常数 \\(a\\)、\\(b\\)，有：\n\\[\n\\textup{Var}(aX + b) = a^2 \\textup{Var}(X)\n\\tag{4.49}\\]\n\n证. 令 \\(\\mu = E[X]\\)，根据 推论 4.1 有 \\(E[aX + b] = a \\mu + b\\)，根据方差的定义 定义 4.1 有：\n\\[\n\\begin{align}\n\\textup{Var}(aX + b) &= E[(aX + b - E[aX + b])^2] \\\\\n&= E[(aX + b - a \\mu - b)^2] \\\\\n&= E[(aX - a \\mu)^2] \\\\\n&= E[a^2(X - \\mu)^2] \\\\\n&= a^2E[(X - \\mu)^2] \\\\\n&= a^2\\textup{Var}(X)\n\\end{align}\n\\]\n\n式 4.49 中，对于特定的 \\(a\\) 和 \\(b\\) 可以导出其他的推论。例如，如果 \\(a=0\\)，则有：\n\\(\\textup{Var}(b) = 0\\)\n即：常数的方差为 0（这符合直觉吗？）。类似的，令 \\(a = 1\\)，则有：\n\\(\\textup{Var}(X + b) = \\textup{Var}(X)\\)\n也就是说，随机变量 加一个常数的方差等于该 随机变量 的方差。最后，令 \\(b=0\\)，则有：\n\\(\\textup{Var}(aX) = a^2\\textup{Var}(X)\\)\n\\(\\sqrt{\\textup{Var}(X)}\\) 称为 \\(X\\) 的标准差（standard deviation）。随机变量 的标准差和均值具有相同的单位。\n\n\n\n\n\n\n备注\n\n\n\n与 均值 是质量分布的 重心 的概念类似，在力学中，方差 代表 惯性矩（the moment of inertia）。\n\n\n\n\n\n\n\n\n惯性矩\n\n\n\n在力学中，惯性矩（又称转动惯量）是一个用于描述物体绕轴转动时惯性大小的物理量。\n具体来说，它衡量了物体对于绕某一特定轴转动的抵抗能力。惯性矩越大，物体绕该轴转动就越困难，也就越不容易改变其转动状态；反之，惯性矩越小，物体就相对更容易改变其转动状态。\n其数学定义通常是对于质量分布为 \\(m_i\\)、距离转动轴为 \\(r_i\\) 的多个质点组成的物体，惯性矩等于各质点质量与该质点到转动轴距离平方的乘积之和，即 \\(I=\\sum m_ir_i^2\\)。\n例如，对于一个均匀圆盘，其绕中心轴的惯性矩与圆盘的质量和半径的平方有关；对于一个细长的直杆，绕垂直于杆且通过一端的轴转动时，其惯性矩也有特定的表达式。惯性矩在研究物体的转动运动、机械设计等方面都有着重要的应用。\n方差和惯性矩有一定的相似性，但不能简单地说方差就是惯性矩。方差主要是用来描述一组数据离散程度的统计量。它反映了数据相对于均值的偏离程度。而惯性矩是在力学中用于衡量物体绕轴转动时惯性大小的物理量。\n从某种意义上来说，它们有一些相似之处。比如两者都涉及到对“差异”或“偏离”的一种度量。在惯性矩中，是质量分布相对于转动轴的偏离程度；在方差中，是数据点相对于均值的偏离程度。",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>随机变量和期望</span>"
    ]
  },
  {
    "objectID": "chapter_4/4.html#协方差以及随机变量的和的方差",
    "href": "chapter_4/4.html#协方差以及随机变量的和的方差",
    "title": "4  随机变量和期望",
    "section": "4.7 协方差以及随机变量的和的方差",
    "text": "4.7 协方差以及随机变量的和的方差\n在 小节 4.5 中，我们证明了任意数量的 随机变量 之和的 期望 等于它们各自 期望 的和（式 4.45）。但是，对于 方差 而言，却并非如此。例如：\n\\[\n\\begin{align}\nVar(X+X) &= Var(2X) \\\\\n&= 2^2 Var(X) \\\\\n&= 4 Var(X) \\\\\n& \\ne Var(X) + Var(X)\n\\end{align}\n\\]\n然而，当这些 随机变量 是独立的条件时，随机变量 的和的 方差 等于这些 随机变量 各自的方差的和。但是，在证明这一点之前，我们先定义两个 随机变量 的 协方差（covariance） 的概念。\n\n定义 4.2 两个 随机变量 \\(X\\)、\\(Y\\) 的 协方差 \\(\\textup{Cov}(X,Y)\\) 的定义如下：\n\\(\\textup{Cov}(X,Y) = E[(X - \\mu_x)(Y - \\mu_y)]\\)，其中 \\(\\mu_x\\) 和 \\(\\mu_y\\) 分别为 \\(X\\) 和 \\(Y\\) 的均值。\n\n对 定义 4.2 中的等式右边进行展开，则有：\n\\[\n\\begin{align}\n\\textup{Cov}(X,Y) &= E[XY - \\mu_x Y -\\mu_y X + \\mu_x \\mu_y] \\\\\n&= E[X,Y] - \\mu_xE[Y] - \\mu_yE[X] + \\mu_x \\mu_y \\\\\n&= E[XY] - \\mu_x \\mu_y - \\mu_y \\mu_x + \\mu_x \\mu_y \\\\\n&= E[XY] - E[X]E[Y]\n\\end{align}\n\\tag{4.50}\\]\n根据 定义 4.2，我们可以知道 协方差 满足如下的性质：\n\n\n\n\n\n\n提示\n\n\n\n\\[\n\\textup{Cov}(X,Y) = \\textup{Cov}(Y,X)\n\\tag{4.51}\\]\n\\[\n\\textup{Cov}(X,X) = \\textup{Var}(X)\n\\tag{4.52}\\]\n\\[\n\\textup{Cov}(aX, Y) = a \\textup{Cov}(X, Y)\n\\tag{4.53}\\]\n\n\n与 期望 一样，协方差 也具有加和性（additive property）。\n\n引理 4.1 \\(\\textup{Cov}(X_1 + X_2, Y) = \\textup{Cov}(X_1, Y) + \\textup{Cov}(X_2,Y)\\)\n\n\n证. \\[\n\\begin{align}\n\\textup{Cov}(X_1 + X_2,Y) &= E[(X_1+X_2)Y] - E[X_1+X_2]E[Y] \\\\\n&= E[X_1Y] + E[X_2Y]-(E[X_1] + E[X_2])E[Y] \\\\\n&= E[X_1Y] - E[X_1]E[Y] + E[X_2Y] - E[X_2]E[Y] \\\\\n&= \\textup{Cov}(X_1,Y) + \\textup{Cov}(X_2,Y) \\quad \\blacksquare\n\\end{align}\n\\]\n\n引理 4.1 的一般形式如下：\n\\[\n\\textup{Cov}\\bigg( \\sum_{i=1}^{n}{X_i},Y \\bigg) = \\sum_{i=1}^{n}{\\textup{Cov}(X_i,Y)}\n\\tag{4.54}\\]\n\n命题 4.2 \\[\n\\textup{Cov}\\bigg( \\sum_{i=1}^{n}{X_i},\\sum_{j=1}^{m}{Y_j} \\bigg) = \\sum_{i=1}^{n} \\sum_{j=1}^{m} {\\textup{Cov}(X_i,Y_j)}\n\\]\n\n\n证. \\[\n\\begin{align}\n\\textup{Cov}\\bigg( \\sum_{i=1}^{n}{X_i},\\sum_{j=1}^{m}{Y_j} \\bigg) &= \\sum_{i=1}^{n}{\\textup{Cov}\\bigg(X_i, \\sum_{j=1}^{m}{Y_j}\\bigg)} \\\\\n&= \\sum_{i=1}^{n}{\\textup{Cov}\\bigg(\\sum_{j=1}^{m}{Y_j}, X_i\\bigg)} \\\\\n&= \\sum_{i=1}^{n} \\sum_{j=1}^{m} {\\textup{Cov}(Y_j,X_i)} \\\\\n&= \\sum_{i=1}^{n} \\sum_{j=1}^{m} {\\textup{Cov}(X_i,Y_j)} \\quad \\blacksquare\n\\end{align}\n\\]\n\n使用 式 4.52 可以得到 随机变量 之和的方差的公式。\n\n推论 4.2 \\[\n\\textup{Var}\\bigg( \\sum_{i=1}^{n}{X_i} \\bigg) = \\sum_{i=1}^{n}{\\textup{Var}(X_i)} + \\sum_{i=1}^{n} \\sum_{\\begin{align} &j=1 \\\\ &j \\ne i \\end{align}}^{n} {\\textup{Cov}(X_i, X_j)}\n\\]\n\n\n证. 因为 \\(\\textup{Cov}(X, X) = \\textup{Var}(X)\\)（式 4.52），根据 命题 4.2 有：\n\\[\n\\begin{align}\n\\textup{Var}\\bigg( \\sum_{i=1}^{n}{X_i} \\bigg) &= \\textup{Cov}\\bigg( \\sum_{i=1}^{n}{X_i}, \\sum_{j=1}^{n}{X_j} \\bigg) \\\\\n&= \\sum_{i=1}^{n} \\sum_{j=1}^{n} {\\textup{Cov}(X_i, X_j)} \\\\\n&= \\sum_{i=1}^{n} \\bigg( \\sum_{j \\ne i}{\\textup{Cov}(X_i, X_j)} + \\textup{Cov}(X_i, X_i)\\bigg) \\\\\n&= \\sum_{i=1}^{n} \\sum_{j \\ne i} {\\textup{Cov}(X_i, X_j)} + \\sum_{i=1}^{n}{\\textup{Cov}(X_i, X_i)} \\\\\n&= \\sum_{i=1}^{n} \\sum_{j \\ne i} {\\textup{Cov}(X_i, X_j)} + \\sum_{i=1}^{n}{\\textup{Var}(X_i)} \\quad \\blacksquare\n\\end{align}\n\\]\n\n当 \\(n = 2\\) 时，推论 4.2 变为：\n\\(\\textup{Var}(X+Y) = \\textup{Var}(X) + \\textup{Var}(Y) + \\textup{Cov}(X,Y) + \\textup{Cov}(Y,X)\\)\n根据 式 4.51 有：\n\\[\n\\textup{Var}(X+Y) = \\textup{Var}(X) + \\textup{Var}(Y) + 2\\textup{Cov}(X,Y)\n\\tag{4.55}\\]\n\n定理 4.1 如果 \\(X\\) 和 \\(Y\\) 是独立 随机变量，则 \\(\\textup{Cov}(X,Y) = 0\\)。\n更一般的，如果 \\(X_1,...,X_n\\) 是相互独立的 随机变量，则 \\(\\textup{Var}\\bigg( \\sum_{i=1}^{n}{X_i} \\bigg)=\\sum_{i=1}^{n}{\\textup{Var}(X_i)}\\)。\n\n证. 要证明 \\(\\textup{Cov}(X,Y) = 0\\)，根据 式 4.50 可知，我们需要证明：\n\\(E[XY] = E[X]E[Y]\\)\n如果 \\(X\\)、\\(Y\\) 为独立离散随机变量，则有：\n\\[\n\\begin{align}\nE[XY] &= \\sum_{j}^{} \\sum_{i}^{} {x_i y_i P\\{X=x_i, Y=y_j\\}} \\\\\n&= \\sum_{j}^{} \\sum_{i}^{} {x_i y_i P\\{X=x_i\\}P\\{Y=y_j\\}} \\quad \\because X,Y 相互独立 \\\\\n&= \\sum_{y}^{}{y_jP\\{Y=y_j\\}} \\cdot \\sum_{j}^{}{x_iP\\{X=x_i\\}} \\\\\n&= E[Y]E[X]\n\\end{align}\n\\]\n故而有 \\(\\textup{Cov}(X,Y)=E[XY] - E[X]E[Y] = 0\\)。对于连续随机变量而言，该等式依然成立。所以 定理 4.1 得证。\n\n\n\n习题 4.16 抛 10 次骰子，计算这 10 次获得的点数之和的 方差。\n\n\n解 4.16. 令 \\(X_i\\) 表示第 \\(i\\) 次的点数，则根据 习题 4.15 有，\\(\\textup{Var}(X_i) = \\frac{35}{12}\\)，所以： \\[\n\\begin{align}\n\\textup{Var}\\bigg( \\sum_{i=1}^{10}{X_i} \\bigg) &= \\sum_{i=1}^{10}{\\textup{Var}(X_i)} \\\\\n&= 10 \\frac{35}{12} \\\\\n&= \\frac{175}{6} \\quad \\blacksquare\n\\end{align}\n\\]\n\n\n习题 4.17 抛 10 次硬币，计算正面向上的次数的 方差。\n\n\n解 4.17. 令 \\(I_j = \\begin{cases} 1, \\quad & 第 j 次结果为正面向上\\\\ 0, \\quad & 第 j 次结果为反面向上 \\end{cases}\\)，\n则 正面向上的总次数为 \\(\\sum_{j=1}^{10}{I_j}\\)。\n根据 定理 4.1 有：\\(\\textup{Var}\\bigg( \\sum_{j=1}^{10}{I_j} \\bigg) = \\sum_{j=1}^{10}{\\textup{Var}(I_j)}\\)。\n现在，由于 \\(I_j\\) 是概率为 的 事件 的指示 随机变量，从 例 4.12 可知：\n\\(\\textup{Var}(I_j) = \\frac{1}{2}(1-\\frac{1}{2}) = \\frac{1}{4}\\)，因此：\n\\(\\textup{Var}\\bigg( \\sum_{j=1}^{10}{I_j} \\bigg) = \\frac{10}{4}\\)。\\(\\blacksquare\\)\n\n\n\n\n\n\n\n重要\n\n\n\n两个 随机变量 的 协方差 可以作为一个重要指标以衡量它们之间的关系。例如，考虑 \\(X\\) 和 \\(Y\\) 是 事件 \\(A\\) 和 事件 \\(B\\) 是否发生的指标随机变量，即：\n\\(X = \\begin{cases} 1, \\quad & 如果 A 发生\\\\ & \\\\ 0, \\quad & 如果 A 不发生 \\end{cases},  \\quad Y = \\begin{cases} 1, \\quad & 如果 B 发生\\\\ & \\\\ 0, \\quad & 如果 B 不发生 \\end{cases}\\)\n并且：\n\\(XY = \\begin{cases} 1, \\quad & 如果 X=1, Y=1\\\\ & \\\\ 0, \\quad & 其他 \\end{cases}\\)\n因此：\n\\(\\begin{align} \\textup{Cov}(X,Y) &= E[XY] - E[X]E[Y] \\\\ &= P\\{X=1,Y=1\\} - P\\{X=1\\}P\\{Y=1\\} \\end{align}\\)\n故而：\n\\(\\begin{align} \\textup{Cov}(X,Y) \\gt 0 & \\Leftrightarrow P\\{X=1,Y=1\\} \\gt P\\{X=1\\}P\\{Y=1\\} \\\\ & \\Leftrightarrow \\frac{P \\{X=1,Y=1\\}}{P\\{X=1\\}} \\gt P\\{Y=1\\} \\\\ & \\Leftrightarrow P\\{Y=1|X=1\\} \\gt P\\{Y=1\\} \\end{align}\\)\n如果 \\(X=1\\) 时，\\(Y=1\\) 的可能性更小，而 \\(Y=0\\) 的可能性更大，则 \\(\\textup{Cov}(X,Y) \\lt 0\\) 。（根据 协方差 的交换律，当 \\(X\\) 和 \\(Y\\) 互换时，如上的内容仍然正确。）\n\n\n\n\n\n\n\n\n相关系数\n\n\n\n一般来说，\\(\\textup{Cov}(X,Y) \\gt 0\\) 表明 \\(Y\\) 会随着 \\(X\\) 的增加而增加，而 \\(\\textup{Cov}(X,Y) \\lt 0\\) 表明 \\(Y\\) 会随着 \\(X\\) 的增加而减少。可以用 \\(X\\) 和 \\(Y\\) 之间的相关性来表示 \\(X\\) 和 \\(Y\\) 之间关系的强度。\\(X\\) 和 \\(Y\\) 之间的相关性是其 协方差 除以其各自 标准差 的乘积得到的 无量纲量（dimensionless）。即：\n\\[\n\\textup{Corr}(X,Y) = \\frac{\\textup{Cov}(X,Y)}{\\sqrt{\\textup{Var}(X) \\textup{Var}(Y)}}\n\\tag{4.56}\\]\n可以证明，\\(\\textup{Corr}(X,Y)\\) 的值总是介于 −1 和 +1 之间。",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>随机变量和期望</span>"
    ]
  },
  {
    "objectID": "chapter_4/4.html#矩生成函数",
    "href": "chapter_4/4.html#矩生成函数",
    "title": "4  随机变量和期望",
    "section": "4.8 矩生成函数",
    "text": "4.8 矩生成函数\n\n\n\n\n\n\n注记\n\n\n\n矩生成函数（Moment Generating Function）是概率论中的一个重要概念，主要用于描述 随机变量 的概率分布。矩生成函数是 随机变量 的特征函数，我们可以利用矩生成函数得到 随机变量 的所有矩（平均值、方差、偏度等统计量）。\n\n\n随机变量 \\(X\\) 的矩生成函数 \\(\\phi(t)\\) 的定义如下：\n\\[\n\\phi(t) = E[e^{tX}] = \\begin{cases}\n\\sum_{x}{e^{tx}p(x)}, \\quad & 如果 X 为离散随机变量 \\\\\n& \\\\\n& \\\\\n\\int_{-\\infty}^{\\infty}{e^{tx}f(x) \\mathrm{d} x}, \\quad & 如果 X 为连续随机变量 \\\\\n\\end{cases}\n\\tag{4.57}\\]\n因为 \\(X\\) 的所有的矩都可以通过对 \\(\\phi(t)\\) 求 \\(k\\) 阶导数来获得，因此我们称 \\(\\phi(t)\\) 为矩生成函数。例如\n\n\\(\\phi'(0)=E[X]\\)：\n\n\\[\n\\begin{align}\n\\phi'(t) &= \\frac{\\mathrm{d} {E[e^{tX}]}}{\\mathrm{d} t} \\\\\n&= E\\bigg[ \\frac{\\mathrm{d} {e^{tX}}}{\\mathrm{d} t} \\bigg] \\\\\n&= E[Xe^{tX}] \\\\\n\\therefore \\phi'(0) &= E[Xe^{0 \\cdot X}] = E[X]\n\\end{align}\n\\tag{4.58}\\]\n\n\\(\\phi''(0)=E[X^2]\\)\n\n\\[\n\\begin{align}\n\\phi''(t) &= \\frac{\\mathrm{d} {\\phi'(t)}}{\\mathrm{d} t} \\\\\n&= \\frac{\\mathrm{d} {E[Xe^{tX}]}}{\\mathrm{d} t} \\\\\n&= E\\bigg[ \\frac{\\mathrm{d} {(Xe^{tX})}}{\\mathrm{d} t} \\bigg] \\\\\n&= E[X^2e^{tX}] \\\\\n\\therefore \\phi''(0) &= E[X^2]\n\\end{align}\n\\tag{4.59}\\]\n\n更一般的，在 \\(t=0\\) 处的 \\(\\phi(t)\\) 的 \\(n\\) 阶导数等于 \\(E[X^n]\\)，即：\n\n\\[\n\\phi^{n}(0) = E[X^n], \\quad n \\ge 1\n\\tag{4.60}\\]\n矩生成函数的一个重要特性是：独立 随机变量 之和的矩生成函数是每个 随机变量 的矩生成函数的乘积。假设 \\(X\\) 和 \\(Y\\) 是独立 随机变量，其矩生成函数分别为 \\(\\phi_X(t)\\)、\\(\\phi_Y(t)\\)，则 \\(X+Y\\) 的矩生成函数为：\n\\(\\begin{align} \\phi_{X+Y}(t) &= E[e^{t(X+Y)}] \\\\ &= E[e^{tX}e^{tY}] \\\\ &= E[e^{tX}]E[e^{tY}] \\\\ &= \\phi_X(t)\\phi_Y(t) \\end{align}\\)\n如果 \\(X\\) 和 \\(Y\\) 是相互独立的，则 \\(e^{tX}\\) 和 \\(e^{tY}\\) 也是独立的，所以根据 定理 4.1 有 \\(E[e^{tX}e^{tY}] = E[e^{tX}]E[e^{tY}]\\)，所以上式得证。\n矩生成函数的另一个重要的特性是：矩生成函数唯一地确定了 随机变量 的概率分布。也就是说，矩生成函数和 随机变量 的分布函数之间存在一一对应的关系。",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>随机变量和期望</span>"
    ]
  },
  {
    "objectID": "chapter_4/4.html#切比雪夫不等式和弱大数定律",
    "href": "chapter_4/4.html#切比雪夫不等式和弱大数定律",
    "title": "4  随机变量和期望",
    "section": "4.9 切比雪夫不等式和弱大数定律",
    "text": "4.9 切比雪夫不等式和弱大数定律\n我们从证明马尔可夫不等式（Markov’s inequality）开始本节的内容。\n\n命题 4.3 马尔可夫不等式：如果 \\(X\\) 是一个取值为非负数的 随机变量，则对于任意的 \\(a \\gt 0\\) 有：\n\\(P\\{X \\ge a\\} \\le \\frac{E[X]}{a}\\)\n\n证. 我们给出了概率密度函数为 \\(f\\) 的连续 随机变量 \\(X\\) 的证明。\n\\[\n\\begin{align}\nE[X] &= \\int_{0}^{\\infty}{xf(x) \\mathrm{d} x} \\\\\n&= \\int_{0}^{a}{xf(x) \\mathrm{d} x} + \\int_{a}^{\\infty}{xf(x) \\mathrm{d} x} \\\\\n& \\ge \\int_{a}^{\\infty}{xf(x) \\mathrm{d} x} \\\\\n& \\ge \\int_{a}^{\\infty}{af(x) \\mathrm{d} x} \\\\\n&= a\\int_{a}^{\\infty}{f(x) \\mathrm{d} x} \\\\\n&= aP\\{X \\ge a\\} \\quad \\blacksquare\n\\end{align}\n\\]\n\n\n作为推论，我们得到 命题 4.4。\n\n命题 4.4 契比雪夫不等式：如果\\(X\\) 是一个均值为 \\(\\mu\\) 方差为 \\(\\sigma^2\\) 的随机变量，则对于任意的 \\(k \\gt 0\\) 有：\n\\(P\\{|X - \\mu| \\ge k\\} \\le \\frac{\\sigma^2}{k^2}\\)\n\n证. 因为 \\((X-\\mu)^2\\) 是一个非负的随机变量，因此，令 \\(a=k^2\\)，然后根据 命题 4.3 所示的马尔科夫不等式有：\n\\[\nP\\{(X-\\mu)^2 \\ge k^2\\} \\le \\frac{E[(X-\\mu)^2]}{k^2}\n\\tag{4.61}\\]\n\\((X-\\mu)^2 \\ge k^2\\) 当且仅当 \\(|X-\\mu| \\ge k\\)，所以 式 4.61 等价于：\n\\[\nP\\{|X-\\mu| \\ge k\\} \\le \\frac{E[(X-\\mu)^2]}{k^2} = \\frac{\\sigma^2}{k^2}\n\\tag{4.62}\\]\n证毕。\\(\\blacksquare\\)\n\n\n马尔可夫不等式和切比雪夫不等式的重要性在于：在只知道概率分布的均值或均值和方差的情况下，我们可以利用马尔可夫不等式和切比雪夫不等式推导出概率的界限。当然，如果实际的概率分布是已知的，那么就可以精确的计算出待计算的概率，我们也就不需要计算概率的界限。\n\n习题 4.18 已知工厂一周的产量是一个 随机变量，其平均值为 50。\n\n本周的产量超过 75 的概率可以说是多少？\n如果已知一周的产量的方差等于 25，那么本周产量在 40 和 60 之间的概率是多少？\n\n\n\n解 4.18. 令 \\(X\\) 为工厂一周的产量。\n\n利用马尔科夫不等式可知：\n\\(P\\{X \\gt 75\\} \\le \\frac{E[X]}{75} = \\frac{50}{75} = \\frac{2}{3}\\)\n利用切比雪夫不等式可知：\n\\(P\\{|X-50| \\ge 10\\} \\le \\frac{\\sigma^2}{10^2} = \\frac{1}{4}\\)，所以：\n$\\(P\\{|X-50| \\lt 10\\} \\ge 1 - \\frac{1}{4} = \\frac{3}{4}\\)。\n因此，本周产量在 40 和 60 之间的概率最小是 0.75。\\(\\blacksquare\\)\n\n\n在 式 4.62 中，令 \\(k = k\\sigma\\)，我们可以将切比雪夫不等式改写为：\n\\[\nP\\{|X - \\mu| \\ge k\\sigma\\} \\le \\frac{1}{k^2}\n\\tag{4.63}\\]\n因此，随机变量 与其 均值 相差超过 \\(k\\) 个 标准差 的概率最大为 \\(\\frac{1}{k^2}\\)。\n在本节的最后，我们将用切比雪夫不等式来证明弱大数定律（weak law of large numbers）。弱大数定律指出：在一个独立同分布的 随机变量 序列中，当 \\(n\\) 趋向于无穷大时，前 \\(n\\) 个 随机变量 的平均数（average）和该随机变量的均值（mean）的差值超过 \\(\\varepsilon\\) 的概率为 0。\n\n定理 4.2 弱大数定律：令 \\(X_1, X_2,...\\) 是一个独立同分布的 随机变量 序列，每个 随机变量 的均值都为 \\(\\mu\\)（\\(E[X_i] = \\mu\\)）。则，对于任意的 \\(\\varepsilon \\gt 0\\)，有：\n\\(P\\bigg\\{ \\big| \\frac{X_1 + X_2 + ... + X_n}{n} - \\mu \\big| \\gt \\varepsilon \\bigg\\} \\rightarrow 0, \\quad n \\rightarrow \\infty\\)\n\n证. 我们只能在 随机变量 的方差 \\(\\sigma^2\\) 为有限数的附加假设下证明 定理 4.2。因为：\n\\(E\\bigg[\\frac{X_1 + X_2 + ... + X_n}{n}\\bigg] = \\mu\\)，\\(\\textup{Var}\\bigg(\\frac{X_1 + X_2 + ... + X_n}{n}\\bigg) = \\frac{\\sigma^2}{n}\\)\n所以，根据 命题 4.4 的切比雪夫不等式有：\n\\(P\\bigg\\{ \\big| \\frac{X_1 + X_2 + ... + X_n}{n} - \\mu \\big| \\gt \\varepsilon \\bigg\\} \\le \\frac{\\sigma^2}{n \\varepsilon^2}\\)\n证毕。\\(\\blacksquare\\)\n\n\n假设我们独立执行某个试验多次，令 \\(E\\) 为某个固定 事件，用 \\(P(E)\\) 表示 \\(E\\) 在给定试验中发生的概率。令\n\\(X_i = \\begin{cases} 1, \\quad & 第 i 次试验中 E 发生\\\\ 0, \\quad & 第 i 次试验中 E 不发生 \\end{cases}\\)\n则 \\(X_1+X_2+...+X_n\\) 表示在 \\(n\\) 次试验中，\\(E\\) 发生的次数。因为 \\(E[X_i]=P(E)\\)，所以根据弱大数定律，对于任意的 \\(\\varepsilon \\gt 0\\)，无论 \\(\\varepsilon\\) 有多小，随着 \\(n\\) 的增加，前 \\(n\\) 次试验中 \\(E\\) 发生的比例与 \\(P(E)\\) 的差值超过 \\(\\varepsilon\\) 的概率会变为 0。",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>随机变量和期望</span>"
    ]
  },
  {
    "objectID": "chapter_4/4.html#习题",
    "href": "chapter_4/4.html#习题",
    "title": "4  随机变量和期望",
    "section": "习题",
    "text": "习题\n\n根据考试成绩对 5 名男性和 5 名女性进行排名。假设所有人的分数都不相同，并且所有的 \\(10!\\) 种可能的排名的可能性都相等。令 \\(X\\) 表示女性获得的最高名次（例如，如果排名第 1 的是男性，而排名第 2 的是女性，则 \\(X=2\\)）。找出 \\(P\\{X=i\\}, i=1,2,3,...,8,9,10\\)。\n设 \\(X\\) 表示抛 \\(n\\) 次硬币得到的正面向上的次数和反面向上的次数之差，则 \\(X\\) 的可能值是多少？\n在习题 2 中，如果假设硬币是公平的，对于 \\(n=3\\)，则 \\(X\\) 可能取值的对应的概率是多少？\n随机变量 \\(X\\) 的分布函数为： \\[\nF(x) = \\begin{cases}\n0, \\quad & x \\lt 0  \\\\\n\\frac{x}{2}, \\quad & 0 \\le x \\lt 1 \\\\\n\\frac{2}{3}, \\quad & 1 \\le x \\lt 2 \\\\\n\\frac{11}{12}, \\quad & 2 \\le x \\lt 3 \\\\\n1, \\quad & 3 \\le x \\\\\n\\end{cases}\n\\]\n\n画出分布函数的图\n计算 \\(P\\{X \\gt \\frac{1}{2}\\}\\)？\n计算 \\(P\\{2 \\lt X \\le 4\\}\\)？\n计算 \\(P\\{X \\le 3\\}\\)？\n计算 \\(P\\{X = 1\\}\\)？\n\n假设随机变量 \\(X\\) 的概率密度函数为： \\[\nf(x) = \\begin{cases}\ncx^3, \\quad & 0 \\le x \\le 1 \\\\\n0, \\quad & 其他\n\\end{cases}\n\\]\n\n计算 \\(c\\) 的值？\n计算 \\(P\\{0.4 \\lt X \\lt 0.8\\}\\)？\n\n计算机在故障前运行的小时数是一个连续随机变量，其概率密度函数为：\n\\[\nf(x) = \\begin{cases}\n\\lambda e^{-\\frac{x}{100}}, \\quad & x \\ge 0 \\\\\n0, \\quad & x \\lt 0\n\\end{cases}\n\\]\n\n一台计算机在故障前工作了 50 到 150 小时的概率是多少？\n工作不到 100 小时的概率是多少？\n\n收音机中某种电子管的寿命（以小时为单位）是一个随机变量，其概率密度函数为：\n\\[\nf(x) = \\begin{cases}\n0, \\quad & x \\le 100 \\\\\n\\frac{100}{x^2}, \\quad & x \\gt 100\n\\end{cases}\n\\]\n一台收音机中的 5 个这样的电子管中恰有 2 个必须在 150 小时内更换的概率是多少？假设在这段时间内，必须更换第 \\(i\\) 个电子管的 事件 \\(E_i, i=1,2,3,4,5\\) 是独立的。\n如果 \\(X\\) 的概率密度函数为：\n\\[\nf(x) = \\begin{cases}\nce^{-2x}, \\quad & 0 \\lt x \\lt \\infty \\\\\n0, \\quad & x \\lt 0\n\\end{cases}\n\\]\n\n计算 \\(c\\)？\n计算 \\(P\\{X \\gt 2\\}\\)？\n\n我们要检测 5 个晶体管，我们以随机的顺序每次检测 1 个晶体管，并检查哪一个晶体管有缺陷。假设 5 个晶体管中有 3 个有缺陷，令 \\(N_1\\) 表示发现第 1 个缺陷晶体管时我们检测的次数，让 \\(N_2\\) 表示发现第 2 个缺陷晶体管时额外增加的检测次数。计算 \\(N_1\\) 和 \\(N_2\\) 的联合概率质量函数。\n\\(X\\) 和 \\(Y\\) 的联合概率密度函数为：\n\\(f(x,y)=\\frac{6}{7}\\big(x^2 + \\frac{xy}{2}\\big), \\ 0 \\lt x \\lt 1, \\ 0 \\lt y \\lt 2\\)\n\n验证这确实是一个联合密度函数？\n计算 \\(X\\) 的边缘密度函数？\n计算 \\(P\\{X \\gt Y\\}\\)？\n\n令 \\(X_1, X_2, ..., X_n\\) 是符合 \\(U(0,1)\\) 的均匀分布的独立随机变量。令 \\(M = max(X_1, X_2, ...,X_n)\\)，则 \\(M\\) 的分布函数为：\n\\(F_M(x) = x^n, \\ 0 \\le x \\le 1\\)\n计算 \\(M\\) 的概率密度函数？\n\\(X\\)、\\(Y\\) 的联合密度函数为：\n\\(f(x,y)=\\begin{cases} xe^{-(x+y)}, \\quad & x \\gt 0, y \\gt 0 \\\\ 0, \\quad & 其它 \\end{cases}\\)\n\n计算 \\(X\\) 的边缘密度函数？\n计算 \\(Y\\) 的边缘密度函数？\n\\(X\\) 和 \\(Y\\) 是独立的吗？\n\n\\(X\\)、\\(Y\\) 的联合概率密度函数为：\n\\(f(x,y)=\\begin{cases} 2, \\quad & 0 \\lt x \\lt y, 0 \\lt y \\lt 1 \\\\ 0, \\quad & 其它 \\end{cases}\\)\n\n计算 \\(X\\) 的边缘密度函数？\n计算 \\(Y\\) 的边缘密度函数？\n\\(X\\) 和 \\(Y\\) 是独立的吗？\n\n如果 \\(X\\) 和 \\(Y\\) 的联合密度函数可以分解为仅依赖于 \\(x\\) 的部分和仅依赖于 \\(y\\) 的部分，则 \\(X\\) 和 \\(Y\\) 是独立的。如果：\n\\(f(x,y)=k(x)h(y), \\ -\\infty \\lt x \\lt \\infty, \\ -\\infty \\lt x \\lt \\infty\\)\n证明，\\(X\\)、\\(Y\\) 是相互独立的。\n习题 14 与习题 12 和习题 13 的结果一致吗？\n假设 \\(X\\)、\\(Y\\) 是独立的连续随机变量，证明：\n\n\\(P\\{X + Y \\le a\\} = \\int_{-\\infty}^{\\infty}{F_X(a-y)f_Y(y)\\mathrm{d} y}\\)\n\\(P\\{X \\le Y\\} = \\int_{-\\infty}^{\\infty}{F_X(y)f_Y(y)\\mathrm{d} y}\\)\n\n其中，\\(f_Y\\) 是 \\(Y\\) 的边缘概率密度函数，\\(F_X\\) 是 \\(X\\) 的边缘分布函数。\n当电流 \\(I\\)（单位为安培）流过电阻 \\(R\\) 时（单位为欧姆），产生的功率（单位为瓦特）为 \\(W=I^2R\\)。 假设 \\(I\\) 和 \\(R\\) 是独立随机变量且其概率密度函数为：\n\\(f_I(x) = 6x(1-x), \\quad 0 \\le x \\le 1\\)\n\\(f_R(x) = 2x, \\quad 0 \\le x \\le 1\\)\n计算 \\(W\\) 的概率密度函数？\n在 例 4.5 中，计算所选择的家庭有 2 个女孩的条件概率质量函数？\n计算 \\(X\\) 在 \\(Y=y\\) 时的条件概率密度函数：\n\n\\(X\\)、\\(Y\\) 的联合概率密度函数如习题 10\n\\(X\\)、\\(Y\\) 的联合概率密度函数如习题 13\n\n证明 \\(X\\)、\\(Y\\) 是独立随机变量当且仅当：\n\n\\(X\\)、\\(Y\\) 是离散随机变量且 \\(P_{X|Y}(x|y)=p_X(x)\\)\n\\(X\\)、\\(Y\\) 是连续随机变量且 \\(f_{X|Y}(x|y)=f_X(x)\\)\n\n计算习题 1 中随机变量的期望？\n计算习题 3 中随机变量的期望？\n每天晚上，不同的气象学家会预测第二天下雨的“概率”。为了判断这些人的预测水平，我们将按如下的规则给他们打分：如果气象学家预测明天下雨的概率为 \\(p\\)，那么他们的得分为：\n\n如果明天确实下雨了，得分为：\\(1 - (1 - p)^2\\)\n如果明天没有下雨，得分为：\\(1 - p^2\\)\n\n对于这些打分，我们将跟踪一定的时间，并得出结论：平均打分最高的气象学家就是最佳天气预测者。现在，假设某个气象学家已经了解到了打分的规则，并希望最大化自己的打分。如果该气象学家真的相信明天下雨的概率为 \\(p^*\\)，那么为了最大化自己的打分，他预测明天下雨的概率 \\(p\\) 应该是多少？\n一家保险公司有一种保单，大意是：如果某个事件 \\(E\\) 在一年内发生，则他们必须支付一笔钱 \\(A\\)。如果保险公司估计 \\(E\\) 在一年内发生的概率为 \\(p\\)，保险公司应该向客户收取多少费用，以使得他们的预期利润将是 \\(A\\) 的 10%？\n4 辆载有来自同一所学校的 148 名学生的公共汽车来到一个足球场。公共汽车的载客量分别为：40名、33名、25名和50名。随机选择一名学生，令 \\(X\\) 表示随机选择的这个学生所在的公共汽车上的学生数量。对于 4 辆车的 4 名司机，随机选择 1 名司机，令 \\(Y\\) 表示该司机驾驶的公共汽车上的学生数量。\n\n你认为 \\(E[X]\\) 和 \\(E[Y]\\) 哪一个更大？为什么？\n计算 \\(E[X]\\) 和 \\(E[Y]\\)。\n\n在一场多局游戏比赛中，两个参赛队伍中，如果有一个首先赢得 \\(i\\) 局游戏，则游戏结束。假设每一局比赛都是独立的，且 \\(A\\) 队获胜概率是 \\(p\\)。当 \\(i=2\\) 时：\n\n计算游戏局数的期望？\n证明当 \\(p=\\frac{1}{2}\\) 时，该期望值最大？\n\n\\(X\\) 的概率密度函数为：\n\\(f(x)=\\begin{cases} a + bx^2, \\quad & 0 \\le x \\le 1\\\\ 0, \\quad & 其它 \\end{cases}\\)\n如果 \\(E[X] = \\frac{3}{5}\\)，计算 \\(a\\) 和 \\(b\\)。\n某电子管的寿命（单位为小时）是一个随机变量，其概率密度函数为：\n\\(f(x) = a^2xe^{-ax}, \\quad x \\ge 0\\)\n计算该电子管的寿命的期望？\n令 \\(X_1, X_2,...,X_n\\) 是独立同分布的随机变量，其概率密度函数为：\n\\(f(x) = \\begin{cases} 1, \\quad & 0 \\lt x \\lt 1\\\\ 0, \\quad & 其它 \\end{cases}\\)\n计算：\n\n\\(E[Max(X_1, X_2, ..., X_n)]\\)\n\\(E[Min(X_1, X_2, ..., X_n)]\\)\n\n假设 \\(X\\) 的概率密度函数为：\n\\(f(x)=\\begin{cases} 1, \\quad & 0 \\lt x \\lt 1\\\\ 0, \\quad & 其它 \\end{cases}\\)\n根据如下的要求计算 \\(E[X^n]\\)：\n\n先计算 \\(X^n\\) 的概率密度，然后根据期望的定义计算 \\(E[X^n]\\)\n利用 命题 4.1 计算 \\(E[X^n]\\)\n\n修理个人电脑所需的时间（以小时为单位）是一个随机变量，其密度函数为：\n\\(f(x)=\\begin{cases} \\frac{1}{2}, \\quad & 0 \\lt x \\lt 2\\\\ 0, \\quad & 其它 \\end{cases}\\)\n修理的费用取决于修理所需的时间，当修理所需时间为 \\(x\\) 时，费用为 \\(40 + 30 \\sqrt{x}\\)。计算修理个人电脑的费用的期望。\n如果 \\(E[X] = 2\\)，\\(E[X^2] = 8\\)，计算：\n\n\\(E[(2 + 4X)^2]\\)？\n\\(E[X^2 + (X+1)^2]\\)？\n\n从包含 17 个白球和 23 个黑球的盒子中随机选择 10 个球。令 \\(X\\) 表示所选白球的数量。利用如下的方式计算 \\(E[X]\\)：\n\n定义适当的指示随机变量 \\(X_i, i=1,...,10\\)，以满足 \\(X = \\sum_{i=1}^{10}{X_i}\\)。\n定义适当的指示随机变量 \\(Y_i, i=1,...,17\\)，以满足 \\(X = \\sum_{i=1}^{17}{Y_i}\\)。\n\n如果 \\(X\\) 是具有分布函数 \\(F\\) 的连续随机变量，则其中位数（median）的定义为令 \\(F(m)=\\frac{1}{2}\\) 的 \\(m\\) 的值。如果随机变量的概率密度函数如下所示，计算其中位数：\n\n\\(f(x) = e^{-x}, \\quad x \\ge 0\\)。\n\\(f(x) = 1, 0 \\le x \\le 1\\)。\n\n在预测随机变量的值方面，中位数和均值一样都是很重要的概念。如前所述（式 4.46），随机变量的均值是从最小化误差平方的期望的角度所得到的最佳预测器。而中位数则是通过最小化绝对误差的期望所得到的最佳预测器。也就是说，当 \\(c\\) 是 \\(X\\) 的分布函数的中位数时，\\(E[|X − c|]\\) 的值最小。当 \\(X\\) 是连续随机变量，且其分布函数和密度函数分别为 \\(F\\) 和 \\(f\\) 时，请证明如上的关于中位数的结论。提示：\n\\[\n\\begin{align}\nE[|X-c|] &= \\int_{-\\infty}^{\\infty}{|x-c|f(x)\\mathrm{d} x} \\\\\n&= \\int_{-\\infty}^{c}{|x-c|f(x)\\mathrm{d} x} + \\int_{c}^{\\infty}{|x-c|f(x)\\mathrm{d} x} \\\\\n&= \\int_{-\\infty}^{c}{(c-x)f(x)\\mathrm{d} x} + \\int_{c}^{\\infty}{(x-c)f(x)\\mathrm{d} x} \\\\\n&= cF(c) - \\int_{-\\infty}^{c}{xf(x)\\mathrm{d} x} + \\int_{c}^{\\infty}{xf(x)\\mathrm{d} x} - c[1 - F(c)]\n\\end{align}\n\\]\n然后利用微积分求 \\(c\\) 的最小值。\n对于随机变量的分布函数 \\(F\\)，如果有 \\(F(m_p)=p\\)，则我们称 \\(m_p\\) 为 \\(100p\\)-百分位数。如果一个随机变量的概率密度函数为：\n\\(f(x)=2e^{-2x}, \\quad x \\ge 0\\)\n求 \\(m_p\\)。\n一个社区由 100 对已婚夫妇组成。如果这个社区有 50 人去世了，那么剩下的 50 人中包含的夫妻数量的期望是多少？假设去世的人群随机来 \\(\\left(\\begin{array}{cc}  200 \\\\  50 \\end{array}\\right)\\) 中的任何一组。提示：对于 \\(i=1,...,100\\)，令\n\\(X_i = \\begin{cases}1, \\quad & 夫妻中没有人去世\\\\0, \\quad & 其它\\end{cases}\\)\n某个试验的成功概率为 \\(p\\)，如果独立执行 \\(n\\) 次试验，计算其成功次数的期望和方差？计算中，试验之间的独立性是有必要的吗？\n假设 \\(X\\) 取值 1、2、3、4 中的任何一个数的概率都是一致的，计算：\n\n\\(E[X]\\)。\n\\(Var(X)\\)。\n\n令 \\(p_i=P\\{X=i\\}\\)，假设 \\(p_1+p_2+p_3=1\\)。如果 \\(E[X]=2\\)，求：\n\n\\(p_1\\)、\\(p_2\\)、\\(p_3\\)的最大值？\n\\(Var(X)\\) 的最小值？\n\n抛 3 次硬币，计算其正面向上的次数的期望和方差？\n该题涉及到 例 4.13 所示的友谊悖论。我们随机选择一个人 \\(X\\)，并从 \\(X\\) 的好友中随机选择一个人 \\(W\\)。也就是说，在 \\(X\\) 的 \\(n\\) 位好友中，\\(W\\) 是 \\(X\\) 的好友的概率是 \\(\\frac{1}{n}\\)。在 例 4.13 中，已经证明了 \\(E[f(W)] \\ge E[f(X)]\\)，即随机选择的某个人的平均朋友数不大于其随机选择的朋友的平均朋友数。使用 图 4.5 给出的朋友圈证明该结论是正确的。\n某种零件的重量是一个随机变量 \\(X\\)，其概率密度函数为：\n\\(f(z)=\\begin{cases} z-8, \\quad & 8 \\le z \\le 9 \\\\ 10-z, \\quad & 9 \\lt z \\le 10 \\\\ 0, \\quad & 其它 \\end{cases}\\)\n\n计算随机变量 \\(X\\) 的期望和方差？\n工厂以 2 元的固定价格出售该零件，并且工厂保证：任何购买该零件的客户，如果发现该零件的重量低于 8.25，他们将退还货款。工厂生产该零件的成本与零件的重量关系为 \\(\\frac{x}{15} + 0.35\\)。计算每个零件的预期利润？\n\n在某次给定的选举中，令随机变量 \\(X_i\\) 表是对候选人 \\(i\\) 的投票支持率，假设 \\(X_1\\) 和 \\(X_2\\) 的概率密度函数为：\n\\(f_{X_1, X_2}(x,y)=\\begin{cases} 3(x+y), \\quad & x \\ge 0, y \\ge 0, 0 \\le x +y \\le 1\\\\ 0, \\quad & 其它 \\end{cases}\\)\n\n计算 \\(X_1\\) 和 \\(X_2\\) 的边缘密度函数？\n对于 \\(i=1,2\\)，计算 \\(E[X_i]\\) 和 \\(\\textup{Var}(X_i)\\)？\n\n我们会根据产品的缺陷数量和生产厂家对产品进行分类。设随机变量 \\(X_1\\) 表示单位产品的缺陷量（取值为 0，1，2，3），随机变量 \\(X_2\\) 表示工厂编号（取值为 1，2）。随机选择一个产品，其联合概率质量函数如下表所示：\n\n\n\n\n\\(X_2\\) = 1\n\\(X_2\\) = 2\n\n\n\n\n\\(X_1\\) = 0\n\\(\\frac{1}{8}\\)\n\\(\\frac{1}{16}\\)\n\n\n\\(X_1\\) = 1\n\\(\\frac{1}{16}\\)\n\\(\\frac{1}{16}\\)\n\n\n\\(X_1\\) = 2\n\\(\\frac{3}{16}\\)\n\\(\\frac{1}{8}\\)\n\n\n\\(X_1\\) = 3\n\\(\\frac{1}{8}\\)\n\\(\\frac{1}{4}\\)\n\n\n\n\n计算 \\(X_1\\)、\\(X_2\\) 的边缘概率分布？\n计算 \\(E[X_1]\\)，\\(E[X_2]\\)，\\(\\textup{Var}(X_1)\\)，\\(\\textup{Var}(X_2)\\)，\\(\\textup{Cov}(X_1, X_2)\\)？\n\n计算 习题 44 中的随机变量的相关性 \\(\\textup{Corr}(X_1, X_2)\\)？\n验证 式 4.53？\n用数学归纳法证明 式 4.54？\n令 \\(X\\) 的方差为 \\(\\sigma_x^2\\)，\\(Y\\) 的方差为 \\(\\sigma_y^2\\)。\n\n当 \\(0 \\le \\textup{Var}(\\frac{X}{\\sigma_x} + \\frac{Y}{\\sigma_y})\\) 时，有 \\(-1 \\le \\textup{Corr}(X,Y)\\)。\n当 \\(0 \\le \\textup{Var}(\\frac{X}{\\sigma_x} - \\frac{Y}{\\sigma_y})\\) 时，有 \\(-1 \\le \\textup{Corr}(X,Y) \\le 1\\)。\n当 \\(\\textup{Var}(Z) = 0\\) 时意味着 \\(Z\\) 是一个常数。\n\n证明：\n\n当 \\(Y=ax +b\\) 时，\\(\\textup{Corr}(X,Y)\\) 等于 1 或者 -1？\n当 \\(a &gt; 0\\) 时，\\(\\textup{Corr}(X,Y) = 1\\)，当 \\(a &lt; 0\\) 时，\\(\\textup{Corr}(X,Y) = -1\\)？\n\n一个试验的结果取值为 1、2、3，并且各自的概率为 \\(p_1,p_2,p_3\\)，并且 \\(sum_{i=1}^{3} = 1\\)。对于 \\(n\\) 次这样的相互独立的试验，令 \\(N_i\\) 表示实验结果为 \\(i\\) 的次数，证明：\n\n\\(\\textup{Cov}(N_1, N_2) = -np_1p_2\\)?\n请解释为什么如上的协方差是负数？\n\n提示：对于 \\(i=1,...,n\\)，\n令 \\(X_i=\\begin{cases} 1, \\quad & 第 i 次试验的结果为 1\\\\ 0, \\quad & 第 i 次试验的结果不为 1 \\end{cases}\\)。\n同理，令 \\(Y_j=\\begin{cases} 1, \\quad & 第 j 次试验的结果为 2\\\\ 0, \\quad & 第 j 次试验的结果不为 2 \\end{cases}\\)。\n然后证明 \\(N_1 = \\sum_{i=1}^{n}X_i\\)，\\(N_2 = \\sum_{j=1}^{n}Y_i\\)，然后利用 命题 4.2 和 定理 4.1 来证明 \\(\\textup{Cov}(N_1, N_2)\\)。\n对于 习题 4.12，计算 \\(\\textup{Cov}(X_i,X_j)\\)，并用该结果证明 \\(\\textup{Var}(X) = 1\\)。\n如果 \\(X_1\\) 和 \\(X_2\\) 的概率分布函数相同，证明：\\(\\textup{Cov}(X_1 - X_2, X_1 + X_2) = 0\\)（注意，此处没有假定 \\(X_1\\) 和 \\(X_2\\) 相互独立）。\n假设 \\(X\\) 的概率密度函数为：\\(f(x)=e^{-x}, \\ x \\gt 0\\)。\n\n计算 \\(X\\) 的矩生成函数，并用结果来确定 \\(X\\) 的均值和方差。\n直接根据概率密度函数计算 \\(X\\) 的均值并用来该值来校验上一步中得出的结果。\n\n如果 \\(X\\) 的概率密度函数为：\\(f(x) = 1, \\ 0 \\lt x \\lt 1\\)。\n\n计算 \\(E[e^{tX}]\\)。\n对 \\(E[e^{tX}]\\) 求 \\(n\\) 阶导数以得到 \\(E[X^n]\\)，并校验结果。\n\n假设随机变量 \\(X\\) 的均值和方差都是 20，计算 \\(P\\{0 \\le X \\le 40\\}\\)？\n根据过去的经验，教授知道学生期末考试的成绩是一个随机变量，并且其平均值为 75。\n\n学生考试成绩超过 85 的最大概率是多少？\n假设教授知道学生考试成绩的方差为 25，那么学生成绩在 65 到 85 之间的概率如何？\n最少有多少学生参加考试，才能确保该班级的平均水平在 70 到 80 之间的概率至少为 0.9？\n\n令 \\(X\\) 的分布函数为 \\(F_X\\)，\\(Y\\) 的分布函数为 \\(F_Y\\)，假设对于常数 \\(a &gt; 0\\)，\\(b &gt; 0\\)，有\n\\(F_X(x) = F_Y\\bigg(\\frac{x-a}{b}\\bigg)\\)\n\n用 \\(E[Y]\\) 来确定 \\(E[X]\\)？\n用 \\(\\textup{Var}(Y)\\) 来确定 \\(\\textup{Var}(X)\\)？\n\n提示：\\(X\\) 与哪个随机变量的分布相同？",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>随机变量和期望</span>"
    ]
  },
  {
    "objectID": "chapter_4/4.html#footnotes",
    "href": "chapter_4/4.html#footnotes",
    "title": "4  随机变量和期望",
    "section": "",
    "text": "为了证明这一点，我们必须证明这根杆绕点 \\(E[X]\\) 转动的力矩之和等于 0。也就是说，我们必须证明 \\(0=\\sum_{i}{(x_i−E[X])p(x_i)}\\)。↩︎",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>随机变量和期望</span>"
    ]
  },
  {
    "objectID": "chapter_5/5.html",
    "href": "chapter_5/5.html",
    "title": "5  特殊的随机变量",
    "section": "",
    "text": "5.1 伯努利分布和二项分布\n在实际应用中，某些类型的 随机变量 会反复出现。在本章中，我们将研究经常应用到的几种 随机变量。\n假设一项试验的结果只有两种：“成功”或“失败”。当实验结果是“成功”时，令 \\(X=1\\)；当结果是“失败”时，令 \\(X=0\\)。令 \\(p\\) 为“成功”的概率（\\(0 \\le p \\le 1\\)），那么 \\(X\\) 的概率质量函数为：\n\\[\n\\begin{align}\n& P\\{X = 0\\} = 1 - p \\\\\n& P\\{X = 1\\} = p\n\\end{align}\n\\tag{5.1}\\]\n一个 随机变量 \\(X\\) 的概率质量函数如果满足 式 5.1 （其中 \\(p \\in (0,1)\\)），我们称 \\(X\\) 是 伯努利随机变量（Bernoulli random variable，以瑞士数学家 James Bernoulli 的名字命名）。伯努利随机变量的期望为：\n\\(E[X] = 1 \\cdot P\\{X = 1\\} + 0 \\cdot P\\{X = 0\\} = p\\)\n也就是说，伯努利随机变量的期望就是该随机变量取值为 1 时的概率。\n假设现在要执行 \\(n\\) 个独立的试验，其中每个试验“成功”的概率为 \\(p\\) 并且“失败”的概率为 \\(1-p\\)。如果 \\(X\\) 表示 \\(n\\) 个试验中的成功次数，那么我们称 \\(X\\) 是参数为 \\((n, p)\\) 的二项随机变量（binomial random variable）。\n参数为 \\((n, p)\\) 的二项随机变量的概率质量函数为：\n\\[\nP\\{X=i\\} = \\left(\\begin{array}{cc}  n \\\\ i  \\end{array}\\right)p^i(1-p)^{n-i}, \\qquad i = 0,1,...,n\n\\tag{5.2}\\]\n其中，\\(\\left(\\begin{array}{cc}  n \\\\ i  \\end{array}\\right) = \\frac{n!}{i!(n-i)!}\\) 是从 \\(n\\) 个物体中抽取 \\(i\\) 个物体的不同的抽取方式数量。我们可以按照如下的步骤来校验 式 5.2 的正确性：\n例如，如果 \\(n = 5\\)，\\(i = 2\\)，则成功 2 次的总的试验数量为 \\(\\left(\\begin{array}{cc}  5 \\\\ 2  \\end{array}\\right)\\)，也就是：\n\\((s,s,f,f,f) \\quad (f,s,s,f,f) \\quad (f,f,s,f,s)\\)\n\\((s,f,s,f,f) \\quad (f,s,f,s,f) \\quad (s,f,f,s,f)\\)\n\\((f,s,f,f,s) \\quad (f,f,f,s,s) \\quad (s,f,f,f,s) \\quad (f,f,s,s,f)\\)\n其中，\\((f,s,f,s,f)\\) 意味着：第 2 次和第 4 次试验的结果是“成功”的。由于 \\(\\left(\\begin{array}{cc}  5 \\\\ 2  \\end{array}\\right)\\) 种实验结果种，每一种的概率都为 \\(p^2(1−p)^3\\)，因此在 5 次实验中出现 2 次成功的概率为 \\(\\left(\\begin{array}{cc}  5 \\\\ 2  \\end{array}\\right)p^2(1-p)^3\\)。 我们可以发现 \\(p(i)\\) 的和为 1，也就是说：\n\\(\\sum_{i=0}^{\\infty}{p(i)} = \\sum_{i=0}^{n} \\left(\\begin{array}{cc}  n \\\\ i  \\end{array}\\right) p^i (1-p)^{n-i} = \\big( p + (1-p)\\big)^n = 1\\)\n图 5.1 给出了三个参数分别为 \\((10, 0.5)\\)，\\((10, 0.3)\\)，\\((10, 0.6)\\) 的二项随机变量的概率质量函数。其中，当 \\(p=0.5\\) 时，图形是对称的；当 \\(p=0.3\\) 时，图形是右偏的；当 \\(p=0.6\\) 时，图形是左偏的（如 小节 2.5 所示）。\n由于具有参数 \\((n,p)\\) 的二项随机变量 \\(X\\) 表示 \\(n\\) 个独立试验中的成功次数，其中每个试验成功的概率为 \\(p\\)，因此我们可以将 \\(X\\) 表示为：\n\\[\nX = \\sum_{i=1}^{n}{X_i}\n\\tag{5.3}\\]\n其中，\\(X_i = \\begin{cases} 1, \\quad & 第 i 次试验是成功的 \\\\ 0, \\quad & 其它 \\end{cases}\\)\n因为 \\(X_i\\) 之间是相互独立的伯努利随机变量，因此有：\n\\(E[X_i] = P\\{X_i = 1\\} = p\\)\n\\(\\textup{Var}(X_i) = E[X_i^2] - E^2[X_i] = p - p^2 = p(1-p)\\)，其中因为 \\(X_i^2 = X_i\\)，所以 \\(E[X_i^2] = E[X_i] = p\\)。\n根据 式 5.3，二项随机变量 \\(X\\) 的期望和方差为：\n\\(E[X] = \\sum_{i=1}^{n}{E[X_i]} = np\\)\n\\(\\textup{Var}(X) = \\sum_{i=1}^{n}{\\textup{Var}(X_i)} = np(1-p)\\)\n如果 \\(X_1\\) 和 \\(X_2\\) 是两个独立的二项随机变量，并且其参数分别为 \\((n_i, p),i=1,2\\)，则 \\(X_1 + X_2\\) 也是一个二项随机变量并且其参数为 \\((n_1 + n_2, p)\\)。因为 \\(X_i,i=1,2\\) 代表在 \\(n_i\\) 个独立试验（每个试验的成功概率为 \\(p\\)）中成功的数量，所以 \\(X_1+X_2\\) 代表 \\(n_1+n_2\\) 个独立试验（每个试验的成功概率为 \\(p\\)）中成功的数量。因此，\\(X_1+X_2\\) 是参数为 \\((n_1+n_2, p)\\) 的二项随机变量。",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>特殊的随机变量</span>"
    ]
  },
  {
    "objectID": "chapter_5/5.html#sec-5_1",
    "href": "chapter_5/5.html#sec-5_1",
    "title": "5  特殊的随机变量",
    "section": "",
    "text": "首先，假设这 \\(n\\) 次试验是相互独立的，则在任何一个特定的试验序列中出现 \\(i\\) 次“成功” \\(n-i\\) 次失败的概率为 \\(p^i(1-p)^{n-i}\\)。\n其次，因为在 \\(n\\) 次试验中，出现 \\(i\\) 次“成功” \\(n-i\\) 次失败的不同的试验数量为 \\(\\left(\\begin{array}{cc}  n \\\\ i  \\end{array}\\right)\\)，因此 \\(p^i(1-p)^{n-i}\\) 需要再乘以 \\(\\left(\\begin{array}{cc}  n \\\\ i  \\end{array}\\right)\\)。\n\n\n\n\n\n\n\n\n\n代码\nlibrary(ggplot2)\n\nn &lt;- 10\np &lt;- 0.5 \n\nrandom_numbers &lt;- rbinom(n = 10000, size = n, prob = p)\ndf &lt;- data.frame(x = random_numbers)\nggplot(df, aes(x = x)) +  \n    geom_bar() +\n    scale_x_continuous(breaks = seq(0,10,1), limits = c(0, 10))\n\np &lt;- 0.3\nrandom_numbers &lt;- rbinom(n = 10000, size = n, prob = p)\ndf &lt;- data.frame(x = random_numbers)\nggplot(df, aes(x = x)) +  \n    geom_bar() +\n    scale_x_continuous(breaks = seq(0,10,1), limits = c(0, 10))\n\np &lt;- 0.6\nrandom_numbers &lt;- rbinom(n = 10000, size = n, prob = p)\ndf &lt;- data.frame(x = random_numbers)\nggplot(df, aes(x = x)) +  \n    geom_bar() + \n    scale_x_continuous(breaks = seq(0,10,1), limits = c(0, 10))\n\n\n\n\n\n\n\n\n\n\n\n\n(a) \\((10, 0.5)\\)\n\n\n\n\n\n\n\n\n\n\n\n(b) \\((10, 0.3)\\)\n\n\n\n\n\n\n\n\n\n\n\n\n\n(c) \\((10, 0.6)\\)\n\n\n\n\n\n\n\n图 5.1: 二项分布的概率质量函数\n\n\n\n\n习题 5.1 某家公司生产的磁盘的次品率为 0.01，该公司按 10 个磁盘为一包的方式打包出售磁盘，并保证每包的 10 个磁盘中只要有超过 1 个次品就可以退货。那么，该公司的退货比例是多少？如果有人买了三包磁盘，其中退一包的概率是多少？\n\n\n解 5.1. 若果 \\(X\\) 是每包磁盘中的次品数量，则 \\(X\\) 是一个参数为 \\((10, 0.01)\\) 的二项随机变量。因此，对于 1 包磁盘而言，退货的概率为：\n\\(P\\{X \\gt 1\\} = 1 - P\\{X = 0\\} - P\\{X = 1\\} \\approx 0.05\\)\n因为每包磁盘的退货率都是 0.005 并且都是相互独立的，根据大数定律，从长远来看，该公司的退货比例为 0.5%。\n根据上述情况，顾客购买的三包磁盘中可以退货的包数是一个参数为 \\((3, 0.005)\\) 的二项随机变量。因此，三包磁盘中，恰好有一包退货的概率为 \\(\\left(\\begin{array}{cc}  3 \\\\ 1  \\end{array}\\right) \\cdot 0.005 \\cdot 0.995^2 = 0.015\\)。\\(\\blacksquare\\)\n\n\n习题 5.2 一个人的眼睛的颜色由单独的一对基因决定，其中棕色基因是显性基因，蓝色基因是隐形基因。这意味着：如果一个人的基因对中的两个基因都是蓝色基因，则他的眼睛是蓝色的；而如果他的基因对中的两个基因都是棕色的或者有一个棕色基因和一个蓝色基因，则他的眼睛是棕色的。每个人的基因对都是随机从父母的基因对中选择一个基因而构成的。如果一对夫妇的眼睛都是棕色的，并且他们的第一个孩子的眼睛是蓝色的，那么他们的另外四个孩子中的两个（另外的 4 个孩子都不是双胞胎）也有蓝色眼睛的概率是多少？\n\n\n解 5.2. 首先，因为他们最大的孩子的眼睛是蓝色的，因此这对夫妇的基因对均为一个棕色基因和一个蓝色基因（对于父母中有一个人有两个棕色基因，那么每个孩子都至少会得到一个棕色基因，因此所有孩子的眼睛都是棕色的）。这对夫妇的孩子的眼睛为蓝色的概率等于孩子的基因对中的基因都是蓝色基因的概率，即 \\(\\frac{1}{2} \\cdot \\frac{1}{2} = \\frac{1}{4}\\)。又因为其他四个孩子中的每个孩子的眼睛是蓝色的概率均为 \\(\\frac{1}{4}\\)，因此，他们中正好有两人的眼睛是蓝色的概率是：\n\\(\\left(\\begin{array}{cc}  4 \\\\ 2  \\end{array}\\right) \\cdot (\\frac{1}{4})^2 \\cdot (\\frac{3}{4})^2 = \\frac{27}{128}\\)。\\(\\blacksquare\\)\n\n\n习题 5.3 一个通信系统由 \\(n\\) 个组件组成，每个组件都是相互独立的，并且每个组件可以正常工作的概率都是 \\(p\\)。如果至少有一半的组件可以正常工作，整个系统就能够有效的运行。\n\n当 \\(p\\) 为多少时，5-组件系统比3-组件系统的稳定性更高？\n更一般的，当 \\(p\\) 为多少时，\\(2k+1\\)-组件系统比 \\(2k-1\\)-组件系统更稳定？\n\n\n\n解 5.3. \n\n因为可工作的组件数量是参数为 \\((n,p)\\) 的二项随机变量，因此5-组件系统可以正常工作的概率为：\n\\(\\left(\\begin{array}{cc}  5 \\\\ 3  \\end{array}\\right) p^3 (1-p)^2 + \\left(\\begin{array}{cc}  5 \\\\ 4  \\end{array}\\right) p^4 (1-p) + p^5\\)\n3-组件系统可以正常工作的概率为：\n\\(\\left(\\begin{array}{cc}  3 \\\\ 2  \\end{array}\\right) p^2 (1-p) + p^3\\)\n因此，当5-组件系统更稳定时，有：\n\\(10p^3(1−p)^2 +5p^4(1−p)+p^5 \\ge 3p^2(1−p)+p^3\\)\n于是有：\\(3(p−1)^2(2p−1) \\ge 0\\)，即 \\(p \\ge \\frac{1}{2}\\)。\n一般来说，当且仅当 \\(p \\ge \\frac{1}{2}\\) 时，\\(2k+1\\)-组件系统比 \\(2k-1\\)-组件系统更稳定。为了证明这一点，考虑一个 \\(2k+1\\)-组件系统， 并令 \\(X\\) 表示前 \\(2k-1\\) 个组件构成的系统可以正常运行时其正常工作的组件数量。然后有：\n\\(P_{2k+1}=P\\{X \\ge k + 1\\} + P\\{X = k\\}(1 − (1 − p)^2) + P\\{X = k − 1\\}p^2\\)\n因此，\\(2k+1\\)-组件系统可以正常运行时，需要满足如下条件：\n\n\n或者 \\(X \\ge k+1\\)\n\n\n或者 \\(X = k\\) 并且剩余的 2 个组件中至少有 1 个可以正常工作\n\n\n或者 \\(X = k - 1\\) 并且剩余的 2 个组件均可以正常工作\n\n\n因为 \\(P_{2k-1} = P\\{X \\ge k\\} = P\\{X=k\\} + P\\{X \\ge k+1\\}\\)，故而：\n\\[\n\\begin{align}\nP_{2k + 1} - P_{2k - 1} &= P\\{X = k−1\\}p^2 − (1−p)^2P\\{X = k\\} \\\\\n&= \\left(\\begin{array}{cc}  2k - 1 \\\\ k - 1  \\end{array}\\right) p^{k-1}(1-p)^kp^2 - (1-p)^2 \\left(\\begin{array}{cc}  2k - 1 \\\\ k   \\end{array}\\right) p^k (1-p)^{k-1} \\\\\n&= \\left(\\begin{array}{cc}  2k-1 \\\\ k  \\end{array}\\right) p^k (1-p)^k (p - (1-p)) \\\\\n\\ge 0 \\Leftrightarrow p \\ge \\frac{1}{2} \\quad \\blacksquare\n\\end{align}\n\\]\n\n\n\n习题 5.4 假设一家计算机硬件制造商生产的芯片的次品率为 10%。如果我们订购 100 个这样的芯片，我们收到的芯片中的次品数量 \\(X\\) 会是二项随机变量吗？\n\n\n解 5.4. 如果每个芯片可以工作的概率为 0.9 并且不同芯片之间可以工作的事件之间是相互独立的，则随机变量 \\(X\\) 将是一个参数为 \\((100, 0.1)\\) 的二项随机变量。当我们知道生产的芯片中有 10% 是次品时，\\(X\\) 是否是一个二项随机变量还取决于其他的因素。例如，假设在给定的一天中生产的所有芯片总是要么功能正常，要么是次品（其中 90% 的天数生产的芯片是功能正常的）。在这种情况下，如果我们知道我们的 100 个芯片都是在同一天生产的，此时芯片之间功能正常的事件并不是独立的，所以 \\(X\\) 将不是一个二项随机变量。事实上，在这种情况下，我们会得到：\n\\(P\\{X = 100\\} = 0.1\\)\n\\(P\\{X = 0\\} = 0.9\\) \\(\\quad \\blacksquare\\)\n\n\n\n\n\n\n\n\n\n\n\n\n5.1.1 使用 R 计算二项随机变量的概率\n在 R 中，如果想得到参数为 \\((n,p)\\) 的二项随机变量成功 \\(i\\) 次的概率，则可以输入：\n&gt; dbinom(i, n, p)\n对于相同的随机变量，如果想得到成功小于或等于 \\(i\\) 次的概率，则可以输入：\n&gt; pbinom(i, n, p)\n换句话说，如果 \\(X\\) 是一个二项随机变量，其参数为 \\((n,p)\\)，则在 R 中：\ndbinom(i, n, p) returns P(X = i)\npbinom(i, n, p) returns P(X &lt;= i)\n\n习题 5.5 如果 \\(X\\) 是一个参数为 \\((100,0.75)\\) 的二项随机变量，计算 \\(P(X=70)\\) 和 \\(P(X \\ge 80)\\)？\n\n\n解 5.5. \\(P(X=70)\\) 的计算代码为：\n&gt; dbinom(70, 100, 0.75)\n\n\n代码\ndbinom(70, 100, 0.75)\n\n\n[1] 0.04575381\n\n\n\\(P(X \\ge 80) = 1 - P(X \\le 79)\\)，其计算代码为：\n1 - pbinom(79, 100, 0.75)\n\n\n代码\n1 - pbinom(79, 100, 0.75)\n\n\n[1] 0.1488311\n\n\n\\(\\blacksquare\\)\n\n我们还可以使用 R 来绘制二项随机变量的概率图。假设 \\(X\\) 是一个参数为 \\((10, 4)\\) 的二项随机变量，并且我们想要绘制 \\(P(X=i), i=1...10\\) 的概率图。我们可以使用如下的代码：\n1i &lt;- seq(0, 10, 1)\n2p &lt;- dbinom(i, 10, 0.4)\n3plot(i, p)\n\n1\n\n\\(i\\) 从 0 到 10 并且步长为 1\n\n2\n\n对于 \\(i\\) 的每一个值，计算其 \\(X=i\\) 时的二项随机变量的概率\n\n3\n\n利用 plot(i, p) 画散点图\n\n\n利用如上的代码，我们可以得到如下的散点图：\n\n\n代码\ni &lt;- seq(0, 10, 1)\np &lt;- dbinom(i, 10, 0.4)\nplot(i, p)",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>特殊的随机变量</span>"
    ]
  },
  {
    "objectID": "chapter_5/5.html#泊松分布",
    "href": "chapter_5/5.html#泊松分布",
    "title": "5  特殊的随机变量",
    "section": "5.2 泊松分布",
    "text": "5.2 泊松分布",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>特殊的随机变量</span>"
    ]
  },
  {
    "objectID": "chapter_5/5.html#the-hypergeometric-random-variable",
    "href": "chapter_5/5.html#the-hypergeometric-random-variable",
    "title": "5  特殊的随机变量",
    "section": "5.3 The hypergeometric random variable",
    "text": "5.3 The hypergeometric random variable",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>特殊的随机变量</span>"
    ]
  },
  {
    "objectID": "chapter_5/5.html#sec-5_4",
    "href": "chapter_5/5.html#sec-5_4",
    "title": "5  特殊的随机变量",
    "section": "5.4 The uniform random variable",
    "text": "5.4 The uniform random variable",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>特殊的随机变量</span>"
    ]
  },
  {
    "objectID": "chapter_5/5.html#normal-random-variables",
    "href": "chapter_5/5.html#normal-random-variables",
    "title": "5  特殊的随机变量",
    "section": "5.5 Normal random variables",
    "text": "5.5 Normal random variables",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>特殊的随机变量</span>"
    ]
  },
  {
    "objectID": "chapter_5/5.html#exponential-random-variables",
    "href": "chapter_5/5.html#exponential-random-variables",
    "title": "5  特殊的随机变量",
    "section": "5.6 Exponential random variables",
    "text": "5.6 Exponential random variables",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>特殊的随机变量</span>"
    ]
  },
  {
    "objectID": "chapter_5/5.html#the-gamma-distribution",
    "href": "chapter_5/5.html#the-gamma-distribution",
    "title": "5  特殊的随机变量",
    "section": "5.7 The gamma distribution",
    "text": "5.7 The gamma distribution",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>特殊的随机变量</span>"
    ]
  },
  {
    "objectID": "chapter_5/5.html#sec-5_8",
    "href": "chapter_5/5.html#sec-5_8",
    "title": "5  特殊的随机变量",
    "section": "5.8 由正态分布衍生的分布",
    "text": "5.8 由正态分布衍生的分布\n\n5.8.1 卡方分布\n\n5.8.1.1 卡方分布和伽马分布之间的关系\n\n\n\n5.8.2 \\(t-\\text{分布}\\)\n\n\n5.8.3 \\(F-\\text{分布}\\)",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>特殊的随机变量</span>"
    ]
  },
  {
    "objectID": "chapter_5/5.html#the-logistics-distribution",
    "href": "chapter_5/5.html#the-logistics-distribution",
    "title": "5  特殊的随机变量",
    "section": "5.9 The logistics distribution",
    "text": "5.9 The logistics distribution",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>特殊的随机变量</span>"
    ]
  },
  {
    "objectID": "chapter_5/5.html#distributions-in-r",
    "href": "chapter_5/5.html#distributions-in-r",
    "title": "5  特殊的随机变量",
    "section": "5.10 Distributions in R",
    "text": "5.10 Distributions in R",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>特殊的随机变量</span>"
    ]
  },
  {
    "objectID": "chapter_5/5.html#problems",
    "href": "chapter_5/5.html#problems",
    "title": "5  特殊的随机变量",
    "section": "Problems",
    "text": "Problems",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>特殊的随机变量</span>"
    ]
  },
  {
    "objectID": "chapter_6/6.html",
    "href": "chapter_6/6.html",
    "title": "6  抽样分布",
    "section": "",
    "text": "6.1 引言\n统计学是一门从观测数据中得出结论的科学。例如，在技术研究中，经常遇到的一种情况是：我们可能会面对数量庞大的、具有可测量值（measurable values）的对象的集合。我们希望通过对这些数量庞大的对象适当抽样（sampling）并分析抽样得到的样本对象，从而得到一些和全部对象相关的结论。\n为了使用样本数据（sample data）推断总体（pupulation），必须对样本与总体之间的关系作某些假设。通常，非常合理的一个假设是：总体会存在一个潜在的概率分布，因此可以认为，从总体中抽取的对象的测量值是独立随机变量并且其分布于总体分布一致。如果通过随机抽取的方式来获得样本数据，那么样本数据是独立、同总体分布一致这样的假设是合理的。\n在大多数应用中，总体的分布 \\(F\\) 并非总是事先指定的（事实是，在大多数情况下，\\(F\\) 是未知的），因此我们会尝试使用数据来推断 \\(F\\)。\n在使用样本数据推断总体分布的过程中，如果假定总体的潜在分布 \\(F\\) 是由一组未知参数确定的，则称其为 参数推断（parametric inference）；而如果对总体的潜在分布 \\(F\\) 没有任何假设，则称其为 非参数推断（nonparametric inference）。\n在本章中，我们将关注由样本产生的某些统计量（或统计指标）的概率分布，其中 统计量（statistic）是一个随机变量，统计量的值由样本数据决定。我们将讨论的两个重要的统计量：样本均值 和 样本方差。",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>抽样分布</span>"
    ]
  },
  {
    "objectID": "chapter_6/6.html#sec-6_1",
    "href": "chapter_6/6.html#sec-6_1",
    "title": "6  抽样分布",
    "section": "",
    "text": "定义 6.1 如果 \\(X_1, ..., X_n\\) 是独立同分布的随机变量，其分布函数为 \\(F\\)，我们称 \\(X_1, ..., X_n\\) 构成了来自于 \\(F\\) 的 样本（sample）（有时也称其为随机样本）。\n\n\n\n有时，我们会假设 \\(F\\) 由一些未知的参数来确定。例如，我们可以假设 \\(F\\) 是一个均值和方差都未知的正态分布，或者是一个均值未知的泊松分布。\n有时，我们会假设，除了是一个连续分布或者离散分布外，\\(F\\) 几乎没有任何的已知信息。\n\n\n\n例 6.1 假设刚刚安装了一个新工艺以用来生产计算机芯片，并且假设这个新工艺生产的连续芯片的使用寿命是独立、同分布的，其分布是一个未知分布 \\(F\\)。\n物理原因有时会暗示分布 \\(F\\) 的参数形式。例如，物理原因可能会让我们相信 \\(F\\) 是一个正态分布或者是一个指数分布。在这种情况下，我们面对的将是一个 参数统计 问题，我们希望使用观察到的数据来估计 \\(F\\) 的参数。例如，如果假设 \\(F\\) 是正态分布，我们将希望估计其 均值 和 方差；如果假设 \\(F\\) 是指数分布，我们将希望估计其 均值。\n在其他情况下，可能没有任何物理依据来假设 \\(F\\) 具有某种特定分布形式。在这种情况下，关于 \\(F\\) 的推断问题将构成一个 非参数推断 问题。\n\n\n\n\n\n\n注记\n\n\n\n物理原因（Physical reasons）指的是基于物理学原理或物理现象的原因。在统计学和概率论中，物理原因通常涉及使用物理理论或实验结果来推导或假设某些统计分布的形式。例如，在某些情况下，物理现象可能会暗示数据遵循某种特定的分布：\n\n正态分布：如果某个过程受到大量小的、独立的随机影响，那么根据中心极限定理，最终的结果可能会接近正态分布。比如，测量误差通常假定为正态分布。\n指数分布：在某些情况下，事件的发生是完全随机的，且时间间隔独立且服从相同分布，那么这些时间间隔可能服从指数分布。比如，放射性衰变事件的时间间隔通常假设为指数分布。\n泊松分布：当在固定时间间隔内的事件发生是独立的，且事件发生的概率很小，次数很多时，事件的发生次数通常会服从泊松分布。比如，电话交换机中每小时接收到的呼叫数可能服从泊松分布。 \\(\\blacksquare\\)\n\n\n\n\n\n\n在 小节 6.2 中，我们将介绍 样本均值，并推导 样本均值 的期望和方差。我们注意到，当样本量至少为中等大小时，样本均值的分布近似正态分布。如上的结论来自于 中心极限定理（the central limit theorem）。\n中心极限定理是概率论中最重要的理论之一，我们将在 小节 6.3 中对其进行讨论。\n在 小节 6.4 中，我们将介绍 样本方差 并确定其期望。\n在 小节 6.5 中，我们假设总体服从正态分布，并给出样本均值和样本方差的联合分布。\n在 小节 6.6 中，我们假设从有限元素的总体中采样，并解释采样所得到的样本是“随机样本”的含义。当总体大小相对于样本大小很大时，我们通常将总体视为是无限大的。",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>抽样分布</span>"
    ]
  },
  {
    "objectID": "chapter_6/6.html#sec-6_2",
    "href": "chapter_6/6.html#sec-6_2",
    "title": "6  抽样分布",
    "section": "6.2 样本均值",
    "text": "6.2 样本均值\n考虑一个总体，总体中的每个元素都有一个数字类型的值（value）。例如，总体可能由特定社区的成年人构成，总体中和每个成年人相关的数字类型的值可能是其年收入、身高或年龄等。我们经常假设，与总体中的任何成员相关的值都可以看作期望为 \\(\\mu\\)、方差为 \\(\\sigma^2\\) 的随机变量的取值。我们称 \\(\\mu\\) 为总体均值，称 \\(\\sigma^2\\) 为总体方差。令 \\(X_1, X_2, ..., X_n\\) 是从该总体中抽取的样本的值，则样本均值的定义为：\n\\[\n\\overline{X} = \\frac{X_1 + ... + X_n}{n}\n\\]\n因为样本均值 \\(\\overline{X}\\) 的值取决于样本中的各随机变量的值，因此 \\(\\overline{X}\\) 也是一个随机变量。\\(\\overline{X}\\) 的期望和方差分别为：\n\\[\n\\begin{align}\nE[\\overline{X}] &= E\\bigg[\\frac{X_1 + ... + X_n}{n}\\bigg] \\\\\n&= \\frac{1}{n}(E[X_1] + ... + E[X_n]) \\\\\n&= \\mu \\\\\n\\textup{Var}(\\overline{X}) &= \\textup{Var}\\bigg(\\frac{X_1 + ... + X_n}{n}\\bigg) \\\\\n&= \\frac{1}{n^2}\\bigg(\\textup{Var}(X_1) + ... + \\textup{Var}(X_n) \\bigg) \\\\\n&= \\frac{n\\sigma^2}{n^2} \\\\\n&= \\frac{\\sigma^2}{n}\n\\end{align}\n\\tag{6.1}\\]\n其中，\\(\\mu\\) 和 \\(\\sigma^2\\) 分别为总体的均值和方差。因此，样本均值的期望就是总体均值 \\(\\mu\\)，而样本均值的方差就是总体方差的 \\(\\frac{1}{n}\\) 倍。因此，我们可以得出结论：\\(\\overline{X}\\) 也是以总体均值 \\(\\mu\\) 为中心，但是其波动会随着样本量的增加而变得越来越小。图 6.1 绘制了来自标准正态分布总体的、不同样本量的样本均值的概率密度函数。\n\n\n代码\nlibrary(ggplot2)\ndistributions &lt;- data.frame(\n  x = rep(seq(-4, 4, length = 1000), 4),\n  mean = rep(c(0, 0, 0, 0), each = 1000),\n  sd = rep(c(1, 0.5, 0.25, 0.1), each = 1000),\n  n  = rep(c(1, 2, 4, 10), each = 1000)\n)\n\n# 计算每个分布的概率密度\ndistributions$y &lt;- with(distributions, dnorm(x, mean=mean, sd=sd))\n\n# 绘制多个正态分布的曲线\nggplot(distributions, aes(x=x, y=y, color=factor(n))) +\n  geom_line() +\n  labs(color=\"n\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n图 6.1: 来自标准正态分布的不同样本量的样本均值的概率密度",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>抽样分布</span>"
    ]
  },
  {
    "objectID": "chapter_6/6.html#sec-6_3",
    "href": "chapter_6/6.html#sec-6_3",
    "title": "6  抽样分布",
    "section": "6.3 中心极限定理",
    "text": "6.3 中心极限定理\n在本节中，我们将讨论概率论中最为显著的一个结果——即中心极限定理（the central limit theorem）。简单的说，中心极限定理断言：大量的、独立随机变量的和的分布近似于正态分布。因此，对于独立随机变量的和而言，中心极限定理不仅提供了一种计算其近似概率的简单方法，而且还有助于解释许多自然总体的经验频率呈现钟形曲线（即正态分布）的这一显著现象。\n中心极限定理的最简单的形式如下：\n\n定理 6.1 中心极限定理：令 \\(X_1, X_2, ..., X_n\\) 是一个独立、同分布的随机变量的序列，其中每个随机变量的均值和方差均为 \\(\\mu\\) 和 \\(\\sigma^2\\)。对于一个比较大的 \\(n\\)，\n\\(X_1 + X_2 + \\cdots + X_n\\)\n的分布近似于均值为 \\(n\\mu\\)、方差为 \\(n\\sigma^2\\) 的正态分布。\\(\\blacksquare\\)\n\n根据 定理 6.1，\\(\\frac{X_1 + X_2 + \\cdots + X_n - n\\mu}{\\sqrt{n}\\sigma}\\) 的分布近似于标准正态分布 \\(\\mathcal{N}(0,1)\\)。因此，如果 \\(Z \\thicksim \\mathcal{N}(0, 1)\\)，对于一个比较大的 \\(n\\)，有：\n\\[\nP\\bigg\\{\\frac{X_1 + X_2 + \\cdots + X_n - n\\mu}{\\sqrt{n}\\sigma} \\lt x \\bigg\\} \\approx P\\{Z \\lt x\\}\n\\]\n\n习题 6.1 一家保险公司有 25000 名汽车保险的投保人。如果投保人的年度索赔额是均值为 320、标准差为 540 的随机变量，则投保人年度索赔总额超过 830 万元的概率是多少？\n\n\n解 6.1. 令 \\(X\\) 表示年度索赔总额。对投保人进行编号，令 \\(X_i\\) 表示第 \\(i\\) 位投保人的年度索赔额。当 \\(n = 25000\\) 时，根据中心极限定理，\\(X = \\sum_{i=1}^{n}{X_i}\\) 将近似于均值为 \\(320 \\times 25000 = 8 \\times 10^6\\)、标准差为 \\(540 \\sqrt{25000} = 8.5381 \\times 10^4\\) 的正态分布。因此：\n\\[\n\\begin{align}\nP\\{X &gt; 8.3 \\times 10^6\\} &= P\\bigg\\{\\frac{X - 8 \\times 10^6}{8.5381 \\times 10^4} \\gt \\frac{8.3 \\times 10^6 - 8 \\times 10^6}{8.5381 \\times 10^4} \\bigg\\} \\\\\n&= P\\bigg\\{\\frac{X - 8 \\times 10^6}{8.5381 \\times 10^4} \\gt \\frac{0.3 \\times 10^6}{8.5381 \\times 10^4} \\bigg\\} \\\\\n& \\approx P\\{Z \\gt 3.51 \\} \\\\\n& \\approx 0.00023\n\\end{align}\n\\]\n因此，年索赔额超过 830 万元的概率仅仅只有万分之 2.2。当然我们也可以使用 R 来计算待求的概率：\n1 - pnorm(8.3 * 10^6, 320 * 25000, 540 * sqrt(25000))\n\n\n代码\n1 - pnorm(8.3 * 10^6, 320 * 25000, 540 * sqrt(25000))\n\n\n[1] 0.0002210042\n\n\n\\(\\blacksquare\\)\n\n\n习题 6.2 土木工程师认为：在没有结构性损坏的情况下，某跨度的桥所能承受的重量（单位为 1000 磅）\\(W\\) 是一个均值为 400、标准差为 40 的正态分布。假设一辆汽车的重量（同样以 1000 磅为单位）是一个均值为 3、标准差为 0.3 的随机变量。该桥上必须有多少辆汽车才能使其发生结构性损坏的概率超过 0.1？\n\n\n解 6.2. 令 \\(P_n\\) 表示当桥上有 \\(n\\) 辆车时桥发生结构性损坏的概率。令 \\(X_i\\) 表示桥上第 \\(i\\) 辆汽车的重量，于是有：\n\\(\\begin{align} P_n &= P\\{X_1 + \\cdots + X_n \\ge W\\} \\\\ &= P\\{X_1 + \\cdots + X_n - W \\ge 0\\} \\end{align}\\)\n\n根据中心极限定理（定理 6.1），\\(\\sum_{i=1}^{n}{X_i}\\) 近似于均值为 \\(3n\\)、方差为 \\(0.09n\\) 的正态分布。因为 \\(W\\) 是与 \\(X_i\\) 之间相互独立的正态分布，因此 \\((\\sum_{i=1}^{n}{X_i}) - W\\) 也是一个正态分布，并且其均值和方差分别为：\n\\(E\\bigg[(\\sum_{i=1}^{n}{X_i}) - W\\bigg] = 3n - 400\\)\n\\(\\textup{Var}\\bigg((\\sum_{i=1}^{n}{X_i}) - W\\bigg) = \\textup{Var}\\bigg(\\sum_{i=1}^{n}{X_i}\\bigg) + \\textup{Var}(W) = 0.09n + 1600\\)\n令 \\(Z\\) 表示标准正态分布的随机变量，所以有：\n\\(\\begin{align} P_n &= P\\bigg\\{\\frac{X_1 + \\cdots + X_n - W - (3n - 400)}{\\sqrt{0.09n + 1600}} \\ge \\frac{0 - (3n - 400)}{\\sqrt{0.09n + 1600}}\\bigg\\} \\\\ & \\approx P\\bigg\\{Z \\ge \\frac{400 - 3n}{\\sqrt{0.09n + 1600}} \\bigg\\} \\end{align}\\)\n在 R 语言中，利用 qnorm(0.1, lower.tail = FALSE) 求解 \\(P\\{X \\gt x\\}\\) 的概率可得到 \\(P\\{Z \\ge 1.28\\} \\approx 0.1\\)。\n\n\n代码\nqnorm(0.1, lower.tail = FALSE)\n\n\n[1] 1.281552\n\n\n所以当汽车数量满足 \\(\\frac{400 - 3n}{\\sqrt{0.09n + 1600}} \\le 1.28\\) 时，即 \\(n \\ge 117\\) 时，桥会有 10% 的概率发生结构性损坏。\\(\\blacksquare\\)\n对二项随机变量的研究是中心极限定理最重要的应用之一。由于二项随机变量 \\(X\\) 以参数 \\((n, p)\\) 表示在试验成功概率为 \\(p\\) 时 \\(n\\) 个独立试验的成功次数。如果令\n\\(X_i = \\begin{cases} 1, \\quad & 第 i 次试验成功\\\\ 0, \\quad & 其它 \\end{cases}\\)\n则我们可以将 \\(X\\) 表示为：\n\\(X = X_1 + \\cdots + X_n\\)\n因为 \\(E[X_i] = p\\)，\\(\\textup{Var}(X_i) = np(1-p)\\)，所以根据中心极限定理，当 \\(n\\) 比较大时：\n\\(\\frac{X - np}{\\sqrt{np(1-p)}}\\) 近似于标准正态分布。\n图 6.2 以图形的方式给出了参数为 \\((n,p)\\) 的二项随机变量的概率质量函数是如何随着 \\(n\\) 的增大而变得越来越趋向于正态分布。\n\n代码\nlibrary(ggplot2)\n\nn_seq = c(10, 20, 30, 50)\np &lt;- 0.7 \ni &lt;- 1\ng_list &lt;- list()\n\nfor (n in n_seq) {\n    x &lt;- seq(0, n, 1)\n    y &lt;- dbinom(x, n, p)\n    df &lt;- data.frame(x = x, y = y, y_start = rep(0, n + 1))\n    plot &lt;- ggplot(df, aes(x = x, y = y_start, yend = y)) +  \n      geom_segment(size = 1) + \n      scale_x_continuous(breaks = seq(0, n, n / 10), limits = c(0, n)) +\n      #labs(title = paste(\"(\", n, \",\", p, \")\")) + \n      theme(axis.title.y = element_blank())\n    g_list[[i]] &lt;- plot\n    i &lt;- i + 1\n}\n\nfor (g in g_list) {\n    print(g)\n}\n\n\n\n\n\n\n\n\n\n\n\n\n(a) (10, 0.7)\n\n\n\n\n\n\n\n\n\n\n\n(b) (20, 0.7)\n\n\n\n\n\n\n\n\n\n\n\n\n\n(c) (30, 0.7)\n\n\n\n\n\n\n\n\n\n\n\n(d) (50, 0.7)\n\n\n\n\n\n\n\n图 6.2: 逐步收敛到正态分布的二项概率质量函数\n\n\n\n\n习题 6.3 某所大学的一年级学生的理想人数是 150。根据过去的经验，平均而言，收到录取通知书的学生中，只有 30% 会真正入学，因此该学校采用发放 450 份录取通知书的政策。计算该学校的一年级学生人数超过 150 的概率？\n\n\n解 6.3. 令 \\(X\\) 表示入学的学生数量，假定每个收到入学通知书的学生最终是否入学是相互独立的，因此 \\(X\\) 是一个参数为 \\((450, 0.3)\\) 的二项随机变量。因为二项分布是离散分布，而正态分布是连续分布，因此当使用正态分布来近似计算时，最好使用 \\(P\\{i - 0.5 &lt; X &lt; i + 0.5\\}\\) 来计算 \\(P\\{X=i\\}\\)（也称为连续性校正（Continuity Correction））。令 \\(Z \\thicksim \\mathcal{N}(0,1)\\)，则近似概率为：\n\\(\\begin{align} P\\{X \\gt 150.5\\} &= P\\bigg\\{\\frac{X - 450 \\cdot 0.3}{\\sqrt{450 \\cdot 0.3 \\cdot 0.7}} \\gt \\frac{150.5 - 450 \\cdot 0.3}{\\sqrt{450 \\cdot 0.3 \\cdot 0.7}} \\bigg\\} \\\\ & \\approx P\\{Z \\gt 1.59\\} \\\\ & \\approx 0.06 \\end{align}\\)\npnorm(1.59, lower.tail = FALSE)\n\n\n代码\npnorm(1.59, lower.tail = FALSE)\n\n\n[1] 0.0559174\n\n\n\n因此，在收到录取通知书的 450 名学生中，实际入学超过 150 名学生的概率只有 6%。\\(\\blacksquare\\)\n\n\n\n\n\n\n连续性校正\n\n\n\n连续性校正（Continuity Correction），有时也称为 Yates 连续性校正，是统计学中用于修正离散分布（如二项分布）和连续分布（如正态分布）之间差异的一种方法。具体来说，当我们使用连续的正态分布来近似离散的二项分布时，连续性校正可以提高近似的精确度。\n\n\n需要注意的是，对于二项分布，我们现在有两种可能的近似方式：\n\n泊松分布近似，当 \\(n\\) 很大而 \\(p\\) 很小时，使用泊松分布来逼近二项分布的效果比较好。\n正态分布近似，当 \\(np(1−p)\\) 很大时，可以证明正态分布来逼近二项分布的效果会非常好。一般而言，如果 \\(n\\) 满足 \\(np(1−p) \\ge 10\\) 时，正态分布的近似效果会非常好。\n\n\n6.3.1 样本均值的近似分布\n令 \\(X_1, ..., X_n\\) 是从均值为 \\(\\mu\\)、方差为 \\(\\sigma^2\\) 的总体中抽取的样本。可以使用中心极限定理来近似样本均值 \\(\\overline{X}\\) 的分布：\n\\(\\overline{X} = \\sum_{i=1}^{n}{\\frac{X_i}{n}}\\)\n根据中心极限定理，当 \\(n\\) 比较大时，\\(\\overline{X}\\) 近似于正态分布。根据 式 6.1，\\(\\overline{X}\\) 的期望和标准差分别为 \\(\\mu\\) 和 \\(\\frac{\\sigma}{\\sqrt{n}}\\)，因此：\n\\[\n\\frac{\\overline{X} - \\mu}{\\frac{\\sigma}{\\sqrt{n}}}\n\\]\n近似于标准正态分布。\n\n习题 6.4 一个工人总体的体重的均值为 167，标准差为 27。\n\n如果选择 36 名工人作为样本，则其体重的样本均值在 163~170 之间的近似概率是多少？\n当样本大小为 144 人时，重复计算第 1 题？\n\n\n\n解 6.4. 令 \\(Z \\thicksim \\mathcal{N}(0,1)\\)。\n\n根据中心极限定理，\\(\\overline{X}\\) 近似服从均值为 167、标准差为 \\(\\frac{27}{\\sqrt{36}} = 4.5\\) 的正态分布。因此：\n\\(\\begin{align} P\\{163 \\lt \\overline{X} \\lt 170\\} &= P\\bigg\\{\\frac{163 - 167}{4.5} \\lt \\frac{\\overline{X} - 167}{4.5} \\lt \\frac{170 - 167}{4.5} \\bigg\\} \\\\ & \\approx P\\{-0.8889 \\lt Z \\lt 0.8889\\} \\\\ &= P\\{Z \\lt 0.8889\\} - P\\{Z \\lt -0.8889\\} \\\\ &= 1 - 2 \\cdot P\\{Z \\ge 0.8889\\} \\\\ &= 0.6259432 \\end{align}\\)\n可以用如下 R 代码 1 - 2 * pnorm(0.8889, lower.tail = FALSE) 求解 \\(1 - 2 \\cdot P\\{Z \\ge 0.8889\\}\\) 的值：\n\n\n\n代码\n1 - 2 * pnorm(0.8889, lower.tail = FALSE)\n\n\n[1] 0.6259432\n\n\n\n当样本量为 144 时，近似服从均值为 167、标准差为 \\(\\frac{27}{\\sqrt{144}} = 2.25\\) 的正态分布。因此：\n\\(\\begin{align} P\\{163 \\lt \\overline{X} \\lt 170\\} &= P\\bigg\\{\\frac{163 - 167}{2.25} \\lt \\frac{\\overline{X} - 167}{2.25} \\lt \\frac{170 - 167}{2.25} \\bigg\\} \\\\ & \\approx P\\{-1.7778 \\lt Z \\lt 1.7778\\} \\\\ &= P\\{Z \\lt 1.7778\\} - P\\{Z \\lt -1.7778\\} \\\\ &= 1 - 2 \\cdot P\\{Z \\ge 1.7778\\} \\\\ &= 0.9245633 \\end{align}\\)\n\n因此，当样本大小从 36 增加到 144 时，工人体重的样本均值在 163~170 之间的近似概率从 0.6259 提升到了 0.9246。\\(\\blacksquare\\)\n\n\n习题 6.5 一位天文学家想测量从她的观测台到一颗遥远恒星的距离。然而，由于大气扰动的原因，任何测量都不会产生确切的距离 \\(d\\)。因此，天文学家决定进行一系列测量，然后使用它们的平均值作为实际距离的估计。如果天文学家认为连续测量的距离之间是独立的随机变量，其均值为 \\(d\\) 光年，标准差为 2 光年，则天文学家需要做多少次测量才能使得她所估计的距离误差在 \\(\\pm 0.5\\) 光年之内的概率至少为 95%？\n\n\n解 6.5. 如果天文学家测量了 \\(n\\) 次，则测量数据的样本均值 \\(\\overline{X}\\) 将近似服从均值为 \\(d\\)、标准差为 \\(\\frac{2}{\\sqrt{n}}\\) 的正态分布。因此，测量值位于 \\(d \\pm 0.5\\) 之间的概率为：\n\\(\\begin{align} P\\{-0.5 \\lt \\overline{X} - d \\lt 0.5\\} &= P\\bigg\\{\\frac{-0.5}{\\frac{2}{\\sqrt{n}}} \\lt \\frac{\\overline{X} - d}{\\frac{2}{\\sqrt{n}}} \\lt \\frac{0.5}{\\frac{2}{\\sqrt{n}}} \\bigg\\} \\\\ & \\approx P\\{-\\frac{\\sqrt{n}}{4} \\lt Z \\lt \\frac{\\sqrt{n}}{4}\\} \\\\ &= 1 - 2 \\cdot P\\{Z \\ge \\frac{\\sqrt{n}}{4}\\} \\end{align}\\)\n即，\\(1 - 2 \\cdot P\\{Z \\ge \\frac{\\sqrt{n}}{4}\\} \\ge 0.95\\)，也就是 \\(P\\{Z \\ge \\frac{\\sqrt{n}}{4}\\} \\le 0.025\\)。\n在 R 中，利用 qnorm(0.025, lower.tail = FALSE) 可以得到 \\(Z\\) 的最小值 1.959964，即 \\(\\frac{\\sqrt{n}}{4} \\ge 1.959964\\)。\n\n\n代码\nqnorm(0.025, lower.tail = FALSE)\n\n\n[1] 1.959964\n\n\n于是得到 \\(n \\ge 61.46334\\)，因此，天文学家至少要测量 62 次。\\(\\blacksquare\\)\n\n\n\n6.3.2 需要多大的样本？\n中心极限定理并没有明确指出：样本大小 \\(n\\) 需要多大才能使逼近的正态分布是有效的。事实上，答案取决于样本数据的总体分布。\n例如，如果总体潜在的分布是正态分布，那么无论样本量大小是多少，样本均值 \\(\\overline{X}\\) 也都将是正态分布。一般的经验是：只要样本量 \\(n\\) 至少为30，就可以确信 \\(\\overline{X}\\) 近似服从正态分布。也就是说，实际上，无论总体的潜在分布有多不服从正态分布，至少有 30 个样本的样本均值都将近似服从正态分布。在大多数情况下，正态逼近也适用于样本量小得多的场景。事实上，大小为 5 的样本通常就足以让正态逼近是有效的。当总体分布为指数分布时，图 6.3 显示了样本大小 \\(n\\) 分别为 1、5、10 时的样本均值的分布。\n\n\n\n\n\n\n图 6.3: 均值为 1 的 \\(n\\) 个指数随机变量的均值的概率密度函数",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>抽样分布</span>"
    ]
  },
  {
    "objectID": "chapter_6/6.html#sec-6_4",
    "href": "chapter_6/6.html#sec-6_4",
    "title": "6  抽样分布",
    "section": "6.4 样本方差",
    "text": "6.4 样本方差\n令 \\(X_1, ..., X_n\\) 是从均值为 \\(\\mu\\)、方差为 \\(\\sigma^2\\) 的总体中抽取的随机样本。令 \\(\\overline{X}\\) 为样本均值，然后回顾一下 小节 2.3.2 节中的 定义 2.3。\n\n定义 6.2 令 \\(S^2\\) 为样本方差，则样本方差的定义如下：\n\\[\nS^2 = \\frac{\\sum_{i=1}^{n}{(X_i - \\overline{X})^2}}{n-1}\n\\]\n\n\\(S = \\sqrt{S^2}\\) 为样本标准差。\n为了计算 \\(E[S^2]\\)，我们需要用到在 小节 2.3.2 中已经证明过的 式 2.5，即：对于任意的 \\(x_1, ..., x_n\\)，\n\\(\\sum_{i=1}^{n}{(x_i - \\overline{x})^2} = \\sum_{i=1}^{n}{x_i^2} - n\\overline{x}^2\\)，其中 \\(\\overline{x} = \\frac{\\sum_{i=1}^{n}{x_i}}{n}\\)。\n根据 定义 6.2 和 式 2.5 有：\n\\[\n(n-1)S^2 = \\sum_{i=1}^{n}{X_i^2} - n\\overline{X}^2\n\\tag{6.2}\\]\n根据 式 4.47，对于任意的随机变量 \\(X\\)，\\(E[X^2] = \\textup{Var}(X) + (E[X])^2\\)。对 式 6.2 两边求期望得到：\n\\[\n\\begin{align}\n(n-1)E[S^2] &= E\\bigg[\\sum_{i=1}^{n}{X_i^2}\\bigg] - nE[\\overline{X}^2] \\\\\n&= nE[X_1^2] - nE[\\overline{X}^2] \\\\\n&= n \\textup{Var}(X_1) + n(E[X_1])^2 - n \\textup{Var}(\\overline{X}) - n (E[\\overline{X}])^2 \\\\\n&= n \\sigma^2 + n \\mu^2 - n \\frac{\\sigma^2}{n} - n \\mu^2 \\\\\n&= (n-1)\\sigma^2 \\\\\n\\therefore E[S^2] &= \\sigma^2\n\\end{align}\n\\]\n也就是说，样本方差 \\(S^2\\) 的期望等于总体的方差 \\(\\sigma^2\\)。",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>抽样分布</span>"
    ]
  },
  {
    "objectID": "chapter_6/6.html#sec-6_5",
    "href": "chapter_6/6.html#sec-6_5",
    "title": "6  抽样分布",
    "section": "6.5 正态分布总体的抽样分布",
    "text": "6.5 正态分布总体的抽样分布\n令 \\(X_1, X_2, ..., X_n\\) 是从均值为 \\(\\mu\\)、方差为 \\(\\sigma^2\\) 的正态分布总体中抽取的样本。也就是说，\\(X_i\\) 之间是独立且同分布的，并且 \\(X_i \\thicksim \\mathcal{N}(\\mu, \\sigma^2)\\)。\n同时，令 \\(\\overline{X} = \\frac{\\sum_{i=1}^{n}{X_i}}{n}\\) 表示样本均值，令 \\(S^2 = \\frac{\\sum_{i=1}^{n}{(X_i - \\overline{X})^2}}{n-1}\\) 表示样本方差。接下来，我们就将计算 \\(\\overline{X}\\) 和 \\(S^2\\) 的分布。\n\n6.5.1 样本均值的分布\n因为独立的、正态分布的随机变量的和也是正态分布，因此，\\(\\overline{X}\\) 也是正态分布，其均值和方差分别为：\n\\(E[\\overline{X}] = \\sum_{i=1}^{n}{\\frac{E[X_i]}{n}} = \\mu\\)\n\\(\\textup{Var}(\\overline{X}) = \\frac{1}{n^2}\\sum_{i=1}^{n}{\\textup{Var}(X_i)} = \\frac{\\sigma^2}{n}\\)\n也就是说，随机样本的平均值 \\(\\overline{X}\\) 是一个均值为总体均值、但是方差为总体方差 \\(\\frac{1}{n}\\) 倍的正态分布。因此，\n\\(\\frac{\\overline{X} - \\mu}{\\frac{\\sigma}{\\sqrt{n}}}\\) 是一个标准正态分布。\n\n\n6.5.2 \\(\\overline{X}\\) 和 \\(S^2\\) 的联合分布\n在本节中，我们不仅会计算样本方差 \\(S^2\\) 的分布，还发现了关于正态分布随机样本的一个基本事实：即 \\(\\overline{X}\\) 和 \\(S^2\\) 是相互独立的随机变量，并且 \\(\\frac{(n-1)S^2}{\\sigma^2}\\) 服从自由度为 \\(n−1\\) 的卡方（chi-square）分布。\n对于 \\(x_1, ..., x_n\\)，令 \\(y_i = x_i - \\mu\\)，则 \\(\\overline{y} = \\overline{x} - \\mu\\)，根据：\n\\[\n\\sum_{i=1}^{n}{(y_i - \\overline{y})^2} = \\sum_{i=1}^{n}{y_i^2} - n\\overline{y}^2\n\\]\n有：\n\\[\n\\sum_{i=1}^{n}{(x_i - \\overline{x})^2} = \\sum_{i=1}^{n}{(x_i - \\mu)^2} - n(\\overline{x} - \\mu)^2\n\\tag{6.3}\\]\n如果 \\(X_1, ..., X_n\\) 是从均值为 \\(\\mu\\)、方差为 \\(\\sigma^2\\) 的正态分布总体中抽取的样本，根据 式 6.3 有：\n\\[\n\\frac{\\sum_{i=1}^{n}{(X_i - \\mu)^2}}{\\sigma^2} = \\frac{\\sum_{i=1}^{n}{(X_i - \\overline{X})^2}}{\\sigma^2} + \\frac{n(\\overline{X} - \\mu)^2}{\\sigma^2}\n\\]\n即，\n\\[\n\\sum_{i=1}^{n}{\\bigg(\\frac{X_i - \\mu}{\\sigma}\\bigg)^2} = \\frac{\\sum_{i=1}^{n}{(X_i - \\overline{X})^2}}{\\sigma^2} + \\bigg(\\frac{\\sqrt{n}(\\overline{X} - \\mu)}{\\sigma}\\bigg)^2\n\\tag{6.4}\\]\n因为 \\(\\frac{X_i - \\mu}{\\sigma}\\) 是相互独立的标准正态分布，所以 式 6.4 中的等式左边是一个自由度为 \\(n\\) 的卡方随机变量。又根据 小节 6.5.1 可知，\\(\\frac{\\sqrt{n}(\\overline{X} - \\mu)}{\\sigma}\\) 也是一个标准正态分布，因此，\\(\\bigg(\\frac{\\sqrt{n}(\\overline{X} - \\mu)}{\\sigma}\\bigg)^2\\) 是一个自由度为 1 的卡方随机变量。因此 式 6.4 等价于一个自由度为 \\(n\\) 的卡方随机变量 是两个随机变量的和，其中一个随机变量是自由度为 1 的卡方随机变量。同时已知两个独立卡方随机变量之和也是卡方随机变量，并且其自由度为这两个独立的卡方随机变量的自由度之和。因此，看起来，式 6.4 右边的两部分是相互独立的、并且 \\(\\frac{\\sum_{i=1}^{n}{(X_i - \\overline{X})^2}}{\\sigma^2}\\) 服从自由度为 \\(n-1\\) 的卡方分布。结果确实如此，因此我们有以下基本结论。\n\n定理 6.2 如果 \\(X_1, ..., X_n\\) 是从均值为 \\(\\mu\\)、方差为 \\(\\sigma^2\\) 的正态分布总体中抽取的样本，则\n\n\\(\\overline{X}\\) 和 \\(S^2\\) 是相互独立的随机变量\n\\(\\overline{X}\\) 是均值为 \\(\\mu\\)、方差为 \\(\\frac{\\sigma^2}{n}\\) 的正态分布随机变量\n\\(\\frac{(n-1)S^2}{\\sigma^2}\\) 是一个自由度为 \\(n-1\\) 的卡方分布随机变量\n\n\n对于一个正态分布的总体而言，定理 6.2 不但给出了 样本均值 \\(\\overline{X}\\) 和样本方差 \\(S^2\\) 的分布，而且还给出了 \\(\\overline{X}\\) 和 \\(S^2\\) 之间是相互独立的这一重要事实。事实上，\\(\\overline{X}\\) 和 \\(S^2\\) 的这种独立性是正态分布的一个特性。定理 6.2 的重要性将在后续的章节中得以明显的体现。\n\n习题 6.6 CPU 处理某类作业（job）所需的时间服从均值为 20 秒、标准差为 3 秒的正态分布。如果观察到 15 个这样的作业，则样本方差超过 12 的概率是多少？\n\n\n解 6.6. 因为样本的大小 \\(n = 15\\)，样本方差 \\(\\sigma^2 = 9\\)，因此：\n\\(P\\{S^2 &gt; 12\\} = P\\bigg\\{\\frac{14}{9} S^2 \\gt \\frac{14}{9} \\cdot 12\\bigg\\}\\)\n\n在 R 中利用 1 - pchisq(56/3, 14) 进行计算得到：\n\n\n代码\n1 - pchisq(56/3, 14)\n\n\n[1] 0.1780811\n\n\n\\(\\blacksquare\\)\n在后续章节中，定理 6.2 的如下推论将非常有用。\n\n推论 6.1 如果 \\(X_1, ..., X_n\\) 是从均值为 \\(\\mu\\) 的正态分布总体中抽取的样本。如果 \\(\\overline{X}\\) 为样本均值，\\(S\\) 为样本标准差，则：\n\\[\n\\sqrt{n} \\frac{\\overline{X} - \\mu}{S} \\thicksim t_{n-1}\n\\]\n\n也就是说，\\(\\sqrt{n} \\frac{\\overline{X} - \\mu}{S}\\) 服从自由度为 \\(n-1\\) 的 \\(t\\) 分布。\n\n证. 回想一下，自由度为 \\(n\\) 的 \\(t\\) 分布随机变量的定义为：\n\\(\\frac{Z}{\\sqrt{\\frac{\\chi_n^2}{n}}}\\)\n其中，\\(Z\\) 为标准正态分布随机变量，并且与自由度为 \\(n\\) 的卡方随机变量 \\(\\chi_n^2\\) 相互独立。根据 定理 6.2，\\(\\frac{\\sqrt{n}(\\overline{X} - \\mu)}{\\sigma}\\) 是一个标准正态分布并且与自由度为 \\(n-1\\) 的卡方分布随机变量 \\(\\frac{(n-1)S^2}{\\sigma^2}\\) 相互独立。因此，我们有：\n\\(\\frac{\\sqrt{n}(\\overline{X} - \\mu) / \\sigma}{\\sqrt{S^2 / \\sigma^2}} = \\sqrt{n} \\frac{(\\overline{X} - \\mu)}{S}\\)\n是一个自由度为 \\(n-1\\) 的 \\(t\\) 分布随机变量。\\(\\blacksquare\\)",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>抽样分布</span>"
    ]
  },
  {
    "objectID": "chapter_6/6.html#sec-6_6",
    "href": "chapter_6/6.html#sec-6_6",
    "title": "6  抽样分布",
    "section": "6.6 从有限总体中抽样",
    "text": "6.6 从有限总体中抽样\n考虑一个包含 \\(N\\) 个元素的总体，假设该总体中具有某种特征的个体占比是 \\(p\\)，也就是说有 \\(Np\\) 个个体具备该特征，而 \\(N(1-p)\\) 个个体不具备该特征。从该总体中抽取大小为 \\(n\\) 的样本，如果对于 \\(\\left(\\begin{array}{cc}  N \\\\ n  \\end{array}\\right)\\) 种抽取方式中的每一种都是等概率抽取的，则我们称抽取到的样本为 随机样本（random sample）。例如，如果总体由 \\(a\\)、\\(b\\)、\\(c\\) 三个元素构成，则选择大小为 2 的随机样本，以便\\(\\{a,b\\}\\)、\\(\\{a,c\\}\\) 和 \\(\\{b,c\\}\\) 都有同样的可能性成为样本。可以通过以下方式可以依次选择一个随机样本：让随机样本的第一个元素等可能地为总体的 \\(N\\) 个元素中的任何一个，然后让其第二个元素等可能地为总体的剩余 \\(N - 1\\) 个元素中的任何一个，依此类推。\n假设从大小为 \\(N\\) 的总体中抽取大小为 \\(n\\) 的随机样本。对于 \\(i = 1, ..., n\\)，令\n\\(X_i = \\begin{cases} 1, \\quad & 第 i 个元素具备某种特征\\\\ 0, \\quad & 其它 \\end{cases}\\)\n现在我们考虑 \\(X_i\\) 的和，也就是：\n\\(X = X_1 + X_2 + \\cdots + X_n\\)\n如果样本的第 \\(i\\) 个成员具有该特征，则 \\(X_i\\) 对总和的贡献为 1，否则贡献为 0，因此 \\(X\\) 等于样本中具有该特征的成员的数量。\n此外，样本均值\n\\(\\overline{X} = \\frac{X}{n} = \\sum_{i=1}^{n}{\\frac{X_i}{n}}\\)\n等于样本中具备该特征的成员的占比。\n现在让我们考虑 \\(X\\) 和 \\(\\overline{X}\\) 的统计量的概率分布。首先，请注意，由于总体中 \\(N\\) 个成员中的每一个都有相同的可能是样本的第 \\(i\\) 个成员，因此：\n\\(P\\{X_i = 1\\} = \\frac{Np}{N} = p\\)\n同理，\n\\(P\\{X_i = 0\\} = 1 - P\\{X_i = 1\\} = 1 - p\\)\n也就是说，每一个 \\(X_i\\) 为 1 的概率都是 \\(p\\)，为 0 的概率都是 \\(1 - p\\)。\n需要特别注意的是：随机变量 \\(X_1, X_2, ..., X_n\\) 并不是相互独立的。例如，由于第二次所选择的成员可以是总体 \\(N\\) 个成员中的任何一个，因此第二次选择的成员具有该特征的概率是 \\(\\frac{Np}{N}=p\\)。也就是说，在不知道第一次选择结果的情况下，\n\\(P\\{X_2 = 1\\} = p\\)\n但是，在给定第一次选择的成员具备该特征的条件下，第二次选择的成员也具备该特征的条件概率为：\n\\(P\\{X_2=1 | X_1=1\\} = \\frac{Np - 1}{N - 1}\\)\n于是我们可以注意到：如果第一次选择的成员具有该特征，那么第二次选择的成员可能是剩余的 \\(N-1\\) 个成员中具备该特征的 \\(Np - 1\\) 个成员中的任何一个。\n类似的，在给定第一次选择的成员没有该特征的条件下，第二次选择的成员具有该特征的概率是：\n\\(P\\{X_2=1 | X_1=0\\} = \\frac{Np}{N - 1}\\)\n因此，随机样本的第一个元素是否具有该特征会改变下一个元素具有该特征的概率。然而，当总体大小 \\(N\\) 远远超过样本大小 \\(n\\) 时，这种影响将会变得非常小。例如，如果 \\(N=1000\\)，\\(p=0.4\\)，于是有：\n\\(P\\{X_2=1 | X_1=1\\} = \\frac{Np - 1}{N - 1} = \\frac{399}{999} = 0.3994\\)\n\\(P\\{X_2=1 | X_1=0\\} = \\frac{Np}{N - 1} = \\frac{400}{999} = 0.4004\\)\n如上的条件概率都和 \\(P\\{X_2 = 1\\} = 0.4\\) 非常接近。\n事实上，可以证明，当总体规模 \\(N\\) 远大于样本大小 \\(n\\) 时，\\(X_1, X_2, ..., X_n\\) 之间近似于相互独立。现在，如果我们把每个 \\(X_i\\) 看作是一次试验的结果，如果 \\(X_i\\) 等于 1 则视为成功，否则视为失败。那么，\\(X = \\sum_{i=1}^{n}{X_i}\\) 可以看作是 \\(n\\) 次试验中成功的总次数。因此，如果 \\(X_i\\) 是相互独立的，那么 \\(X\\) 将是一个参数为 \\((n,p)\\) 的二项随机变量。换句话说，当总体规模 \\(N\\) 远大于样本规模 \\(n\\) 时，样本中具有该特征的成员数量的分布近似于参数为 \\((n,p)\\) 的二项分布。\n\n\n\n\n\n\n备注\n\n\n\n当然，\\(X\\) 是 小节 5.4 的超几何随机变量（hypergeometric random variable）。因此，之前的分析表明，当抽取的样本个数远小于总体规模时，超几何分布可以近似为二项分布。\n\n对于本文的接下来的部分，我们将假设总体规模远大于样本大小，并且我们也将 \\(X\\) 的分布视为二项分布。\n\n\n\n如 小节 5.1 中所述，对于一个二项随机变量而言，其均值和标准差分别为：\n\\(E[X] = np\\)，\\(\\textup{Var}(X)=np(1-p)\\)\n则样本中具备某特征的成员的占比 \\(\\overline{X} = \\frac{X}{n}\\) 的均值和方差分别为：\n\\(E[\\overline{X}] = \\frac{E[X]}{n} = p\\)\n\\(\\textup{Var}(\\overline{X}) = \\frac{\\textup{Var}(X)}{n^2} = \\frac{p(1-p)}{n}\\)\n\n习题 6.7 在选举中，假设有 45% 的民众会支持某个候选人。如果选民的随机样本大小为 200，请计算：\n\n样本中支持该候选人的选民数量的期望和方差？\n样本中支持该候选人的选民数量超过一半的概率？\n\n\n\n解 6.7. \n\n样本中支持该候选人的选民数量的期望和标准差为：\n\\(E[X] = np = 200 \\cdot 0.45 = 90\\)\n\\(SD(X) = \\sqrt{np(1-p)} = \\sqrt{200 \\cdot 0.45 \\cdot (1 - 0.45)} = 7.0356\\)\n因为 \\(X\\) 是一个参数为 \\((200, 0.45)\\) 的二项分布，因此：\n\\(P\\{X \\ge 101\\} = 1 - P\\{X \\le 100\\}\\)\n在 R 中，利用 1 - pbinom(100, 200, 0.45) 计算得：\\(P\\{X \\ge 101\\} = 0.06807525\\)。\n\n\n\n代码\n1 - pbinom(100, 200, 0.45)\n\n\n[1] 0.06807525\n\n\n\\(\\blacksquare\\)\n\n\n\n\n\n\n\n重要\n\n\n\n即使总体中每个元素都有两个以上的可能取值，如果总体规模远大于样本规模，那么样本数据仍然可以看作是来自总体分布的独立随机变量。\n\n\n\n习题 6.8 根据美国农业部的《世界家畜状况》报告，丹麦是人均猪肉消费量最高的国家。2013 年，居住在丹麦的人的人均猪肉消费量均值为 147 磅，标准差为 62 磅。如果随机选择 25 名丹麦人作为样本，估算这 25 名丹麦人在 2013 年的平均猪肉消费量超过 150 磅的概率？\n\n\n解 6.8. 令 \\(X_i\\) 表示样本中第 \\(i\\) 个人的猪肉消费量，\\(i=1, ..., 25\\)。则待求解的概率为：\n\\(P\\bigg\\{\\frac{X_1 + \\cdots + X_{25} }{25} \\gt 150 \\bigg\\} = P\\{\\overline{X} \\gt 150\\}\\)\n其中，\\(\\overline{X}\\) 为 25 个人的样本均值。我们可以将 \\(X_i\\) 看作是均值为 147、标准差为 62 的相互独立的随机变量。根据中心极限定理有：\\(\\overline{X}\\) 是均值为 147、标准差为 \\(\\frac{62}{5}\\) 的正态分布。用 \\(Z\\) 表示标准正态分布，则有：\n\\(P\\{\\overline{X} \\gt 150\\} = P\\bigg\\{\\frac{\\overline{X} - 147}{12.4} \\gt \\frac{150 - 147}{12.4} \\bigg\\}\\)\n\\(P\\{\\overline{X} \\gt 150\\} \\approx P\\bigg\\{Z \\gt \\frac{150 - 147}{12.4}\\bigg\\} = P\\{Z \\gt \\frac{3}{12.4}\\}\\)\n在 R 中，使用 pnorm(3/12.4, lower.tail = FALSE) 计算得到：\n\\(P\\{\\overline{X} \\gt 150\\} = 0.4044151\\)\n\n\n代码\npnorm(3/12.4, lower.tail = FALSE)\n\n\n[1] 0.4044151\n\n\n\\(\\blacksquare\\)",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>抽样分布</span>"
    ]
  },
  {
    "objectID": "chapter_6/6.html#习题",
    "href": "chapter_6/6.html#习题",
    "title": "6  抽样分布",
    "section": "习题",
    "text": "习题\n\n假设 \\(X_1, X_2, X_3\\) 是独立同分布的随机变量，其概率质量函数为：\n\\(P\\{X_i = 0\\} = 0.2\\)，\\(P\\{X_i = 1\\} = 0.3\\)，\\(P\\{X_i = 3\\} = 0.5\\)\n\n计算 \\(\\overline{X}_2 = \\frac{X_1 + X_2}{2}\\) 的概率质量函数？\n计算 \\(E[\\overline{X}_2]\\) 和 \\(\\textup{Var}(\\overline{X}_2)\\)？\n计算 \\(\\overline{X}_3 = \\frac{X_1 + X_2 + X_3}{3}\\) 的概率质量函数？\n计算 \\(E[\\overline{X}_3]\\) 和 \\(\\textup{Var}(\\overline{X}_3)\\)？\n\n如果抛 10 个骰子，计算获得的点数（[10,60]）位于 \\([30,40]\\) 的近似概率？\n计算 16 个独立、同 \\((0,1)\\) 均匀分布的随机变量的和超过 10 的概率？\n在轮盘游戏中，轮盘有 38 个槽，编号分别为 0、00、1~36。如果你在指定的数字槽上押 1 点，当球落在这个数字槽上时你会赢 35 点，而当球没有落在这个数字槽上时你就会输 1 点。假设球会以相同的概率落在轮盘上的任何一个数字槽中，那么如果你不断的玩这个游戏，计算如下的概率：\n\n34 次投注后，你赢了\n1000 次投注后，你赢了\n100000 次投注后，你赢了\n\n一个公路部门有足够的盐来处理 80 英寸的降雪。假设每天的降雪的均值为 1.5 英寸、标准差为 3 英寸。\n\n估算现有的盐在未来 50 天内是否足够？\n你在解决第（1）步时做了什么假设？\n你认为这个假设是合理的吗？\n\n将 50 个数字四舍五入到最接近的整数后求和。如果四舍五入的误差是 -0.5 到 0.5 之间的均匀分布，估算得到的总和与实际总和相差超过 3 的概率。\n一个六面的骰子，每个面出现的概率相等，反复抛这个骰子直到获得的总点数超过 400，估算总共抛的此处超过 140 次的概率？\n某种电池的寿命是一个均值为 5 周、标准差为 1.5 周的随机变量。电池失效后会立即更换一块新的电池。估算一年内需要的电池数量大于或等于 13 的概率？\n某种电气零件的寿命是一个均值为 100 小时、标准差为 20 小时的随机变量。如果测试 16 个零件，计算样本均值：\n\n小于 104 小时的概率？\n在 98 到 104 小时之间的概率？\n\n某烟草公司声称其香烟中的尼古丁含量是一个均值为 2.2 毫克、标准差为 0.3 毫克的随机变量。但是，随机选取的 100 个香烟样本的均值是 3.1 毫克。如果该公司的声称是真实的，那么样本均值大于或等于 3.1 毫克的概率是多少？\n某种灯泡的寿命（小时）是一个均值为 500、标准差为 50 的随机变量。当样本大小为 \\(n\\) 时，估算样本均值超过 525 小时的概率？\n\nn = 4\nn = 16\nn = 36\nn = 64\n\n一位老师根据经验了解到学生考试成绩的均值是 77、标准差是 15。如果该老师要教两个独立的班级，一个班级有 25 名学生，另一个有 64 名学生。\n\n估算 25 名学生的班级的平均分在 72 到 82 之间的概率？\n估算 64 名学生的班级的平均分在 72 到 82 之间的概率？\n25 名学生的班级的平均测试分数高于 64 名学生的班级的概率是多少？\n假设 25 名学生的班级的平均分是 83分，64 名学生的班级的平均分是 63 分，哪个班级更可能获得 83 分的平均分？\n\n如果 \\(X\\) 是参数为 \\((150,0.6)\\) 的二项分布，计算 \\(P\\{X \\ge 80\\}\\) 的确切值，并和如下的两种方式得到的概率进行对比：\n\n在近似正态分布中使用连续性校正\n在近似正态分布中不使用连续性校正\n\n1, 2, 3, 4 四支队伍中的每支队伍都将于其它的每一支队伍进行 10 次比赛。第 \\(i\\) 队和第 \\(j\\) 对比赛时，\\(i\\) 对获胜的概率是 \\(P_{i,j}\\)，\\(j\\) 对获胜的概率是 \\(1 - P_{i,j}\\)。如果： \\(P_{1,2} = 0.6\\) \\(P_{3,1} = 0.7\\) \\(P_{2,3} = 0.6\\) \\(P_{4,2} = 0.75\\) \\(P_{3,4} = 0.5\\) \\(P_{4,1} = 0.5\\)\n\n估算 1 队在最近 20 场比赛中获胜 10 场的概率。\n假设我们想近似计算 2 队赢得比赛的总数大于或等于 1 队的概率。为此，让 \\(X\\) 表示 2 队在与 1 队比赛时获胜的总数，让 \\(Y\\) 表示 2 队在与 3 队、4 队比赛时获胜的总数，让 \\(Z\\) 表示 1 队在于 3 队、4 队比赛时获胜的总数。\n\n\\(X\\)、\\(Y\\)、\\(Z\\) 是独立的吗？\n用随机变量 \\(X\\)、\\(Y\\)、\\(Z\\) 来表示 2 队赢得比赛的总数大于或等于 1 队这一事件\n计算 2 队赢得比赛的总数大于或等于 1 队的概率\n\n\n一个篮球队每个赛季会打 60 场比赛。其中 32 场比赛是对阵甲级球队，28 场比赛是对阵乙级球队，并且所有比赛的结果都是独立的。每场比赛中，该队战 胜A 级对手的概率为 0.5，战胜 B 级对手的概率为 0.7。令 \\(X\\) 表示本赛季中该队的总胜利次数。\n\n\\(X\\) 是否是一个二项随机变量？\n令 \\(X_A\\) 表示球队在和 A 级球队比赛时的获胜次数，\\(X_B\\) 表示球队在和 B 级球队比赛时的获胜次数。\\(X_A\\) 和 \\(X_B\\) 的分布是什么？\n\\(X\\)，\\(X_A\\)，\\(X_B\\) 之间的关系是什么？\n估算球队在整个赛季中赢得至少 40 场比赛的概率？\n\n根据中心极限定理，当 \\(\\lambda\\) 很大时，均值为 \\(\\lambda\\) 的泊松分布将近似地具有均值和方差都等于 \\(\\lambda\\) 的正态分布。如果 \\(X\\) 是均值为 100 的泊松随机变量，计算 \\(X\\) 小于或等于 116 的确切概率，并和如下的两种方式得到的概率进行对比：在近似正态分布中使用连续性校正；在近似正态分布中不使用连续性校正。泊松分布向正态分布的收敛参见 图 6.4。\n\n\n\n\n\n\n\n\n\n\n\n(a) Poisson(5)\n\n\n\n\n\n\n\n\n\n\n\n(b) Poisson(10)\n\n\n\n\n\n\n\n\n\n\n\n\n\n(c) Poisson(20)\n\n\n\n\n\n\n\n图 6.4: 泊松分布的概率质量函数\n\n\n\n\\(X\\) 是一个参数为 \\((100, 0.1)\\) 的二项随机变量，计算 \\(P\\{X \\leq 10\\}\\)。将此分别与泊松逼近和正态逼近的结果进行比较（在使用正态逼近时，为了进行连续性校正，待求解的概率为 \\(P\\{X &lt; 10.5\\}\\)）。\n恒温器停止工作时的温度是服从方差为 \\(\\sigma^2\\) 的正态分布。如果测试恒温器五次，计算：\n\n\\(P\\{\\frac{S^2}{\\sigma^2} &lt; 1.8 \\}\\)\n\\(P\\{0.85 \\le \\frac{S^2}{\\sigma^2} \\le 1.15\\}\\)\n\n其中 \\(S^2\\) 是五个测试数据值的样本方差。\n在习题 18 中，样本的大小需要多大才能确保 \\(P\\{\\frac{S^2}{\\sigma^2} &lt; 1.8 \\}\\) 至少为 0.95？\n考虑两个独立的样本：第一个样本来自方差为 4 的正态分布，其大小为 10；第二个样本来自方差为 2 的正态分布，其大小为 5。计算第二个样本的方差超过第一个样本的方差的概率（提示：考虑使用 \\(F-分布\\)）。\n12% 的人是左撇子。在一个 100 人的样本中，有 10 到 14 个左撇子的概率是多少？\n某城市有 52% 的居民赞成在高中教授进化论。在一个大小为 \\(n\\) 的随机样本中，至少 50% 的人赞成教授进化论的概率是多少？\n\n\\(n = 10\\)\n\\(n = 100\\)\n\\(n = 1000\\)\n\\(n = 10000\\)\n\n下表按照性别给出了某城市居民在健康习惯方面的相关数据。假设随机选择一个 300 名男性构成的样本，估算以下概率：\n\n至少 150 人很少吃早餐\n少于 100 人吸烟\n\n\n\n\n\n\n\n\n\n\n\n\n每晚睡眠不足 6 小时 (%)\n吸烟 (%)\n很少吃早餐 (%)\n体重超标 20% 以上 (%)\n\n\n\n\n男性\n22.7\n28.4\n45.4\n29.6\n\n\n女性\n21.4\n22.0\n42.0\n25.6\n\n\n\n\n数据来源：美国国家健康统计，健康促进和疾病预防中心。\n\n（使用习题 23 中的表格）假设随机选择一个 300 名女性构成的样本。估算以下概率：\n\n其中至少 60 人超重 20% 或以上\n其中不到 50 人每晚睡眠 6 小时或更少\n\n（使用习题 23 中的表格）假设随机选择一个 300 名男性构成的样本和一个 300 名女性构成的样本。估算很少吃早餐的女性人数大于男性人数的概率。\n下表使用数据来说明了青少年全职工人中、不同性别的年收入在不同薪资分组中的占比。假设选择 1000 名男性构成的样本和 1000 名女性构成的样本。使用表格来估算以下概率：\n\n至少一半的女性收入低于 20,000 美元\n超过一半的男性收入超过 20,000 美元\n超过一半的女性和超过一半的男性收入低于 20,000 美元\n不超过 250 名女性收入至少 25,000 美元\n至少 200 名男性收入超过 50,000 美元\n收入在 20,000 到 24,999 美元之间的女性比男性多\n\n\n\n\n收入范围（单位：$）\n女性百分比 (%)\n男性百分比 (%)\n\n\n\n\n4999 或更少\n2.8\n1.8\n\n\n5000 到 9999\n10.4\n4.7\n\n\n10,000 到 19,999\n41.0\n23.1\n\n\n20,000 到 24,999\n16.5\n13.4\n\n\n25,000 到 49,999\n26.3\n42.1\n\n\n50,000 及以上\n3.0\n14.9\n\n\n\n\n来源：美国商务部，人口普查局。\n\n如今，约 10.5% 的劳动者会加入工会。如果随机选择五名工人，他们加入工会的概率是多少？将你的答案与 1983 年 20.1% 的劳动这加入了工会这一数据进行比较。\n旧金山所有学生在最近的数学学术能力测试中的样本均值和样本标准差分别是 517 和 120。估算 144 名学生构成的样本的平均得分超过以下值的概率：\n\n507\n517\n537\n550\n\n化学工程专业的刚毕业的本科毕业生的平均工资为 53,600 美元，标准差为 3200 美元。估算 12 名刚毕业的化学工程师的平均工资超过 55,000 美元的概率。\n某个元器件对电气系统的运行至关重要，一旦该元器件出现故障则必须立即更换。如果这种元件的平均寿命为 100 小时，并且其标准差为 30 小时，那么必须准备多少个该元器件，才能保障在接下来的 2000 小时内，系统持续运行的可能性至少为 0.95？(提示：令 \\(X_i\\) 表示第 \\(i\\) 个元器件的寿命)",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>抽样分布</span>"
    ]
  },
  {
    "objectID": "chapter_7/7.html",
    "href": "chapter_7/7.html",
    "title": "7  参数估计",
    "section": "",
    "text": "7.1 引言\n令 \\(X_1, ..., X_n\\) 是来自分布为 \\(F_\\theta\\) 的随机样本，这个分布由一个未知参数向量 \\(\\theta\\) 来指定。例如，样本可能来自一个平均值未知的泊松分布；或者可能来自一个均值和方差都未知的正态分布。在概率论中，通常假设分布的所有参数都是已知的，而在统计学中，情况则恰恰相反。统计学的核心问题之一就是使用观测数据来推断未知参数。",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>参数估计</span>"
    ]
  },
  {
    "objectID": "chapter_7/7.html#sec-7_1",
    "href": "chapter_7/7.html#sec-7_1",
    "title": "7  参数估计",
    "section": "",
    "text": "在 小节 7.2 中，我们会介绍 最大似然方法（maximum likelihood）来估计未知参数。因为 最大似然估计 指定了一个单一值作为 \\(\\theta\\) 的估计，因此我们称其为 点估计（point estimates）。\n在 小节 7.3 中，我们会考虑 区间估计（interval estimates）的相关问题。对于区间估计而言，我们不会指定某个值作为 \\(\\theta\\) 的估计，而是会指定一个区间来估计 \\(\\theta\\)。此外，我们还考虑了可以对这样的区间估计报以多少 置信度（confidence）的问题。在该节中，我们会展示如何计算一个均值未知、但给定方差的正态分布的均值的区间估计。接下来，我们还会讨论区间估计中的一系列问题。在 小节 7.3.1 中，我们会讨论方差未知的正态分布的均值的区间估计。在 小节 7.3.2 中，我们会讨论正态分布的方差的区间估计。\n在 小节 7.4 中，我们会讨论两个正态分布的均值差的区间估计，我们会分两种情况进行讨论：\n\n这两个正态分布的方差是已知的；\n这两个正态分布的方差未知，但是我们会假设他们的方差是相同的。\n\n在 小节 7.5 和 小节 7.6 中，我们会分别讨论伯努利随机变量和指数随机变量的均值的区间估计。\n在 小节 7.7 中，我们会重新回到计算未知参数的点估计的一般性问题上来，并展示如何通过 均方误差（mean square error）来评估估计量。我们还会讨论估计量的偏差，并会探讨偏差与均方误差之间的关系。\n在 小节 7.8 中，我们会考虑在有先验信息可用时确定未知参数估计值的问题，这就是 贝叶斯（bayesian）方法。贝叶斯方法假设在观察数据之前，决策者总是可以获得关于 \\(\\theta\\) 的信息，并且该信息可以用 \\(\\theta\\) 的概率分布来表示。我们还会讨论如何使用估计量和参数 \\(\\theta\\) 之间的均方误差来计算 贝叶斯估计量（Bayes estimator）。\n\n\n\n\n\n\n\n估计量与估计值\n\n\n\n在下一节会讲到：任何用于估计未知参数 \\(\\theta\\) 的值的统计量都称为 \\(\\theta\\) 的 估计量（estimator）。估计量的观测值称为 估计值（estimate）。",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>参数估计</span>"
    ]
  },
  {
    "objectID": "chapter_7/7.html#sec-7_2",
    "href": "chapter_7/7.html#sec-7_2",
    "title": "7  参数估计",
    "section": "7.2 最大似然估计",
    "text": "7.2 最大似然估计\n任何用于估计未知参数 \\(\\theta\\) 的值的统计量都称为 \\(\\theta\\) 的 估计量（estimator）。估计量的观测值称为 估计值（estimate）。例如，一般而言，对于正态分布的均值的估计量是基于样本 \\(X_1, ..., X_n\\) 的样本均值 \\(\\overline{X} = \\frac{\\sum_i{X_i}}{n}\\)。如果样本的大小为 3，并且样本数据为 \\(X_1=2\\)，\\(X_2=3\\)，\\(X_3=4\\)，那么根据估计量 \\(\\overline{X}\\) 则得到总体均值的估计值 3。\n假设随机变量 \\(X_1, \\ldots, X_n\\) 的联合分布是已知的，只是有一个未知参数 \\(\\theta\\)。我们关注的问题是使用观察到的值来估计 \\(\\theta\\)。例如， \\(X_i\\) 可能是独立的指数随机变量，每个变量具有相同的未知均值 \\(\\theta\\)。在这种情况下，随机变量的联合密度函数将由以下公式给出：\n假设随机变量 \\(X_1, ..., X_n\\) 的联合分布是已知的，只是有一个未知的参数 \\(\\theta\\)。我们关注的问题是：使用观察到的数据来估计 \\(\\theta\\)。例如，\\(X_i\\) 可能是相互独立的指数随机变量，每个变量都具有相同的未知均值 \\(\\theta\\)。在这种情况下，随机变量的联合密度函数为：\n\\[\n\\begin{align}\nf(x_1, x_2, ..., x_n) &= f_{X_1}(x_1) f_{X_2}(x_2) \\cdots f_{X_n}(x_n) \\\\\n&= \\frac{1}{\\theta}e^{-\\frac{x_1}{\\theta}} \\frac{1}{\\theta}e^{-\\frac{x_2}{\\theta}} \\cdots \\frac{1}{\\theta}e^{-\\frac{x_n}{\\theta}} \\\\\n&= \\frac{1}{\\theta^n}e^{-{\\frac{\\sum_{i=1}^{n}{x_i}}{\\theta}}}\n\\end{align}\n\\]\n我们的目标就是根据观测数据 \\(x_1, x_2, ..., x_n\\) 来估计 \\(\\theta\\)。\n在统计学中，一种被广泛使用的、特殊类型的估计量就是最大似然估计量（maximum likelihood estimator）。最大似然估计的推导过程如下。\n\n令 \\(f(x_1, ..., x_n | \\theta)\\) 表示随机变量 \\(X_1, X_2, ..., X_n\\) 的联合概率质量函数（当它们是离散随机变量时）或者联合概率密度函数（当它们是连续随机变量时）。因为我们假定 \\(\\theta\\) 未知，所以我们也将 \\(f\\) 写成 \\(\\theta\\) 的函数。\n现在，\\(f(x_1, ..., x_n | \\theta)\\) 表示当参数 \\(\\theta\\) 是其真实值时，观测值为 \\(x_1, x_2, ..., x_n\\) 的可能性（likelihood）。因此，\\(\\theta\\) 的合理的估计值应该是使得观测值的可能性最大的那个 \\(\\theta\\) 值。\n换句话说，最大似然估计 \\(\\hat{\\theta}\\) 就是令 \\(f(x_1, ..., x_n | \\theta)\\) 取得最大值的 \\(\\theta\\) 值，其中 \\(x_1, ..., x_n\\) 表示观侧数据。而函数 \\(f(x_1, ..., x_n | \\theta)\\) 也被称为关于 \\(\\theta\\) 的似然函数。\n为了确定 \\(f(x_1, ..., x_n | \\theta)\\) 最大时的 \\(\\theta\\) 值，通常会利用以下的事实：函数 \\(f(x_1, ..., x_n | \\theta)\\) 和函数 \\(\\textup{log}[f(x_1, ..., x_n | \\theta)]\\) 取得最大值时的 \\(\\theta\\) 值是相同的。因此，我们也可以通过最大化 \\(\\textup{log}[f(x_1, ..., x_n | \\theta)]\\) 得到 \\(\\hat{\\theta}\\)。\n\n\n习题 7.1 伯努利分布参数的最大似然估计。假设执行 \\(n\\) 个独立试验，每个试验的成功概率均为 \\(p\\)。则 \\(p\\) 的最大似然估计是多少？\n\n\n解 7.1. 观察数据由 \\(X_1, ..., X_n\\) 的值构成，其中 \\(X_i = \\begin{cases} 1, \\quad & 第 i 次试验成功\\\\ 0, \\quad & 其它 \\end{cases}\\)\n令 \\(P\\{X_i = 1\\} = p = 1- P\\{X_i = 0\\}\\)，该等式可以简化为：\n\\(P\\{X_i = x\\} = p^x(1-p)^{1-x}, \\quad x = 0,1\\)\n因此试验之间相互独立，因此观察到的数据的可能性（likelihook，指的就是联合概率质量函数）为：\n\\(\\begin{align} f(x_1, ..., x_n | p) &= P\\{X_1 = x_1, ..., X_n = x_n | p\\} \\\\ &= p^{x_1}(1-p)^{1-x_1} \\cdots p^{x_n}(1-p)^{1-x_n} \\\\ &= p^{\\sum_{i=1}^{n}{x_i}} (1-p)^{n - \\sum_{i=1}^{n}{x_i}}, \\quad x_i = 0,1, \\quad i = 1,...,n \\end{align}\\)\n为了确定是的 \\(f\\) 取得最大值时 \\(p\\) 的值，首先对 \\(f\\) 取对数： \\(\\textup{log}f(x_1, ..., x_n | p) = \\bigg(\\sum_{i=1}^{n}{x_i}\\bigg)\\textup{log}\\ p +\\bigg (n - \\sum_{i=1}^{n}{x_i}\\bigg)\\textup{log}(1 - p)\\)\n求导得到：\n\\(\\frac{d}{dp} \\textup{log}\\ f(x_1, ..., x_n | p) = \\frac{\\sum_{i=1}^{n}{x_i}}{p} -\\frac{n - \\sum_{i=1}^{n}{x_i}}{1-p}\\)\n令 \\(\\frac{d}{dp} \\textup{log}\\ f(x_1, ..., x_n | p) = 0\\) 并计算得到最大似然估计 \\(\\hat{p}\\) 满足：\n\\(\\frac{\\sum_{i=1}^{n}{x_i}}{\\hat{p}} -\\frac{n - \\sum_{i=1}^{n}{x_i}}{1-\\hat{p}}\\)\n即，\\(\\hat{p} = \\frac{\\sum_{i=1}^{n}{x_i}}{n}\\)\n因此，均值未知的伯努利分布的最大似然估计量为：\n\\(d(X_1, ..., X_n) = \\frac{\\sum_{i=1}^{n}{X_i}}{n}\\)\n因为 \\(\\sum_{i=1}^{n}{X_i}\\) 就是试验成功的次数，所以 \\(p\\) 的最大似然估计就等于观察到的实验中成功次数的占比。举个例子，假设某制造商生产的 每个 RAM（运行内存）芯片的合格率是相互独立的，并且合格率为 \\(p\\)。如果在 1000 个测试样本中，有 921 个合格品，那么 \\(p\\) 的最大似然估计是 0.921。 \\(\\blacksquare\\)\n\n\n习题 7.2 两位编辑审验相同的一本稿件，如果第一位编辑发现 \\(n_1\\) 个错误，第二位编辑发现 \\(n_2\\) 个错误，其中有 \\(n_{1,2}\\) 个错误两位编辑都发现了，估计这本稿件中的错误总数 \\(N\\)。\n\n\n解 7.2. 在估计 \\(N\\) 之前，需要对潜在的概率模型做一些假设。假设不同编辑的审验结果之间是独立的，并且稿件中的每个错误被第 \\(i\\) 位编辑独立发现的概率为 \\(p_i,\\ i = 1,2\\)。\n为了估计 \\(N\\)，我们将从推导 \\(p_1\\) 的估计量开始。为此，请注意，第一位编辑将会以 \\(p_1\\) 的概率独立发现第二位编辑发现的 \\(n_2\\) 个错误中的每一个错误。因为第一位编辑发现了\\(n_2\\) 个错误中的 \\(n_{1,2}\\) 个错误，因此，\\(p_1\\) 的合理估计为：\n\\(\\hat{p}_1 = \\frac{n_{1,2}}{n_2}\\)\n但是，对于稿件中的 \\(N\\) 个错误，因为第一位编辑发现了其中的 \\(n_1\\) 个错误，因此假设 \\(p_1\\) 近似的等于 \\(\\frac{n_1}{N}\\) 也是合理的。因此 \\(\\hat{p}_1 \\approx \\frac{n_1}{N}\\)，即 \\(\\frac{n_{1,2}}{n_2}\\approx \\frac{n_1}{N}\\)，也就是说：\n\\(N \\approx \\frac{n_1 n_2}{n_{1,2}}\\)\n因为如上的估计对于 \\(n_1\\) 和 \\(n_2\\) 是对称的，所以无论哪个编辑是第一位编辑，最终的结果都是相同的。\n当两个研究小组宣布他们已经破译了人类遗传密码序列时，如上估计过程的一个有趣的案例发生了。作为两个研究小组工作的一部分，他们都估计人类基因组由大约 33000 个基因组成。因为这个数字是由两个小组独立得出的，许多科学家认为这个数字是可信的。但是，大多数科学家对这个相对较少的基因数量感到非常惊讶；相比之下，它只是果蝇基因数量的两倍左右。然而，对两个小组的研究结果进行更为仔细的检查表明，这两个小组均发现的基因数量大约为 17000 个（也就是说，有 17000 个相同的基因被这两个小组发现了）。因此，根据我们之前的估计量，我们会估计基因的实际数量不是 33000个，而是 \\(\\frac{n_1 n_2}{n_{1,2}} = \\frac{33000 \\times 33000}{17000} \\approx 64000\\) 个。\n对于声称发现的基因中的某些基因是否真的存在会有一些争议，因此，64000个基因应该被视为基因实际数量的上限。\n当有 \\(m(m \\gt 2)\\) 个编辑时，则上述采用的两位编辑的估计方法将不再适用。\n当 \\(m \\gt 2\\) 时，对于第 \\(i\\) 为编辑，我们令 \\(\\hat{p}_i\\) 为由至少一位其他编辑 \\(j(j \\ne i)\\) 发现的错误中 \\(i\\) 也发现的错误的占比，然后让 \\(\\hat{p}_i\\) 等于 \\(\\frac{n_i}{N}\\)，那么 \\(N\\) 的估计值，即 \\(\\frac{n_i}{\\hat{p}_i}\\)，将因不同的 \\(i\\) 而异。\n此外，使用这种方法时，即使第 \\(i\\) 位编辑找到的错误比第 \\(j\\) 位编辑的少，我们也有可能得到 \\(\\hat{p}_i &gt; \\hat{p}_j\\)。例如，对于 \\(m = 3\\)，假设第 1 位编辑和第 2 位编辑找到了完全相同的 10 个错误，而第 3 位编辑找到了 20 个错误且只有 1 个与其他编辑找到的错误是相同的。因为第 1 位编辑和第 2 位编辑都找到了 29 个错误中的 10 个（第 2 位编辑和第 3 位编辑总共找到了 29 个不同的错误），所以，\\(\\hat{p}_i = \\frac{10}{29}\\)，\\(i = 1, 2\\)。另一方面，因为第 3 位编辑仅找到了其他编辑找到的 10 个错误（第 1 位编辑和第 2 为编辑找到的 10 个错误是相同的）中的 1 个，因此 \\(\\hat{p}_3 = \\frac{1}{10}\\)。因此，尽管第 3 位编辑找到的错误是 第 1 位编辑的两倍，但 \\(p_3\\) 的估计值小于 \\(p_1\\) 的估计值。\n为了获得更合理的估计，我们可以将上述 \\(\\hat{p}_i,\\ i=1, ..., m\\) 值作为 \\(p_i\\) 的初步估计值。现在，令 \\(n_f\\) 为至少由一位编辑发现的错误的数量。因为至少一位编辑发现的错误的占比为 \\(\\frac{n_f}{N}\\)，因此 \\(\\frac{n_f}{N}\\) 近似等于某个错误至少被一位编辑发现的概率 \\(1 - \\Pi_{i=1}^{m}{(1 - p_i)}\\)。因此，有：\n\\(\\frac{n_f}{N} \\approx 1 - \\Pi_{i=1}^{m}{(1-p_i)}\\)\n假设 \\(N \\approx \\hat{N}\\)，有：\n\\[\n\\hat{N} = \\frac{n_f}{1 - \\Pi_{i=1}^{m}{(1-\\hat{p_i})}}\n\\tag{7.1}\\]\n有了 \\(N\\) 的估计，我们可以通过 \\(N\\) 的估计来重新估计 \\(p_i\\)：\n\\[\n\\hat{p_i} = \\frac{n_i}{\\hat{N}}, \\quad i = 1, ..., m\n\\tag{7.2}\\]\n然后，我们可以根据新的 \\(\\hat{p_i}\\) 并利用 式 7.1 重新估计 \\(N\\)。注意，估计的过程不应该就此停止，每当我们获得了 \\(N\\) 的新估计 \\(\\hat{N}\\) 时，我们可以利用 式 7.2 获得 \\(p_i\\) 的新估计，然后可以使用 \\(p_i\\) 的新估计来获得 \\(N\\) 的新估计，依此类推。） \\(\\blacksquare\\)\n\n\n习题 7.3 泊松分布参数的最大似然估计。假设 \\(X_1, ..., X_n\\) 是独立的泊松随机变量，其均值为 \\(\\lambda\\)。确定 \\(\\lambda\\) 的最大似然估计量。\n\n\n解 7.3. \\(\\lambda\\) 的似然函数为：\n\\(\\begin{align} f(x_1, ..., x_n | \\lambda) &= \\frac{\\lambda^{x_1}e^{-\\lambda}}{x_1!} \\cdots \\frac{\\lambda^{x_n}e^{-\\lambda}}{x_n!} \\\\ &= \\frac{\\lambda^{\\sum_{i=1}^{n}{x_i}}e^{-n\\lambda}}{x_1! \\cdots x_n!} \\end{align}\\)\n对上式取对数有：\n\\(\\textup{log}\\ f(x_1, ..., x_n | \\lambda) = -n\\lambda + \\sum_{i=1}^{n}{x_i} \\textup{log}\\ \\lambda - \\textup{log}\\ c\\)\n其中，\\(c = \\Pi_{i=1}^{n}{x_i!}\\)，对上式求导有：\n\\(\\frac{d}{d\\lambda} \\textup{log}\\ f(x_1, ..., x_n | \\lambda) = -n + \\frac{1}{\\lambda} \\sum_{i=1}^{n}{x_i}\\)\n令上式为 0，得到最大似然估计 \\(\\hat{\\lambda} = \\frac{\\sum_{i=1}^{n}{x_i}}{n}\\)\n因此，最大似然估计量为：\n\\(d(X_1, ..., X_n) = \\frac{\\sum_{i=1}^{n}{x_i}}{n}\\)\n例如，假设任何一天进入某个零售店的人数是一个泊松随机变量，其均值 \\(\\lambda\\) 未知，我们希望估计 \\(\\lambda\\) 的值。如果 20 天后，共有857 人进入该机构，那么 \\(\\lambda\\) 的最大似然估计为 \\(\\frac{857}{20}=42.85\\)。也就是说，平均而言，我们估计在给定的一天将有 42.85 名顾客进入该零售店。\\(\\blacksquare\\)\n\n\n习题 7.4 1998 年加州伯克利市在 10 个随机选择的非雨天发生的交通事故数量如下：\n4,0,6,5,2,1,2,0,4,3\n使用这些数据来估计非雨天最多发生 2 起交通事故的天数占比。\n\n\n解 7.4. 由于有大量司机，并且每个司机在某一天发生事故的可能性很小，因此假设每天的交通事故数量是泊松随机变量似乎是合理的。因为 \\(\\overline{X} = \\frac{1}{10} \\sum_{i=1}^{10}{X_i} = 2.7\\)，因此，泊松分布的均值的最大似然估计值为 2.7。最多发生 2 起事故的非雨天的长期占比等于 \\(P\\{X \\le 2\\}\\)，其中 \\(X\\) 表示一天中的事故数。因此待计算的估计值为：\n\\(\\begin{align} P\\{X \\le 2\\} &= P\\{X = 0\\} + P\\{X = 1\\} + P\\{X = 2\\} \\\\ &= e^{-2.7}(1 + 2.7 + \\frac{{2.7}^2}{2}) \\\\ &= 0.4936 \\end{align}\\)\n也就是说，我们估计有不到一半的非雨天最多发生 2 起事故。\\(\\blacksquare\\)\n\n\n习题 7.5 正态分布总体的最大似然估计。假设 \\(X_1, ..., X_n\\) 是相互独立的正态分布随机变量，其均值 \\(\\mu\\) 和标准差 \\(\\sigma\\) 均未知。计算其均值和标准差的最大似然估计。\n\n\n解 7.5. 其联合概率密度函数为：\n\\(\\begin{align} f(x_1, ..., x_n | \\mu, \\sigma) &= \\Pi_{i=1}^{n}{\\frac{1}{\\sqrt{2\\pi}\\sigma}e^{\\frac{-(x_i - \\mu)^2}{2\\sigma^2}}} \\\\ &= (\\frac{1}{2\\pi})^{\\frac{n}{2}} \\frac{1}{\\sigma^n} e^{\\frac{-\\sum_{i=1}^{n}{(x_i - \\mu)^2}}{2\\sigma^2}} \\end{align}\\)\n取对数有：\n\\(\\textup{log}\\ f(x_1, ..., x_n | \\mu, \\sigma) = - \\frac{n}{2} \\textup{log}\\ (2\\pi) - n \\textup{log}\\ \\sigma - \\frac{\\sum_{i=1}^{n}{(x_i - \\mu)^2}}{2 \\sigma^2}\\)\n为了找到 \\(\\mu\\) 和 \\(\\sigma\\) 以使上述值最大化，我们计算如下的偏导数：\n\\(\\frac{\\partial}{\\partial \\mu} \\textup{log}\\ f(x_1, ..., x_n | \\mu, \\sigma) = \\frac{\\sum_{i=1}^{n}{(x_i - \\mu)}}{\\sigma^2}\\)\n\\(\\frac{\\partial}{\\partial \\sigma} \\textup{log}\\ f(x_1, ..., x_n | \\mu, \\sigma) = - \\frac{n}{\\sigma} + \\frac{\\sum_{i=1}^{n}{(x_i - \\mu)^2}}{\\sigma^3}\\)\n令如上的偏导数等于 0，有：\n\\(\\hat{\\mu} = \\frac{\\sum_{i=1}^{n}{x_i}}{n}\\)\n\\(\\hat{\\sigma} = \\bigg[\\frac{\\sum_{i=1}^{n}{(x_i - \\hat{\\mu})^2}}{n}\\bigg]^{\\frac{1}{2}}\\)\n因此，正态分布的均值和标准差的最大似然估计量分别为：\n\\[\n\\begin{align}\n\\hat{\\mu} &= \\overline{X} \\\\\n\\hat{\\sigma} &= \\bigg[\\frac{\\sum_{i=1}^{n}{(X_i - \\overline{X})^2}}{n}\\bigg]^{\\frac{1}{2}}\n\\end{align}\n\\tag{7.3}\\]\n需要注意的是：标准差 \\(\\sigma\\) 的最大似然估计并不等同于样本标准差：\n\\(S = \\bigg[\\frac{\\sum_{i=1}^{n}{(X_i - \\overline{X})^2}}{n - 1}\\bigg]^{\\frac{1}{2}}\\)\n在 式 7.3 中，分母为 \\(\\sqrt{n}\\)，而不是样本方差中的 \\(\\sqrt{n - 1}\\)。然而，对于合理大小的 \\(n\\)，\\(\\sigma\\) 的这两个估计量将近似相等。\\(\\blacksquare\\)\n\n\n习题 7.6 Kolmogorov 碎裂定律（Kolmogorov’s law of fragmentation）指出，由矿物化合物碎裂产生的大量颗粒中的单个颗粒的大小服从近似对数正态分布（lognormal distribution）。如果一个随机变量 \\(X\\) 的对数 \\(\\textup{log}\\ (X)\\) 服从正态分布，那么 \\(X\\) 则具有对数正态分布。碎裂定律最初是通过实验证明的，后来由 Kolmogorov 提供了理论基础，并被应用于各种工程研究。例如，人们用碎裂定律来分析从一堆金砂中随机挑选出的颗粒的大小。碎裂定律还应用与地震断裂带的应力释放研究中（参见：Lomnitz, C., “Global Tectonics and Earthquake Risk,” Developments in Geotectonics, Elsevier, Amsterdam, 1979）。\n假设从一大堆金属砂中取出 10 粒样品，它们的长度（以毫米为单位）分别是：\n2.2, 3.4, 1.6, 0.8, 2.7, 3.3, 1.6, 2.8, 2.5, 1.9\n估计整个砂堆中长度在 2~3 毫米之间的砂粒的百分比。\n\n\n解 7.6. 取这 10 个数据值的自然对数，得到转换后的数据集结果：\n0.7885, 1.2238, 0.4700, -0.2231, 0.9933, 1.1939, 0.4700, 1.0296, 0.9163, 0.6419\n因为如上数据的样本均值和样本标准差分别为：\n\\(\\overline{x} = 0.7504, s = 0.4351\\)\n\n\n代码\nx &lt;- c(2.2, 3.4, 1.6, 0.8, 2.7, 3.3, 1.6, 2.8, 2.5, 1.9)\nlog_x &lt;- log(x)\nmean_log_x &lt;- mean(log_x)\nsd_log_x &lt;- sd(log_x)\nprint(mean_log_x)\n\n\n[1] 0.7504035\n\n\n代码\nprint(sd_log_x)\n\n\n[1] 0.435063\n\n\n因此，随机选择的砂粒长度的对数服从均值为 0.7504、标准差为 0.4351 正态分布。所以，如果 \\(X\\) 是砂粒的长度，那么\n\\(\\begin{align} P\\{2 \\lt X \\lt 3\\} &= P\\{\\textup{log}\\ 2 \\lt \\textup{log}\\ X \\lt \\textup{log}\\ 3\\} \\\\ &= P\\bigg\\{\\frac{\\textup{log}\\ 2 - 0.7504}{0.4351} \\lt \\frac{\\textup{log}\\ X - 0.7504}{0.4351} \\lt \\frac{\\textup{log}\\ 3 - 0.7504}{0.4351}\\bigg\\} \\\\ & \\approx pnorm(\\textup{log}\\ 3 - 0.7504 / 0.4351) - pnorm(\\textup{log}\\ 2 - 0.7504 / 0.4351) \\\\ &= 0.3405766 \\end{align}\\)\n\n\n代码\npnorm((log(3) - 0.7504) / 0.4351) - pnorm((log(2) - 0.7504) / 0.4351)\n\n\n[1] 0.3405766\n\n\n\\(\\blacksquare\\)\n\n当随机变量可以看作大量独立、同分布的随机变量的乘积的情况下，我们可以假设该随机变量服从对数正态分布。例如，在金融领域，经常用对数正态分布来估计股价在未来某段时间的价格分布。为了理解这种假设的合理性，我们假设当前股价是 \\(s\\)，我们关心的是经过时间 \\(t\\) 后的股票价格 \\(S(t)\\)。对于一个较大的 \\(n\\) 值，令 \\(t_i = \\frac{t}{n}\\)，并令 \\(S(t_1), S(t_2), ..., S(t_n)\\) 表示在时间 \\(t_1, t_2, ..., t_n\\) 时的股价。金融领域中的一个比较常见的假设是：\\(\\frac{S(t_i)}{S(t_{i-1})}\\) 近似符合独立同分布。因此，如果我们令 \\(X_i = \\frac{S(t_i)}{S(t_{i-1})}\\)，则：\n\\(\\begin{align} S(t) = S(t_n) &= S(t_0) \\cdot \\frac{S(t_1)}{S(t_0)} \\cdot \\frac{S(t_2)}{S(t_1)} \\cdot \\cdots \\cdot \\frac{S(t_n)}{S(t_{n-1})} \\\\ &= s \\prod_{i=1}^{n} X_i \\end{align}\\)\n对上式取对数得：\n\\(\\log(S(t)) = \\log(s) + \\sum_{i=1}^{n} \\log(X_i)\\)\n根据中心极限定理有：\\(\\log(S(t))\\) 将近似服从正态分布。\n已经证明，对于某些随机变量而言，对数正态分布是一个很好的拟合，例如病人的住院时长和车辆的行驶时间。\n\n\n\n\n\n\n提示\n\n\n\n在上述所有例子中，总体均值的最大似然估计都是样本均值 \\(\\overline{X}\\)。但是并非所有情况都是如此，例如 例 7.1。\n\n\n\n例 7.1 均匀分布的均值的最大似然估计。假设 \\(X_1, ..., Xn\\) 是来自均匀分布 \\((0, \\theta)\\) 的样本，其中 \\(\\theta\\) 未知。因此，\\(X_i\\) 的联合密度函数为：\n\\(f(x_1, x_2, ..., x_n | \\theta) = \\begin{cases} \\frac{1}{\\theta^n}, \\quad & 0 \\lt x_i \\lt \\theta \\\\ 0, \\quad & 其它 \\end{cases}\\)\n如果 \\(\\theta\\) 尽可能小，则 \\(f(x_1, x_2, ..., x_n | \\theta)\\) 则会尽可能的大。由于 \\(\\theta\\) 必须至少与所有观测值 \\(x_i\\) 一样大，因此 \\(\\theta\\) 的最小的可能值等于 \\(max(x_1, x_2, ..., x_n)\\)。因此，\\(\\theta\\) 的最大似然估计量是\n\\(\\hat{\\theta} = max(X_1, X_2, ..., X_n)\\)\n因此，可以得出均匀分布均值 \\(\\frac{\\theta}{2}\\) 的最大似然估计量为 \\(\\frac{max(X_1, X_2, ..., X_n)}{2}\\)。\\(\\blacksquare\\)\n\n\n7.2.1 估计寿命分布\n从今天出生的孩子中随机选择一个样本，令 \\(X\\) 表示样本中的孩子死亡时的年龄。若新生儿在其第 \\(i\\) 年死亡，则 \\(X = i\\)，\\(i \\geq 1\\)。为了估计 \\(X\\) 的概率质量函数，令 \\(\\lambda_i\\) 表示一个新生儿在度过其第 \\(i - 1\\) 年后在第 \\(i\\) 年死亡的概率。即，\n\\(\\lambda_i = P\\{X = i | X &gt; i - 1\\} = \\frac{P\\{X = i\\}}{P\\{X &gt; i - 1\\}}\\)\n另外，令\n\\(s_i = 1 - \\lambda_i = \\frac{P\\{X &gt; i\\}}{P\\{X &gt; i - 1\\}}\\)\n表示新生儿在度过其前 \\(i - 1\\) 年后在第 \\(i\\) 年仍然健在的概率。我们称 \\(\\lambda_i\\) 为故障率（failure rate），称 \\(s_i\\) 为生存率（survival rate）（个体在第 \\(i\\) 年的生存概率）。现在，\n\\(s_1 s_2 \\cdots s_i = P\\{X &gt; 1\\} \\frac{P\\{X &gt; 2\\}}{P\\{X &gt; 1\\}} \\frac{P\\{X &gt; 3\\}}{P\\{X &gt; 2\\}} \\cdots \\frac{P\\{X &gt; i\\}}{P\\{X &gt; i - 1\\}} = P\\{X &gt; i\\}\\)\n因此，\n\\(P\\{X = n\\} = P\\{X &gt; n - 1\\} \\lambda_n = s_1 \\cdots s_{n - 1} (1 - s_n)\\)\n因此，我们可以通过估计 \\(s_i, i = 1, \\ldots, n\\) 来估计 \\(X\\) 的概率质量函数。\\(s_i\\) 可以通过查看所有在第 \\(i-1\\) 年健在的人在第 \\(i\\) 年仍然健在的人来估计 \\(s_i\\) 的值，其估计值 \\(\\hat{s}_i\\) 为他们今天仍然健在的比例。然后我们将使用 \\(\\hat{s}_1 \\hat{s}_2 \\cdots \\hat{s}_{n - 1} (1 - \\hat{s}_n)\\) 来估计 \\(P\\{X = n\\}\\)。（注意，尽管我们在估计 \\(s_i\\) 时使用了尽可能最新的数据，但我们对新生儿寿命的概率质量函数的估计是假设新生儿在达到年龄 \\(i\\) 时的生存率与去年同年龄 \\(i\\) 的人的生存率相同。）\n在健康研究中，使用生存率来估计寿命分布也是很重要的，尤其是在信息不完全的情况下。例如，考虑一项研究，其中一种新药物被给与 12 名肺癌患者。假设一段时间后，我们得到了从开始服用新药到患者死亡的月份数：\n\\(4, 7^*, 9, 11^*, 12, 3, 14^*, 1, 8, 7, 5, 3^*\\)\n其中 \\(x\\) 表示患者在开始复用新药后的第 \\(x\\) 个月死亡，而 \\(x^*\\) 表示患者服药 \\(x\\) 个月并且仍然健在。\n令 \\(X\\) 表示开始复用新药后的生存月份数，并令\n\\(s_i = P(X &gt; i \\mid X &gt; i - 1) = \\frac{P(X &gt; i)}{P(X &gt; i - 1)}\\)\n为了估计 \\(s_i\\)，即在第 \\(i - 1\\) 个月存活的患者也将在第 \\(i\\) 个月存活的概率，我们应该取那些在第 \\(i\\) 个月开始服药并且在这个月存活的患者的比例。例如，因为 12 名患者中有 1 名在第 1 个月后死亡，所以 \\(\\hat{s}_1 = \\frac{11}{12}\\)。因为所有在第 2 个月开始服药的 11 名患者都存活，所以 \\(\\hat{s}_2 = \\frac{11}{11}\\)。因为 11 名患者中有 1 名在第 3 个月后死亡，所以 \\(\\hat{s}_3 = \\frac{10}{11}\\)。因为 9 名患者中，有 1 名在第 4 个月后死亡，所以 \\(\\hat{s}_4 = \\frac{8}{9}\\)。类似的推理适用于其他月份，于是得到以下生存率估计值：\n\\(\\hat{s}_1 = \\frac{11}{12}\\)\n\\(\\hat{s}_2 = \\frac{11}{11}\\)\n\\(\\hat{s}_3 = \\frac{10}{11}\\)\n\\(\\hat{s}_4 = \\frac{8}{9}\\)\n\\(\\hat{s}_5 = \\frac{7}{8}\\)\n\\(\\hat{s}_6 = \\frac{7}{7}\\)\n\\(\\hat{s}_7 = \\frac{6}{7}\\)\n\\(\\hat{s}_8 = \\frac{4}{5}\\)\n\\(\\hat{s}_9 = \\frac{3}{4}\\)\n\\(\\hat{s}_{10} = \\frac{3}{3}\\)\n\\(\\hat{s}_{11} = \\frac{3}{3}\\)\n\\(\\hat{s}_{12} = \\frac{1}{2}\\)\n\\(\\hat{s}_{13} = \\frac{1}{1}\\)\n\\(\\hat{s}_{14} = \\frac{1}{1}\\)\n现在，我们可以使用 \\(\\prod_{i=1}^j \\hat{s}_i\\) 来估计服用新药至少存活 \\(j\\) 个月的概率，其中 \\(j = 1, \\ldots, 14\\)。例如，\\(P\\{X &gt; 6\\}\\) 的估计是 \\(\\frac{35}{54}\\)。",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>参数估计</span>"
    ]
  },
  {
    "objectID": "chapter_7/7.html#sec-7_3",
    "href": "chapter_7/7.html#sec-7_3",
    "title": "7  参数估计",
    "section": "7.3 区间估计",
    "text": "7.3 区间估计\n假设 \\(X_1, \\ldots, X_n\\) 是来自均值 \\(\\mu\\) 未知但是方差 \\(\\sigma^2\\) 已知的正态分布总体的样本。根据 小节 7.2，我们知道 \\(\\overline{X} = \\frac{1}{n} \\sum_{i=1}^{n} X_i\\) 是 \\(\\mu\\) 的最大似然估计。然而，我们不能指望样本均值 \\(\\overline{X}\\) 会正好等于 \\(\\mu\\)，我们反而更希望 \\(\\overline{X}\\) 会“接近” \\(\\mu\\)。因此，有时指定一个 \\(\\mu\\) 可能会落入的、我们有一定信心水平的区间，比一个点估计更有价值。为了得到这样的区间估计量，我们需要利用点估计量的概率分布。\n如 小节 6.2 所述，点估计量 \\(\\overline{X}\\) 服从均值为 \\(\\mu\\) 、方差为 \\(\\frac{\\sigma^2}{n}\\) 的正态分布，因此：\n\\(\\frac{\\overline{X} - \\mu}{\\frac{\\sigma}{\\sqrt{n}}} = \\sqrt{n} \\frac{(\\overline{X} - \\mu)}{\\sigma}\\)\n服从标准正态分布。因此，\n\\(P\\bigg\\{ -1.96 &lt; \\sqrt{n} \\frac{(\\overline{X} - \\mu)}{\\sigma} &lt; 1.96 \\bigg\\} = 0.95\\)\n上式等价于：\n\\(P\\bigg\\{ -1.96 \\frac{\\sigma}{\\sqrt{n}} &lt; \\overline{X} - \\mu &lt; 1.96 \\frac{\\sigma}{\\sqrt{n}} \\bigg\\} = 0.95\\)\n通过乘以 -1 得到等价的表述：\n\\(P\\bigg\\{ -1.96 \\frac{\\sigma}{\\sqrt{n}} &lt; \\mu - \\overline{X} &lt; 1.96 \\frac{\\sigma}{\\sqrt{n}} \\bigg\\} = 0.95\\)\n即，\n\\(P\\bigg\\{ \\overline{X} - 1.96 \\frac{\\sigma}{\\sqrt{n}} &lt; \\mu &lt; \\overline{X} + 1.96 \\frac{\\sigma}{\\sqrt{n}} \\bigg\\} = 0.95\\)\n也就是说，样本均值 \\(\\overline{X}\\) 有 95% 的概率落在与总体均值 \\(\\mu\\) 之间的距离小于 \\(1.96 \\frac{\\sigma}{\\sqrt{n}}\\) 的区间。如果我们现在观察样本，并且发现 \\(\\overline{X} = \\overline{x}\\)，那么我们可以说，有 95% 的置信度使得\n\\[\n\\overline{x} - 1.96 \\frac{\\sigma}{\\sqrt{n}} &lt; \\mu &lt; \\overline{x} + 1.96 \\frac{\\sigma}{\\sqrt{n}}\n\\tag{7.4}\\]\n也就是说，我们“有95%的信心”断言总体的均值位于观测到的样本均值的 \\(\\pm 1.96\\) 个标准差的区间内。（需要注意到，\\(\\overline{X}\\) 的标准差为 \\(\\frac{\\sigma}{\\sqrt{n}}\\)）。\n我们称\n\\(\\left( \\overline{x} - 1.96\\frac{\\sigma}{\\sqrt{n}},\\ \\overline{x} + 1.96\\frac{\\sigma}{\\sqrt{n}}\\right)\\)\n为 \\(\\mu\\) 的 95% 置信区间估计（95 percent confidence interval estimate of \\(\\mu\\) ）。\n\n习题 7.7 假设从 A 地发射一个信号 \\(\\mu\\) 到 B 地，在 B 接收到的信号的值服从均值为 \\(\\mu\\)、方差为 4 的正态分布。也就是说，如果发送的信号值为 \\(\\mu\\)，那么接收到的信号值是 \\(\\mu + N\\)，其中 \\(N\\) 代表噪声是服从均值为 0、方差为 4 的正态分布。为了减少误差，相同的值会被发送 9 次。如果接收到的值分别是：\n5、8.5、12、15、7、9、7.5、6.5、10.5\n为 \\(\\mu\\) 构造一个 95% 置信区间。\n\n\n解 7.7. 因为 \\(\\overline{x} = \\frac{81}{9} = 9\\)，因此，假设 B 地接收到的信号值之间是独立的，则 \\(\\mu\\) 的 95% 可信区间是：\n\\(\\left(9 - 1.96\\frac{\\sigma}{3},\\ 9 + 1.96\\frac{\\sigma}{3}\\right) = (7.69, 10.31)\\)\n因此，我们有 95% 的置信度确认真实的信号值将位于 7.69~10.31 的范围内。\n\n式 7.4 中的区间称为双边置信区间（two-sided confidence interval）。然而，有时我们感兴趣的是确定一个值，使得我们能以 95% 的置信度断言 \\(\\mu\\) 至少与该值一样大。\n如果 \\(Z\\) 是一个标准正态分布随机变量，则\n\\(P\\{Z \\lt 1.645\\} = 0.95\\)\n\n\n\n\n\n\n注记\n\n\n\n在 R 中，可以使用 qnorm() 来得到该值：\n\n\n代码\nqnorm(0.95)\n\n\n[1] 1.644854\n\n\n\n\n因此有：\\(P\\bigg\\{\\sqrt{n}\\frac{(\\overline{X} - \\mu)}{\\sigma} \\lt 1.645\\bigg\\} = 0.95\\)，即\n\\(P\\bigg\\{\\overline{X} - 1.645\\frac{\\sigma}{\\sqrt{n}} \\lt \\mu \\bigg\\} = 0.95\\)\n因此，\\(\\mu\\) 的 95% 单边上置信区间为：\n\\(\\left(\\overline{x} - 1.645\\frac{\\sigma}{\\sqrt{n}},\\ \\infty\\right)\\)，其中 \\(\\overline{x}\\) 为观察到的数据的样本均值。\n\n\n\n\n\n\n注记\n\n\n\n或者说，我们有 95% 的信心认为 \\(\\mu\\) 的值不可能低于 \\(\\overline{x} - 1.645\\frac{\\sigma}{\\sqrt{n}}\\)。\n\n\n类似的，我们可以得到单边下置信区间（one-sided lower confidence interval）。当我们观察到的数据的样本均值为 \\(\\overline{x}\\) 时，则 \\(\\mu\\) 的 95% 单边下置信区间为：\n\\(\\left(-\\infty,\\ \\overline{x} + 1.645\\frac{\\sigma}{\\sqrt{n}}\\right)\\)\n\n\n\n\n\n\n注记\n\n\n\n或者说，我们有 95% 的信心认为 \\(\\mu\\) 的值不可能大于 \\(\\overline{x} + 1.645\\frac{\\sigma}{\\sqrt{n}}\\)。\n\n\n\n习题 7.8 确定 习题 7.7 中 \\(\\mu\\) 的 95% 置信区间估计的上下限。\n\n\n解 7.8. 因为：\n\\(1.645 \\frac{\\sigma}{\\sqrt{n}} = \\frac{3.29}{3} = 1.097\\)，\n所以，95% 上置信区间为：\\((9 - 1.097, \\infty) = (7.903, \\infty)\\)。 95% 下置信区间为：\\((-\\infty, 9 + 1.097) = (-\\infty, 10.097)\\)。\\(\\blacksquare\\)\n\n我们也可以获得任何指定置信水平的置信区间。为此，回忆一下 \\(z_{\\alpha}\\) 的定义。\\(z_{\\alpha}\\) 是使得\n\\[\nP\\{Z &gt; z_{\\alpha}\\} = \\alpha\n\\]\n成立的值，其中 \\(Z\\) 是标准正态随机变量。这意味着（见 图 7.1），对于任意 \\(\\alpha\\)，\n\\[\nP\\{-z_{\\alpha/2} &lt; Z &lt; z_{\\alpha/2}\\} = 1 - \\alpha\n\\]\n\n\n\n\n\n\n图 7.1: \\(P\\{-z_{\\alpha/2} &lt; Z &lt; z_{\\alpha/2}\\} = 1 - \\alpha\\)\n\n\n\n因此，我们有：\n\\[\nP\\left\\{ -z_{\\alpha/2} &lt; \\sqrt{n}\\left(\\frac{\\overline{X} - \\mu}{\\sigma}\\right) &lt; z_{\\alpha/2} \\right\\} = 1 - \\alpha\n\\]\n或\n\\[\nP\\left\\{ -z_{\\alpha/2} \\frac{\\sigma}{\\sqrt{n}} &lt; \\overline{X} - \\mu &lt; z_{\\alpha/2} \\frac{\\sigma}{\\sqrt{n}} \\right\\} = 1 - \\alpha\n\\]\n或\n\\[\nP \\left\\{-z_{\\alpha/2} \\frac{\\sigma}{\\sqrt{n}} &lt; \\mu - \\overline{X} &lt; z_{\\alpha/2} \\frac{\\sigma}{\\sqrt{n}}\\right\\} = 1 - \\alpha\n\\]\n也就是说，\n\\[\nP \\left\\{\\overline{X} - z_{\\alpha/2} \\frac{\\sigma}{\\sqrt{n}} &lt; \\mu &lt; \\overline{X} + z_{\\alpha/2} \\frac{\\sigma}{\\sqrt{n}}\\right\\} = 1 - \\alpha\n\\]\n因此，\\(\\mu\\) 的 \\(100(1−\\alpha)％\\) 的双边置信区间是：\n\\[\n\\left(\\overline{X} - z_{\\alpha/2} \\frac{\\sigma}{\\sqrt{n}}, \\overline{X} + z_{\\alpha/2} \\frac{\\sigma}{\\sqrt{n}}\\right)\n\\]\n其中 \\(\\overline{X}\\) 是观测样本均值。\n同样地，对于一个标准正态随机变量 \\(Z = \\sqrt{n} \\frac{(\\overline{X} - \\mu)}{\\sigma}\\)，有 \\(P\\{Z &gt; z_{\\alpha}\\} = \\alpha\\) 和 \\(P\\{Z &lt; -z_{\\alpha}\\} = \\alpha\\)。\n因此，我们可以得到任意置信水平的单边置信区间。具体来说，\\(\\mu\\) 的 \\(100(1−\\alpha)％\\) 单边上置信区间和 \\(100(1−\\alpha)％\\) 单边下置信区间分别为：\n\n\\(\\left(\\overline{X} - z_{\\alpha} \\frac{\\sigma}{\\sqrt{n}}, \\infty\\right)\\)\n\\(\\left(-\\infty, \\overline{X} + z_{\\alpha} \\frac{\\sigma}{\\sqrt{n}}\\right)\\)\n\n\n习题 7.9 使用 习题 7.7 中的数据来计算 \\(\\mu\\) 的 99% 置信区间估计，以及其 99% 单边上、下置信区间。\n\n\n解 7.9. 由于 \\(z_{0.005} = 2.58\\)，且 \\(2.58 \\frac{\\sigma}{\\sqrt{n}} = \\frac{5.16}{3} = 1.72\\)，\n因此，\\(\\mu\\) 的 99% 置信区间为 \\(9 \\pm 1.72\\)，也就是说，99% 置信区间估计为 \\((7.28, 10.72)\\)。\n此外，由于 \\(z_{0.01} = 2.33\\)，因此，99% 上置信区间为 \\((9 - 2.33(\\frac{2}{3}), \\infty) = (7.447, \\infty)\\)。\n同样地，99% 下置信区间为 \\((-\\infty, 9 + 2.33(\\frac{2}{3})) = (-\\infty, 10.553)\\)。\\(\\blacksquare\\)\n\n有时候，我们对某一置信水平（比如 \\(1−\\alpha\\)）的双边置信区间感兴趣，但问题是如何选择样本量 \\(n\\) 才能使得置信区间为某个指定的大小。例如，假设我们要计算一个长度为 0.1 的区间，并且能断言该区间以 99% 的置信度包含 \\(\\mu\\)，此时我们需要多大的样本量 \\(n\\)？\n由于 \\(z_{0.005} = 2.58\\)，从样本量为 \\(n\\) 的样本中得到的 \\(\\mu\\) 的 99% 置信区间是：\n\\(\\left( \\overline{X} - 2.58 \\frac{\\sigma}{\\sqrt{n}}, \\overline{X} + 2.58 \\frac{\\sigma}{\\sqrt{n}} \\right)\\)\n因此，置信区间的长度为：\\(5.16 \\frac{\\sigma}{\\sqrt{n}}\\)。因此，要使置信区间的长度等于 0.1，我们必须让 \\(5.16 \\frac{\\sigma}{\\sqrt{n}} = 0.1\\)，即：\\(n = (51.6 \\sigma)^2\\)。\n\n\n\n\n\n\n注意\n\n\n\n对“\\(100(1−\\alpha)％\\) 置信区间”的解释可能会令人困惑。需要注意的是，我们并不是在断言 \\(\\mu \\in \\left( \\overline{X} - 1.96 \\frac{\\sigma}{\\sqrt{n}}, \\overline{X} + 1.96 \\frac{\\sigma}{\\sqrt{n}} \\right)\\) 的概率为 0.95，这主要是因为在如上的断言中并没有涉及到任何 随机变量。我们所断言的是，使用这种方法得到的区间会有 95% 的概率包含 \\(\\mu\\)。换句话说，观测到数据之前，我们可以断言该区间有 0.95 的概率将包含 \\(\\mu\\)；而在观测到数据之后，我们只能断言结果区间确实以 0.95 的置信度包含 \\(\\mu\\)。\n\n\n\n习题 7.10 根据以往的经验，在商业孵化场中养殖的三文鱼的重量符合正态分布，其均值会随季节的不同而不同，但其标准差固定为 0.3 磅。如果我们想在 95% 的置信度下，估计当前季节三文鱼的平均重量，并且估计的误差在 \\(\\pm 0.1\\) 磅以内，需要多大的样本量？\n\n\n解 7.10. 基于样本量 \\(n\\) 的未知均值 \\(\\mu\\) 的 95% 置信区间估计为：\n\\(\\mu \\in \\left( \\overline{X} - 1.96 \\frac{\\sigma}{\\sqrt{n}}, \\overline{X} + 1.96 \\frac{\\sigma}{\\sqrt{n}} \\right)\\)\n因为估计区间中的任何一个估计值都在 \\(\\overline{X}\\) 的 \\(1.96(\\sigma / \\sqrt{n}) = \\frac{0.588}{\\sqrt{n}}\\) 以内，因此我们可以 95% 地确信，\\(\\overline{X}\\) 在 \\(\\mu\\) 的 0.1 以内的前提是：\n\\(\\frac{0.588}{\\sqrt{n}} \\leq 0.1\\)\n也就是说 \\(\\sqrt{n} \\geq 5.88\\)，即 \\(n \\geq 34.57\\)。也就是说，样本量为 35 或更大就足够了。 \\(\\blacksquare\\)\n\n\n7.3.1 方差未知时正态分布均值的置信区间\n\n\n\n\n\n\n图 7.2: t 分布的概率密度函数\n\n\n\n假设 \\(X_1, ..., X_n\\) 是来自均值 \\(\\mu\\)、方差 \\(\\sigma^2\\) 均未知的正态分布的样本，我们希望计算 \\(\\mu\\) 的 \\(100(1-\\alpha)\\%\\) 置信区间估计。当方差 \\(\\sigma^2\\) 未知时，我们不能再认为 \\(\\sqrt{n} \\frac{\\overline{X} - \\mu}{\\sigma}\\) 是一个标准正态分布的 随机变量。但是，令 \\(S^2 = \\sum_{i=1}^{n}(X_i - \\overline{X})^2 / (n-1)\\) 为样本方差，那么根据 推论 6.1 可知\n\\(\\sqrt{n} \\frac{\\overline{X} - \\mu}{S}\\)\n符合自由度为 \\(n-1\\) 的 \\(t\\) 分布。因此，根据 \\(t\\) 分布的概率密度函数的对称性（图 7.2），对于任何 \\(\\alpha \\in (0, 1/2)\\) ，我们都有\n\\(P\\left\\{ -t_{\\alpha/2, n-1} &lt; \\sqrt{n} \\frac{\\overline{X} - \\mu}{S} &lt; t_{\\alpha/2, n-1} \\right\\} = 1 - \\alpha\\)\n即\n\\(P\\left\\{ -t_{\\alpha/2, n-1} \\frac{S}{\\sqrt{n}} &lt; \\overline{X} - \\mu &lt; t_{\\alpha/2, n-1} \\frac{S}{\\sqrt{n}} \\right\\} = 1 - \\alpha\\)\n于是，得到\n\\(P\\left\\{ \\overline{X} - t_{\\alpha/2, n-1} \\frac{S}{\\sqrt{n}} &lt; \\mu &lt; \\overline{X} + t_{\\alpha/2, n-1} \\frac{S}{\\sqrt{n}} \\right\\} = 1 - \\alpha\\)\n因此，根据观测到的样本数据 \\(\\overline{X} = \\overline{x}\\) 且 \\(S = s\\) ，我们可以说“ \\(\\mu\\) 的 \\(100(1-\\alpha)\\%\\) 置信度区间估计”为：\n\\(\\mu \\in \\left( \\overline{x} - t_{\\alpha/2, n-1} \\frac{s}{\\sqrt{n}}, \\overline{x} + t_{\\alpha/2, n-1} \\frac{s}{\\sqrt{n}} \\right)\\)\n\n习题 7.11 让我们再次考虑 习题 7.7，但现在假设在 A 地传输值为 \\(\\mu\\) 的信号时，在 B 地接收到的值符合均值为 \\(\\mu\\)、方差为 \\(\\sigma^2\\) 的正态分布，但是 \\(\\sigma^2\\) 未知。如 习题 7.7 所示，如果连续发送 9 个信号，B 地接收到的信号值分别为：\n5、8.5、12、15、7、9、7.5、6.5、10.5\n请计算 \\(\\mu\\) 的 95% 置信区间。\n\n\n解 7.11. 样本均值 \\(\\overline{x} = 9\\)，样本标准差 \\(s^2 = \\frac{\\sum(x_i - \\overline{x})^2}{8} = 9.5\\)，即 \\(s = 3.082\\)。\n\n\n代码\nqt(0.025, df=8, lower.tail=FALSE)\n\n\n[1] 2.306004\n\n\n因为 \\(t_{0.025, 8} = 2.306\\)，因此，\\(\\mu\\) 的 95% 置信区间为：\n\\(\\bigg(9-2.306 \\frac{3.082}{3}, 9+2.306 \\frac{3.082}{3}\\bigg) = (6.63, 11.37)\\)\n可见，如上的结果比 Solution 7.7 中得到的区间要大，这里主要有两个原因：\n\n最主要的原因是，我们在这里对方差的估计值比 Solution 7.7 中的方差更大。也就是说，在 Solution 7.7 中，我们假设 \\(\\sigma^2\\) 已知并等于 4；而在本例中，我们假设方差是未知的，并且我们的估计值为 9.5。更大的方差导致我们得到了一个更大范围的置信区间。\n事实上，即使我们估计的 \\(\\sigma^2\\) 依旧是 4，因为方差未知，我们仍然需要利用 \\(t\\) 分布来估计方差。因为 \\(t\\) 分布的方差比标准正态分布的方差更大，因此获得的区间范围也会比标准正态分布更宽。例如，如果 \\(\\overline{x} = 9\\) 且 \\(s^2 = 4\\)，那么我们的置信区间将是：\n\n\\((9 - 2.306 \\cdot \\frac{2}{3}, 9 + 2.306 \\cdot \\frac{2}{3}) = (7.46, 10.54)\\)\n这显然比 Solution 7.7 中的 \\((7.69, 10.31)\\) 的区间更大。\\(\\blacksquare\\)\n\n\n\n\n\n\n\n注意\n\n\n\n\n当 \\(\\sigma\\) 已知时，\\(\\mu\\) 的置信区间基于以下事实：\\(\\sqrt{n}(\\overline{X} - \\mu)/\\sigma\\) 服从标准正态分布。当 \\(\\sigma\\) 未知时，可以利用样本标准差 \\(S\\) 来估计总体标准差 \\(\\sigma\\)，然后利用以下事实——\\(\\sqrt{n}(\\overline{X} - \\mu)/S\\) 服从自由度为 \\(n - 1\\) 的 \\(t\\) 分布——来计算 \\(\\mu\\) 的置信区间估计。\n当总体方差未知时，\\(\\mu\\) 的 \\(100(1-2\\alpha)\\%\\) 置信区间的长度并不总是比方差已知时的更长。当 \\(\\sigma\\) 已知时，置信区间估计的长度是 \\(2z_{\\alpha}\\frac{\\sigma}{\\sqrt{n}}\\)；而当 \\(\\sigma\\) 未知时，其长度是 \\(2t_{\\alpha, n-1}\\frac{S}{\\sqrt{n}}\\)。并且，确实存在如下的可能性：样本标准差 \\(S\\) 远小于总体标准差 \\(\\sigma\\)。但是，我们依然可以证明，当总体方差未知时，\\(\\mu\\) 的置信区间的平均长度会更长。也就是说，可以证明：\n\\(t_{\\alpha, n-1} E[S] \\geq z_{\\alpha}\\sigma\\)\n我们会在 章节 14 中计算 \\(E[S]\\)，例如：\n\\(E[S] = \\begin{cases}0.94\\sigma, \\quad n = 5 & \\\\0.97\\sigma, \\quad n = 9 &\\end{cases}\\)\n因为 \\(z_{0.025} = 1.96\\)， \\(t_{0.025,4} = 2.78\\)， \\(t_{0.025,8} = 2.31\\)，所以样本量为 5 时，当方差已知时，95% 的置信区间长度是 \\(2 \\times 1.96 \\times \\frac{\\sigma}{5} = 1.75 \\sigma\\)；而当方差未知时，其预期长度是 \\(2 \\times 2.78 \\times \\frac{0.94\\sigma}{\\sqrt{5}} = 2.34\\sigma\\)。因此可以看出，当方差未知时，置信区间的长度增加了 33.7%。如果样本量为 9，则方差已知和方差未知时的 95% 置信区间长度分别为 \\(1.31\\sigma\\) 和 \\(1.49\\sigma\\)，置信区间长度增加了 13.7%。\n\n\n\n当总体方差未知时，我们可以得到 \\(\\mu\\) 的单边上置信区间估计为：\n\\(P\\bigg\\{\\sqrt{n}\\frac{\\overline{X} - \\mu}{S} \\lt t_{\\alpha, n-1}\\bigg\\} = 1 - \\alpha\\)，即\n\\(P\\bigg\\{\\overline{X} - \\mu \\lt \\frac{S}{\\sqrt{n}}t_{\\alpha, n-1} \\bigg\\} = 1 - \\alpha\\)，即\n\\(P\\bigg\\{\\mu \\gt \\overline{X} - \\frac{S}{\\sqrt{n}}t_{\\alpha, n-1} \\bigg\\} = 1 - \\alpha\\)\n因此，对于观察到的样本数据而言，\\(\\overline{X} = \\overline{x}\\)，\\(S=s\\)，我们有“有 \\(100(1-\\alpha)\\%\\) 的信心” 可以断言：\n\\(\\mu \\in \\bigg(\\overline{x} - \\frac{S}{\\sqrt{n}}t_{\\alpha, n-1}, \\infty\\bigg)\\)\n同理，我们可以得到总体方差未知时，\\(\\mu\\) 的单边下置信区间估计为：\n\\(\\mu \\in \\bigg(-\\infty, \\overline{x} + \\frac{S}{\\sqrt{n}}t_{\\alpha, n-1}\\bigg)\\)\n我们可以使用 R 来获得置信区间。要得到 \\(x_1, ..., x_n\\) 的 \\(100(1-\\alpha)\\%\\) 置信区间，我们可以在 R 中执行如下操作：\nd &lt;- c(x1,...,xn)\nl &lt;- mean(d) − qt(1−α/2, n−1) * sqrt(var(d) / n)\nu &lt;- mean(d) + qt(1−α/2, n−1) * sqrt(var(d) / n) \nc(l, u)\n例如，在正态分布的总体方差未知时，我们要计算该正态分布的均值的 99% 置信区间，其中数据样本为：\n5, 9, 12, 8.6, 7.2, 13, 9.5\nd &lt;- c(5, 9, 12, 8.6, 7.2, 13, 9.5)\nl &lt;- mean(d) - qt(.995, 6) * sqrt(var(d) / 7)\nu &lt;- mean(d) + qt(.995, 6) * sqrt(var(d) / 7)\nc(l, u)\n\n\n代码\nd &lt;- c(5, 9, 12, 8.6, 7.2, 13, 9.5)\nl &lt;- mean(d) - qt(.995, 6) * sqrt(var(d) / 7)\nu &lt;- mean(d) + qt(.995, 6) * sqrt(var(d) / 7)\nc(l, u)\n\n\n[1]  5.373463 12.997965\n\n\n\n习题 7.12 从某健身俱乐部的成员中随机选择了 15 名成员并得到了如下的静息心率数据：\n54、63、58、72、49、92、70、73、69、104、48、66、80、64、77\n确定该健身俱乐部成员的平均静息心率的 95% 置信区间和 95% 上置信区间。\n\n\n解 7.12. 双边 95% 置信区间为：\\((60.86694, 77.66640)\\)\n\n\n代码\nd &lt;- c(54, 63, 58, 72, 49, 92, 70, 73, 69, 104, 48, 66, 80, 64, 77)\nl &lt;- mean(d) - qt(.975, 14) * sqrt(var(d) / 15)\nu &lt;- mean(d) + qt(.975, 14) * sqrt(var(d) / 15)\nc(l, u)\n\n\n[1] 60.86694 77.66640\n\n\n单边 95% 上置信区间为：\\((62.36876, \\infty)\\)\n\n\n代码\nd &lt;- c(54, 63, 58, 72, 49, 92, 70, 73, 69, 104, 48, 66, 80, 64, 77)\nub &lt;- mean(d) - qt(.95, 14) * sqrt(var(d) / 15)\nub\n\n\n[1] 62.36876\n\n\n\\(\\blacksquare\\)\n\n我们假定总体分布是正态分布，然后推导出总体均值 \\(\\mu\\) 的 \\(100(1-\\alpha) \\%\\) 置信区间。然而，即使总体不是正态分布，根据中心极限定理（定理 6.1），如果样本量足够大，那么 \\(\\sqrt{n}(\\overline{X} - \\mu)/\\sigma\\) 将近似服从正态分布，并且 \\(\\sqrt{n}(\\overline{X} - \\mu)/S\\) 将近似服从 \\(t\\) 分布，因此 \\(\\mu\\) 的区间估计仍将近似于 \\(100(1-\\alpha) \\%\\) 置信区间。\n\n例 7.2 统计模拟法（simulation）提供了一种强大的方法以计算一维积分和多维积分。例如，设 \\(f\\) 是一个 \\(r\\) 维向量 \\((y_1, y_2, \\ldots, y_r)\\) 的函数，并且假设我们想要对如下的 进行估计：\n\\(\\theta = \\int_{0}^{1} \\int_{0}^{1} \\cdots \\int_{0}^{1} f(y_1, y_2, \\ldots, y_r) dy_1 dy_2 \\ldots dy_r\\)\n如果 \\(U_1, U_2, \\ldots, U_r\\) 是 \\((0, 1)\\) 上的、相互独立的均匀分布随机变量，那么\n\\(\\theta = E[f(U_1, U_2, \\ldots, U_r)]\\)\n现在，我们可以（通过所谓的伪随机数）在计算机上近似模拟独立 \\((0, 1)\\) 均匀分布随机变量的值。如果我们生成一个 \\(r\\) 维向量，并在该向量上计算 \\(f\\)，那么由此得到的值——\\(X_1\\)——将是均值为 \\(\\theta\\) 的随机变量。如果我们重复这个过程，那么我们得到另一个值——\\(X_2\\)——将与 \\(X_1\\) 的分布相同。继续下去，我们可以生成一个序列 \\(X_1, X_2, \\ldots, X_n\\)，他们是独立、同分布的随机变量，并且均值为 \\(\\theta\\)。然后我们就可以利用 \\(X_1, X_2, \\ldots, X_n\\) 的观察值来估计 \\(\\theta\\)。我们将这种近似积分的方法称为 蒙特卡罗模拟（Monte Carlo simulation）。\n例如，假设我们想要估计一维积分：\n\\(\\theta = \\int_{0}^{1} \\sqrt{1 - y^2} dy = E[\\sqrt{1 - U^2}]\\)\n其中，\\(U\\) 是一个 \\((0, 1)\\) 均匀随机变量。\n为此，设 \\(U_1, \\ldots, U_{100}\\) 为 \\((0, 1)\\) 上的独立均匀随机变量，并设\n\\(X_i = \\sqrt{1 - U_i^2}, \\quad i = 1, \\ldots, 100\\)\n通过这种方式，我们生成了一个均值为 \\(\\theta\\) 的 100 个随机变量的样本。假设计算机生成的 \\(U_1, \\ldots, U_{100}\\) 的随机值所得到的样本 \\(X_1, \\ldots, X_{100}\\) 的样本均值为 0.786、样本标准差为 0.03。\n因为 \\(t_{0.025, 99} = 1.985\\)，因此 \\(\\theta\\) 的 95% 置信区间为：\n\\(0.786 \\pm 1.985 \\cdot (0.003)\\)\n因此，我们有 95% 的信心断言，\\(\\theta\\)（实际为 \\(\\frac{\\pi}{4}\\)） 位于区间 \\((0.780, 0.792)\\) 中。\\(\\blacksquare\\)\n\n\n\n7.3.2 预测区间\n假设 \\(X_1, \\ldots, X_n, X_{n+1}\\) 是来自均值 \\(\\mu\\) 方差 \\(\\sigma\\) 均未知的正态分布的样本。进一步假设 \\(X_1, \\ldots, X_n\\) 的值是已知的，并且我们希望用它们来预测 \\(X_{n+1}\\) 的值。\n首先，如果均值 \\(\\mu\\) 是已知的，那么 \\(\\mu\\) 就是 \\(X_{n+1}\\) 的天然预测器。但是由于 \\(\\mu\\) 未知，因此在观察到 \\(X_1, \\ldots, X_n\\) 后，使用这些观测值的平均值作为 \\(X_{n+1}\\) 的预测值是合理的。也就是说，我们应该使用 \\(\\overline{X}_n = \\sum_{i=1}^n X_i / n\\) 作为 \\(X_{n+1}\\) 的预测值。\n现在假设我们想要确定一个区间，在这个区间内，以某种置信度预测 \\(X_{n+1}\\) 将位于该区间中。为了获得这样的预测区间，注意到 \\(\\overline{X}_n\\) 是具有均值 \\(\\mu\\) 和方差 \\(\\sigma^2 / n\\) 的正态分布，并且它与 \\(X_{n+1}\\)（均值为 \\(\\mu\\)、方差为 \\(\\sigma^2\\)）是独立的。由此可以得出 \\(X_{n+1} - \\overline{X}_n\\) 的均值为 0、方差为 \\(\\sigma^2 / n + \\sigma^2\\)。因此，\n\\(\\frac{X_{n+1} - \\overline{X}_n}{\\sigma \\sqrt{1 + 1/n}}\\)\n服从标准正态分布。\n由于 \\(\\frac{X_{n+1} - \\overline{X}_n}{\\sigma \\sqrt{1 + 1/n}}\\) 与 \\(S_n^2 = \\sum_{i=1}^n (X_i - \\overline{X}_n)^2 / (n - 1)\\) 独立，从而根据 推论 6.1 可知，将 \\(\\sigma\\) 替换为其估计量 \\(S_n\\) 后的表达式是自由度为 \\(n - 1\\) 的 \\(t\\) 分布，即，\n\\(\\frac{X_{n+1} - \\overline{X}_n}{S_n \\sqrt{1 + 1/n}}\\)\n是自由度为 \\(n - 1\\) 的 \\(t\\) 分布随机变量。因此，对于任何 \\(\\alpha \\in (0, 1/2)\\)，\n\\(P \\bigg\\{ -t_{\\alpha/2, n-1} &lt; \\frac{X_{n+1} - \\overline{X}_n}{S_n \\sqrt{1 + 1/n}} &lt; t_{\\alpha/2, n-1} \\bigg\\} = 1 - \\alpha\\)\n即\n\\(P \\bigg\\{ \\overline{X}_n - t_{\\alpha/2, n-1} S_n \\sqrt{1 + 1/n} &lt; X_{n+1} &lt; \\overline{X}_n + t_{\\alpha/2, n-1} S_n \\sqrt{1 + 1/n} \\bigg\\}\\)\n因此，如果 \\(\\overline{X}_n\\) 和 \\(S_n\\) 的样本观察值分别是 \\(\\overline{x}_n\\) 和 \\(s_n\\)，那么我们可以在 \\(100(1 - \\alpha) \\%\\) 的置信度下预测 \\(X_{n+1}\\) 将位于 \\(\\overline{x}_n - t_{\\alpha/2, n-1} s_n \\sqrt{1 + 1/n}\\) 和 \\(\\overline{x}_n + t_{\\alpha/2, n-1} s_n \\sqrt{1 + 1/n}\\) 之间。也就是说，在 \\(100(1 - \\alpha) \\%\\) 的置信度下，我们可以预测\n\\[\nX_{n+1} \\in \\left( \\overline{x}_n - t_{\\alpha/2, n-1} s_n \\sqrt{1 + 1/n}, \\overline{x}_n + t_{\\alpha/2, n-1} s_n \\sqrt{1 + 1/n} \\right)\n\\]\n\n习题 7.13 以下数据是过去 7 天的步数：\n6822, 5333, 7420, 7432, 6252, 7005, 6752\n假设每天的步数可以认为服从正态分布，给出一个预测区间，使得在 95% 的置信度下，明天的步数将位于该预测区间。\n\n\n解 7.13. 计算这 7 个数据值的样本均值和样本方差： \\(\\overline{X}_7 = 6716.57 , \\quad S_7 = 733.97\\)\n因为 \\(t_{0.025, 6} = 2.447\\)，并且 \\(2.4447 \\cdot 733.97 \\sqrt{1 + 1/7} = 1920.03\\)，我们可以在 95% 的置信度下预测明天的步数将在 6716.57 - 1920.03 和 6716.57 + 1920.03 之间。也就是说，在 95% 的置信度下，\\(X_8\\) 将位于区间 (4796.54, 8636.60) 内。 \\(\\blacksquare\\)\n\n\n\n7.3.3 正态分布方差的置信区间\n如果 \\(X_1, \\ldots, X_n\\) 是来自均值 \\(\\mu\\) 和方差 \\(\\sigma^2\\) 均未知的正态分布的样本，那么我们可以根据以下事实（定理 6.2）构造 \\(\\sigma^2\\) 的置信区间：\n\\((n-1)\\frac{S^2}{\\sigma^2} \\sim \\chi^2_{n-1}\\)\n因此，\n\\(P \\left\\{ \\chi^2_{1-\\alpha/2, n-1} \\leq (n-1)\\frac{S^2}{\\sigma^2} \\leq \\chi^2_{\\alpha/2, n-1} \\right\\} = 1-\\alpha\\)\n即，\n\\(P \\left\\{ \\frac{(n-1)S^2}{\\chi^2_{\\alpha/2, n-1}} \\leq \\sigma^2 \\leq \\frac{(n-1)S^2}{\\chi^2_{1-\\alpha/2, n-1}} \\right\\} = 1-\\alpha\\)\n因此，当 \\(S^2 = s^2\\) 时，\\(\\sigma^2\\) 的 \\(100(1 - \\alpha) \\%\\) 置信区间为：\n\\(\\left( \\frac{(n - 1)s^2}{\\chi^2_{\\alpha/2, n-1}}, \\frac{(n - 1)s^2}{\\chi^2_{1-\\alpha/2, n-1}} \\right)\\)\n\n习题 7.14 我们希望一个标准化流水线生产的垫片的厚度差异很小。假设我们选取了 10 个这样的垫片并测量其厚度。如果这些垫片的厚度（单位：英寸）如下所示：\n0.123 0.133 0.124 0.125 0.126 0.128 0.120 0.124 0.130 0.126\n那么，该流水线生产的垫片厚度的标准差的 90% 置信区间是多少？\n\n\n解 7.14. 使用 R，我们有：\n&gt;d = c(0.123, 0.124, 0.126, 0.120, 0.130, 0.133, 0.125, 0.128, 0.124, 0.126)\n&gt;l = 9 * var(d) / qchisq(0.95, 9)\n&gt;u = 9 * var(d) / qchisq(0.05, 9)\n&gt;c(l, u)\n\n\n代码\nd = c(0.123, 0.124, 0.126, 0.120, 0.130, 0.133, 0.125, 0.128, 0.124, 0.126)\nl = 9 * var(d) / qchisq(0.95, 9)\nu = 9 * var(d) / qchisq(0.05, 9)\nc(l, u)\n\n\n[1] 7.264032e-06 3.696115e-05\n\n\n由此可见，\\(\\sigma^2\\) 的 90% 的置信区间为：\n\\(\\sigma^2 \\in (7.2640 \\times 10^{-6}, 36.9612 \\times 10^{-6})\\)\n所以：\n\\(\\sigma \\in (0.00269, 0.00608)\\)\n\n类似的，可以得到 \\(\\sigma^2\\) 的单边置信区间。表 7.1 对本节的内容进行了总结。\n\n\n\n表 7.1: 正态分布参数的 \\(100(1-\\alpha)\\%\\) 置信区间，其中 \\(X_1,...,X_n \\sim \\mathcal{N}(\\mu, \\sigma^2)\\)，\\(\\overline{X} = \\sum_{i=1}^{n}{X_i/n}\\)，\\(S = \\sqrt{\\sum_{i=1}^{n}{(X_i - \\overline{X})^2/(n-1)}}\\)\n\n\n\n\n\n\n\n\n\n\n\n\n假设\n参数\n置信区间\n单边下置信区间\n单边上置信区间\n\n\n\n\n\\(\\sigma^2\\) 已知\n\\(\\mu\\)\n\\(\\overline{X} \\pm z_{\\alpha/2} \\frac{\\sigma}{\\sqrt{n}}\\)\n\\((-\\infty, \\overline{X} + z_{\\alpha} \\frac{\\sigma}{\\sqrt{n}})\\)\n\\((\\overline{X} - z_{\\alpha} \\frac{\\sigma}{\\sqrt{n}}, \\infty)\\)\n\n\n\\(\\sigma^2\\) 未知\n\\(\\mu\\)\n\\(\\overline{X} \\pm t_{\\alpha/2, n-1} \\frac{S}{\\sqrt{n}}\\)\n\\((-\\infty, \\overline{X} + t_{\\alpha, n-1} \\frac{S}{\\sqrt{n}})\\)\n\\((\\overline{X} - t_{\\alpha, n-1} \\frac{S}{\\sqrt{n}}, \\infty)\\)\n\n\n\\(\\mu\\) 未知\n\\(\\sigma^2\\)\n\\(\\left( \\frac{(n - 1) S^2}{\\chi^2_{\\alpha/2, n-1}}, \\frac{(n - 1) S^2}{\\chi^2_{1-\\alpha/2, n-1}} \\right)\\)\n\\(\\left(0, \\frac{(n - 1) S^2}{\\chi^2_{1 - \\alpha, n-1}}\\right)\\)\n\\(\\left(\\frac{(n - 1) S^2}{\\chi^2_{\\alpha, n-1}}, \\infty\\right)\\)",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>参数估计</span>"
    ]
  },
  {
    "objectID": "chapter_7/7.html#sec-7_4",
    "href": "chapter_7/7.html#sec-7_4",
    "title": "7  参数估计",
    "section": "7.4 估计两个正态分布总体的均值差异",
    "text": "7.4 估计两个正态分布总体的均值差异\n令 \\(X_1, X_2, \\dots, X_n\\) 是来自均值为 \\(\\mu_1\\)、方差为 \\(\\sigma_1^2\\) 的正态分布的总体的一个样本，样本大小为 \\(n\\)；\\(Y_1, \\dots, Y_m\\) 是来自均值为 \\(\\mu_2\\)、方差为 \\(\\sigma_2^2\\) 的另一个正态分布总体的一个样本，样本大小为 \\(m\\)。假设这两个样本之间彼此相互独立。此时，我们感兴趣的是：如何估计 \\(\\mu_1 - \\mu_2\\)？\n因为 \\(\\mu_1\\) 和 \\(\\mu_2\\) 的最大似然估计分别是：\\(\\overline{X} = \\sum_{i=1}^n X_i / n\\)、\\(\\overline{Y} = \\sum_{i=1}^m Y_i / m\\)，所以直觉而言（并且可以证明）\\(\\mu_1 - \\mu_2\\) 的最大似然估计是 \\(\\overline{X} - \\overline{Y}\\)。\n为了得到置信区间估计，我们需要计算 \\(\\overline{X} - \\overline{Y}\\) 的分布。由于\n\\(\\begin{align} \\overline{X} &\\sim \\mathcal{N}\\left(\\mu_1, \\frac{\\sigma_1^2}{n}\\right) \\\\ \\overline{Y} & \\sim \\mathcal{N}\\left(\\mu_2, \\frac{\\sigma_2^2}{m}\\right) \\end{align}\\)\n根据独立正态分布随机变量的和也是正态分布的性质，有：\n\\(\\overline{X} - \\overline{Y} \\sim \\mathcal{N}\\left(\\mu_1 - \\mu_2, \\frac{\\sigma_1^2}{n} + \\frac{\\sigma_2^2}{m}\\right)\\)\n因此，假设 \\(\\sigma_1^2\\) 和 \\(\\sigma_2^2\\) 是已知的，我们有：\n\\[\n\\frac{\\overline{X} - \\overline{Y} - (\\mu_1 - \\mu_2)}{\\sqrt{\\frac{\\sigma_1^2}{n} + \\frac{\\sigma_2^2}{m}}} \\sim \\mathcal{N}(0, 1)\n\\tag{7.5}\\]\n因此，\n\\(P\\left\\{-z_{\\alpha/2} &lt; \\frac{\\overline{X} - \\overline{Y} - (\\mu_1 - \\mu_2)}{\\sqrt{\\frac{\\sigma_1^2}{n} + \\frac{\\sigma_2^2}{m}}} &lt; z_{\\alpha/2}\\right\\} = 1 - \\alpha\\)\n即：\n\\(P\\left\\{\\overline{X} - \\overline{Y} - z_{\\alpha/2}\\sqrt{\\frac{\\sigma_1^2}{n} + \\frac{\\sigma_2^2}{m}} &lt; \\mu_1 - \\mu_2 &lt; \\overline{X} - \\overline{Y} + z_{\\alpha/2}\\sqrt{\\frac{\\sigma_1^2}{n} + \\frac{\\sigma_2^2}{m}}\\right\\} = 1 - \\alpha\\)\n因此，如果获得了样本的观察数据，则 \\(\\overline{X}\\) 和 \\(\\overline{Y}\\) 分别等于 \\(\\overline{x}\\) 和 \\(\\overline{y}\\)，那么 \\(\\mu_1 - \\mu_2\\) 的 \\(100(1-\\alpha)\\%\\) 双边置信区间估计为：\n\\[\n\\mu_1 - \\mu_2 \\in \\left(\\overline{x} - \\overline{y} - z_{\\alpha/2}\\sqrt{\\frac{\\sigma_1^2}{n} + \\frac{\\sigma_2^2}{m}}, \\, \\overline{x} - \\overline{y} + z_{\\alpha/2}\\sqrt{\\frac{\\sigma_1^2}{n} + \\frac{\\sigma_2^2}{m}}\\right)\n\\tag{7.6}\\]\n类似的，可以得到 \\(\\mu_1 - \\mu_2\\) 的 \\(100(1-\\alpha)\\%\\) 的单边置信区间：\n\\[\n\\mu_1 - \\mu_2 \\in \\left(-\\infty, \\, \\overline{x} - \\overline{y} + z_{\\alpha}\\sqrt{\\frac{\\sigma_1^2}{n} + \\frac{\\sigma_2^2}{m}}\\right)\n\\tag{7.7}\\]\n式 7.7 的证明我们留给读者来进行验证。\n\n习题 7.15 我们对两种不同类型的电缆绝缘材料进行了测试，以确定故障发生时的电压水平。在实验室的实验中，在电压不断增加的情况下，两种类型的电缆绝缘材料在如下的电压下发生了故障：\n\n\n\nType A\nType B\n\n\n\n\n36\n52\n\n\n44\n64\n\n\n41\n38\n\n\n53\n68\n\n\n38\n66\n\n\n36\n52\n\n\n34\n60\n\n\n54\n44\n\n\n52\n48\n\n\n37\n46\n\n\n51\n70\n\n\n44\n62\n\n\n35\n\n\n\n44\n\n\n\n\n假设已知绝缘材料 A 所能承受的电压服从均值为 \\(\\mu_A\\)（未知）、方差为 \\(\\sigma_A^2 = 40\\) 的正态分布；而绝缘材料 B 服从均值为 \\(\\mu_B\\)（未知）、方差为 \\(\\sigma_B^2 = 100\\) 的正态分布。\n\n确定 \\(\\mu_B - \\mu_A\\) 的 95% 置信区间。\n确定我们可以以 95% 的置信度断言比 \\(\\mu_B - \\mu_A\\) 小的最大值。\n\n\n\n解 7.15. \n\nx &lt;- c(52, 64, 38, 68, 66, 52, 60, 44, 48, 46, 70, 62)\ny &lt;- c(36, 44, 41, 53, 38, 36, 34, 54, 52, 37, 51, 44, 35, 44)\nl &lt;- mean(x) - mean(y) - qnorm(.975) * sqrt(40 / 14 + 100 / 12) \nu &lt;- mean(x) - mean(y) + qnorm(.975) * sqrt(40 / 14 + 100 / 12) \nc(l,u)\n\n[1]  6.491114 19.604124\n\n\n因此，我们有 95% 的信心可以断言 \\(\\mu_B - \\mu_A \\in (6.491114, 19.604124)\\)。为了获得单边上置信区间，我们可以采用如下的 R 代码：\n\nx &lt;- c(52, 64, 38, 68, 66, 52, 60, 44, 48, 46, 70, 62)\ny &lt;- c(36, 44, 41, 53, 38, 36, 34, 54, 52, 37, 51, 44, 35, 44)\nu &lt;- mean(x) - mean(y) - qnorm(.95) * sqrt(40 / 14 + 100 / 12) \nu\n\n[1] 7.545227\n\n\n因此，我们有 95% 的信心认为 \\(\\mu_B - \\mu_A \\ge 7.545227\\)。\\(\\blacksquare\\)\n\n\n7.4.1 总体方差未知时 \\(\\mu_1 - \\mu_2\\) 的区间估计\n现在，我们希望再次对 \\(\\mu_1 - \\mu_2\\) 进行区间估计，但这次估计时的总体方差 \\(\\sigma_1^2\\) 和 \\(\\sigma_2^2\\) 均是未知的。在这种情况下，最直接的做法就是用 样本方差 来替换公式 式 7.5 中的总体方差 \\(\\sigma_1^2\\) 和 \\(\\sigma_2^2\\)：\n\\(\\begin{align} S_1^2 &= \\frac{\\sum_{i=1}^n (X_i - \\overline{X})^2}{n - 1} \\\\ S_2^2 &= \\frac{\\sum_{i=1}^m (Y_i - \\overline{Y})^2}{m - 1} \\end{align}\\)\n也就是说，此时的区间估计很自然地变为如下的形式：\n\\[\n\\frac{\\overline{X} - \\overline{Y} - (\\mu_1 - \\mu_2)}{\\sqrt{S_1^2/n + S_2^2/m}}\n\\tag{7.8}\\]\n然而，为了利用 式 7.8 计算置信区间，我们需要知道 式 7.8 的分布，并且该分布不能依赖于任何未知参数 \\(\\sigma_1^2\\) 和 \\(\\sigma_2^2\\)。不幸的是，这个分布既复杂又确实依赖于未知参数 \\(\\sigma_1^2\\) 和 \\(\\sigma_2^2\\)。事实上，只有在特殊情况下，即 \\(\\sigma_1^2 = \\sigma_2^2\\) 时，我们才能获得 \\(\\mu_1 - \\mu_2\\) 的区间估计。因此，虽然总体方差未知，但我们可以假设总体方差是一致的，并令 \\(\\sigma^2\\) 表示 \\(\\sigma_1^2\\) 和 \\(\\sigma_2^2\\) 的值。由 定理 6.2 得到：\n\\(\\begin{align} (n - 1)\\frac{S_1^2}{\\sigma^2} & \\sim \\chi^2_{n-1} \\\\ (m - 1)\\frac{S_2^2}{\\sigma^2} & \\sim \\chi^2_{m-1} \\end{align}\\)\n此外，由于样本是独立的，因此这两个卡方随机变量也是独立的。由卡方随机变量的可加性，独立卡方随机变量之和也是卡方分布，其自由度等于各卡方随机变量的自由度之和，因此有：\n\\[\n(n - 1)\\frac{S_1^2}{\\sigma^2} + (m - 1)\\frac{S_2^2}{\\sigma^2} \\sim \\chi^2_{n+m-2}\n\\tag{7.9}\\]\n同时，由于\n\\(\\overline{X} - \\overline{Y} \\sim \\mathcal{N}\\left(\\mu_1 - \\mu_2, \\frac{\\sigma^2}{n} + \\frac{\\sigma^2}{m}\\right)\\)\n我们可以得到：\n\\[\n\\frac{\\overline{X} - \\overline{Y} - (\\mu_1 - \\mu_2)}{\\sqrt{\\sigma^2/n + \\sigma^2/m}} \\sim \\mathcal{N}(0, 1)\n\\tag{7.10}\\]\n现在，根据 定理 6.2 中的基本结果，在正态分布抽样中，\\(\\overline{X}\\) 和 \\(S^2\\) 是独立的，所以 \\(X_1, S_1^2, X_2, S_2^2\\) 是独立的随机变量。因此，如果令：\n\\(S_p^2 = \\frac{(n-1)S_1^2 + (m-1)S_2^2}{n+m-2}\\)\n使用 \\(t\\) 随机变量的定义（小节 5.8.2，\\(t\\) 随机变量为两个独立随机变量的比值，其中分子为标准正态分布，分母为一个卡方随机变量除以其自由度的平方根），根据 式 7.9 和 式 7.10 可以得到：\n\\(\\frac{\\overline{X} - \\overline{Y} - (\\mu_1 - \\mu_2)}{\\sqrt{\\sigma^2 (1/n + 1/m)}} \\div \\sqrt{\\frac{S_p^2}{\\sigma^2}} = \\frac{\\overline{X} - \\overline{Y} - (\\mu_1 - \\mu_2)}{\\sqrt{S_p^2 (1/n + 1/m)}}\\)\n是自由度为 \\(n + m - 2\\) 的 \\(t-\\text{分布}\\) 随机变量。因此：\n\\(P\\left\\{ -t_{\\alpha/2, n+m-2} \\leq \\frac{\\overline{X} - \\overline{Y} - (\\mu_1 - \\mu_2)}{S_p \\sqrt{1/n + 1/m}} \\leq t_{\\alpha/2, n+m-2} \\right\\} = 1 - \\alpha\\)\n因此，当观察到样本数据后，令 \\(\\overline{X} = \\overline{x}\\)、\\(\\overline{Y} = \\overline{y}\\)、\\(S_p = s_p\\)，我们得到 \\(\\mu_1 - \\mu_2\\) 的 \\(100(1-\\alpha)\\%\\) 的置信区间：\n\\[\n\\left(\\overline{x} - \\overline{y} - t_{\\alpha/2, n+m-2} s_p \\sqrt{1/n + 1/m}, \\quad \\overline{x} - \\overline{y} + t_{\\alpha/2, n+m-2} s_p \\sqrt{1/n + 1/m}\\right)\n\\tag{7.11}\\]\n类似地，我们可以得到方差未知时 \\(\\mu_1 - \\mu_2\\) 的单边置信区间。\n\n习题 7.16 对于 习题 7.15 中的数据，如果两个样本的总体方差均未知、但是方差是相等的，计算 \\(\\mu_B - \\mu_A\\) 的 95% 的双边置信区间？\n\n\n解 7.16. \n\nx &lt;- c(52, 64, 38, 68, 66, 52, 60, 44, 48, 46, 70, 62)\ny &lt;- c(36, 44, 41, 53, 38, 36, 34, 54, 52, 37, 51, 44, 35, 44)\nsp &lt;- sqrt((11 * var(x) + 13 * var(y)) / 24)\nl &lt;- mean(x) - mean(y) - qt(0.975, 24) * sp * sqrt(1 / 12 + 1 / 14) \nu &lt;- mean(x) - mean(y) + qt(0.975, 24) * sp * sqrt(1 / 12 + 1 / 14) \nc(l,u)\n\n[1]  5.830952 20.264286\n\n\n\\(\\blacksquare\\)\n\n\n\n\n\n\n\n备注\n\n\n\n由 式 7.11 给出的置信区间是在假设总体方差相等的条件下的结果；假设抽样的总体的方差都是 \\(\\sigma^2\\)，则\n\\(\\frac{\\overline{X} - \\overline{Y} - (\\mu_1 - \\mu_2)}{\\sqrt{\\sigma^2/n + \\sigma^2/m}} = \\frac{\\overline{X} - \\overline{Y} - (\\mu_1 - \\mu_2)}{\\sigma\\sqrt{1/n + 1/m}}\\)\n服从标准正态分布。\n然而，由于 \\(\\sigma^2\\) 是未知的，因此不能直接使用上式来计算置信区间。为了计算置信区间，必须首先估计 \\(\\sigma^2\\)。同时，请注意，两个样本方差都是 \\(\\sigma^2\\) 的估计量。此外，由于 \\(S_1^2\\) 的自由度为 \\(n - 1\\)，\\(S_2^2\\) 的自由度为 \\(m - 1\\)，所以取这两个样本方差的估计量的加权平均值（权重与自由度成正比）作为 \\(\\sigma^2\\) 的估计量是合理的。也就是说，\\(\\sigma^2\\) 的估计量是 池化估计量（the pooled estimator）：\n\\(S_p^2 = \\frac{(n - 1)S_1^2 + (m - 1)S_2^2}{n + m - 2}\\)\n于是基于以下统计量计算置信区间：\n\\(\\frac{\\overline{X} - \\overline{Y} - (\\mu_1 - \\mu_2)}{\\sqrt{S_p^2\\left(1/n + 1/m\\right)}}\\)\n根据之前的分析，如上的统计量服从自由度为 \\(n + m - 2\\) 的 \\(t- \\text{分布}\\)。\n\n\n表 7.2 对本节的相关结论进行了总结。\n\n\n\n表 7.2: \\(\\mu_1 - \\mu_2\\) 的 \\(100(1 - \\alpha) \\%\\) 置信区间\n\n\n\n\n\n\n\n(a) \\(X_i\\)，\\(Y_i\\) 的分布\n\n\n\n\n\n\n\n\n\\(\\begin{align} & X_1, ..., X_n \\sim \\mathcal{N}(\\mu_1, \\sigma_1^2) \\\\ & Y_1, ..., Y_n \\sim \\mathcal{N}(\\mu_2, \\sigma_2^2) \\\\ & \\overline{X} = \\sum_{i=1}^{n}{X_i} / n, \\quad S_1^2 = \\sum_{i=1}^{n}{(X_i - \\overline{X})^2} / (n-1) \\\\ & \\overline{Y} = \\sum_{i=1}^{m}{Y_i} / n, \\quad S_2^2 = \\sum_{i=1}^{m}{(Y_i - \\overline{Y})^2} / (m-1)\\end{align}\\)\n\n\n\n\n\n\n\n\n\n\n\n\n\n(b) 双边置信区间\n\n\n\n\n\n\n\n\n\nAssumption\nConfidence Interval\n\n\n\n\n\\(\\sigma_1, \\sigma_2\\) 已知\n\\(\\overline{X} - \\overline{Y} \\pm z_{\\alpha/2} \\sqrt{\\sigma_1^2/n + \\sigma_2^2/m}\\)\n\n\n\\(\\sigma_1, \\sigma_2\\) 未知但相等\n\\(\\overline{X} - \\overline{Y} \\pm t_{\\alpha/2, n+m-2} \\sqrt{\\left(\\frac{1}{n} + \\frac{1}{m}\\right) \\frac{(n-1)S_1^2 + (m-1)S_2^2}{n+m-2}}\\)\n\n\n\n\n\n\n\n\n\n\n\n\n\n(c) 单边下置信区间\n\n\n\n\n\n\n\n\n\nAssumption\nLower Confidence Interval\n\n\n\n\n\\(\\sigma_1, \\sigma_2\\) 已知\n\\((-\\infty, \\overline{X} - \\overline{Y} + z_{\\alpha} \\sqrt{\\sigma_1^2/n + \\sigma_2^2/m})\\)\n\n\n\\(\\sigma_1, \\sigma_2\\) 未知但相等\n\\(\\left(-\\infty, \\overline{X} - \\overline{Y} + t_{\\alpha, n+m-2} \\sqrt{\\left(\\frac{1}{n} + \\frac{1}{m}\\right) \\frac{(n-1)S_1^2 + (m-1)S_2^2}{n+m-2}}\\right)\\)\n\n\n\n\n\n\n\n\n\n\n\n\n注意：\\(\\mu_1 - \\mu_2\\) 的单边上置信区间可以通过 \\(\\mu_2 - \\mu_1\\) 的单边下执行区间得到",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>参数估计</span>"
    ]
  },
  {
    "objectID": "chapter_7/7.html#sec-7_5",
    "href": "chapter_7/7.html#sec-7_5",
    "title": "7  参数估计",
    "section": "7.5 伯努利随机变量均值的近似置信区间",
    "text": "7.5 伯努利随机变量均值的近似置信区间\n考虑某个物品的一个总体，总体中每个物品达到某些标准的概率都是未知概率 \\(p\\)，并且物品之间的达标率是相互独立的。如果我们从总体中抽取 \\(n\\) 个物品进行测试，以确定这些物品是否达到标准，我们如何利用抽检所得到的数据来计算 \\(p\\) 的置信区间？\n如果我们令 \\(X\\) 表示抽取的 \\(n\\) 个物品中符合标准的物品数量，那么 \\(X\\) 是参数为 \\((n, p)\\) 的二项随机变量。因此，当 \\(n\\) 较大时，根据二项分布会近似为正态分布的特性（小节 6.3），\\(X\\) 近似服从均值为 \\(np\\)、方差为 \\(np(1-p)\\) 的正态分布。因此，\n\\[\n\\frac{X - np}{\\sqrt{np(1-p)}} \\approx \\mathcal{N}(0, 1)\n\\tag{7.12}\\]\n其中 \\(\\approx\\) 表示“近似服从”。因此，对于任何 \\(\\alpha \\in (0, 1)\\)，我们有：\n\\(P\\left\\{-z_{\\alpha/2} &lt; \\frac{X - np}{\\sqrt{np(1-p)}} &lt; z_{\\alpha/2}\\right\\} \\approx 1 - \\alpha\\)\n因此，如果对于实验数据 \\(X = x\\) 而言，\\(p\\) 的近似 \\(100(1-\\alpha)\\%\\) 置信区为：\n\\[\n\\left\\{p : -z_{\\alpha/2} &lt; \\frac{x - np}{\\sqrt{np(1-p)}} &lt; z_{\\alpha/2}\\right\\}\n\\tag{7.13}\\]\n然而，式 7.13 的区域并非区间。令 \\(\\hat{p} = X/n\\) 表示符合标准的物品所占的比例，以便得到 \\(p\\) 的置信区间。根据 习题 7.1 可知，\\(\\hat{p}\\) 是 \\(p\\) 的最大似然估计，因此 \\(\\hat{p}\\) 应该近似等于 \\(p\\)。因此，\\(\\sqrt{n\\hat{p}(1-\\hat{p})}\\) 将近似等于 \\(\\sqrt{np(1-p)}\\)，因此由 式 7.12 可以得到：\n\\(\\frac{X - np}{\\sqrt{n\\hat{p}(1-\\hat{p})}} \\approx \\mathcal{N}(0, 1)\\)\n因此，对于任何 \\(\\alpha \\in (0, 1)\\)，我们有：\n\\(P\\left\\{-z_{\\alpha/2} &lt; \\frac{X - np}{\\sqrt{n\\hat{p}(1-\\hat{p})}} &lt; z_{\\alpha/2}\\right\\} \\approx 1 - \\alpha\\)\n即，\n\\(P\\{-z_{\\alpha/2}\\sqrt{n\\hat{p}(1-\\hat{p})} &lt; np - X &lt; z_{\\alpha/2}\\sqrt{n\\hat{p}(1-\\hat{p})}\\} \\approx 1 - \\alpha\\)\n将上述不等式两边都除以 \\(n\\)，并根据 \\(\\hat{p} = X/n\\)，有：\n\\[\nP\\left\\{\\hat{p} - z_{\\alpha/2}\\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n}} &lt; p &lt; \\hat{p} + z_{\\alpha/2}\\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n}}\\right\\} \\approx 1 - \\alpha\n\\tag{7.14}\\]\n式 7.14 给出了 \\(p\\) 的 \\(100(1-\\alpha)\\%\\) 的近似置信区间。\n\n例 7.3 从一批晶体管中随机抽取 100 个样本，并测试这 100 个样本是否符合当前标准。如果其中有 80 个晶体管符合标准，那么符合标准的所有晶体管的比例 \\(p\\) 的近似 95% 置信区间为：\n\\((0.8 - 1.96 \\sqrt{\\frac{0.8(0.2)}{100}}, \\, 0.8 + 1.96 \\sqrt{\\frac{0.8(0.2)}{100}}) = (0.7216, \\, 0.8784)\\)\n也就是说，在 95% 的置信度的情况下，符合标准的晶体管的比例在 72.16% 到 87.84% 之间。\n\n\n习题 7.17 2013 年 8 月，《纽约时报》报道了最近的一项民意调查，结果显示 52% 的人（误差范围为 \\(\\pm 4\\%\\)）对奥巴马总统的工作表现呈肯定态度。这意味着什么？我们能推断出有多少人参与了调查吗？\n\n\n解 7.17. 新闻媒体通常会使用 95% 置信区间。由于 \\(z_{0.025} = 1.96\\)，令 \\(p\\) 代表肯定奥巴马总统工作表现的人的比例，那么关于 \\(p\\) 的 95% 置信区间可以表示为：\n\\(\\hat{p} \\pm 1.96 \\sqrt{\\frac{\\hat{p}(1 - \\hat{p})}{n}} = 0.52 \\pm 1.96 \\sqrt{\\frac{0.52 \\times 0.48}{n}}\\)\n其中，\\(n\\) 是样本的大小。由于“误差范围”是 \\(\\pm 4\\%\\)，由此可以推导出：\n\\(1.96 \\sqrt{\\frac{0.52 \\times 0.48}{n}} = 0.04\\)\n即：\n\\(n = \\frac{(1.96)^2 \\times 0.52 \\times 0.48}{(0.04)^2} = 599.29\\)\n也就是说，大约有 599 人参与了调查，其中 52% 的人对奥巴马总统的工作表现持肯定态度。 \\(\\blacksquare\\)\n\n我们经常希望为 \\(p\\) 指定一个近似的 \\(100(1 - \\alpha)\\%\\) 的置信区间，并且该置信区间的长度不能超过某个给定的值（\\(b\\)）。获得这样的、有大小限定的置信区间的问题在于确定合适的样本量 \\(n\\)。从样本大小为 \\(n\\) 的样本中得到的 \\(p\\) 的近似 \\(100(1 - \\alpha)\\%\\) 的置信区间的长度为：\n\\(2z_{\\alpha/2} \\sqrt{\\frac{\\hat{p}(1 - \\hat{p})}{n}}\\)\n该值近似等于 \\(2z_{\\alpha/2}\\sqrt{\\frac{p(1-p)}{n}}\\)。不幸的是，因为 \\(p\\) 是未知的，因此我们不能简单地令 \\(2z_{\\alpha/2}\\sqrt{\\frac{p(1-p)}{n}} = b\\)，然后再确定所需的样本量 \\(n\\)。然而，我们可以先进行一个初步的抽样，以获得 \\(p\\) 的粗略估计，然后利用该估计来确定 \\(n\\)。\n也就是说，我们使用初步抽样样本中的比例 \\(p^*\\) 作为 \\(p\\) 的初步估计；然后通过求解下列方程确定总样本量 \\(n\\)：\n\\(2z_{\\alpha/2} \\sqrt{\\frac{p^*(1 - p^*)}{n}} = b\\)\n对上式两边平方得到：\n\\((2z_{\\alpha/2})^2 \\frac{p^*(1 - p^*)}{n} = b^2\\)\n即：\n\\(n = \\frac{(2z_{\\alpha/2})^2 p^*(1 - p^*)}{b^2}\\)\n也就是说，如果最初抽取了 \\(k\\) 个样本以获得 \\(p\\) 的初步估计，那么还应再抽取 \\(n - k\\) 个样本。\n\n例 7.4 某芯片制造商生产的每个芯片的达标率为某个未知概率 \\(p\\)（假设芯片之间的达标率是相互独立的）。已经抽取了 30 个芯片的初步样本以便获得区间长度为 0.05 的 \\(p\\) 的近似 99% 置信区间。在抽取的 30 个芯片中，如果有 26 个芯片符合标准（达标），那么 \\(p\\) 的初步估计为 \\(26/30\\)。使用该值，得到长度为 0.05 的 99% 置信区间所需的样本量为：\n\\(n = \\frac{4(z_{0.005})^2 \\cdot \\frac{26}{30} \\left(1 - \\frac{26}{30}\\right)}{(0.05)^2} = \\frac{4(2.58)^2 \\cdot \\frac{26}{30} \\cdot \\frac{4}{30}}{(0.05)^2} = 1231\\)\n因此，我们现在应该再抽取 1201 个芯片，并且如果其中有 1040 个芯片是符合标准的，那么 \\(p\\) 的最终 99% 置信区间为：\n\\(\\left(\\frac{1066}{1231} - \\sqrt{\\frac{1066}{1231} \\left(1 - \\frac{1066}{1231}\\right)} \\cdot \\frac{z_{0.005}}{\\sqrt{1231}}, \\, \\frac{1066}{1231} + \\sqrt{\\frac{1066}{1231} \\left(1 - \\frac{1066}{1231}\\right)} \\cdot \\frac{z_{0.005}}{\\sqrt{1231}}\\right)\\)\n即：\n\\(p \\in (0.84091, 0.89101)\\) \\(\\blacksquare\\)\n\n\n\n\n\n\n\n备注\n\n\n\n如前所示，当样本量为\n\\(n = \\frac{(2z_{\\alpha/2})^2}{b^2} \\cdot p(1-p)\\)\n时，\\(p\\) 的 \\(100(1-\\alpha)\\%\\) 置信区间的长度将近似为 \\(b\\)。\n现在很容易证明，对于函数 \\(g(p) = p(1-p)\\)（定义域为：\\(0 \\leq p \\leq 1\\)）而言，当 \\(p = \\frac{1}{2}\\) 时，\\(g(p)\\) 取得最大值 \\(\\frac{1}{4}\\)。因此，\\(n\\) 的上界为\n\\(n \\leq \\frac{(z_{\\alpha/2})^2}{b^2}\\)\n因此，样本量至少为 \\(\\frac{(z_{\\alpha/2})^2}{b^2}\\) 时，可以确保在不需要任何额外的抽样的情况下，置信区间的长度不超过 \\(b\\)。\n\n\n表 7.3 对本节的内容进行了总结。\n\n\n\n表 7.3: \\(X \\sim \\mathcal{N}(n, p)\\)，\\(\\hat{p} = X/n\\)，\\(p\\) 的 \\(100(1-\\alpha)\\%\\) 的置信区间\n\n\n\n\n\n\n\n\n\n置信区间类型\n置信区间\n\n\n\n\n双边置信区间\n\\(\\hat{p} \\pm z_{\\alpha/2} \\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n}}\\)\n\n\n单边下置信区间\n\\(\\left(-\\infty, \\, \\hat{p} + z_{\\alpha} \\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n}}\\right)\\)\n\n\n单边上置信区间\n\\(\\left(\\hat{p} - z_{\\alpha} \\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n}}, \\, \\infty\\right)\\)",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>参数估计</span>"
    ]
  },
  {
    "objectID": "chapter_7/7.html#sec-7_6",
    "href": "chapter_7/7.html#sec-7_6",
    "title": "7  参数估计",
    "section": "7.6 Confidence interval of the mean of the exponential distribution \\(^*\\)",
    "text": "7.6 Confidence interval of the mean of the exponential distribution \\(^*\\)",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>参数估计</span>"
    ]
  },
  {
    "objectID": "chapter_7/7.html#sec-7_7",
    "href": "chapter_7/7.html#sec-7_7",
    "title": "7  参数估计",
    "section": "7.7 Evaluating a point estimator \\(^*\\)",
    "text": "7.7 Evaluating a point estimator \\(^*\\)",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>参数估计</span>"
    ]
  },
  {
    "objectID": "chapter_7/7.html#sec-7_8",
    "href": "chapter_7/7.html#sec-7_8",
    "title": "7  参数估计",
    "section": "7.8 The Bayes estimator \\(^*\\)",
    "text": "7.8 The Bayes estimator \\(^*\\)",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>参数估计</span>"
    ]
  },
  {
    "objectID": "chapter_7/7.html#problems",
    "href": "chapter_7/7.html#problems",
    "title": "7  参数估计",
    "section": "Problems",
    "text": "Problems",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>参数估计</span>"
    ]
  },
  {
    "objectID": "chapter_8/8.html",
    "href": "chapter_8/8.html",
    "title": "8  假设检验",
    "section": "",
    "text": "8.1 引言\n如前一章所述，假设我们从一个分布已知但参数未知的总体中抽取随机样本。现在，我们不想对未知参数进行明确的估计，而是更多的关注使用所得到的样本来检验关于这些参数的某个特定 假设（hypothesis）。举例来说，假设某建筑公司刚刚购买了一大批电缆，电缆厂家保证电缆的平均断裂强度至少为每平方英寸（per square inch: PSI） 7000 磅。为了验证电缆厂家的声明，该公司决定随机抽取其中的 10 根电缆以确定其断裂强度。然后，该公司将使用实验结果来确定是否接受电缆厂家声明的假设：总体上，电缆强度的平均值至少为 7000 PSI。\n统计假设（statistical hypothesis）通常是关于总体分布的一组参数的陈述。我们称之为 假设 是因为这一陈述的真实性尚不可知。一个主要问题是开发一个流程，以确定从总体中获取的随机样本的值是否与 假设 一致。例如，一个正态分布总体的均值 \\(\\theta\\) 未知、方差为 1。“\\(\\theta \\lt 1\\)” 就是一个 统计假设，我们可以通过观察来自该总体的随机样本来对该 假设 进行检验。如果随机样本与 假设 一致，我们将“接受”该 假设；否则，我们将“拒绝”该 假设。",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>假设检验</span>"
    ]
  },
  {
    "objectID": "chapter_8/8.html#sec-8_1",
    "href": "chapter_8/8.html#sec-8_1",
    "title": "8  假设检验",
    "section": "",
    "text": "注意\n\n\n\n务必注意，当我们接受一个给定的 假设 时，并不意味着我们实际上认为这个假设是真的，而是说结果数据与该 假设 看起来是一致的。\n例如，在 \\(\\mathcal{N}(\\theta，1)\\) 的正态分布总体中，如果大小为 10 的样本的均值为 1.25，那么虽然这样的结果不能视为支持 “\\(\\theta \\lt 1\\)” 的证据，但该结果与 假设 并不矛盾，因此我们将接受该 假设。\n另外，如果大小为 10 的样本的均值为 3，即使当 \\(\\theta \\lt 1\\) 时，这样的样本值是可能存在的，但出现这样的样本值是如此的不可能，以致于这似乎与 假设 并不一致，因此我们会拒绝该 假设。",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>假设检验</span>"
    ]
  },
  {
    "objectID": "chapter_8/8.html#sec-8_2",
    "href": "chapter_8/8.html#sec-8_2",
    "title": "8  假设检验",
    "section": "8.2 显著性水平",
    "text": "8.2 显著性水平\n考虑一个分布为 \\(F_{\\theta}\\) 的总体，其中 \\(\\theta\\) 是未知的。假设我们要检验关于 \\(\\theta\\) 的特定 假设，我们将此假设记为 \\(H_0\\)，并称之为 原假设（null hypothesis）。例如，如果 \\(F_{\\theta}\\) 是均值为 \\(\\theta\\)、方差为 1 的正态分布，那么关于 \\(\\theta\\) 的两个可能的 原假设 是：\n\n\\(H_0: \\theta = 1\\)\n\\(H_0: \\theta \\le 1\\)\n\n因此，第一个 假设 表明总体是均值为 1 且方差为 1 的正态分布，而第二个 假设 表明总体是方差为 1 且均值小于或等于 1 的正态分布。注意，第一个 原假设 为真时，完全确定了总体分布，而当第二个 原假设 为真时，则没有完全确定总体分布。如果一个 假设 为真可以完全确定总体分布，我们称这样的 假设 为 简单假设（simple hypothesis）；否则，我们称之为 复合假设（composite hypothesis）。\n假设现在为了检验特定的 原假设 \\(H_0\\)，我们将观察一个样本大小为 \\(n\\) 的总体样本——例如 \\(X_1, \\ldots, X_n\\)。基于这 \\(n\\) 个值，我们必须决定是否接受 \\(H_0\\)。可以通过在 \\(n\\) 维空间中定义一个区域 \\(C\\) 来指定 \\(H_0\\) 的检验：如果随机样本 \\(X_1, \\ldots, X_n\\) 位于 \\(C\\) 中，则拒绝 假设，否则接受 假设。该区域 \\(C\\) 称之为 临界区（critical region）。换句话说，由 临界区 \\(C\\) 确定的统计检验是：\n\n接受 \\(H_0\\)：如果 \\((X_1, X_2, \\ldots, X_n) \\notin C\\)\n拒绝 \\(H_0\\)：如果 \\((X_1, \\ldots, X_n) \\in C\\)\n\n例如，一个关于方差为 1 的正态分布的均值 \\(\\theta\\) 的常见假设——均值等于 1 的检验，其 临界区 由以下公式给出：\n\\[\nC = \\{(X_1, \\ldots, X_n) : |\\overline{X} - 1| &gt; 1.96 / \\sqrt{n}\\}\n\\tag{8.1}\\]\n因此，当样本均值与 1 的差值超过 1.96 除以样本大小的平方根时，则拒绝 \\(\\theta = 1\\) 的 原假设。\n\n\n\n\n\n\n注意\n\n\n\n重要的是，在任何检验中，可能会出现两种不同类型的错误。\n\n第一种错误，称之为 I 型错误，是指检验错误地拒绝了实际上正确的 \\(H_0\\)。\n第二种错误，称之为 II 型错误，是指检验错误地接受了实际上不正确的 \\(H_0\\)。\n\n\n\n如前所述，统计检验 \\(H_0\\) 的目标不是明确确定 \\(H_0\\) 是否为真，而是确定 \\(H_0\\) 是否与结果数据一致。因此，基于这个目标，合理的做法是：仅当 \\(H_0\\) 为真时，并且结果数据非常不可能出现时，才拒绝 \\(H_0\\)。传统的方法是指定一个值 \\(\\alpha\\) ，然后要求检验具有这样的性质：每当 \\(H_0\\) 为真时，\\(H_0\\) 被拒绝的概率绝不超过 \\(\\alpha\\)。这个 \\(\\alpha\\) 值，称之为 检验的显著性水平（level of significance of the test）。通常会预先设定检验的显著性水平，常用的值有 \\(\\alpha = 0.1, 0.05, 0.005\\)。\n换句话说，传统的检验 \\(H_0\\) 的方法是固定一个显著性水平 \\(\\alpha\\) ，然后要求检验具有这样的性质：发生 I 型错误 的概率绝不能超过 \\(\\alpha\\)。\n\\(\\theta\\) 是总体的一个未知参数，假设现在我们对检验一个关于 \\(\\theta\\) 的特定 假设 感兴趣。具体来说，对于给定的参数值集合 \\(w\\)，假设我们对如下的检验感兴趣：\n\\(H_0 : \\theta \\in w\\)\n在 \\(\\alpha\\) 下检验 \\(H_0\\) 的一种常见方法是，从确定 \\(\\theta\\) 的点估计量——记为 \\(d(\\mathbfit{X})\\) 开始。\n当 \\(d(\\mathbfit{X})\\) 远离区域 \\(w\\) 时，则拒绝 假设。然而，为了确定 \\(d(\\mathbfit{X})\\) 需要多远才能证明拒绝 \\(H_0\\) 是合理的，我们需要确定当 \\(H_0\\) 为真时 \\(d(\\mathbfit{X})\\) 的概率分布。因为这通常能帮助我们确定适当的 临界区，从而使检验达到所需的 显著性水平 \\(\\alpha\\)。例如，式 8.1 给出的参数为 \\((\\theta, 1)\\) 的总体均值等于 1 的假设检验，当 \\(\\theta\\) 的 点估计量——即样本均值——与 1 之间的距离超过 \\(1.96/\\sqrt{n}\\) 时，则拒绝 假设。正如我们将在 小节 8.3 中所讲述的，选择 \\(1.96/\\sqrt{n}\\) 是为了满足 显著性水平 \\(\\alpha = 0.05\\)。",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>假设检验</span>"
    ]
  },
  {
    "objectID": "chapter_8/8.html#sec-8_3",
    "href": "chapter_8/8.html#sec-8_3",
    "title": "8  假设检验",
    "section": "8.3 正态分布的均值检验",
    "text": "8.3 正态分布的均值检验\n\n8.3.1 方差 \\(\\sigma^2\\) 已知的场景\n\\(X_1, \\dots, X_n\\) 是从未知均值 \\(\\mu\\) 且方差为 \\(\\sigma^2\\) 的正态分布总体中抽取的大小为 \\(n\\) 的样本，假设我们要对以下的原假设进行检验：\n\\(\\begin{align} H_0: \\mu = \\mu_0 \\quad vs \\quad H_1: \\mu \\neq \\mu_0 \\end{align}\\)\n其中 \\(\\mu_0\\) 是某个特定的常数。\n由于 \\(\\overline{X} = \\frac{1}{n} \\sum_{i=1}^n X_i\\) 是 \\(\\mu\\) 的点估计量，因此如果 \\(\\overline{X}\\) 与 \\(\\mu_0\\) 相差不大，则接受 \\(H_0\\) 是合理的。也就是说，检验的 临界区 为：\n\\[\nC = \\{ X_1, \\dots, X_n : |\\overline{X} - \\mu_0| &gt; c \\}\n\\tag{8.2}\\]\n其中 \\(c\\) 为某个合适的值。\n如果我们要求检验的显著性水平为 \\(\\alpha\\)，我们必须确定 式 8.2 中的临界值 \\(c\\)，以使得 I 类错误等于 \\(\\alpha\\)。即，\\(c\\) 必须满足：\n\\[\nP_{\\mu_0}\\{ |\\overline{X} - \\mu_0| &gt; c \\} = \\alpha\n\\tag{8.3}\\]\n\\(P_{\\mu_0}\\) 表示我们在 \\(\\mu = \\mu_0\\) 的假设下计算 式 8.3 的概率。然而，当 \\(\\mu = \\mu_0\\) 时，\\(\\overline{X}\\) 将服从均值为 \\(\\mu_0\\) 且方差为 \\(\\sigma^2/n\\) 的正态分布，因此 式 8.4 定义的 \\(Z\\) 将服从标准正态分布。\n\\[\nZ \\equiv \\frac{\\overline{X} - \\mu_0}{\\sigma/\\sqrt{n}} = \\sqrt{n} \\frac{(\\overline{X} - \\mu_0)}{\\sigma}\n\\tag{8.4}\\]\n于是，式 8.3 等价于：\n\\(P\\left\\{ |Z| &gt; \\frac{c \\sqrt{n}}{\\sigma} \\right\\} = \\alpha\\)\n即：\n\\(2P\\left\\{ Z &gt; \\frac{c \\sqrt{n}}{\\sigma} \\right\\} = \\alpha\\)\n其中 \\(Z\\) 是标准正态分布随机变量。然而，我们知道\n\\(P\\{ Z &gt; z_{\\alpha/2} \\} = \\alpha/2\\)\n因此：\n\\(\\frac{c \\sqrt{n}}{\\sigma} = z_{\\alpha/2}\\)\n即：\n\\(c = \\frac{z_{\\alpha/2} \\sigma}{\\sqrt{n}}\\)\n因此，显著性水平为 \\(\\alpha\\) 的检验为：\n\n如果 \\(\\frac{\\sqrt{n}}{\\sigma} |\\overline{X} - \\mu_0| &gt; z_{\\alpha/2}\\)，则拒绝 \\(H_0\\)；\n否则，接受 \\(H_0\\)。\n\n\\[\n\\begin{align}\n\\text{拒绝} H_0 &: \\quad \\frac{\\sqrt{n}}{\\sigma} |\\overline{X} - \\mu_0| &gt; z_{\\alpha/2} \\\\\n\\text{接受} H_0 &: \\quad \\frac{\\sqrt{n}}{\\sigma} |\\overline{X} - \\mu_0| \\le z_{\\alpha/2}\n\\end{align}\n\\tag{8.5}\\]\n可以通过图 图 8.1 来直观地表示 式 8.5，在 图 8.1 中，我们叠加了标准正态分布的概率密度函数（即当 \\(H_0\\) 成立时，统计量 \\(\\sqrt{n}(\\overline{X} - \\mu_0)/\\sigma\\) 的概率密度）。\n\n\n代码\nlibrary(latex2exp)\nlibrary(ggplot2)\n\nx &lt;- seq(-3, 3, 0.01) \ny &lt;- dnorm(x)\ndf &lt;- data.frame(x=x, y=y)\n\nggplot(df, aes(x=x, y=y)) + \n  geom_line() + \n  geom_segment(x=-1.96, y=dnorm(-1.96) * 1.5, xend=-1.96, yend=0) +\n  geom_segment(x=1.96, y=dnorm(1.96) * 1.5, xend=1.96, yend=0) + \n  geom_segment(x=-1.96, y=dnorm(-1.96) * 1.3, xend=1.96, yend=dnorm(1.96) * 1.3, \n               arrow = arrow(ends = \"both\", type = \"closed\", length = unit(0.1, \"inches\"))) + \n  annotate(\"text\", x = -1.86, y = -0.01, label = TeX(\"$-z_{\\\\alpha/2}$\"), hjust = 1, vjust = 0, size = 3) +\n  annotate(\"text\", x = 2.06, y = -0.01, label = TeX(\"$z_{\\\\alpha/2}$\"), hjust = 1, vjust = 0, size = 3) +\n  annotate(\"text\", x = 0.15, y = dnorm(-1.96) * 1.4, label = \"Accept\", hjust = 1, vjust = 0, size = 3) +\n  theme_minimal() + \n  theme(axis.text = element_blank(),axis.title = element_blank())\n\n\n\n\n\n\n\n\n图 8.1\n\n\n\n\n\n\n习题 8.1 与 习题 7.7 类似，假设从 A 地发射一个信号 \\(\\mu\\) 到 B 地，在 B 接收到的信号的值服从均值为 \\(\\mu\\)、方差为 4 的正态分布。也就是说，B 地接收到的信号会加入随机噪声、并且该随机噪声是服从 \\(\\mathcal{N}(0, 4)\\) 的随机变量。现在，B 地的人怀疑今天 A 地发送的信号值为 \\(\\mu = 8\\)。假设 A 地独立发送了 5 次该信号，且在 B 地接收到的信号的平均值为 \\(\\overline{X} = 9.5\\)。请对 今天 A 地发送的信号值为 \\(\\mu = 8\\)  这一假设进行检验。\n\n\n习题 8.2 假设我们在 5% 的显著性水平下进行检验。首先，计算检验统计量：\n\\(\\frac{\\sqrt{n}}{\\sigma} |\\overline{X} - \\mu_0| = \\frac{\\sqrt{5}}{2} (1.5) = 1.68\\)\n由于 1.68 小于 \\(z_{0.025} = 1.96\\)，因此应该接受该假设。换句话说，因为当 A 地发射的信号真的为 8 时，那么会有 5% 的可能性发生像我们观察到的样本平均值偏离 8 的这种情况，但是这个比例并没有达到足以令我们拒绝原假设，所以观察到的数据与原假设并不矛盾。但是，如果我们选择了更不严格的显著性水平——比如 \\(\\alpha = 0.1\\)，此时，因为 1.68 大于 \\(z_{0.05} = 1.645\\)，那么我们将拒绝原假设。因此，如果我们选择了 10% 的概率会错误的拒绝原假设的情况下（第 I 类错误），那么我们将拒绝原假设。\n选择合适的显著性水平（\\(\\alpha\\)）并不是一个一成不变的标准，而是需要根据具体情况进行调整。例如，如果错误的拒绝实际为真的原假设 \\(H_0\\) 会导致巨大损失，那么我们可能会选择非常保守的显著性水平，此时可以选择 0.05 或 0.01 的显著性水平。此外，如果我们一开始就非常相信 \\(H_0\\) 是正确的，那么我们就需要设置一个非常严格的标准并要求有强有力的数据证据才能认为 \\(H_0\\) 是错误的。也就是说，在这种情况下，我们通常需要设置一个非常低的显著性水平（例如 0.01 或者更低）。\\(\\blacksquare\\)\n\n式 8.5 给出的 检验 的描述如下：对于检验统计量 \\(\\sqrt{n}|\\overline{X} - \\mu_0|/\\sigma\\) 的任何观测值——我们称其为 \\(v\\)——当 \\(H_0\\) 成立时，如果检验统计量大于或等于 \\(v\\) 的概率小于或等于显著性水平 \\(\\alpha\\)，则 检验 说明需要拒绝原假设 \\(H_0\\)。\n由此，我们可以通过以下步骤来确定是否接受原假设 \\(H_0\\)：\n\n首先，计算检验统计量的值 \\(v\\)；\n其次，计算标准正态分布（取绝对值）的概率，即标准正态分布中大于 \\(v\\) 的概率，我们称这一概率为检验的 \\(p-\\text{value}\\)。\\(p-\\text{value}\\) 给出了临界显著性水平的意义，即如果 \\(p-\\text{value}\\) 大于显著性水平 \\(\\alpha\\)，则接受 \\(H_0\\)；如果 \\(p-\\text{value}\\) 小于或等于显著性水平 \\(\\alpha\\)，则拒绝 \\(H_0\\)。\n\n在实际操作中，显著性水平往往不是预先设定的，而是会首先通过观察数据来确定 \\(p-\\text{value}\\)。\n\n有时，\\(p-\\text{value}\\) 会明显大于我们愿意使用的任何显著性水平，因此我们可以非常轻松的就接受原假设 \\(H_0\\)。\n而有时，\\(p-\\text{value}\\) 值又非常小（甚至小于任何我们会使用到的显著性水平），因此显然我们应该拒绝该假设。\n\n\n例 8.1 在 习题 8.2 中，假设接收到的 5 个值的平均值为 \\(\\overline{X} = 8.5\\)。在这种情况下，\n\\(\\frac{\\sqrt{n}}{\\sigma} |\\overline{X} - \\mu_0| = \\frac{\\sqrt{5}}{4} = 0.559\\)\n因为\n\\(P\\{|Z| &gt; 0.559\\} = 2P\\{Z &gt; 0.559\\}= 2 \\times 0.288 = 0.576\\)\n所以 \\(p-\\text{value}\\) 为 0.576，因此信号值为 8 的原假设在任何显著性水平 \\(\\alpha &lt; 0.576\\) 下都将被接受。显然，我们绝不会使用一个高达 0.576 的显著性水平来检验原假设，因此我们将接受 \\(H_0\\)。\n另一方面，如果数据的平均值为 11.5，则检验均值为 8 的 \\(p-\\text{value}\\) 值将为\n\\(P\\{|Z| &gt; 1.75\\sqrt{5}\\} = P\\{|Z| &gt; 3.913\\} \\approx 0.00005\\)\n对于如此小的\\(p-\\text{value}\\)，我们将拒绝信号值为 8 的原假设。\\(\\blacksquare\\)\n\n到现在为止，我们还没有讨论过 第 II 类错误 的概率——也就是在真实均值 \\(\\mu\\) 不等于 \\(\\mu_0\\) 时错误的接受原假设的概率。第 II 类错误 的概率取决于 \\(\\mu\\) 的值，因此我们定义 \\(\\beta(\\mu)\\) 如下：\n\\(\\begin{align}\\beta(\\mu) &= P_\\mu\\{\\text{接受 } H_0\\} \\\\ &=P_{\\mu}\\left\\{\\left|\\frac{\\overline{X}-\\mu_0}{\\sigma/\\sqrt{n}}\\right| \\le z_{\\alpha/2}\\right\\} \\\\ &=P_{\\mu}\\left\\{-z_{\\alpha/2} \\le \\frac{\\overline{X}-\\mu_0}{\\sigma/\\sqrt{n}}\\le z_{\\alpha/2}\\right\\} \\end{align}\\)\n我们称函数 \\(\\beta(\\mu)\\) 为 Operating Characteristic（OC）Curve，\\(\\beta(\\mu)\\) 表示当真实均值为 \\(\\mu\\) 时接受原假设 \\(H_0\\) 的概率。\n为了计算这个概率，我们使用 \\(\\overline{X}\\) 服从均值为 \\(\\mu\\)、方差为 \\(\\sigma^2/n\\) 的正态分布的事实，因此\n\\(Z \\equiv \\frac{\\overline{X} - \\mu}{\\sigma/\\sqrt{n}} \\sim \\mathcal{N}(0, 1)\\)\n因此，\n\\[\n\\begin{align}\n\\beta(\\mu) &= P_\\mu\\left\\{-z_{\\alpha/2} \\leq \\frac{\\overline{X} - \\mu_0}{\\sigma/\\sqrt{n}} \\leq z_{\\alpha/2}\\right\\} \\\\\n&= P_\\mu\\left\\{-z_{\\alpha/2} \\leq \\frac{\\overline{X} - \\mu + \\mu - \\mu_0}{\\sigma/\\sqrt{n}} \\leq z_{\\alpha/2}\\right\\} \\\\\n&= P_\\mu\\left\\{-z_{\\alpha/2} - \\frac{\\mu}{\\sigma / \\sqrt{n}} \\leq \\frac{\\overline{X} - \\mu - \\mu_0}{\\sigma/\\sqrt{n}} \\leq z_{\\alpha/2} -  \\frac{\\mu}{\\sigma / \\sqrt{n}} \\right\\} \\\\\n&= P_\\mu\\left\\{ -z_{\\alpha/2} - \\frac{\\mu}{\\sigma / \\sqrt{n}} \\leq Z - \\frac{\\mu_0}{\\sigma/\\sqrt{n}} \\leq z_{\\alpha/2} -  \\frac{\\mu}{\\sigma / \\sqrt{n}} \\right\\} \\\\\n&= P\\left\\{\\frac{\\mu_0 - \\mu}{\\sigma / \\sqrt{n}} - z_{\\alpha/2} \\le Z \\le \\frac{\\mu_0 - \\mu}{\\sigma / \\sqrt{n}} + z_{\\alpha/2}\\right\\} \\\\\n&= \\Phi\\left(\\frac{\\mu_0 - \\mu}{\\sigma/\\sqrt{n}} + z_{\\alpha/2}\\right) - \\Phi\\left(\\frac{\\mu_0 - \\mu}{\\sigma/\\sqrt{n}} - z_{\\alpha/2}\\right)\n\\end{align}\n\\tag{8.6}\\]\n其中 \\(\\Phi\\) 是标准正态分布函数。\n对于固定的显著性水平 \\(\\alpha\\)，由 式 8.6 给出的 OC 曲线是关于 \\(\\mu_0\\) 对称的，并且实际上仅通过 \\(\\sqrt{n}|\\mu - \\mu_0|/\\sigma\\) 而依赖于 \\(\\mu\\)。当 \\(\\alpha = 0.05\\) 时，这条曲线的横坐标由 \\(\\mu\\) 改为 \\(d = \\sqrt{n}|\\mu - \\mu_0|/\\sigma\\)，并且曲线如 图 8.2 所示。\n\n\n代码\nlibrary(ggplot2)\n\n# β(μ) 的计算函数\ncalculate_beta &lt;- function(mu, mu0, sigma, n, alpha) {\n  z_alpha = qnorm(1 - alpha / 2)\n  d = sqrt(n) * (mu0 - mu) / sigma\n  beta = pnorm(d + z_alpha) - pnorm(d - z_alpha)\n  return(beta)\n}\n\n# 参数设置\nmu0 &lt;- 0        # 原假设的均值\nsigma &lt;- 3      # 标准差\nn &lt;- 10         # 样本大小\nalpha &lt;- 0.05   # 显著性水平\n\n# 生成一系列 μ 的值\nmu_values &lt;- seq(-5, 5, by = 0.1)\n\n# 计算每个 μ 对应的 β(μ)\nbeta_values &lt;- sapply(mu_values, calculate_beta, mu0 = mu0, sigma = sigma, n = n, alpha = alpha)\nd &lt;- sqrt(n) / sigma * abs(mu0 - mu_values)\n\n# 创建数据框用于绘图\ndf &lt;- data.frame(mu = mu_values, d = d, beta = beta_values)\n\n# 绘制 OC 曲线\nggplot(df, aes(x = d, y = beta)) +\n  geom_line() +\n  scale_x_continuous(limits = c(0, 5)) + \n  scale_y_continuous(limits = c(0, 1), breaks = seq(0, 1, 0.2)) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n图 8.2: 显著性水平位 0.05 时双边正态分布检验的 OC 曲线图\n\n\n\n\n\n\n例 8.2 对于 习题 8.2 中的问题，当实际发送的值为 10 时，计算接受原假设 \\(\\mu = 8\\) 的概率？\n\n# β(μ) 的计算函数\ncalculate_beta &lt;- function(mu, mu0, sigma, n, alpha) {\n  z_alpha = qnorm(1 - alpha / 2)\n  d = sqrt(n) * (mu0 - mu) / sigma\n  beta = pnorm(d + z_alpha) - pnorm(d - z_alpha)\n  return(beta)\n}\n\np &lt;- calculate_beta(10, 8, 2, 5, 0.05)\np\n\n[1] 0.3912205\n\n\n\\(\\blacksquare\\)\n\n\n\n\n\n\n\n备注\n\n\n\n我们称 \\(1 - \\beta(\\mu)\\) 为 检验功效函数（power-function of the test）。因此，对于给定的 \\(\\mu\\) 值，检验功效 等于当 \\(\\mu\\) 为真实值时拒绝原假设的概率。\n\n\n在确定所需的随机样本大小以满足我们对 第 II 类错误 的某些特定要求的场景下，Operating Characteristic 函数非常有用。例如，假设我们希望确定所需的样本大小 \\(n\\)，以确保当真实均值实际上为 \\(\\mu_1\\) 时，接受原假设 \\(H_0: \\mu = \\mu_0\\) 的概率大约为 \\(\\beta\\)。也就是说，我们希望找到 \\(n\\) 使得：\n\\(\\beta(\\mu_1) \\approx \\beta\\)\n但是，根据 式 8.6，我们可以推导出，如上的式子等价于\n\\[\n\\Phi \\left(\\frac{\\sqrt{n}(\\mu_0 - \\mu_1)}{\\sigma} + z_{\\alpha/2}\\right) - \\Phi \\left(\\frac{\\sqrt{n}(\\mu_0 - \\mu_1)}{\\sigma} - z_{\\alpha/2}\\right) \\approx \\beta \\quad\n\\tag{8.7}\\]\n尽管无法直接对 式 8.7 进行求解并得到 \\(n\\)，但可以使用标准正态分布表来求解得到 \\(n\\)。此外，还可以通过 式 8.7 推导出 \\(n\\) 的近似值 式 8.9。\n首先，假设 \\(\\mu_1 &gt; \\mu_0\\)，于是这意味着：\n\\(\\frac{\\sqrt{n}(\\mu_0 - \\mu_1)}{\\sigma} - z_{\\alpha/2} \\leq -z_{\\alpha/2}\\)\n由于 \\(\\Phi\\) 是一个递增函数，因此：\n\\(\\Phi \\left(\\frac{\\sqrt{n}(\\mu_0 - \\mu_1)}{\\sigma} - z_{\\alpha/2}\\right) \\leq \\Phi(-z_{\\alpha/2}) = P\\{Z \\leq -z_{\\alpha/2}\\} = P\\{Z \\geq z_{\\alpha/2}\\} = \\alpha/2\\)\n因此，我们可以取\n\\(\\Phi \\left(\\frac{\\sqrt{n}(\\mu_0 - \\mu_1)}{\\sigma} - z_{\\alpha/2}\\right) \\approx 0\\)\n根据 式 8.7 可以得到：\n\\[\n\\beta \\approx \\Phi \\left(\\frac{\\sqrt{n}(\\mu_0 - \\mu_1)}{\\sigma} + z_{\\alpha/2}\\right)\n\\tag{8.8}\\]\n或者，由于\n\\(\\beta = P\\{Z &gt; z_{\\beta}\\} = P\\{Z &lt; -z_{\\beta}\\} = \\Phi(-z_{\\beta})\\)\n根据 式 8.8 得到：\n\\(-z_{\\beta} \\approx \\frac{\\sqrt{n}(\\mu_0 - \\mu_1)}{\\sigma} + z_{\\alpha/2}\\)\n即：\n\\[\nn \\approx \\frac{(z_{\\alpha/2} + z_{\\beta})^2 \\sigma^2}{(\\mu_1 - \\mu_0)^2}\n\\tag{8.9}\\]\n事实上，当 \\(\\mu_1 &lt; \\mu_0\\) 时，我们会得到近似相同的结果（留作习题），因此，在任何情况下 式 8.9 都是如下场景的一个合理的近似值：\n\n估计所需的样本大小，以确保当真实均值为 \\(\\mu = \\mu_1\\) 时，第 II 类错误 的概率大约等于 \\(\\beta\\)。\n\n\n习题 8.3 对于 习题 8.2 的问题，在 0.05 的显著性水平下，当 \\(\\mu\\) 实际为 9.2 时，需要发送多少次信号才能使得原假设 \\(H_0: \\mu = 8\\) 至少有 75% 的概率被拒绝？\n\n\n解 8.1. 由于 \\(z_{.025} = 1.96\\)，\\(z_{0.25} = .67\\)，根据 式 8.9 有：\n\\(n \\approx \\frac{(1.96 + 0.67)^2}{(1.2)^2} 4 \\approx 19.21\\)\n因此需要一个大小为 20 的样本。\n根据方程 式 8.6，当 \\(n = 20\\) 时，\n\\(\\begin{align} \\beta(9.2) &= \\Phi \\left(-\\frac{1.2\\sqrt{20}}{2} + 1.96\\right) - \\Phi \\left(-\\frac{1.2\\sqrt{20}}{2} - 1.96\\right) \\\\ & \\approx \\Phi(-0.723) - \\Phi(-4.643) \\\\ & \\approx 1 - \\Phi(0.723) \\\\ & \\approx 0.235 \\end{align}\\)\n\n# β(μ) 的计算函数\ncalculate_beta &lt;- function(mu, mu0, sigma, n, alpha) {\n  z_alpha = qnorm(1 - alpha / 2)\n  d = sqrt(n) * (mu0 - mu) / sigma\n  beta = pnorm(d + z_alpha) - pnorm(d - z_alpha)\n  return(beta)\n}\n\np &lt;- calculate_beta(9.2, 8, 2, 20, 0.05)\np\n\n[1] 0.2347407\n\n\n因此，如果发送消息 20 次，那么当真实均值为 9.2 时，有 76.5% 的概率会拒绝原假设 \\(\\mu = 8\\)。\\(\\blacksquare\\)\n\n\n8.3.1.1 单边检验\n在检验原假设 \\(\\mu = \\mu_0\\) 时，我们选择了一种检验以使得在 \\(\\overline{X}\\) 远离 \\(\\mu_0\\) 时拒绝原假设。也就是说，和 \\(\\mu_0\\) 相比，\\(\\overline{X}\\)（\\(\\mu\\) 的估计量）的一个非常小的值或非常大的值似乎使得 \\(\\mu\\) 不可能等于 \\(\\mu_0\\)。然而，当 \\(\\mu\\) 等于 \\(\\mu_0\\) 的唯一 备择假设 是 \\(\\mu &gt; \\mu_0\\) 时会发生什么呢？也就是说，当 备择假设 为 \\(H_1: \\mu &gt; \\mu_0\\) 时会发生什么？显然，此时，在 \\(\\overline{X}\\) 很小（与 \\(\\mu\\) 相比）时，\\(H_0\\) 为真比 \\(H_1\\) 为真更有可能发生。因此，此时，我们不希望拒绝 \\(H_0\\)。\n因此，对于 式 8.10 的检验\n\\[\nH_0: \\mu = \\mu_0 \\quad vs. \\quad H_1: \\mu &gt; \\mu_0\n\\tag{8.10}\\]\n当 \\(\\mu_0\\) 的点估计 \\(\\overline{X}\\) 远大于 \\(\\mu_0\\) 时，我们应该拒绝 \\(H_0\\)。这意味着，临界区 应如下所示：\n\\(C = \\{(X_1, \\dots, X_n) : \\overline{X} - \\mu_0 &gt; c\\}\\)\n由于当 \\(H_0\\) 为真时，拒绝原假设的概率应该等于 \\(\\alpha\\)，因此 \\(c\\) 需要满足：\n\\[\nP_{\\mu_0}\\{\\overline{X} - \\mu_0 &gt; c\\} = \\alpha\n\\tag{8.11}\\]\n当 \\(H_0\\) 为真时，\\(Z\\) 服从标准正态分布：\n\\(Z = \\frac{\\overline{X} - \\mu_0}{\\sigma/\\sqrt{n}} = \\sqrt{n}\\frac{(\\overline{X} - \\mu_0)}{\\sigma}\\)\n所以，式 8.11 等价于：\n\\(P\\left\\{Z &gt; \\frac{c\\sqrt{n}}{\\sigma}\\right\\} = \\alpha\\)\n由于\n\\(P\\{Z &gt; z_{\\alpha}\\} = \\alpha\\)\n所以有：\n\\[\nc = \\frac{z_{\\alpha}\\sigma}{\\sqrt{n}}\n\\tag{8.12}\\]\n因此，假设 式 8.10 的检验是当 \\(\\overline{X} - \\mu_0 &gt; z_{\\alpha} \\sigma / \\sqrt{n}\\) 时拒绝 \\(H_0\\)，否则接受 \\(H_0\\)。即：\n\\[\n\\begin{align}\n&\\text{接受} \\ H_0 \\quad \\text{如果} \\frac{\\sqrt{n}}{\\sigma} (\\overline{X} - \\mu_0) \\leq z_{\\alpha} \\\\\n&\\text{拒绝} \\ H_0 \\quad \\text{如果} \\frac{\\sqrt{n}}{\\sigma} (\\overline{X} - \\mu_0) \\gt z_{\\alpha} \\\\\n\\end{align}\n\\tag{8.13}\\]\n因为仅在 \\(\\overline{X}\\) 较大时才会拒绝原假设，所以 式 8.13 称之为 单边临界区域（one-sided critical region）。相应地，与 备择假设 为 \\(H_1: \\mu \\neq \\mu_0\\) 的双边检验问题相比，式 8.14 所示的假设检验问题也称之为 单边检验问题。\n\\[\n\\begin{align}\nH_0: &\\mu = \\mu_0 \\\\\nH_1: & \\mu &gt; \\mu_0\n\\end{align}\n\\tag{8.14}\\]\n为了计算 单边检验 中的 \\(p-\\text{value}\\)，我们\n\n首先使用观测数据确定统计量 \\(\\frac{\\sqrt{n}(\\overline{X} - \\mu_0)}{\\sigma}\\) 的值。\n然后，\\(p-\\text{value}\\) 等于标准正态分布中大于等于该值的概率。\n\n\n习题 8.4 假设在 习题 8.2 中，我们预先知道信号值至少是 8，那么在这种情况下可以得出什么结论？\n\n\n解 8.2. 为了判断观察到的数据是否与均值为 8 的假设一致，我们做如下的检验：\n\\(\\begin{align}H_0: &\\mu = 8 \\\\ H_1: &\\mu &gt; 8 \\end{align}\\)\n单边检验统计量的值为：\n\\(\\sqrt{n} \\frac{(\\overline{X} - \\mu_0)}{\\sigma} = \\sqrt{5} \\frac{(9.5 - 8)}{2} = 1.68\\)\n并且 \\(p-\\text{value}\\) 为标准正态分布超过 1.68 的概率，即\n\\(p-\\text{value} = 1 - \\Phi(1.68) = 0.0465\\)\n该检验将在所有大于或等于 0.0465 的显著性水平下拒绝原假设。例如，如果显著性水平 \\(\\alpha = 0.05\\)，那么我们将拒绝原假设。 \\(\\blacksquare\\)\n\n式 8.13 所示的单边检验的 Operating Characteristic 函数 \\(\\beta(\\mu) = P_{\\mu}\\{\\text{接受} H_0\\}\\) 为：\n\\(\\begin{align} \\beta(\\mu) &= P_{\\mu}\\left\\{ \\overline{X} \\leq \\mu_0 + z_{\\alpha}\\frac{\\sigma}{\\sqrt{n}} \\right\\} \\\\ &= P\\left\\{ \\frac{\\sqrt{n}(\\overline{X} - \\mu_0)}{\\sigma} \\leq \\frac{\\sqrt{n}(\\mu_0 - \\mu)}{\\sigma} + z_{\\alpha} \\right\\} \\\\ &= P\\left\\{ Z \\leq \\frac{\\sqrt{n}(\\mu_0 - \\mu)}{\\sigma} + z_{\\alpha} \\right\\}, \\quad Z \\sim N(0, 1) \\end{align}\\)\n即：\n\\(\\beta(\\mu) = \\Phi \\left( \\frac{\\sqrt{n}(\\mu_0 - \\mu)}{\\sigma} + z_{\\alpha} \\right)\\)\n由于 \\(\\Phi\\) 是概率分布函数，因此 \\(\\Phi\\) 随着自变量的增加而递增，所以从直觉而言：\\(\\beta(\\mu)\\) 随 \\(\\mu\\) 的增加而减少是合理的。显然，当真实均值 \\(\\mu\\) 越大时，\\(\\mu \\leq \\mu_0\\) 的可能性就越小。此外，由于 \\(\\Phi(z_{\\alpha}) = 1 - \\alpha\\)，因此\n\\(\\beta(\\mu_0) = 1 - \\alpha\\)\n最初用于检验 \\(H_0: \\mu = \\mu_0 \\ vs. \\ H_1: \\mu &gt; \\mu_0\\) 的 式 8.13 也可以用于：在显著性水平 \\(\\alpha\\) 下，如下假设的单边检验：\n\\[\nH_0: \\mu \\leq \\mu_0 \\quad vs. \\quad H_1: \\mu &gt; \\mu_0\n\\tag{8.15}\\]\n为了验证它仍然是在显著性水平为 \\(\\alpha\\) 下的检验，我们需要证明：当 \\(H_0\\) 为真时，拒绝原假设的概率不超过 \\(\\alpha\\)。也就是说，我们必须验证：\n\\(1 - \\beta(\\mu) \\leq \\alpha , \\quad \\quad \\forall \\mu \\leq \\mu_0\\)\n或者\n\\(\\beta(\\mu) \\geq 1 - \\alpha , \\quad \\quad \\forall \\mu \\leq \\mu_0\\)\n之前已经证明，对于由方程 式 8.13 给出的检验，\\(\\beta(\\mu)\\) 随 \\(\\mu\\) 的增加而减少，且 \\(\\beta(\\mu_0) = 1 - \\alpha\\)。于是：\n\\(\\beta(\\mu) \\geq \\beta(\\mu_0) = 1 - \\alpha , \\quad \\quad \\forall \\mu \\leq \\mu_0\\)\n这表明由 式 8.13 给出的检验在显著性水平 \\(\\alpha\\) 下，对 \\(H_0: \\mu \\leq \\mu_0 \\quad vs. \\quad H_1: \\mu &gt; \\mu_0\\) 仍然是一个 显著性水平为 \\(\\alpha\\) 的检验。\n\n\n\n\n\n\n备注\n\n\n\n我们还可以在在显著性水平 \\(\\alpha\\) 下对如下的假设\n\\(H_0: \\mu = \\mu_0 \\quad (\\text{或} \\quad \\mu \\geq \\mu_0) \\quad vs \\quad H_1: \\mu &lt; \\mu_0\\)\n做出如下的单边检验：\n\\(\\begin{align} \\text{接受 } H_0, & \\quad \\text{如果} \\quad \\frac{\\sqrt{n}}{\\sigma}(\\overline{X} - \\mu_0) \\geq -z_{\\alpha} \\\\ \\text{拒绝 } H_0, & \\quad \\text{其他} \\end{align}\\)\n可以通过首先计算检验统计量 \\(\\frac{\\sqrt{n}(\\overline{X} - \\mu_0)}{\\sigma}\\) 来进行该检验。\\(p-\\text{value}\\) 等于标准正态分布小于 \\(\\frac{\\sqrt{n}(\\overline{X} - \\mu_0)}{\\sigma}\\) 的概率，当 \\(p-\\text{value}\\) 小于任何的显著性水平时，我们将拒绝原假设。\n\n\n\n习题 8.5 目前，市场上的所有香烟的平均尼古丁含量至少为 1.6 毫克/支。一家生产香烟的公司声称，他们发现了一种新的烟草叶处理方法，这种方法会使香烟的平均尼古丁含量低于 1.6 毫克/支。为了测试这家公司的这一说法，我们分析了该公司的 20 支香烟的样本。已知一支香烟的尼古丁含量的标准差为 0.8 毫克，如果 20 支香烟的平均尼古丁含量为 1.54/支，那么在显著性水平为 5% 的情况下，可以得出什么结论？\n注意：如上问题中有一个问题，即我们如何事先知道标准差为 0.8。一个可能性是，香烟尼古丁含量的变化源自每支香烟中的烟草量的变化，而不是使用的处理方法。因此，可以从以往的经验中得知香烟中尼古丁含量的标准差。\n\n\n解 8.3. 我们必须首先确定适当的原假设。如前所述，我们的检验方法在对原假设和备择假设的处理上是不对称的，因为我们只考虑那些在原假设为真时拒绝原假设的概率永远不会超过显著性水平 \\(\\alpha\\) 的检验。因此，拒绝原假设是对数据与此假设不一致的强烈陈述，而当接受原假设时，并不能做出类似的陈述。因此，我们希望仅在有充分证据支持生产商的说法时才能接受生产商的说法，因此我们应将生产商的说法作为备择假设。也就是说，我们应该检验：\n\\(H_0: \\mu \\geq 1.6 \\quad vs \\quad H_1: \\mu &lt; 1.6\\)\n此时，检验统计量的值为\n\\(\\frac{\\sqrt{n}(\\overline{X} - \\mu_0)}{\\sigma} = \\frac{\\sqrt{20}(1.54 - 1.6)}{0.8} = -0.336\\)\n因此，\\(p\\) 值为\n\\(\\text{p-value} = P\\{Z &lt; -0.336\\} = 0.368\\)\n由于 \\(\\text{p-value}\\) 大于 0.05，因此在显著性水平为 5% 的情况下，样本数据不足以拒绝平均尼古丁含量超过 1.6 毫克的假设。换句话说，尽管样本数据支持了香烟生产商的说法，但尚不足以证明应该接受生产商的说法。 \\(\\blacksquare\\)\n\n\n\n\n\n\n\n备注\n\n\n\n\n置信区间估计 与 假设检验 之间有直接的类比关系。例如，对于均值为 \\(\\mu\\)、方差为 \\(\\sigma^2\\)（已知）的正态分布总体，正如我们在 小节 7.3 中所述，\\(\\mu\\) 的 \\(100(1 - \\alpha)\\%\\) 置信区间为：\n\\(\\mu \\in \\left( \\overline{X} - z_{\\alpha/2}\\frac{\\sigma}{\\sqrt{n}}, \\, \\overline{X} + z_{\\alpha/2}\\frac{\\sigma}{\\sqrt{n}} \\right)\\)\n其中 \\(\\overline{X}\\) 是观测到的样本均值。更正式地，前述置信区间等价于：\n\\(P \\left\\{ \\mu \\in \\left( \\overline{X} - z_{\\alpha/2}\\frac{\\sigma}{\\sqrt{n}}, \\, \\overline{X} + z_{\\alpha/2}\\frac{\\sigma}{\\sqrt{n}} \\right) \\right\\} = 1 - \\alpha\\)\n因此，如果 \\(\\mu = \\mu_0\\)，则 \\(\\mu_0\\) 落在区间\n\\(\\left( \\overline{X} - z_{\\alpha/2}\\frac{\\sigma}{\\sqrt{n}}, \\, \\overline{X} + z_{\\alpha/2}\\frac{\\sigma}{\\sqrt{n}} \\right)\\)\n的概率是 \\(1 - \\alpha\\)，这意味着显著性水平为 \\(\\alpha\\) 的假设——\\(H_0: \\mu = \\mu_0 \\quad vs \\quad H_1: \\mu \\neq \\mu_0\\) 的检验是：\n当 \\(\\mu_0 \\notin \\left( \\overline{X} - z_{\\alpha/2}\\frac{\\sigma}{\\sqrt{n}}, \\, \\overline{X} + z_{\\alpha/2}\\frac{\\sigma}{\\sqrt{n}} \\right)\\) 时拒绝 \\(H_0\\)。\n类似地，\\(\\mu\\) 的 \\(100(1 - \\alpha)\\%\\) 单边置信区间由下式给出：\n\\(\\mu \\in \\left( \\overline{X} - z_{\\alpha}\\frac{\\sigma}{\\sqrt{n}}, \\, \\infty \\right)\\)\n因此，显著性水平为 \\(\\alpha\\) 的假设——\\(H_0: \\mu \\leq \\mu_0 \\quad vs \\quad H_1: \\mu &gt; \\mu_0\\) 的检验是：\n当 \\(\\mu_0 \\notin \\left( \\overline{X} - z_{\\alpha}\\frac{\\sigma}{\\sqrt{n}}, \\, \\infty \\right)\\)（即，\\(\\mu_0 &lt; \\overline{X} - z_{\\alpha}\\frac{\\sigma}{\\sqrt{n}}\\)） 时拒绝 \\(H_0\\)。\n关于稳健性（robustness）的说明：统计检验通常基于一些前提条件或假设（例如样本来自正态分布、方差是已知的等），当这些前提条件或假设并不满足的时候，某个检验仍能有良好的表现，那么我们认为该检验是稳健（robust）的。例如，小节 8.3.1 和 小节 8.3.1.1 中的检验都是基于如下的假设：总体分布是方差为 \\(\\sigma^2\\) 的正态分布。然而，在推导这些检验时，这个假设仅用于得出：\\(\\overline{X}\\) 也服从正态分布。但是，由中心极限定理（定理 6.1）可知，当样本量足够大时，无论总体服从什么分布，\\(\\overline{X}\\) 都将近似服从正态分布。因此，我们可以得出结论，这些检验对于任何方差为 \\(\\sigma^2\\) 的总体分布都将是相对稳健的。\n\n\n\n表 8.1 对本节的假设检验进行了总结。\n\n\n\n表 8.1: \\(X_1, \\dots, X_n\\) 是来自 \\((\\mu, \\sigma^2)\\) 的总体，其中 \\(\\sigma^2\\) 是已知的，\\(\\overline{X} = \\frac{1}{n} \\sum_{i=1}^n X_i\\)，\\(Z\\) 是标准正态分布随机变量\n\n\n\n\n\n\n\n\n\n\n\n\n\\(H_0\\)\n\\(H_1\\)\n检验统计量（Test Statistic） \\(TS\\)\n在显著性水平 \\(\\alpha\\) 下的检验\n\\(TS=t\\) 时的 \\(p-\\text{value}\\)\n\n\n\n\n\\(\\mu = \\mu_0\\)\n\\(\\mu \\neq \\mu_0\\)\n\\(\\sqrt{n}\\frac{(\\overline{X} - \\mu_0)}{\\sigma}\\)\n拒绝 \\(H_0\\) 如果 \\(|TS| &gt; z_{\\alpha/2}\\)\n\\(2P\\{Z \\geq |t|\\}\\)\n\n\n\\(\\mu \\leq \\mu_0\\)\n\\(\\mu &gt; \\mu_0\\)\n\\(\\sqrt{n}\\frac{(\\overline{X} - \\mu_0)}{\\sigma}\\)\n拒绝 \\(H_0\\) 如果 \\(TS &gt; z_{\\alpha}\\)\n\\(P\\{Z \\geq t\\}\\)\n\n\n\\(\\mu \\geq \\mu_0\\)\n\\(\\mu &lt; \\mu_0\\)\n\\(\\sqrt{n}\\frac{(\\overline{X} - \\mu_0)}{\\sigma}\\)\n拒绝 \\(H_0\\) 如果 \\(TS &lt; -z_{\\alpha}\\)\n\\(P\\{Z \\leq t\\}\\)\n\n\n\n\n\n\n\n\n\n8.3.2 方差未知的场景：\\(t-\\text{检验}\\)\n到目前为止，我们假设正态分布总体的唯一未知参数是其均值。然而，更常见的情况是均值 \\(\\mu\\) 和方差 \\(\\sigma^2\\) 都未知。假设在这种情况下，再次考虑检验均值等于某个指定值 \\(\\mu_0\\) 的假设。即考虑以下假设检验：\n\\(H_0: \\mu = \\mu_0 \\quad vs \\quad H_1: \\mu \\neq \\mu_0\\)\n需要注意的是，此时，因为我们并没有有指定 \\(\\sigma^2\\) 的值，因此原假设并不是一个 简单假设（小节 8.2）。\n与 小节 8.3.1 一样，当样本均值 \\(\\overline{X}\\) 远离 \\(\\mu_0\\) 时，拒绝 \\(H_0\\) 是合理的。然而，样本均值 \\(\\overline{X}\\) 需要远离 \\(\\mu_0\\) 多远才能合理地拒绝 \\(H_0\\) 取决于方差 \\(\\sigma^2\\)（参见 式 8.4）。如 式 8.5，\\(\\sigma^2\\) 已知时，当 \\(|\\overline{X} - \\mu_0|\\) 超过 \\(z_{\\alpha/2}\\sigma/\\sqrt{n}\\) 时，检验会拒绝 \\(H_0\\)，即当：\n\\(\\frac{\\sqrt{n}|\\overline{X} - \\mu_0|}{\\sigma} &gt; z_{\\alpha/2}\\)\n时拒绝 \\(H_0\\)。\n现在，当 \\(\\sigma^2\\) 未知时，需要先估计 \\(\\sigma^2\\)：\n\\(S^2 = \\frac{\\sum_{i=1}^{n} (X_i - \\overline{X})^2}{n-1}\\)\n然后，当\n\\(\\frac{|\\overline{X} - \\mu_0|}{S/\\sqrt{n}}\\)\n较大时拒绝 \\(H_0\\)。\n为了确定在显著性水平 \\(\\alpha\\) 下， 检验统计量\n\\(\\frac{\\sqrt{n}|\\overline{X} - \\mu_0|}{S}\\)\n需要大到什么程度时才能拒绝 \\(H_0\\)，我们必须确定当 \\(H_0\\) 为真时该统计量的概率分布。然而，如 小节 6.5 中的 推论 6.1 所述，当 \\(\\mu = \\mu_0\\) 时，下式定义的统计量 \\(T\\) 服从自由度为 \\(n-1\\) 的 \\(t-\\text{分布}\\)。\n\\(T = \\frac{\\sqrt{n}(\\overline{X} - \\mu_0)}{S}\\)\n因此，\n\\[\nP_{\\mu_0}\\left\\{ -t_{\\alpha/2, n-1} \\leq \\frac{\\sqrt{n}(\\overline{X} - \\mu_0)}{S} \\leq t_{\\alpha/2, n-1} \\right\\} = 1 - \\alpha\n\\tag{8.16}\\]\n其中 \\(t_{\\alpha/2, n-1}\\) 是自由度为 \\(n-1\\) 的 \\(t\\) 分布在 \\(\\left (100 \\frac{\\alpha}{2} \\right) \\%\\) 处的上百分位数。\n因此，从 式 8.16 中，我们可以看出，当 \\(\\sigma^2\\) 未知的情况时，在适当的显著性水平 \\(\\alpha\\) 下的\n\\(H_0: \\mu = \\mu_0 \\quad vs \\quad H_1: \\mu \\neq \\mu_0\\)\n的检验为：\n\\[\n\\begin{align}\n\\text{接受} \\ H_0, &\\quad \\text{如果} \\quad \\frac{\\sqrt{n}|\\overline{X} - \\mu_0|}{S} \\leq t_{\\alpha/2, n-1} \\\\\n\\text{拒绝} \\ H_0, &\\quad \\text{如果} \\quad \\frac{\\sqrt{n}|\\overline{X} - \\mu_0|}{S} \\gt t_{\\alpha/2, n-1}\n\\end{align}\n\\tag{8.17}\\]\n我们称 式 8.17 定义的检验为 双边 \\(t-\\text{检验}\\)（two-sided t-test），如 图 8.3 所示。\n\n\n\n\n\n\n图 8.3: 双边 \\(t-\\text{检验}\\)\n\n\n\n如果我们用 \\(t\\) 表示检验统计量 \\(T = \\sqrt{n}(\\overline{X} - \\mu_0)/S\\) 的观察值，那么检验的 \\(p-\\text{value}\\) 是当 \\(H_0\\) 为真时，\\(|T|\\) 超过 \\(|t|\\) 的概率。也就是说，\\(p-\\text{value}\\) 是自由度为 \\(n - 1\\) 的 \\(t-\\text{分布}\\) 的绝对值超过 \\(|t|\\) 的概率。因此，检验要求在所有的显著性水平均大于 \\(p-\\text{value}\\) 时拒绝原假设，同时在所有的显著性水平均小于 \\(p-\\text{value}\\) 时接受原假设。\n\n习题 8.6 一家诊所的患者的血液胆固醇水平范围为中高水平（即血清中胆固醇至少为 220 毫升/分升），从这些患者中招募了 50 名志愿者来测试一种用于降低血液胆固醇的新药。这 50 名志愿者服用了 1 个月的新药，并记录了他们的血液胆固醇水平的变化。如果他们的血液胆固醇平均降低了 14.8，并且样本标准差为 6.4，可以得出什么结论？\n\n\n解 8.4. 首先检验该变化可能完全是由偶然因素引起的假设——即这 50 个样本的变化构成了一个均值为 0 的正态分布样本。因为用于检验正态分布均值等于 0 的假设的 \\(T-\\text{统计量}\\) 的值是\n\\(T = \\frac{\\sqrt{n} \\overline{X}}{S} = \\frac{\\sqrt{50} \\cdot 14.8}{6.4} = 16.352\\)\n很明显，我们应该拒绝该变化完全是由偶然因素引起的假设。\n然而，不幸的是，此时我们还不能得出结论：这些变化是由于特定药物而不是其他因素引起的。例如，众所周知，任何药物（无论该药物是否直接与患者的病痛相关）通常都会导致患者病情的改善——即所谓的 安慰剂效应（placebo effect）。此外，另一个需要考虑的可能性是测试期间的天气情况，因为可以合理地认为天气会影响血液胆固醇水平。\n确实，必须得出结论：上述的实验设计非常不合理。为了测试某种治疗方式是否对可能受多种因素影响的疾病有作用，我们应该尝试设计实验，以避免所有其他可能因素带来的影响。实现这一目标的公认方法是将志愿者随机分成两组：一组复用新药物，另一组服用安慰剂（即一种看起来像实际药物但没有生理作用的药片）。志愿者不应该知道他们是在实验组还是对照组中，实际上，如果连临床医生都不知道这些信息（即所谓的 双盲试验（double-blind test）），那就更好了。此时，无论是志愿者还是临床医生，他们自己的偏见都无法在实验中发挥作用。由于这两组人员是从志愿者中随机选出的，我们现在可以认为：除了一组接受了新药而另一组接受了安慰剂之外，影响这两组的所有因素都是相同的。因此，这两组之间表现出的任何差异都可以归因于新药。\\(\\blacksquare\\)\n\n\n习题 8.7 一位公共卫生官员声称，家庭的平均用水量为每天 350 加仑。为了验证这一说法，对 20 户随机选定的家庭进行了研究，结果这些家庭的平均每日用水量如下：\n340, 344, 362, 375,\n356, 386, 354, 364,\n332, 402, 340, 355,\n362, 322, 372, 324,\n318, 360, 338, 370\n这些数据是否与该官员的说法相矛盾？\n\n\n解 8.5. 为了确定这些数据是否与官员的说法相矛盾，我们需要检验：\n\\(H_0: \\mu = 350 \\quad vs \\quad H_1: \\mu \\neq 350\\)\n首先计算样本数据集的样本均值和样本标准差：\n\\(\\overline{X} = 353.75, \\quad S = 21.82436\\)\n因此，检验统计量的值为：\n\\(T = \\frac{\\sqrt{20} (3.75)}{21.82436} = 0.7684308\\)\n因为这个值小于 \\(|t_{0.05, 19}| = 1.730\\)，所以在 10% 的显著性水平下，接受原假设。实际上，检验数据的 \\(p-\\text{value}\\) 为：\n\\(p-\\text{value} = P\\{ |T_{19}| &gt; 0.7684308 \\} = 2P\\{ T_{19} &gt; 0.7684308 \\} = 0.4517\\)\n这表明在任何合理的显著性水平下，都会接受原假设，因此数据与该公共卫生官员的说法并不矛盾。 \\(\\blacksquare\\)\n\n可以使用 R 来计算 \\(t-\\text{检验}\\)。当数据位 \\(x_1, ..., x_n\\) 时，为了检验均值 \\(\\mu\\) 等于 \\(\\mu_0\\) 的原假设与均值 \\(\\mu\\) 不等于 \\(\\mu_0\\) 的备择假设，可以使用如下的 R 代码：\nx &lt;- c(x1, ..., xn)\nt.test(x, mu = mu0)\n如上的代码会返回 \\(\\mu\\) 的 95% 的置信区间以及原假设为真时的 \\(p-\\text{value}\\)。我们可以使用如下的代码来计算 习题 8.7：\n\nx &lt;- c(340, 356, 332, 362, 318, 344, 386, 402, 322, 360, 362, 354, 340, 372, 338, 375, 363, 355, 324, 370)\nt.test(x, mu = 350)\n\n\n    One Sample t-test\n\ndata:  x\nt = 0.76843, df = 19, p-value = 0.4517\nalternative hypothesis: true mean is not equal to 350\n95 percent confidence interval:\n 343.5359 363.9641\nsample estimates:\nmean of x \n   353.75 \n\n\n\n\n\n\n\n\n注记\n\n\n\n此处与原书中的结果存在一定差异，请务必注意。\n\n\n我们可以使用 单边 \\(t-\\text{检验}\\) 来检验假设\n\\(H_0: \\mu = \\mu_0 \\quad (\\text{或 } H_0: \\mu \\leq \\mu_0) \\quad vs \\quad H_1: \\mu &gt; \\mu_0\\)\n显著性水平为 \\(\\alpha\\) 的检验是：\n\\[\n\\begin{align}\n\\text{接受} H_0 &, \\quad \\text{如果} \\frac{\\sqrt{n}(\\overline{X} - \\mu_0)}{S} \\leq t_{\\alpha, n-1} \\\\\n\\text{拒绝} H_0 &, \\quad \\text{如果} \\frac{\\sqrt{n}(\\overline{X} - \\mu_0)}{S} &gt; t_{\\alpha, n-1}\n\\end{align}\n\\tag{8.18}\\]\n如果 \\(\\frac{\\sqrt{n}(\\overline{X} - \\mu_0)}{S} = v\\)，那么该检验的 \\(p-\\text{value}\\) 是自由度为 \\(n-1\\) 的 \\(t-\\text{分布}\\) 随机变量的值大于等于 \\(v\\) 的概率，即 \\(1 - pt(v, n - 1)\\)。\n假设： \\(H_0: \\mu = \\mu_0 \\quad (\\text{或 } H_0: \\mu \\geq \\mu_0) \\quad vs \\quad H_1: \\mu &lt; \\mu_0\\)\n在显著性水平为 \\(\\alpha\\) 下的检验是：\n\\[\n\\begin{align}\n\\text{接受 } H_0 &, \\quad \\text{ 如果 } \\frac{\\sqrt{n}(\\overline{X} - \\mu_0)}{S} \\geq -t_{\\alpha, n-1} \\\\\n\\text{拒绝 } H_0 &, \\quad \\text{ 如果 } \\frac{\\sqrt{n}(\\overline{X} - \\mu_0)}{S} &lt; -t_{\\alpha, n-1}\n\\end{align}\n\\tag{8.19}\\]\n该检验的 \\(p-\\text{value}\\) 是自由度为 \\(n-1\\) 的 \\(t-\\text{分布}\\) 随机变量的值小于或等于观测值 \\(\\frac{\\sqrt{n}(\\overline{X} - \\mu_0)}{S}\\) 的概率，即 \\(pt(v, n - 1)\\)。\n\n习题 8.8 新型玻璃纤维轮胎的制造商声称他们生产的轮胎的平均寿命至少为 40,000 英里。为了验证这一说法，测试了 12 条轮胎，其寿命（以千英里为单位）如下：\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n轮胎序号\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\n\n\n寿命\n36.1\n40.2\n33.8\n38.5\n42\n35.8\n37\n41\n36.8\n37.2\n33\n36\n\n\n\n在 5% 的显著性水平下，检验制造商的说法。\n\n\n解 8.6. 为了确定上述数据是否与制造商生成的其产品的平均寿命至少为 40,000 英里的假设一致，我们将检验\n\\(H_0: \\mu \\geq 40,000 \\quad vs \\quad H_1: \\mu &lt; 40,000\\)\n计算得出\n\\(\\overline{X} = 37.2833, \\quad S = 2.7319\\)\n因此，检验统计量的值为\n\\(T = \\frac{\\sqrt{12}(37.2833 - 40)}{2.7319} = -3.4448\\)\n由于 -3.4448 小于 \\(t_{0.05, 11} = -1.796\\)，因此在 5% 的显著性水平下需要拒绝原假设。实际上，观察数据的 \\(p-\\text{value}\\) 为\n\\(p-\\text{value} = P\\{ T_{11} &lt; -3.4448 \\} = P\\{ T_{11} &gt; 3.4448 \\} = 0.0027\\)\n这表明在任何大于 0.003 的显著性水平下，我们都将拒绝制造商的说法。 \\(\\blacksquare\\)\n\n通过 R 提供的 单边 \\(t-\\text{检验}\\) 函数也可以解决 习题 8.8 的问题。在 R 中，通过指定备择假设是均值小于或大于 \\(\\mu_0\\) 来执行单边 \\(t-\\text{检验}\\)。也就是说，当数据为 \\(x_1, ..., x_n\\) 时，可以使用如下 R 代码对 \\(H_0: \\mu = \\mu_0 \\quad vs \\quad H_1: \\mu &gt; \\mu_0\\) 进行单边 \\(t-\\text{检验}\\)。\nx &lt;- c(x1,...,xn)\nt.test(x,  mu = mu0, alternative =\"less\")\n例如，对于 习题 8.8 而言，可以使用如下 R 代码：\n\nx &lt;- c(36.1, 40.2, 33.8, 38.5, 42, 35.8, 37, 41, 36.8, 37.2, 33, 36)\nt.test(x, mu = 40, alternative = \"less\")\n\n\n    One Sample t-test\n\ndata:  x\nt = -3.4448, df = 11, p-value = 0.002739\nalternative hypothesis: true mean is less than 40\n95 percent confidence interval:\n     -Inf 38.69963\nsample estimates:\nmean of x \n 37.28333 \n\n\n\n习题 8.9 对于一个单服务窗口的排队系统而言，如果到达的客户数量服从泊松分布，那么客户的平均排队时间取决于为客户服务时间的均值和方差。确实，如果 \\(\\mu\\) 是服务时间的均值，\\(\\sigma^2\\) 是服务时间的方差，那么客户在排队中花费的平均时间将由以下公式给出：\n\\(\\frac{\\lambda (\\mu^2 + \\sigma^2)}{2(1 - \\lambda \\mu)}\\)\n其中 \\(\\lambda \\mu &lt; 1\\)，并且 \\(\\lambda\\) 是到达率。如果 \\(\\lambda \\mu \\geq 1\\)，则平均等待时间将是无限等待。因为 \\(\\lambda\\) 是到达率，\\(1/\\lambda\\) 是到达之间的平均时间，因此根据如上的公式可见，当 \\(\\mu\\) 仅略小于 \\(1/\\lambda\\) 时，平均延迟还相当大。\n假设服务站的平均服务时间（每人）超过 8 分钟，那么该服务站的主管就会雇用第二名服务人员。以下数据给出了该排队系统中 28 位客户的服务时间（以分钟为单位），这些数据是否表明该服务站的平均服务时间超过 8 分钟？\n8.6, 9.4, 5.0, 4.4, 3.7, 11.4, 10.0, 7.6, 14.4, 12.2, 11.0, 14.4, 9.3, 10.5, 10.3, 7.7, 8.3, 6.4, 9.2, 5.7, 7.9, 9.4, 9.0, 13.3, 11.6, 10.0, 9.5, 6.6\n\n\n解 8.7. 使用上述数据来检验服务时间的均值小于或等于 8 分钟的原假设。一个较小的 \\(p-\\text{value}\\) 将是平均服务时间超过 8 分钟的有力证据。利用 t.test() 对如上数据进行 \\(t-\\text{检测}\\) 得到：检验统计量的值为 2.257，\\(p-\\text{value}\\) 为 0.016。如此小的 \\(p-\\text{value}\\) 无疑是平均服务时间超过 8 分钟的有力证据。\n\nx &lt;- c(8.6, 9.4, 5.0, 4.4, 3.7, 11.4, 10.0, 7.6, 14.4, 12.2, 11.0, 14.4, 9.3, 10.5, 10.3, 7.7, 8.3, 6.4, 9.2, 5.7, 7.9, 9.4, 9.0, 13.3, 11.6, 10.0, 9.5, 6.6)\nt.test(x, mu = 8, alternative = \"greater\")\n\n\n    One Sample t-test\n\ndata:  x\nt = 2.2575, df = 27, p-value = 0.01613\nalternative hypothesis: true mean is greater than 8\n95 percent confidence interval:\n 8.287595      Inf\nsample estimates:\nmean of x \n 9.171429 \n\n\n\\(\\blacksquare\\)\n\n表 8.2 对本节的内容进行了总结。\n\n\n\n表 8.2: \\(X_1, \\dots, X_n\\) 是来自方差未知的 \\((\\mu, \\sigma^2)\\) 总体，\\(\\overline{X} = \\sum_{i=1}^{n} X_i/n\\)，\\(S^2 = \\sum_{i=1}^{n}(X_i - \\overline{X})^2 / (n-1)\\)，\\(T_{n-1}\\) 是自由度为 \\(n-1\\) 的 \\(t-\\text{分布}\\) 随机变量，\\(P\\{T_{n-1} &gt; t_{\\alpha, n-1}\\} = \\alpha\\)\n\n\n\n\n\n\n\n\n\n\n\n\n\\(H_0\\)\n\\(H_1\\)\n统计量 TS\n在显著性水平为 \\(\\alpha\\) 时的检验\n\\(p-\\text{value}\\)\n\n\n\n\n\\(\\mu = \\mu_0\\)\n\\(\\mu \\neq \\mu_0\\)\n\\(\\sqrt{n}(\\overline{X} - \\mu_0)/S\\)\n拒绝 \\(H_0\\) 如果， \\(|TS| &gt; t_{\\alpha/2, n-1}\\)\n\\(2P\\{T_{n-1} \\geq |t|\\}\\)\n\n\n\\(\\mu \\leq \\mu_0\\)\n\\(\\mu &gt; \\mu_0\\)\n\\(\\sqrt{n}(\\overline{X} - \\mu_0)/S\\)\n拒绝 \\(H_0\\) 如果， \\(TS &gt; t_{\\alpha, n-1}\\)\n\\(P\\{T_{n-1} \\geq t\\}\\)\n\n\n\\(\\mu \\geq \\mu_0\\)\n\\(\\mu &lt; \\mu_0\\)\n\\(\\sqrt{n}(\\overline{X} - \\mu_0)/S\\)\n拒绝 \\(H_0\\) 如果， \\(TS &lt; -t_{\\alpha, n-1}\\)\n\\(P\\{T_{n-1} \\leq t\\}\\)",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>假设检验</span>"
    ]
  },
  {
    "objectID": "chapter_8/8.html#sec-8_4",
    "href": "chapter_8/8.html#sec-8_4",
    "title": "8  假设检验",
    "section": "8.4 检验两个正态分布的均值是否相等",
    "text": "8.4 检验两个正态分布的均值是否相等\n确定两种不同的方法是否会得出相同的结果是工程师在实践中经常遇到的一个场景。通常可以通过 假设检验 来对这种场景建模——检验两个正态分布的总体是否具有相同的均值。\n\n8.4.1 方差已知的场景\n假设 \\(X_1, \\dots, X_n\\) 和 \\(Y_1, \\dots, Y_m\\) 是来自两个正态分布总体的、相互独立的样本，这两个总体的均值 \\(\\mu_x\\) 和 \\(\\mu_y\\) 均未知，但方差 \\(\\sigma_x^2\\) 和 \\(\\sigma_y^2\\) 已知。现在考虑检验以下假设：\n\\(H_0: \\mu_x = \\mu_y \\quad vs \\quad  H_1: \\mu_x \\neq \\mu_y\\)\n由于 \\(\\overline{X}\\) 是 \\(\\mu_x\\) 的估计值，\\(\\overline{Y}\\) 是 \\(\\mu_y\\) 的估计值，因此 \\(\\overline{X} - \\overline{Y}\\) 可以用来估计 \\(\\mu_x - \\mu_y\\)。因此，原假设可以写作：\\(H_0: \\mu_x - \\mu_y = 0\\)，并且当 \\(\\overline{X} - \\overline{Y}\\) 远大于 0 时，拒绝原假设 \\(H_0\\) 是合理的。因此，对于某个合适的 \\(c\\) 而言，检验如下所示：\n\\[\n\\begin{align}\n\\text{拒绝} H_0 &, \\quad \\text{如果} \\left | \\overline{X} - \\overline{Y}\\right | &gt; c \\\\\n\\text{接受} H_0 &, \\quad \\text{如果} \\left | \\overline{X} - \\overline{Y}\\right | \\le c\n\\end{align}\n\\tag{8.20}\\]\n为了确定令 式 8.20 可以满足显著性水平为 \\(\\alpha\\) 的 \\(c\\) 的值，我们需要确定当 \\(H_0\\) 为真时 \\(\\overline{X} - \\overline{Y}\\) 的分布。如我们在 小节 7.4 中所述：\n\\[\n\\overline{X} - \\overline{Y} \\sim \\left(\\mu_x - \\mu_y, \\frac{\\sigma_x^2}{n} + \\frac{\\sigma_y^2}{m}\\right)\n\\]\n即（式 7.5）：\n\\[\n\\frac{\\overline{X} - \\overline{Y} - (\\mu_x - \\mu_y)}{\\sqrt{\\frac{\\sigma_x^2}{n} + \\frac{\\sigma_y^2}{m}}} \\sim N(0, 1)\n\\tag{8.21}\\]\n因此，当 \\(H_0\\) 为真时，\\(\\mu_x - \\mu_y = 0\\)，所以 \\(\\frac{\\overline{X} - \\overline{Y}}{\\sqrt{\\frac{\\sigma_x^2}{n} + \\frac{\\sigma_y^2}{m}}}\\) 服从标准正态分布。于是：\n\\[\nP_{H_0}\\left\\{-z_{\\alpha/2} \\leq \\frac{\\overline{X} - \\overline{Y}}{\\sqrt{\\frac{\\sigma_x^2}{n} + \\frac{\\sigma_y^2}{m}}} \\leq z_{\\alpha/2}\\right\\} = 1 - \\alpha\n\\tag{8.22}\\]\n由此，根据 式 8.22，我们可以得出显著性水平为 \\(\\alpha\\) 时，\\(H_0: \\mu_x = \\mu_y \\quad vs \\quad H_1: \\mu_x \\neq \\mu_y\\) 的检验标准为：\n\\[\n\\begin{align}\n\\text{接受} H_0, &\\quad \\text{如果} \\frac{\\left|\\overline{X} - \\overline{Y}\\right|}{\\sqrt{\\frac{\\sigma_x^2}{n} + \\frac{\\sigma_y^2}{m}}} \\leq z_{\\alpha/2} \\\\\n\\text{拒绝} H_0, &\\quad \\text{如果} \\frac{\\left|\\overline{X} - \\overline{Y}\\right|}{\\sqrt{\\frac{\\sigma_x^2}{n} + \\frac{\\sigma_y^2}{m}}} \\geq z_{\\alpha/2}\n\\end{align}\n\\tag{8.23}\\]\n\n习题 8.10 如果现在新提出了两种轮胎生产方法，为了确定哪种生产方法更好，轮胎制造商使用第一种方法生产了 10 个轮胎，使用第二种方法生产了 8 个轮胎。使用第一种方法生产的轮胎在 A 地进行道路测试，使用第种方法生产的轮胎在 B 地测试。已知轮胎在这两个地点的寿命服从正态分布，其均值与轮胎质量有关，但方差主要由测试的地点决定。具体而言，A 地轮胎寿命的标准差为 4000 公里，B 地的标准差为 6000 公里。如果制造商希望检验这两种方法生产的轮胎的平均寿命是否无显著差异，那么在显著性水平为 5% 的情况下，我们可以从 表 8.3 的数据中得出什么结论？\n\n\n\n表 8.3: 不同地点轮胎的寿命（单位为100公里）\n\n\n\n\n\n在 A 地测试的轮胎寿命\n在 B 地测试的轮胎寿命\n\n\n\n\n61.1\n62.2\n\n\n58.2\n56.6\n\n\n62.3\n66.4\n\n\n64.0\n56.2\n\n\n59.7\n57.4\n\n\n66.2\n58.4\n\n\n57.8\n57.6\n\n\n61.4\n65.4\n\n\n62.2\n\n\n\n63.6\n\n\n\n\n\n\n\n\n\n解 8.8. 根据 表 8.3 的数据可以计算得出检验统计量的值为 0.066。对于如此小的统计量值，显然我们应该接受原假设，即两种方法生产的轮胎的寿命没有显著的差异。\\(\\blacksquare\\)\n\n根据 式 8.20，对于单边假设 \\(H_0: \\mu_x = \\mu_y\\)（或 \\(H_0: \\mu_x \\leq \\mu_y\\)） \\(\\quad vs \\quad H_1: \\mu_x &gt; \\mu_y\\) 的检验为：\n\\[\n\\begin{align}\n\\text{接受} H_0&, \\quad \\text{如果} \\overline{X} - \\overline{Y} \\leq z_\\alpha \\sqrt{\\frac{\\sigma_x^2}{n} + \\frac{\\sigma_y^2}{m}} \\\\\n\\text{拒绝} H_0&, \\quad \\text{如果} \\overline{X} - \\overline{Y} \\gt z_\\alpha \\sqrt{\\frac{\\sigma_x^2}{n} + \\frac{\\sigma_y^2}{m}}\n\\end{align}\n\\tag{8.24}\\]\n\n\n8.4.2 方差未知的场景\n继续假设 \\(X_1, \\dots, X_n\\) 和 \\(Y_1, \\dots, Y_m\\) 是来自两个正态分布总体的独立样本，这两个总体的参数分别为 \\((\\mu_x, \\sigma_x^2)\\) 和 \\((\\mu_y, \\sigma_y^2)\\)，现在我们假设这四个参数都是未知的。我们再次考虑以下的假设检验：\n\\(H_0: \\mu_x = \\mu_y \\quad vs \\quad H_1: \\mu_x \\neq \\mu_y\\)\n为了确定显著性水平为 \\(\\alpha\\) 的检验，我们需要做额外的假设：方差 \\(\\sigma_x^2\\) 和 \\(\\sigma_y^2\\) 是相等的，记为 \\(\\sigma^2\\)，即 \\(\\sigma^2 = \\sigma_x^2 = \\sigma_y^2\\)。\n如 式 8.20，当 \\(\\left |\\overline{X} - \\overline{Y} \\right|\\) 远大于零时，我们将拒绝 \\(H_0\\)。为了确定 \\(c\\)（式 8.20）的值，我们定义如下的样本方差：\n\\(\\begin{align} S_x^2 &= \\frac{1}{n-1} \\sum_{i=1}^{n} (X_i - \\overline{X})^2 \\\\ S_y^2 &= \\frac{1}{m-1} \\sum_{i=1}^{m} (Y_i - \\overline{Y})^2 \\end{align}\\)\n于是如 小节 7.4.1 所述：\n\\(\\frac{\\overline{X} - \\overline{Y} - (\\mu_x - \\mu_y)}{\\sqrt{S_p^2 \\left( \\frac{1}{n} + \\frac{1}{m} \\right)}} \\sim t_{n+m-2}\\)\n其中 \\(S_p^2\\) 是两个样本的共同的方差的池化估计量（pooled estimator）：\n\\(S_p^2 = \\frac{(n-1)S_x^2 + (m-1)S_y^2}{n + m - 2}\\)\n因此，当 \\(H_0\\) 为真时，由于 \\(\\mu_x - \\mu_y = 0\\)，所以统计量 \\(T\\)：\n\\(T \\equiv \\frac{\\overline{X} - \\overline{Y}}{\\sqrt{S_p^2 \\left( \\frac{1}{n} + \\frac{1}{m} \\right)}} \\sim t_{n+m-2}\\)\n服从自由度为 \\(n + m - 2\\) 的 \\(t-\\text{分布}\\)，于是我们可以对 \\(\\mu_x = \\mu_y\\) 的假设做如下的检验：\n\\[\n\\begin{align} \\text{接受} H_0&, \\quad \\text{如果} |T| \\leq t_{\\alpha/2, n+m-2} \\\\ \\text{拒绝} H_0&, \\quad \\text{如果} |T| &gt; t_{\\alpha/2, n+m-2} \\end{align}\n\\tag{8.25}\\]\n其中，\\(t_{\\alpha/2, n+m-2}\\) 是自由度为 \\(n + m - 2\\) 的 \\(t-\\text{分布}\\) 随机变量的 \\(100\\ \\alpha/2\\) 百分位数（如 图 8.4 所示）。\n\n\n代码\nlibrary(ggplot2)\n\ndfreedom &lt;- 2\nx &lt;- seq(-10, 10, 0.01) \ny &lt;- dt(x, dfreedom)\ndf &lt;- data.frame(x=x, y=y)\n\nggplot(df, aes(x=x, y=y)) + \n  geom_line() + \n  geom_segment(x=-3, y=dt(-3, dfreedom), xend=-3, yend=0) +\n  geom_segment(x=3, y=dt(3, dfreedom), xend=3, yend=0) + \n  geom_ribbon(data = subset(df, x &gt;= 3), aes(ymin = 0, ymax = y), fill = \"gray\") + \n  geom_ribbon(data = subset(df, x &lt;= -3), aes(ymin = 0, ymax = y), fill = \"gray\") + \n  annotate(\"text\", x = 3.2, y = -0.01, label = TeX(\"$t_{\\\\alpha, k}$\"), hjust = 1, vjust = 0, size = 3) +\n  annotate(\"text\", x = -2.7, y = -0.01, label = TeX(\"$-t_{\\\\alpha, k}$\"), hjust = 1, vjust = 0, size = 3) +\n  annotate(\"text\", x = 6, y = 0.01, label = TeX(\"Area: $\\\\alpha$\"), hjust = 1, vjust = 0, size = 3) + \n  annotate(\"text\", x = -5, y = 0.01, label = TeX(\"Area: $\\\\alpha$\"), hjust = 1, vjust = 0, size = 3) + \n  theme_minimal() +\n  theme(axis.text = element_blank(),axis.title = element_blank())\n\n\n\n\n\n\n\n\n图 8.4: 自由度为 \\(k\\) 的 \\(t-\\text{分布}\\) 随机变量的概率密度函数\n\n\n\n\n\n我们还可以通过计算 \\(p-\\text{value}\\) 来进行检验。如果 \\(T\\) 的观测值为 \\(v\\)，那么对 \\(H_0 \\ vs \\ H_1\\) 的检验的 \\(p-\\text{value}\\) 为：\n\\(p-\\text{value} = P\\{|T_{n+m-2}| \\geq |v|\\} = 2P\\{T_{n+m-2} \\geq |v|\\}\\)\n其中，\\(T_{n+m-2}\\) 是自由度为 \\(n + m - 2\\) 的 \\(t-\\text{分布}\\) 随机变量。\n如果我们需要计算单边检验：\\(H_0: \\mu_x \\leq \\mu_y \\quad vs \\quad H_1: \\mu_x &gt; \\mu_y\\)，那么在 \\(T\\) 较大时，我们会拒绝 \\(H_0\\)。因此，在显著性水平为 \\(\\alpha\\) 时的单边检验为：\n\\[\n\\begin{align} \\text{拒绝} H_0&, \\quad \\text{如果} T \\geq t_{\\alpha, n+m-2} \\\\ \\text{接受} H_0&, \\quad \\text{否则} \\end{align}\n\\tag{8.26}\\]\n如果检验统计量 \\(T\\) 的值为 \\(v\\)，那么 \\(p-\\text{value}\\) 为：\n\\(p-\\text{value} = P\\{T_{n+m-2} \\geq v\\}\\)\n可以用 R 来实现两个样本的 \\(t-\\text{检验}\\)。假设 \\(x_1, \\dots, x_n\\) 和 \\(y_1, \\dots, y_m\\) 是来自两个不同的正态分布总体的独立样本，且这两个总体具有相同的方差。令 \\(\\mu_x\\) 表示第一个总体的均值，\\(\\mu_y\\) 表示第二个总体的均值。为了检验假设 \\(H_0: \\mu_x = \\mu_y \\quad vs \\quad H_1: \\mu_x \\neq \\mu_y\\)，可以使用如下的代码：\nx &lt;- c(x1,...,xn)\ny &lt;- c(y1,...,ym)\nt.test(x, y, var.equal = TRUE)\n如上的代码会输出 \\(p-\\text{value}\\) 和 \\(\\mu_x - \\mu_y\\) 的 95% 置信区间。例如：如果 \\(x = \\{3, 5, 7, 9\\}\\)，\\(y = \\{6, 8, 12, 15\\}\\)，则 \\(H_0: \\mu_x = \\mu_y \\quad vs \\quad H_1: \\mu_x \\neq \\mu_y\\) 的假设检验为：\n\nx &lt;- c(3, 5, 7, 9)\ny &lt;- c(6, 8, 12, 15)\nt.test(x, y, var.equal = TRUE)\n\n\n    Two Sample t-test\n\ndata:  x and y\nt = -1.7756, df = 6, p-value = 0.1261\nalternative hypothesis: true difference in means is not equal to 0\n95 percent confidence interval:\n -10.106849   1.606849\nsample estimates:\nmean of x mean of y \n     6.00     10.25 \n\n\n我们可以通过 t.test() 的 alternative 参数来控制我们需要的检验类型（双边检验、单边检验）。如果我们想计算 \\(H_0: \\mu_x \\le \\mu_y \\quad vs \\quad H_1: \\mu_x \\gt \\mu_y\\) 的假设检验，我们可以使用如下的代码：\n\nx &lt;- c(3, 5, 7, 9)\ny &lt;- c(6, 8, 12, 15)\nt.test(x, y, var.equal = TRUE, alternative = \"greater\")\n\n\n    Two Sample t-test\n\ndata:  x and y\nt = -1.7756, df = 6, p-value = 0.9369\nalternative hypothesis: true difference in means is greater than 0\n95 percent confidence interval:\n -8.901134       Inf\nsample estimates:\nmean of x mean of y \n     6.00     10.25 \n\n\n同理，如果我们想计算 \\(H_0: \\mu_x \\ge \\mu_y \\quad vs \\quad H_1: \\mu_x \\lt \\mu_y\\) 的假设检验，我们可以使用如下的代码：\n\nx &lt;- c(3, 5, 7, 9)\ny &lt;- c(6, 8, 12, 15)\nt.test(x, y, var.equal = TRUE, alternative = \"less\")\n\n\n    Two Sample t-test\n\ndata:  x and y\nt = -1.7756, df = 6, p-value = 0.06307\nalternative hypothesis: true difference in means is less than 0\n95 percent confidence interval:\n      -Inf 0.4011337\nsample estimates:\nmean of x mean of y \n     6.00     10.25 \n\n\n\n习题 8.11 在一个感冒研究所，22 名志愿者在暴露于各种感冒病毒后感染了感冒。从中随机选取 10 名志愿者服用含有 1 克维生素 C 的药片，并且每天复用四次。另外的 12 名志愿者作为对照组服用看起来、尝起来与维生素 C 药片完全相同的安慰剂药片。对于每一个志愿者而言，实验会持续到医生（不知道志愿者服用的是维生素 C 还是安慰剂）认为志愿者已经康复为止，并记录志愿者感冒的持续时间。实验结束时，得到了如下数据。\n\n\n\n复用维生素 C 的患者\n复用安慰剂的患者\n\n\n\n\n5.5\n6.5\n\n\n6.0\n6.0\n\n\n7.0\n8.5\n\n\n6.0\n7.0\n\n\n7.5\n6.5\n\n\n6.0\n8.0\n\n\n7.5\n7.5\n\n\n5.5\n6.5\n\n\n7.0\n7.5\n\n\n6.5\n6.0\n\n\n\n8.5\n\n\n\n7.0\n\n\n\n这些数据是否证明每天服用 4 克维生素 C 可以缩短感冒持续时间？在什么显著性水平下？\n\n\n解 8.9. 为了证明上述假设，我们需要在以下假设检验中拒绝原假设：\n\\(H_0 : \\mu_C \\geq \\mu_P \\quad vs \\quad H_1 : \\mu_C &lt; \\mu_P\\)\n其中，\\(\\mu_C\\) 是服用维生素 C 药片时感冒的平均持续时间，\\(\\mu_P\\) 是服用安慰剂时的平均持续时间。假设维生素 C 组和安慰剂组的方差相同，我们使用 R 进行上述检验。\n\nx &lt;- c(5.5, 6, 7, 6, 7.5, 6, 7.5, 5.5, 7, 6.5)\ny &lt;- c(6.5, 6, 8.5, 7, 6.5, 8, 7.5, 6.5, 7.5, 6, 8.5, 7)\nt.test(x, y, alternative = \"less\", var.equal = TRUE)\n\n\n    Two Sample t-test\n\ndata:  x and y\nt = -1.8987, df = 20, p-value = 0.03606\nalternative hypothesis: true difference in means is less than 0\n95 percent confidence interval:\n        -Inf -0.06185013\nsample estimates:\nmean of x mean of y \n    6.450     7.125 \n\n\n由于 \\(p-\\text{value}\\) 为 0.036，因此可以在 5% 的显著性水平下确定维生素 C 可以缩短感冒的持续时间。此外，值得注意的是，除了输出 \\(p-\\text{value}\\) 外，R 还提供了 \\(\\mu_x - \\mu_y\\) 的单边 95% 置信区间。\\(\\blacksquare\\)\n\n\n\n8.4.3 方差未知且不同的场景\n现在，我们假设总体的方差 \\(\\sigma_x^2\\) 和 \\(\\sigma_y^2\\) 不仅未知，而且不能认为相等。在这种情况下，由于 \\(S_x^2\\) 和 \\(S_y^2\\) 分别是 \\(\\sigma_x^2\\) 和 \\(\\sigma_y^2\\) 的估计量，因此基于以下检验统计量进行 \\(H_0: \\mu_x = \\mu_y \\quad vs \\quad H_1: \\mu_x \\ne \\mu_y\\) 的假设检验似乎是合理的：\n\\[\n\\frac{\\overline{X} - \\overline{Y}}{\\sqrt{\\frac{S_x^2}{n} + \\frac{S_y^2}{m}}}\n\\tag{8.27}\\]\n然而，上述统计量的分布非常复杂，即使在 \\(H_0\\) 为真时，式 8.27 的分布也依赖于未知参数，因此无法被广泛使用。唯一可以利用 式 8.27 这个统计量的场景是：\\(n\\) 和 \\(m\\) 都非常大。当 \\(n\\) 和 \\(m\\) 都非常大时，可以证明：在 \\(H_0\\) 为真时，该统计量近似服从标准正态分布。因此，当 \\(n\\) 和 \\(m\\) 都很大时，\\(H_0: \\mu_x = \\mu_y \\quad vs \\quad H_1: \\mu_x \\ne \\mu_y\\) 在显著性水平 \\(\\alpha\\) 下的 近似 检验为：\n\\[\n\\begin{align} \\text{接受} H_0&, \\quad \\text{如果} -z_{\\alpha/2} \\leq \\frac{\\overline{X} - \\overline{Y}}{\\sqrt{\\frac{S_x^2}{n} + \\frac{S_y^2}{m}}} \\leq z_{\\alpha/2} \\\\ \\text{拒绝} H_0&, \\quad \\text{否则}\\end{align}\n\\tag{8.28}\\]\n确定两个具有未知且不一定相等方差的正态总体均值在 精确 显著性水平 \\(\\alpha\\) 下的检验的问题，我们称之为 Behrens-Fisher 问题。对于 Behrens-Fisher 问题而言，目前还没有完全令人满意的解决方案。\n表 8.4 对本节的双边检验进行了总结。\n\n\n\n表 8.4: \\(X_1, \\dots, X_n\\) 是来自 \\((\\mu_1, \\sigma_1^2)\\) 总体的样本；\\(Y_1, \\dots, Y_m\\) 是来自 \\((\\mu_2, \\sigma_2^2)\\) 总体的样本。两个总体的样本是独立的。\\(H_0: \\mu_1 = \\mu_2 \\quad vs \\quad H_0: \\mu_1 \\neq \\mu_2\\) 的假设检验\n\n\n\n\n\n\n\n\n\n\n\n假设\n假设检验统计量 \\(TS\\)\n在显著性水平 \\(\\alpha\\) 下的检验\n当 \\(TS = t\\) 时的 \\(p-\\text{value}\\)\n\n\n\n\n\\(\\sigma_1, \\sigma_2\\) 已知\n\\(\\frac{\\overline{X} - \\overline{Y}}{\\sqrt{\\sigma_1^2/n + \\sigma_2^2/m}}\\)\n拒绝 \\(H_0\\)，如果 \\(|TS| &gt; z_{\\alpha/2}\\)\n\\(2P\\{Z \\geq |t|\\}\\)\n\n\n\\(\\sigma_1 = \\sigma_2\\)\n\\(\\frac{\\overline{X} - \\overline{Y}}{\\sqrt{\\frac{(n-1)S_1^2 + (m-1)S_2^2}{n+m-2}}\\sqrt{1/n + 1/m}}\\)\n拒绝 \\(H_0\\)，如果 \\(|TS| &gt; t_{\\alpha/2, n+m-2}\\)\n\\(2P\\{T_{n+m-2} \\geq |t|\\}\\)\n\n\n\\(n, m\\) 较大\n\\(\\frac{\\overline{X} - \\overline{Y}}{\\sqrt{S_1^2/n + S_2^2/m}}\\)\n拒绝 \\(H_0\\)，如果 \\(|TS| &gt; z_{\\alpha/2}\\)\n\\(2P\\{Z \\geq |t|\\}\\)\n\n\n\n\n\n\n\n\n8.4.4 成对样本的 \\(t-\\text{检验}\\)\n假设我们对 安装某种防污染装置是否会影响汽车油耗 这个问题感兴趣。为了检验 安装某种防污染装置是否会影响汽车油耗，我们：\n\n首先，招募 \\(n\\) 辆没有安装该装置的汽车\n然后，分别记录每辆车在安装装置前后的每加仑行驶里程\n\n最后，我们可以通过比较安装装置前后的油耗差异来检验：防污染控制装置是否对油耗有影响？\n假设有 \\(n\\) 对数据 \\((X_i, Y_i)\\)，其中 \\(X_i\\) 是第 \\(i\\) 辆车在安装装置前的油耗，\\(Y_i\\) 是安装装置后的油耗。因为这 \\(n\\) 辆车中的每辆车之间存在天然的不同，因此我们不能将 \\(X_1, ..., X_n\\) 和 \\(Y_1, ..., Y_m\\) 看作相互独立的样本。例如，如果我们知道 \\(X_1\\) 很大（比如，每加仑 40 英里），我们肯定会认为 \\(Y_1\\) 也可能很大。因此，我们不能使用本节之前所介绍的方法。\n为了检验安装装置前后的油耗是否存在差异，我们定义差值 \\(W_i = X_i - Y_i, \\ i = 1,...,n\\)。如果防污染控制装置对油耗没有影响，\\(W_i\\) 的均值将为 0。因此，我们可以对如下的假设进行假设检验：\n\\(H_0: \\mu_w = 0 \\quad vs \\quad H_1: \\mu_w \\neq 0\\)\n其中，我们假定 \\(W_1, \\dots, W_n\\) 为来自一个具有未知均值 \\(\\mu_w\\) 和未知方差 \\(\\sigma_w^2\\) 的正态总体。使用 小节 8.3.2 中的 \\(t-\\text{检验}\\) 进行假设检验：\n\\[\n\\begin{align}\n\\text{接受} H_0&, \\quad \\text{如果} -t_{\\alpha/2, n-1} &lt; \\sqrt{n} \\frac{\\overline{W}}{S_w} &lt; t_{\\alpha/2, n-1} \\\\ \\text{拒绝} H_0&, \\quad \\text{否则}\n\\end{align}\n\\tag{8.29}\\]\n\n习题 8.12 计算机芯片行业最近实施了一项工业安全计划。下表显示了 10 家芯片工厂在实施该计划前后，由于事故导致的平均每周的 工时损失（loss in labor-hours）数据（最近一个月的平均数据）：\n\n\n\n工厂\n实施前\n实施后\n\\(A - B\\)\n\n\n\n\n1\n30.5\n23\n-7.5\n\n\n2\n18.5\n21\n2.5\n\n\n3\n24.5\n22\n-2.5\n\n\n4\n32\n28.5\n-3.5\n\n\n5\n16\n14.5\n-1.5\n\n\n6\n15\n15.5\n0.5\n\n\n7\n23.5\n24.5\n1\n\n\n8\n25.5\n21\n-4.5\n\n\n9\n28\n23.5\n-4.5\n\n\n10\n18\n16.5\n-1.5\n\n\n\n在 5% 的显著性水平下，判断该安全计划是否有效？\n\n\n解 8.10. 我们将检验以下假设：\n\\(H_0: \\mu_A - \\mu_B \\geq 0 \\quad vs \\quad H_1: \\mu_A - \\mu_B &lt; 0\\)\n如上的假设可以让我们判断原假设——安全计划没有产生有益效果——是否合理。为此，我们使用 R 首先得到检验统计量 \\(v\\) 的值，然后计算 \\(p-\\text{value}\\)，即自由度为 9 的 \\(t-\\text{分布}\\) 随机变量小于 \\(v\\) 的概率。\n\nd &lt;- c(-7.5, 2.5, -2.5, -3.5, -1.5, .5, 1, -4.5, -4.5, -1.5)\nv &lt;- sqrt(10 / var(d)) * mean(d)\nv\n\n[1] -2.265949\n\npt(v, 9)\n\n[1] 0.02484552\n\n\n\\(p-\\text{value} = P(T_9 \\leq -2.265949) = 0.02484552\\)\n我们使用 R 中的 pt(v, n) 来获得自由度为 \\(n\\) 的 \\(t-\\text{分布}\\) 随机变量小于或等于 \\(v\\) 的概率。\n由于 \\(p-\\text{value}\\) 小于 0.05，因此我们拒绝安全计划没有效果的假设，并且可以得出结论：这项安全计划的有效性已经得到证实（至少对于任何显著性水平大于 0.025 的情况下）。\n我们还可以直接使用 R 中的 t.test() 来进行同样的检验：\n\nd &lt;- c(-7.5, 2.5, -2.5, -3.5, -1.5, .5, 1, -4.5, -4.5, -1.5)\nt.test(d, alternative=\"less\")\n\n\n    One Sample t-test\n\ndata:  d\nt = -2.2659, df = 9, p-value = 0.02485\nalternative hypothesis: true mean is less than 0\n95 percent confidence interval:\n      -Inf -0.410688\nsample estimates:\nmean of x \n    -2.15 \n\n\nt.test() 不仅可以给出 \\(p-\\text{value}\\)，还会同时给出 \\(\\mu_A - \\mu_B\\) 的 95% 置信区间。\\(\\blacksquare\\)\n\n\n\n\n\n\n\n注意\n\n\n\n即使样本不是独立的且总体方差不相等，也可以使用成对样本的 \\(t-\\text{检验}\\)。",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>假设检验</span>"
    ]
  },
  {
    "objectID": "chapter_8/8.html#sec-8_5",
    "href": "chapter_8/8.html#sec-8_5",
    "title": "8  假设检验",
    "section": "8.5 关于正态总体方差的假设检验",
    "text": "8.5 关于正态总体方差的假设检验\n假设 \\(X_1, \\dots, X_n\\) 是来自正态分布总体的样本，该总体具有未知均值 \\(\\mu\\) 和未知方差 \\(\\sigma^2\\)，并且我们希望检验以下的假设：\n\\(H_0 : \\sigma^2 = \\sigma_0^2 \\quad vs \\quad H_1 : \\sigma^2 \\neq \\sigma_0^2\\)\n其中 \\(\\sigma_0^2\\) 是一个特定的值。\n当 \\(H_0\\) 为真时，如 定理 6.2 所述，\\((n-1)S^2/\\sigma_0^2\\) 服从自由度为 \\(n-1\\) 的卡方分布，因此：\n\\(\\frac{(n-1)S^2}{\\sigma_0^2} \\sim \\chi^2_{n-1}\\)\n由于 \\(P\\{\\chi^2_{n-1} &lt; \\chi^2_{\\alpha/2, n-1}\\} = 1 - \\alpha/2\\) 且 \\(P\\{\\chi^2_{n-1} &lt; \\chi^2_{1-\\alpha/2, n-1}\\} = \\alpha/2\\)，由此得出\n\\(P_{H_0} \\left\\{ \\chi^2_{1-\\alpha/2, n-1} \\leq \\frac{(n-1)S^2}{\\sigma_0^2} \\leq \\chi^2_{\\alpha/2, n-1} \\right\\} = 1 - \\alpha\\)\n因此，在显著性水平为 \\(\\alpha\\) 下的检验为：\n\\[\n\\begin{align}\n\\text{接受} H_0&, \\quad \\text{如果} \\chi^2_{1-\\alpha/2, n-1} \\leq \\frac{(n-1)S^2}{\\sigma_0^2} \\leq \\chi^2_{\\alpha/2, n-1} \\\\\n\\text{拒绝} H_0&, \\quad \\text{否则}\n\\end{align}\n\\]\n如上的检验可以通过：\n\n首先，计算检验统计量 \\((n-1)S^2/\\sigma_0^2\\) 的值——我们称之为 \\(c\\)——来实现\n然后，计算自由度为 \\(n-1\\) 的卡方分布随机变量大于 \\(c\\) 或者小于 \\(c\\) 的概率\n如果如上的概率中的任一个概率小于 \\(\\alpha/2\\)，则拒绝原假设。换句话说，该检验的 \\(p-\\text{value}\\) 为：\n\n\\(p-\\text{value} = 2 \\min \\left( P\\{\\chi^2_{n-1} &lt; c\\}, 1 - P\\{\\chi^2_{n-1} &lt; c\\} \\right)\\)\n同样，也可以使用类似的方法得到单边检验的 \\(p-\\text{value}\\)。我们可以使用 R 命令 pchisq(c, n-1) 得到 \\(P\\{\\chi^2_{n-1} &lt; c\\}\\) 的值。\n\n习题 8.13 最近安装了一台自动控制磁带长度的机器。如果磁带长度的标准差 \\(\\sigma\\) 小于 0.15 厘米，则认为该机器是有效的。如果 20 个磁带样本的方差 \\(S^2 = 0.025 \\ \\text{cm}^2\\)，我们能否得出该机器无效的结论？\n\n\n解 8.11. 我们将检验该机器有效的假设，因为拒绝这个假设将使我们得出该机器无效的结论。因此，我们检验以下假设：\n\\(H_0: \\sigma^2 \\leq 0.0225 \\quad vs \\quad H_1: \\sigma^2 &gt; 0.0225\\)\n因此，当 \\(S^2\\) 较大时，我们会拒绝 \\(H_0\\)。测试数据的 \\(p-\\text{value}\\) 是自由度为 19 的卡方随机变量超过 \\(19 \\times 0.025 / 0.0225 = 21.111\\) 的概率，即：\n\\(p-\\text{value} = P\\{\\chi^2_{19} &gt; 21.111\\} = 1 - \\text{pchisq}(21.111, 19) = 0.3307001\\)\n因此，我们必须得出结论：观察到的 \\(S^2 = 0.025\\) 的值不足以排除 \\(\\sigma^2 \\leq 0.0225\\) 的可能性，因此接受原假设。\\(\\blacksquare\\)\n\n\n8.5.1 检验两个正态分布的方差是否相等\n设 \\(X_1, \\dots, X_n\\) 和 \\(Y_1, \\dots, Y_m\\) 表示来自两个正态分布总体的独立样本，这两个总体的参数分别为 \\((\\mu_x, \\sigma_x^2)\\) 和 \\((\\mu_y, \\sigma_y^2)\\)，我们考虑检验如下的假设：\n\\(H_0: \\sigma_x^2 = \\sigma_y^2 \\quad vs \\quad H_1: \\sigma_x^2 \\neq \\sigma_y^2\\)\n如果我们令：\n\\(\\begin{align} S_x^2 &= \\frac{1}{n-1} \\sum_{i=1}^{n} (X_i - \\overline{X})^2 \\\\ S_y^2 &= \\frac{1}{m-1} \\sum_{i=1}^{m} (Y_i - \\overline{Y})^2 \\end{align}\\)\n表示样本方差，那么如 定理 6.2 所示，\\((n-1)S_x^2/\\sigma_x^2\\) 和 \\((m-1)S_y^2/\\sigma_y^2\\) 服从自由度分别为 \\(n-1\\) 和 \\(m-1\\) 的卡方分布，因此 \\((S_x^2/\\sigma_x^2) / (S_y^2/\\sigma_y^2)\\) 服从自由度为 \\(n-1\\) 和 \\(m-1\\) 的 \\(F-\\text{分布}\\)。所以，当 \\(H_0\\) 为真时：\n\\(S_x^2/S_y^2 \\sim F_{n-1, m-1}\\)\n所以：\n\\(P_{H_0}\\{F_{1 - \\alpha / 2, n-1, m-1} \\leq S_x^2/S_y^2 \\leq F_{\\alpha / 2, n-1, m-1}\\} = 1 - \\alpha\\)\n因此，在显著性水平 \\(\\alpha\\) 下，\\(H_0 \\ vs \\ H_1\\) 的检验为：\n\\[\n\\begin{align}\n\\text{接受} H_0&, \\quad \\text{如果} F_{1-\\alpha/2, n-1, m-1} &lt; \\frac{S_x^2}{S_y^2} &lt; F_{\\alpha/2, n-1, m-1}  \\\\\n\\text{拒绝} H_0&, \\quad \\text{否则}\n\\end{align}\n\\]\n上述检验可以通过：\n\n首先，确定检验统计量 \\(\\frac{S_x^2}{S_y^2}\\) 的值——记为 \\(v\\)\n然后，计算 \\(P\\{F_{n-1, m-1} \\leq v\\}\\)，其中 \\(F_{n-1, m-1}\\) 是自由度为 \\(n-1\\) 和 \\(m-1\\) 的 \\(F-\\text{分布}\\) 随机变量\n如果此概率小于 \\(\\alpha/2\\)（当 \\(S_x^2\\) 显著小于 \\(S_y^2\\) 时）或大于 \\(1-\\alpha/2\\)（当 \\(S_x^2\\) 显著大于 \\(S_y^2\\) 时），则拒绝原假设。\n\n换句话说，检验数据的 \\(p-\\text{value}\\) 为：\n\\(p-\\text{value} = 2 \\min \\left( P\\{F_{n-1, m-1} &lt; v\\}, 1 - P\\{F_{n-1, m-1} &lt; v\\} \\right)\\)\n当 \\(p-\\text{value}\\) 小于等于 显著性水平 \\(\\alpha\\) 时，则拒绝原假设。\n\n习题 8.14 有两种不同的催化剂可用于加快某化学反应的过程。为了检验：无论使用哪种催化剂化学反应产物的方差都是相同的，我们使用第一种催化剂生产了 10 批产品，使用第二种催化剂生产了 12 批产品。如果结果数据为： \\(S_1^2 = 0.14\\)、\\(S_2^2 = 0.28\\)，我们能否在 5% 的显著性水平下拒绝方差相等的假设？\n\n\n解 8.12. 使用 R 命令 pf(v, n, m) 来获得具有参数 \\(n\\) 和 \\(m\\) 的 \\(F-\\text{分布}\\) 随机变量小于或等于 \\(v\\) 的概率，我们得到：\n\\(P(F_{9,11} \\leq 0.5) = pf(0.5, 9, 11) = 0.1537596\\)\n因此，\n\\(p-\\text{value} = 2 \\min(0.1537596, 1 - 0.1537596) = 0.3075\\)\n因此，我们不能拒绝方差相等的原假设。\\(\\blacksquare\\)",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>假设检验</span>"
    ]
  },
  {
    "objectID": "chapter_8/8.html#sec-8_6",
    "href": "chapter_8/8.html#sec-8_6",
    "title": "8  假设检验",
    "section": "8.6 二项分布的假设检验",
    "text": "8.6 二项分布的假设检验\n二项分布在工程问题中经常遇到。例如，考虑一种产品生产线，该生产线制造的产品可以分为两类——可接受的或有缺陷的。通常会假设生产的每个产品的缺陷概率为 \\(p\\)，因此一个具有 \\(n\\) 个产品的样本中的缺陷产品数量将是参数为 \\((n, p)\\) 的二项分布。现在考虑以下的假设检验：\n\\(H_0 : p \\le p_0 \\quad vs \\quad H_1 : p &gt; p_0\\)\n其中 \\(p_0\\) 是某个指定的值。\n如果令 \\(X\\) 表示样本大小为 \\(n\\) 的样本中的缺陷数，那么显然当 \\(X\\) 较大时我们希望拒绝 \\(H_0\\)。为了计算在显著性水平 \\(\\alpha\\) 下需要多大的 \\(X\\) 才能证明拒绝是合理的，我们关注到：\n\\(P\\{X \\ge k\\} = \\sum_{i=k}^{n} P\\{X = i\\} = \\sum_{i=k}^{n} \\binom{n}{i} p^i (1 - p)^{n-i}\\)\n现在，很直观（并且可以证明），\\(P\\{X \\ge k\\}\\) 是 \\(p\\) 的递增函数——即，样本中包含至少 \\(k\\) 个缺陷产品的概率随着缺陷概率 \\(p\\) 的增加而增加。使用这一点，我们看到当 \\(H_0\\) 为真时（即 \\(p \\le p_0\\)），\n\\(P\\{X \\ge k\\} \\le \\sum_{i=k}^{n} \\binom{n}{i} p_0^i (1 - p_0)^{n-i}\\)\n因此，显著性水平 \\(\\alpha\\) 下的假设检验\n\\(H_0 : p \\le p_0 \\quad vs \\quad H_1 : p &gt; p_0\\)\n是当 \\(X \\ge k^*\\) 时拒绝 \\(H_0\\)，其中 \\(k^*\\) 是使 \\(\\sum_{i=k}^{n} \\binom{n}{i} p_0^i (1 - p_0)^{n-i} \\le \\alpha\\) 成立的最小的 \\(k\\) 值。也就是说，\n\\(k^* = \\min \\left\\{ k : \\sum_{i=k}^{n} \\binom{n}{i} p_0^i (1 - p_0)^{n-i} \\le \\alpha \\right\\}\\)\n可以通过首先确定检验统计量的值——例如 \\(X = x\\)，然后再计算给定的 \\(p\\)-值 来执行假设检验。\n\\[\n\\begin{align}\np-\\text{value} &= P\\{B(n, p_0) \\ge x\\} \\\\\n&= \\sum_{i=x}^{n}{\\left(\\begin{array}{cc}  n \\\\ i  \\end{array}\\right)p_0^i(1-p_0)^{n-i}}\n\\end{align}\n\\]\n\n习题 8.15 一家电脑芯片制造商声称他们出售的芯片的缺陷率不超过 2%。一家电子公司对这家芯片公司的声明印象深刻，并购买了该芯片公司生产的大量芯片。为了确定芯片制造商的声明的可信性，该电子公司决定测试 300 个芯片样本。如果最终发现这 300 个芯片中有 10 个是有缺陷的，那么是否应该拒绝芯片制造商的声明？\n\n\n解 8.13. 让我们在 5% 的显著性水平上检测制造商的声明。为了判断是否需要拒绝制造商 2% 缺陷率的声明，我们需要计算当 \\(p\\) 等于 0.02 时，300 个样本中出现 10 个或更多个缺陷产品的概率。也就是说，我们需要计算 \\(p-\\text{value}\\)。如果 \\(p-\\text{value}\\) 小于或等于 0.05，那么就应该拒绝制造商 2% 缺陷率的声明。\n\\[\n\\begin{align}\nP_{0.02}\\{X \\ge 10\\} &= 1 - P_{0.02}\\{X \\le 9\\} \\\\\n&= 1 - pbinom(9, 300, 0.02) \\\\\n&= 0.08183807\n\\end{align}\n\\]\n因此，在显著性水平为 0.05 时，我们不能拒绝芯片制造商的声明。\n\n\n\n\n\n\n注记\n\n\n\n当然，在 R 中，我们可以使用 binom.test() 来直接根据实验结果计算二项分布的 \\(p-\\text{value}\\)。\n\n\n代码\nbinom.test(10, 300, 0.02, \"greater\")\n\n\n\n    Exact binomial test\n\ndata:  10 and 300\nnumber of successes = 10, number of trials = 300, p-value = 0.08184\nalternative hypothesis: true probability of success is greater than 0.02\n95 percent confidence interval:\n 0.01819384 1.00000000\nsample estimates:\nprobability of success \n            0.03333333 \n\n\n\n\n\\(\\blacksquare\\)\n\n\n习题 8.16 为了证明编辑 A 优于编辑 B，给两位编辑提供了一份相同的稿件。如果编辑 A 发现了 28 个错误，而编辑 B 发现了 18 个错误，其中有 10 个错误两人都发现了，我们能否得出编辑 A 更优秀的结论？\n\n\n解 8.14. 需要注意的是，A 发现了 B 未发现的 18 个错误，B 发现了 A 未发现的 8 个错误。因此，仅由一人发现的错误总数为 26 个。如果 A 和 B 的能力相当，那么他们单独发现某个错误的概率是相等的，即为 1/2。因此，为了证明 A 是更好的编辑，26 次试验中 18 次成功的结果必须足够强大以拒绝以下假设：\n\\(H_0: p \\leq 1/2 \\quad vs \\quad H_1: p &gt; 1/2\\)\n其中，\\(p\\) 是伯努利试验成功的概率。对于实验数据的 \\(p-\\text{value}\\) 为：\n\\(p-\\text{value} = P\\{B(26, 0.5) \\geq 18\\} = 0.03776\\)\n因此，在 5% 的显著性水平下，我们将拒绝原假设，所以可以得出结论：在 5% 的显著性水平下，A 是更优秀的编辑。 \\(\\blacksquare\\)\n\n当样本量 \\(n\\) 较大时，我们可以通过正态分布逼近二项分布来推导显著性水平为 \\(\\alpha\\) 的 \\(H_0: p \\leq p_0 \\quad vs \\quad H_1: p &gt; p_0\\) 的近似检验。其原理如下：因为当 \\(n\\) 较大时，随机变量 \\(X\\) 将近似服从均值为\n\\(E[X] = np\\)\n方差为\n\\(\\text{Var}(X) = np(1-p)\\)\n的正态分布，因此\n\\(\\frac{X - np}{\\sqrt{np(1-p)}}\\)\n将近似服从标准正态分布。因此，显著性水平为 \\(\\alpha\\) 的近似检验为：\n\\(\\text{拒绝} H_0, \\quad \\text{如果} \\frac{X - np_0}{\\sqrt{np_0(1-p_0)}} \\geq z_\\alpha\\)\n同样的，也可以使用正态分布来近似来计算 \\(p-\\text{value}\\)。\n\n例 8.3 在 习题 8.15 中，\\(np_0 = 300 \\times 0.02 = 6\\)，且 \\(\\sqrt{np_0(1-p_0)} = \\sqrt{5.88}\\)。因此，由数据 \\(X = 10\\) 得出的 \\(p-\\text{value}\\) 为\n\\(\\begin{align} p-\\text{value} &= P_{0.02}\\{X \\geq 10\\} \\\\ &= P_{0.02}\\{X \\geq 9.5\\} \\\\ &P_{0.02}\\left\\{\\frac{X - 6}{\\sqrt{5.88}} \\geq \\frac{9.5 - 6}{\\sqrt{5.88}}\\right\\} \\\\ &\\approx P\\{Z \\geq 1.443\\} \\\\ &= 0.0745 \\end{align}\\)\n因此，精确的 \\(p-\\text{value}\\) 为 0.0818，正态分布给出的近似 \\(p-\\text{value}\\) 为 0.0745。\n\n假设我们现在希望检验 \\(p\\) 等于某个指定值的原假设，即我们希望检验\n\\(H_0: p = p_0 \\quad vs \\quad H_1: p \\neq p_0\\)\n如果一个具有参数 \\(n\\) 和 \\(p\\) 的二项随机变量 \\(X\\) 的观测值等于 \\(x\\)，如果 \\(x\\) 的值显著大于或显著小于在 \\(p = p_0\\) 时的预期值，那么显著性水平为 \\(\\alpha\\) 的检验将拒绝原假设 \\(H_0\\)。更准确地说，当以下任意一项成立时，检验将拒绝 \\(H_0\\)：\n\\(P\\{B(n, p_0) \\geq x\\} \\leq \\alpha/2 \\quad \\text{或} \\quad P\\{B(n, p_0) \\leq x\\} \\leq \\alpha/2\\)\n换句话说，当 \\(X = x\\) 时的 \\(p-\\text{value}\\) 为\n\\(p-\\text{value} = 2 \\min \\left(P\\{B(n, p_0) \\geq x\\}, P\\{B(n, p_0) \\leq x\\}\\right)\\)\n\n习题 8.17 历史数据显示，某制造商生产的组件中有 4% 是不合格的。该制造商最近刚刚结束了一场特别激烈的劳资纠纷，所以管理层想知道该劳资纠纷是否会导致 不合格率的变化。如果随机抽取的 500 个样品中有 16 个不合格品（占比 3.2%），在显著性水平为 5% 的情况下，是否足以证明不合格率确实发生了变化？\n\n\n解 8.15. 需要足够强的数据支撑，以使得我们在检验以下的假设时拒绝原假设，才能够得出不合格率发生了变化的结论：\n\\(H_0: p = 0.04 \\quad vs \\quad H_1: p \\neq 0.04\\)\n其中 \\(p\\) 是单个组件不合格的概率。500 个样品中有 16 个不合格品的数据的 \\(p-\\text{value}\\) 为：\n\\(p\\text{-value} = 2 \\min\\{P\\{X \\leq 16\\}, P\\{X \\geq 16\\}\\}\\)\n其中 \\(X\\) 是一个二项式随机变量 \\(\\text{binomial}(500, 0.04)\\)。因为 \\(500 \\times 0.04 = 20\\)，我们得知：\n\\(p\\text{-value} = 2P\\{X \\leq 16\\}\\)\n由于 \\(X\\) 的均值为 20，标准差为 \\(\\sqrt{20 \\times 0.96} \\approx 4.38\\)，显然 \\(X\\) 小于等于 16 的概率是比均值小于一个标准差的概率略小的一个值，该值的两倍并非足够小以允许我们拒绝原假设。事实上，可以证明：\n\\(p-\\text{value} = 2P\\{X \\leq 16\\} = 0.43161\\)\n因此，没有足够的证据拒绝原假设，即不合格品率仍将保持不变。\\(\\blacksquare\\)\n\n\n8.6.1 检验两个伯努利总体的参数是否相同\n假设某类型的芯片有两种不同的生产方法，并且假设第一种生产方法生产的芯片的缺陷率为 \\(p_1\\)，而第二种生产方法生产的芯片的缺陷率为 \\(p_2\\)。为了检验假设 \\(p_1 = p_2\\)，我们使用第一种方法生产了 \\(n_1\\) 个芯片作为样本 1，使用第二种方法生产了 \\(n_2\\) 个芯片作为样本 2。\n令 \\(X_1\\) 表示样本 1 中的缺陷芯片的数量，\\(X_2\\) 表示样本 2 中的缺陷芯片的数量。因此，\\(X_1\\) 和 \\(X_2\\) 是相互独立的二项分布随机变量，其参数分别为 \\((n_1, p_1)\\) 和 \\((n_2, p_2)\\)。假设 \\(X_1 + X_2 = k\\)，那么两个样本总共有 \\(k\\) 个缺陷品。\n如果 \\(H_0\\)（\\(p_1 = p_2\\)）成立，那么 \\(n_1 + n_2\\) 个芯片中的每一个都有相同的概率成为缺陷品。因此 \\(k\\) 个缺陷品的分布与从一个包含 \\(n_1 + n_2\\) 个物品（其中 \\(n_1\\) 是白色物品， \\(n_2\\) 是黑色物品）中随机抽取 \\(k\\) 个样本的分布相同。换句话说，给定总共 \\(k\\) 个缺陷品，当 \\(H_0\\) 成立时，使用第一种方法得到的缺陷品数量的条件分布将具有以下的超几何分布：\n\\[\nP_{H_0}\\{X_1 = i | X_1 + X_2 = k\\} = \\frac{\\binom{n_1}{i}\\binom{n_2}{k-i}}{\\binom{n_1+n_2}{k}}, \\quad i = 0, 1, \\ldots, k\n\\tag{8.30}\\]\n在检验 \\(H_0: p_1 = p_2 \\quad vs \\quad H_1: p_1 \\neq p_2\\) 时，当使用第一种方法生产的缺陷芯片比例与使用第二种方法生产的缺陷芯片比例差异很大时，似乎可以合理地拒绝原假设。因此，如果总共存在 \\(k\\) 个缺陷品，那么当 \\(H_0\\) 成立时，我们预计 \\(X_1/n_1\\)（使用第一种方法生产的缺陷芯片比例）将接近于 \\((k - X_1)/n_2\\) （使用第二种方法生产的缺陷芯片比例）。当 \\(X_1\\) 非常小或非常大时，\\(X_1/n_1\\) 和 \\((k - X_1)/n_2\\) 之间的差异会比较大，因此，合理的显著性水平 \\(\\alpha\\) 的检验如下所示。\n当 \\(X_1 + X_2 = k\\) 时，\n\\[\n\\begin{align}\n\\text{拒绝} H_0 &, \\quad \\text{如果} P\\{X \\leq x_1\\} \\leq \\alpha/2 \\quad \\text{ 或 } \\quad P\\{X \\geq x_1\\} \\leq \\alpha/2 \\\\\n\\text{接受} H_0 &, \\quad 否则\n\\end{align}\n\\]\n其中 \\(X\\) 是具有以下概率质量函数的超几何随机变量：\n\\[\nP\\{X = i\\} = \\frac{\\binom{n_1}{i}\\binom{n_2}{k-i}}{\\binom{n_1+n_2}{k}}, \\quad i = 0, 1, \\ldots, k\n\\tag{8.31}\\]\n\\[\np-\\text{value} = 2 \\min(P\\{X \\leq x_1\\}, P\\{X \\geq x_1\\})\n\\tag{8.32}\\]\n换句话说，如果显著性水平至少为 \\(\\alpha\\) 大于等于 \\(p-\\text{value}\\)，我们将拒绝原假设。这种检验也称之为 Fisher-Irwin 检验。\n可以通过使用 R 命令 phyper(x, n, m, k) 来计算 式 8.32 的概率，该命令用于计算超几何随机变量的概率，其参数 \\(n, m, k\\) 代表从一个包含 \\(n\\) 个红球和 \\(m\\) 个蓝球的盒子中随机抽取 \\(k\\) 个球时，抽取的红球数量小于或等于 \\(x\\) 的概率。\n\n\n\n\n\n\nfisher.test() 和列联表\n\n\n\n在 R 中，可以直接使用 fisher.test() 来计算 式 8.32 所示的 \\(p-\\text{value}\\)。\n要使用 R 的 fisher.test 来检验两个二项分布的参数 \\(p\\) 是否一致，首先需要将两个二项分布的结果组织成一个 \\(2 \\times 2\\) 的列联表。这个列联表表示两个分布的成功和失败次数。然后，使用 fisher.test 来检验两个分布是否独立，从而间接检验它们的参数 \\(p\\) 是否一致。\n\n列联表（contingency table）是按两个或更多属性对数据分类后所列出的对应分类的频数表，是由两个以上的变量进行交叉分类的频数分布表。\n\n\n准备数据：假设我们有两个二项分布的结果，分别记录了其成功次数和失败次数。\n\n假设 A 有 8 次成功，2 次失败。\nB 有 5 次成功，5 次失败。\n\n将如上分布数据组织成如下的 \\(2 \\times 2\\) 列联表：\ndata &lt;- matrix(c(8, 2, 5, 5), nrow = 2, byrow = TRUE)\ncolnames(data) &lt;- c(\"Success\", \"Failure\")\nrownames(data) &lt;- c(\"Distribution A\", \"Distribution B\")\nprint(data)\n输出的表格将是：\n                Success Failure\nDistribution A        8       2\nDistribution B        5       5\n执行 Fisher 精确检验：\nresult &lt;- fisher.test(data)\nprint(result)\n解释结果：\nfisher.test 的结果将包括 \\(p-\\text{value}\\) 以用来判断两个分布的成功率 \\(p\\) 是否显著不同。\nFisher's Exact Test for Count Data\n\ndata:  data\np-value = 0.315\nalternative hypothesis: true odds ratio is not equal to 1\n95 percent confidence interval:\n  0.2943 19.3332\nsample estimates:\nodds ratio \n      3.98 \n\np-value: 如果 \\(p-\\text{value}\\) 值大于 0.05，则我们不能拒绝原假设，即没有足够证据表明两个分布的成功率（p 值）不一致。\nodds ratio: 估计的优势比，这里为 3.98，表示 A 的成功与 B 的成功的比率。\n95 percent confidence interval: 这是对优势比的 95% 置信区间。\n\n\n在 R 的 fisher.test() 中，列联表的行和列的顺序对计算结果的 p-value 和 odds ratio 等值均没有影响，即便如此，我们最好还是按照行优先来组织列联表，以保障结果的可解释性。\n\np-value 不受影响：\n\nFisher 精确检验的核心是计算列联表中不同行和列组合下观察到的频率是否显著偏离了独立性假设。这个计算基于全排列的可能性，所以 p-value 不受行列顺序的影响。\n换句话说，无论你如何排列列联表的行和列，p-value 会保持一致，因为 Fisher 精确检验本质上是一种对称性检验。\n\nodds ratio 不受影响：\n\n具体来说，odds ratio 是通过下列公式计算的：\\(\\text{odds ratio} = \\frac{(a \\times d)}{(b \\times c)}\\)，其中：\n\na 是第一行第一列的值\nb 是第一行第二列的值\nc 是第二行第一列的值\nd 是第二行第二列的值\n\n根据 odds ratio 的计算公式可知，对于列联表而言，无论是行优先、还是列优先的存储方式，都不会影响最终的结果，但是为了保障可解释性，我们最好还是按照行优先来组织列联表，即：\n           Success Failure\nGroup A        8       2\nGroup B        5       5\n\n\n\n\n\n习题 8.18 假设方法 1 生产的 100 个晶体管中有 20 个不合格，而方法 2 生产的 100 个晶体管中有 12 个不合格。我们能否以 10% 的显著性水平得出这两种方法是等效的这样的结论？\n\n\n解 8.16. 利用 R，我们得到如下的数据：\n\\(\\begin{align} p-\\text{value} & = 2 \\min(P(X \\leq 20), \\, P(X \\geq 20)) \\\\ &= 2 \\min(P(X \\leq 20), \\, 1 - P(X \\leq 19)) \\\\ & =2 \\times \\min(\\text{phyper}(20, 100, 100, 32), \\, 1 - \\text{phyper}(19, 100, 100, 32)) \\\\ &= 0.1763396 \\end{align}\\)\n在上述计算中使用了 R 函数 min(x, y)，该函数返回 \\(x\\) 和 \\(y\\) 中的最小值。根据 \\(p-\\text{value}\\) 的值，我们无法拒绝这两种方法是等效的假设。\n\n\n\n\n\n\n注记\n\n\n\n更简单的，我们可以直接使用 R 中的 fisher.test() 来计算 \\(p-\\text{value}\\)。\n\ndata &lt;- matrix(c(20, 80, 12, 88), ncol=2, byrow=TRUE)\nrownames(data) &lt;- c(\"Method 1\", \"Method 2\")\ncolnames(data) &lt;- c(\"Unacceptable\", \"Acceptable\")\nfisher.test(data)\n\n\n    Fisher's Exact Test for Count Data\n\ndata:  data\np-value = 0.1763\nalternative hypothesis: true odds ratio is not equal to 1\n95 percent confidence interval:\n 0.792462 4.381294\nsample estimates:\nodds ratio \n  1.827794 \n\n\n\n\n\\(\\blacksquare\\)\n\n检验两种不同治疗方法效果是否相同的理想方法是将一组人随机分成两组，一组接受第一种治疗方法，另一组接受第二种治疗方法。然而，这种随机分组的方式并非总是万能的。例如，如果我们想研究饮酒是否会增加患前列腺癌的风险，我们不能让随机选择的样本人群去饮酒。观察性研究（observational study）是研究这种假设的另一种方法，这种方法：\n\n首先，随机选择一组饮酒人群和一组不饮酒人群\n然后，在一段时间内跟踪这些随机选择的人群\n最后，使用所得到的跟踪数据来检验假设并判断这两组人群患前列腺癌的风险是否相同\n\n接下来的 例 8.4 展示了实现 观察性研究 的另一种方法。\n\n例 8.4 1970 年，研究人员 Herbst、Ulfelder 和 Poskanzer (H-U-P) 怀疑年轻女性中一种相当罕见的疾病——阴道癌，可能是由于她们的母亲在怀孕期间服用了己烯雌酚（Diethylstilbestrol，通常称为 DES）而引起的。为了研究这种可能性，研究人员可以通过搜索获得一组在其母亲怀孕时服用了 DES 的女性（实验组（treatment））和一组在其母亲怀孕时没有服用 DES 的女性（对照组（control））来进行 观察性研究。然后，研究人员可以在一段时间内去观察这些不同组的人群，并使用所得到的数据进行检验假设——即这两组不同人群的阴道癌发病概率是否相同。然而，对于这两组人群而言，阴道癌都非常罕见，所以这样的研究需要具备较大的群体规模，并且还需要跟踪观察多年才能获得一个显著的结果。因此，H-U-P 决定采用另一种不同的 观察性研究 方法。他们发现了年龄在 15 至 22 岁之间的患有阴道癌的 8 名女性。这些女性（称为病例）中的每一名都与 4 名其他女性（称为参照（referents）或对照(controls)）进行了匹配。每个病例的任何一个参照者都没有患癌症，并且与对应病例出生在相同医院的、相同类型的房间（无论是私人房间还是公共房间），同时其出生日期相差不超过 5 天。研究人员认为，如果 DES 对阴道癌没有影响，那么病例的母亲服用了 DES 的概率 \\(p_c\\) 应该与参照者的母亲服用了 DES 的概率 \\(p_r\\) 相同，所以 H-U-P 决定检验以下假设：\n\\(H_0 : p_c = p_r \\quad vs \\quad H_1 : p_c \\neq p_r\\)\n研究发现，8 个病例中有 7 个病例的母亲在怀孕时服用了 DES，而 32 个参照者中没有一个参照者的母亲服用了该药物。研究人员1得出结论：DES 与阴道癌之间存在强关联（这些数据的 \\(p-\\text{value}\\) 约等于 0）。\n\n\n\n\n\n\n注记\n\n\n\n\ndata &lt;- matrix(c(7, 1, 0, 32), ncol = 2, byrow = TRUE)\nrownames(data) &lt;- c(\"Treatment\", \"Control\")\ncolnames(data) &lt;- c(\"C\", \"NC\")\ndata\n\n          C NC\nTreatment 7  1\nControl   0 32\n\nfisher.test(data)\n\n\n    Fisher's Exact Test for Count Data\n\ndata:  data\np-value = 4.291e-07\nalternative hypothesis: true odds ratio is not equal to 1\n95 percent confidence interval:\n 15.42963      Inf\nsample estimates:\nodds ratio \n       Inf \n\n\n\n\n\\(\\blacksquare\\)\n\n当样本量 \\(n1\\) 和 \\(n2\\) 比较大时，我们可以通过正态分布逼近二项分布来推导显著性水平为 \\(\\alpha\\) 时的原假设 \\(H_0: p_1 = p_2\\) 的近似检验，具体参见：习题 63。",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>假设检验</span>"
    ]
  },
  {
    "objectID": "chapter_8/8.html#sec-8_7",
    "href": "chapter_8/8.html#sec-8_7",
    "title": "8  假设检验",
    "section": "8.7 关于泊松分布的均值的假设检验",
    "text": "8.7 关于泊松分布的均值的假设检验\n令 \\(X\\) 表示一个均值为 \\(\\lambda\\) 的泊松分布随机变量，我们希望检验如下的假设：\n\\(H_0 : \\lambda = \\lambda_0 \\quad vs \\quad H_1 : \\lambda \\neq \\lambda_0\\)\n如果观察到的 \\(X\\) 的值为 \\(X = x\\)，那么当以下任一条件成立时，显著性水平为 \\(\\alpha\\) 时的检验将拒绝 \\(H_0\\)：\n\\[\nP_{\\lambda_0} \\{ X \\geq x \\} \\leq \\alpha / 2 \\quad \\text{或} \\quad P_{\\lambda_0} \\{ X \\leq x \\} \\leq \\alpha / 2\n\\tag{8.33}\\]\n其中，\\(P_{\\lambda_0}\\) 表示在泊松分布的均值为 \\(\\lambda_0\\) 的假设下计算的概率。根据 式 8.33，\\(p-\\text{value}\\) 的计算方式为：\n\\(\\text{p-value} = 2 \\min \\left( P_{\\lambda_0} \\{ X \\geq x \\}, P_{\\lambda_0} \\{ X \\leq x \\} \\right)\\)\n可以利用 R 中的 ppois(x, lamda_0) 计算 \\(P_{\\lambda_0} \\{ X \\geq x \\}\\) 或者 P_{_0} { X x } 的概率。\n\n习题 8.19 某芯片制造商的管理层声称：每天生产的计算机芯片中，存在缺陷的芯片的平均数量不超过 25 个，但是有人质疑管理层的这一说法。为了检验管理层这一说法，抽取了 5 天生产的产品作为样本，样本显示这 5 天的缺陷芯片个数分别是：28、34、32、38、22。在 5% 的显著性水平下，检验管理层的说法是否成立。\n\n\n解 8.17. 对于每个计算机芯片而言，检测到其有缺陷的可能性非常小，因此，假设每天生产的芯片中存在缺陷的芯片数量近似服从均值为 \\(\\lambda\\) 的泊松分布是合理的。为了确定管理层的说法是否可靠，我们将检验如下假设：\n\\(H_0: \\lambda \\leq 25 \\quad vs \\quad H_1: \\lambda &gt; 25\\)\n在 \\(H_0\\) 下，5 天内生产的芯片中存在缺陷的芯片总数也服从泊松分布（独立的泊松分布随机变量的和也服从泊松分布），并且其均值不超过 125。由于观察到 5 天的缺陷芯片数量总数为 154，因此 \\(p-\\text{value}\\) 为：\n\\(\\begin{align} p-\\text{value} &= P_{125}\\{X \\geq 154\\} \\\\ &= 1 - P_{125}\\{X \\leq 153\\} \\\\ &= 1 - \\text{ppois}(153, 125) \\\\ &= 0.006664794 \\end{align}\\)\n因此，在 5% 的显著性水平下（甚至在 1% 的显著性水平下），我们将拒绝管理层的说法。\\(\\blacksquare\\)\n\n\n8.7.1 检验两个泊松分布的参数之间的关系\n令 \\(X_1\\) 和 \\(X_2\\) 为独立的泊松分布随机变量，其均值分别为 \\(\\lambda_1\\) 和 \\(\\lambda_2\\)，考虑检验如下的假设：\n\\(H_0 : \\lambda_2 = c\\lambda_1 \\quad vs \\quad H_1 : \\lambda_2 \\neq c\\lambda_1\\)\n其中，\\(c\\) 为给定的常数。\n如上假设的检验是一个条件检验（a conditional test），其本质类似于 小节 8.6.1 中的 Fisher-Irwin 检验。在给定 \\(X_1 + X_2\\) 下，\\(X_1\\) 的条件概率分布服从二项分布，基于这一事实，我们有 命题 8.1。\n\n命题 8.1 \\(P\\{X_1 = k \\mid X_1 + X_2 = n\\} = \\binom{n}{k} \\left[\\frac{\\lambda_1}{\\lambda_1 + \\lambda_2}\\right]^k \\left[\\frac{\\lambda_2}{\\lambda_1 + \\lambda_2}\\right]^{n-k}\\)\n\n证. \\[\n\\begin{align}\nP\\{X_1 = k \\mid X_1 + X_2 = n\\} &= \\frac{P\\{X_1 = k, X_1 + X_2 = n\\}}{P\\{X_1 + X_2 = n\\}} \\\\\n&= \\frac{P\\{X_1 = k, X_2 = n - k\\}}{P\\{X_1 + X_2 = n\\}} \\\\\n&= \\frac{P\\{X_1 = k\\} P\\{X_2 = n - k\\}}{P\\{X_1 + X_2 = n\\}} \\quad \\text{（由于独立性）} \\\\\n&= \\frac{\\exp\\{-\\lambda_1\\} \\lambda_1^k / k! \\cdot \\exp\\{-\\lambda_2\\} \\lambda_2^{n-k} / (n-k)!}{\\exp\\{-(\\lambda_1 + \\lambda_2)\\} (\\lambda_1 + \\lambda_2)^n / n!} \\\\\n&= \\frac{n!}{(n-k)!k!} \\left[\\frac{\\lambda_1}{\\lambda_1 + \\lambda_2}\\right]^k \\left[\\frac{\\lambda_2}{\\lambda_1 + \\lambda_2}\\right]^{n-k}\n\\end{align}\n\\]\n其中，倒数第二个等式成立的原因是：独立泊松随机变量的和也是泊松分布。\\(\\blacksquare\\)\n\n\n根据 命题 8.1 可知，如果 \\(H_0\\) 为真，那么在给定 \\(X_1 + X_2\\) 下，\\(X_1\\) 的条件概率分布是参数为 \\((n, p = \\frac{1}{1 + c})\\) 的二项分布。因此，我们可以得出结论：如果 \\(X_1 + X_2 = n\\)，如果我们观察到 \\(X_1\\) 的值为 \\(x_1\\)，那么如果满足以下条件中的任何一个，则应拒绝 \\(H_0\\)：\n\\[\n\\begin{align}\n&P\\{\\text{B}(n, 1/(1+c)) \\geq x_1\\} \\leq \\alpha/2 \\\\\n&或 \\\\\n&P\\{\\text{B}(n, 1/(1+c)) \\leq x_1\\} \\leq \\alpha/2\n\\end{align}\n\\tag{8.34}\\]\n\n习题 8.20 一家企业经营着两个大型的工厂。如果工厂 1 在过去 8 周内发生的事故数量分别为 16、18、9、22、17、19、24、8，工厂 2 在过去 6 周内发生的事故数量分别为 22、18、26、30、25、28，我们是否可以在 5% 的显著性水平下得出这两个工厂的安全条件存在差异的结论？\n\n\n解 8.18. 对于任何一分钟而言，发生工业事故的概率很小，因此每周发生的此类事故的数量应大致符合泊松分布。如果我们令 \\(X_1\\) 表示工厂 1 在 8 周期间发生的事故总数，\\(X_2\\) 表示工厂 2 在 6 周期间发生的事故总数，那么如果两个工厂的安全条件没有差异，我们将有：\n\\(\\lambda_2 = \\frac{3}{4}\\lambda_1\\)\n其中 \\(\\lambda_i \\equiv E[X_i],\\ i = 1, 2\\)。\n由于 \\(X_1 = 133\\), \\(X_2 = 149\\)，根据 式 8.34，该检验的 \\(p-\\text{value}\\) 为：\n\\(p-\\text{value} = 2\\min \\left( P\\{\\text{B}(282, \\frac{4}{7}) \\geq 133\\}, P\\{\\text{B}(282, \\frac{4}{7}) \\leq 133\\} \\right)\\)\n即， \\(p-\\text{value} = 9.408 \\times 10^{-4}\\)\n因此，我们将拒绝原假设：两个工厂的安全条件相同。 \\(\\blacksquare\\)",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>假设检验</span>"
    ]
  },
  {
    "objectID": "chapter_8/8.html#problems",
    "href": "chapter_8/8.html#problems",
    "title": "8  假设检验",
    "section": "Problems",
    "text": "Problems",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>假设检验</span>"
    ]
  },
  {
    "objectID": "chapter_8/8.html#footnotes",
    "href": "chapter_8/8.html#footnotes",
    "title": "8  假设检验",
    "section": "",
    "text": "Herbst, A., Ulfelder, H., and Poskanzer, D., Adenocarcinoma of the Vagina: Association of Maternal Stilbestrol Therapy with Tumor Appearance in Young Women, New England Journal of Medicine, 284, 878-881, 1971↩︎",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>假设检验</span>"
    ]
  },
  {
    "objectID": "chapter_9/9.html",
    "href": "chapter_9/9.html",
    "title": "9  回归",
    "section": "",
    "text": "9.1 引言\n工程和科学中的许多问题都涉及到：确定一组变量之间的关系。例如，在化学反应中，我们可能对化学反应的产物、反应时的温度以及所用催化剂的用量之间的关系感兴趣。了解这种不同变量之间的关系可以使我们预测不同温度和催化剂用量下的反应产物。\n在许多情况下，存在一个单一的 响应变量（response variable）——也称之为 因变量（dependent variable）—— \\(Y\\)。因变量 \\(Y\\) 依赖于一组 输入变量（input variables）——也称之为 自变量（independent variables）——\\(x_1, \\ldots, x_r\\) 的值。最简单的 因变量 \\(Y\\) 和 自变量 \\(x_1, \\ldots, x_r\\) 之间的关系类型是线性关系。即，对于一组常数 \\(\\beta_0, \\beta_1, \\ldots, \\beta_r\\)，先行关系的等式为：\n\\[\nY = \\beta_0 + \\beta_1 x_1 + \\cdots + \\beta_r x_r\n\\tag{9.1}\\]\n如果 \\(Y\\) 和 \\(x_i\\) 之间的关系如 式 9.1 所示，那么一旦学习到 \\(\\beta_i\\)，我们就可以准确预测任意一组输入值的 \\(Y\\)。然而，实际上，几乎无法实现 100% 的精确预测，我们最多可以期望 式 9.1 在随机误差下（subject to random error）是有效的。此时，式 9.1 将表示为：\n\\[\nY = \\beta_0 + \\beta_1 x_1 + \\cdots + \\beta_r x_r + e\n\\tag{9.2}\\]\n其中 \\(e\\) 表示随机误差，并假设随机误差是均值为 0 的随机变量。实际上，式 9.2 的另一种表达为：\n\\[\nE[Y|\\mathbf{x}] = \\beta_0 + \\beta_1 x_1 + \\cdots + \\beta_r x_r\n\\tag{9.3}\\]\n其中 \\(\\mathbf{x} = (x_1, \\ldots, x_r)\\) 是 自变量，\\(E[Y|\\mathbf{x}]\\) 是在给定输入 \\(\\mathbf{x}\\) 下的结果的期望。\n我们称 式 9.2 为 线性回归方程（linear regression equation）。式 9.2 描述了 因变量 \\(Y\\) 对一组 自变量 \\(x_1, \\ldots, x_r\\) 的回归。我们称 \\(\\beta_0, \\beta_1, \\ldots, \\beta_r\\) 为 回归系数（regression coefficients），并且通常需要通过估计得到 回归系数。如果回归方程中只包含一个 自变量——即 \\(r=1\\)，我们称之为 简单回归方程（simple regression equation）；相比之下，如果回归方程包含多个 自变量，我们称之为 多元回归方程（multiple regression equation）。\n因此，简单线性回归模型假设 \\(Y\\) 的均值与单个 自变量 的值之间存在线性关系，即：\n\\[\nY = \\alpha + \\beta x + e\n\\tag{9.4}\\]\n其中，\\(x\\) 是自变量的值，也称为 输入水平（input level），\\(Y\\) 是对应的输出，\\(e\\) 代表均值为 0 的随机误差。",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>回归</span>"
    ]
  },
  {
    "objectID": "chapter_9/9.html#sec-9_1",
    "href": "chapter_9/9.html#sec-9_1",
    "title": "9  回归",
    "section": "",
    "text": "术语说明\n\n\n\n在回归分析中，而对于因变量和自变量的取值会有多种描述，例如对于：\n\n因变量的取值：输出，结果，响应值（response values）\n自变量的取值：输入，输入水平（input level）\n\n我们在后续的章节中，会根据具体的场景来穿插使用这些术语。\n\n\n\n例 9.1 考虑以下 10 对数据 \\((x_i, y_i), i = 1, \\ldots, 10\\)，其中 \\(y\\) 是实验的百分比产量，\\(x\\) 是实验温度。\n\\[\n\\begin{array}{ccc|ccc}\ni & x_i & y_i & i & x_i & y_i \\\\\n1 & 100 & 45 & 6 & 150 & 68 \\\\\n2 & 110 & 52 & 7 & 160 & 75 \\\\\n3 & 120 & 54 & 8 & 170 & 76 \\\\\n4 & 130 & 63 & 9 & 180 & 92 \\\\\n5 & 140 & 62 & 10 & 190 & 88 \\\\\n\\end{array}\n\\]\n如上数据的散点图（scatter diagram）如 图 9.1 所示。\n\n\n代码\nlibrary(ggplot2)\nx &lt;- seq(100, 190, 10)\ny &lt;- c(45, 52, 54, 63, 62, 68, 75, 76, 92, 88)\ndf &lt;- data.frame(x = x, y = y)\n\nggplot(df, aes(x = x, y = y)) + \n  geom_point() + \n  scale_x_continuous(breaks = seq(100, 200, 20), limits = c(100, 200)) +\n  scale_y_continuous(breaks = seq(40, 100, 10), limits = c(40, 100))\n\n\n\n\n\n\n\n\n图 9.1: 散点图\n\n\n\n\n\n正如 图 9.1 的散点图所显示的那样，受随机误差的影响，\\(y\\) 和 \\(x\\) 之间似乎存在线性关系。因此，看起来，对于本例的数据而言，简单线性回归模型似乎是合适的。\\(\\blacksquare\\)",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>回归</span>"
    ]
  },
  {
    "objectID": "chapter_9/9.html#sec-9_2",
    "href": "chapter_9/9.html#sec-9_2",
    "title": "9  回归",
    "section": "9.2 回归参数的最小二乘估计",
    "text": "9.2 回归参数的最小二乘估计\n假设对于输入值 \\(x_i\\)（\\(i = 1, \\ldots, n\\)）的输出为 \\(Y_i\\)，我们将这些数据作为观察值并用于估计简单线性回归模型（式 9.4）中的 \\(\\alpha\\) 和 \\(\\beta\\)。\n为了确定 \\(\\alpha\\) 和 \\(\\beta\\) 的估计，我们作如下推理：如果 \\(A\\) 是 \\(\\alpha\\) 的估计，\\(B\\) 是 \\(\\beta\\) 的估计，那么输入变量 \\(x_i\\) 的输出估计将是 \\(A + Bx_i\\)。由于实际输出是 \\(Y_i\\) ，因此实际输出和输出估计之间的平方差为 \\((Y_i - A - Bx_i)^2\\)，因此如果 \\(A\\) 和 \\(B\\) 是 \\(\\alpha\\) 和 \\(\\beta\\) 的估计，那么输出估计值和实际输出值之间的平方差的和（SS: the sum of the squared）为：\n\\[\nSS = \\sum_{i=1}^n (Y_i - A - Bx_i)^2\n\\tag{9.5}\\]\n最小二乘法（the least squares）选择让 SS 达到最小值的 \\(A\\) 和 \\(B\\) 以作为 \\(\\alpha\\) 和 \\(\\beta\\) 的估计。为了确定 \\(A\\) 和 \\(B\\)，我们首先对 SS 进行微分运算：\n\\(\\frac{\\partial SS}{\\partial A} = -2 \\sum_{i=1}^n (Y_i - A - Bx_i)\\)\n\\(\\frac{\\partial SS}{\\partial B} = -2 \\sum_{i=1}^n x_i (Y_i - A - Bx_i)\\)\n令偏导数为零，得到令 \\(A\\) 和 \\(B\\) 最小化的方程：\n\\[\n\\begin{align}\n\\sum_{i=1}^n Y_i &= nA + B \\sum_{i=1}^n x_i \\\\\n\\sum_{i=1}^n x_i Y_i &= A \\sum_{i=1}^n x_i + B \\sum_{i=1}^n x_i^2\n\\end{align}\n\\tag{9.6}\\]\n我们称 式 9.6 为 正规方程（the normal equations）。如果令：\n\\(\\overline{Y} = \\sum_i Y_i / n, \\quad \\overline{x} = \\sum_i x_i / n\\)\n那么我们可以将第一个 正规方程 写为：\n\\[\nA = \\overline{Y} - B \\overline{x}\n\\tag{9.7}\\]\n把 \\(A\\) 的代入到第二个 正规方程 得到：\n\\(\\sum_{i}{x_iY_i} = (\\overline{Y}-B\\overline{x})n\\overline{x} + B \\sum_{i}{x_i^2}\\)\n即，\\(B\\bigg(\\sum_i{x_i^2} - n \\overline{x}^2\\bigg)=\\sum_i{x_iY_i} - n\\overline{x}\\overline{Y}\\)\n即，\\(B = \\frac{\\sum_i{x_iY_i} - n\\overline{x}\\overline{Y}}{\\sum_i{x_i^2} - n \\overline{x}^2}\\)\n因此，根据 式 9.7 和 \\(n\\overline{Y}=\\sum_{i=1}^{n}{Y_i}\\)，我们可以证明 命题 9.1。\n\n命题 9.1 在数据集 \\((x_i, y_i), i = 1, \\ldots, n\\) 上的 \\(\\beta\\) 和 \\(\\alpha\\) 的最小二乘法估计量分别为：\n\\(B = \\frac{\\sum_{i=1}^n x_i Y_i - \\overline{x} \\sum_{i=1}^n Y_i}{\\sum_{i=1}^n x_i^2 - n\\overline{x}^2}\\)\n\\(A = \\overline{Y} - B\\overline{x}\\)\n\n我们称直线 \\(A + Bx\\) 为估计线性方程（the estimated regression line）。\n我们可以使用 R 来获得数据对 \\((x_1, y_1), ..., (x_n, y_n)\\) 的估计线性方程。\nx &lt;- c(x_1, ..., x_n)\ny &lt;- c(y_1, ..., y_n)\ndf &lt;- data.frame(x = x, y = y)\n1fit &lt;- lm(y ~ x, df)\n2fit\n\n1\n\n定义模型为 lm(y~x)，该模型为线性模型并且假定 \\(y\\) 是 \\(x\\) 的线性函数加上一个随机误差，并且我们将该模型命名为 fit。\n\n2\n\n输出模型 fit 的估计线性方程。\n\n\n例如：\n\nx &lt;- c(1, 2, 3, 4, 5, 6, 7)\ny &lt;- c(3, 2, 5, 6, 4, 8, 9)\ndf &lt;- data.frame(x = x, y = y)\nfit &lt;- lm(y ~ x, df)\nfit\n\n\nCall:\nlm(formula = y ~ x, data = df)\n\nCoefficients:\n(Intercept)            x  \n      1.143        1.036  \n\n\n所以，根据如上的结果，估计线性方程为：\\(y = 1.143 + 1.036x\\)。\n要获得估计线性方程图，首先输入 plot(x, y)，这将生成散点图。然后输入 abline(fit)，这将在散点图上添加估计线性方程的直线。\n\nx &lt;- c(1, 2, 3, 4, 5, 6, 7)\ny &lt;- c(3, 2, 5, 6, 4, 8, 9)\ndf &lt;- data.frame(x = x, y = y)\nfit &lt;- lm(y ~ x, df)\nplot(x, y)\nabline(fit)\n\n\n\n\n\n\n\n\n\n例 9.2 生产某种合成纤维所用的原材料储存在一个没有湿度控制的地方。该储存地点 15 天内的相对湿度和原材料样品的水分含量数据如下所示：\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n相对湿度（%）\n46\n53\n29\n61\n36\n39\n47\n49\n52\n38\n55\n32\n57\n54\n44\n\n\n\n\n原材料含水量（%）\n12\n15\n7\n17\n10\n11\n11\n12\n14\n9\n16\n8\n18\n14\n12\n\n\n\n将该线性回归模型命名为 moisture，并且利用 R 得到：\n\nx &lt;- c(46, 53, 29, 61, 36, 39, 47, 49, 52, 38, 55, 32, 57, 54, 44)\ny &lt;- c(12, 15,  7, 17, 10, 11, 11, 12, 14,  9, 16,  8, 18, 14, 12)\ndf &lt;- data.frame(x = x, y = y)\nmoisture &lt;- lm(y ~ x, df)\nmoisture\n\n\nCall:\nlm(formula = y ~ x, data = df)\n\nCoefficients:\n(Intercept)            x  \n    -2.5105       0.3232  \n\n\n数据的散点图和估计线性方程图为：\n\nx &lt;- c(46, 53, 29, 61, 36, 39, 47, 49, 52, 38, 55, 32, 57, 54, 44)\ny &lt;- c(12, 15,  7, 17, 10, 11, 11, 12, 14,  9, 16,  8, 18, 14, 12)\ndf &lt;- data.frame(x = x, y = y)\nmoisture &lt;- lm(y ~ x, df)\n\nplot(x, y)\nabline(moisture)",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>回归</span>"
    ]
  },
  {
    "objectID": "chapter_9/9.html#sec-9_3",
    "href": "chapter_9/9.html#sec-9_3",
    "title": "9  回归",
    "section": "9.3 估计量的分布",
    "text": "9.3 估计量的分布\n为了确定估计量 \\(A\\) 和 \\(B\\) 的分布，不能仅仅假设随机误差的均值为 0，我们有必要对随机误差做出额外的假设。通常，我们假设随机误差是均值为 0，方差为 \\(\\sigma^2\\) 的独立的、正态分布随机变量。也就是说，如果输入值 \\(x_i\\) 对应的输出为 \\(Y_i\\)，那么 \\(Y_1, \\ldots, Y_n\\) 相互独立，并且：\n\\(Y_i \\sim \\mathcal{N}(\\alpha + \\beta x_i, \\sigma^2)\\)\n注意，上述假设认为随机误差的方差不依赖于输入值，而是一个常数。并且，我们假设 \\(\\sigma^2\\) 的值是未知的，我们必须通过数据对 \\(\\sigma^2\\) 进行估计。\n根据 命题 9.1，\\(\\beta\\) 的最小二乘估计量 \\(B\\) 可以表示为：\n\\[\nB = \\frac{\\sum_{i}(x_i - \\overline{x}) Y_i}{\\sum_{i} x_i^2 - n\\overline{x}^2}\n\\tag{9.8}\\]\n因此，\\(B\\) 是独立、正态分布随机变量 \\(Y_i, i = 1, \\ldots, n\\) 的线性组合，所以 \\(B\\) 本身也服从正态分布。根据 式 9.8，\\(B\\) 的均值和方差为：\n\\[\n\\begin{align}\nE[B] &= \\frac{\\sum_{i}(x_i - \\overline{x}) E[Y_i]}{\\sum_{i} x_i^2 - n\\overline{x}^2} \\\\\n&= \\frac{\\sum_{i}(x_i - \\overline{x})(\\alpha + \\beta x_i)}{\\sum_{i} x_i^2 - n\\overline{x}^2} \\\\\n&= \\frac{\\alpha \\sum_{i}(x_i - \\overline{x}) + \\beta \\sum_{i}x_i(x_i - \\overline{x})}{\\sum_{i} x_i^2 - n\\overline{x}^2} \\\\\n&= \\beta \\frac{\\sum_i x_i^2 - \\overline{x}\\sum_i x_i}{\\sum_i x_i^2 - n\\overline{x}^2} \\quad \\because \\sum_i(x_i - \\overline{x}) = 0 \\\\\n&= \\beta\n\\end{align}\n\\]\n因此，\\(E[B] = \\beta\\)，所以 \\(B\\) 是 \\(\\beta\\) 的无偏估计量。现在，我们计算 \\(B\\) 的方差。\n\\[\n\\begin{align}\n\\textup{Var}(B) &= \\frac{\\textup{Var}\\bigg( \\sum_{i=1}^n (x_i - \\overline{x}) Y_i \\bigg)}{\\bigg( \\sum_{i=1}^n x_i^2 - n\\overline{x}^2 \\bigg)^2} \\\\\n&= \\frac{\\sum_{i=1}^n (x_i - \\overline{x})^2 \\textup{Var}(Y_i)}{\\bigg( \\sum_{i=1}^n x_i^2 - n \\overline{x}^2 \\bigg)^2} \\text{ by independence} \\\\\n&= \\frac{\\sigma^2 \\sum_{i=1}^n (x_i - \\overline{x})^2}{\\bigg( \\sum_{i=1}^n x_i^2 - n \\overline{x}^2 \\bigg)^2} \\\\\n&= \\frac{\\sigma^2}{\\sum_{i=1}^n x_i^2 - n \\overline{x}^2} \\quad \\because \\sum_{i=1}^n (x_i - \\overline{x})^2 = \\sum_{i=1}^n x_i^2 - n \\overline{x}^2\n\\end{align}\n\\tag{9.9}\\]\n根据 式 9.8 以及 \\(A = \\frac{\\sum_{i=1}^n Y_i}{n} - B \\overline{x}\\) 表明 \\(A\\) 也可以表示为独立正态分布随机变量 \\(Y_i, i = 1, \\ldots, n\\) 的线性组合，因此 \\(A\\) 也服从正态分布。\\(A\\) 的均值为：\n\\[\n\\begin{align}\nE[A] &= \\sum_{i=1}^n \\frac{E[Y_i]}{n} - \\overline{x} E[B] \\\\\n&= \\sum_{i=1}^n \\frac{\\alpha + \\beta x_i}{n} - \\overline{x} \\beta \\\\\n&= \\alpha + \\beta \\overline{x} - \\overline{x} \\beta \\\\\n&= \\alpha\n\\end{align}\n\\]\n因此，\\(A\\) 也是 \\(\\alpha\\) 的无偏估计量。首先将 \\(A\\) 表示为 \\(Y_i\\) 的线性组合来计算 \\(A\\) 的方差，其结果为（详细的推导步骤作为练习留给读者）：\n\\[\n\\text{Var}(A) = \\frac{\\sigma^2 \\sum_{i=1}^n x_i^2}{n \\bigg( \\sum_{i=1}^n x_i^2 - n \\overline{x}^2 \\bigg)}\n\\tag{9.10}\\]\n\\(Y_i - A - Bx_i, i = 1, \\ldots, n\\)，表示实际值（即 \\(Y_i\\)）与其最小二乘估计量（即 \\(A + Bx_i\\)）之间的差异，我们称之为 残差（residuals）。可以用残差的平方和：\n\\(SS_R = \\sum_{i=1}^n (Y_i - A - Bx_i)^2\\)\n来估计随机误差的方差 \\(\\sigma^2\\)。实际上，可以证明\n\\(\\frac{SS_R}{\\sigma^2} \\sim \\chi^2_{n-2}\\)\n也就是说，\\(\\frac{SS_R}{\\sigma^2}\\) 服从自由度为 \\(n-2\\) 的卡方分布，这意味着\n\\(E \\left[ \\frac{SS_R}{\\sigma^2} \\right] = n-2\\)\n或者\n\\(E \\left[ \\frac{SS_R}{n-2} \\right] = \\sigma^2\\)\n因此，\\(\\frac{SS_R}{n-2}\\) 是 \\(\\sigma^2\\) 的无偏估计量。此外，还可以证明 \\(SS_R\\) 与 \\(A\\) 和 \\(B\\) 是独立的。\n\n\n\n\n\n\n备注\n\n\n\n关于为什么 \\(\\frac{SS_R}{\\sigma^2}\\) 服从自由度为 \\(n-2\\) 的卡方分布并且与 \\(A\\) 和 \\(B\\) 独立的合理性论证如下。\n因为 \\(Y_i\\) 是独立正态随机变量，因此 \\(\\frac{(Y_i - E[Y_i])}{\\sqrt{\\text{Var}(Y_i)}}\\)（\\(i = 1, \\ldots, n\\)）服从标准正态分布，所以：\n\\(\\sum_{i=1}^n \\frac{(Y_i - E[Y_i])^2}{\\text{Var}(Y_i)} = \\sum_{i=1}^n \\frac{(Y_i - \\alpha - \\beta x_i)^2}{\\sigma^2} \\sim \\chi^2_n\\)\n现在，如果我们用估计量 \\(A\\) 和 \\(B\\) 替代 \\(\\alpha\\) 和 \\(\\beta\\)，那么将失去 2 个自由度，因此 \\(\\frac{SS_R}{\\sigma^2}\\) 服从自由度为 \\(n-2\\) 的卡方分布并不令人惊讶。\n事实上，\\(SS_R\\) 与 \\(A\\) 和 \\(B\\) 的独立性与一个基本结果非常相似，即在正态分布抽样中，\\(\\overline{X}\\) 和 \\(S^2\\) 是独立的（定理 6.2）。实际上，\\(\\overline{X}\\) 和 \\(S^2\\) 的独立性表明，如果 \\(Y_1, \\ldots, Y_n\\) 是均值为 \\(\\mu\\)、方差为 \\(\\sigma^2\\) 的正态分布样本，那么平方和 \\(\\sum_{i=1}^n (Y_i - \\mu)^2 / \\sigma^2\\) 服从自由度为 \\(n\\) 的卡方分布。如果用均值的估计量 \\(\\overline{Y}\\) 替代 \\(\\mu\\) 得到新的平方和 \\(\\sum_{i} (Y_i - \\overline{Y})^2 / \\sigma^2\\)，那么这个量（等于 \\((n-1)S^2 / \\sigma^2\\)）将与 \\(\\overline{Y}\\) 独立，并且将服从自由度为 \\(n-1\\) 的卡方分布。由于 \\(SS_R / \\sigma^2\\) 是通过在平方和 \\(\\sum_{i=1}^n (Y_i - \\alpha - \\beta x_i)^2 / \\sigma^2\\) 中用估计量 \\(A\\) 和 \\(B\\) 来分别替代 \\(\\alpha\\) 和 \\(\\beta\\)，因此这个量可能与 \\(A\\) 和 \\(B\\) 是独立的。\n当 \\(Y_i\\) 是正态分布随机变量时，最小二乘估计量也是最大似然估计量。为了验证这一点，注意到 \\(Y_1, \\ldots, Y_n\\) 的联合密度由下式给出：\n\\[\n\\begin{align}\nf_{Y_1, \\ldots, Y_n}(y_1, \\ldots, y_n) &= \\prod_{i=1}^n f_{Y_i}(y_i) \\\\\n&= \\prod_{i=1}^n \\frac{1}{\\sqrt{2\\pi} \\sigma} e^{-(y_i - \\alpha - \\beta x_i)^2 / 2\\sigma^2} \\\\\n&= \\frac{1}{(2\\pi)^{n/2} \\sigma^n} e^{-\\sum_{i=1}^n (y_i - \\alpha - \\beta x_i)^2 / 2\\sigma^2} \\\\\n\\end{align}\n\\]\n因此，\\(\\alpha\\) 和 \\(\\beta\\) 的最大似然估计量恰好是使 \\(\\sum_{i=1}^n (y_i - \\alpha - \\beta x_i)^2\\) 最小的值，即最小二乘估计量。\n\n\n\n\n\n\n\n\n符号说明\n\n\n\n如果我们令：\n\\(S_{xY} = \\sum_{i=1}^n (x_i - \\overline{x})(Y_i - \\overline{Y}) = \\sum_{i=1}^n x_i Y_i - n \\overline{x} \\overline{Y}\\)\n\\(S_{xx} = \\sum_{i=1}^n (x_i - \\overline{x})^2 = \\sum_{i=1}^n x_i^2 - n \\overline{x}^2\\)\n\\(S_{YY} = \\sum_{i=1}^n (Y_i - \\overline{Y})^2 = \\sum_{i=1}^n Y_i^2 - n \\overline{Y}^2\\)\n则最小二乘估计量可以表示为：\n\\(B = \\frac{S_{xY}}{S_{xx}}\\)\n\\(A = \\overline{Y} - B\\overline{x}\\)\n因此，我们得到如下的残差的平方和的计算等式：\n\\[\nSS_R = \\frac{S_{xx}S_{YY} - S_{xY}^2}{S_{xx}}\n\\tag{9.11}\\]\n\n\n命题 9.2 对本节的内容进行了总结。\n\n命题 9.2 假设因变量 \\(Y_i, i = 1, \\ldots, n\\) 是均值为 \\(\\alpha + \\beta x_i\\)、方差为 \\(\\sigma^2\\) 的独立的、正态分布随机变量。\\(\\beta\\) 和 \\(\\alpha\\) 的最小二乘估计量为：\n\\(B = \\frac{S_{xY}}{S_{xx}}, \\quad A = \\overline{Y} - B\\overline{x}\\)\n其分布为：\n\\(A \\sim \\mathcal{N} \\left( \\alpha, \\frac{\\sigma^2 \\sum_{i} x_i^2}{n S_{xx}} \\right)\\)\n\\(B \\sim \\mathcal{N} \\left( \\beta, \\frac{\\sigma^2}{S_{xx}} \\right)\\)\n此外，如果我们令：\n\\(SS_R = \\sum_{i} (Y_i - A - Bx_i)^2\\)\n表示残差平方和，那么：\n\\(\\frac{SS_R}{\\sigma^2} \\sim \\chi^2_{n-2}\\)\n并且 \\(SS_R\\) 与最小二乘估计量 \\(A\\) 和 \\(B\\) 是独立的。同时，\\(SS_R\\) 可以通过如下的方式来计算：\n\\(SS_R = \\frac{S_{xx}S_{YY} - (S_{xY})^2}{S_{xx}}\\)\n\n可以使用 R 计算 \\(S_{xY}\\)，\\(S_{xx}\\)，\\(S_{YY}\\)，\\(SS_R\\)：\nx &lt;- c(x_1, ..., x_n)\ny &lt;- c(y_1, ..., y_n)\nSxy &lt;- sum(x * y) - n * mean(x) * mean(y)\nSxx &lt;- sum(x * x) - n * mean(x)^2\nSyy &lt;- sum(y * y) - n * mean(y)^2\nSSR &lt;- (Sxx * Syy - Sxy^2) / Sxx\n\n习题 9.1 下面的数据中，\\(x\\) 为某种产品的湿混合物的水分，\\(Y\\) 为最终产品的密度。\n\n\n\n\\(x_i\\)\n\\(y_i\\)\n\n\n\n\n5\n7.4\n\n\n6\n9.3\n\n\n7\n10.6\n\n\n10\n15.4\n\n\n12\n18.1\n\n\n15\n22.2\n\n\n18\n24.1\n\n\n20\n24.8\n\n\n\n为这些数据拟合一条线性曲线，并确定回归方程的残差的平方和 \\(SS_R\\)。\n\n\n解 9.1. 使用 R 计算 \\(SS_R\\)：\n\nx &lt;- c(5,6,7,10,12,15,18,20)\ny &lt;- c(7.4, 9.3, 10.6, 15.4, 18.1, 22.2, 24.1, 24.8)\nSxy = sum(x * y) - 8 * mean(x) * mean(y)\nSxx = sum(x * x) - 8 * mean(x)^2\nSyy = sum(y * y) - 8 * mean(y)^2\nSSR = (Sxx * Syy - Sxy^2) / Sxx\nSSR\n\n[1] 9.469758\n\n\n使用 R 求线性回归方程：\n\nx &lt;- c(5,6,7,10,12,15,18,20)\ny &lt;- c(7.4, 9.3, 10.6, 15.4, 18.1, 22.2, 24.1, 24.8)\ndf &lt;- data.frame(x = x, y = y)\nmodel &lt;- lm(y ~ x, df)\nmodel\n\n\nCall:\nlm(formula = y ~ x, data = df)\n\nCoefficients:\n(Intercept)            x  \n      2.463        1.206  \n\nplot(x, y)\nabline(model)\n\n\n\n\n\n\n\n图 9.2: 习题 9.1\n\n\n\n\n\n如 图 9.2 所示，估计的线性回归方程为：\n\\(y = 2.463 + 1.206x\\) \\(\\blacksquare\\)",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>回归</span>"
    ]
  },
  {
    "objectID": "chapter_9/9.html#sec-9_4",
    "href": "chapter_9/9.html#sec-9_4",
    "title": "9  回归",
    "section": "9.4 关于回归参数的统计推断",
    "text": "9.4 关于回归参数的统计推断\n使用 命题 9.2，设计回归参数的假设检验和置信区间是一件非常简单的事情。\n\n9.4.1 关于 \\(\\beta\\) 的统计推断\n\\(\\beta = 0\\) 是简单线性回归模型 \\(Y = \\alpha + \\beta x + e\\) 的一个重要的假设。该假设的重要性源自这样的事实，即 \\(\\beta = 0\\) 相当于声明模型的输出均值不依赖于模型的输入，或者说没有对输入变量进行任何的回归。\n为了检验：\n\\(H_0: \\beta = 0 \\quad vs. \\quad H_1: \\beta \\ne 0\\)\n我们注意到，根据 命题 9.2 有：\n\\[\n\\frac{B - \\beta}{\\sqrt{\\sigma^2 / S_{xx}}} = \\sqrt{S_{xx}} \\frac{B - \\beta}{\\sigma} \\sim \\mathcal{N}(0, 1)\n\\tag{9.12}\\]\n同时，残差平方和 \\(SS_R\\) 于 \\(B\\) 之间相互独立，且：\n\\[\n\\frac{SS_R}{\\sigma^2} \\sim \\chi_{n-2}^{2}\n\\]\n因此，根据 \\(t\\) 分布随机变量的定义，\n\\[\n\\frac{\\sqrt{S_{xx}}(B - \\beta) / \\sigma}{\\sqrt{\\frac{SS_R}{\\sigma^2(n-2)}}} = \\sqrt{\\frac{(n-2)S_{xx}}{SS_R}}(B - \\beta) \\sim t_{n-2}\n\\tag{9.13}\\]\n也就是说，\\(\\sqrt{\\frac{(n-2)S_{xx}}{SS_R}}(B - \\beta)\\) 服从自由度为 \\(n-2\\) 的 \\(t\\) 分布。因此，如果 \\(H_0\\) 为真（即 \\(\\beta = 0\\)），则：\n\\[\n\\sqrt{\\frac{(n-2)S_{xx}}{SS_R}}B \\sim t_{n-2}\n\\]\n\\(H_0: \\beta = 0\\) 的假设检验 \\(H_0\\) 在显著性水平 \\(\\gamma\\) 下的检验为：\n拒绝： \\(H_0 \\quad 如果 \\quad \\sqrt{\\frac{(n-2)S_{xx}}{SS_R}} |B| \\gt t_{\\gamma/2, n-2}\\)\n接受： \\(H_0 \\quad 其他\\)\n为了计算该检验，首先计算检验统计量 \\(\\sqrt{(n-2)S_{XX}/SS_R}|B|\\) 的值（\\(v\\)），然后如果如下所示的 \\(p \\text{-value}\\) 小于给定的显著性水平则拒绝 \\(H_0\\)：\n\\(p \\text{-value} = P\\{|T_{n-2}| &gt; v\\} = 2P\\{T_{n-2} &gt; v\\}\\)\n其中 \\(T_{n-2}\\) 服从自由度为 \\(n-2\\) 的 t 分布随机变量。\n可以使用 R 来计算如上的假设检验。例如，如果模型的名称为 fit，那么 summary(fit) 将提供所需的 \\(p \\text{-value}\\)。\n\n习题 9.2 一个人声称他的汽车的燃油消耗量不依赖于汽车的行驶速度。为了检验这个假设的合理性，在不同的速度（45~70 英里/小时）测试了汽车。不同速度下的每加仑英里的测试数据如下：\n\n\n\n速度\n每加仑英里数\n\n\n\n\n45\n24.2\n\n\n50\n25.0\n\n\n55\n23.3\n\n\n60\n22.0\n\n\n65\n21.5\n\n\n70\n20.6\n\n\n75\n19.8\n\n\n\n这些数据是否拒绝了每加仑汽油的英里数不受汽车行驶速度影响的说法？\n\n\n解 9.2. 假设 \\(Y\\) 为汽车每加仑汽油的英里数，\\(x\\) 为汽车的行驶速度，并且 \\(Y\\) 和 \\(x\\) 符合简单线性回归模型：\n\\(Y = \\alpha + \\beta x + e\\)\n因此，题目中的假设意味着回归系数 \\(\\beta = 0\\)。\n使用 R，我们有：\n\nx &lt;- c(45, 50, 55, 60, 65, 70, 75)\ny &lt;- c(24.2, 25, 23.3, 22, 21.5, 20.6, 19.8)\nmiles &lt;- lm(y ~ x)\nmiles\n\n\nCall:\nlm(formula = y ~ x)\n\nCoefficients:\n(Intercept)            x  \n      32.54        -0.17  \n\nsummary(miles)\n\n\nCall:\nlm(formula = y ~ x)\n\nResiduals:\n        1         2         3         4         5         6         7 \n-0.692857  0.957143  0.107143 -0.342857  0.007143 -0.042857  0.007143 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) 32.54286    1.27059  25.612 1.69e-06 ***\nx           -0.17000    0.02089  -8.138 0.000455 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.5527 on 5 degrees of freedom\nMultiple R-squared:  0.9298,    Adjusted R-squared:  0.9158 \nF-statistic: 66.23 on 1 and 5 DF,  p-value: 0.0004548\n\n\nsummary(miles) 首先给出七个数据的残差 \\(y_i - (A + Bx_i)\\)，其中 \\(i = 1, \\ldots, 7\\)。接下来的几行给出了截距 \\(\\alpha\\) 和斜率 \\(\\beta\\) 的估计值分别为 32.54286 和 -0.17。然后，给出了这些估计值的标准误差。接着给出了用于检验回归参数为零的 \\(t\\)-统计量的值。例如，检验 \\(\\beta = 0\\) 的 \\(t\\)-值为 -8.138。随后给出了回归参数为零的检验的 \\(p \\text{-value}\\)，例如：\\(\\alpha = 0\\) 的 \\(p \\text{-value}\\) 为 \\(1.69 \\times 10^{-6}\\)，\\(\\beta = 0\\) 的 \\(p \\text{-value}\\) 为 0.000455，这表明在实践中，无论显著性水平为何值，两个假设都将被拒绝。残差标准误差的值为 \\(\\sqrt{\\frac{SS_R}{n-2}}\\)。由于 \\(SS_R/(n-2)\\) 是 \\(\\sigma^2\\) 的估计量，因此残差标准误差是 \\(\\sigma\\) 的估计量。 \\(\\blacksquare\\)\n\n根据 式 9.13 可以很容易地得到 \\(\\beta\\) 的置信区间估计。实际上，从 式 9.13 可以推导出，对于任意 \\(a\\)，其中 \\(0 &lt; a &lt; 1\\)，有\n\\(P \\left\\{ -t_{a/2, n-2} &lt; \\sqrt{\\frac{(n-2)S_{xx}}{SS_R}} (B - \\beta) &lt; t_{a/2, n-2} \\right\\} = 1 - a\\)\n即：\n\\(P \\left\\{ B - \\sqrt{\\frac{SS_R}{(n-2)S_{xx}}} t_{a/2, n-2} &lt; \\beta &lt; B + \\sqrt{\\frac{SS_R}{(n-2)S_{xx}}} t_{a/2, n-2} \\right\\} = 1 - a\\)\n于是，我们得到了以下的结果。\n\\(\\beta\\) 的置信区间\n\\(\\beta\\) 的 \\(100(1 - a) \\%\\) 的置信区间估计是：\n\\(\\left( B - \\sqrt{\\frac{SS_R}{(n-2)S_{xx}}} t_{a/2, n-2}, B + \\sqrt{\\frac{SS_R}{(n-2)S_{xx}}} t_{a/2, n-2} \\right)\\)\n\n\n\n\n\n\n备注\n\n\n\n因为 \\(\\sigma^2\\) 未知，所以不能直接使用 \\(\\frac{B - \\beta}{\\sqrt{\\sigma^2/S_{xx}}} \\sim \\mathcal{N}(0,1)\\) 来对 \\(\\beta\\) 进行统计推断。相反，我们采用了 小节 9.3 中提到的 \\(\\sigma^2\\) 的估计量 \\(SS_R/(n-2)\\)，这导致统计量的分布从标准正态分布变为自由度为 \\(n-2\\) 的 \\(t\\) 分布。\n\n\n\n例 9.3 我们还可以使用 R 来获得 \\(\\alpha\\) 和 \\(\\beta\\) 的置信区间。如果模型的名称是 name，那么 R 命令 confint(name, level = m) 会返回模型 name 中的 \\(\\alpha\\) 和 \\(\\beta\\) 的 \\(100m \\%\\) 置信区间。例如，假设我们想要计算模型 miles 的参数的 95% 置信区间。如果我们输入 confint(miles, level = 0.95)，那么 R 会返回 \\(\\alpha\\) 和 \\(\\beta\\) 的 95% 置信区间。\n\nx &lt;- c(45, 50, 55, 60, 65, 70, 75)\ny &lt;- c(24.2, 25, 23.3, 22, 21.5, 20.6, 19.8)\nmiles &lt;- lm(y ~ x)\nconfint(miles)\n\n                 2.5 %     97.5 %\n(Intercept) 29.2766922 35.8090220\nx           -0.2236954 -0.1163046\n\n\n所以 \\(\\alpha\\) 和 \\(\\beta\\) 的 95% 置信区间分别为：\\((29.2767, 35.8090)\\) 和 \\((-0.2237, -0.1163)\\)。\n\n\n\n9.4.2 均值回归\n术语 回归（regression）最初由 Francis Galton 在描述遗传定律时使用。Galton 认为这些定律导致了种群中的极端值“向均值回归”（regress toward the mean）。在“向均值回归”中，Galton 的意思是：在某个特征上具有极端值的人的孩子会倾向于比他们的父母具有更不极端的值。\n如果我们假设在某特征上，后代 (\\(Y\\)) 和父代 (\\(x\\)) 之间存在线性回归关系，那么当回归参数 \\(\\beta\\) 介于 0 和 1 之间时，将发生均值回归。也就是说，如果\n\\(E[Y] = \\alpha + \\beta x\\)\n并且 \\(0 &lt; \\beta &lt; 1\\)，那么当 \\(x\\) 很大时，\\(E[Y]\\) 将小于 \\(x\\)；当 \\(x\\) 很小时，\\(E[Y]\\) 将大于 \\(x\\)。可以通过代数方法或者绘制两条直线 \\(y = \\alpha + \\beta x\\) 和 \\(y = x\\) 来轻松验证如上的陈述。\n在直线图中我们可以发现，当 \\(0 &lt; \\beta &lt; 1\\) 时，对于较小的 \\(x\\) 值，\\(y = \\alpha + \\beta x\\) 在 \\(y = x\\) 的上方，而对于较大的 \\(x\\) 值，则位于其下方。\n\n例 9.4 为了演示 Galton 的均值回归理论，英国统计学家 Karl Pearson 绘制了 10 名随机选择的男孩与其父亲的身高的对比图。具体数据（以英寸为单位）如下：\n父亲的身高：60, 62, 64, 65, 66, 67, 68, 70, 72, 74\n儿子的身高：63.6, 65.2, 66, 65.5, 66.9, 67.1, 67.4, 68.3, 70.1, 70\n如上数据的散点图如 图 9.3 所示。\n\n\n代码\nfather_height &lt;- c(60, 62, 64, 65, 66, 67, 68, 70, 72, 74)\nson_height &lt;- c(63.6, 65.2, 66, 65.5, 66.9, 67.1, 67.4, 68.3, 70.1, 70)\nplot(father_height, son_height)\n\n\n\n\n\n\n\n\n图 9.3: 父子之间的身高对比图\n\n\n\n\n\n注意，虽然数据表明身高较高的父亲其儿子的身高也往往较高，但也表明较高或者较低身高的父亲的儿子的身高往往比他们更“平均”——也就是说，孩子的身高有“向均值回归”的现象。\n我们将通过将 均值回归 作为 备则假设 来确定上述数据是否足以证明 均值回归 的存在。也就是说，我们将使用上述数据来检验：\n\\(H_0: \\beta \\geq 1 \\quad \\text{vs} \\quad H_1: \\beta &lt; 1\\)\n即：\n\\(H_0: \\beta = 1 \\quad \\text{vs} \\quad H_1: \\beta &lt; 1\\)\n根据 式 9.13，当 \\(\\beta = 1\\) 时，检验统计量：\n\\(TS = \\sqrt{\\frac{8S_{xx}}{SS_R}}(B-1) \\sim t_{8}\\)\n如果 \\(TS = v\\)，则原假设 \\(H_0: \\beta \\ge 1\\) 的 \\(p \\text{-value}\\) 为：\n\\(p \\text{-value} = P\\{T_8 \\le v\\}\\)\n其中，\\(T_8\\) 为自由度为 8 的 \\(t\\)-分布。使用 R 来计算如上的值：\n\nx &lt;- c(60, 62, 64, 65, 66, 67, 68, 70, 72, 74)\ny &lt;- c(63.6, 65.2, 66, 65.5, 66.9, 67.1, 67.4, 68.3, 70.1, 70)\nheight = lm(y ~ x)\n\nsummary(height)\n\n\nCall:\nlm(formula = y ~ x)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-0.6738 -0.2374 -0.0852  0.2835  0.6742 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) 35.97681    2.20760   16.30 2.02e-07 ***\nx            0.46457    0.03298   14.08 6.27e-07 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.4321 on 8 degrees of freedom\nMultiple R-squared:  0.9612,    Adjusted R-squared:  0.9564 \nF-statistic: 198.4 on 1 and 8 DF,  p-value: 6.273e-07\n\n\n由此可知，\\(\\beta\\) 的估计值 \\(B = 0.46457\\)，并且 \\(\\beta\\) 的估计的标准误差为 0.03298，\\(\\beta = 0\\) 时的统计检验 \\(\\sqrt{\\frac{8S_{xx}}{SS_R}}B\\) 为 14.08。因此，对于 \\(H_0: \\beta = 1\\) 时的统计检验值 \\(TS=\\sqrt{\\frac{8S_{xx}}{SS_R}}(B-1) = 14.08 - \\frac{14.08}{0.46457} = -16.2276\\)。\n\npt(-16.2276, 8)\n\n[1] 1.045567e-07\n\n\n因此，统计检验量的值是 -16.2276，相应的 \\(p \\text{-value}\\) 是 \\(1.045569 \\times 10^{-7}\\)。因此，在任何显著性水平上，原假设 $$ 将被拒绝，从而建立了均值回归。（参见 图 9.4，在 图 9.3 的散点图上增加了直线 \\(y = x\\)）。\n\n\n代码\nfather_height &lt;- c(60, 62, 64, 65, 66, 67, 68, 70, 72, 74)\nson_height &lt;- c(63.6, 65.2, 66, 65.5, 66.9, 67.1, 67.4, 68.3, 70.1, 70)\nplot(father_height, son_height, xlim=c(60, 74), ylim=c(60, 74))\nabline(a=0, b=1, col=\"red\")\n\n\n\n\n\n\n\n\n图 9.4: 对于比较小的 x，y &gt; x；对于比较大的 x，y &lt; x\n\n\n\n\n\n一种现代生物学解释认为，均值回归现象大致可以解释为：后代会随机获取父母的一半的基因，因此，假设某人的身高非常高，则其后代很可能由于偶然原因拥有了更少的“高个子”基因。\n尽管均值回归现象最重要的应用是关于后代与其父母的生物学特征之间的关系，但这一现象在我们拥有指向相同变量的两组数据场景时也会出现。\\(\\blacksquare\\)\n\n\n例 9.5  \n\n\n\n表 9.1: 美国西北部 12 个县在 1988 年和 1989 年的机动车死亡人数\n\n\n\n\n\n县市\n1988 年死亡人数\n1989 死亡人数\n\n\n\n\n1\n121\n104\n\n\n2\n96\n91\n\n\n3\n85\n101\n\n\n4\n113\n110\n\n\n5\n102\n117\n\n\n6\n118\n108\n\n\n7\n90\n96\n\n\n8\n84\n102\n\n\n9\n107\n114\n\n\n10\n112\n96\n\n\n11\n95\n488\n\n\n12\n101\n106\n\n\n\n\n\n\n表 9.1 的数据涉及美国西北部 12 个县在 1988 年和 1989 年发生的机动车死亡人数。\n\n\n代码\ndeath_1988 &lt;- c(121, 96, 85, 113, 102, 118, 90, 84, 107, 112, 95, 101)\ndeath_1989 &lt;- c(104, 91, 101, 110, 117, 108, 96, 102, 114, 96, 488, 106)\nplot(death_1988, death_1989, xlim = c(80, 130), ylim = c(80, 130))\n\n\n\n\n\n\n\n\n图 9.5: 1988 年和 1989 年的死亡人数对比图\n\n\n\n\n\n从 图 9.5 可以看出，1989 年大多数县的死亡人数减少了，这些县在 1988 年有大量的机动车死亡人数。同样，那些在 1988 年死亡人数较少的县，1989 年的死亡人数似乎有所增加。因此，我们可以认为均值回归现象确实存在。实际上，可以用 R 计算 表 9.1 的估计回归方程：\n\\(y = 74.589 + 0.276x\\)\n这也表明，\\(\\beta\\) 的估计值确实小于 1。\n在考虑上述数据中的均值回归现象的原因时，我们必须要小心。例如，我们会很自然的假设，在 1988 年机动车死亡人数较多的县可能通过改善道路安全或让人们更多地意识到不安全驾驶的潜在危险来做出大力改进，以减少机动车死亡人数。同时，我们可能假设在 1988 年死亡人数最少的那些县可能“沾沾自喜”，并且没有做出更多的努力来进一步改善机动车的死亡人数，因此导致第二年死亡人数的增加。\n尽管这种假设可能是正确的，但重要的是要认识到，即使没有任何一个县做出了任何非同寻常的举措，也可能会发生均值回归现象。事实上，很有可能在 1988 年那些死亡人数较多的县在那一年非常不幸，因此下一年的减少只是其更正常结果的回归。例如，如果抛 10 次硬币，如果出现了 9 次正面朝上，那么再抛这枚硬币 10 次，则正面向上的次数很可能会少于 9 次。同样，那些在 1988 年死亡人数较少的县在那一年可能非常“幸运”，而 1989 年的更正常结果将导致死亡人数的增加。\n错误地认为均值回归是由于某种外部影响导致，但实际上均值回归只是由于统计中的随机性（chance occurs frequently）而导致的，这通常被称为 回归谬误（the regression fallacy）。\\(\\blacksquare\\)\n\n\n\n9.4.3 关于 \\(\\alpha\\) 的统计推断\n确定 \\(\\alpha\\) 的置信区间和假设检验的方法与 \\(\\beta\\) 的方法完全相同。具体而言，可利用 命题 9.2 证明：\n\\[\n\\sqrt{\\frac{n(n-2)S_{xx}}{SS_R \\sum_i x_i^2}} (A - \\alpha) \\sim t_{n-2}\n\\tag{9.14}\\]\n\\(\\alpha\\) 的置信区间估计\n\\(\\alpha\\) 的 \\(100(1 - \\alpha) \\%\\) 的置信区间为：\n\\[\nA \\pm t_{\\alpha/2, n-2} \\sqrt{\\frac{SS_R \\sum_i x_i^2}{n(n-2)S_{xx}}}\n\\]\n关于 \\(\\alpha\\) 的假设检验可以很容易地由 式 9.14 得到，其推导过程将留作习题。\n\n\n9.4.4 关于 \\(\\alpha + \\beta x_0\\) 的统计推断\n通常我们对利用数据对 \\((x_i, Y_i), i = 1, \\ldots, n\\) 来估计 \\(\\alpha + \\beta x_0\\) 感兴趣（在给定输入 \\(x_0\\) 下估计平均输出）。\n对于点估计量而言，那么我们自然会想到 \\(A + B x_0\\)，因为\n\\(E[A + B x_0] = E[A] + x_0 E[B] = \\alpha + \\beta x_0\\)\n所以 \\(A + B x_0\\) 是 \\(\\alpha + \\beta x_0\\) 的无偏估计量。\n然而，如果我们需要一个置信区间，或对 \\(\\alpha + \\beta x_0\\) 进行某种假设检验，那么首先必须确定估计量 \\(A + B x_0\\) 的概率分布。\n使用 式 9.8 中的 \\(B\\) 的表达式，可以得到：\n\\(B = c \\left( \\sum_{i=1}^{n} (x_i - \\overline{x}) Y_i \\right)\\)\n其中，\\(c = \\frac{1}{\\sum_{i=1}^{n} x_i^2 - n \\overline{x}^2} = \\frac{1}{S_{xx}}\\)\n由于 \\(A = \\overline{Y} - B \\overline{x}\\)，所以\n\\[\n\\begin{align}\nA + B x_0 &= \\frac{\\sum_{i=1}^{n} Y_i}{n} - B (\\overline{x} - x_0) \\\\\n&= \\sum_{i=1}^{n} Y_i \\left[ \\frac{1}{n} - c(x_i - \\overline{x})(\\overline{x} - x_0) \\right]\n\\end{align}\n\\]\n由于 \\(Y_i\\) 是独立的正态分布随机变量，上述等式表明 \\(A + B x_0\\) 可以表示为独立正态分布随机变量的线性组合，因此上述等式本身也服从正态分布。我们已经知道了 \\(A + B x_0\\) 的均值，现在只需要计算它的方差：\n\\[\n\\begin{align}\n\\text{Var}(A + B x_0) &= \\sum_{i=1}^{n} \\left[ \\frac{1}{n} - c(x_i - \\overline{x})(\\overline{x} - x_0) \\right]^2 \\text{Var}(Y_i) \\\\\n&= \\sigma^2 \\sum_{i=1}^{n} \\left[ \\frac{1}{n^2} + c^2(x_i - x_0)^2(x_i - \\overline{x})^2 - 2c(x_i - \\overline{x}) \\frac{(\\overline{x} - x_0)}{n} \\right] \\\\\n&= \\sigma^2 \\left[ \\frac{1}{n} + c^2(x_0 - \\overline{x})^2 \\sum_{i=1}^{n}(x_i - \\overline{x})^2 - 2c(\\overline{x} - x_0) \\sum_{i=1}^{n} \\frac{(x_i - \\overline{x})}{n} \\right] \\\\\n&\\because \\sum_{i=1}^{n}{(x_i - \\overline{x})^2 = \\frac{1}{c} = S_{xx}}, \\quad \\sum_{i=1}^{n}{(x_i - \\overline{x})} = 0 \\\\\n\\therefore &= \\sigma^2 \\left [ \\frac{1}{n} + \\frac{(\\overline{x} - x_0)^2}{S_{xx}} \\right ]\n\\end{align}\n\\]\n于是，我们得到：\n\\[\nA + B x_0 \\sim \\mathcal{N}\\left ( \\alpha + \\beta x_0, \\sigma^2 \\left [ \\frac{1}{n} + \\frac{(\\overline{x} - x_0)^2}{S_{xx}} \\right ]\\right )\n\\tag{9.15}\\]\n根据 命题 9.2，\\(\\frac{SS_R}{\\sigma^2} \\sim \\chi_{n-2}^2\\) 且其与 \\(A + Bx_0\\) 独立，有：\n\\[\n\\frac{A + B x_0 - (\\alpha + \\beta x_0)}{\\sqrt{\\frac{1}{n} + \\frac{(x_0 - \\overline{x})^2}{S_{xx}}} \\sqrt{\\frac{SS_R}{n - 2}}} \\sim t_{n-2}\n\\tag{9.16}\\]\n现在，可以利用 式 9.16 得到 \\(\\alpha + \\beta x_0\\) 的置信区间估计。\n\\(\\alpha + \\beta x_0\\) 的置信区间估计\n在 \\(100(1 - \\alpha)\\%\\) 的置信度下，\\(\\alpha + \\beta x_0\\) 将位于：\n\\(A + B x_0 \\pm \\left(\\sqrt{\\frac{1}{n} + \\frac{(x_0 - \\overline{x})^2}{S_{xx}}} \\sqrt{\\frac{SS_R}{n - 2}}\\right)t_{\\alpha/2, n-2}\\)\n\n习题 9.3 使用 例 9.4 的数据，确定在 95% 的置信度下，父亲身高为 68 英寸下的所有男性的平均身高的置信区间。\n\n\n解 9.3. 我们使用 R 来计算该置信区间：\n\nx &lt;- c(60, 62, 64, 65, 66, 67, 68, 70, 72, 74)\ny &lt;- c(63.6, 65.2, 66, 65.5, 66.9, 67.1, 67.4, 68.3, 70.1, 70)\nSxy &lt;- sum(x * y) - 10 * mean(x) * mean(y)\nSxx &lt;- sum(x * x) - 10 * mean(x)^2\nSyy &lt;- sum(y * y) - 10 * mean(y)^2\nSyy\n\n[1] 38.529\n\nSSR &lt;- (Sxx * Syy - Sxy^2) / Sxx \nSSR\n\n[1] 1.493578\n\nB &lt;- Sxy / Sxx\nA &lt;- mean(y) - B * mean(x)\na &lt;- sqrt((1 / 10 + (68 - mean(x))^2 / Sxx) * SSR / 8)\nl &lt;- (A + B * 68) - a * qt (0.975, 8)\nu &lt;- (A + B * 68) + a * qt (0.975, 8)\nc(l,u)\n\n[1] 67.23944 67.89552\n\n\n所以，95% 置信区间为：\\(\\alpha + \\beta x_0 \\in (67.23944, 67.89552)\\)。\\(\\blacksquare\\)\n\n\n\n9.4.5 输出的预测区间\n通常情况下，估计输出的实际值比估计输出的均值更重要。例如，如果在温度为 \\(x_0\\) 时进行实验，那么我们可能对预测 \\(Y(x_0)\\) 更感兴趣（即实验的实际输出），而不是估计输出的期望 \\(\\text{E}[Y(x_0)] = \\alpha + \\beta x_0\\)。另一方面，如果在温度为 \\(x_0\\) 时进行一系列实验，那么我们可能会更想估计输出的期望值，即 \\(\\alpha + \\beta x_0\\)。\n首先，假设我们对单个值（而不是区间）感兴趣，并以此作为 \\(Y(x_0)\\) 的预测值，即在输入为 \\(x_0\\) 下的输出值。显然，\\(Y(x_0)\\) 的最佳预测值是其均值 \\(\\alpha + \\beta x_0\\)。实际上，这并不是那么显而易见，因为人们可能认为随机变量的最佳预测值是：\n\n均值——这最小化了预测值与实际值之间的平方差；\n中位数——这最小化了预测值与实际值之间的绝对差；\n众数——最可能出现的值。\n\n然而，由于正态分布随机变量的均值、中位数和众数相等，并且输出服从正态分布，因此此时如上的 3 种估计量并没有区别。由于 \\(\\alpha\\) 和 \\(\\beta\\) 是未知的，使用其估计量 \\(A\\) 和 \\(B\\) 似乎是合理的，因此可以使用 \\(A + B x_0\\) 作为新的输入 \\(x_0\\) 的新输出预测值。\n假设我们现在不关心确定某个值来预测输出，而是希望找到一个预测区间，以使得在给定的置信度下，该预测区间将包含输出值。为了获得这样的区间，让 \\(Y\\) 表示输入为 \\(x_0\\) 时的输出预测值，并考虑在输出中减去其预测值的概率分布，即 \\(Y - A - B x_0\\)。因为，\n\\(Y \\sim \\mathcal{N}(\\alpha + \\beta x_0, \\sigma^2)\\)\n并且，如 小节 9.4.4 所示，\n\\(A + B x_0 \\sim \\mathcal{N} \\left( \\alpha + \\beta x_0, \\sigma^2 \\left[ \\frac{1}{n} + \\frac{(x_0 - \\overline{x})^2}{S_{xx}} \\right] \\right)\\)\n因此，由于 \\(Y\\) 与用于确定 \\(A\\) 和 \\(B\\) 的数据值 \\(Y_1, Y_2, \\ldots, Y_n\\) 独立，所以 \\(Y\\) 与 \\(A + B x_0\\) 独立，因此\n\\(Y - A - B x_0 \\sim \\mathcal{N} \\left( 0, \\sigma^2 \\left[ 1 + \\frac{1}{n} + \\frac{(x_0 - \\overline{x})^2}{S_{xx}} \\right] \\right)\\)\n即，\n\\[\n\\frac{Y - A - B x_0}{\\sigma \\sqrt{\\frac{n+1}{n} + \\frac{(x_0 - \\overline{x})^2}{S_{xx}}}} \\sim \\mathcal{N}(0, 1)\n\\tag{9.17}\\]\n因为 \\(SS_R\\) 与 \\(A\\) 和 \\(B\\) 独立（当然，也与 \\(Y\\) 独立），并且\n\\(\\frac{SS_R}{\\sigma^2} \\sim \\chi^2_{n-2}\\)\n于是得到，\n\\(\\frac{Y - A - B x_0}{\\sqrt{\\frac{n+1}{n} + \\frac{(x_0 - \\overline{x})^2}{S_{xx}}} \\sqrt{\\frac{SS_R}{n - 2}}} \\sim t_{n-2}\\)\n因此，对于任意的 \\(a\\)，\\(0 &lt; a &lt; 1\\)，\n\\(P \\left\\{ -t_{a/2, n-2} &lt; \\frac{Y - A - B x_0}{\\sqrt{\\frac{n+1}{n} + \\frac{(x_0 - \\overline{x})^2}{S_{xx}}} \\sqrt{\\frac{SS_R}{n - 2}}} &lt; t_{a/2, n-2} \\right\\} = 1 - a\\)\n即我们构建了以下的结论。\n在输入为 \\(x_0\\) 处时输出的预测区间\n基于输入值 \\(x_i\\) 对应的输出值 \\(Y_i\\)，\\(i = 1, 2, \\ldots, n\\)：在 \\(100(1 - a)\\%\\) 的置信度下，\\(x_0\\) 处的输出值 \\(Y\\) 将包含在如下的区间内\n\\(A + B x_0 \\pm t_{a/2, n-2} \\sqrt{\\frac{n+1}{n} + \\frac{(x_0 - \\overline{x})^2}{S_{xx}}} \\sqrt{\\frac{SS_R}{n - 2}}\\)\n\n例 9.6 在 例 9.4 中，假设我们希望得到一个区间，并且我们“有 95% 的信心”认为该区间将包含父亲的身高为 68 英寸的男性的身高。简单计算后，现在得到预测区间\n\\(Y(68) \\in 67.568 \\pm 1.050\\)\n即，在 95% 的置信度下，父亲身高为 68 英寸的男性的身高将在 66.518 和 68.618 之间。\\(\\blacksquare\\)\n\n\n\n\n\n\n\n备注\n\n\n\n\n通常，置信区间 和 预测区间 之间的区别会存在一些混淆。置信区间是在给定置信度下包含固定参数的区间。预测区间是在给定置信度下包含随机变量的区间。\n如果待预测的输入数据与获得回归方程的数据的差异较大，那么我们不应该使用该回归方程来预测该输入数据的输出。例如，不应使用 例 9.4 的数据获得的回归方程来预测父亲身高为 42 英寸的男性的身高。\n\n\n\n\n表 9.2: 计算不同推断对象时所用的分布\n\n\n\n\n\n\n\n\n\n推断对象\n使用的分布\n\n\n\n\n\\(\\beta\\)\n\\(\\sqrt{\\frac{(n-2)S_{xx}}{SS_R}}(B - \\beta) \\sim t_{n-2}\\)\n\n\n\\(\\alpha\\)\n\\(\\sqrt{\\frac{n(n-2)S_{xx}}{\\sum x_i^2 SS_R}} (A - \\alpha) \\sim t_{n-2}\\)\n\n\n\\(\\alpha + \\beta x_0\\)\n\\(\\frac{A + B x_0 - \\alpha - \\beta x_0}{\\sqrt{\\frac{1}{n} + \\frac{(x_0 - \\overline{x})^2}{S_{xx}}} \\sqrt{\\frac{SS_R}{n - 2}}} \\sim t_{n-2}\\)\n\n\n\\(Y(x_0)\\)\n\\(\\frac{Y(x_0) - A - B x_0}{\\sqrt{1 + \\frac{1}{n} + \\frac{(x_0 - \\overline{x})^2}{S_{xx}}} \\sqrt{\\frac{SS_R}{n - 2}}} \\sim t_{n-2}\\)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n置信区间与预测区间的不同\n\n\n\n置信区间对应的是回归方程输出的平均值即 \\(\\alpha + \\beta x_0\\) （小节 9.4.4）的置信度区间，而预测区间是回归方程的输出值 \\(\\alpha + \\beta x_0 + e\\)（式 9.4）（而不是平均值）的置信区间。\n根据 表 9.2 可知，\\(Y(x_0)\\) 的区间比 \\(\\alpha + \\beta x_0\\) 的区间要宽。更直观的，我们可以使用 R 计算 例 9.4 的回归方程的置信区间和预测区间。\n\nx &lt;- c(60, 62, 64, 65, 66, 67, 68, 70, 72, 74)\ny &lt;- c(63.6, 65.2, 66, 65.5, 66.9, 67.1, 67.4, 68.3, 70.1, 70)\ndf &lt;- data.frame(x = x, y = y)\nfit &lt;- lm(y ~ x, df)\n\nnew_x &lt;- seq(min(x), max(x), length.out = 100)\nconf_interval &lt;- predict(fit, newdata = data.frame(x = new_x), interval = \"confidence\")\npred_interval &lt;- predict(fit, newdata = data.frame(x = new_x), interval = \"prediction\")\n\nplot(x, y, main = \"The Confidence Interval & Predict Interval of the Regression\")\nabline(fit, col = \"blue\", lwd = 2)\nlines(new_x, conf_interval[, \"lwr\"], col = \"red\", lwd = 1, lty = 2)\nlines(new_x, conf_interval[, \"upr\"], col = \"red\", lwd = 1, lty = 2)\nlines(new_x, pred_interval[, \"lwr\"], col = \"green\", lwd = 1, lty = 3)\nlines(new_x, pred_interval[, \"upr\"], col = \"green\", lwd = 1, lty = 3)\nlegend(\"topleft\", legend = c(\"Regression Line\", \"Confidence Interval\", \"Prediction Interval\"),\n  col = c(\"blue\", \"red\", \"green\"), lty = c(1, 2, 3), lwd = 2)\n\n\n\n\n\n\n\n\n\n\n\n\n9.4.6 总结\n\n模型：\\(Y = \\alpha + \\beta x + e\\)，其中 \\(e \\sim \\mathcal{N}(0, \\sigma^2)\\)\n数据：\\((x_i, Y_i)\\)，\\(i = 1, 2, \\ldots, n\\)",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>回归</span>"
    ]
  },
  {
    "objectID": "chapter_9/9.html#sec-9_5",
    "href": "chapter_9/9.html#sec-9_5",
    "title": "9  回归",
    "section": "9.5 决定系数和样本相关系数",
    "text": "9.5 决定系数和样本相关系数\n\n\n\n\n\n\n变异量\n\n\n\n变异量（the amount of variation）是指一组数据中的变异性，即数据的波动或分散程度。这种波动可以是由多种因素引起的，包括个体差异、测量误差、随机误差等。在后续的翻译章节中，我们会根据具体的场景交叉使用 变异量 和 数据波动，如无特殊说明，这些指的都是一个概念。\n同时，我们会避免使用 数据差异（difference） 来指代 变异量 的概念，因为在数学中，数据差异 更多指代两个数据之间的差值，因此和我们所讨论的数据的波动和分布程度并不是一个概念。\n\n\n针对一组输入值 \\(x_1, \\ldots, x_n\\)，假设我们想要测量这组输入值对应的响应值（response value） \\(Y_1, \\ldots, Y_n\\) 之间的数据波动（或 变异量）。在统计学中，测量 \\(Y_1, \\ldots, Y_n\\) 之间的数据波动（变异量）的标准方法为：\n\\(S_{YY} = \\sum_{i=1}^{n} (Y_i - \\overline{Y})^2\\)\n例如，如果所有的 \\(Y_i\\) 相等，那么 \\(Y_i\\) 都等于 \\(\\overline{Y}\\)，所以 \\(S_{YY}\\) 将等于 0。\n\\(Y_i\\) 之间的波动来源于两个因素。\n\n首先，由于输入值 \\(x_i\\) 是不同的，因此，响应变量 \\(Y_i\\) 具有不同的响应均值，这将导致 \\(Y_i\\) 的值存在一定的波动。\n其次，波动还来自这样一个事实：除了输入值 \\(x_i\\) 的差异外，每个响应变量 \\(Y_i\\) 都具有 \\(\\sigma^2\\) 的方差。因此，\\(Y_i\\) 不会和\\(x_i\\) 处的预测值完全相等。\n\n让我们考虑这样一个问题：响应值的波动在多大程度上是由不同输入值引起的，又在多大程度上是由响应值的固有方差引起的（已经考虑了输入值的差异）。为了解答这个问题，我们关注到 \\(SS_R\\) 的定义：\n\\(SS_R = \\sum_{i=1}^{n} (Y_i - A - Bx_i)^2\\)\n因此，\\(SS_R\\) 度量了响应变量中，除了不同输入值带来的变异量之外的、剩余的变异量。\n因此，\\(S_{YY} - SS_R\\) 表示：响应变量中，由不同输入值能够解释的变异量。因此，我们令 \\(R^2\\) 表示为：响应变量中，由不同输入值能够解释的变异量比例。我们称 \\(R^2\\) 为 决定系数（coefficient of determination），其定义为：\n\\(R^2 = \\frac{S_{YY} - SS_R}{S_{YY}} = 1 - \\frac{SS_R}{S_{YY}}\\)\n\n\n\n\n\n\n解释变异量\n\n\n\n解释变异量（Explained Variation）是回归分析中的一个重要概念，用于衡量回归模型中自变量能够解释的因变量的变异量。换句话说，解释变异量是由回归模型的预测结果解释的因变量的总变异的一部分。\n\n\n决定系数 \\(R^2\\) 的取值范围在 0 和 1 之间。接近 1 的 \\(R^2\\) 表示响应数据的大部分波动性可以由不同的输入值来解释，而接近 0 的 \\(R^2\\) 则表示响应数据的波动几乎不能够由不同的输入值来解释。\n\n例 9.7 例 9.4 中的数据揭示了父子身高之间的关系，我们可以使用 R 计算得到：\n\nx &lt;- c(60, 62, 64, 65, 66, 67, 68, 70, 72, 74)\ny &lt;- c(63.6, 65.2, 66, 65.5, 66.9, 67.1, 67.4, 68.3, 70.1, 70)\nSxy &lt;- sum(x * y) - 10 * mean(x) * mean(y)\nSxx &lt;- sum(x * x) - 10 * mean(x)^2\nSyy &lt;- sum(y * y) - 10 * mean(y)^2\nSSr &lt;- (Sxx * Syy - Sxy^2) / Sxx\nSyy\n\n[1] 38.529\n\nSSr\n\n[1] 1.493578\n\nR2 = 1 - SSr / Syy\nR2\n\n[1] 0.961235\n\n\n我们可以使用 R 中的 summary() 来获取 \\(R^2\\) 的计算结果。\n\nx &lt;- c(60, 62, 64, 65, 66, 67, 68, 70, 72, 74)\ny &lt;- c(63.6, 65.2, 66, 65.5, 66.9, 67.1, 67.4, 68.3, 70.1, 70)\ndf &lt;- data.frame(x = x, y = y)\nfit &lt;- lm(y ~ x, df)\n\nsummary(fit)\n\n\nCall:\nlm(formula = y ~ x, data = df)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-0.6738 -0.2374 -0.0852  0.2835  0.6742 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) 35.97681    2.20760   16.30 2.02e-07 ***\nx            0.46457    0.03298   14.08 6.27e-07 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.4321 on 8 degrees of freedom\nMultiple R-squared:  0.9612,    Adjusted R-squared:  0.9564 \nF-statistic: 198.4 on 1 and 8 DF,  p-value: 6.273e-07\n\n\n根据如上结果，我们可以看到：Multiple R-squared:  0.9612，Multiple R-squared 即 \\(R^2\\)。换句话说，在 10 个人的身高波动中，有 96% 的身高波动是由其父亲的身高带来的（解释的），剩下的（未解释的）4% 的数据波动是由于儿子的身高波动带来的（即随机误差的方差 \\(\\sigma^2\\)）。\\(\\blacksquare\\)\n\n通用用 决定系数 \\(R^2\\) 的值作为回归模型对数据拟合好坏的指标，\\(R^2\\) 值越接近 1 则表示拟合效果越好，而 \\(R^2\\) 值越接近 0 则表示拟合效果越差。换句话说，如果回归模型能够解释响应数据中的绝大部分波动（variation in the response data），那么就认为该模型可以较好的拟合数据。\n回想一下我们在 小节 2.6 中定义的数据对 \\((x_i, Y_i), i = 1, \\ldots, n\\) 的 样本相关系数 \\(r\\)：\n\\(r = \\frac{\\sum_{i=1}^{n} (x_i - \\overline{x})(Y_i - \\overline{Y})}{\\sqrt{\\sum_{i=1}^{n} (x_i - \\overline{x})^2 \\sum_{i=1}^{n} (Y_i - \\overline{Y})^2}}\\)\n样本相关系数 \\(r\\) 提供了一种衡量 \\(x\\) 和 \\(Y\\) 之间相关性强度的方式。当 \\(r\\) 接近 +1 时，表示较大的 \\(x\\) 对应着较大的 \\(Y\\)，并且较小的 \\(x\\) 对应着较小的 \\(Y\\)；当 \\(r\\) 接近 -1 时，表示较大的 \\(x\\) 对应着较小的 \\(Y\\)，并且较小的 \\(x\\) 对应着较大的 \\(Y\\)。\n在本章中，\\(r = \\frac{S_{xY}}{\\sqrt{S_{xx} S_{YY}}}\\)，根据 式 9.11 有：\\(SS_R = \\frac{S_{xx}S_{YY} - S_{xY}^2}{S_{xx}}\\)，于是有：\n\\(\\begin{align}r^2 &= \\frac{S_{xY}^2}{S_{xx} S_{YY}} \\\\ &= \\frac{S_{xx}S_{YY} - SS_R S_{xx}}{S_{xx}S_{YY}} \\\\ &= 1 - \\frac{SS_R}{S_{YY}} \\\\ &= R^2\\end{align}\\)\n即：\n\\(|r| = \\sqrt{R^2}\\)\n因此，除了 \\(r\\) 的符号表示它是正相关还是负相关外，样本相关系数 和 决定系数 的平方根是一致的。\\(r\\) 的符号与参数 \\(B\\) 的符号相同。\n如上的内容为 样本相关系数 提供了额外的意义。例如，如果一个数据集的 样本相关系数 \\(r\\) 等于 0.9，那么这意味着对于这些数据的 简单线性回归模型 可以解释 响应变量 81% 的数据波动（variation）（因为 \\(R^2 = 0.9^2 = 0.81\\)）。换句话说，对于响应变量的数据波动而言，81% 可以由不同的输入值来解释。",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>回归</span>"
    ]
  },
  {
    "objectID": "chapter_9/9.html#sec-9_6",
    "href": "chapter_9/9.html#sec-9_6",
    "title": "9  回归",
    "section": "9.6 残差分析：评估模型",
    "text": "9.6 残差分析：评估模型\n可以通过分析数据的散点图来初步确定简单线性回归模型\n\\(Y = \\alpha + \\beta x + e, \\quad e \\sim (0, \\sigma^2)\\)\n是否适用于特定场景。事实上，数据散点图的分析通常足以让我们确认回归模型是否正确。当散点图本身不能确定简单线性模型是否合适时，就需要计算模型的 最小二乘估 计量 \\(A\\) 和 \\(B\\)，并分析残差 \\(Y_i - (A + Bx_i)\\), \\(i = 1, \\ldots, n\\)。残差分析（analysis of residuals）需要首先对残差 正态化（normalizing）或者 标准化（standardizing），残差除以 \\(\\sqrt{SS_R / (n - 2)}\\)（即 \\(Y_i\\) 的标准差的估计值，小节 9.3）得到的指标量\n\\(\\frac{Y_i - (A + Bx_i)}{\\sqrt{SS_R / (n - 2)}}, \\quad i = 1, \\ldots, n\\)\n称为 标准化残差（Standardized Residuals）。\n当简单回归模型正确时，标准化残差 应近似为相互独立的、标准正态分布随机变量，因此 标准化残差 应围绕 0 随机分布，且有大约 95% 的 标准化残差 应位于 \\((-2, 2)\\) 区间内（因为 \\(P\\{-1.96 &lt; Z &lt; 1.96\\} = 0.95\\)）。此外，标准化残差图不应显示出任何明显的模式（pattern）。实际上，任何明显的模式都暗示着我们需要怀疑假定的简单线性回归模型的有效性。\n图 9.6 展示了三个不同的散点图及其相关的标准化残差图。图 9.6 (a) 中的散点图及其标准化残差的随机性表明线性模型的拟合比较好。图 9.6 (b) 中的残差图显示出一个明显的模式（pattern），即残差随着输入变量值的增加时呈现出先减小后增加的趋势。这通常意味着需要更高阶（不仅仅是线性）的项来描述输入和响应之间的关系。在散点图中，也体现了如上的结论。图 9.6 (c) 中的标准化残差图也显示出一种模式，即残差的值及其平方随着输入变量值的增加而增加。这通常意味着 \\(Y_i\\) 的方差并不是常数，而是随着输入变量值的增加而增加。\n\n\n\n\n\n\n\n\n\n\n\n(a) A\n\n\n\n\n\n\n\n\n\n\n\n(b) B\n\n\n\n\n\n\n\n\n\n\n\n\n\n(c) C\n\n\n\n\n\n\n\n图 9.6",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>回归</span>"
    ]
  },
  {
    "objectID": "chapter_9/9.html#sec-9_7",
    "href": "chapter_9/9.html#sec-9_7",
    "title": "9  回归",
    "section": "9.7 转换为线性回归",
    "text": "9.7 转换为线性回归\n在许多情况下，响应均值（输出值的均值）明显不是输入水平（输入值）的线性函数。在这种情况下，如果可以确定输入水平和其响应均值之间的关系形式，那么有时可以通过变量变换将其转换为线性形式。例如，在某些应用中，已知信号在 \\(t\\) 时刻处的振幅 \\(W(t)\\) 近似满足：\n\\(W(t) \\approx c e^{-dt}\\)\n对上式去对数运算，则可以表示为：\n\\(\\log W(t) \\approx \\log c - dt\\)\n如果令 \\(Y = \\log W(t)\\)，\\(\\alpha = \\log c\\)，\\(\\beta = -d\\)，则模型 \\(W(t) \\approx c e^{-dt}\\) 可以转换为：\n\\(Y = \\alpha + \\beta t + e\\)\n然后，我们可以利用最小二乘法来估计简单线性回归模型的回归参数 \\(\\alpha\\) 和 \\(\\beta\\)，于是 \\(W(t) \\approx c e^{-dt}\\) 可以用如下方式来预测：\n\\(W(t) \\approx e^{A + Bt}\\)\n\n习题 9.4 下表给出了在不同温度（摄氏度）下进行实验时所使用的化学物质的百分比。使用这些数据估计：如果实验在 350 度下进行，那么需要使用的化学物质的百分比是多少？\n\n\n\n温度\n百分比\n\n\n\n\n5°\n0.061\n\n\n10°\n0.113\n\n\n20°\n0.192\n\n\n30°\n0.259\n\n\n40°\n0.339\n\n\n50°\n0.401\n\n\n60°\n0.461\n\n\n80°\n0.551\n\n\n\n\n\n解 9.4. \n\n\n代码\nx &lt;- c(5, 10, 20, 30, 40, 50, 60, 80)\ny &lt;- c(0.061, 0.113, 0.192, 0.259, 0.339, 0.401, 0.461, 0.551)\nplot(x, y)\n\n\n\n\n\n\n\n\n图 9.7: 习题 9.4\n\n\n\n\n\n设 \\(P(x)\\) 为在温度 \\(10x\\) 时所使用的化学物质的百分比。尽管如 图 9.7 所示，\\(P(x)\\) 看起来大致呈线性关系，但我们可以通过考虑 \\(x\\) 和 \\(P(x)\\) 之间的非线性关系来改进模型的拟合效果。具体而言，我们考虑以下形式的关系：\n\\(1 - P(x) \\approx c(1 - d)^x\\)\n也就是说，假设在温度为 \\(x\\) 的实验中，所用化学物质的百分比大约以指数速率减少。对上式进行对数运算后，可以写成：\n\\(\\log(1 - P(x)) \\approx \\log(c) + x \\log(1 - d)\\)\n令：\n\\(\\begin{align}Y &= - \\log (1-P) \\\\ \\alpha &= - \\log c \\\\ \\beta &= - \\log (1-d) \\end{align}\\)\n我们得到了一般的回归方程：\n\\(Y = \\alpha + \\beta x + e\\)\n为了看出数据是否支持这个模型，我们需要画出 \\(x\\) 和 \\(- \\log (1-P)\\) 的散点图。表 9.3 给出了转换后的数据，图 9.8 给出了对应的散点图。\n\n\n\n表 9.3\n\n\n\n\n\n温度\n\\(- \\log (1-P)\\)\n\n\n\n\n5°\n0.063\n\n\n10°\n0.120\n\n\n20°\n0.213\n\n\n30°\n0.300\n\n\n40°\n0.414\n\n\n50°\n0.512\n\n\n60°\n0.618\n\n\n80°\n0.801\n\n\n\n\n\n\n\n\n代码\nx &lt;- c(5, 10, 20, 30, 40, 50, 60, 80)\ny &lt;- c(0.061, 0.113, 0.192, 0.259, 0.339, 0.401, 0.461, 0.551)\ny1 &lt;- -log(1 - y)\nplot(x, y1)\n\n\n\n\n\n\n\n\n图 9.8\n\n\n\n\n\n使用 R 得到 \\(\\alpha\\) 和 \\(\\beta\\) 的最小二乘估计值（小节 9.2）：\n\nx &lt;- c(5, 10, 20, 30, 40, 50, 60, 80)\ny &lt;- c(0.061, 0.113, 0.192, 0.259, 0.339, 0.401, 0.461, 0.551)\ny1 &lt;- -log(1 - y)\n\nB &lt;- (sum(x * y1) - mean(x) * sum(y1)) / (sum(x^2) - length(x) * mean(x)^2)\nA &lt;- mean(y1) - B * mean(x)\n\nB\n\n[1] 0.009889817\n\nA\n\n[1] 0.01544615\n\n\n于是得到 \\(c\\) 和 \\(d\\) 的估计值：\n\\(\\begin{align} \\hat{c} &= e^{-A} = 0.9847 \\\\ 1 - \\hat{d} &= e^{-B} = 0.9901 \\end{align}\\)\n最后得到估计的函数关系为：\n\\(\\hat{P} = 1 - 0.9847 \\cdot (0.9901)^x\\)\n如上模型的残差 \\(P - \\hat{P}\\) 如 表 9.4 所示。\n\n\n\n表 9.4\n\n\n\n\n\nx\nP\n\\(\\hat{P}\\)\n\\(P - \\hat{P}\\)\n\n\n\n\n5\n0.061\n0.063\n-0.002\n\n\n10\n0.113\n0.109\n0.040\n\n\n20\n0.192\n0.193\n-0.001\n\n\n30\n0.259\n0.269\n-0.010\n\n\n40\n0.339\n0.339\n0.000\n\n\n50\n0.401\n0.401\n0.000\n\n\n60\n0.461\n0.458\n0.003\n\n\n80\n0.551\n0.556\n-0.005\n\n\n\n\n\n\n\\(\\blacksquare\\)",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>回归</span>"
    ]
  },
  {
    "objectID": "chapter_9/9.html#sec-9_8",
    "href": "chapter_9/9.html#sec-9_8",
    "title": "9  回归",
    "section": "9.8 加权最小二乘法",
    "text": "9.8 加权最小二乘法\n在回归模型\n\\(Y = \\alpha + \\beta x + e\\)\n中，我们经常发现 响应变量 的方差不是常数，而是依赖于其 输入水平（input level）。如果已经知道这些方差——至少应该知道这些方差的系数——那么可以通过最小化加权平方和来估计回归参数 \\(\\alpha\\) 和 \\(\\beta\\)。具体来说，如果\n\\(\\text{Var}(Y_i) = \\frac{\\sigma^2}{w_i}\\)\n那么估计量 \\(A\\) 和 \\(B\\) 应该为下式的最小化：\n\\(\\sum_i \\frac{[Y_i - (A + Bx_i)]^2}{\\text{Var}(Y_i)} = \\frac{1}{\\sigma^2} \\sum_i w_i (Y_i - A - Bx_i)^2\\)\n分别对 \\(A\\) 和 \\(B\\) 进行偏微分计算，然后令偏微分为 0，得到令 \\(A\\) 和 \\(B\\) 最小化的方程：\n\\[\n\\begin{align}\n\\sum_i w_i Y_i &= A \\sum_i w_i + B \\sum_i w_i x_i \\\\\n\\sum_i w_i x_i Y_i &= A \\sum_i w_i x_i + B \\sum_i w_i x_i^2\n\\end{align}\n\\tag{9.18}\\]\n很容易就可以求解这些方程以得到最小二乘估计量。\n\n例 9.8 为了理解为什么应该通过最小化加权平方和而不是普通平方和来获得估计量，需要考虑以下情况。假设 \\(X_1, \\ldots, X_n\\) 是具有均值 \\(\\mu\\) 和方差 \\(\\sigma^2\\) 的独立正态分布随机变量。假设 \\(X_i\\) 不可直接观测，而只能观测到\n\\(Y_1 = X_1 + \\dots + X_k, \\quad Y_2 = X_{k+1} + \\dots + X_n, \\quad k &lt; n\\)\n我们如何基于 \\(Y_1\\) 和 \\(Y_2\\) 估计 \\(\\mu\\)？\n虽然 \\(\\mu\\) 的最佳估计量显然是 \\(\\overline{X} = \\sum_{i=1}^{n} X_i / n = (Y_1 + Y_2)/n\\)，但让我们看看普通最小二乘估计量会是什么。因为\n\\(E[Y_1] = k\\mu, \\quad E[Y_2] = (n - k)\\mu\\)\n\\(\\mu\\) 的最小二乘估计量是使得以下表达式最小化的 \\(\\mu\\) 的值：\n\\((Y_1 - k\\mu)^2 + (Y_2 - [n - k]\\mu)^2\\)\n对其求导并令其等于零，我们得到最小二乘估计量 \\(\\mu\\)（记作 \\(\\hat{\\mu}\\)）应满足：\n\\(-2k(Y_1 - k\\hat{\\mu}) - 2(n - k)[Y_2 - (n - k)\\hat{\\mu}] = 0\\)\n即：\n\\([k^2 + (n - k)^2]\\hat{\\mu} = kY_1 + (n - k)Y_2\\)\n所以：\n\\(\\hat{\\mu} = \\frac{kY_1 + (n - k)Y_2}{k^2 + (n - k)^2}\\)\n因为\n\\(E[\\hat{\\mu}] = \\frac{kE[Y_1] + (n - k)E[Y_2]}{k^2 + (n - k)^2} = \\frac{k^2\\mu + (n - k)^2\\mu}{k^2 + (n - k)^2} = \\mu\\)\n因此，我们看到虽然普通最小二乘估计量是 \\(\\mu\\) 的无偏估计量，但它却不是 \\(\\overline{X}\\) 的最佳估计量。\n现在，我们通过最小化加权平方和来确定 \\(\\mu\\) 的估计量。也就是说，让我们确定 \\(\\mu\\) 的值（记作 \\(\\mu_w\\)）以使得以下表达式最小化：\n\\(\\frac{(Y_1 - k\\mu)^2}{\\text{Var}(Y_1)} + \\frac{[Y_2 - (n - k)\\mu]^2}{\\text{Var}(Y_2)}\\)\n因为\n\\(\\text{Var}(Y_1) = k\\sigma^2, \\quad \\text{Var}(Y_2) = (n - k)\\sigma^2\\)\n这相当于需要选择令下式最小化的 \\(\\mu\\)：\n\\(\\frac{(Y_1 - k\\mu)^2}{k} + \\frac{[Y_2 - (n - k)\\mu]^2}{n - k}\\)\n对其求导并令其等于零，我们得到 \\(\\mu_w\\) 应满足：\n\\(\\frac{-2k(Y_1 - k\\mu_w)}{k} - \\frac{2(n - k)[Y_2 - (n - k)\\mu_w]}{n - k} = 0\\)\n即：\n\\(Y_1 + Y_2 = n\\mu_w\\)\n所以：\n\\(\\mu_w = \\frac{Y_1 + Y_2}{n}\\)\n即加权最小二乘估计量实际上就是首选的估计量 \\((Y_1 + Y_2) / n = \\overline{X}\\)。\\(\\blacksquare\\)\n\n\n\n\n\n\n\n备注\n\n\n\n\n假设数据是正态分布的，加权最小二乘估计量就是最大似然估计量。这是因为数据 \\(Y_1, \\ldots, Y_n\\) 的联合概率密度为：\n\\(\\begin{align} f_{Y_1, \\ldots, Y_n}(y_1, \\ldots, y_n) &= \\prod_{i=1}^{n} \\frac{1}{\\sqrt{2\\pi (\\sigma/\\sqrt{w_i})}} e^{-(y_i - \\alpha - \\beta x_i)^2 / (2\\sigma^2 / w_i)} \\\\ &= \\frac{\\sqrt{w_1 \\dots w_n}}{(2\\pi)^{n/2} \\sigma^n} e^{-\\sum_{i=1}^{n} w_i (y_i - \\alpha - \\beta x_i)^2 / 2\\sigma^2} \\end{align}\\)\n因此，\\(\\alpha\\) 和 \\(\\beta\\) 的最大似然估计量正是使的加权平方和 \\(\\sum_{i=1}^{n} w_i (y_i - \\alpha - \\beta x_i)^2\\) 最小的 \\(\\alpha\\) 和 \\(\\beta\\) 的值。\n加权平方和也可以看作是回归方程 \\(Y = \\alpha + \\beta x + e\\) 乘以 \\(\\sqrt{w}\\)，即：\n\\(Y\\sqrt{w} = \\alpha \\sqrt{w} + \\beta x \\sqrt{w} + e\\sqrt{w}\\)\n在这个方程中，误差项 \\(e\\sqrt{w}\\) 的均值为 0，且方差是常数。因此，\\(\\alpha\\) 和 \\(\\beta\\) 的最小二乘估计量应是使以下表达式最小的 \\(A\\) 和 \\(B\\) 的值：\n\\(\\sum_{i} (Y_i \\sqrt{w_i} - A \\sqrt{w_i} - B x_i \\sqrt{w_i})^2 = \\sum_{i} w_i (Y_i - A - B x_i)^2\\)\n加权最小二乘法主要关注那些具有最大权重的数据对（会让权重最大的数据项的误差的方差最小）。\n\n\n\n因为加权最小二乘法需要知道在任意输入水平处的响应变量的方差（至少需要知道其系数），因此加权最小二乘法可能看起来不太有用。但是，通常可以通过分析模型生成的数据来确定这些值。以下两个例子将对此进行说明。\n\n习题 9.5 下表表示某城市市区内的通勤时间。自变量或输入变量是通勤的距离。\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n通勤距离（英里）\n0.5\n1\n1.5\n2\n3\n4\n5\n6\n8\n10\n\n\n\n\n通勤时间（分钟）\n15.0\n15.1\n16.5\n19.9\n27.7\n29.7\n26.7\n35.9\n42\n49.4\n\n\n\n假设通勤时间 \\(Y\\) 和通勤距离 \\(x\\) 之间的关系为线性关系：\n\\(Y = \\alpha + \\beta x + e\\)\n我们应如何估计 \\(\\alpha\\) 和 \\(\\beta\\)？\n为了使用加权最小二乘法，我们需要知道 \\(Y\\) 的方差。现在，我们提出一个论点，即 \\(\\text{Var}(Y)\\) 应与 \\(x\\) 成正比。\n\n\n解 9.5. 设 \\(d\\) 表示一个街区的长度，于是一个通勤距离为 \\(x\\) 的行程将由 \\(x/d\\) 个街区组成。如果我们让 \\(Y_i\\) 表示第 \\(i\\) 个街区所需的时间，那么总通勤时间可以表示为：\n\\(Y = Y_1 + Y_2 + \\dots + Y_{x/d}\\)\n在许多应用中，合理的假设是 \\(Y_i\\) 是具有相同方差的独立随机变量，因此\n\\(\\begin{align} \\text{Var}(Y) &= \\text{Var}(Y_1) + \\dots + \\text{Var}(Y_{x/d}) \\\\ &= (x/d)\\text{Var}(Y_1) \\\\ &= x\\sigma^2 \\end{align}\\)\n其中 \\(\\sigma^2 = \\text{Var}(Y_1)/d\\)。\n因此，估计量 \\(A\\) 和 \\(B\\) 应该令以下表达式最小化：\n\\(\\sum_{i} \\frac{(Y_i - A - B x_i)^2}{x_i}\\)\n使用上面的数据，且权重为 \\(w_i = 1/x_i\\)，式 9.18 的最小二乘方程为：\n\\(\\begin{align} 104.22 &= 5.34A + 10B \\\\ 277.9 &= 10A + 41B \\end{align}\\)\n求解得：\n\\(A = 12.561, \\quad B = 3.714\\)\n图 9.9 展示了数据点和其估计回归线 \\(12.561 + 3.714x\\) 的图形。对我们的解的定性分析可以知：在输入水平较小时，回归的效果最好，这主要是因为权重与输入水平成反比。\n\n\n代码\nmiles &lt;- c(0.5, 1, 1.5, 2, 3, 4, 5, 6, 8, 10)\ntime &lt;- c(15.0, 15.1, 16.5, 19.9, 27.7, 29.7, 26.7, 35.9, 42, 49.4)\nplot(miles, time)\nabline(a = 12.561, b = 3.714)\n\n\n\n\n\n\n\n\n图 9.9\n\n\n\n\n\n\\(\\blacksquare\\)\n\n\n例 9.9 考虑在交通繁忙的高速公路上发生的事故数量 \\(Y\\) 与在高速公路上行驶的车辆数量 \\(x\\) 之间的关系。稍微思考后，大多数人可能会认为其比较合适的关系应该为线性模型：\n\\(Y = \\alpha + \\beta x + e\\)\n然而，由于没有任何先验（priori）理由认为 \\(\\text{Var}(Y)\\) 和输入水平 \\(x\\) 之间无关，因此我们不清楚是否可以使用普通最小二乘法来估计 \\(\\alpha\\) 和 \\(\\beta\\)。实际上，我们将论证：应该采用加权最小二乘法且权重为 \\(1/x\\)，即我们应该选择 \\(A\\) 和 \\(B\\) 以最小化\n\\(\\sum_{i} \\frac{(Y_i - A - Bx_i)^2}{x_i}\\)\n背后的理由是，假设 \\(Y\\) 近似服从泊松分布是合理的。因为我们可以想象每辆车 \\(x\\) 都存在一个小概率会导致事故，因此对于较大的 \\(x\\)，事故的数量应该近似为泊松随机变量。由于泊松随机变量的方差等于其均值，我们可以看到：\n\\(\\begin{align} \\text{Var}(Y) & \\simeq E[Y] \\\\ &= \\alpha + \\beta x \\\\ & \\simeq \\beta x \\end{align}\\)\n\n\n\n\n\n\n\n备注\n\n\n\n\n在响应变量的方差依赖于输入水平时，另一种常用的技术是通过适当的变换来稳定方差。例如，如果 \\(Y\\) 是一个均值为 \\(\\lambda\\) 的泊松随机变量，那么可以证明（参见第 2 点），无论 \\(\\lambda\\) 的值是多少 \\(\\sqrt{Y}\\) 的近似方差都是 \\(0.25\\)。基于这一事实，可以尝试将 \\(E[\\sqrt{Y}]\\) 建模为输入水平的线性函数，即：\n\\(\\sqrt{Y} = \\alpha + \\beta x + e\\)\n当 \\(Y\\) 是具有均值 \\(\\lambda\\) 的泊松分布时，证明 \\(\\text{Var}(\\sqrt{Y}) \\approx 0.25\\)。考虑 \\(g(y) = \\sqrt{y}\\) 在 \\(\\lambda\\) 处的泰勒级数（Taylor series）展开。忽略二阶导数项以后的所有项，我们得到：\n\\[\ng(y) \\approx g(\\lambda) + g'(\\lambda)(y - \\lambda) + \\frac{g''(\\lambda)(y - \\lambda)^2}{2}\n  \\tag{9.19}\\]\n由于\n\\(g'(\\lambda) = \\frac{1}{2} \\lambda^{-1/2}, \\quad g''(\\lambda) = -\\frac{1}{4} \\lambda^{-3/2}\\)\n于是，在 \\(y = Y\\) 处，我们得到\n\\(\\sqrt{Y} \\approx \\sqrt{\\lambda} + \\frac{1}{2} \\lambda^{-1/2}(Y - \\lambda) - \\frac{1}{8} \\lambda^{-3/2}(Y - \\lambda)^2\\)\n因为 \\(E[Y - \\lambda] = 0\\) 和 \\(E[(Y - \\lambda)^2] = \\text{Var}(Y) = \\lambda\\)，所以：\n\\(E[\\sqrt{Y}] \\approx \\sqrt{\\lambda} - \\frac{1}{8\\sqrt{\\lambda}}\\)\n因此：\n\\((E[\\sqrt{Y}])^2 \\approx \\lambda + \\frac{1}{64\\lambda} - \\frac{1}{4} \\approx \\lambda - \\frac{1}{4}\\)\n因此：\n\\(\\begin{align} \\text{Var}(\\sqrt{Y}) &= E[Y] - (E[\\sqrt{Y}])^2 \\\\ & \\approx \\lambda - \\left(\\lambda - \\frac{1}{4}\\right) \\\\ &= \\frac{1}{4} \\end{align}\\)",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>回归</span>"
    ]
  },
  {
    "objectID": "chapter_9/9.html#sec-9_9",
    "href": "chapter_9/9.html#sec-9_9",
    "title": "9  回归",
    "section": "9.9 多项式回归",
    "text": "9.9 多项式回归\n当无法通过线性关系充分拟合响应变量 \\(Y\\) 和自变量 \\(x\\) 之间的函数关系的情况下，有时可以通过考虑多项式关系来获得合理的拟合。也就是说，可以尝试将数据集拟合到以下形式的函数关系：\n\\(Y = \\beta_0 + \\beta_1 x + \\beta_2 x^2 + \\cdots + \\beta_r x^r + e\\)\n其中 \\(\\beta_0, \\beta_1, \\ldots, \\beta_r\\) 是需要估计的回归系数。如果数据集由 \\(n\\) 对 \\((x_i, Y_i)\\) 组成，其中 \\(i = 1, \\ldots, n\\)，那么 \\(\\beta_0, \\ldots, \\beta_r\\) 的最小二乘估计量——我们称之为 \\(B_0, \\ldots, B_r\\)——就是使下式最小化的值：\n\\(\\sum_{i=1}^{n} \\left( Y_i - B_0 - B_1 x_i - B_2 x_i^2 - \\cdots - B_r x_i^r \\right)^2\\)\n为了确定这些估计量，我们分别求解 \\(B_0 \\ldots B_r\\) 的偏导数，并令这些偏导数等于 0。在执行这些操作，并重新排列所得的方程之后，我们得到的最小二乘估计 \\(B_0, B_1, \\ldots, B_r\\) 满足以下由 \\(r + 1\\) 个线性方程组（称为 正规方程（normal equations））成的方程组：\n\\[\n\\begin{align}\n\\sum_{i=1}^{n} Y_i &= B_0 n + B_1 \\sum_{i=1}^{n} x_i + B_2 \\sum_{i=1}^{n} x_i^2 + \\cdots + B_r \\sum_{i=1}^{n} x_i^r \\\\\n\\sum_{i=1}^{n} x_i Y_i &= B_0 \\sum_{i=1}^{n} x_i + B_1 \\sum_{i=1}^{n} x_i^2 + B_2 \\sum_{i=1}^{n} x_i^3 + \\cdots + B_r \\sum_{i=1}^{n} x_i^{r+1} \\\\\n\\sum_{i=1}^{n} x_i^2 Y_i &= B_0 \\sum_{i=1}^{n} x_i^2 + B_1 \\sum_{i=1}^{n} x_i^3 + B_2 \\sum_{i=1}^{n} x_i^4 + \\cdots + B_r \\sum_{i=1}^{n} x_i^{r+2} \\\\\n& \\vdots \\qquad \\vdots \\qquad \\qquad \\qquad \\qquad \\qquad \\qquad \\qquad \\vdots \\\\\n\\sum_{i=1}^{n} x_i^r Y_i &= B_0 \\sum_{i=1}^{n} x_i^r + B_1 \\sum_{i=1}^{n} x_i^{r+1} + \\cdots + B_r \\sum_{i=1}^{n} x_i^{2r}\n\\end{align}\n\\]\n在对一组数据进行多项式拟合时，通常可以通过研究散点图来确定多项式的必要阶数。我们强调，应始终使用最小可能阶数来充分描述数据的关系。例如，尽管通常可以找到一个阶数为 \\(n\\) 的多项式以通过所有 \\(n\\) 对 \\((x_i, Y_i)\\)，但我们很难对这种拟合寄予太大的信心。\n与线性回归相比，使用多项式拟合来预测那些远离拟合数据（\\(i = 1, \\ldots, n\\)）的 \\(x_0\\) 的响应值是一件更为危险的事情。多项式拟合可能只在 \\(x_i\\)（\\(i = 1, \\ldots, n\\)）周围的某一区域有效，并且这个区域并不包括 \\(x_0\\)。\n\n习题 9.6 为如下的数据进行多项式拟合。\n\n\n\nx\nY\n\n\n\n\n1\n20.6\n\n\n2\n30.8\n\n\n3\n55.0\n\n\n4\n71.4\n\n\n5\n97.3\n\n\n6\n131.8\n\n\n7\n156.3\n\n\n8\n197.3\n\n\n9\n238.7\n\n\n10\n291.7\n\n\n\n\n\n解 9.6. \n\n\n代码\nx &lt;- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)\ny &lt;- c(20.6, 30.8, 55.0, 71.4, 97.3, 131.8, 156.3, 197.3, 238.7, 291.7)\nplot(x, y)\n\n\n\n\n\n\n\n\n图 9.10\n\n\n\n\n\n数据的散点图（图 9.10）暗示着 \\(Y\\) 与 \\(x\\) 之间存在二次关系：\n\\(Y = \\beta_0 +\\beta_1 x + \\beta_2 x ^2 + e\\)\n\\(\\begin{align} \\sum_{i} x_i &= 55, \\quad \\sum_{i} x_i^2 = 385, \\quad \\sum_{i} x_i^3 = 3025, \\quad \\sum_{i} x_i^4 = 25,333 \\\\ \\sum_{i} Y_i &= 1291.1, \\quad \\sum_{i} x_i Y_i = 9549.3, \\quad \\sum_{i} x_i^2 Y_i = 77,758.9 \\end{align}\\)\n所以，最小二乘估计就是如下的方程组的解：\n\\[\n\\begin{align}\n1291.1 &= 10B_0 + 55B_1 + 385B_2 \\\\\n9549.3 &= 55B_0 + 385B_1 + 3025B_2 \\\\\n77758.9 &= 385B_0 + 3025B_1 + 25333B_2\n\\end{align}\n\\tag{9.20}\\]\n解如上的方程组可以得到最小二乘估计为：\n\\(B_0 = 12.59326, \\quad B_1 = 6.326172, \\quad B_2 = 2.122818\\)\n因此，估计的二次回归方程为：\n\\(Y = 12.59 + 6.33x + 2.12x^2\\)\n数据的散点图和拟合的二次回归方程图如 图 9.11 所示。\n\n\n代码\nx &lt;- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)\ny &lt;- c(20.6, 30.8, 55.0, 71.4, 97.3, 131.8, 156.3, 197.3, 238.7, 291.7)\nplot(x, y)\n\nbeta0 &lt;- 12.59\nbeta1 &lt;- 6.33\nbeta2 &lt;- 2.12\ncurve(beta0 + beta1 * x + beta2 * x^2, from=0, to=10, col=\"red\", lwd=2, add=TRUE)\n\n\n\n\n\n\n\n\n图 9.11\n\n\n\n\n\n\\(\\blacksquare\\)\n\n\n\n\n\n\n\n注记\n\n\n\n可以使用 R 的 lm() 实现 习题 9.6 的多项式拟合。\n\nx &lt;- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)\ny &lt;- c(20.6, 30.8, 55.0, 71.4, 97.3, 131.8, 156.3, 197.3, 238.7, 291.7)\nmodel &lt;- lm(y ~ x + I(x^2))\n\nsummary(model)\n\n\nCall:\nlm(formula = y ~ x + I(x^2))\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-4.5482 -2.4869 -0.4486  2.7006  4.8739 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  12.6433     4.3477   2.908   0.0227 *  \nx             6.2971     1.8158   3.468   0.0104 *  \nI(x^2)        2.1250     0.1609  13.209 3.33e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 3.697 on 7 degrees of freedom\nMultiple R-squared:  0.9987,    Adjusted R-squared:  0.9984 \nF-statistic:  2745 on 2 and 7 DF,  p-value: 7.368e-11\n\nplot(x, y)\ncurve(12.6433 + 6.2971 * x + 2.1250 * x^2, from=0, to=10, col=\"blue\", lwd=2, add=TRUE)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n备注\n\n\n\n在矩阵表示法中，式 9.20 可以表示为：\n\\[\n\\begin{bmatrix}\n1291.1 \\\\\n9549.3 \\\\\n77758.9\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n10 & 55 & 385 \\\\\n55 & 385 & 3025 \\\\\n385 & 3025 & 25,333\n\\end{bmatrix}\n\\begin{bmatrix}\nB_0 \\\\\nB_1 \\\\\nB_2\n\\end{bmatrix}\n\\]\n其解为：\n\\[\n\\begin{bmatrix}\nB_0 \\\\\nB_1 \\\\\nB_2\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n10 & 55 & 385 \\\\\n55 & 385 & 3025 \\\\\n385 & 3025 & 25,333\n\\end{bmatrix}^{-1}\n\\begin{bmatrix}\n1291.1 \\\\\n9549.3 \\\\\n77,758.9\n\\end{bmatrix}\n\\]",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>回归</span>"
    ]
  },
  {
    "objectID": "chapter_9/9.html#sec-9_10",
    "href": "chapter_9/9.html#sec-9_10",
    "title": "9  回归",
    "section": "9.10 Multiple linear regression \\(^*\\)",
    "text": "9.10 Multiple linear regression \\(^*\\)",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>回归</span>"
    ]
  },
  {
    "objectID": "chapter_9/9.html#sec-9_11",
    "href": "chapter_9/9.html#sec-9_11",
    "title": "9  回归",
    "section": "9.11 用于二元输出数据的逻辑回归模型",
    "text": "9.11 用于二元输出数据的逻辑回归模型\n在本节中，我们考虑实验结果要么是成功要么是失败的实验。我们假设可以在不同的水平（\\(x\\)）执行这些实验，并且在水平 \\(x\\) 处实验成功的概率为 \\(p(x)\\)，其中 \\(-\\infty &lt; x &lt; \\infty\\)。如果 \\(p(x)\\) 具有以下形式：\n\\(p(x) = \\frac{e^{a+bx}}{1 + e^{a+bx}}\\)\n那么，我们称这些实验来自于一个 逻辑回归模型（logistic regression model），而称 \\(p(x)\\) 为 逻辑回归函数（logistics regression function）。\n\n如果 \\(b &gt; 0\\)，那么 \\(p(x) = \\frac{1}{[e^{-(a+bx)} + 1]}\\) 是一个递增函数，随着 \\(x \\rightarrow \\infty\\) 而收敛到 1。\n如果 \\(b &lt; 0\\)，那么 \\(p(x)\\) 是一个递减函数，随着 \\(x \\rightarrow \\infty\\) 而收敛到 0。\n当 \\(b = 0\\) 时，\\(p(x)\\) 是一个常数。\n\n图 9.12 给出了 逻辑回归函数 的图形，从图中可以看出，这些曲线呈现 S 形状。\n\n\n\n\n\n\n图 9.12: 逻辑回归函数\n\n\n\n将 \\(p(x)\\) 写为 \\(p(x) = 1 - \\left[ \\frac{1}{1 + e^{a+bx}} \\right]\\) 并对 \\(x\\) 求导，得到：\n\\(\\frac{\\partial}{\\partial x} p(x) = \\frac{be^{a+bx}}{(1 + e^{a+bx})^2} = b \\cdot p(x) [1 - p(x)]\\)\n因此，\\(p(x)\\) 的变化率取决于 \\(x\\)，并且在 \\(p(x)\\) 接近 0.5 时的那些 \\(x\\) 处，\\(p(x)\\) 的变化率最大。例如，在 \\(p(x) = 0.5\\) 时，\\(\\frac{\\partial}{\\partial x} p(x) = 0.25b\\)，而在 \\(p(x) = 0.8\\) 时，\\(x\\) 处，\\(\\frac{\\partial}{\\partial x} p(x) = 0.16b\\)。\n如果我们将 \\(o(x)\\) 定义为实验在 \\(x\\) 处成功时的 赔率（小节 3.4），那么：\n\\(o(x) = \\frac{p(x)}{1 - p(x)} = e^{a+bx}\\)\n因此，当 \\(b &gt; 0\\) 时，赔率 随着 \\(x\\) 的增加而指数级增加；当 \\(b &lt; 0\\) 时，赔率 随着 \\(x\\) 的增加而指数级减少。取 赔率 取对数运算，我们有：\n\\(\\log(o(x)) = a + bx\\)\n这表明，对数赔率（log odds）——即 logit 函数——是一个线性函数：\n\\(\\log(o(x)) = a + bx\\)\n逻辑回归函数的参数 \\(a\\) 和 \\(b\\) 是未知的，需要对其进行估计。可以通过最大似然法来估计逻辑回归函数的参数。也就是说，假设在 \\(x_1, \\ldots, x_k\\) 进行实验，令 \\(Y_i\\)（成功时为 1，失败时为 0） 表示在 \\(x_i\\) 处进行实验时的实验结果。然后，使用伯努利概率密度函数（即单次试验的概率密度函数为二项概率密度函数）：\n\\(P(Y_i = y_i) = [p(x_i)]^{y_i} [1 - p(x_i)]^{1 - y_i} = \\left( \\frac{e^{a+bx_i}}{1 + e^{a+bx_i}} \\right)^{y_i} \\left( \\frac{1}{1 + e^{a+bx_i}} \\right)^{1 - y_i}, \\quad y_i = 0, 1\\)\n因此，在 \\(x_i\\) 处实验结果为 \\(y_i\\) 的概率（对于所有 \\(i = 1, \\ldots, k\\)） 为：\n\\(\\begin{align} P(Y_i = y_i, i = 1, \\ldots, k) &= \\prod_{i} \\left( \\frac{e^{a+bx_i}}{1 + e^{a+bx_i}} \\right)^{y_i} \\left( \\frac{1}{1 + e^{a+bx_i}} \\right)^{1 - y_i} \\\\ &= \\prod_{i}{\\frac{(e^{a+bx_i})^{y_i}}{1+e^{a+bx_i}}} \\end{align}\\)\n等式两边取对数得到：\n\\(\\log\\left( P\\{Y_i = y_i, i = 1, \\ldots, k\\} \\right) = \\sum_{i=1}^{k} y_i(a + bx_i) - \\sum_{i=1}^{k} \\log \\left( 1 + e^{a+bx_i} \\right)\\)\n现在可以通过数值方法求解使得上述似然函数取得最大值的 \\(a\\) 和 \\(b\\) 的值，从而获得最大似然估计。然而，由于似然函数是非线性的，所以通常需要迭代的方法来计算最大似然估计；因此，通常需要使用专门的软件来获得逻辑回归函数的参数估计。\n\n\n\n\n\n\nglm()\n\n\n\nglm() 函数用于拟合 广义线性模型（Generalized Linear Models, GLM）。glm() 是一个非常强大的函数，可以处理各种类型的回归模型，包括线性回归、逻辑回归、泊松回归等。\n可以通过 family 参数来控制 glm() 的回归类型，例如：\n\nfamily = gaussian（默认）用于线性回归\nfamily = binomial 用于逻辑回归\nfamily = poisson 用于泊松回归\n\n\n\n可以使用 R 确定逻辑回归模型中 \\(a\\) 和 \\(b\\) 的估计。可以使用 R 中的 glm(y ~ x, family = \"binomial\") 确定逻辑回归模型。例如，假设某个实验进行了 7 次，在 \\(x = (5, 9, 13, 22, 22, 24, 30)\\) 时，其对应的结果为 \\((0, 1, 0, 1, 0, 1, 1)\\)，其中 1 表示该实验成功，0 表示实验失败。则估计的逻辑回归方程如下：\n\nx &lt;- c(5, 9, 3, 12, 22, 24, 30)\ny &lt;- c(0, 1, 0, 1, 0, 1, 1)\nmodel &lt;- glm(y ~ x, family = \"binomial\")\nmodel\n\n\nCall:  glm(formula = y ~ x, family = \"binomial\")\n\nCoefficients:\n(Intercept)            x  \n    -1.2678       0.1103  \n\nDegrees of Freedom: 6 Total (i.e. Null);  5 Residual\nNull Deviance:      9.561 \nResidual Deviance: 8.025    AIC: 12.03\n\n\n\n\n\n\n\n\n注意\n\n\n\n在原书中，此处使用的是 glm(y ~ x)，如果没有指定 family 参数，则 glm() 实际执行的是线性回归，而不是逻辑回归。这里要特别注意。\n\n\n也就是说，在逻辑回归模型 \\(p(x)=\\frac{e^{a+bx}}{1+e^{a+bx}}\\) 中，\\(a\\) 和 \\(b\\) 的估计值分别是：-1.2678 和 0.1103。\n当响应数据为二元数据时，虽然逻辑回归模型是最常用的模型，但通常也会使用其他模型。例如，在输入水平为 \\(x\\) 时，假设 \\(p(x)\\)（实验成功的概率）是一个随 \\(x\\) 的增加而增加的函数是合理的。在这种情况下，常常假设 \\(p(x)\\) 具有特定的概率分布函数。实际上，当 \\(b &gt; 0\\) 时，逻辑回归模型就满足这种形式。此时，因为 \\(p(x)\\) 就是参数为 \\(\\mu = -a/b\\)、\\(\\nu = 1/b\\) 的逻辑分布随机变量的分布函数（?sec-5_9）。\n可用于二元响应数据的另一种模型是 probit model，在这种模型中，假设对于某些常数 \\(\\alpha, \\beta &gt; 0\\)，\n\\(p(x) = \\Phi(\\alpha + \\beta x) = \\frac{1}{\\sqrt{2\\pi}} \\int_{-\\infty}^{\\alpha + \\beta x} e^{-y^2/2} dy\\)\n换句话说，\\(p(x)\\) 等于标准正态分布随机变量小于 \\(\\alpha + \\beta x\\) 的概率。\n\n例 9.10 常见的假设是：当一个动物暴漏在剂量水平为 \\(x\\) 下的某化学物质时，动物是否会生病。该假设使用了阈值模型（threshold model），阈值模型认为每个动物都有一个随机阈值，当剂量水平超过该阈值时，动物就会生病。有时，可以用指数分布来作为阈值分布。例如，Freedman 和 Zeisel 在论文（From Mouse to Man: The Quantitative Assessment of Cancer Risks,” Statistical Science, 1988, 3, 1, 3–56）中的模型假设：一只暴露于 \\(x\\) 剂量（以 ppm 计量）的 DDT（二氯二苯基三氯乙烷，一种合成的有机氯杀虫剂，最早于 1940 年代被引入，用于控制蚊子、苍蝇等传播疾病的昆虫，并在农业中广泛用于保护农作物免受害虫侵害） 下的老鼠将会以如下的概率患上肝癌：\n\\(p(x) = 1 - e^{-\\alpha x}, \\quad x &gt; 0\\)\n由于指数分布的“无记忆性”，这相当于假设：如果老鼠在接收到部分剂量 \\(x\\) 后仍然健康，那么剂量水平 \\(x\\) 带来的风险与之前没有接收到任何剂量时一样。\n根据 Freedman 和 Zeisel 的研究，暴露于 250 ppm DDT 下的 111 只老鼠中，有 84 只发展成癌症。因此，可以通过以下公式估计 \\(\\alpha\\)：\n\\(1 - e^{-250\\hat{\\alpha}} = \\frac{84}{111}\\)\n即：\n\\(\\hat{\\alpha} = -\\frac{\\log(27/111)}{250} = 0.005655\\) \\(\\blacksquare\\)",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>回归</span>"
    ]
  },
  {
    "objectID": "chapter_9/9.html#problems",
    "href": "chapter_9/9.html#problems",
    "title": "9  回归",
    "section": "Problems",
    "text": "Problems",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>回归</span>"
    ]
  },
  {
    "objectID": "chapter_10/10.html",
    "href": "chapter_10/10.html",
    "title": "10  方差分析",
    "section": "",
    "text": "10.1 引言\n目前市面上有 4 款软件来教授用户学习一门新的变成语言，某大公司正在考虑大规模购买这 4 款软件中的一款。公司内部一些资深人士声称，这几款软件没有太大的区别，它们对用户的最终学习效果影响很小。为了检验这一假设，公司决定选择 160 名工程师，并将他们分成 4 组，每组 40 人。第 \\(i\\) 组的工程师使用第 \\(i\\)（\\(i = 1, 2, 3, 4\\)）款软件来学习新的语言。当所有工程师完成学习后，参与学习的所有工程师将进行一次全面考试。公司希望使用这次考试的结果来确定不同的教学软件是否真的可以互换。该公司需要怎么做才能实现这一点？\n在回答这个问题之前，我们需要明确，显然我们希望得出这样的结论：当所有分组的平均成绩相似时，可以认为这几款软件确实是可以互换的；而当不同分组的平均成绩之间有很大差异时，可以认为这几款软件在本质上是存在区别的。要得出这样的结论，我们必须注意到：将这 160 名工程师分成 4 组的方法至关重要。例如，假设第一组的成员成绩显著高于其他组，我们能从中得出什么结论？具体来说，这个结果是由于 第 1 款软件的教学效果更好，还是第一组的工程师的学习能力更好？为了能够得出这几款软件是否可以互换的结论，需要一种合理的分组方式以保证不同分组的工程师不会存在显著的差异，这一点至关重要。以完全随机的方式将工程师分成 4 组是久经考验的一种方法。也就是说，完全随机的分组方式可以使得所有可能的分组组合都有相同的概率，从而保障任何一组明显优于其他组的可能性非常小。假设我们确实使用“随机”的方式对工程师分组，虽然目前还不清楚如何才能做到。一种有效的方法是首先对这 160 名工程师进行 1~160 的编号，然后生成 1~160 的随机排列，并将排列中的前 40 名工程师放分到 第 1 组，排列中的第 41 到 80 名工程师分到 第 2 组，以此类推。\n现在，我们可以合理的假设：每一位工程师的考试成绩应该大致服从正态分布，该分布的参数取决于他所使用的教学软件。同样，也可以合理的假设：尽管工程师的平均考试成绩取决于他所使用的教学软件，但考试成绩的变异性（variability）将源自 160 名工程师的内在变异（inherent variation），而不是来自所使用的软件。因此，如果我们令 \\(X_{ij},\\ i=1,...4, \\ j=1,...,40\\) 表示第 \\(i\\) 组中第 \\(j\\) 名工程师的考试成绩。一个合理的模型可能是假设 \\(X_{ij}\\) 是独立的随机变量，其中 \\(X_{ij}\\) 服从均值为 \\(\\mu_i\\) 且方差为 \\(\\sigma^2\\) 的正态分布。不同的教学软件可以互换的假设相当于对原假设 \\(H_0: \\mu_1 = \\mu_2 = \\mu_3 = \\mu_4\\) 进行检验。\n在本章中，我们将介绍一种技术可以用来检验如上案例中的假设。这种技术非常通用，可以用于推断与总体均值相关的大量参数，这种技术称之为 方差分析（ANOVA, analysis of variance）。",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>方差分析</span>"
    ]
  },
  {
    "objectID": "chapter_10/10.html#sec-10_1",
    "href": "chapter_10/10.html#sec-10_1",
    "title": "10  方差分析",
    "section": "",
    "text": "变异量\n\n\n\n正如在 小节 9.5 中对 变异 这个术语的解释，此处再次做如下的强调。\n变异量（the amount of variation）是指一组数据中的变异性，即数据的波动或分散程度。这种波动可以是由多种因素引起的，包括个体差异、测量误差、随机误差等。在后续的翻译章节中，我们会根据具体的场景交叉使用 变异量 和 数据波动，如无特殊说明，这些指的都是一个概念。\n同时，我们会避免使用 数据差异（difference） 来指代 变异量 的概念，因为在数学中，数据差异 更多指代两个数据之间的差值，因此和我们所讨论的数据的波动和分布程度并不是一个概念。",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>方差分析</span>"
    ]
  },
  {
    "objectID": "chapter_10/10.html#sec-10_2",
    "href": "chapter_10/10.html#sec-10_2",
    "title": "10  方差分析",
    "section": "10.2 综述",
    "text": "10.2 综述\n\n本章内容还需要继续修改。\n\n在 小节 8.4、小节 8.5.1、小节 8.6.1、小节 8.7.1 章节中，我们研究了关于两个总体均值的假设检验。在本章中，我们将研究关于多个总体均值的假设检验。\n在 小节 10.3 中，假设我们有来自 \\(m\\) 个不同总体的样本，每个样本的大小为 \\(n\\)，我们希望使用这些数据来检验 \\(m\\) 个总体均值相等的假设。对于这种场景，由于随机变量的均值仅取决于一个因素——即随机变量来自哪个样本——因此称这种情况为 单因素方差分析（one-way analysis of variance）。在 小节 10.3.2 中，我们展示了如何获得 \\(\\binom{m}{2}\\) 对总体均值之间的 多重比较（multiple comparisons）。在第 小节 10.3.3 中展示了当 \\(m\\) 个样本之间的样本大小不同时，如何检验总体均值相等的假设。\n在 小节 10.4 和 小节 10.5 中，我们将介绍由两个因素决定因变量均值的模型。在这些模型中，我们可以把自变量排列在一个矩阵中，在这个矩阵中，每一行和每一列都代表着一个因素或条件，矩阵中的元素代表着自变量的观测数据。此时，某个因变量的均值同时依赖于矩阵中的行和列。这种模型称为 双因素方差分析（two-way analysis of variance）。我们假设因变量的均值受到自变量的 加性方式（additive fashion）影响，具体地，第 \\(i\\) 行、第 \\(j\\) 列的变量对应的响应均值可以表示为 \\(\\mu + \\alpha_i + \\beta_j\\)。在 小节 10.4 中，我们将介绍如何估计 \\(\\alpha_i\\)、\\(\\beta_j\\)。在 小节 10.5 中将介绍如何进行检验假设，即某个特定因素不会影响结果的均值。\n在 小节 10.6 中，我们将介绍因变量的均值允许以非线性方式取决于自变量所在的行和列的情况，从而允许两个因素之间存在 交互作用（interaction）。我们还将介绍如何检验不存在交互作用的假设，以及关于不存在行效应和列效应对因变量均值影响的假设。\n在本章中，我们假设所有的数据都服从正态分布，并且都具有相同（虽然未知）的方差 \\(\\sigma^2\\)。使用 ANOVA 来检验和总体均值有关的多个参数的原假设 \\(H_0\\)，需要基于从共同的总体方差 $ ^2 $ 中推导出的两个估计量。第一个估计量是 \\(\\sigma^2\\) 的估计量，并且无论原假设是否为真，该估计量都是 \\(\\sigma^2\\) 的有效估计量。第二个估计量也是 \\(\\sigma^2\\) 的估计量，只是仅在 \\(H_0\\) 为真时，该估计量才是 \\(\\sigma^2\\) 的有效估计量。此外，当 \\(H_0\\) 不成立时，第二个估计量往往会超过 \\(\\sigma^2\\)。检验方法就是比较这两个估计量的值，并在第二个估计量与第一个估计量的比率足够大时拒绝 \\(H_0\\)。换句话说，当 \\(H_0\\) 为真时，这两个估计量应彼此接近（因为它们在这种情况下都是 \\(\\sigma^2\\) 的估计量），而当 \\(H_0\\) 不为真时，第二个估计量通常应比第一个大，因此当第二个估计量显著大于第一个时，拒绝 \\(H_0\\) 是自然的选择。\n我们将使用和卡方随机变量有关的事实来获得方差 \\(\\sigma^2\\) 的估计量。假设 \\(X_1, \\dots, X_N\\) 是独立的正态分布随机变量，它们可能具有不同的均值但却具有相同的方差 \\(\\sigma^2\\)，并且设 \\(\\mu_i = E[X_i]\\)，其中 \\(i = 1, \\dots, N\\)。\n由于随机变量\n\\(Z_i = (X_i - \\mu_i)/\\sigma, \\quad i = 1, \\dots, N\\)\n服从标准正态分布，因此根据卡方分布随机变量的定义可知：\n\\[\n\\sum_{i=1}^{N} Z_i^2 = \\sum_{i=1}^{N} \\frac{(X_i - \\mu_i)^2}{\\sigma^2}\n\\tag{10.1}\\]\n是一个自由度为 \\(N\\) 的卡方分布随机变量。假设每一个 \\(\\mu_i, \\ i = 1, \\dots, N\\) 都可以表示为 \\(k\\) 个未知参数的线性函数。同时，假设我们可以确定这 \\(k\\) 个参数的估计量，从而给出 \\(\\mu_i\\) 的估计量。如果我们用 \\(\\hat{\\mu}_i\\) 表示 \\(\\mu_i, \\ i=1,...,N\\) 的估计量，那么可以证明：\n\\(\\sum_{i=1}^{N} \\frac{(X_i - \\hat{\\mu}_i)^2}{\\sigma^2}\\)\n服从自由度为 \\(N - k\\) 的卡方分布。\n换句话说，\n\\(\\sum_{i=1}^{N} \\frac{(X_i - E[X_i])^2}{\\sigma^2}\\)\n是一个自由度为 \\(N\\) 的卡方分布随机变量。\n如果我们用 \\(k\\) 个参数的线性函数来表示每个 \\(E[X_i]\\)，并用这 \\(k\\) 个参数的估计量来替换这 \\(k\\) 个参数，那么我们得到的表达式仍然是卡方分布，但是其自由度将因为每个参数由其估计量来代替而减少 1。\n为了说明如上的结论，我们考虑所有均值已知并且相等的情况，即：\n\\(E[X_i] = \\mu, \\quad i = 1, \\dots, N\\)\n因为此时只有一个需要估计的参数，因此 \\(k = 1\\)。把公共均值 \\(\\mu\\) 的估计量 \\(\\overline{X}\\) 代入 式 10.1 得到如下的量：\n\\[\n\\sum_{i=1}^{N} \\frac{(X_i - \\overline{X})^2}{\\sigma^2}\n\\tag{10.2}\\]\n则 式 10.2 是一个自由度为 \\(N - 1\\) 的卡方分布随机变量。\n在所有均值都相等的情况下，数据 \\(X_1, \\dots, X_N\\) 均来自同一个正态分布总体，因此 式 10.2 等价与 \\((N - 1)S^2/\\sigma^2\\)，其中 \\(S^2\\) 是样本方差。换句话说，在这种场景下的结论就是：\\((N - 1)S^2/\\sigma^2\\) 是自由度为 \\(N - 1\\) 的卡方分布随机变量（参见 定理 6.2）。",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>方差分析</span>"
    ]
  },
  {
    "objectID": "chapter_10/10.html#sec-10_3",
    "href": "chapter_10/10.html#sec-10_3",
    "title": "10  方差分析",
    "section": "10.3 单因素方差分析",
    "text": "10.3 单因素方差分析\n有 \\(m\\) 个独立的样本，每个样本的大小为 \\(n\\)，其中第 \\(i\\) 个样本——\\(X_{i1}, X_{i2}, \\dots, X_{in}\\)——是均值 \\(\\mu_i\\)、方差 \\(\\sigma^2\\) 均未知的正态分布随机变量。也就是说，\n\\(X_{ij} \\sim \\mathcal{N}(\\mu_i, \\sigma^2), \\quad i = 1, \\dots, m, \\quad j = 1, \\dots, n\\)\n我们将对以下假设进行检验：\n\\(H_0: \\mu_1 = \\mu_2 = \\dots = \\mu_m \\quad vs \\quad H_1: \\text{并非所有的均值都相等}\\)\n也就是说，我们检验的原假设为所有总体的均值都是相等的，对应的备择假设为：至少存在两个总体的均值不同。如何理解我们所要进行的假设检验？想象一下，对于同一个物品而言，我们有 \\(m\\) 种不同的处理方法，第 \\(i\\) 种处理方法的结果是具有均值为 \\(\\mu_i\\)、方差为 \\(\\sigma^2\\) 的正态分布随机变量。然后我们感兴趣的是：把每种处理方法应用于 \\(n\\) 个物品并分析结果，以检验 所有处理方法的的效果相同 的假设。\n总共有 \\(nm\\) 个独立的正态分布随机变量 \\(X_{ij}\\)，因此 \\(X_{ij}\\) 标准化之后的随机变量的平方和将是 自由度为 \\(nm\\) 的卡方分布随机变量。\n\\[\n\\sum_{i=1}^{m} \\sum_{j=1}^{n} \\frac{(X_{ij} - E[X_{ij}])^2}{\\sigma^2} = \\sum_{i=1}^{m} \\sum_{j=1}^{n} \\frac{(X_{ij} - \\mu_i)^2}{\\sigma^2} \\sim \\chi^2_{nm}\n\\tag{10.3}\\]\n为了获得 \\(m\\) 个未知参数 \\(\\mu_1, \\dots, \\mu_m\\) 的估计量，设 \\(X_i.\\) 表示第 \\(i\\) 个样本中所有元素的平均值，即：\n\\(X_i. = \\frac{1}{n} \\sum_{j=1}^{n} X_{ij}\\)\n\\(X_i.\\) 是第 \\(i, \\ i = 1, \\dots, m\\) 个总体的样本均值，因此是总体均值 \\(\\mu_i\\) 的估计量。因此，用 \\(\\mu_i\\) 的估计量 \\(X_i.\\) 替代 式 10.3 中的 \\(\\mu_i\\)，得到：\n\\[\n\\sum_{i=1}^{m} \\sum_{j=1}^{n} \\frac{(X_{ij} - X_i.)^2}{\\sigma^2}\n\\tag{10.4}\\]\n式 10.4 是自由度为 \\(nm - m\\) 的卡方分布。（每估计一个参数，自由度就会减少 1。）\n令 \\(SS_W = \\sum_{i=1}^{m} \\sum_{j=1}^{n} (X_{ij} - X_i.)^2\\)\n因此，式 10.4 变为 \\(SS_W/\\sigma^2\\)。\n由于卡方分布随机变量的期望值等于其自由度，因此：\\(E[SS_W/\\sigma^2] = nm - m\\)，即 \\(E\\left[\\frac{SS_W}{nm - m}\\right] = \\sigma^2\\)。\n我们因此得到了方差 \\(\\sigma^2\\) 的第一个估计量，即 \\(\\frac{SS_W}{nm - m}\\)。注意，对于该估计量而言，我们并没有对原假设的真假作任何的假设。也就是说，无论原假设是否为真，我们都将有该估计量。\n\n定义 10.1 组内平方和（within samples sum of squares）\n\\(SS_W = \\sum_{i=1}^{m} \\sum_{j=1}^{n} (X_{ij} - X_{i.})^2\\)\n因为 \\(SS_W\\) 是利用样本均值代替 式 10.3 中的总体均值而得到的统计量，因此，我们称 \\(SS_W\\) 为 组内平方和（within samples sum of squares）。\n\\(\\frac{SS_W}{nm - m}\\) 是 \\(\\sigma^2\\) 的一个估计量。\\(\\blacksquare\\)\n\n方差 \\(\\sigma^2\\) 的第二个估计量是只有在原假设为真时的估计量。假设 \\(H_0\\) 为真，因此所有总体均值 \\(\\mu_i\\) 相等，即 \\(\\mu_i = \\mu\\)。此时，所有 \\(m\\) 个样本均值 \\(X_1., X_2., \\dots, X_m.\\) 都将具有相同的均值 \\(\\mu\\) 和相同的方差 \\(\\sigma^2/n\\)。因此，对 \\(X_i.\\) 标准化后的随机变量 \\(\\frac{X_i. - \\mu}{\\sqrt{\\sigma^2 / n}} = \\frac{\\sqrt{n}(X_i. - \\mu)}{\\sigma}\\) 的平方和是一个自由度为 \\(m\\) 的卡方分布随机变量。\n即当 \\(H_0\\) 为真时，\n\\[\n\\frac{n \\sum_{i=1}^{m} {(X_i. - \\mu)^2}}{\\sigma^2} \\sim \\chi^2_m\n\\tag{10.5}\\]\n当所有的总体均值都等于 \\(\\mu\\) 时，\\(\\mu\\) 的估计量是所有 \\(nm\\) 个数据值的平均值。也就是说，\\(\\mu\\) 的估计量是 \\(X_{..}\\)，即：\n\\(X_{..} = \\frac{1}{nm} \\sum_{i=1}^{m} \\sum_{j=1}^{n} X_{ij} = \\frac{1}{m} \\sum_{i=1}^{m} X_i.\\)\n用 \\(X_{..}\\) 代替 式 10.5 中的位置参数 \\(\\mu\\)，则当 \\(H_0\\) 为真时，有：\n\\(\\frac{n \\sum_{i=1}^{m} {(X_i. - X_{..})^2}}{\\sigma^2} \\sim \\chi_{m-1}^2\\)\n如果我们定义 \\(SS_B\\) 为\n\\(SS_B = n \\sum_{i=1}^{m} (X_i. - X_{..})^2\\)\n那么，当 \\(H_0\\) 为真时，\\(SS_B/\\sigma^2\\) 是自由度为 \\(m - 1\\) 的卡方分布随机变量。\n所以，当 \\(H_0\\) 为真时，有：\n\\(E\\left[\\frac{SS_B}{\\sigma^2}\\right] = m - 1\\)\n即，\n\\[\nE\\left[\\frac{SS_B}{(m - 1)}\\right] = \\sigma^2\n\\tag{10.6}\\]\n因此，当 \\(H_0\\) 为真时，\\(\\frac{SS_B}{m - 1}\\) 也是 \\(\\sigma^2\\) 的估计量。\n\n定义 10.2 组间平方和（between samples sum of squares）\n\\(SS_B = n \\sum_{i=1}^{m} (X_i. - X_{..})^2\\)\n称为 组间平方和（between samples sum of squares）。当 \\(H_0\\) 为真时，\\(\\frac{SS_B}{m - 1}\\) 是 \\(\\sigma^2\\) 的估计量。\\(\\blacksquare\\)\n\n因此，我们得到：\n\\(\\begin{align} \\frac{SS_W}{nm - m}, \\quad &\\text{总是} \\sigma^2 \\text{的估计量} \\\\ \\frac{SS_B}{m - 1}, \\quad &\\text{仅当} H_0 \\text{为真时} \\sigma^2 \\text{的估计量} \\end{align}\\)\n可以证明（在本节的末尾会对其进行证明），当 \\(H_0\\) 不为真时，\\(\\frac{SS_B}{m - 1}\\) 往往会超过 \\(\\sigma^2\\)，因此合理的做法是将检验统计量定义为：\n\\(TS = \\frac{SS_B/(m - 1)}{SS_W/(nm - m)}\\)\n并且当 \\(TS\\) 足够大时，拒绝 \\(H_0\\)。\n接下来的问题就是：当 \\(TS\\) 需要多大时才能拒绝 \\(H_0\\)？可以证明：如果 \\(H_0\\) 为真，那么 \\(SS_B\\) 和 \\(SS_W\\) 是独立的。这意味着，当 \\(H_0\\) 为真时，\\(TS\\) 服从分子自由度为 \\(m - 1\\)、分母自由度为 \\(nm - m\\) 的 \\(F-\\text{分布}\\)。我们使用符号 \\(F_{r,s}\\) 表示分子自由度为 \\(r\\)、分母自由度为 \\(s\\) 的 \\(F-\\text{分布}\\) 随机变量，令 \\(F_{\\alpha, m-1, nm-m}\\) 表示这个 \\(F-\\text{分布}\\) 的 \\(100(1 - \\alpha)\\%\\) 分位数，即：\n\\(P\\left \\{F_{m-1, nm-m} &gt; F_{\\alpha, m-1, nm-m}\\right\\} = \\alpha\\)\n在显著性水平 \\(\\alpha\\) 时，\\(H_0\\) 的检验为：\n\\[\n\\begin{align}\n\\text{拒绝} H_0&, \\quad \\text{如果} \\frac{SS_B/(m - 1)}{SS_W/(nm - m)} \\gt F_{\\alpha, m-1, nm-m} \\\\\n\\text{不拒绝} H_0&, \\quad \\text{其他}\n\\end{align}\n\\tag{10.7}\\]\n检验 所有总体均值是否相等 的假设的另一种计算方法是计算 \\(p-\\text{value}\\)。如果检验统计量 \\(TS = v\\)，则 \\(p-\\text{value}\\) 由以下公式给出：\n\\(p-\\text{value} = P\\{F_{m-1,nm-m} \\geq v\\}\\)\n在 R 中可以使用 pf() 计算 \\(p-\\text{value}\\)：\n# 方式 1\n1 - pf(v, m - 1, nm - m)\n\n# 方式 2\npf(v, m - 1, nm - m, lower.tail = FALSE)\n\n\n\n\n\n\n平方和恒等式（the sum of squares identity）\n\n\n\n如下的 代数恒等式（algebraic identity），称为 平方和恒等式（sum of squares identity），在手动计算时非常有用。\n\\(\\sum_{i=1}^{m} \\sum_{j=1}^{n} X_{ij}^2 = nm X^2_{..} + SS_B + SS_W\\)\n根据 定义 10.2，我们定义 \\(SS_B\\) 为：\n\\(SS_B = n \\sum_{i=1}^{m} (X_i. - X_{..})^2\\)\n在手动计算时，应首先计算 \\(SS_B\\) 的值。一旦得到 \\(SS_B\\) 后，可以根据 平方和恒等式 确定 \\(SS_W\\)。在计算 \\(SS_W\\) 的同时，我们也得到了 \\(\\sum_{i=1}^{m} \\sum_{j=1}^{n} X_{ij}^2\\) 和 \\(\\overline{X}^2_{..}\\)。然后根据如下公式确定 \\(SS_W\\)：\n\\(SS_W = \\sum_{i=1}^{m} \\sum_{j=1}^{n} X_{ij}^2 - nm X^2_{..} - SS_B\\)\n\n\n\n习题 10.1 一家汽车租赁公司使用 15 台相同的发动机在固定速度下测试 3 种不同的汽油品牌。每种汽油品牌都分配了其中的 5 台发动机，并且每台发动机分配了10 加仑汽油。以下的数据表示了不同发动机在汽油耗尽时所获得的总里程数：\n\n\n\n汽油品牌\n里程（英里）\n\n\n\n\n汽油 1\n220, 251, 226, 246, 260\n\n\n汽油 2\n244, 235, 232, 242, 225\n\n\n汽油 3\n252, 272, 250, 238, 256\n\n\n\n在 5% 的显著性水平下，检验假设：发动机的平均里程不受汽油品牌的影响。\n\n\n解 10.1. 我们手动计算 习题 10.1 的结果。\n首先需要注意的是，每个数据值减去一个常数不会影响检验统计量的值。因此，我们从每个数据值中减去 220，得到以下信息：\n\n\n\n汽油品牌\n里程（英里）\n\\(\\sum_j X_{ij}\\)\n\\(\\sum_j X_{ij}^2\\)\n\n\n\n\n1\n0, 31, 6, 26, 40\n103\n3273\n\n\n2\n24, 15, 12, 22, 5\n78\n1454\n\n\n3\n32, 52, 30, 18, 36\n168\n6248\n\n\n\n因为 \\(m = 3\\)，\\(n = 5\\)，并且\n\\(\\begin{align} X_1. &= \\frac{103}{5} = 20.6 \\\\ X_2. &= \\frac{78}{5} = 15.6 \\\\ X_3. &= \\frac{168}{5} = 33.6 \\\\ X_{..} &= \\frac{(103 + 78 + 168)}{15} = 23.2667 \\\\ X_{..}^2 &= 541.3393 \\end{align}\\)\n因此，\n\\(SS_B = 5[(20.6 - 23.2667)^2 + (15.6 - 23.2667)^2 + (33.6 - 23.2667)^2] = 863.3335\\)\n此外，\n\\(\\sum \\sum X_{ij}^2 = 3273 + 1454 + 6248 = 10975\\)\n根据平方和恒等式，\n\\(SS_W = 10975 - 15(541.3393) - 863.3335 = 1991.5785\\)\n因此，检验统计量的值为：\n\\(TS = \\frac{863.3335 / 2}{1991.5785/12} = 2.60\\)\n使用 R 语言计算得到 \\(p-\\text{value}\\)：\n\n1 - pf(2.60, 2, 12)\n\n[1] 0.1153232\n\n\n我们同样可以使用 R 来计算整个过程：\n\ngas1 &lt;- c(0, 31, 6, 26, 40)\ngas2 &lt;- c(24, 15, 12, 22, 5)\ngas3 &lt;- c(32, 52, 30, 18, 36)\ndata &lt;- matrix(c(gas1, gas2, gas3), ncol = 5, byrow = TRUE)\nx1. &lt;- mean(data[1,])\nx2. &lt;- mean(data[2,])\nx3. &lt;- mean(data[3,])\nx.. &lt;- mean(data)\nSS_B &lt;- 5 * sum(apply(data, 1, function(x) (mean(x) - mean(data))^2))\nx_ij_ss &lt;- sum(data^2)\nSS_W &lt;- x_ij_ss - 3 * 5 * x..^2 - SS_B\nTS = (SS_B / 2) / (SS_W / 12)\n1 - pf(TS, 2, 12)\n\n[1] 0.1152489\n\n\n由于 \\(p-\\text{value}\\) 大于 0.05，因此在 5% 的显著性水平下，我们不能拒绝汽品牌不会影响发动机里程的原假设。\\(\\blacksquare\\)\n\n现在让我们证明：\n\\(E\\left[\\frac{SS_B}{m-1}\\right] \\geq \\sigma^2\\)\n当且仅当 \\(H_0\\) 为真时，等号成立。\n因此，我们必须证明：\n\\(E\\left[\\frac{\\sum_{i=1}^{m} (X_{i.} - X_{..})^2}{m-1}\\right] \\geq \\frac{\\sigma^2}{n}\\)\n当且仅当 \\(H_0\\) 为真时，等号成立。\n令 \\(\\mu_. = \\frac{\\sum_{i=1}^{m} \\mu_i}{m}\\) 为 \\(m\\) 个总体均值的平均值。此外，对于 \\(i = 1, \\dots, m\\)，令：\n\\(Y_i = X_{i.} - \\mu_i + \\mu_.\\)\n由于 \\(X_{i.}\\) 服从均值为 \\(\\mu_i\\)、方差为 \\(\\frac{\\sigma^2}{n}\\) 的正态分布，因此 \\(Y_i\\) 服从均值为 \\(\\mu_.\\)、方差为 \\(\\frac{\\sigma^2}{n}\\) 的正态分布。因此，\\(Y_1, \\dots, Y_m\\) 构成了一个方差为 \\(\\frac{\\sigma^2}{n}\\) 的正态分布总体的样本。\n令 \\(Y_{.}\\) 为 \\(Y_i\\) 的均值：\n\\(Y_{.} = \\frac{\\sum_{i=1}^{m} Y_i}{m} = X_{..} - \\mu_. + \\mu_. = X_{..}\\)\n则：\n\\(X_{i.} - X_{..} = Y_i + \\mu_i - \\mu_. - Y_{.}\\)\n因此，\n\\(\\begin{align} E\\left[\\sum_{i=1}^{m} (X_{i.} - X_{..})^2\\right] &= E\\left[\\sum_{i=1}^{m} (Y_i - Y_{.} + \\mu_i - \\mu_.)^2\\right] \\\\ &= E\\left[\\sum_{i=1}^{m} \\left[(Y_i - Y_{.})^2 + (\\mu_i - \\mu_.)^2 + 2(\\mu_i - \\mu_.)(Y_i - Y_{.})\\right]\\right] \\\\ &= E\\left[\\sum_{i=1}^{m} (Y_i - Y_{.})^2\\right] + \\sum_{i=1}^{m} (\\mu_i - \\mu_.)^2 + 2\\sum_{i=1}^{m} (\\mu_i - \\mu_.) E[Y_i - Y_{.}] \\\\ &= (m-1)\\frac{\\sigma^2}{n} + \\sum_{i=1}^{m} (\\mu_i - \\mu_.)^2 + 2\\sum_{i=1}^{m} (\\mu_i - \\mu_.) E[Y_i - Y_{.}] \\\\ &= (m-1)\\frac{\\sigma^2}{n} + \\sum_{i=1}^{m} (\\mu_i - \\mu_.)^2\\end{align}\\)\n在倒数第二个等式中，\\(\\sum_{i=1}^{m} \\frac{(Y_i - Y_{.})^2}{(m-1)}\\) 是总体方差 \\(\\frac{\\sigma^2}{n}\\) 的无偏估计量，并且最后一个等式是因为 \\(E[Y_i - Y_{.}] = E[Y_i] - E[Y_{.}] = \\mu_. - \\mu_. = 0\\)。最后，在结果的等式两边都除以 \\(m-1\\) 得到：\n\\(E\\left[\\frac{\\sum_{i=1}^{m} (X_{i.} - X_{..})^2}{m-1}\\right] = \\frac{\\sigma^2}{n} + \\frac{\\sum_{i=1}^{m} (\\mu_i - \\mu_.)^2}{(m-1)}\\)\n因为 \\(\\sum_{i=1}^{m} (\\mu_i - \\mu_.)^2 \\geq 0\\)，当且仅当所有 \\(\\mu_i\\) 相等时等号成立，所以 \\(E\\left[\\frac{SS_B}{m-1}\\right] \\geq \\sigma^2\\)。\n表 10.1 总结了本节的结果：\n\n\n\n表 10.1: 单因素方差分析表；在显著性水平 \\(\\alpha\\) 下的检验，当 \\(TS \\geq F_{\\alpha, m-1, nm-m}\\) 时拒绝 \\(H_0\\)，否则不拒绝 \\(H_0\\)；如果 \\(TS = v\\)，则 \\(p-\\text{value} = P\\{F_{m-1, nm-m} \\geq v\\}\\)\n\n\n\n\n\n\n\n\n\n\n\n变异来源\n平方和\n自由度\n检验统计量的值\n\n\n\n\n组间\n\\(SS_B = n\\sum_{i=1}^{m} (X_{i.} - X_{..})^2\\)\n\\(m-1\\)\n\n\n\n组内\n\\(SS_W = \\sum_{i=1}^{m} \\sum_{j=1}^{n} (X_{ij} - X_{i.})^2\\)\n\\(nm-m\\)\n\n\n\n\n\n\n\\(TS = \\frac{SS_B/(m-1)}{SS_W/(nm-m)}\\)\n\n\n\n\n\n\n\n10.3.1 使用 R 计算统计量\n首先，需要注意的是：在 R 中定义矩阵时，矩阵元素默认按照列的方向来填充。例如，假设我们想要用 R 构建如下的矩阵并命名为 A：\n\\[\\begin{pmatrix}\n2 & 1 & 3 & 4 \\\\\n1 & 5 & 2 & 6 \\\\\n5 & 3 & 7 & 9\n\\end{pmatrix}\n\\]\n我们可以按如下方式进行：\n\nA &lt;- matrix(c(2, 1, 5, 1, 5, 3, 3, 2, 7, 4, 6, 9), nrow = 3, ncol = 4)\n\nR 中 matrix() 的定义是：在给出矩阵元素之后，给出行数，然后给出列数。因此，我们可以省略 nrow = 和 ncol =，直接定义 A 如下：\n\nA &lt;- matrix(c(2, 1, 5, 1, 5, 3, 3, 2, 7, 4, 6, 9), 3, 4)\n\n要显示矩阵，我们会输入：\n\nA &lt;- matrix(c(2, 1, 5, 1, 5, 3, 3, 2, 7, 4, 6, 9), 3, 4)\nA\n\n     [,1] [,2] [,3] [,4]\n[1,]    2    1    3    4\n[2,]    1    5    2    6\n[3,]    5    3    7    9\n\n\n当然，也可以通过列向量来初始化一个矩阵，例如：\n\nv1 &lt;- c(2, 1, 5)\nv2 &lt;- c(1, 5, 3)\nv3 &lt;- c(3, 2, 7)\nv4 &lt;- c(4, 6, 9)\nA &lt;- matrix(c(v1, v2, v3, v4), 3, 4)\nA\n\n     [,1] [,2] [,3] [,4]\n[1,]    2    1    3    4\n[2,]    1    5    2    6\n[3,]    5    3    7    9\n\n\n如果 \\(A\\) 是一个矩阵，\\(x\\) 是一个标量（scalar），那么 \\(A + x\\) 是一个矩阵，其结果是将 \\(x\\) 加到 \\(A\\) 的每个元素上。矩阵的幂运算意味着矩阵中的每个元素都执行该幂次方运算。例如，如果 \\(A\\) 是矩阵 \\([a_{i,j}]\\)），那么 \\(A^2\\) 就是矩阵 \\([a_{i,j}^2]\\)。（此处的这种约定与“矩阵乘法”的概念并不一致。）\n要对矩阵 \\(A\\) 的所有元素求和，只需输入 R 命令 sum(A)；要获得矩阵 \\(A\\) 中所有元素的平均值，使用 mean(A)。例如，如果我们想要计算矩阵 \\(A\\) 中所有元素的平方求和，并且想将结果命名为 ss，我们可以输入：\n\nA &lt;- matrix(c(2, 1, 5, 1, 5, 3, 3, 2, 7, 4, 6, 9), 3, 4)\nss &lt;- sum(A^2)\nss\n\n[1] 260\n\n\n如果我们想计算矩阵 \\(A\\) 中的每一行、或者每一列的元素的和，可以使用 rowSums()、colSums()。例如：\n\nA &lt;- matrix(c(2, 1, 5, 1, 5, 3, 3, 2, 7, 4, 6, 9), 3, 4)\nss &lt;- sum(A^2)\nss\n\n[1] 260\n\nrowSums(A)\n\n[1] 10 14 24\n\ncolSums(A)\n\n[1]  8  9 12 19\n\n\n如果想计算矩阵 \\(A\\) 中的每一行、或者每一列的元素的平均值，可以使用 rowMeans()、colMeans()。\n假设 \\(A\\) 是一个具有 \\(m\\) 行和 \\(n\\) 列的矩阵，并且对于 \\(b_1, \\dots, b_m\\)，我们想要得到一个矩阵 \\(B\\)。矩阵 \\(B\\) 是从 \\(A\\) 的第一行的每个元素中减去 \\(b_1\\)，从 \\(A\\) 的第二行的每个元素中减去 \\(b_2\\)，……可以使用 R 中的 sweep() 来完成该操作：\nA &lt;- matrix(...)\nb &lt;- c(b1,...,bm)\nB &lt;- sweep(A, 1, b)\n例如：\n\nA &lt;- matrix(c(2, 3, 3, 5, 1, 4), nrow = 2)\n\n# 对矩阵 A 的每一行中的所有元素，都减去该行对应的均值\nb &lt;- rowMeans(A)\nB &lt;- sweep(A, 1, b)\nB\n\n     [,1] [,2] [,3]\n[1,]    0    1   -1\n[2,]   -1    1    0\n\n\n同样，假设 \\(A\\) 是一个具有 \\(m\\) 行和 \\(n\\) 列的矩阵，并且对于 \\(c_1, \\dots, c_n\\)，我们想要得到一个矩阵 \\(C\\)。矩阵 \\(C\\) 是从 \\(A\\) 的第一列的每个元素中减去 \\(c_1\\)，从 \\(A\\) 的第二列的每个元素中减去 \\(c_2\\)，……同样可以使用 R 中的 sweep() 来完成该操作：\nA &lt;- matrix(...)\nc &lt;- c(c1,...,cn)\nC &lt;- sweep(A, 2, c)\n例如我们想让矩阵 \\(A\\) 的每一列的所有元素都加上该列对应的均值：\n\nA &lt;- matrix(c(2, 3, 3, 5, 1, 4), nrow = 2)\n\n# 对矩阵 A 的每一列中的所有元素，都加上该列对应的均值\nc &lt;- colMeans(A)\nC &lt;- sweep(A, 2, -c)\nC\n\n     [,1] [,2] [,3]\n[1,]  4.5    7  3.5\n[2,]  5.5    9  6.5\n\n\n接下来，我们将使用 R 来解决 习题 10.1 中所示的单因素方差分析问题。\n\ngas1 &lt;- c(220, 251, 226, 246, 260)\ngas2 &lt;- c(244, 235, 232, 242, 225)\ngas3 &lt;- c(252, 272, 250, 238, 256)\nG &lt;- matrix(c(gas1, gas2, gas3), nrow = 3, byrow = TRUE)\n\nm &lt;- nrow(G)\nn &lt;- ncol(G)\n\nrm &lt;- rowMeans(G)\nmm &lt;- mean(G)\nd &lt;- rm - mm\nSS_B &lt;- n * sum(d^2)\nSS_W &lt;- sum(G^2) - m * n * mm^2 - SS_B\nTS = (SS_B / (m - 1)) / (SS_W / (m * n - m))\n1 - pf(TS, m - 1, m * n - m)\n\n[1] 0.1152489\n\n\n\n\n10.3.2 样本均值的多重比较\n当我们拒绝了总体均值相等的原假设时，我们需要对不同总体的样本均值 \\(\\mu_1, \\dots, \\mu_m\\) 进行比较。实现这个目的常用方法是 \\(T-\\text{方法}\\)（T-method）。对于指定的 \\(\\alpha\\) 值，\\(T-\\text{方法}\\) 为所有的 \\(\\binom{m}{2}\\) 个差异 \\(\\mu_i - \\mu_j\\)（\\(i \\neq j, i, j = 1, \\dots, m\\)）提供了 联合置信区间（joint condifence intervals），从而使得这些所有的置信区间都将以 \\(1 - \\alpha\\) 的概率包含其对应的 \\(\\mu_i - \\mu_j\\)。\\(T-\\text{方法}\\) 基于以下结果：\n对于任何 \\(i \\neq j\\)，\\(\\mu_i - \\mu_j\\) 都将以 \\(1 - \\alpha\\) 的概率包含于如下的区间：\n\\(X_i. - X_j. - W &lt; \\mu_i - \\mu_j &lt; X_i. - X_j. + W\\)\n其中，\n\\(W = \\frac{1}{\\sqrt{n}}C(m, nm - m, \\alpha)\\sqrt{\\frac{SS_W}{nm - m}}\\)\n并且，附录中的 表 A.1 给出了 \\(\\alpha = 0.05\\) 和 \\(\\alpha = 0.01\\) 时，\\(C(m, nm - m, \\alpha)\\) 的值。\n\n习题 10.2 某大学声称，对于该大学而言，来自三个不同高中的学生的第一学年的平均成绩没有差异。下表给出了随机选择的 12 名学生的第一学年的平均成绩，其中每个高中选取 4 名学生。假设显著性水平为 5%，这些数据是否推翻了该大学的主张？如果是，请确定来自不同高中的学生的平均成绩之间的差异的置信区间，以便我们可以在 95% 的置信水平下相信所有的置信区间都是成立的。\n\n\n\n学校 1\n学校 2\n学校 3\n\n\n\n\n3.2\n3.4\n2.8\n\n\n3.4\n3.0\n2.6\n\n\n3.3\n3.7\n3.0\n\n\n3.5\n3.3\n2.7\n\n\n\n\n\n解 10.2. 首先，共有 \\(m = 3\\) 个样本，每个样本的大小为 \\(n = 4\\)。使用 R 进行计算得到的结果如下：\n\nschool1 &lt;- c(3.2, 3.4, 3.3, 3.5)\nschool2 &lt;- c(3.4, 3.0, 3.7, 3.3)\nschool3 &lt;- c(2.8, 2.6, 3.0, 2.7)\n\nG &lt;- matrix(c(school1, school2, school3), nrow = 3, byrow = TRUE)\nm &lt;- nrow(G)\nn &lt;- ncol(G)\n\nrm &lt;- rowMeans(G)\nmm &lt;- mean(G)\nd &lt;- rm - mm\nSS_B &lt;- n * sum(d^2)\nSS_W &lt;- sum(G^2) - m * n * mm^2 - SS_B\nTS = (SS_B / (m - 1)) / (SS_W / (m * n - m))\n1 - pf(TS, m - 1, m * n - m)\n\n[1] 0.00480163\n\n\n因此，我们会拒绝：来自三个高中的学生在第一学年的平均成绩相等的假设。\n为了确定总体均值差异的置信区间，首先注意到样本均值为：\n\\(X_1 = 3.350, \\quad X_2 = 3.350, \\quad X_3 = 2.775\\)\n从附录 表 A.1 中，我们看到 \\(C(3, 9, 0.05) = 3.95\\)，因此 \\(W = \\frac{3.95}{\\sqrt{4}} \\cdot \\sqrt{0.0431} = 0.410\\)，我们得到以下置信区间：\n\\(\\begin{align} -0.410 &lt; &\\mu_1 - \\mu_2 &lt; 0.410 \\\\ 0.165 &lt; &\\mu_1 - \\mu_3 &lt; 0.985 \\\\ 0.165 &lt; &\\mu_2 - \\mu_3 &lt; 0.985 \\end{align}\\)\n因此，在 95% 的置信水平下，我们可以得出结论：\n\n第 3 所高中的学生平均成绩比第 1 所或第 2 所高中的学生的平均成绩低，差异在 0.165 到 0.985 之间\n第 1 所高中和第 2 所高中的学生的平均成绩差异小于 0.410。\\(\\blacksquare\\)\n\n\n\n\n10.3.3 样本大小不同的单因素方差分析\n在上一节的模型中，我们都假设每个样本的样本大小均相同。虽然在理想情况下，样本大小都是相同的，但实际中却无法总是保证不同样本之间的样本大小都相同。假设我们有 \\(m\\) 个样本，样本的大小分别为 \\(n_1, n_2, \\dots, n_m\\)。也就是说，数据由独立随机变量 \\(X_{ij}\\) 组成，其中 \\(i = 1, \\dots, m\\)，\\(j = 1, \\dots, n_i\\)，并且：\n\\(X_{ij} \\sim \\mathcal{N}(\\mu_i, \\sigma^2)\\)\n我们仍然希望检验假设 \\(H_0\\)，即所有样本的均值都相等。\n\\(\\sum_{i=1}^{m} \\sum_{j=1}^{n_i} \\frac{(X_{ij} - E[X_{ij}])^2}{\\sigma^2} = \\sum_{i=1}^{m} \\sum_{j=1}^{n_i} \\frac{(X_{ij} - \\mu_i)^2}{\\sigma^2}\\)\n是自由度为 \\(\\sum_{i=1}^{m} n_i\\) 的卡方分布随机变量。因此，用 \\(\\mu_i\\) 的估计量 \\(X_{i.}\\)（第 \\(i\\) 个样本中的元素的平均值）代替每个总体的均值 \\(\\mu_i\\)，我们得到：\n\\(\\sum_{i=1}^{m} \\sum_{j=1}^{n_i} \\frac{(X_{ij} - X_{i.})^2}{\\sigma^2}\\)\n是自由度为 \\(\\sum_{i=1}^{m} n_i - m\\) 的卡方分布。因此，定义：\n\\(SS_W = \\sum_{i=1}^{m} \\sum_{j=1}^{n_i} (X_{ij} - X_{i.})^2\\)\n则 \\(SS_W / \\left( \\sum_{i=1}^{m} n_i - m \\right)\\) 是 \\(\\sigma^2\\) 的无偏估计量。\n此外，如果 \\(H_0\\) 为真，并且 \\(\\mu\\) 是公同均值，则随机变量 \\(X_{i.}\\) 将是独立的正态分布随机变量，且满足：\n\\(E[X_{i.}] = \\mu, \\quad \\text{Var}(X_{i.}) = \\frac{\\sigma^2}{n_i}\\)\n因此，当 \\(H_0\\) 为真时：\n\\(\\sum_{i=1}^{m} \\frac{(X_{i.} - \\mu)^2}{\\sigma^2 / n_i} = \\sum_{i=1}^{m} \\frac{n_i (X_{i.} - \\mu)^2}{\\sigma^2}\\)\n是自由度为 \\(m\\) 的卡方分布随机变量。因此，用估计量 \\(X_{..}\\)（所有 \\(X_{ij}\\) 的平均值）代替 \\(\\mu\\)，得到统计量：\n\\(\\sum_{i=1}^{m} \\frac{n_i (X_{i.} - X_{..})^2}{\\sigma^2}\\)\n是自由度为 \\(m - 1\\) 的卡方分布。因此，定义：\n\\(SS_B = \\sum_{i=1}^{m} n_i (X_{i.} - X_{..})^2\\)\n可以得出，当 \\(H_0\\) 为真时，\\(SS_B / (m - 1)\\) 也是 \\(\\sigma^2\\) 的无偏估计量。\n可以证明，当 \\(H_0\\) 为真时，\\(SS_B\\) 和 \\(SS_W\\) 是独立的，所以统计量：\n\\(\\frac{SS_B / (m - 1)}{SS_W / \\left( \\sum_{i=1}^{m} n_i - m \\right)}\\)\n是一个分子自由度为 \\(m - 1\\)、分母自由度为 \\(\\sum_{i=1}^{m} n_i - m\\) 的 \\(F-\\text{分布}\\) 随机变量。因此，我们可以得出显著性水平 为 \\(\\alpha\\) 下的零假设的检验结论：\n\\[\n\\begin{align}\n\\text{拒绝} H_0,& \\quad \\text{如果} \\frac{SS_B / (m - 1)}{SS_W / \\left( \\sum_{i=1}^{m} n_i - m \\right)} &gt; F_{m-1, N, \\alpha} \\\\\n\\text{接受} H_0,& \\quad \\text{否则}\n\\end{align}\n\\]\n其中，\\(N = \\sum_{i=1}^{m} n_i - m\\)。\n\n\n\n\n\n\n备注\n\n\n\n当样本大小不同时，我们称之为 不均衡场景（unbalanced case）。因为在样本均衡设计中，检验统计量对于总体方差不相同的场景相对不那么敏感。因此，样本均衡设计通常更稳健。所以，与不均衡场景相比，在设计检验时，我们需要尽可能的选择均衡的样本。",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>方差分析</span>"
    ]
  },
  {
    "objectID": "chapter_10/10.html#sec-10_4",
    "href": "chapter_10/10.html#sec-10_4",
    "title": "10  方差分析",
    "section": "10.4 双因素方差分析：引言和参数估计",
    "text": "10.4 双因素方差分析：引言和参数估计\n虽然我们可以用 小节 10.3 中的模型研究数据集中的单个因素的影响，但我们还可以研究多个因素的影响。在本节中，我们假设每个数据值都受到两个因素的影响。\n\n例 10.1 对 5 名学生进行了 4 种不同标准的阅读测试，测试的结果如下表所示。表中的 20 个数据受到两个因素的影响：考试因素和学生因素。考试因素有 4 个可能的取值或 水平（levels），学生因素有 5 个可能的取值或 水平（levels）。\n\n\n\n考试标准\n学生 1\n学生 2\n学生 3\n学生 4\n学生 5\n\n\n\n\n1\n75\n73\n60\n70\n86\n\n\n2\n78\n71\n64\n72\n90\n\n\n3\n80\n69\n62\n70\n85\n\n\n4\n73\n67\n63\n80\n92\n\n\n\n通常情况下，我们假设第一个因素有 \\(m\\) 个可能的 水平，第二个因素有 \\(n\\) 个可能的 水平。令 \\(X_{ij}\\) 表示当第一个因素处于第 \\(i\\) 个水平，第二个因素处于第 \\(j\\) 个水平时获得的值。我们经常将数据集表示为如下的数组：\n\\[\n\\begin{matrix}\nX_{11} & X_{12} & \\dots & X_{1j} & \\dots & X_{1n} \\\\\nX_{21} & X_{22} & \\dots & X_{2j} & \\dots & X_{2n} \\\\\n\\vdots & \\vdots & \\dots & \\vdots & \\dots & \\vdots \\\\\nX_{i1} & X_{i2} & \\dots & X_{ij} & \\dots & X_{in} \\\\\n\\vdots & \\vdots & \\dots & \\vdots & \\dots & \\vdots \\\\\nX_{m1} & X_{m2} & \\dots & X_{mj} & \\dots & X_{mn}\n\\end{matrix}\n\\]\n因此，我们称第一个因素为 “行” 因素，称第二个因素为 “列” 因素。\n如 小节 10.3 中，我们假设数据 \\(X_{ij}, i = 1, \\dots, m; j = 1, \\dots, n\\) 是具有相同方差 \\(\\sigma^2\\) 的独立正态分布随机变量。然而，在第 小节 10.3 中，我们假设，只有一个因素（即它所属样本的均值）会影响数据点的均值。而在本节中，我们则假设，数据点的均值以 加性方式（additive manner）取决于其所在的行和列。\n在 小节 10.3 的模型中，我们令 \\(X_{ij}\\) 表示第 \\(i\\) 个样本中第 \\(j\\) 个成员的值，那么模型可以符号化表示为：\n\\(E[X_{ij}] = \\mu_i\\)\n如果我们令 \\(\\mu\\) 表示 \\(\\mu_i\\) 的平均值，即\n\\(\\mu = \\frac{1}{m} \\sum_{i=1}^{m} \\mu_i\\)\n那么我们可以将模型重写为\n\\(E[X_{ij}] = \\mu + \\alpha_i\\)\n其中 \\(\\alpha_i = \\mu_i - \\mu\\)。根据 \\(\\alpha_i\\) 的定义：\\(\\mu_i\\) 相对于平均值 \\(\\mu\\) 的偏差，我们很容易得到：\n\\(\\sum_{i=1}^{m} \\alpha_i = 0\\)\n一个 双因素加性模型 也可以用行偏差和列偏差来表示。如果我们令 \\(\\mu_{ij} = E[X_{ij}]\\)，则加性模型假设对于某些常数 \\(a_i\\)（\\(i = 1, \\dots, m\\)）和 \\(b_j\\)（\\(j = 1, \\dots, n\\)）有：\n\\(\\mu_{ij} = a_i + b_j\\)\n令：\n\\(\\mu_{i.} = \\frac{1}{n} \\sum_{j=1}^{n} \\mu_{ij}, \\quad \\mu_{.j} = \\frac{1}{m} \\sum_{i=1}^{m} \\mu_{ij}, \\quad \\mu_{..} = \\frac{1}{mn} \\sum_{i=1}^{m} \\sum_{j=1}^{n} \\mu_{ij}\\)\n同样地，我们定义\n\\(a_{.} = \\frac{1}{m} \\sum_{i=1}^{m} a_i, \\quad b_{.} = \\frac{1}{n} \\sum_{j=1}^{n} b_j\\)\n因为：\n\\(\\mu_{i.} = \\frac{1}{n} \\sum_{j=1}^{n} (a_i + b_j)/n = a_i + b_{.}\\)\n同理，\n\\(\\mu_{.j} = a_{.} + b_j, \\quad \\mu_{..} = a_{.} + b_{.}\\)\n如果我们令：\n\\(\\mu = \\mu_{..} = a_{.} + b_{.}\\)\n\\(\\alpha_i = \\mu_{i.} - \\mu = a_i - a_{.}\\)\n\\(\\beta_j = \\mu_{.j} - \\mu = b_j - b_.\\)\n则我们有：\n\\(\\mu_{ij} = E[X_{ij}] = \\mu + \\alpha_i + \\beta_j\\)\n其中，\\(\\sum_{i=1}^{m}{\\alpha_i} = \\sum_{j=1}^{n}{\\beta_j} = 0\\)\n我们称 \\(\\mu\\) 被为 总均值（the grand mean），\\(\\alpha_i\\) 为由第 \\(i\\) 行导致的相对于 总均值 的偏差，\\(\\beta_j\\) 为由第 \\(j\\) 列导致的相对于 总均值 的偏差。\n接下来，我们确定参数 \\(\\mu, \\alpha_i, \\beta_j\\)（\\(i = 1, \\dots, m\\), \\(j = 1, \\dots, n\\)）的估计量。\n令\n\\(X_{i.} = \\frac{1}{n} \\sum_{j=1}^{n} X_{ij} \\quad \\text{表示第} i \\text{行中的值的平均值}\\)\n\\(X_{.j} = \\frac{1}{m} \\sum_{i=1}^{m} X_{ij} \\quad \\text{表示第} j \\text{列中的值的平均值}\\)\n\\(X_{..} = \\frac{1}{nm} \\sum_{i=1}^{m} \\sum_{j=1}^{n} X_{ij} \\quad \\text{表示所有数据值的平均值}\\)\n则：\n\\[\n\\begin{align}\nE[X_{i.}] &= \\frac{1}{n} \\sum_{j=1}^{n} E[X_{ij}] \\\\\n&= \\mu + \\frac{1}{n} \\sum_{j=1}^{n} \\alpha_i + \\frac{1}{n} \\sum_{j=1}^{n} \\beta_j \\\\\n&= \\mu + \\alpha_i \\quad \\because \\sum_{j=1}^{n} \\beta_j = 0\n\\end{align}\n\\]\n同理有：\n\\(E[X_{.j}] = \\mu + \\beta_j\\)\n\\(E[X_{..}] = \\mu\\)\n因为上述等式等价于：\n\\[\n\\begin{align}\nE[X_{..}] &= \\mu \\\\\nE[X_{i.} - X_{..}] &= \\alpha_i \\\\\nE[X_{.j} - X_{..}] &= \\beta_j\n\\end{align}\n\\]\n我们发现，参数 \\(\\mu, \\alpha_i, \\beta_j\\) 的无偏估计量，记作 \\(\\hat{\\mu}, \\hat{\\alpha_i}, \\hat{\\beta_j}\\) 为：\n\\[\n\\begin{align}\n\\hat{\\mu} &= X_{..} \\\\\n\\hat{\\alpha_i} &= X_{i.} - X_{..} \\\\\n\\hat{\\beta_j} &= X_{.j} - X_{..}\n\\end{align}\n\\]\n\\(\\blacksquare\\)\n\n\n习题 10.3 下表的数据来自 例 10.1，请使用这些数据估计模型的参数。\n\n\n\n\n\n\n\n\n\n\n\n\n\n考试\n学生 1\n学生 2\n学生 3\n学生 4\n学生 5\n行总计\n\\(X_{i.}\\)\n\n\n\n\n1\n75\n73\n60\n70\n86\n364\n72.8\n\n\n2\n78\n71\n64\n72\n90\n375\n75\n\n\n3\n80\n69\n62\n70\n85\n366\n73.2\n\n\n4\n73\n67\n63\n80\n92\n375\n75\n\n\n列总计\n306\n280\n249\n292\n353\n1480 (grand total)\n\n\n\n\\(X_{.j}\\)\n76.5\n70\n62.25\n73\n88.25\n\\(X_{..} = \\frac{1480}{20} = 74\\)\n\n\n\n\n\n\n解 10.3. 估计量为：\n\\(\\hat{\\mu} = 74\\)\n\\(\\hat{\\alpha_1} = 72.8 - 74 = -1.2 \\quad \\hat{\\beta_1} = 76.5 - 74 = 2.5\\)\n\\(\\hat{\\alpha_2} = 75 - 74 = 1 \\quad \\hat{\\beta_2} = 70 - 74 = -4\\)\n\\(\\hat{\\alpha_3} = 73.2 - 74 = -0.8 \\quad \\hat{\\beta_3} = 62.25 - 74 = -11.75\\)\n\\(\\hat{\\alpha_4} = 75 - 74 = 1 \\quad \\hat{\\beta_4} = 73 - 74 = -1\\)\n\\(\\hat{\\beta_5} = 88.25 - 74 = 14.25\\)\n因此，如果随机选择一名学生并随机指定一场考试，那么我们对其平均分的估计是 \\(\\hat{\\mu} = 74\\)。如果我们知道该学生选择了考试 \\(i\\)，则这会使我们对其平均分的估计增加 \\(\\hat{\\alpha_i}\\)；如果我们知道学生的编号是 \\(j\\)，则这会使我们对其平均分的估计增加 \\(\\hat{\\beta_j}\\)。\n例如，我们会估计第 1 场考试中第 2 名学生的分数是一个随机变量，其均值为：\n\\(\\hat{\\mu} + \\hat{\\alpha_1} + \\hat{\\beta_2} = 74 - 1.2 - 4 = 68.8\\)\n\\(\\blacksquare\\)",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>方差分析</span>"
    ]
  },
  {
    "objectID": "chapter_10/10.html#sec-10_5",
    "href": "chapter_10/10.html#sec-10_5",
    "title": "10  方差分析",
    "section": "10.5 双因素方差分析：检验假设",
    "text": "10.5 双因素方差分析：检验假设\n考虑一个双因素模型，数据为 \\(X_{ij}\\)，\\(i = 1, \\dots, m\\)，\\(j = 1, \\dots, n\\)。假设 \\(X_{ij}\\) 是具有共同方差 \\(\\sigma^2\\) 的独立正态分布随机变量，且其均值满足以下条件：\n\\(E[X_{ij}] = \\mu + \\alpha_i + \\beta_j\\)\n其中，\n\\(\\sum_{i=1}^{m} \\alpha_i = \\sum_{j=1}^{n} \\beta_j = 0\\)\n在本节中，我们将关注检验如下的假设：\n\\(H_0: \\text{所有的} \\ \\alpha_i = 0 \\quad vs \\quad H_1: \\text{并非所有的} \\ \\alpha_i \\ \\text{都等于} 0\\)\n该原假设表明 \\(X_{ij}\\) 不存在行效应，即某个数据的值不受其所在行的因素水平的影响。\n类似的，我们还将关注有关列的假设，即\n\\(H_0: \\text{所有的} \\ \\beta_j = 0 \\quad vs \\quad H_1: \\text{并非所有的} \\ \\beta_j \\ \\text{都等于} 0\\)\n我们将使用 方差分析（analysis of variance） 的方法来检验上述原假设。在 方差分析 中，我们会得到方差 \\(\\sigma^2\\) 的两个不同的估计量：\n\n第一个估计量总是有效估计量。\n第二个估计量只有在原假设为真时才是有效估计量。\n此外，当原假设不为真时，第二个估计量往往大于 \\(\\sigma^2\\)。\n\n为了获得 \\(\\sigma^2\\) 的第一个估计量，我们需要基于如下的事实：\n\\(\\sum_{i=1}^{m} \\sum_{j=1}^{n} \\frac{(X_{ij} - E[X_{ij}])^2}{\\sigma^2} = \\sum_{i=1}^{m} \\sum_{j=1}^{n} \\frac{(X_{ij} - \\mu - \\alpha_i - \\beta_j)^2}{\\sigma^2}\\)\n是自由度为 \\(nm\\) 的卡方随机变量。如果用未知参数的估计量替换对应的未知参数 \\(\\mu, \\alpha_1, \\alpha_2, \\dots, \\alpha_m, \\beta_1, \\beta_2, \\dots, \\beta_n\\)，则结果仍然是一个卡方分布随机变量，但其自由度将随着估计参数的增加而对应的减少（每估计一个参数，自由度减 1）。由于 \\(\\sum_{i=1}^{m} \\alpha_i = \\sum_{j=1}^{n} \\beta_j = 0\\)，这意味着当我们估计了 \\(m-1\\) 个 \\(\\alpha_i\\) 后，最后一个 \\(\\alpha_i\\) 也随之确定；同理，我们仅需要估计 \\(n-1\\) 个 \\(\\beta_j\\) 就可以确定所有的 \\(\\beta_j\\)。最后，因为 \\(\\mu\\) 也需要估计，所以需要估计的参数总数为：\n\\(1 + m - 1 + n - 1 = n + m - 1\\)\n因此，\n\\(\\sum_{i=1}^{m} \\sum_{j=1}^{n} \\frac{(X_{ij} - \\hat{\\mu} - \\hat{\\alpha_i} - \\hat{\\beta_j})^2}{\\sigma^2}\\)\n是一个自由度为 \\(nm - (n + m - 1) = (n-1)(m-1)\\) 的卡方分布随机变量。\n因为 \\(\\hat{\\mu} = X_{..}, \\hat{\\alpha_i} = X_{i.} - X_{..}, \\hat{\\beta_j} = X_{.j} - X_{..}\\)，所以有：\n\\[\n\\sum_{i=1}^{m} \\sum_{j=1}^{n} \\frac{(X_{ij} - X_{i.} - X_{.j} + X_{..})^2}{\\sigma^2}\n\\tag{10.8}\\]\n是一个自由度为 \\((n-1)(m-1)\\) 的卡方分布随机变量。\n\n定义 10.3 误差平方和（error sum of squares）\n我们称统计量 \\(SS_e\\) 为 误差平方和：\n\\(SS_e = \\sum_{i=1}^{m} \\sum_{j=1}^{n} (X_{ij} - X_{i.} - X_{.j} + X_{..})^2\\) \\(\\blacksquare\\)\n\n如果我们认为某个值与我们所估计的均值之间的差异是“误差”（error），那么 \\(SS_e\\) 就等于这些误差的平方的总和。由于 \\(SS_e / \\sigma^2\\) 就是 式 10.8，所以我们知道 \\(SS_e / \\sigma^2\\) 是一个自由度为 \\((n-1)(m-1)\\) 的卡方分布随机变量。因为卡方分布随机变量的期望值等于其自由度，所以：\n\\(E[SS_e/\\sigma^2] = (n-1)(m-1)\\)\n即：\n\\(E\\left[\\frac{SS_e}{(n-1)(m-1)}\\right] = \\sigma^2\\)\n所以：\n\\(\\frac{SS_e}{(n-1)(m-1)}\\) 是 \\(\\sigma^2\\) 的无偏估计量。\n假设我们现在想要检验 不存在行效应 的原假设，即我们想要检验\n\\(H_0: \\text{所有的} \\alpha_i = 0 \\quad vs \\quad  H_1: \\text{并不是所有的} \\alpha_i \\text{都为 0}\\)\n为了获得 \\(\\sigma^2\\) 的第二个估计量，考虑行均值 \\(X_{i.}\\)，\\(i = 1, \\ldots, m\\)。当 \\(H_0\\) 为真时，每个 \\(\\alpha_i = 0\\)，因此\n\\(E[X_{i.}] = \\mu + \\alpha_i = \\mu\\)\n因为每个 \\(X_{i.}\\) 是 \\(n\\) 个随机变量的均值，而每个随机变量的方差为 \\(\\sigma^2\\)，因此有\n\\(\\text{Var}(X_{i.}) = \\frac{\\sigma^2}{n}\\)\n因此当 \\(H_0\\) 为真时：\n\\(\\sum_{i=1}^{m}(X_{i.} - E[X_{i.}])^2 / \\text{Var}(X_{i.}) = n \\sum_{i=1}^{m}(X_{i.} - \\mu)^2 / \\sigma^2\\)\n将服从自由度为 \\(m\\) 的卡方分布。如果我们现在用 \\(X_{..}\\) （\\(\\mu\\) 的估计量）代替 \\(\\mu\\)，那么得到的表达式仍将是卡方分布，但自由度会减少 1。因此，当 \\(H_0\\) 为真时，有以下结论：\n\\(n \\sum_{i=1}^{m}(X_{i.} - X_{..})^2 / \\sigma^2\\)\n服从自由度为 \\(m-1\\) 的卡方分布。\n\n定义 10.4 行平方和（row sum of squares）\n我们称统计量 \\(SS_r\\) 为 行平方和：\n\\(SS_r = n \\sum_{i=1}^{m}(X_{i.} - X_{..})^2\\)\n\n当 \\(H_0\\) 为真时，\\(\\frac{SS_r}{\\sigma^2}\\) 服从自由度为 \\(m-1\\) 的卡方分布。因此，当 \\(H_0\\) 为真时，有\n\\(E[SS_r / \\sigma^2] = m-1\\)\n即：\n\\(E[SS_r / (m-1)] = \\sigma^2\\)\n此外，可以证明，当 \\(H_0\\) 不为真时，\\(\\frac{SS_r}{(m-1)}\\) 的值将大于 \\(\\sigma^2\\)。\n因此，我们再次获得了 \\(\\sigma^2\\) 的两个估计量：\n\n无论原假设是否为真，第一个估计量 \\(\\frac{SS_e}{(n-1)(m-1)}\\) 都是有效估计量。\n而仅在 \\(H_0\\) 为真时，第二个估计量 \\(\\frac{SS_r}{(m-1)}\\) 才是有效估计量；当 \\(H_0\\) 不为真时，\\(\\frac{SS_r}{(m-1)}\\) 将大于 \\(\\sigma^2\\)。\n\n基于 \\(\\sigma^2\\) 的两个估计量（\\(SS_e\\) 和 \\(SS_r\\)）的比值对 \\(H_0\\) 进行检验。具体来说，我们使用如下的检验统计量：\n\\(TS = \\frac{SS_r/(m-1)}{SS_e/[(n-1)(m-1)]}\\)\n可以证明，当 \\(H_0\\) 为真时，估计量是独立的，所以在显著性水平为 \\(\\alpha\\) 下的检验为：\n\\(\\begin{align} \\text{拒绝} \\quad &H_0, \\quad \\text{如果} \\ TS \\geq F_{\\alpha, m-1, (n-1)(m-1)} \\\\ \\text{不拒绝} \\quad &H_0, \\quad \\text{否则}\\end{align}\\)\n或者，可以通过计算检验统计量 \\(v\\) 的 \\(p-\\text{value}\\) 来进行检验：\n\\(p-\\text{value} = P(F_{m-1,(n-1)(m-1)} \\geq v)\\)\n类似的，我们同样可以使用如上的方法检验列效应的原假设，即检验所有的 \\(\\beta_j = 0\\) 的原假设。表 10.2 和 表 10.3 对本节介绍的 行效应 和 列效应 的假设检验方法进行了总结。同时，可以使用 R 来计算相关的 \\(p-\\text{value}\\)。\n\n\n\n表 10.2: 行平方和，列平方和以及误差平方和\n\n\n\n\n\n\n\n\n\n\n\n平方和\n自由度\n\n\n\n\n行\n\\(SS_r = n \\sum_{i=1}^{m} (X_{i.} - X_{..})^2\\)\n\\(m - 1\\)\n\n\n列\n\\(SS_c = m \\sum_{j=1}^{n} (X_{.j} - X_{..})^2\\)\n\\(n - 1\\)\n\n\n误差\n\\(SS_e = \\sum_{i=1}^{m} \\sum_{j=1}^{n} (X_{ij} - X_{i.} - X_{.j} + X_{..})^2\\)\n\\((n - 1)(m - 1)\\)\n\n\n\n\n\n\n\n\n\n表 10.3: 双因素方差分析（Two-Factor ANOVA），\\(N = (n-1)(m-1)\\)\n\n\n\n\n\n\n\n\n\n\n\n原假设\n检验统计量\n显著性水平 \\(\\alpha\\) 下的检验\n\\(TS=v\\) 时的 \\(p-\\text{value}\\)\n\n\n\n\n所有 \\(\\alpha_i = 0\\)\n\\(\\frac{SS_r/(m-1)}{SS_e/N}\\)\n若 \\(TS \\geq F_{\\alpha,m-1,N}\\)，则拒绝 \\(H_0\\)\n\\(P\\{F_{m-1,N} \\geq v\\}\\)\n\n\n所有 \\(\\beta_j = 0\\)\n\\(\\frac{SS_c/(n-1)}{SS_e/N}\\)\n若 \\(TS \\geq F_{\\alpha,n-1,N}\\)，则拒绝 \\(H_0\\)\n\\(P\\{F_{n-1,N} \\geq v\\}\\)\n\n\n\n\n\n\n\n例 10.2 以下数据表示在热排放附近的 6 个站点收集的、大型无脊椎动物的不同种类的数量，数据收集的时间为 1970 年至 1977 年。\n\n\n\n\n\n\n注记\n\n\n\n热排放通常是指来自工业设施（如发电厂、工厂或其他热力系统）的废热，通常以温水或蒸汽的形式排放到附近的水体或空气中。因为水温的上升可能改变栖息地的条件，影响物种的多样性和数量，所以这种排放可能会对周围的环境、生态系统以及水生生物产生影响。\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nYear\nStation 1\nStation 2\nStation 3\nStation 4\nStation 5\nStation 6\n\n\n\n\n1970\n53\n35\n31\n37\n40\n43\n\n\n1971\n36\n34\n17\n21\n30\n18\n\n\n1972\n47\n37\n17\n31\n45\n26\n\n\n1973\n55\n31\n17\n23\n43\n37\n\n\n1974\n40\n32\n19\n26\n45\n37\n\n\n1975\n52\n42\n20\n27\n26\n32\n\n\n1976\n39\n28\n21\n21\n36\n28\n\n\n1977\n40\n32\n21\n21\n36\n35\n\n\n\n我们使用 R 来检验以下假设：\n\n\n数据是否随时间变化\n\n\n数据是否在各站点之间变化\n\n\n\nv1 &lt;- c(53, 36, 47, 55, 40, 52, 39, 40)\nv2 &lt;- c(35, 34, 37, 31, 32, 42, 28, 32)\nv3 &lt;- c(31, 17, 17, 17, 19, 20, 21, 21)\nv4 &lt;- c(37, 21, 31, 23, 26, 27, 21, 21)\nv5 &lt;- c(40, 32, 45, 43, 45, 26, 36, 36)\nv6 &lt;- c(43, 18, 26, 37, 37, 32, 28, 35)\nX &lt;- matrix(c(v1, v2, v3, v4, v5, v6), 8, 6)\nH &lt;- sweep(X, 1, rowMeans(X)) + mean(X)\nC &lt;- sweep(H, 2, colMeans(X))\nSSe &lt;- sum(C^2)\nD &lt;- rowMeans(X) - mean(X)\nSSr &lt;- ncol(X) * sum(D^2)\nE &lt;- colMeans(X) - mean(X)\nSSc &lt;- nrow(X) * sum(E^2)\nN &lt;- (nrow(X) - 1) * (ncol(X) - 1)\nTSrow &lt;- (SSr / (nrow(X) - 1)) / (SSe / N)\nTSrow\n\n[1] 3.602264\n\n1 - pf(TSrow, nrow(X) - 1, N)\n\n[1] 0.005037051\n\nTScol = (SSc / (ncol(X) - 1)) / (SSe / N)\nTScol\n\n[1] 22.67062\n\n1 - pf(TScol, ncol(X) - 1, N)\n\n[1] 4.413647e-10\n\n\n因此，数据分布是否不依赖于年份的 F 统计量的值为 3.602，其对应的 \\(p-\\text{value}\\) 为 0.005；数据分布是否不依赖于站点的 F 统计量的值为 22.67，其对应的 \\(p-\\text{value}\\) 为 \\(4 \\times 10^{-10}\\)。因此，在几乎所有的显著性水平下，这两个原假设我们都将拒绝。 \\(\\blacksquare\\)",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>方差分析</span>"
    ]
  },
  {
    "objectID": "chapter_10/10.html#sec-10_6",
    "href": "chapter_10/10.html#sec-10_6",
    "title": "10  方差分析",
    "section": "10.6 有交互效应的双因素方差分析",
    "text": "10.6 有交互效应的双因素方差分析\n在 小节 10.4 和 小节 10.5 中，我们讨论了观察数据的分布依赖于两个因素——称之为 行因素 和 列因素——的场景。具体来说，我们假设 \\(X_{ij}\\) 的均值可以表示为两部分的和——一部分取决于数据所在的行，另一部分取决于数据所在的列。即我们假设\n\\(X_{ij} \\sim \\mathcal{N}(\\mu + \\alpha_i + \\beta_j, \\sigma^2), \\quad i = 1, \\ldots, m, \\quad j = 1, \\ldots, n\\)\n然而，上述模型的问题是：上述模型总是假设 行因素 和 列因素 的效应是可加的，它不允许 行因素 和 列因素 之间存在 交互效应。\n例如，考虑如下的实验，在该实验中，我们需要比较四个不同的工人在使用三台不同机器时，生产的次品数量的均值。在分析结果时，我们可能假设，对于不同的工人而言，使用某台机器产生的次品数量的增量是相同的。但是，也存在如下的可能：同一机器对于不同工人而言所产生的次品数量的增量并不一致，也就是说，可能存在 \\(\\text{工人-机器}\\) 的 交互效应（interation）。而在加性模型中，不允许存在这种 交互效应。\n\n\n\n\n\n\n交互效应\n\n\n\n交互效应或者交互作用指的是：在某个自变量的不同水平上，另一个自变量对因变量的效应不同。例如上面提到的，在工人这个自变量的不同水平上，同一台机器对于产品次品数量的效应并不相同。\n\n\n为了考虑行和列之间可能的 交互效应，令\n\\(\\mu_{ij} = E[X_{ij}]\\)\n并定义 \\(\\mu, \\alpha_i, \\beta_j, \\gamma_{ij}, i = 1, \\ldots, m; j = 1, \\ldots, n\\)：\n\\(\\begin{align} \\mu &= \\mu_{..} \\\\ \\alpha_i &= \\mu_{i.} - \\mu_{..} \\\\ \\beta_j &= \\mu_{.j} - \\mu_{..} \\\\ \\gamma_{ij} &= \\mu_{ij} - \\mu_{i.} - \\mu_{.j} + \\mu_{..} \\end{align}\\)\n显然有：\n\\(\\mu_{ij} = \\mu + \\alpha_i + \\beta_j + \\gamma_{ij}\\)\n并且，也可以很容易的证明：\n\\(\\sum_{i=1}^{m} \\alpha_i = \\sum_{j=1}^{n} \\beta_j = \\sum_{i=1}^{m} \\gamma_{ij} = \\sum_{j=1}^{n} \\gamma_{ij} = 0\\)\n\n参数 \\(\\mu\\) 是 \\(nm\\) 个均值的平均值，我们称之为总体均值（grand mean）。\n参数 \\(\\alpha_i\\) 表示第 \\(i\\) 行的均值与 总体均值 之间的差值，我们被之称为 行效应（effect of row）。\n参数 \\(\\beta_j\\) 表示第 \\(j\\) 列的均值与 总体均值 之间的差值，我们称之为 列效应（effect of column）。\n参数 \\(\\gamma_{ij} = \\mu_{ij} - (\\mu + \\alpha_i + \\beta_j)\\) 表示 \\(\\mu_{ij}\\) 与 总体均值 和 第 \\(i\\) 行效应、第 \\(j\\) 列效应 的和的差值，是对第 \\(i\\) 行和第 \\(j\\) 列的加性偏离的度量，我们称之为第 \\(i\\) 行和第 \\(j\\) 列的 交互效应。\n\n为了能够检验假设：行和列之间没有交互效应——也就是说，所有 \\(\\gamma_{ij} = 0\\)——每对因素需要有多个观察值。假设每行和每列都有 \\(l\\) 个观察值。也就是说，假设数据是 \\(\\{X_{ijk}, i=1, \\dots, m; j=1, \\dots, n; k=1, \\dots, l\\}\\)，其中 \\(X_{ijk}\\) 是第 \\(i\\) 行和第 \\(j\\) 列中的第 \\(k\\) 个观察值。由于假设所有观察值都是相互独立的正态分布随机变量且具有相同的方差 \\(\\sigma^2\\)，所以：\n\\(X_{ijk} \\sim \\mathcal{N}(\\mu + \\alpha_i + \\beta_j + \\gamma_{ij}, \\sigma^2)\\)\n其中：\n\\[\n\\sum_{i=1}^{m} \\alpha_i = \\sum_{j=1}^{n} \\beta_j = \\sum_{i=1}^{m} \\gamma_{ij} = \\sum_{j=1}^{n} \\gamma_{ij} = 0\n\\tag{10.9}\\]\n我们将对上述参数进行估计，并检验以下原假设：\n\\(\\begin{align} H_0^r: \\alpha_i &= 0, \\quad \\text{for all} \\ i \\\\ H_0^c: \\beta_j &= 0, \\quad \\text{for all} \\ j \\\\ H_0^{int}: \\gamma_{ij} &= 0, \\quad \\text{for all} \\ i, j \\end{align}\\)\n也就是说，\\(H_0^r\\) 是没有行效应的假设，\\(H_0^c\\) 是没有列效应的假设，\\(H_0^{int}\\) 是没有行和列之间交互效应的假设。\n根据 式 10.9 和 \\(E[X_{ijk}] = \\mu_{ij} = \\mu + \\alpha_i + \\beta_j + \\gamma_{ij}\\) 可以得到：\n\\(\\begin{align} E[X_{ij.}] &= \\mu_{ij} = \\mu + \\alpha_i + \\beta_j + \\gamma_{ij} \\\\ E[X_{i..}] &= \\mu + \\alpha_i \\\\ E[X_{.j.}] &= \\mu + \\beta_j \\\\ E[X_{...}] &= \\mu \\end{align}\\)\n因此，各参数的无偏估计量为：\n\\(\\begin{align} \\hat{\\mu} &= X_{...} \\\\ \\hat{\\beta}_j &= X_{.j.} - X_{...} \\\\ \\hat{\\alpha}_i &= X_{i..} - X_{...} \\\\ \\hat{\\gamma}_{ij} &= X_{ij.} - \\hat{\\mu} - \\hat{\\beta}_j - \\hat{\\alpha}_i = X_{ij.} - X_{i..} - X_{.j.} + X_{...} \\end{align}\\)\n为了为原假设 \\(H_0^{int}\\)、\\(H_0^r\\)、\\(H_0^c\\) 构建检验，我们首先注意到：\n\\(\\sum_{k=1}^{l} \\sum_{j=1}^{n} \\sum_{i=1}^{m} \\frac{(X_{ijk} - \\mu - \\alpha_i - \\beta_j - \\gamma_{ij})^2}{\\sigma^2}\\)\n是一个自由度为 \\(nml\\) 的卡方分布随机变量。因此：\n\\(\\sum_{k=1}^{l} \\sum_{j=1}^{n} \\sum_{i=1}^{m} \\frac{(X_{ijk} - \\hat{\\mu} - \\hat{\\alpha}_i - \\hat{\\beta}_j - \\hat{\\gamma}_{ij})^2}{\\sigma^2}\\)\n也将是卡方分布，但是其自由度将因为每估计一个参数而减少 1。因为 \\(\\sum_{i} \\alpha_i = 0\\)，所以只需要估计 \\(m-1\\) 个 \\(\\alpha_i\\)；同样地，由于 \\(\\sum_{j} \\beta_j = 0\\)，因此只需要估计 \\(n-1\\) 个 \\(\\beta_j\\)。另外，由于 \\(\\sum_{i} \\gamma_{ij} = \\sum_{j} \\gamma_{ij} = 0\\)，我们只需要估计 \\((m-1)(n-1)\\) 个 \\(\\gamma_{ij}\\)。因为还需要估计 \\(\\mu\\)，因此我们总共需要估计的参数个数为：\n\\(n - 1 + m - 1 + (n-1)(m-1) + 1 = nm\\)\n因为：\n\\(\\hat{\\mu} + \\hat{\\alpha}_i + \\hat{\\beta}_j + \\hat{\\gamma}_{ij} = X_{ij\\cdot}\\)\n因此，如果我们令：\n\\(SS_e = \\sum_{k=1}^{l} \\sum_{j=1}^{n} \\sum_{i=1}^{m} (X_{ijk} - X_{ij \\cdot})^2\\)\n则 \\(\\frac{SS_e}{\\sigma^2}\\) 是自由度为 \\(nm(l-1)\\) 的卡方分布。因此：\\(\\frac{SS_e}{nm(l-1)}\\) 是 \\(\\sigma^2\\) 的无偏估计量。\n假设现在我们想要检验行和列之间没有 交互效应 的假设，即检验：\n\\(H_0^{int}: \\gamma_{ij} = 0, \\quad i=1,\\dots,m, \\quad j=1,\\dots,n\\)\n如果 \\(H_0^{int}\\) 为真，则随机变量 \\(X_{ij.}\\) 是均值为 \\(E[X_{ij.}] = \\mu + \\alpha_i + \\beta_j\\) 的正态分布随机变量。\n此外，因为 \\(X_{ij.}\\) 是 \\(l\\) 个方差为 \\(\\sigma^2\\) 的正态分布随机变量的平均值，因此：\n\\(\\text{Var}(X_{ij.}) = \\frac{\\sigma^2}{l}\\)\n因此，如果原假设 \\(H_0^{int}\\) 为真：\n\\(\\sum_{j=1}^{n} \\sum_{i=1}^{m} \\frac{l(X_{ij.} - \\mu - \\alpha_i - \\beta_j)^2}{\\sigma^2}\\)\n是一个自由度为 \\(nm\\) 的卡方分布。因为总共 \\(1 + n - 1 + m - 1 = n + m - 1\\) 个参数 \\(\\mu, \\alpha_i, \\beta_j\\) 必须估计，所以：\n\\(SS_{int} = \\sum_{j=1}^{n} \\sum_{i=1}^{m} l(X_{ij.} - \\hat{\\mu} - \\hat{\\alpha}_i - \\hat{\\beta}_j)^2 = \\sum_{j=1}^{n} \\sum_{i=1}^{m} l(X_{ij.} - X_{i..} - X_{.j.} - X_{...})^2\\)\n所以，在 \\(H_0^{int}\\) 为真的情况下：\n\\(\\frac{SS_{int}}{\\sigma^2}\\)\n是自由度为 \\((n-1)(m-1)\\) 的卡方分布。\n因此，在没有行和列的 交互效应 的假设下：\n\\(\\frac{SS_{int}}{(n-1)(m-1)}\\)\n是 \\(\\sigma^2\\) 的无偏估计量。\n可以证明，在没有 交互效应 的假设下，\\(SS_e\\) 和 \\(SS_{int}\\) 是相互独立的，故当 \\(H_0^{int}\\) 为真时，\n\\(F_{int} = \\frac{SS_{int}/[(n-1)(m-1)]}{SS_e/[nm(l-1)]}\\)\n是分子自由度为 \\((n-1)(m-1)\\)、分母自由度为 \\(nm(l-1)\\) 的 \\(F-\\text{分布}\\) 随机变量。在显著性水平为 \\(\\alpha\\) 下，原假设 \\(H_0^{int} : 所有 \\gamma_{ij} = 0\\) 的检验为：\n\\(\\begin{align} \\text{拒绝} \\quad & H_0^{int} \\quad \\text{如果} \\ \\frac{SS_{int}/[(n-1)(m-1)]}{SS_e/[nm(l-1)]} &gt; F_{\\alpha, (n-1)(m-1), nm(l-1)} \\\\ \\text{不拒绝} \\quad & H_0^{int} \\quad \\text{否则} \\end{align}\\)\n或者，我们可以计算 \\(p-\\text{value}\\)。如果 \\(F_{int} = v\\)，那么检验所有交互项等于 0 的原假设的 \\(p-\\text{value}\\) 是：\n\\(p-\\text{value} = P\\{F_{(n-1)(m-1), nm(l-1)} &gt; v\\}\\)\n当 \\(H_0^r\\) 为真时，\\(X_{i..}\\) 是 \\(nl\\) 个正态分布随机变量的均值，每个随机变量均值为 \\(\\mu\\)、方差为 \\(\\sigma^2\\)。因此，在 \\(H_0^r\\) 为真时：\n\\(E[X_{i..}] = \\mu, \\quad \\text{Var}(X_{i..}) = \\frac{\\sigma^2}{nl}\\)\n因此，\\(\\sum_{i=1}^{m} \\frac{nl(X_{i..} - \\mu)^2}{\\sigma^2}\\) 是自由度为 \\(m\\) 的卡方分布。因此，如果我们令：\n\\(SS_r = \\sum_{i=1}^{m} nl(X_{i..} - \\hat{\\mu})^2 = \\sum_{i=1}^{m} nl(X_{i..} - X_{...})^2\\)\n则当 \\(H_0^r\\) 为真时，\\(\\frac{SS_r}{\\sigma^2}\\) 是自由度为 \\(m-1\\) 的卡方分布。因此：\\(\\frac{SS_r}{m-1}\\) 是当 \\(H_0^r\\) 为真时，\\(\\sigma^2\\) 的无偏估计量。\n可以证明，在 \\(H_0^r\\) 为真时，\\(SS_e\\)、\\(SS_r\\) 是独立的，故当 \\(H_0^r\\) 为真时：\n\\(\\frac{SS_r/(m-1)}{SS_e/[nm(l-1)]}\\)\n是一个 \\(F_{m-1, nm(l-1)}\\) 分布随机变量。\n因此，在显著性水平为 \\(\\alpha\\) 时，\n\\(H_0^r : 所有 \\alpha_i = 0 \\quad vs \\quad H_1^r : 至少一个 \\alpha_i \\neq 0\\)\n的检验为：\n\\(\\begin{align} \\text{拒绝} \\quad & H_0^r \\quad \\text{如果} \\quad \\frac{SS_r/(m-1)}{SS_e/[nm(l-1)]} &gt; F_{\\alpha, m-1, nm(l-1)} \\\\ \\text{不拒绝} \\quad & H_0^r \\quad \\text{否则} \\end{align}\\)\n如果令：\\(\\frac{SS_r/(m-1)}{SS_e/[nm(l-1)]} = v\\)，则 \\(p-\\text{value}\\) 为：\n\\(p\\text{-value} = P\\{F_{m-1, nm(l-1)} &gt; v\\}\\)\n同理，也可以得到 \\(H_0 : \\beta_j = 0\\) 的检验结果。表 10.4 对本节的 方差分析（ANOVA）相关信息进行了总结。\n\n\n\n表 10.4: 对于 \\(m\\) 行 \\(n\\) 列的每个 \\(X_{ij}\\) 都有 \\(l\\) 个观察数据时的双因素方差分析，其中 \\(N=nm(l-1)\\)\n\n\n\n\n\n\n\n\n\n\n\n\n\n类型\n自由度\n平方和\n\\(F-\\text{统计量}\\)\n显著性水平 \\(\\alpha\\) 下的检验\n\\(F = v\\) 时的 \\(p-\\text{value}\\)\n\n\n\n\n行效应\n\\(m - 1\\)\n\\(SS_r = ln \\sum_{i=1}^{m} (X_{i..} - X_{...})^2\\)\n\\(F_r = \\frac{SS_r/(m-1)}{SS_e/N}\\)\n拒绝 \\(H_0^r\\) 如果 \\(F_r &gt; F_{\\alpha, m-1, N}\\)\n\\(P\\{F_{m-1, N} &gt; v\\}\\)\n\n\n列效应\n\\(n - 1\\)\n\\(SS_c = lm \\sum_{j=1}^{n} (X_{.j.} - X_{...})^2\\)\n\\(F_c = \\frac{SS_c/(n-1)}{SS_e/N}\\)\n拒绝 \\(H_0^c\\) 如果 \\(F_c &gt; F_{\\alpha, n-1, N}\\)\n\\(P\\{F_{n-1, N} &gt; v\\}\\)\n\n\n交互效应\n\\((n - 1)(m - 1)\\)\n\\(\\begin{align} &SS_{int} = l \\sum_{j=1}^{n} \\\\ & \\times \\sum_{i=1}^{m} (X_{ij.} - X_{i..} - X_{.j.} + X_{...})^2 \\end{align}\\)\n\\(F_{int} = \\frac{SS_{int}/[(n-1)(m-1)]}{SS_e/N}\\)\n拒绝 \\(H_0^{int}\\) 如果 \\(F_{int} &gt; F_{\\alpha, (n-1)(m-1), N}\\)\n\\(P\\{F_{(n-1)(m-1), N} &gt; v\\}\\)\n\n\n误差\n\\(N\\)\n\\(\\begin{align} & SS_e = \\sum_{k=1}^{l} \\sum_{j=1}^{n} \\\\ & \\times \\sum_{i=1}^{m} (X_{ijk} - X_{ij.})^2 \\end{align}\\)\n\n\n\n\n\n\n\n\n\n注意，对于前面介绍的所有的检验而言，只有在相关的 \\(F-\\text{统计量}\\) 较大时，我们才会拒绝原假设。因为当 \\(H_0\\) 不成立时，\\(F-\\text{统计量}\\) 的分子的分布往往会变大；而不论 \\(H_0\\) 是否成立，\\(F-\\text{统计量}\\) 的分母的分布都是相同的。所以只有较大的（而不是较小的）\\(F-\\text{统计量}\\) 的值才会让我们拒绝原假设。\n\n习题 10.4 我们认为，某种特定类型的发电机的寿命会受到所使用的材料以及所使用场所的温度的影响。下表显示了由三种不同材料制造的发电机在两种不同温度下使用时的 24 台发电机的寿命数据。该数据是否可以表明，发电机的材料和工作场所的温度确实会影响发电机的寿命？是否有证据可以表明材料和工作场所的温度对发电机的寿命存在交互效应？\n\n\n\n材料\n10°C\n18°C\n\n\n\n\n1\n135, 150  176, 85\n50, 55  64, 38\n\n\n2\n150, 162  171, 120\n76, 88  91, 57\n\n\n3\n138, 111  140, 106\n68, 60  74, 51\n\n\n\n\n\n解 10.4. 计算得出用于检验材料和温度之间没有交互效应的 \\(F-\\text{统计量}\\) 的值为 0.64525，其 \\(p-\\text{value}\\) 为：\n\\(p-\\text{value} = P(F_{2,18} &gt; 0.64525) &gt; 1 - pf(0.64525, 2, 18)\\)\n\n\n代码\n1 - pf(0.64525, 2, 18)\n\n\n[1] 0.5362424\n\n\n因此，我们无法拒绝材料和温度之间没有交互效应的原假设。\n计算得出用于检验发电机寿命不依赖于所使用材料（即没有行效应）的 \\(F-\\text{统计量}\\) 值为 2.47976，其 \\(p-\\text{value}\\) 为：\n\\(p-\\text{value} = P(F_{2,18} &gt; 2.47976) &gt; 1 - pf(2.47976, 2, 18)\\)\n\n\n代码\n1 - pf(2.47976, 2, 18)\n\n\n[1] 0.111889\n\n\n因此，在 10% 的显著性水平下，我们无法拒绝发电机寿命不依赖于所使用材料的原假设。\n计算表明，用于检验发电机寿命不依赖于温度（即没有列效应）的 \\(F-\\text{统计量}\\) 值为 69.63223，其 \\(p-\\text{value}\\) 为：\n\\(p\\text{-value} = P(F_{1,18} &gt; 69.63223) = 1 - pf(69.63223, 1, 18)\\)\n\n\n代码\n1 - pf(69.63223, 1, 18)\n\n\n[1] 1.337273e-07\n\n\n因此，我们应该拒绝发电机寿命不依赖于温度的原假设。\\(\\blacksquare\\)",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>方差分析</span>"
    ]
  },
  {
    "objectID": "chapter_10/10.html#problems",
    "href": "chapter_10/10.html#problems",
    "title": "10  方差分析",
    "section": "Problems",
    "text": "Problems",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>方差分析</span>"
    ]
  },
  {
    "objectID": "chapter_11/11.html",
    "href": "chapter_11/11.html",
    "title": "11  拟合优度检验和分类数据分析",
    "section": "",
    "text": "11.1 引言\n我们通常需要确定某个特定的 概率模型（probabilistic model）是否适用于某个随机事件，例如我们希望能够确定是否可以用泊松分布来描述某时间段内到达商店的顾客数？我们通常通过检验给定的随机样本是否来自某个指定的概率分布来简化判断。例如，我们可能 先验（priori）地认为某工厂每天发生的工业事故数量应当是来自泊松分布的随机样本。我们可以通过观察一段时间内发生的事故数量，并用观察到的数据来检验每天发生的工业事故数服从泊松分布的假设是否合理。这种用于判断某随机事件是否满足某特定的概率模型的统计检验称之为：拟合优度检验（goodness of fit test）。\n用于检验拟合优度检验的零假设——即某个样本服从某个特定的概率分布——的经典方法是：将随机变量的可能取值划分为有限的多个区域。然后确定落入每个区域的样本值的数量，并与指定概率分布下的理论数量进行比较，当这两个数据之间的差异显著时，我们将拒绝零假设，即该样本不服从我们所假设的分布。详细的检验过程将在 小节 11.2 中介绍，并且我们会假设零假设中的概率分布是完全指定的。在 小节 11.3 中，我们将介绍当零假设中的概率分布的某些参数并未指定时的分析方法，例如，零假设可能是样本分布为正态分布，但却未指定该分布的均值和方差。在 小节 11.4 和 小节 11.3 中，我们讨论了根据两种不同的特征对总体中的每个个体进行分类的情况，并展示了如何使用前述的分析方法来检验随机选择的个体的特征是否独立。我们还将演示如何检验 \\(m\\) 个总体都具有相同的离散概率分布的假设。最后，在 小节 11.6 中，我们将再次回到检验样本数据来自某个特定的概率分布的问题，只是我们会假设该特定分布是连续的。我们没有采用对数据离散化然后使用 小节 11.2 中的检验方法，而是会使用 Kolmogorov–Smirnov检验 直接进行检验。",
    "crumbs": [
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>拟合优度检验和分类数据分析</span>"
    ]
  },
  {
    "objectID": "chapter_11/11.html#sec-11_2",
    "href": "chapter_11/11.html#sec-11_2",
    "title": "11  拟合优度检验和分类数据分析",
    "section": "11.2 概率模型的所有参数都指定时的拟合优度检验",
    "text": "11.2 概率模型的所有参数都指定时的拟合优度检验\n假设有 \\(n\\) 个独立的随机变量 \\(Y_1, Y_2, \\dots, Y_n\\)，其中每个变量的取值为 \\(1, 2, \\dots, k\\)，我们希望检验如下的零假设：\\(Y_j\\) 的概率质量函数为 \\(\\{ p_i, i = 1, \\dots, k \\}\\)。也就是说，如果用 \\(Y\\) 表示任意一个 \\(Y_j\\)，那么零假设为：\n\\(H_0: P\\{Y = i\\} = p_i, \\quad i = 1, \\dots, k\\)\n备择假设为：\n\\(H_1: P\\{Y = i\\} \\neq p_i, \\quad \\text{对于某些} i = 1, \\dots, k\\)\n为了检验上述假设，令 \\(X_i\\)（\\(i = 1, \\dots, k\\)）表示 \\(Y_j\\) 等于 \\(i\\) 的数量。由于每个 \\(Y_j\\) 都独立地以概率 \\(P\\{Y = i\\}\\) 等于 \\(i\\)，那么原假设 \\(H_0\\) 为真时，\\(X_i\\) 服从参数为 \\(n\\) 和 \\(p_i\\) 的二项分布。因此，当原假设 \\(H_0\\) 为真时，\n\\(E[X_i] = np_i\\)\n因此，可以用 \\((X_i - np_i)^2\\) 来判断 \\(p_i\\) 是否确实等于 \\(P\\{Y = i\\}\\)。当 \\((X_i - np_i)^2\\) 比较大时，则表明 \\(H_0\\) 可能不成立。实际上，这种推理让我们考虑以下检验统计量：\n\\[\nT = \\sum_{i=1}^k \\frac{(X_i - np_i)^2}{np_i}\n\\tag{11.1}\\]\n并且，当 \\(T\\) 较大时，我们将拒绝零假设。\n为了确定临界区，首先需要指定显著性水平 \\(\\alpha\\)，然后确定满足下式的临界值 \\(c\\)：\n\\(P_{H_0}\\{T \\geq c\\} = \\alpha\\)\n也就是说，我们需要确定 \\(c\\)，使得当 \\(H_0\\) 为真时，统计量 \\(T\\) 大于等于 \\(c\\) 的概率为 \\(\\alpha\\)。在显著性水平 \\(\\alpha\\) 下，当 \\(T \\geq c\\) 时，则需要拒绝原假设 \\(H_0\\)，否则就接受原假设。\n接下来我们需要确定 \\(c\\) 的值。确定 \\(c\\) 的经典的方法是使用如下的结论：当 \\(n\\) 较大时，在 \\(H_0\\) 为真时，\\(T\\) 近似服从自由度为 \\(k - 1\\) 的卡方分布（当 \\(n \\rightarrow \\infty\\) 时，\\(T\\) 服从自由度为 \\(k-1\\) 的卡方分布）。因此，当 \\(n\\) 较大时，\\(c\\) 的取值可以是 \\(\\chi^2_{\\alpha, k-1}\\)，因此在显著性水平为 \\(\\alpha\\) 时的近似检验为：\n\\(\\begin{align} \\text{拒绝} \\quad &H_0 \\quad \\text{如果} T \\geq \\chi^2_{\\alpha, k-1} \\\\ \\text{接受} \\quad &H_0 \\quad \\text{否则} \\end{align}\\)\n如果观察到的统计量 \\(T\\) 的值为 \\(t\\)，那么上述检验等价于在 \\(\\alpha\\) 值大于或等于如下的 \\(p-\\text{value}\\) 时拒绝 \\(H_0\\)：\n\\(p-\\text{value} = P_{H_0}\\{T \\geq t\\} \\approx P\\{\\chi^2_{k-1} \\geq t\\}\\)\n其中 \\(\\chi^2_{k-1}\\) 是自由度为 \\(k - 1\\) 的卡方分布随机变量。\n经验规则指出，对于 \\(n\\) 来说，\\(n\\) 需要足够大才能使得如上的检验是一个比较好的近似检验，一般而言，对于每个 \\(i, i = 1,..., k\\)，需要满足 \\(np_i \\geq 1\\)，并且至少 80% 的 \\(np_i\\) 值应大于 5。\n\n\n\n\n\n\n备注\n\n\n\n\n\n可以展开 式 11.1 中的平方项并根据 \\(\\sum p_i = 1\\) 和 \\(\\sum X_i = n\\) 来更简单的计算 \\(T\\)（为什么可以这样计算？）：\n\n\n\\[\n\\begin{align}\nT &= \\sum_{i=1}^k \\frac{X_i^2 - 2np_i X_i + n^2 p_i^2}{np_i} \\\\\n&= \\sum_i \\frac{X_i^2}{np_i} - 2 \\sum_i X_i + n \\sum_i p_i \\\\\n&= \\sum_i \\frac{X_i^2}{np_i} - n\n\\end{align}\n\\tag{11.2}\\]\n\n\n直观上而言，依赖于 \\(X_1, \\dots, X_k\\) 值的检验统计量 \\(T\\) 只有 \\(k - 1\\) 个自由度的原因是：有一个自由度因为线性关系 \\(\\sum_i X_i = n\\) 而丢失了。\n\n\n虽然证明 \\(T\\) 渐近地服从卡方分布非常复杂，但当 \\(k = 2\\) 时，可以很轻松的证明 \\(T\\) 服从卡方分布。当 \\(k = 2\\) 时，由于 \\(X_1 + X_2 = n\\)，且 \\(p_1 + p_2 = 1\\)，有：\n\n\n\\[\n\\begin{align}\nT &= \\frac{(X_1 - np_1)^2}{np_1} + \\frac{(X_2 - np_2)^2}{np_2} \\\\\n&= \\frac{(X_1 - np_1)^2}{np_1} + \\frac{(n - X_1 - n[1 - p_1])^2}{n(1 - p_1)} \\\\\n&= \\frac{(X_1 - np_1)^2}{np_1} + \\frac{(X_1 - np_1)^2}{n(1 - p_1)} \\\\\n&= \\frac{(X_1 - np_1)^2}{np_1(1 - p_1)} \\quad \\because \\frac{1}{p} + \\frac{1}{1 - p} = \\frac{1}{p(1 - p)}\n\\end{align}\n\\]\n因为 \\(X_1\\) 是一个二项分布随机变量，其均值为 \\(np_1\\)，方差为 \\(np_1(1 - p_1)\\)，因此，根据二项分布的正态近似性，可以得出：当 \\(n\\) 比较大时，\\(\\frac{(X_1 - np_1)}{\\sqrt{np_1(1 - p_1)}}\\) 近似服从标准正态分布，因此 \\(\\frac{(X_1 - np_1)^2}{np_1(1 - p_1)}\\) 近似服从自由度为 1 的卡方分布。\n\n\n\n习题 11.1 近年来，心理健康与身体健康之间的相关性逐渐得到人们的认可。可以使用名人的生日和去世日期之间的数据分析来进一步的研究这种相关性。为了使用这些数据，我们假设：人们对某件事情的盼望能够改善一个人的心理状态。因为生日会带来更多的关注、关爱，因此一位名人可能会对他/她的生日充满期待。如果这位名人身体不好并且濒临死亡，那么对生日的期待可能会“令他振奋，从而改善他的健康状态，并降低他在生日之前去世的概率。” 数据可能显示：名人在他/她的生日前几个月去世的可能性较小，而在生日之后的几个月去世的可能性较大。\n\n\n解 11.1. 为了验证如上的假设，从《Who Was Who in America》一书中随机选取了 1251 名已故美国名人，书中记录了这些名人的出生日期和去世日期。样本数据取自 D. Phillips 的 Death Day and Birthday: An Unexpected Connection，具体的数据如 表 11.1 所示1。\n\n\n\n表 11.1: 在生日的前后几个月中死亡数量的分布图，\\(n=1251\\)，\\(n / 12 = 104.25\\)\n\n\n\n\n\n生日前后的月数\n死亡数\n\n\n\n\n6 Months Before\n90\n\n\n5 Months Before\n100\n\n\n4 Months Before\n87\n\n\n3 Months Before\n96\n\n\n2 Months Before\n101\n\n\n1 Month Before\n86\n\n\nThe Month\n119\n\n\n1 Month After\n118\n\n\n2 Months After\n121\n\n\n3 Months After\n114\n\n\n4 Months After\n113\n\n\n5 Months After\n106\n\n\n\n\n\n\n如果去世日期与生日无关，那么这 1251 个人的去世日期在 12 个类别（categories）中的每个类别的可能性都是相同的。因此，我们可以检验以下的零假设：\n\\(H_0: p_i = \\frac{1}{12}, \\quad i = 1, \\dots, 12\\)\n由于 \\(np_i = 1251/12 = 104.25\\)，该假设的卡方检验统计量为：\n\\(T = \\frac{(90)^2 + (100)^2 + (87)^2 + \\dots + (106)^2}{104.25} - 1251 = 17.192\\)\n\\(p-\\text{value}\\) 为：\n\\(p-\\text{value} \\approx P(\\chi_{11}^2 \\geq 17.192) = 1 - \\text{pchisq}(17.192, 11) = 0.1023232\\)\n检验的结果让我们对即将到来的生日是否对人的余生有影响的假设存在一些质疑。尽管这些数据不足以在 10% 的显著性水平下拒绝该假设，但它们确实表明了原假设可能是错误的。于是我们有了一个新的问题：在分析中，我们是否应该有多达 12 个数据类别，是否允许通过更少的可能类别来获得更强的检验？例如，假设我们将数据分为 4 个可能的类别：\n\n类别 1: \\(-6, -5, -4\\)\n类别 2: \\(-3, -2, -1\\)\n类别 3: \\(0, 1, 2\\)\n类别 4: \\(3, 4, 5\\)\n\n也就是说，如果某人的去世日期发生在其生日前三个月内，则将其归为 类别 2。根据这种分类，我们得到如下的数据：\n\n\n\n\n死亡人数\n\n\n\n\n1\n277\n\n\n2\n283\n\n\n3\n358\n\n\n4\n333\n\n\n\n于是：\\(n = 1251\\)，\\(\\quad n/4 = 312.75\\)。\n\\(H_0: p_i = \\frac{1}{4}, \\quad i = 1, 2, 3, 4\\) 的检验统计量为：\n\\(T = \\frac{(277)^2 + (283)^2 + (358)^2 + (333)^2}{312.75} - 1251 = 14.775\\)\n因此，由于 \\(\\chi_{01,3}^2 = 11.345\\)，所以即使在 1% 的显著性水平下，我们也会拒绝原假设。使用 R 计算得到的 \\(p-\\text{value}\\) 为：\n\\(p-\\text{value} = P\\{\\chi_3^2 \\geq 14.775\\} = 1 - \\text{pchisq}(14.775, 3) = 0.00201938\\)\n然而，如上的原假设是在观察到数据后提出的，因此上述分析可能会受到批评。确实，虽然使用一组数据来确定原假设的“正确表达方式”没有错，但再次利用这些相同的数据来检验该假设的做法是值得怀疑的。因此，要确保得出可靠的结论，按照上述的数据处理方式选择第二个随机样本似乎是必须的，并且需要在新的样本上再次检验 \\(H_0: p_i = \\frac{1}{4}, \\quad i = 1, 2, 3, 4\\)（参见 习题 3）。\\(\\blacksquare\\)\n\n可以使用 R 计算检验统计量和 \\(p-\\text{value}\\)。假设 \\(x = c(x_1,...,x_k)\\) 是 \\(k\\) 个不同的类别上的对应样本数量，并且我们希望检验原假设 \\(H_0: P\\{i = k\\} = p_i\\)。可以使用如下的 R 代码：\nx &lt;- c(x1,...xk)\nchisq.test(x, p=c(p1,...pk))\n例如，对于 习题 11.1 而言，\n\nx &lt;- c(277, 283, 358, 333)\np &lt;- c(1/4, 1/4, 1/4, 1/4)\nchisq.test(x, p=p)\n\n\n    Chi-squared test for given probabilities\n\ndata:  x\nX-squared = 14.775, df = 3, p-value = 0.00202\n\n\n\n习题 11.2 某荧光灯制造商对一位购货量非常大的顾客说：他们生产的这些灯泡的质量并不统一，而是按照某种方式生产的。具体而言，他们生产的每个灯泡的质量划分为 A、B、C、D、E 这 5 个等级，并且不同质量等级的灯泡的生产是独立的，同时不同等级对应的概率分别为 0.15、0.25、0.35、0.20 和 0.05。然而，该顾客认为他收到的 E 型（最低质量）灯泡太多，因此他决定花费时间和成本来确定 30 个灯泡的质量，以此来检验制造商的说法。假设他发现这 30 个灯泡中，3 个是 A 等级，6 个是 B 等级，9 个是 C 等级，7 个是 D 等级，5 个是 E 等级。那么，根据这些数据，在 5% 的显著性水平下，该顾客是否能拒绝制造商的说法？\n\n\n解 11.2. \n\nx &lt;- c(3, 6, 9, 7, 5)\np &lt;- c(0.15, 0.25, 0.35, 0.20, 0.05)\nchisq.test(x, p=p)\n\nWarning in chisq.test(x, p = p): Chi-squared approximation may be incorrect\n\n\n\n    Chi-squared test for given probabilities\n\ndata:  x\nX-squared = 9.3476, df = 4, p-value = 0.05297\n\n\n注意，由于每个类别中的样本量相对较小，所以 R 给出了如下警告：卡方分布对检验统计量分布的近似可能不完全准确。假设结果的准确性没有问题，则在 5% 的显著性水平下，我们不会拒绝原假设。但由于在所有高于 0.053 的显著性水平下，我们都将拒绝原假设，因此该顾客应对制造商的说法保持怀疑态度。\\(\\blacksquare\\)\n\n\n11.2.1 通过模拟确定临界区域 \\(^*\\)",
    "crumbs": [
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>拟合优度检验和分类数据分析</span>"
    ]
  },
  {
    "objectID": "chapter_11/11.html#sec-11_3",
    "href": "chapter_11/11.html#sec-11_3",
    "title": "11  拟合优度检验和分类数据分析",
    "section": "11.3 概率模型的参数未指定时的拟合优度检验",
    "text": "11.3 概率模型的参数未指定时的拟合优度检验\n对于概率模型 \\(\\{p_i, i = 1, \\dots, k\\}\\) 而言，如果并非所有的参数都是已知的，此时我们依然可以对 原假设（null hypothesis）进行拟合优度检验。例如，对于我们在 小节 11.1 中介绍的某工厂每天事故数量的场景，现在，我们想检验该工厂每天发生的事故次数是否服参数为 \\(\\lambda\\) 的泊松分布，其中 \\(\\lambda\\) 是未知的。为了检验该假设，假设该工厂把 \\(n\\) 天内每天发生的事故次数都记录了下来，并记作 \\(Y_1, \\dots, Y_n\\)。\n要分析这些数据，我们必须首先处理这样一个问题，即 \\(Y_i\\) 可以有无穷多个可能的值。不过，我们可以把 \\(Y_i\\) 的无限种可能的取值划分为 \\(k\\) 个有限数量的区间，然后用 \\(Y_i\\) 落入的区域来解决该问题。例如，如果某天发生的事故数量为 0，则该天处于 区间 1；如果发生 1 次事故，则处于 区间 2；如果发生 2 次或 3 次事故，则处于 区间 3；如果发生 4 次或 5 次事故，则处于 区间 4；如果发生 5 次以上事故，则处于 区间 5。因此，如果该工厂每天发生的事故次数确实服从均值为 \\(\\lambda\\) 的泊松分布，那么：\n\\[\n\\begin{align}\np_1 &= P\\{Y = 0\\} = e^{-\\lambda} \\\\\np_2 &= P\\{Y = 1\\} = \\lambda e^{-\\lambda} \\\\\np_3 &= P\\{Y = 2\\} + P\\{Y = 3\\} = \\frac{e^{-\\lambda} \\lambda^2}{2} + \\frac{e^{-\\lambda} \\lambda^3}{6} \\\\\np_4 &= P\\{Y = 4\\} + P\\{Y = 5\\} = \\frac{e^{-\\lambda} \\lambda^4}{24} + \\frac{e^{-\\lambda} \\lambda^5}{120} \\\\\np_5 &= P\\{Y &gt; 5\\} = 1 - e^{-\\lambda} - \\lambda e^{-\\lambda} - \\frac{e^{-\\lambda} \\lambda^2}{2} - \\frac{e^{-\\lambda} \\lambda^3}{6} - \\frac{e^{-\\lambda} \\lambda^4}{24} - \\frac{e^{-\\lambda} \\lambda^5}{120}\n\\end{align}\n\\tag{11.3}\\]\n在进行拟合优度检验时，我们面临的第二个难题是：均值 \\(\\lambda\\) 的值是未知的。显然，最直接的做法是假设 \\(H_0\\) 为真，然后从数据中估计 \\(\\lambda\\)——并用 \\(\\hat{\\lambda}\\) 作为 \\(\\lambda\\) 的估计值——然后用估计量 \\(\\hat{\\lambda}\\) 来计算统计量：\n\\(T = \\sum_{i=1}^{k} \\frac{(X_i - n\\hat{p_i})^2}{n\\hat{p_i}}\\)\n其中，\\(X_i\\) 是落在区间 \\(i\\)（\\(i = 1, \\dots, k\\) ）的 \\(Y_j\\) 数量，\\(\\hat{p_i}\\) 是 \\(Y_j\\) 落在区间 \\(i\\) 的估计概率，用 \\(\\lambda\\) 的估计量来替代 \\(\\hat{\\lambda}\\) 并代入 式 11.3 来计算 \\(\\hat{p_i}\\)。\n通常，如果原假设中含有计算概率 \\(\\{p_i, i = 1, \\dots, k\\}\\) 所必需的未知参数时，我们可以使用如上的方法。假设有 \\(m\\) 个未知参数，并且可以用最大似然法（maximum likelihood）对其进行估计。可以证明，当 \\(n\\) 足够大时，在 \\(H_0\\) 为真时，统计量 \\(T\\) 近似服从自由度为 \\(k - 1 - m\\) 的卡方分布。换句话说，自由度会随每个需要估计的参数而减一。因此，检验为：\n\\(\\begin{align} \\text{拒绝} \\quad &H_0 \\quad \\text{如果} \\quad T \\geq \\chi_{\\alpha, k-1-m}^2 \\\\ \\text{接受} \\quad &H_0 \\quad \\text{否则} \\end{align}\\)\n另一种等价的检验方法是首先确定统计量 \\(T\\) 的值，记作 \\(T = t\\)，然后计算\n\\(p-\\text{value} \\approx P\\left\\{\\chi^2_{k-1-m} \\geq t\\right\\}\\)\n如果 \\(\\alpha \\geq p-\\text{value}\\)，则拒绝原假设。\n\n习题 11.3 假设在过去的 30 周内，每周的事故数量如下所示：\n\\[\n\\begin{array}{ccccccccccccc}\n8 & 0 & 0 & 1 & 3 & 4 & 0 & 2 & 12 & 5 \\\\\n1 & 8 & 0 & 2 & 0 & 1 & 9 & 3 & 4 & 5 \\\\\n3 & 3 & 4 & 7 & 4 & 0 & 1 & 2 & 1 & 2\n\\end{array}\n\\]\n检验原假设：每周的事故数量服从泊松分布。\n\n\n解 11.3. 由于 30 周内的事故总数为 95，泊松分布均值的最大似然估计值为：\n\\(\\hat{\\lambda} = \\frac{95}{30} = 3.16667\\)\n因此，\\(P\\{Y = i\\}\\) 的估计值为：\n\\(P\\{Y = i\\} \\stackrel{est}{=} \\frac{e^{-\\hat{\\lambda}} \\hat{\\lambda}^i}{i!}\\)\n通过计算，我们得到：\n\\(\\begin{align} \\hat{p_1} &= 0.04214 \\\\ \\hat{p_2} &= 0.13346 \\\\ \\hat{p_3} &= 0.43434 \\\\ \\hat{p_4} &= 0.28841 \\\\ \\hat{p_5} &= 0.10164 \\end{align}\\)\n使用数据值 \\(X_1 = 6, X_2 = 5, X_3 = 8, X_4 = 6, X_5 = 5\\)，我们可以使用 R 来计算检验统计量：\n\\(T = \\sum_{i=1}^5 \\frac{(X_i - 30\\hat{p_i})^2}{30\\hat{p_i}}\\)\n然后计算 \\(p-\\text{value}\\)：\n\nx &lt;- c(6, 5, 8, 6, 5)\np &lt;- c(.04214, .13346, .43434, .28841, .10164)\ny &lt;- (x - 30 * p)^2\ns &lt;- y / (30 * p)\nT = sum(s)\nT\n\n[1] 21.99156\n\np_value &lt;- 1 - pchisq(T, 3)\np_value\n\n[1] 6.549552e-05\n\n\n因此，我们将拒绝工厂每周发生的事故数量服从泊松分布的假设。显然，有太多周事故数量为 0，因此不能假设事故数量服从均值为 3.167 的泊松分布。\\(\\blacksquare\\)",
    "crumbs": [
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>拟合优度检验和分类数据分析</span>"
    ]
  },
  {
    "objectID": "chapter_11/11.html#sec-11_4",
    "href": "chapter_11/11.html#sec-11_4",
    "title": "11  拟合优度检验和分类数据分析",
    "section": "11.4 列联表的独立性检验",
    "text": "11.4 列联表的独立性检验\n在本节中，我们将考虑这样的问题：总体中的每个成员都可以根据两个不同的特征（characteristics）进行分类——我们将这些特征分别记作 \\(X-\\text{特征}\\) 和 \\(Y-\\text{特征}\\)。假设 \\(X-\\text{特征}\\) 有 \\(r\\) 个可能的取值，\\(Y-\\text{特征}\\) 有 \\(s\\) 个可能的取值。对于 \\(i = 1, \\dots, r\\)，\\(j = 1, \\dots, s\\)，定义\n\\(P_{ij} = P\\{X = i, Y = j\\}\\)\n也就是说，\\(P_{ij}\\) 表示随机选择的一个总体成员具有 \\(X-\\text{特征}\\) \\(i\\) 和 \\(Y-\\text{特征}\\) \\(j\\) 的概率。假设总体中的不同成员之间是独立的，令\n\\(p_i = P\\{X = i\\} = \\sum_{j=1}^{s} P_{ij}, \\quad i = 1, \\dots, r\\)\n\\(q_j = P\\{Y = j\\} = \\sum_{i=1}^{r} P_{ij}, \\quad j = 1, \\dots, s\\)\n也就是说，\\(p_i\\) 是某个总体成员具有 \\(X-\\text{特征}\\) \\(i\\) 的概率，\\(q_j\\) 是其具有 \\(Y-\\text{特征}\\) \\(j\\) 的概率。\n我们希望检验这样的一个假设：总体成员的 \\(X-\\text{特征}\\) 和 \\(Y-\\text{特征}\\) 是相互独立的。即，我们希望检验\n\\[\n\\begin{align}\nH_0: & P_{ij} = p_i q_j, \\quad \\forall \\, i = 1, \\dots, r; j = 1, \\dots, s \\\\\n\\qquad & vs \\\\\nH_1: & P_{ij} \\neq p_i q_j, \\quad \\exists i, j \\quad i = 1, \\dots, r; j = 1, \\dots, s\n\\end{align}\n\\]\n假设我们从总体中抽取了 \\(n\\) 个样本，其中有 \\(N_{ij}\\) 个样本同时具有 \\(X-\\text{特征}\\) \\(i\\) 和 \\(Y-\\text{特征}\\) \\(j\\)，\\(i = 1, \\dots, r; j = 1, \\dots, s\\)。\n由于原假设中未指定的 \\(p_i\\) 和 \\(q_j\\)，我们必须估计他们，因为\n\\(N_i = \\sum_{j=1}^{s} N_{ij}, \\quad i = 1, \\dots, r\\)\n表示样本中具有 \\(X-\\text{特征}\\) \\(i\\) 的样本数量，\\(p_i\\) 的估计值（事实上是最大似然估计值）为\n\\(\\hat{p_i} = \\frac{N_i}{n}, \\quad i = 1, \\dots, r\\)\n同样地，令\n\\(M_j = \\sum_{i=1}^{r} N_{ij}, \\quad j = 1, \\dots, s\\)\n表示样本中具有 \\(Y-\\text{特征}\\) \\(j\\) 的样本数量，则 \\(q_j\\) 的估计值为\n\\(\\hat{q_j} = \\frac{M_j}{n}, \\quad j = 1, \\dots, s\\)\n乍一看，我们似乎需要使用数据来估计 \\(r + s\\) 个参数。然而，由于 \\(p_i\\) 的和与 \\(q_j\\) 的和都必须为 1，也就是说，\\(\\sum_{i=1}^{r} p_i = \\sum_{j=1}^{s} q_j = 1\\)。所以，我们实际上只需要估计 \\(r-1\\) 个 \\(p_i\\) 和 \\(s-1\\) 个 \\(q_j\\)。例如，如果 \\(r = 2\\)，因为 \\(p_2 = 1 - p_1\\)，所以一旦估计了 \\(p_1\\)，就可以自动推导出 \\(p_2\\)。因此，我们实际上需要估计 \\(r - 1 + s - 1 = r + s - 2\\) 个参数，由于每个总体成员都有 \\(k = rs\\) 个不同的可能取值，在 \\(n\\) 较大的情况下，检验统计量将近似服从自由度为 \\(rs - 1 - (r + s - 2) = (r-1)(s-1)\\) 的卡方分布。\n所以，当 \\(H_0\\) 为真时，\n\\(E[N_{ij}] = nP_{ij} = np_iq_j\\)\n因此，检验统计量 \\(T\\) 的定义为\n\\(T = \\sum_{j=1}^{s} \\sum_{i=1}^{r} \\frac{(N_{ij} - n \\hat{p_i} \\hat{q_j})^2}{n \\hat{p_i} \\hat{q_j}} = \\sum_{j=1}^{s} \\sum_{i=1}^{r} \\frac{N_{ij}^2}{n \\hat{p_i} \\hat{q_j}} - n\\)\n如果检验统计量的值为 \\(T = t\\)，则相应的 \\(p-\\text{value}\\)：\n\\(\\begin{align} p-\\text{value} &= P_{H_0}(T \\geq t) \\\\ &\\approx P\\{\\chi^2_{(r-1)(s-1)} \\gt t\\} \\\\ &= 1 - \\text{pchisq}(t, (r-1)(s-1)) \\end{align}\\)\n\n习题 11.4 我们随机选取了 300 个人作为样本，并对其按照性别和政治派别（民主党人、共和党人、无党派人士）进行分类。如下的列联表展示了所得到的数据。\n\n\n\n\\(i\\)/\\(j\\)\n民主党人\n共和党人\n无党派人士\n总计\n\n\n\n\n女性\n68\n56\n32\n156\n\n\n男性\n52\n72\n20\n144\n\n\n总计\n120\n128\n52\n300\n\n\n\n例如，列联表表明，在 300 人的样本中，有 68 名女性是民主党，56 名女性是共和党，32 名女性是无党派人士；即 \\(N_{11}=68\\)，\\(N_{12}=56\\)，\\(N_{13}=32\\)。类似地，\\(N_{21}=52\\)，\\(N_{22}=72\\)，\\(N_{23}=20\\)。\n利用这些数据检验随机选取的一个人的性别和政治派别是独立的这一假设。\n\n\n解 11.4. 根据上述数据，我们得到 \\(n\\hat{p_i}\\hat{q_j}=\\frac{N_iM_j}{n}\\) 的 6 个值如下：\n\\(\\frac{N_{1}M_{1}}{n}=\\frac{156\\times120}{300}=62.40\\) \\(\\frac{N_{1}M_{2}}{n}=\\frac{156\\times128}{300}=66.56\\) \\(\\frac{N_{1}M_{3}}{n}=\\frac{156\\times52}{300}=27.04\\) \\(\\frac{N_{2}M_{1}}{n}=\\frac{144\\times120}{300}=57.60\\) \\(\\frac{N_{2}M_{2}}{n}=\\frac{144\\times128}{300}=61.44\\) \\(\\frac{N_{2}M_{3}}{n}=\\frac{144\\times52}{300}=24.96\\)\n因此，检验统计量的值为：\n\\(\\begin{align} TS&=\\frac{(68 - 62.40)^{2}}{62.40}+\\frac{(56 - 66.56)^{2}}{66.56}+\\frac{(32 - 27.04)^{2}}{27.04}+\\frac{(52 - 57.60)^{2}}{57.60} \\\\ &+\\frac{(72 - 61.44)^{2}}{61.44}+\\frac{(20 - 24.96)^{2}}{24.96}\\\\ &=6.433 \\end{align}\\)\n\\((r - 1)(s - 1)=2\\)，我们使用 R 来获得 \\(p-\\text{value}\\)。\n\np_value &lt;- 1 - pchisq(6.433, 2)\np_value\n\n[1] 0.04009515\n\n\n因此，在 5% 的显著性水平下，我们将拒绝性别和政治派别是独立的原假设。\n\n\n\n\n\n\n注记\n\n\n\n我们可以直接使用 R 中的卡方检验函数来进行检验。\n\nwomen &lt;- c(68, 56, 32)\nmen &lt;- c(52, 72, 20)\ndata &lt;- matrix(c(women, men), nrow = 2, byrow = TRUE)\ncolnames(data) &lt;- c(\"Democrat\", \"Republican\", \"Independent\")\nrownames(data) &lt;- c(\"Women\", \"Men\")\n\ndata\n\n      Democrat Republican Independent\nWomen       68         56          32\nMen         52         72          20\n\nchisq.test(data)\n\n\n    Pearson's Chi-squared test\n\ndata:  data\nX-squared = 6.4329, df = 2, p-value = 0.0401\n\n\n\n\n\\(\\blacksquare\\)\n\n\n习题 11.5 一家公司每天会安排三个不同的班次工人来操作四台机器。下面的列联表展示了在六个月的时间里的机器故障数据。\n\n\n\n表 11.2: 机器故障数\n\n\n\n\n\n班次\n机器 A\n机器 B\n机器 C\n机器 D\n总计\n\n\n\n\n班次 1\n10\n12\n6\n7\n35\n\n\n班次 2\n10\n24\n9\n10\n53\n\n\n班次 3\n13\n20\n7\n10\n50\n\n\n每台机器总计\n33\n56\n22\n27\n138\n\n\n\n\n\n\n假设我们希望确定某台机器在特定班次发生故障的概率是否受该班次的影响。换句话说，对于任意一次故障，我们希望检验导致故障的机器和故障发生的班次之间是否独立。\n\n\n解 11.5. 根据计算，我们得出检验统计量的值为 1.8148。因此，\\(p-\\text{value}\\) 为：\n\np_value &lt;- 1 - pchisq(1.9148, 6)\np_value\n\n[1] 0.9273652\n\n\n因此，我们将接受导致故障的机器和故障发生的班次是独立的假设。\\(\\blacksquare\\)",
    "crumbs": [
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>拟合优度检验和分类数据分析</span>"
    ]
  },
  {
    "objectID": "chapter_11/11.html#sec-11_5",
    "href": "chapter_11/11.html#sec-11_5",
    "title": "11  拟合优度检验和分类数据分析",
    "section": "11.5 具有固定边缘总和的列联表的独立性检验",
    "text": "11.5 具有固定边缘总和的列联表的独立性检验\n在 习题 11.4 中，我们确定了：在特定人群中性别和政治派别的相关性。为了检验我们的原假设，我们首先从该人群中选择了一个随机样本，然后记录了样本的 特征（characteristics）。\n然而，我们收集数据的另一种方式是：预先确定样本中男性和女性的数量，然后从男性和女性人群中选择对应大小的随机样本。也就是说，样本中的男性和女性的数量并不是由随机抽取而决定，而是提前确定他们的数量。因为这样做会导致样本中的男性样本总数和女性样本总数都有固定的特定值，所以我们通常称由此得到的列联表具有固定的边缘（fixed margins）。\n事实证明，即便使用以上的规则来收集数据，小节 11.4 中给出的假设检验仍然可以用来检验两个特征的独立性。检验统计量仍然是\n\\(TS=\\sum_{i}\\sum_{j}\\frac{(N_{ij}-\\hat{e}_{ij})^{2}}{\\hat{e}_{ij}}\\)\n\n\\(N_{ij}\\) 是样本中同时具有 \\(X-\\text{特征}\\) \\(i\\) 和 \\(Y-\\text{特征}\\) \\(j\\) 的样本数量\n\\(N_{i}\\) 是样本中具有 \\(X-\\text{特征}\\) \\(i\\) 的样本数量\n\\(M_{j}\\) 是样本中具有 \\(Y-\\text{特征}\\) \\(j\\) 的样本数量\n\\(\\hat{e}_{ij}=n\\hat{p}_{i}\\hat{q}_{j}=\\frac{N_{i}M_{j}}{n}\\) ，其中 \\(n\\) 是样本的总大小。\n\n此外，当原假设 \\(H_0\\) 为真时， \\(TS\\) 仍然近似具有自由度为 \\((r - 1)(s - 1)\\) 的卡方分布。这里的量 \\(r\\) 和 \\(s\\) 分别指的是 \\(X-\\text{特征}\\) 和 \\(Y-\\text{特征}\\) 可能取值的数量。换句话说，独立性假设检验与某个特征的边缘总和是预先固定的还是由整个总体的随机样本产生的无关。\n\n习题 11.6 随机选取了 20000 名不吸烟者和 10000 名吸烟者，并对他们进行了为期 10 年的跟踪调查。以下数据显示了在这段时间内患肺癌的人数。\n\n\n\n\n吸烟者数量\n不吸烟者数量\n总计\n\n\n\n\n患肺癌数量\n62\n14\n76\n\n\n未患肺癌数量\n9938\n19986\n29924\n\n\n总计\n10000\n20000\n30000\n\n\n\n在 1% 的显著性水平下检验吸烟与肺癌是否独立的假设。\n\n\n解 11.6. 当吸烟和肺癌无关时，每个 \\(ij\\) 单元格中预期人数的估计值为：\n\\(\\hat{e}_{11}=\\frac{(76)(10000)}{30000}=25.33\\)\n\\(\\hat{e}_{12}=\\frac{(76)(20000)}{30000}=50.67\\)\n\\(\\hat{e}_{21}=\\frac{(29924)(10000)}{30000}=9974.67\\)\n\\(\\hat{e}_{22}=\\frac{(29924)(20000)}{30000}=19949.33\\)\n因此，检验统计量的值为：\n\\(\\begin{align*} TS&=\\frac{(62 - 25.33)^{2}}{25.33}+\\frac{(14 - 50.67)^{2}}{50.67}+\\frac{(9938 - 9974.67)^{2}}{9974.67} \\\\ &+\\frac{(19986 - 19949.33)^{2}}{19949.33}\\\\ &=53.09 + 26.54 + 0.13 + 0.07 = 79.83 \\end{align*}\\)\n因此，\\(p-\\text{value}\\approx P(\\chi_{1}^{2}&gt;79.83)=1-\\text{pchisq}(79.83,1)\\approx0\\) 。\n所以，在任何显著性水平下，随机选取的一个人患肺癌与否与这个人是否吸烟无关的原假设都会被拒绝。\n\n接下来，我们将介绍如何使用本节的计算框架来检验 \\(m\\) 个离散总体分布是否相等的假设。考虑 \\(m\\) 个独立的总体，每个总体的成员取值为 \\(1,\\ldots,n\\)。假设从总体 \\(i\\) 中随机选取的一个成员的值为 \\(j\\) 的概率为 \\(p_{i,j}\\) ，其中 \\(i = 1,\\ldots,m\\)，\\(j = 1,\\ldots,n\\)。检验如下的原假设：\n\\(H_0：\\forall j = 1,\\ldots,n, \\quad p_{1,j}=p_{2,j}=p_{3,j}=\\cdots=p_{m,j}\\)\n首先考虑由这 \\(m\\) 个总体的所有成员组成的 超总体（superpopulation）。该 超总体 的任何成员都可以根据两个 特征 进行分类。第一个特征指定成员来自 \\(m\\) 个总体中的哪一个，第二个特征指定其取值。于是，\\(m\\) 个总体的分布都相等的假设就变成了如下的假设：对于每个取值而言，该取值在 \\(m\\) 个总体中的每一个中的比例都是相同的。但这完全等同于：从超总体中随机选取的一个成员的两个特征是独立的。\n因此，我们可以通过从每个总体中随机选取样本成员来检验 \\(H_0\\)。如果我们用 \\(M_i\\) 表示从总体 \\(i\\) 中抽取的样本大小，用 \\(N_{i,j}\\) 表示该样本中取值等于 \\(j\\) 的数量，其中 \\(i = 1,\\ldots,m\\)，\\(j = 1,\\ldots,n\\)，那么我们可以通过检验如下的列联表中特征的独立性来检验 \\(H_0\\)。\n\n\n\n\n\n\n\n\n\n\n\n\n\n取值\n总体 1\n总体 2\n\\(\\cdots\\)\n总体 \\(i\\)\n\\(\\cdots\\)\n总体 \\(m\\)\n总计\n\n\n\n\n1\n\\(N_{1,1}\\)\n\\(N_{2,1}\\)\n\\(\\cdots\\)\n\\(N_{i,1}\\)\n\\(\\cdots\\)\n\\(N_{m,1}\\)\n\\(N_1\\)\n\n\n2\n\n\n\n\n\n\n\n\n\n\\(\\vdots\\)\n\n\n\n\n\n\n\n\n\n\\(j\\)\n\\(N_{1,j}\\)\n\\(N_{2,j}\\)\n\\(\\cdots\\)\n\\(N_{i,j}\\)\n\\(\\cdots\\)\n\\(N_{m,j}\\)\n\\(N_j\\)\n\n\n\\(\\vdots\\)\n\n\n\n\n\n\n\n\n\n\\(n\\)\n\\(N_{1,n}\\)\n\\(N_{2,n}\\)\n\\(\\cdots\\)\n\\(N_{i,n}\\)\n\\(\\cdots\\)\n\\(N_{m,n}\\)\n\\(N_n\\)\n\n\n总计\n\\(M_1\\)\n\\(M_2\\)\n\\(\\cdots\\)\n\\(M_i\\)\n\\(\\cdots\\)\n\\(M_m\\)\n\n\n\n\n注意，\\(N_j\\) 表示样本中取值为 \\(j\\) 的成员的数量。\n\n习题 11.7 最近的一项研究报告称，他们从四个不同的国家随机选取了500名（每个国家随机选择 500 名）女性办公室职员进行调研。其中一个问题就是：她们在工作中是否经常受到言语或性虐待，并得到了如下数据。\n\n\n\n国家\n受虐待的人数\n\n\n\n\n澳大利亚\n28\n\n\n德国\n30\n\n\n日本\n51\n\n\n美国\n55\n\n\n\n基于这些数据，这些国家中经常在工作中感到受虐待的女性办公室职员的比例相同这一说法是否合理？\n\n\n解 11.7. 将上述数据表示成如下的列联表：\n\n\n\n\n国家 1\n国家 2\n国家 3\n国家 4\n总计\n\n\n\n\n受到虐待\n28\n30\n51\n55\n171\n\n\n未受虐待\n472\n470\n442\n445\n1829\n\n\n总计\n500\n500\n500\n500\n2000\n\n\n\n可以通过检验上述列联表中的独立性来检验原假设。使用 R 语言得到检验统计量的值为 \\(TS = 19.51\\)，对应的 \\(p-\\text{value}\\) 为 0.0002。\n因此，在 1% 的显著性水平下（实际上，在任何高于 0.02% 的显著性水平下），我们将拒绝这些国家中的不同女性在工作中受到虐待的比例相同这一假设。\\(\\blacksquare\\)",
    "crumbs": [
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>拟合优度检验和分类数据分析</span>"
    ]
  },
  {
    "objectID": "chapter_11/11.html#sec-11_6",
    "href": "chapter_11/11.html#sec-11_6",
    "title": "11  拟合优度检验和分类数据分析",
    "section": "11.6 用于连续数据的 Kolmogorov–Smirnov 拟合优度检验 \\(^*\\)",
    "text": "11.6 用于连续数据的 Kolmogorov–Smirnov 拟合优度检验 \\(^*\\)\n假设 \\(Y_1,\\ldots,Y_n\\) 为来自连续分布的总体的样本数据，并且我们希望检验原假设 \\(H_0: \\text{总体的分布函数为} F\\)，其中 \\(F\\) 是一个指定的连续分布函数。\n一种检验 \\(H_0\\) 的方法是：\n\n首先将 \\(Y_j\\) 的可能取值划分为 \\(k\\) 个不同的区间，即 \\((y_0,y_1),(y_1,y_2),\\ldots,(y_{k - 1},y_k)\\)，其中 \\(y_0 = -\\infty\\)，\\(y_k = +\\infty\\)。\n如果 \\(Y_j\\) 落在区间 \\((y_{i - 1},y_i)\\) 中，则令 \\(Y_j^d = i\\)。于是我们得到一个离散随机变量 \\(Y_j^{d}\\)，\\(j = 1,\\ldots,n\\)。\n\n原假设意味着 \\(P\\{Y_j^{d} = i\\} = F(y_i)-F(y_{i - 1})\\)，\\(i = 1,\\ldots,k\\)，并且可以通过已经介绍过的卡方拟合优度检验来检验原假设。\n然而，还有另一种比如上的离散化方法更为有效的检验方法以检验 \\(Y_j\\) 是否来自连续分布函数 \\(F\\)。接下来，我们将介绍这种更为有效的检验方法。\n在观察到 \\(Y_1,\\ldots,Y_n\\) 之后，令 \\(F_e\\) 为 经验分布函数（the empirical distribution function）：\n\\(F_e(x)=\\frac{\\#i:Y_i\\leq x}{n}\\)\n也就是说，\\(F_e(x)\\) 是观察值中小于或等于 \\(x\\) 的比例。因为 \\(F_e(x)\\) 是一个观察值小于或等于 \\(x\\) 的概率的自然估计量，所以如果原假设（\\(F\\) 就是总体的分布函数）是正确的，那么 \\(F_e(x)\\) 和 \\(F(x)\\) 应该非常接近。由于对于所有的 \\(x\\) 都是如此，所以检验 \\(H_0\\) 的检验统计量为：\n\\(D\\equiv\\underset{x}{\\text{Maximum}}|F_e(x)-F(x)|\\)\n其中在 \\(x \\in (-\\infty, +\\infty)\\) 上取 \\(|F_e(x)-F(x)|\\) 的最大值作为统计量 \\(D\\)。我们称 \\(D\\) 为 Kolmogorov–Smirnov 检验统计量。\n为了计算给定数据集 \\(Y_j = y_j\\)，\\(j = 1,\\ldots,n\\) 下的 \\(D\\) 的值，我们令 \\(y_{(1)},y_{(2)},\\ldots,y_{(n)}\\) 表示 \\(y_j\\) 的升序排列结果。也就是说，\\(y_{(j)}\\) 是 \\(y_1,\\ldots,y_n\\) 中第 \\(j\\) 小的值。\n例如，如果 \\(n =3\\)，\\(y_1 = 3\\)，\\(y_2 = 5\\)，\\(y_3 = 1\\)，那么 \\(y_{(1)} = 1\\)，\\(y_{(2)} = 3\\)，\\(y_{(3)} = 5\\)。所以，\\(F_e(x)\\) 可以写作：\n\\[\nF_e(x) = \\begin{cases}\n0, \\quad & \\text{if} \\quad x \\lt y_{(1)} \\\\\n\\frac{1}{n}, \\quad & \\text{if} \\quad y_{(1)} \\le x \\lt y_{(2)} \\\\\n\\vdots & \\\\\n\\frac{j}{n}, \\quad & \\text{if} \\quad y_{(j)} \\le x \\lt y_{(j + 1)} \\\\\n\\vdots & \\\\\n1, \\quad & \\text{if} \\quad y_{(n)} \\le x\n\\end{cases}\n\\]\n所以，在区间 \\((y_{(j - 1)},y_{(j)})\\) 内，\\(F_e(x)\\) 是常数，并在 \\(y_{(1)},\\ldots,y_{(n)}\\) 处跃增 \\(\\frac{1}{n}\\)。由于 \\(F(x)\\) 是 \\(x\\) 的增函数且小于等于 \\(1\\)，所以 \\(F_e(x)-F(x)\\) 的最大值是非负的，并且当 \\(x\\) 等于 \\(y_{(j)}, j = 1,\\ldots,n\\) 中的一个时取得最大值（如 图 11.1）。\n\n\n\n\n\n\n图 11.1: \\(n=5\\)\n\n\n\n也就是说，\n\\[\n\\underset{x}{\\text{Maximum}} \\left \\{ F_e(x)-F(x) \\right \\} =\\underset{j = 1,\\ldots,n}{\\text{Maximum}}\\{\\frac{j}{n}-F(y_{(j)})\\}\n\\tag{11.4}\\]\n类似地，\\(F(x)-F_e(x)\\) 的最大值也是非负的，并且出现在紧靠跳跃点 \\(y_{(j)}\\) 的前一个的位置。所以：\n\\[\n\\underset{x}{\\text{Maximum}}\\{F(x)-F_e(x)\\}=\\underset{j = 1,\\ldots,n}{\\text{Maximum}}\\{F(y_{(j)})-\\frac{j - 1}{n}\\}\n\\tag{11.5}\\]\n根据 式 11.4 和 式 11.5，我们得到：\n\\[\n\\begin{align*}\nD&=\\underset{x}{\\text{Maximum}}\\vert F_e(x)-F(x)\\vert\\\\\n&=\\text{Maximum} \\left \\{\\text{Maximum}\\{F_e(x)-F(x)\\},\\text{Maximum}\\{F(x)-F_e(x)\\} \\right \\}\\\\\n&=\\text{Maximum} \\left \\{\\frac{j}{n}-F(y_{(j)}),F(y_{(j)})-\\frac{j - 1}{n},j = 1,\\ldots,n \\right \\}\n\\end{align*}\n\\tag{11.6}\\]\n我们可以利用 式 11.6 来计算 \\(D\\) 的值。\n假设已经观察到 \\(Y_j\\)，并且 \\(Y_j\\) 的观察值使得 \\(D = d\\)。较大的 \\(D\\) 值似乎与总体分布服从 \\(F\\) 的原假设不一致，所以观察数据集的 \\(p-\\text{value}\\) 为：\n\\(p-\\text{value}=P_F\\{D\\geq d\\}\\)\n其中我们写作 \\(P_F\\) 是为了表明如上的概率是在原假设 \\(H_0\\) 为真（所以 \\(F\\) 就是总体的分布函数）的情况下计算的。\n可以通过 命题 11.1 的模拟来更简单的近似计算如上的 \\(p-\\text{value}\\)。命题 11.1 表明 \\(P_F\\{D\\geq d\\}\\) 不依赖于总体的假设分布函数 \\(F\\)，这允许我们可以选择任何的连续分布 \\(F\\) 进行模拟来估计 \\(p-\\text{value}\\)（因此，我们可以使用 \\((0,1)\\) 均匀分布）。\n\n命题 11.1 对于任意的连续分布函数 \\(F\\)，\\(P_F{D \\ge d}\\) 都是一样的。\n\n证. \\(\\begin{align*} P_F\\{D\\geq d\\}&=P_F\\left\\{\\underset{x}{\\text{Maximum}}\\left|\\frac{\\#\\{i:Y_i\\leq x\\}}{n}-F(x)\\right|\\geq d\\right\\}\\\\ &=P_F\\left\\{\\underset{x}{\\text{Maximum}}\\left|\\frac{\\#\\{i:F(Y_i)\\leq F(x)\\}}{n}-F(x)\\right|\\geq d\\right\\}\\\\ &=P\\left\\{\\underset{x}{\\text{Maximum}}\\left|\\frac{\\#\\{i:U_i\\leq F(x)\\}}{n}-F(x)\\right|\\geq d\\right\\} \\end{align*}\\)\n其中，\\(U_1,\\ldots,U_n\\) 是独立的 \\((0,1)\\) 均匀分布随机变量。\n\n第一个等式成立是因为 \\(F\\) 是增函数，所以 \\(Y\\leq x\\) 等价于 \\(F(Y)\\leq F(x)\\)\n第二个等式成立是因为如果 \\(Y\\) 具有连续分布函数 \\(F\\)，那么随机变量 \\(F(Y)\\) 为 \\((0,1)\\) 均匀分布（证明过程留作习题）。\n\n令 \\(y = F(x)\\)，并且当 \\(x\\) 从 \\(-\\infty\\) 增加到 \\(+\\infty\\) 时，\\(F(x)\\) 从 \\(0\\) 增加到 \\(1\\) ，于是我们得到：\n\\(P_F\\{D\\geq d\\}=P\\left\\{\\underset{0\\leq y\\leq1}{\\text{Maximum}}\\left|\\frac{\\#\\{i:U_i\\leq y\\}}{n}-y\\right|\\geq d\\right\\}\\)\n这表明，当原假设 \\(H_0\\) 为真时，\\(D\\) 的分布不依赖于实际分布 \\(F\\)。\\(\\blacksquare\\)\n\n\n由 命题 11.1 可知，在根据观察数据确定 \\(D\\) 的值（\\(D = d\\)）之后，可以使用 \\((0,1)\\) 均匀分布进行模拟来获得 \\(p-\\text{value}\\)。也就是说，我们生成一个包含 \\(n\\) 个随机数 \\(U_1,\\ldots,U_n\\) 的集合，然后检查 \\(\\underset{0\\leq y\\leq1}{\\text{Maximum}}\\left|\\frac{\\#\\{i:U_i\\leq y\\}}{n}-y\\right|\\geq d\\) 是否成立。重复这个过程很多次，那么 \\(\\underset{0\\leq y\\leq1}{\\text{Maximum}}\\left|\\frac{\\#\\{i:U_i\\leq y\\}}{n}-y\\right|\\geq d\\) 成立的次数比例就是对该数据集 \\(p-\\text{value}\\) 的估计。如前所述，可以通过对随机数排序，然后使用等式\n\\(\\text{Max}\\left|\\frac{\\#\\{i:U_i\\leq y\\}}{n}-y\\right|=\\text{Max}\\left\\{\\frac{j}{n}-U_{(j)},U_{(j)}-\\frac{j - 1}{n},j = 1,\\ldots,n\\right\\}\\)\n来计算不等式的左边，其中 \\(U_{(j)}\\) 是 \\(U_1,\\ldots,U_n\\) 中的第 \\(j\\) 小的值。\n例如，如果 \\(n = 3\\) 且 \\(U_1 = 0.7\\)，\\(U_2 = 0.6\\)，\\(U_3 = 0.4\\)，那么 \\(U_{(1)} = 0.4\\)，\\(U_{(2)} = 0.6\\)，\\(U_{(3)} = 0.7\\)，这个数据集的 \\(D\\) 值为：\n\\(D=\\text{Max}\\left\\{\\frac{1}{3}-0.4,\\frac{2}{3}-0.6,1 - 0.7,0.4,0.6-\\frac{1}{3},0.7-\\frac{2}{3}\\right\\}=0.4\\) 。\n令 \\(D^{*}=(\\sqrt{n}+0.12+\\frac{0.11}{\\sqrt{n}})D\\)，并令 \\(d_{\\alpha}^{*}\\) 满足 \\(P_F\\{D^{*}\\geq d_{\\alpha}^{*}\\}=\\alpha\\)，则对于不同的 \\(\\alpha\\) 值，\\(d_{\\alpha}^{*}\\) 有以下的近似值：\n\\(d_{0.1}^{*}=1.224\\)\n\\(d_{0.05}^{*}=1.358\\)\n\\(d_{0.025}^{*}=1.480\\)\n\\(d_{0.01}^{*}=1.626\\)\n如果 \\(D^{*}\\) 的观测值大于等于 \\(d_{\\alpha}^{*}\\)，那么在显著性水平为 \\(\\alpha\\) 下，我们将拒绝总体分布函数为 \\(F\\) 的原假设。\n\n习题 11.8 假设我们要检验一个给定的总体分布是均值为 100 的指数分布的假设，即 \\(F(x)=1-e^{-x/100}\\)。如果来自该分布的、大小为 10 的样本的有序值为：\n66、72、81、94、112、116、124、140、145、155\n那么可以得出什么结论？\n\n\n解 11.8. 首先，我们使用 式 11.6 来计算 Kolmogorov–Smirnov 检验统计量 \\(D\\) 的值。经过计算，我们得到 \\(D = 0.4831487\\)，所以：\n\\(D^{*}=0.48315(\\sqrt{10}+0.12+\\frac{0.11}{\\sqrt{10}})=1.603\\)。\n因为 1.603 超过了 \\(d_{0.025}^{*}=1.480\\)，所以在 2.5% 的显著性水平下，我们将拒绝样本数据来自均值为 100 的指数分布的原假设。另一方面，因为 1.603 小于 \\(d_{0.01}^{*}=1.626\\)，所以在 1% 的显著性水平下，我们不会拒绝原假设。\\(\\blacksquare\\)",
    "crumbs": [
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>拟合优度检验和分类数据分析</span>"
    ]
  },
  {
    "objectID": "chapter_11/11.html#problems",
    "href": "chapter_11/11.html#problems",
    "title": "11  拟合优度检验和分类数据分析",
    "section": "Problems",
    "text": "Problems",
    "crumbs": [
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>拟合优度检验和分类数据分析</span>"
    ]
  },
  {
    "objectID": "chapter_11/11.html#footnotes",
    "href": "chapter_11/11.html#footnotes",
    "title": "11  拟合优度检验和分类数据分析",
    "section": "",
    "text": "D. Phillips, “Death Day and Birthday: An Unexpected Connection,” in Statistics: A Guide to the Unknown, Holden-Day, 1972.↩︎",
    "crumbs": [
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>拟合优度检验和分类数据分析</span>"
    ]
  },
  {
    "objectID": "chapter_12/12.html",
    "href": "chapter_12/12.html",
    "title": "12  非参数假设检验",
    "section": "",
    "text": "12.1 引言\n在本章中，我们将介绍在未指定总体的概率分布的场景下进行假设检验的方法。也就是说，在本章中，我们不再假设总体的分布是正态分布、指数分布或任何其他给定类型的分布。由于没有假设总体分布的特定参数形式，所以我们称这样的检验为 非参数检验（nonparametric test）。\n非参数检验 的优势在于它可以应用于不假设总体分布形式的场景。当然，如果可以假设总体分布的特定参数形式，例如正态分布，那么我们就应该使用对应的参数检验。",
    "crumbs": [
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>非参数假设检验</span>"
    ]
  },
  {
    "objectID": "chapter_12/12.html#sec-12_1",
    "href": "chapter_12/12.html#sec-12_1",
    "title": "12  非参数假设检验",
    "section": "",
    "text": "在 小节 12.2 中，我们将考虑关于连续分布的中位数的假设，并介绍如何使用 符号检验（signed test）来研究检验连续分布中位数的假设。\n在 小节 12.3 中，我们将考虑 符号秩检验（signed rank test），该方法可以用于检验假设：连续分布总体关于某个特定值对称。\n在 小节 12.4 中，我们将考虑双样本问题，即人们希望使用来自两个独立连续分布的数据来检验这些分布相等的假设，并将介绍 秩和检验（rank sum test）。\n最后，在 小节 12.5 中，我们将研究 游程检验（runs test），该方法可用于检验假设：由 0 和 1 组成的序列构成了一个不遵循任何特定模式的随机序列。",
    "crumbs": [
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>非参数假设检验</span>"
    ]
  },
  {
    "objectID": "chapter_12/12.html#sec-12_2",
    "href": "chapter_12/12.html#sec-12_2",
    "title": "12  非参数假设检验",
    "section": "12.2 符号检验",
    "text": "12.2 符号检验\n令 \\(X_1,\\ldots,X_n\\) 表示来自连续分布 \\(F\\) 的一个样本，假设我们希望检验假设：\\(F\\) 的中位数——\\(m\\)——等于某个特定值 \\(m_0\\)。也就是说，考虑检验如下的假设：\n\\(H_0:m = m_0 \\quad vs \\quad H_1:m\\neq m_0\\)，其中 \\(m\\) 满足 \\(F(m)=0.5\\)。\n我们注意到每个观测数据独立小于 \\(m_0\\) 的概率为 \\(F(m_0)\\)。因此，如果令\n\\(I_i=\\begin{cases}1& \\text{如果} X_i\\lt m_0\\\\0& \\text{如果} X_i\\geq m_0\\end{cases}\\)\n那么 \\(I_1,\\ldots,I_n\\) 就是是相互独立的伯努利随机变量，并且其参数为 \\(p = F(m_0)\\)。所以原假设等价于说该伯努利分布的参数等于 \\(\\frac{1}{2}\\)。\n如果令 \\(\\sum_{i = 1}^{n}I_i\\) 的观测值为 \\(v\\)，也就是说，\\(v\\) 是观测数据中小于 \\(m_0\\) 的数量，那么根据 小节 8.6，检验这个伯努利参数等于 \\(\\frac{1}{2}\\) 的 \\(p-\\text{value}\\) 为\n\\[\np-\\text{value}=2\\min(P\\{B(n,\\frac{1}{2})\\leq v\\},P\\{B(n,\\frac{1}{2})\\geq v\\})\n\\tag{12.1}\\]\n其中 \\(B(n,p)\\) 是参数为 \\(n\\) 和 \\(p\\) 的二项分布随机变量。\n然而，\n\\[\n\\begin{align*}\nP\\{B(n,p)\\geq v\\}&=P\\{n-B(n,p)\\leq n-v\\}\\\\\n&=P\\{B(n,1-p)\\leq n-v\\}\n\\end{align*}\n\\]\n想想这是为什么？\n所以根据 式 12.1，我们可以看出 \\(p-\\text{value}\\) 为：\n\\[\n\\begin{align*}\np-\\text{value}&=2\\min(P\\{B(n,\\frac{1}{2})\\leq v\\},P\\{B(n,\\frac{1}{2})\\leq n-v\\})\\\\\n&=\\begin{cases}2P\\{B(n,\\frac{1}{2})\\leq v\\}& \\text{如果} v\\leq\\frac{n}{2}\\\\2P\\{B(n,\\frac{1}{2})\\leq n-v\\}& \\text{如果} v\\geq\\frac{n}{2}\\end{cases}\n\\end{align*}\n\\tag{12.2}\\]\n由于 \\(v=\\sum_{i}I_1\\) 的值取决于各项 \\(X_i - m_0\\) 的符号，所以我们称如上的检验被为 符号检验（sign test）。\n\n习题 12.1 如果一个大小为 200 个样本中有 120 个数据小于 \\(m_0\\)，有 80 个数据大于 \\(m_0\\)，那么用于检验该样本总体的中位数等于 \\(m_0\\) 的 \\(p-\\text{value}\\) 是多少？\n\n\n解 12.1. 根据 式 12.2，检验的 \\(p-\\text{value}\\) 为参数为 \\(B(200, \\frac{1}{2})\\) 的伯努利随机变量小于等于 80 的概率的 2 倍。\n\np_value &lt;- 2 * pbinom(80, 200, 0.5)\n\np_value\n\n[1] 0.005685156\n\n\n因此，在 1% 的显著性水平下，我们将拒绝原假设。\\(\\blacksquare\\)\n\n符号检验 也可以应用于之前的配对 \\(t-\\text{检验}\\) 的场景。例如，让我们回顾一下 习题 8.12，该案例中希望检验最近制定的工业安全计划是否对因事故损失导致的工时数有影响。对于样本来源的 10 个工厂而言，数据对 \\((X_i, Y_i)\\) 表示工厂 \\(i\\) 在实施安全计划前后的平均每周损失工时数。令 \\(Z_i = X_i - Y_i\\)，\\(i = 1,\\ldots,10\\)，那么如果该计划没有任何效果，则 \\(Z_i\\)，\\(i = 1,\\ldots,10\\) 将是一个来自中位数为 0 的总体分布的样本。由于 \\(Z_i\\) 的结果值为 7.5、-2.3、2.6、3.7、1.5、-0.5、-1、4.9、4.8、1.6，其中有三个值的符号为负，七个值的符号为正，所以在显著性水平 \\(\\alpha\\) 下，如果 \\(\\sum_{i = 0}^{3}\\binom{10}{i}\\left(\\frac{1}{2}\\right)^{10}\\leq\\frac{\\alpha}{2}\\)，那么我们应该拒绝 \\(Z\\) 的中位数为 0 的假设。由于 \\(\\sum_{i = 0}^{3}\\binom{10}{i}\\left(\\frac{1}{2}\\right)^{10}=\\frac{176}{1024}=0.172\\)，所以在 5% 的显著性水平下，我们将接受该假设（实际上，在所有小于 0.344 的显著性水平下，我们都会接受原假设）。\n因此，符号检验 不能使我们得出安全计划有任何统计上有显著影响的结论，而这与 习题 8.12 中假设安全计划前后的差异数据服从正态分布得到的结论矛盾。原因在于正态分布的假设使得我们不仅考虑大于 0 的值的数量（这是符号检验所考虑的全部），而且还允许我们考虑这些值的大小。接下来要介绍的检验虽然仍然是非参数检验，但会通过考虑与假设的中位数 \\(m_0\\) 的差异的大多数数据是否会倾向于位于 \\(m_0\\) 的某一侧来改进 符号检验，即这些差异是否主要大于或小于 \\(m_0\\)。\n我们也可以使用 符号检验 来检验关于总体中位数的单边检验。例如，假设我们要检验：\n\\(H_0:m\\leq m_0 \\quad vs \\quad H_1:m\\gt m_0\\)\n其中 \\(m\\) 是总体中位数，\\(m_0\\) 是某个特定值。令 \\(p\\) 表示 \\(m\\) 小于 \\(m_0\\) 的概率，并且如果原假设为真，那么 \\(p\\geq\\frac{1}{2}\\)，如果备择假设为真，那么 \\(p\\lt\\frac{1}{2}\\)（参见 图 12.1）。\n\n\n\n\n\n\n\n\nA\n\n\n\n\n\n\n\nB\n\n\n\n\n\n\n\n\n\nC\n\n\n\n\n\n\n图 12.1\n\n\n\n为了使用 符号检验 来检验单边假设，我们从总体中随机选择 \\(n\\) 个样本。如果其中有 \\(v\\) 个样本的值小于 \\(m_0\\)，那么 \\(p-\\text{value}\\) 就是：如果每个元素小于 \\(m_0\\) 的概率为 \\(\\frac{1}{2}\\)，则存在 \\(v\\)（或更少） 个样本的概率。即，\n\\(p-\\text{value}=P\\{B(n,\\frac{1}{2})\\leq v\\}\\)\n\n习题 12.2 如果能确定某社区家庭的年收入中位数大于 90000 美元，则某家金融机构就会决定在该个社区开设办事处。为了获取相关信息，该金融机构随机选择了 80 个家庭，并记录了其家庭收入。如果其中 28 个家庭的年收入低于 90000 美元，52 个家庭的年收入高于 90000 美元，那么这是否足以说在 5% 的显著性水平下，该社区的家庭年收入中位数大于 90000 美元呢？\n\n\n解 12.2. 对于如下的原假设：\n\\(H_0:m\\leq90 \\quad vs \\quad H_1:m\\gt90\\)\n我们需要确定当前的数据是否足以让我们拒绝原假设。\n这等价于检验：\n\\(H_0:p\\geq\\frac{1}{2} \\quad vs \\quad H_1:p\\lt\\frac{1}{2}\\)\n其中 \\(p\\) 是从总体中随机选择一个家庭其年收入小于 90000 美元的概率。因此，\n\\(p-\\text{value}=P(B(80,\\frac{1}{2})\\leq28)=\\text{pbinom}(28,80,\\frac{1}{2})=0.004841425\\)\n所以我们将拒绝年收入中位数小于或等于 90000 美元的原假设。\\(\\blacksquare\\)\n\n类似的，我们可以对中位数至少为 \\(m_0\\) 的单边假设进行检验。如果选择一个大小为 \\(n\\) 的随机样本，并且结果中有 \\(v\\) 个值小于 \\(m_0\\)，那么 \\(p-\\text{value}\\) 为：\n\\(p-\\text{value}=P\\{B(n,\\frac{1}{2})\\geq v\\}\\)",
    "crumbs": [
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>非参数假设检验</span>"
    ]
  },
  {
    "objectID": "chapter_12/12.html#sec-12_3",
    "href": "chapter_12/12.html#sec-12_3",
    "title": "12  非参数假设检验",
    "section": "12.3 符号秩检验",
    "text": "12.3 符号秩检验\n符号检验 可用于检验连续分布 \\(F\\) 的中位数等于某个特定值 \\(m_0\\) 的假设。然而，在许多应用中，人们不仅希望检验中位数是否等于 \\(m_0\\)，还希望检验分布是否关于 \\(m_0\\) 对称。也就是说，如果 \\(X\\) 具有分布函数 \\(F\\)，那么对于所有的 \\(a \\gt 0\\)，我们通常希望检验假设（参见 图 12.2）：\n\\(H_0:P\\{X\\lt m_0 - a\\}=P\\{X\\gt m_0 + a\\}\\)\n\n\n代码\nlibrary(ggplot2)\n\nf &lt;- function(x) {\n    ifelse(x &lt;= 3,\n           max(0, 0.4 * (x - 3) + sqrt(0.4)),\n           max(0, -0.4 * (x - 3) + sqrt(0.4)))\n}\n\nx &lt;- seq(0, 6, by = 0.1)\ny &lt;- sapply(x, f)\ndf &lt;- data.frame(x = x, y = y)\nggplot(df, aes(x = x, y = y)) + \n  geom_line() +\n  scale_x_continuous(breaks = seq(0, 6, by = 1), limits = c(0, 6))\n\n\n\n\n\n\n\n\n图 12.2: 关于 \\(m=3\\) 对称的概率密度函数\n\n\n\n\n\n虽然仍然可以使用 符号检验 检验 \\(F\\) 关于 \\(m_0\\) 的对称性，但 符号检验 只比较了小于和大于 \\(m_0\\) 的数据值的数量，而没有考虑这两组数据中是否有一组比另一组距离 \\(m_0\\) 更远。一种考虑到这两组数据中是否有一组比另一组距离 \\(m_0\\) 更远的非参数检验就是所谓的 符号秩检验（signed rank test）。\n令 \\(Y_i = X_i - m_0, i = 1,\\ldots,n\\)，然后对 \\(|Y_1|,|Y_2|,\\ldots,|Y_n|\\) 进行排序（rank）。对于 \\(j = 1,\\ldots,n\\)，令：\n\\(I_j=\\begin{cases}1& \\text{如果} |Y_i| \\text{中第} j \\text{最小值对应的} X_i \\text{小于} m_0 \\\\0& \\text{否则} \\end{cases}\\)\n现在，\\(\\sum_{j = 1}^{n}I_j\\) 表示 符号检验 的检验统计量，而 \\(T=\\sum_{j = 1}^{n}jI_j\\) 表示 符号秩检验 的检验统计量。也就是说，符号秩检验 不但会像 符号检验 那样考虑小于 \\(m_0\\) 的数据，而且会给那些距离 \\(m_0\\) 最远的数据赋予更大的权重（符号检验 中这些权重都是相同的）。\n\n例 12.1 如果 \\(n = 4\\)，\\(m_0 = 2\\)，并且观察数据值为 \\(X_1 = 4.2\\)、\\(X_2 = 1.8\\)、\\(X_3 = 5.3\\)、\\(X_4 = 1.7\\)，则 \\(|X_i - 2|\\) 的排序结果为 \\(0.2, 0.3, 2.2, 3.3\\)。因为第一个数据 0.2 来自 \\(X_2\\)，而 \\(X_2 &lt; 2\\)，所以 \\(I_1 = 1\\)。类似的，\\(I_2 = 1\\)，\\(I_3 = I_4 = 0\\)。因此，检验统计量 \\(T = 1 + 2 = 3\\)。\\(\\blacksquare\\)\n\n\n\n\n\n\n\n注记\n\n\n\n可以使用如下的 R 代码计算检验统计量。\n\nTS &lt;- function(X, m_0) {\n    Y &lt;- abs(X - m_0)\n    rank &lt;- order(Y)\n    I &lt;- sapply(X[rank], function(x){ifelse(x &lt; m_0, 1, 0)})\n    T &lt;- sapply(seq_along(I), function(i) {i * I[[i]]})\n    return(sum(T))\n}\n\nt &lt;- TS(c(4.2, 1.8, 5.3, 1.7), 2.0)\nt\n\n[1] 3\n\n\n\n\n当原假设 \\(H_0\\) 为真时，可以比较容易的计算出检验统计量 \\(T\\) 的均值和方差。当 \\(H_0\\) 为真时，意味着 \\(Y_j = X_j - m_0\\) 的分布关于 \\(0\\) 对称，因此对于任何给定的 \\(\\vert Y_j\\vert\\) 的值（比如说 \\(\\vert Y_j\\vert = y\\) ），\\(Y_j = y\\) 和 \\(Y_j = -y\\) 的可能性是相等的。所以，在 \\(H_0\\) 为真时，\\(I_1,\\ldots,I_n\\) 将是独立的随机变量，并且，\n\\(P\\{I_j = 1\\}=\\frac{1}{2}=P\\{I_j = 0\\}, j = 1,\\ldots,n\\)\n因此，在 \\(H_0\\) 为真时，\n\\[\n\\begin{align*}\nE[T]&=E\\left[\\sum_{j = 1}^{n}jI_j\\right]\\\\\n&=\\sum_{j = 1}^{n}\\frac{j}{2}=\\frac{n(n + 1)}{4}\n\\end{align*}\n\\tag{12.3}\\]\n\\[\n\\begin{align*}\n\\mathrm{Var}(T)&=\\mathrm{Var}\\left(\\sum_{j = 1}^{n}jI_j\\right)\\\\\n&=\\sum_{j = 1}^{n}j^{2}\\mathrm{Var}(I_j)\\\\\n&=\\sum_{j = 1}^{n}\\frac{j^{2}}{4}=\\frac{n(n + 1)(2n + 1)}{24}\n\\end{align*}\n\\tag{12.4}\\]\n\n伯努利随机变量 \\(I_j\\) 的方差为 \\(\\frac{1}{2}(1-\\frac{1}{2})=\\frac{1}{4}\\)。\n\n可以证明，对于较大的 \\(n\\)（通常认为 \\(n\\gt25\\) 就足够大了），当 \\(H_0\\) 为真时，\\(T\\) 将近似服从均值为 式 12.3 和方差为 式 12.4 的正态分布。虽然可以通过 \\(T\\) 的近似正态分布推导出在显著性水平 \\(\\alpha\\) 下 \\(H_0\\) 的假设检验（在快速且便宜的算力出现之前，这一直是常用的方法），但我们不会采用这种方法。我们通过明确计算相关概率来确定给定观察数据下的 \\(p-\\text{value}\\)，接下来我们将具体介绍如何实现该方法。\n假设我们需要对 \\(H_0\\) 进行显著性水平为 \\(\\alpha\\) 的检验。由于备择假设是中位数不等于 \\(m_0\\)，所以我们需要进行双边检验。也就是说，如果 \\(T\\) 的观测值等于 \\(t\\) ，那么如果：\n\\[\nP_{H_0}\\{T\\leq t\\}\\leq\\frac{\\alpha}{2} \\quad \\text{或者} \\quad P_{H_0}\\{T\\geq t\\}\\leq\\frac{\\alpha}{2}\n\\tag{12.5}\\]\n我们就应该拒绝 \\(H_0\\)。\n当 \\(T = t\\) 时，观察数据的 \\(p-\\text{value}\\) 为：\n\\[\np-\\text{value}=2\\min(P_{H_0}\\{T\\leq t\\},P_{H_0}\\{T\\geq t\\})\n\\tag{12.6}\\]\n也就是说，如果 \\(T = t\\)，符号秩检验 要求在显著性水平 \\(\\alpha\\) 大于等于 \\(p-\\text{value}\\) 时才会拒绝原假设。可以通过下式来减少计算 \\(p-\\text{value}\\) 时所需的计算量（我们将在本节的末尾给出其证明过程）：\n\\(P_{H_0}\\{T\\geq t\\}=P_{H_0}\\left\\{T\\leq\\frac{n(n + 1)}{2}-t\\right\\}\\)\n根据 式 12.6，有：\n\\[\n\\begin{align*}\np-\\text{value}&=2\\min\\left(P_{H_0}\\{T\\leq t\\},P_{H_0}\\left\\{T\\leq\\frac{n(n + 1)}{2}-t\\right\\}\\right)\\\\\n&=2P_{H_0}\\{T\\leq t^{*}\\}\n\\end{align*}\n\\]\n其中，\\(t^* = \\min\\left(t, \\frac{n(n+1)}{2} - t\\right)\\)\n现在还需要计算 \\(P_{H_0}\\{T\\leq t^{*}\\}\\) 。为此，令 \\(P_k(i)\\) 表示在原假设 \\(H_0\\) 为真时，当样本大小为 \\(k\\) 时，符号秩 统计量 \\(T\\) 小于或等于 \\(i\\) 的概率。我们将从 \\(k = 1\\) 开始确定 \\(P_k(i)\\) 的递归公式。\n当 \\(k = 1\\) 时，由于只有一个数据值，并且当 \\(H_0\\) 为真时，这个数据值小于或大于 \\(m_0\\) 的可能性是相等的，所以 \\(T\\) 等于 \\(0\\) 或 \\(1\\) 的可能性也是相等的。因此\n\\[\nP_{1}(i)=\\begin{cases}0&i\\lt0\\\\\\frac{1}{2}&i = 0\\\\1&i\\geq1\\end{cases}\n\\tag{12.7}\\]\n假设样本大小为 \\(k\\)。为了计算 \\(P_k(i)\\)，我们以 \\(I_k\\) 的值为条件进行如下计算：\n\\[\n\\begin{align*}\nP_{k}(i)&=P_{H_0}\\left\\{\\sum_{j = 1}^{k}jI_j\\leq i\\right\\}\\\\\n&=P_{H_0}\\left\\{\\sum_{j = 1}^{k}jI_j\\leq i\\vert I_k = 1\\right\\}P_{H_0}\\{I_k = 1\\}\\\\\n&\\quad +P_{H_0}\\left\\{\\sum_{j = 1}^{k}jI_j\\leq i\\vert I_k = 0\\right\\}P_{H_0}\\{I_k = 0\\}\\\\\n&=P_{H_0}\\left\\{\\sum_{j = 1}^{k - 1}jI_j\\leq i - k\\vert I_k = 1\\right\\}P_{H_0}\\{I_k = 1\\}\\\\\n&\\quad +P_{H_0}\\left\\{\\sum_{j = 1}^{k - 1}jI_j\\leq i\\vert I_k = 0\\right\\}P_{H_0}\\{I_k = 0\\}\\\\\n&=P_{H_0}\\left\\{\\sum_{j = 1}^{k - 1}jI_j\\leq i - k\\right\\}P_{H_0}\\{I_k = 1\\}+P_{H_0}\\left\\{\\sum_{j = 1}^{k - 1}jI_j\\leq i\\right\\}P_{H_0}\\{I_k = 0\\}\n\\end{align*}\n\\]\n其中最后一个等式利用了 \\(I_1,\\ldots,I_{k - 1}\\) 和 \\(I_k\\) 在 \\(H_0\\) 为真时相互独立的特性。现在 \\(\\sum_{j = 1}^{k - 1}jI_j\\) 与样本大小为 \\(k - 1\\) 时的 符号秩 统计量具有相同的分布，并且由于：\n\\(P_{H_0}\\{I_k = 1\\}=P_{H_0}\\{I_k = 0\\}=\\frac{1}{2}\\)\n所以，有：\n\\[\nP_{k}(i)=\\frac{1}{2}P_{k - 1}(i - k)+\\frac{1}{2}P_{k - 1}(i)\n\\tag{12.8}\\]\n利用 式 12.7 和 式 12.8 给出的递归公式，我们可以一直计算出 \\(P_2(\\cdot)\\)，\\(P_3(\\cdot)\\)，……，直到得到我们所需的 \\(P_n(t^{*})\\)。\n\n例 12.2 对于 例 12.1 中的数据，\n\\(t^* = \\min\\left(3, \\frac{4 \\cdot 5}{2} - 3\\right) = 3\\)\n因此，\\(p-\\text{value}\\) 为 \\(2P_4(3)\\)，其计算如下：\n\\(P_2(0)=\\frac{1}{2}[P_1(-2)+P_1(0)]=\\frac{1}{4}\\)\n\\(P_2(1)=\\frac{1}{2}[P_1(-1)+P_1(1)]=\\frac{1}{2}\\)\n\\(P_2(2)=\\frac{1}{2}[P_1(0)+P_1(2)]=\\frac{3}{4}\\)\n\\(P_2(3)=\\frac{1}{2}[P_1(1)+P_1(3)]=1\\)\n\\(P_3(0)=\\frac{1}{2}[P_2(-3)+P_2(0)]=\\frac{1}{8} \\quad \\because P_2(-3)=0\\)\n\\(P_3(1)=\\frac{1}{2}[P_2(-2)+P_2(1)]=\\frac{1}{4}\\)\n\\(P_3(2)=\\frac{1}{2}[P_2(-1)+P_2(2)]=\\frac{3}{8}\\)\n\\(P_3(3)=\\frac{1}{2}[P_2(0)+P_2(3)]=\\frac{5}{8}\\)\n\\(P_4(0)=\\frac{1}{2}[P_3(-4)+P_3(0)]=\\frac{1}{16}\\)\n\\(P_4(1)=\\frac{1}{2}[P_3(-3)+P_3(1)]=\\frac{1}{8}\\)\n\\(P_4(2)=\\frac{1}{2}[P_3(-2)+P_3(2)]=\\frac{3}{16}\\)\n\\(P_4(3)=\\frac{1}{2}[P_3(-1)+P_3(3)]=\\frac{5}{16}\\) \\(\\blacksquare\\)\n\n可以使用 R 来获得检验统计量 \\(T\\) 和 \\(p-\\text{value}\\) 的值。但是需要注意的是，R 并没有直接给出 \\(T\\) 的值，而是给出了 \\(V = n(n+1)/2 - T\\) 的值。为了使用 R 执行 符号秩检验——有时也称为 Wilcoxon 符号秩检验（Wilcoxon signed rank test）——来检验假设：数据集 \\(x_1,...,x_n\\) 关于 \\(m_0\\) 对称，可以执行如下的代码：\nx &lt;- c(x_1, x_2,..., x_n)\nwilcox.test(x, mu = m_0)\nwilcox.test() 将给出检验的 \\(p-\\text{value}\\)，例如，对于 例 12.1 中的数据而言：\n\nx &lt;- c(4.2, 1.8, 5.3, 1.7)\nwilcox.test(x, mu = 2)\n\n\n    Wilcoxon signed rank exact test\n\ndata:  x\nV = 7, p-value = 0.625\nalternative hypothesis: true location is not equal to 2\n\n\n在本节就要结束的时候，我们给出 \\(P_{H_0}\\{T\\geq t\\}=P_{H_0}\\left\\{T\\leq\\frac{n(n + 1)}{2}-t\\right\\}\\) 的证明。\n为了验证上述等式，首先注意到：如果 \\(\\vert Y_1\\vert,\\ldots,\\vert Y_n\\vert\\) 中第 \\(j\\) 小的值来自一个大于 \\(m_0\\) 的数据值，那么 \\(1 - I_j\\) 将等于 \\(1\\)，否则 \\(1 - I_j\\) 将等于 \\(0\\)。因此，如果我们令：\n\\(T^{1}=\\sum_{j = 1}^{n}j(1 - I_j)\\)\n那么 \\(T^{1}\\) 将表示大于 \\(m_0\\) 的数据值的 \\(\\vert Y_j\\vert\\) 的秩之和。根据对称性，在原假设 \\(H_0\\) 为真时，\\(T^{1}\\) 与 \\(T\\) 具有相同的分布。此时：\n\\(T^{1}=\\sum_{j = 1}^{n}j-\\sum_{j = 1}^{n}jI_j=\\frac{n(n + 1)}{2}-T\\)\n所以：\n\\[\n\\begin{align*}\nP\\{T\\geq t\\}&=P\\{T^{1}\\geq t\\} \\quad \\because T\\text{ 和 }T^{1}\\text{ 具有相同分布}\\\\\n&=P\\{\\frac{n(n + 1)}{2}-T\\geq t\\}\\\\\n&=P\\{T\\leq\\frac{n(n + 1)}{2}-t\\}\n\\end{align*}\n\\]",
    "crumbs": [
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>非参数假设检验</span>"
    ]
  },
  {
    "objectID": "chapter_12/12.html#sec-12_4",
    "href": "chapter_12/12.html#sec-12_4",
    "title": "12  非参数假设检验",
    "section": "12.4 双样本问题",
    "text": "12.4 双样本问题\n假设某种具有可测量特性的产品的生产方式有两种不同的方法，我们正在研究这两种不同的生产方法，以确定这两种生产方法所生产的产品是否在统计上是一致的。\n为了解决这个问题，令 \\(X_1, \\ldots, X_n\\) 表示使用方法 1 生产的 \\(n\\)￼个产品的测量值样本，类似地，令 \\(Y_1, \\ldots, Y_m\\)￼表示使用方法 2 生产的 \\(m\\)￼个产品的测量值样本。如果我们令 \\(F\\)￼和 \\(G\\)￼分别表示这两个样本的分布函数，并假设它们都是连续的，那么我们需要检验的假设为：\\(H_0 : F = G\\)。\n可以使用秩和检验（rank sum test）检验——又称为 Mann-Whitney 检验或 Wilcoxon 检验——来检验 \\(H_0\\)。\n\n首先对 \\(n+m\\)￼个数据值 \\(X_1, \\ldots, X_n, Y_1, \\ldots, Y_m\\) 进行排序。\n由于我们假设 \\(F\\)￼和 \\(G\\)￼是连续的，所以不会出现两个相同的测量值，因此排序的结果是唯一的。我们令最小的数据值的秩为 1，次小的数据值的秩为 2，以此类推，第 \\(n+m\\) 小的数据值的秩为 \\(n+m\\)。\n对于 \\(i=1,...,n\\)，令 \\(R_i = \\text{数据值 } X_i \\text{ 的秩}\\)。\n\n秩和检验则利用第一个样本中的数据的秩的总和作为检验统计量 \\(T\\)，即：\\(T = \\sum_{i=1}^n R_i\\)。\n\n例 12.3 为对比两种防腐处理方式的效果，我们设计了一个实验，并对这两种处理下的金属样本进行了对应的测量，测量结果如下：\n\n处理 1：65.2, 67.1, 69.4, 78.2, 74, 80.3\n处理 2：59.4, 72.1, 68, 66.2, 58.5\n\n如上的数据表示金属样本上的腐蚀坑的最大深度，单位为千分之一英寸。我们对数据进行升序排序得到：\n\\(58.5, 59.4, 65.2^*, 66.2, 67.1^*, 68, 69.4^*, 72.1, 74^*, 78.2^*, 80.3^*\\)\n带星号 (*) 的数据表示该数据来自样本 1。因此，检验统计量的值为：\n\\(T = 3 + 5 + 7 + 9 + 10 + 11 = 45\\) \\(\\blacksquare\\)\n\n假设我们希望在显著性水平 \\(\\alpha\\) 下检验 \\(H_0\\)。如果检验统计量 \\(T\\) 的观察值为 \\(T = t\\)，则如果满足 式 12.9，我们就应当拒绝 \\(H_0\\)：\n\\[\nP_{H_0}\\{T \\leq t\\} \\leq \\frac{\\alpha}{2} \\quad \\text{或} \\quad P_{H_0}\\{T \\geq t\\} \\leq \\frac{\\alpha}{2}\n\\tag{12.9}\\]\n也就是说，如果第一组样本的秩的总和 \\(T\\) 的值太小或太大，以至于从随机性角度来解释时他们发生的概率非常小，则应当拒绝假设 \\(H_0\\)。\n对于整数 \\(t\\)：\n\\(P\\{T \\geq t\\} = 1 - P\\{T &lt; t\\} = 1 - P\\{T \\leq t - 1\\}\\)\n根据 式 12.9，可知，在以条件下需要拒绝 \\(H_0\\)：\n\\[\nP_{H_0}\\{T \\leq t\\} \\leq \\frac{\\alpha}{2} \\quad \\text{或} \\quad P_{H_0}\\{T \\leq t - 1\\} \\geq 1 - \\frac{\\alpha}{2}\n\\tag{12.10}\\]\n为了计算 式 12.10 中的概率，设 \\(P(N, M, K)\\) 表示在样本大小分别为 \\(N\\) 和 \\(M\\) 且 \\(H_0\\) 为真时，第一个样本的秩的总和小于或等于 \\(K\\) 的概率。现在我们将推导 \\(P(N, M, K)\\) 的递归公式，这将帮助我们计算所需的概率值：\\(P(n, m, t) = P_{H_0}\\{T \\le t\\}\\) 和 \\(P(n, m, t - 1)\\)。\n在 \\(N\\) 和 \\(M\\) 为样本大小且 \\(H_0\\) 为真时，为了计算第一个样本的秩的总和小于或等于 \\(K\\) 的概率，我们需要考虑这 \\(N+M\\) 个数据中的最大值是来自第一个样本还是来自第二个样本。\n\n如果最大值来自第一个样本，那么第一个样本的秩的总和等于 \\(N+M\\) 加上第一个样本中剩余的 \\(N-1\\) 个值的秩的总和。因此 \\(P(N, M, K)\\) 等价于这 \\(N-1\\) 个值的秩的总和小于或等于 K-(N+M)。但是因为除了最大值外，剩余的 \\(N-1+M\\) 个数据来自同一个分布（当 \\(H_0\\) 为真时），因此，第一个样本中剩余 \\(N-1\\) 个值的秩的总和小于或等于 \\(K-(N+M)\\) 的概率为 \\(P(N-1, M, K-N-M)\\)。\n同样的，如果最大值来自第二个样本，则 \\(P(N, M, K)\\)$ 的值为 P(N, M-1, K)。\n\n此外，由于最大值在所有 \\(N+M\\) 个数据中的概率是相同的，所以最大值来自第一个样本的概率为 \\(\\frac{N}{N+M}\\)，于是我们得到：\n\\[\nP(N, M, K) = \\frac{N}{N+M} P(N-1, M, K - N - M) + \\frac{M}{N+M} P(N, M-1, K)\n\\tag{12.11}\\]\n根据初始条件：\n\\[\nP(1, 0, K) =\n\\begin{cases}\n0 & \\text{若 } K \\leq 0, \\\\\n1 & \\text{若 } K &gt; 0,\n\\end{cases}\n\\quad\nP(0, 1, K) =\n\\begin{cases}\n0 & \\text{若 } K &lt; 0, \\\\\n1 & \\text{若 } K \\geq 0\n\\end{cases}\n\\]\n通过 式 12.11 的递归公式，可以求解 \\(P(n, m, t - 1)\\) 和 \\(P(n, m, t)\\)。\n\n例 12.4 假设我们希望计算 \\(P(2, 1, 3)\\)。我们使用 式 12.11 进行计算：\n\\(P(2, 1, 3) = \\frac{2}{3} P(1, 1, 0) + \\frac{1}{3} P(2, 0, 3)\\)\n\\(P(1, 1, 0) = \\frac{1}{2} P(0, 1, -2) + \\frac{1}{2} P(1, 0, 0) = 0\\)\n\\(P(2, 0, 3) = P(1, 0, 1) = P(0, 0, 0) = 1\\)\n因此，\n\\(P(2, 1, 3) = \\frac{1}{3}\\)\n为了使两个 \\(X\\) 值的秩的总和小于或等于 3，\\(X_1, X_2, Y_1\\) 中最大的值必须是 \\(Y_1\\)。在 \\(H_0\\) 为真的情况下，\\(P(2, 1, 3)\\) 为 \\(\\frac{1}{3}\\)。 \\(\\blacksquare\\)\n\n由于秩和检验要求在以下任一条件成立时拒绝 \\(H_0\\)：\n\\(2P(n, m, t) \\leq \\alpha \\quad \\text{或} \\quad \\alpha \\geq 2[1 - P(n, m, t - 1)]\\)\n因此，当 \\(T = t\\) 时，检验统计量的 \\(p-\\text{value}\\) 为：\n\\(p-\\text{value} = 2 \\min \\{P(n, m, t), 1 - P(n, m, t - 1)\\}\\)\n可以使用 R 语言来获得检验统计量 \\(T\\) 的值（在 R 中称检验统计量为 \\(W\\)）以及对应的 \\(p-\\text{value}\\)。可以按照如下的步骤使用秩和检验（在 R 中称之和检验为 Wilcoxon 秩和检验）来检验数据集 \\(x_1, \\ldots, x_n\\) 和 \\(y_1, \\ldots, y_m\\) 是否来自同一分布：\nx &lt;- c(x1, ..., xn)\ny &lt;- c(y1, ..., ym)\nwilcox.test(x, y)\n如上代码将输出检验的 \\(p-\\text{value}\\)。例如，对于 例 12.3 而言，我们可以得到如下的结果：\n\nx &lt;- c(65.2,67.1,69.4,78.2,74,80.3)\ny &lt;- c(59.4,72.1,68,66.2,58.5)\nwilcox.test(x, y)\n\n\n    Wilcoxon rank sum exact test\n\ndata:  x and y\nW = 24, p-value = 0.1255\nalternative hypothesis: true location shift is not equal to 0\n\n\n\n12.4.1 检验多个概率分布是否一致\n尽管前几节已经介绍了如何检验两个总体分布是否相同，但我们有时会遇到总体个数大于两个的情况。因此，假设有 \\(k\\) 个总体，并且 \\(F_i\\) 表示某个可测量变量在总体 \\(i\\) 上的分布函数，我们希望检验如下的原假设：\n\\(H_0: F_1 = F_2 = \\cdots = F_k \\quad vs \\quad H_1: \\text{并非所有的 } F_i \\text{ 都相等}\\)\n为检验上述原假设，假设从这 \\(k\\) 个总体中独立抽取样本。令 \\(n_i\\) 表示从总体 \\(i\\) 中抽取的样本量 (\\(i = 1, \\ldots, k\\))，并令 \\(N = \\sum_{i=1}^k n_i\\) 表示所有样本的总数。现在，将这 \\(N\\) 个样本值从小到大排序，并令 \\(R_i\\) 表示从总体 \\(i\\) 中抽取的 \\(n_i\\) 个样本值的秩之和 (\\(i = 1, \\ldots, k\\))。\n当 \\(H_0\\) 成立时，任何一个样本值的秩都可能是 \\(1, \\ldots, N\\) 中的任意一个，因此样本值的秩的期望为：\n\\(\\overline{r} = \\frac{1 + 2 + \\cdots + N}{N} = \\frac{N + 1}{2}\\)\n因此，当 \\(H_0\\) 成立时，总体 \\(i\\) 的 \\(n_i\\) 个样本值的秩的总和的期望为：\n\\(E[R_i] = n_i \\bar{r}\\)\n根据拟合优度检验的启发，我们考虑如下的检验统计量：\n\\(T = \\sum_{i=1}^k \\frac{(R_i - n_i \\bar{r})^2}{n_i \\bar{r}}\\)\n当 \\(T\\) 很大时，我们拒绝原假设 \\(H_0\\)。\n\\[\n\\begin{align}\nT &= \\frac{1}{\\bar{r}} \\sum_{i=1}^k \\frac{R_i^2 - 2 R_i n_i \\bar{r} + n_i^2 \\bar{r}^2}{n_i} \\\\\n&=\\frac{1}{\\bar{r}} \\left( \\sum_{i=1}^k \\frac{R_i^2}{n_i} - 2 \\sum_{i=1}^k R_i \\bar{r} + \\bar{r}^2 \\sum_{i=1}^k n_i \\right) \\\\\n&=\\frac{1}{\\bar{r}} \\sum_{i=1}^k \\frac{R_i^2}{n_i} - N \\bar{r}\n\\end{align}\n\\]\n其中，最后一步的推理使用了以下性质：\n\\(\\sum_{i=1}^k R_i = 1 + 2 + \\cdots + N = \\frac{N(N + 1)}{2} = N \\bar{r}\\)\n因此，当 \\(T\\) 很大时拒绝 \\(H_0\\) 等价于当 \\(\\sum_{i=1}^k \\frac{R_i^2}{n_i}\\) 很大时拒绝 \\(H_0\\)。因此，可以将检验统计量定义为：\n\\(TS = \\sum_{i=1}^k \\frac{R_i^2}{n_i}\\)\n为了确定适当的显著性水平 \\(\\alpha\\)，我们需要确定当 \\(H_0\\) 成立时 \\(TS\\) 的分布。虽然 \\(T_S\\) 的确切分布较为复杂，但当 \\(H_0\\) 成立且所有 \\(n_i \\geq 5\\) 时，\\(\\frac{12}{N(N+1)} TS - 3(N+1)\\) 的分布近似为自由度为 \\(k-1\\) 的卡方分布 \\(\\chi^2_{k-1}\\)。因此，在显著性水平 \\(\\alpha\\) 下原假设 \\(H_0\\) 的近似检验是：\n\\(拒绝 H_0 当且仅当：\\frac{12}{N(N+1)} TS - 3(N+1) \\geq \\chi^2_{k-1, \\alpha}\\)\n如上的检验称为 Kruskal-Wallis 检验。\n\n习题 12.3 以下数据为洛杉矶某中等规模的图书馆在周二、周三、周四这三天的连续 10 周的访客数量：\n\n周二访客：721, 660, 622, 738, 820, 707, 672, 589, 902, 688\n周三访客：604, 626, 744, 802, 691, 665, 711, 715, 661, 729\n周四访客：642, 480, 705, 584, 713, 654, 704, 522, 683, 708\n\n这些数据是否支持这三天的访客数量的分布相同的假设？\n\n\n解 12.3. 对 \\(N = 30\\) 个数据进行排序，得到三个样本的秩的总和分别为：\n\\(R_1 = 176, \\quad R_2 = 175, \\quad R_3 = 114\\)\n因此，\n\\(\\frac{12}{N(N+1)} TS - 3(N+1) = \\frac{12}{30 \\cdot 31} \\left(\\frac{176^2}{10} + \\frac{175^2}{10} + \\frac{114^2}{10}\\right) - 93 = 3.254\\)\n由于 \\(\\chi^2_{2, 0.05} = 5.99\\)，因此在 5% 的显著性水平下，不能拒绝原假设 \\(H_0\\)（三天访客数量的分布相同）。\n实际的 \\(p-\\text{value}\\) 为：\n\\(\\text{p-value} = P(\\chi^2 \\geq 3.254) = 1 - \\text{pchisq}(3.254, 2) = 0.1965182\\) \\(\\blacksquare\\)",
    "crumbs": [
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>非参数假设检验</span>"
    ]
  },
  {
    "objectID": "chapter_12/12.html#sec-12_5",
    "href": "chapter_12/12.html#sec-12_5",
    "title": "12  非参数假设检验",
    "section": "12.5 随机性的游程检验",
    "text": "12.5 随机性的游程检验\n统计学中的一个基本假设就是：数据集由某总体的随机样本构成。然而，有时候，数据并非通过真正的随机过程产生，而是可能遵循某种趋势或循环模式。在本节中，我们将考虑一种名为 游程检验（runs test）的检验方法，游程检验 可用于检验给定的数据集是否为随机样本的原假设 \\(H_0\\)。\n假设每个数据的取值要么是 0，要么是 1。也就是说，我们假设每个数据的值可以二分为成功（1）或失败（0）。令 \\(X_1, \\ldots, X_N\\) 表示数据集。任意连续的 1 或 0 的序列称为一个 游程（run）。例如，以下数据集：\n\\(1 \\ 0 \\ 0 \\ 1 \\ 1 \\ 1 \\ 0 \\ 0 \\ 1 \\ 0 \\ 1 \\ 1 \\ 1 \\ 1 \\ 0 \\ 1 \\ 0 \\ 0 \\ 0 \\ 0 \\ 1 \\ 1\\)\n包含 11 个 游程：6 个 1 的 游程 和 5 个 0 的 游程。假设数据集 \\(X_1, \\ldots, X_N\\) 包含 \\(n\\) 个 1 和 \\(m\\) 个 0，其中 \\(n + m = N\\)，令 \\(R\\) 表示 游程 的数量。\n如果 \\(H_0\\) 成立，那么 \\(X_1, \\ldots, X_N\\) 是 \\(n\\) 个 1 和 \\(m\\) 个 0 的所有 \\(N!/(n!m!)\\) 种排列中的任何一种。因此，当 \\(H_0\\) 成立时，游程 数量 \\(R\\) 的概率质量函数为：\n\\(P_{H_0}\\{R = k\\} = \\frac{\\text{使 \\(n\\) 个 \\(1\\) 和 \\(m\\) 个 \\(0\\) 形成 \\(k\\) 个游程的排列数量}}{\\binom{n+m}{n}}\\)\n可以显式确定这些排列的数量，并证明如下公式成立：\n\\[\n\\begin{align}\nP_{H_0}\\{R = 2k\\} &= 2 \\frac{\\binom{m-1}{k-1} \\binom{n-1}{k-1}}{\\binom{m+n}{n}} \\\\\nP_{H_0}\\{R = 2k+1\\} &= \\frac{\\binom{m-1}{k-1} \\binom{n-1}{k}}{\\binom{m+n}{n}} + \\frac{\\binom{m-1}{k} \\binom{n-1}{k-1}}{\\binom{m+n}{n}}\n\\end{align}\n\\tag{12.12}\\]\n如果数据包含 \\(n\\) 个 1 和 \\(m\\) 个 0，游程检验 在观察到的 游程 数量太大或太小以至于无法通过随机性解释时，则会拒绝数据为随机样本的原假设。具体而言，若观察到的 游程 数量为 \\(r\\)，则 游程检验 的 \\(p-\\text{value}\\) 为：\n\\(p-\\text{value} = 2 \\min \\{P_{H_0}\\{R \\geq r\\}, P_{H_0}\\{R \\leq r\\}\\}\\)\n当样本规模不大时，可以使用 式 12.12 来精确的计算出 \\(p-\\text{value}\\)。\n\n例 12.5 以下是某球队最近 30 场比赛的结果，其中 \\(W\\) 表示胜利，\\(L\\) 表示失败。\n\\(W \\, W \\, W \\, L \\, W \\, W \\, L \\, W \\, W \\, L \\, W \\, L \\, W \\, W \\, W \\, W \\, W \\, L \\, W \\, L \\, L \\, W \\, W \\, W \\, L \\, W \\, L \\, W \\, L \\, L\\)\n这些数据是纯随机产生的吗？\n\n\n解 12.4. 为了检验随机性假设，需要注意以下事实：该数据包含 20 次 \\(W\\) 和 10 次 \\(L\\)，并且有 20 个 游程（run）。为了在 5% 的显著性水平下判断是否拒绝数据是纯随机的这一假设，我们可以使用先前的公式计算 \\(p-\\text{value}\\)。经计算，我们得到 \\(p-\\text{value}= 0.01845\\)，因此，在 5% 的显著性水平下，可以拒绝随机性的原假设。\n值得注意的是，这些数据中一个显著的特点是：每当该队输掉一场比赛后，他们总能在下一场比赛中获胜。如果胜利和失败的概率均等，则包含 20 次胜利和 10 次失败的所有结果中，如上数据发生的可能性则非常低。\\(\\blacksquare\\)\n\n当数据值不是 0 和 1 的情况下，我们仍然可以用 游程检验 来检验数据的随机性。为了检验数据 \\(X_1, \\ldots, X_N\\) 是否构成一个随机样本，令 \\(s\\text{-med}\\) 表示样本中位数。同时，令 \\(n\\) 表示小于等于 \\(s\\text{-med}\\) 的数据值的数量，\\(m\\) 表示大于 \\(s\\text{-med}\\) 的数据值的数量。（因此，如果 \\(N\\) 是偶数并且所有数据值互不相同，那么 \\(n\\) = \\(m\\) = \\(N / 2\\)。）\n定义 \\(I_1, \\ldots, I_N\\) 为：\n\\[\nI_j =\n\\begin{cases}\n1, & \\text{如果 } X_j \\leq s\\text{-med} \\\\\n0, & \\text{否则}\n\\end{cases}\n\\]\n如果原始数据构成一个随机样本，那么 \\(I_1, \\ldots, I_N\\) 中的 游程（runs）的数量的概率质量函数如 式 12.12 所示。因此，我们可以使用 游程检验（runs test）对数据值 \\(I_1, \\ldots, I_N\\) 进行检验，以判断原始数据是否是随机数据。\n\n例 12.6 某电池生产线上连续生产的 19 块电池的寿命如下：\n\\(145, 152, 148, 155, 176, 134, 184, 132, 145, 162, 165, 185, 174, 198, 179, 194, 201, 169, 182\\)\n样本的中位数是第 10 个最小的值——即 169。根据数据值是小于等于还是大于 169，可得到如下数据：\n\\(1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 0\\)\n因此，游程（runs）的数量为 8。根据 ?eq-_12_5_1，可得：\n\\(p\\text{-value} = 0.357\\)\n因此，我们接受数据是随机数据的假设。\\(\\blacksquare\\)\n\n当 \\(n\\) 和 \\(m\\) 都很大并且原假设 \\(H_0\\) 成立时，游程 数量 \\(R\\) 近似服从正态分布并且其均值、标准差分别为：\n\\[\n\\begin{align}\n\\mu &= \\frac{2nm}{n + m} + 1 \\\\\n\\sigma &= \\sqrt{\\frac{2nm(2nm - n - m)}{(n + m)^2(n + m - 1)}}\n\\end{align}\n\\tag{12.13}\\]\n因此，当 \\(n\\) 和 \\(m\\) 都很大时，\n\\[\n\\begin{align}\nP_{H_0}\\{R \\leq r\\} &= P_{H_0}\\left\\{\\frac{R - \\mu}{\\sigma} \\leq \\frac{r - \\mu}{\\sigma}\\right\\} \\\\\n&\\approx P\\left\\{Z \\leq \\frac{r - \\mu}{\\sigma}\\right\\}, \\quad Z \\sim N(0, 1) \\\\\n&= \\Phi\\left(\\frac{r - \\mu}{\\sigma}\\right)\n\\end{align}\n\\]\n因此，\\(P_{H_0}\\{R \\geq r\\} \\approx 1 - \\Phi\\left(\\frac{r - \\mu}{\\sigma}\\right)\\)\n因此，当 \\(n\\) 和 \\(m\\) 都很大时，游程检验 的 \\(p-\\text{value}\\) 近似为：\n\\(\\text{p-value} \\approx 2 \\min \\left\\{\\Phi\\left(\\frac{r - \\mu}{\\sigma}\\right), 1 - \\Phi\\left(\\frac{r - \\mu}{\\sigma}\\right)\\right\\}\\)\n其中，\\(\\mu\\) 和 \\(\\sigma\\) 的值由 式 12.13 给出，\\(r\\) 是观测到的 游程 数量。\n\n例 12.7 假设一个序列包含 60 个 1 和 60 个 0，该序列中的 游程（runs）数量为 75。由于\n\\(\\mu = 61, \\quad \\sigma = \\sqrt{\\frac{3540}{119}} = 5.454\\)\n因此，\\(p-\\text{value}\\) 近似为：\n\\[\n\\begin{align}\np\\text{-value} &\\approx 2 \\min\\{\\Phi(2.567), 1 - \\Phi(2.567)\\} \\\\\n&= 2 \\times (1 - 0.9949) \\\\\n&= 0.0102\n\\end{align}\n\\]\n另一方面，可以证明，\\(p-\\text{value}\\) 的精确值为：\n\\(p\\text{-value} = 0.0130\\)\n如果 游程（runs）数量不是 75，而是 70，那么 \\(p-\\text{value}\\) 的近似值将为：\n\\(p\\text{-value} \\approx 2[1 - \\Phi(1.650)] = 0.0990\\)\n而 \\(p-\\text{value}\\) 的精确值为：\n\\(p\\text{-value} = 0.1189\\) \\(\\blacksquare\\)",
    "crumbs": [
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>非参数假设检验</span>"
    ]
  },
  {
    "objectID": "chapter_12/12.html#problems",
    "href": "chapter_12/12.html#problems",
    "title": "12  非参数假设检验",
    "section": "Problems",
    "text": "Problems",
    "crumbs": [
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>非参数假设检验</span>"
    ]
  },
  {
    "objectID": "chapter_13/13.html",
    "href": "chapter_13/13.html",
    "title": "13  质量控制",
    "section": "",
    "text": "13.1 Introduction\n几乎每个工厂在生产产品的 过程 中都会存在某些 随机变异（variation）。也就是说，无论生产 过程 控制得多么严格，生产出的产品之间总会存在一些 差异（variation）。我们称这种 差异（variation）为 随机变异（chance variation），并且我们认为这种 差异（variation）是生产 过程 本身所固有的。\n然而，在生产 过程 中，还存在另一种类型的 差异（variation），这种 差异（variation）不是生产 过程 本身所固有的，而是由某些 特定原因（assignable cause）引起的，并且通常这些 特定原因（assignable cause）会对产品质量产生不利影响。例如，这种 差异（variation）可能是由机器错误的设置、原材料质量较差、错误的软件、人为错误或其他更多的可能性所导致。当产品表现出的 差异（variation）仅由 随机原因（chance cause）而不是 特定原因（assignable cause）导致时，我们称生产 过程 是 受控（in control）的。\n我们需要解决的一个关键问题就是：确定某个生产 过程 是 受控（in control） 的还是 失控（out of control）的。\n我们可以使用 控制图（control charts）来简化确定一个 过程 是 受控 还是 失控。控制图 由两个数字来确定：上控制限（the upper control limits）和 下控制限（the lower control limits）。为了使用 控制图，我们需要把制造 过程 生成的数据分为若干子组，并计算每个子组的统计量（例如，每个子组的平均值和标准差）。当子组的统计量超出 上下控制限 时，我们会认为 过程 是 失控 的。",
    "crumbs": [
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>质量控制</span>"
    ]
  },
  {
    "objectID": "chapter_13/13.html#sec-13_1",
    "href": "chapter_13/13.html#sec-13_1",
    "title": "13  质量控制",
    "section": "",
    "text": "对过程的解释\n\n\n\n在质量控制领域，我们将 process 译作 过程，以强调一系列活动的内在关联性。过程指为了达到某个目标而执行的一系列操作或阶段，这种操作可以是动态的、复杂的，具有系统性和整体性，例如：生产过程、加工过程……\n\n\n\n\n\n\n\n在 小节 13.2 和 小节 13.3 节中，我们假设连续生产的产品具有某些可测量的特性，当 过程 受控 时，产品的这些特性数据的均值和方差是固定的。我们将会介绍如何基于子组平均值（小节 13.2 节）和子组标准差（小节 13.3 节）构建控制图。\n在 小节 13.4 中，我们假设产品不具有某种可测量特性，此时，我们通过某种 属性（attribute）将产品分类为“合格”或“不合格”，进而判断产品是否合格。然后我们将展示如何构建 控制图（control charts）以指示产品质量的变化。\n在 小节 13.5 中，我们将考虑具有随机缺陷数量情况下的 控制图。\n最后，在 小节 13.6 中，我们将讨论更复杂的 控制图——不仅单独考虑每个子组的数据值，还会综合考虑其他子组的数据值。这类控制图包括三种不同的类型：移动平均控制图（moving average control chart）、指数加权移动平均控制图（exponential weighted moving average control chart）和 累积和控制图（cumulative sum control chart）。",
    "crumbs": [
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>质量控制</span>"
    ]
  },
  {
    "objectID": "chapter_13/13.html#sec-13_2",
    "href": "chapter_13/13.html#sec-13_2",
    "title": "13  质量控制",
    "section": "13.2 基于平均值构建控制图：\\(\\overline{x}\\) 控制图",
    "text": "13.2 基于平均值构建控制图：\\(\\overline{x}\\) 控制图\n假设当 过程 处于 受控 状态时，连续生产的产品在某个可测特性上的观测数据是独立的、并且服从均值为 \\(\\mu\\)、方差为 \\(\\sigma^2\\) 的正态分布。然而，由于特殊情况，该 过程 可能会失控并且生产出的产品在可观测特性上的数据开始具有不同分布。我们希望能够识别出这种失控的情况，以便停止 过程、找出问题所在、并加以修复。\n令 \\(X_1, X_2, \\dots\\) 表示连续生产的产品的可测量特性。为了确定 过程 何时失控，我们将数据分成固定大小（记作 \\(n\\)）的子组。固定大小 \\(n\\) 的选择必须确保各子组内数据的一致性。例如，可以选择 \\(n\\) 以使得各子组内的所有产品都是在同一天、同一批次或同一设置下所生产的。换句话说，\\(n\\) 的具体值的选择，需要使得数据分布的变化更可能的发生在子组之间，而不是子组内部。\\(n\\) 的典型的取值为 4、5 或 6。\n令 \\(\\overline{X}_i, i = 1,2,...\\) 表示第 \\(i\\) 个子组的平均值，即\n\\[\n\\begin{aligned}\n\\overline{X}_1 &= \\frac{X_1 + \\cdots + X_n}{n} \\\\\n\\overline{X}_2 &= \\frac{X_{n+1} + \\cdots + X_{2n}}{n}\\\\\n\\overline{X}_3 &= \\frac{X_{2n+1} + \\cdots + X_{3n}}{n} \\\\\n\\qquad \\qquad & \\qquad\\vdots\n\\end{aligned}\n\\]\n当 过程 受控时，每个 \\(X_i\\) 的均值为 \\(\\mu\\) 且方差为 \\(\\sigma^2\\)，因此可得：\n\\[\n\\begin{aligned}\nE(\\overline{X}_i) &= \\mu \\\\\n\\text{Var}(\\overline{X}_i) &= \\frac{\\sigma^2}{n}\n\\end{aligned}\n\\]\n因此\n\\[\n\\frac{\\overline{X}_i - \\mu}{\\sqrt{\\sigma^2 / n}} \\sim \\mathcal{N}(0, 1)\n\\]\n也就是说，过程 连续生产的产品中，如果第 \\(i\\) 个子组中的产品始终处于受控状态，那么随机变量 \\(\\sqrt{n} \\frac{\\overline{X}_i - \\mu}{\\sigma}\\) 服从标准正态分布。因此，标准正态随机变量 \\(Z\\) 几乎总是位于 \\(-3\\) 和 \\(+3\\) 之间。（实际上，\\(P\\{-3 &lt; Z &lt; 3\\} = 0.9973\\)。）因此，如果 过程 在连续生产的产品中，第 \\(i\\) 个子组的产品始终处于受控状态，那么我们一定可以期望得到：\n\\[\n-3 &lt; \\sqrt{n} \\frac{\\overline{X}_i - \\mu}{\\sigma} &lt; 3\n\\]\n即，\n\\[\n\\mu - \\frac{3\\sigma}{\\sqrt{n}} &lt; \\overline{X}_i &lt; \\mu + \\frac{3\\sigma}{\\sqrt{n}}\n\\]\n我们称\n\\[\n\\begin{aligned}\n\\text{UCL} &\\equiv \\mu + \\frac{3\\sigma}{\\sqrt{n}} \\\\\n\\text{LCL} &\\equiv \\mu - \\frac{3\\sigma}{\\sqrt{n}}\n\\end{aligned}\n\\]\n分别为 上控制限（upper control limits）和 下控制限（lower control limit）。\n\\(\\overline{X}\\) 控制图的作用是检测产品的平均值是否发生变化，其方法是绘制连续子组的平均值 \\(\\overline{X}_i\\)，并在 \\(\\overline{X}_i\\) 第一次落在 \\(\\text{LCL}\\) 和 \\(\\text{UCL}\\) 之外时，判断 过程 已经失控（见 图 13.1）。\n\n习题 13.1 某厂商生产的钢轴直径应服从均值为 3mm、标准差为 0.1mm 的正态分布。连续抽取钢轴样本、并且以 4 个钢轴为一组得到 10 个子组的样本均值（单位：mm）数据如下：\n\n\n\n样本编号\n\\(\\overline{X}\\)\n\n\n\n\n\n1\n3.01\n\n\n\n2\n2.97\n\n\n\n3\n3.12\n\n\n\n4\n2.99\n\n\n\n5\n3.03\n\n\n\n6\n3.02\n\n\n\n7\n3.10\n\n\n\n8\n3.14\n\n\n\n9\n3.09\n\n\n\n10\n3.20\n\n\n\n\n根据如上的数据，我们应得出什么结论？\n\n\n解 13.1. 当 过程 处于受控状态时，连续生产的钢轴直径服从均值 \\(\\mu = 3\\)、标准差 \\(\\sigma = 0.1\\) 的正态分布。因此，当 \\(n = 4\\) 时：\n\\[\n\\begin{aligned}\n\\text{LCL} &= 3 - \\frac{3(0.1)}{\\sqrt{4}} = 2.85 \\\\\n\\text{UCL} &= 3 + \\frac{3(0.1)}{\\sqrt{4}} = 3.15\n\\end{aligned}\n\\]\n由于第 10 子组的样本平均值大于 上控制限（UCL），因此可以怀疑钢轴的平均直径已经不再是 3mm。（显然，从第 6 到第 10 子组样本的结果来看，其平均直径看起来已经超过了 3mm。）\n\n\n\n代码\nlibrary(ggplot2)\n\nx &lt;- c(3.01, 2.97, 3.12, 2.99, 3.03, 3.02, 3.10, 3.14, 3.09, 3.20)\ni &lt;- seq_along(x)\ndf &lt;- data.frame(i=i, x=x)\n\nmu &lt;- 3       # 均值\nsigma &lt;- 0.1  # 标准差\nn &lt;- 4        # 子组样本量\nUCL &lt;- mu + 3 * sigma / sqrt(n)  # 上控制限\nLCL &lt;- mu - 3 * sigma / sqrt(n)  # 下控制限\n\nggplot(df, aes(x = i, y = x)) +\n  geom_point(shape = 4, size = 2) +  # 绘制均值点\n  #geom_line(aes(group = 1), color = \"black\") +  # 连接均值点的线\n  geom_hline(yintercept = UCL, color = \"blue\", linetype = \"dashed\", size = 1) +  # 上控制限\n  geom_hline(yintercept = LCL, color = \"blue\", linetype = \"dashed\", size = 1) +  # 下控制限\n  geom_hline(yintercept = mu, color = \"gray\", linetype = \"dotted\", size = 1) +  # 中心线\n  annotate(\"text\", x = 11, y = UCL, label = \"UCL\", hjust = 0, vjust = -0.5, color = \"blue\") +  # 标注UCL\n  annotate(\"text\", x = 11, y = LCL, label = \"LCL\", hjust = 0, vjust = 1.5, color = \"blue\") +  # 标注LCL\n  annotate(\"text\", x = 10, y = x[10], label = \"Out of control\", hjust = -0.2, vjust = -0.5, color = \"black\") +  # 标注失控点\n  geom_point(data=df[10, ], aes(x = i, y = x), color = \"red\", shape = 4, size = 4) +  # 突出显示失控点\n  labs(title = \"Control Chart\", x = \"Subgroup\", y = expression(bar(X))) +  # 添加标题和轴标签\n  scale_x_continuous(limits = c(1, 12),\n                     breaks = seq(1, 10, by = 1)) + \n  theme_minimal()  # 使用简洁主题\n\n\n\n\n\n\n\n\n图 13.1: \\(\\overline{X}\\) 的控制图，其中 \\(n = 4\\)\n\n\n\n\n\n\n\n\n\n\n\n备注\n\n\n\n\n在如上的控制图中，我们假定当 过程 处于受控状态时，数据分布服从正态分布。然而，根据中心极限定理（小节 6.3），即使数据分布不服从正态分布，各子组均值的分布也应大致服从正态分布。因此，各子组均值也不太可能偏离其平均值 的 3 个标准差。\n通常情况下，我们并不能确定所有生产产品的可测量质量，因此只能通过随机选择的产品来确定 过程 的质量。因此，我们自然的会选择同时生产的产品作为一个子组。\n\n需要注意的是，即使 过程 处于受控状态，子组均值也有概率位于控制界限之外，以 习题 13.1 的数据为例，位于控制界限之外的概率是 0.0027。因此，我们可能会错误地停止 过程 并去寻找那些本来就不存在的问题源。\n假设 过程 刚刚失控，并且测量数据的均值从 \\(\\mu\\) 变为 \\(\\mu + a\\)，其中 \\(a &gt; 0\\)。如果之后没有进一步变化，那么需要多长时间才能从控制图上观察到 过程 已经失控？为了回答这个问题，子组均值落在控制界限内的条件是：\n\\(-3 &lt; \\sqrt{n} \\frac{\\overline{X} - \\mu}{\\sigma} &lt; 3\\)\n即，\n\\(-3 - \\frac{a \\sqrt{n}}{\\sigma} &lt; \\sqrt{n} \\frac{\\overline{X} - \\mu}{\\sigma} - \\frac{a\\sqrt{n}}{\\sigma} &lt; 3 - \\frac{a \\sqrt{n}}{\\sigma}\\)\n所以，\n\\(-3 - \\frac{a \\sqrt{n}}{\\sigma} &lt; \\sqrt{n} \\frac{\\overline{X} - \\mu - a}{\\sigma} &lt; 3 - \\frac{a \\sqrt{n}}{\\sigma}\\)\n因此，子组均值 \\(\\overline{X}\\) 服从均值为 \\(\\mu + a\\)、方差为 \\(\\sigma^2 / n\\) 的正态分布。因此，\n\\(\\sqrt{n}\\frac{\\overline{X} - \\mu - a}{\\sigma}\\) 服从标准正态分布，其落在控制界限内的概率为：\n\\[\n\\begin{aligned}\nP \\left\\{ -3 - \\frac{a \\sqrt{n}}{\\sigma} &lt; Z &lt; 3 - \\frac{a \\sqrt{n}}{\\sigma} \\right\\} &= \\Phi \\left( 3 - \\frac{a \\sqrt{n}}{\\sigma} \\right) - \\Phi \\left( -3 - \\frac{a \\sqrt{n}}{\\sigma} \\right) \\\\\n&\\approx \\Phi \\left( 3 - \\frac{a \\sqrt{n}}{\\sigma} \\right)\n\\end{aligned}\n\\]\n因此，落在控制界限外的概率约为：\n\\(1 - \\Phi \\left( 3 - \\frac{a \\sqrt{n}}{\\sigma} \\right)\\)\n例如，如果子组大小 \\(n = 4\\)，均值增加 \\(1\\) 个标准差，即 \\(a = \\sigma\\)，那么子组均值落在控制界限之外的概率为：\n\\(1 - \\Phi(1) \\approx 0.1587\\)\n由于每个子组均值落在控制界限之外都是相互独立的，切其概率为 \\(1 - \\Phi \\left( 3 - \\frac{a \\sqrt{n}}{\\sigma} \\right)\\)，因此检测到此变化所需的子组数量服从几何分布，其均值为：\n\\(\\left[ 1 - \\Phi \\left( 3 - \\frac{a \\sqrt{n}}{\\sigma} \\right) \\right]^{-1}\\)\n在 \\(n = 4\\) 的情况下，如果均值变化为 1 个标准差，为检测均值发生 1 个标准差变化，需要绘制的子组数量服从几何分布，其均值为：\n\\(\\frac{1}{0.1587} \\approx 6.301\\)。\n\n\n\n13.2.1 \\(\\mu\\)、\\(\\sigma\\) 未知的场景\n如果我们刚开始使用控制图，并且没有可靠的历史数据，那么 \\(\\mu\\) 和 \\(\\sigma\\) 则都是未知的。此时，我们需要估计 \\(\\mu\\) 和 \\(\\sigma\\)。为此，我们使用 \\(k\\) 个子组，其中 \\(k\\) 应满足 \\(k \\geq 20\\) 且 \\(nk \\geq 100\\)。如果 \\(\\overline{X}_i,\\ i = 1, \\ldots, k\\) 是第 \\(i\\) 个子组的平均值，那么可以通过这些子组平均值的均值 \\(\\overline{\\overline{X}}\\) 来估计 \\(\\mu\\)，即：\n\\[\n\\overline{\\overline{X}} = \\frac{\\overline{X}_1 + \\cdots + \\overline{X}_k}{k}\n\\]\n为了估计 \\(\\sigma\\)，令 \\(S_i\\) 表示第 \\(i\\) 个子组的样本标准差，其中 \\(i = 1, \\ldots, k\\)。即：\n\\[\n\\begin{aligned}\nS_1 &= \\sqrt{\\frac{\\sum_{i=1}^n (X_i - \\overline{X}_1)^2}{n-1}} \\\\\nS_2 &= \\sqrt{\\frac{\\sum_{i=1}^n (X_{n+i} - \\overline{X}_2)^2}{n-1}} \\\\\n\\quad & \\quad \\vdots \\\\\nS_k &= \\sqrt{\\frac{\\sum_{i=1}^n (X_{(k-1)n+i} - \\overline{X}_k)^2}{n-1}}\n\\end{aligned}\n\\]\n令：\n\\[\n\\overline{S} = \\frac{S_1 + \\cdots + S_k}{k}\n\\]\n统计量 \\(\\overline{S}\\) 并不是 \\(\\sigma\\) 的无偏估计，即 \\(E[\\overline{S}] \\neq \\sigma\\)。为了将 \\(\\overline{S}\\) 转化为无偏估计，我们首先计算 \\(E[\\overline{S}]\\)：\n\\[\nE[\\overline{S}] = \\frac{E[S_1] + \\cdots + E[S_k]}{k} = E[S_1]\n\\tag{13.1}\\]\n最后一个等式成立是因为 \\(S_1, \\ldots, S_k\\) 是独立且同分布的（因此具有相同的均值）。为了计算 \\(E[S_1]\\)，我们需要用到 定理 6.2 中的正态分布样本的基本概念，即：\n\\[\n(n-1)\\frac{S_1^2}{\\sigma^2} = \\sum_{i=1}^n \\frac{(X_i - \\overline{X}_1)^2}{\\sigma^2} \\sim \\chi^2_{n-1}\n\\tag{13.2}\\]\n现在可以证明（参见习题 3）：\n\\[\nE[\\sqrt{Y}] = \\frac{\\sqrt{2}\\Gamma(n/2)}{\\Gamma(\\frac{n-1}{2})}, \\quad \\text{当} \\, Y \\sim \\chi^2_{n-1}\n\\tag{13.3}\\]\n由于\n\\[\nE\\left[\\sqrt{(n-1)S^2/\\sigma^2}\\right] = \\sqrt{n-1}E[S_1]/\\sigma\n\\]\n根据 式 13.2 和 式 13.3，我们可以得出：\n\\[\nE[S_1] = \\frac{\\sqrt{2}\\Gamma(n/2)\\sigma}{\\sqrt{n-1}\\Gamma(\\frac{n-1}{2})}\n\\]\n因此，如果定义\n\\[\nc(n) = \\frac{\\sqrt{2}\\Gamma(n/2)}{\\sqrt{n-1}\\Gamma(\\frac{n-1}{2})}\n\\]\n则根据 式 13.1，可以推导出 \\(\\overline{S}/c(n)\\) 是 \\(\\sigma\\) 的无偏估计量。\n表 13.1 展示了从 \\(n=2\\) 到 \\(n=10\\) 的 \\(c(n)\\) 的值。\n\n\n\n表 13.1: \\(c(n)\\) 的值\n\n\n\n\n\nc(2)\n0.7978849\n\n\nc(3)\n0.8862266\n\n\nc(4)\n0.9213181\n\n\nc(5)\n0.9399851\n\n\nc(6)\n0.9515332\n\n\nc(7)\n0.9593684\n\n\nc(8)\n0.9650309\n\n\nc(9)\n0.9693103\n\n\nc(10)\n0.9726596\n\n\n\n\n\n\n\n\n\n\n\n\n技术说明\n\n\n\n在计算 表 13.1 中的数值时，\\(\\Gamma(n/2)\\) 和 \\(\\Gamma\\left(n - \\frac{1}{2}\\right)\\) 的计算基于我们在 ?sec-5_7 中已经构建的递归公式：\n\\[\n\\Gamma(a) = (a - 1)\\Gamma(a - 1)\n\\]\n递归公式表明，对于整数 \\(n\\)，有：\n\\[\n\\begin{aligned}\n\\Gamma(n) &= (n - 1)(n - 2) \\cdots 3 \\cdot 2 \\cdot 1 \\cdot \\Gamma(1) \\\\\n&= (n - 1)! \\quad \\because \\quad \\Gamma(1) = \\int_{0}^{\\infty} e^{-x} \\, dx = 1\n\\end{aligned}\n\\]\n类似的，我们可得到如下的递归公式：\n\\[\n\\Gamma\\left(\\frac{n + 1}{2}\\right) = \\left(\\frac{n - 1}{2}\\right)\\left(\\frac{n - 3}{2}\\right)\\cdots\\frac{3}{2} \\cdot \\frac{1}{2} \\cdot \\Gamma\\left(\\frac{1}{2}\\right)\n\\]\n\\[\n\\begin{aligned}\n\\Gamma\\left(\\frac{1}{2}\\right) &= \\int_{0}^{\\infty} e^{-x} x^{-1/2} \\, dx \\\\\n&= \\int_{0}^{\\infty} e^{-y^2/2} \\frac{\\sqrt{2}}{y} \\, y \\, dy \\quad \\text{by } x = \\frac{y^2}{2}, \\, dx = y \\, dy \\\\\n&= \\sqrt{2} \\int_{0}^{\\infty} e^{-y^2/2} \\, dy \\\\\n&= 2\\sqrt{\\pi} \\cdot \\frac{1}{\\sqrt{2\\pi}} \\int_{0}^{\\infty} e^{-y^2/2} \\, dy \\\\\n&= 2\\sqrt{\\pi} \\cdot P[N(0, 1) &gt; 0] \\\\\n&= \\sqrt{\\pi}\n\\end{aligned}\n\\]\n\n\n本节所述的对 \\(\\mu\\) 和 \\(\\sigma\\) 的估计用到了所有的 \\(k\\) 个子组，因此，只有当整个 过程 都处于受控状态时才是合理的。为了检验这一点，我们基于 \\(\\mu\\) 和 \\(\\sigma\\) 的估计值来计算 控制限（the control limits），即：\n\\[\n\\begin{aligned}\n\\text{LCL} & = \\overline{\\overline{X}}-\\frac{3\\overline{S}}{c(n)\\sqrt{n}} \\\\\n\\text{UCL} & = \\overline{\\overline{X}}+\\frac{3\\overline{S}}{c(n)\\sqrt{n}}\n\\end{aligned}\n\\tag{13.4}\\]\n接下来，我们检查每个子组的平均值 \\(\\overline{X}_i\\) 是否落在上下控制限之间。我们删除那些平均值未落在控制限内的子组（假设 过程 暂时失控），然后重新计算 \\(\\mu\\) 和 \\(\\sigma\\) 的估计值。然后，我们再次检查所有剩余子组的平均值是否都位于控制限之间。如果还存在子组的的平均值未落在控制限内，删除这些子组，如此反复。当然，如果有过多的子组平均值落在控制限之外，就表明 过程 尚未处于受控状态。\n\n习题 13.2 对于 习题 13.1 而言，假设该 过程 刚刚开始，因此均值 \\(\\mu\\) 和标准差 \\(\\sigma\\) 是未知的。在这种场景下，我们重新来考虑下 习题 13.1。此时，假设样本标准差如下所示：\n\n\n\n\n\\(\\overline{X}\\)\n\\(S\\)\n\n\\(\\overline{X}\\)\n\\(S\\)\n\n\n\n\n1\n3.01\n0.12\n6\n3.02\n0.08\n\n\n2\n2.97\n0.14\n7\n3.10\n0.15\n\n\n3\n3.12\n0.08\n8\n3.14\n0.16\n\n\n4\n2.99\n0.11\n9\n3.09\n0.13\n\n\n5\n3.03\n0.09\n10\n3.20\n0.16\n\n\n\n因为 \\(\\overline{\\overline{X}} = 3.067\\)，\\(\\overline{S} = 0.122\\)，\\(c(4) = 0.9213\\)，控制限为：\n\\(\\text{LCL} = 3.067 - \\frac{3 \\times 0.122}{2 \\times 0.9213} = 2.868\\) \\(\\text{UCL} = 3.067 + \\frac{3 \\times 0.122}{2 \\times 0.9213} = 3.266\\)\n由于所有的 \\(\\overline{X}_i\\) 均落在控制限内，因此我们假设该 过程 处于控制状态，且均值为 \\(\\mu = 3.067\\)，标准差为：\\(\\sigma = \\frac{\\overline{S}}{c(4)} = 0.1324\\)。\n假设该生产线生产的产品的规格应该为 \\(3 \\pm 0.1\\)。假设该 过程 保持处于受控状态，且上述数据是对真实均值和标准差的准确估计，计算满足规格的产品的比例？\n\n\n解 13.2. 在 \\(\\mu = 3.067\\)，\\(\\sigma = 0.1324\\) 下，我们有：\n\\[\n\\begin{align}\nP\\{2.9 \\leq X \\leq 3.1\\} &= P\\left\\{ \\frac{2.9 - 3.067}{0.1324} \\leq \\frac{X - 3.067}{0.1324} \\leq \\frac{3.1 - 3.067}{0.1324} \\right\\} \\\\\n&= \\Phi(0.2492) - \\Phi(-1.2613) \\\\\n&= 0.5984 - 0.1036 \\\\\n&= 0.4948\n\\end{align}\n\\]\n因此，满足规格要求的产品比例为 49%。\\(\\blacksquare\\)\n\n\n\n\n\n\n\n备注\n\n\n\n1.\n估计量 \\(\\overline{\\overline{X}}\\) 等于所有 \\(nk\\) 个测量值的平均值，因此，显然，\\(\\overline{\\overline{X}}\\) 是 \\(\\mu\\) 的估计量。然而，为什么不直接使用所有 \\(nk\\) 个测量值的样本标准差（如下式所示）作为 \\(\\sigma\\) 的初始估计量可能并不直观：\n\\(S \\equiv \\sqrt{\\frac{\\sum_{i=1}^{nk} \\left( X_i - \\overline{\\overline{X}} \\right)^2}{nk - 1}}\\)\n主要的原因在于：过程 在前 \\(k\\) 个子组期间可能并非始终处于受控状态，因此如上式所示的估计量可能与真实值之间相差甚远。此外，一个 过程 可能会由于某些突发事件而失控，从而导致均值 \\(\\mu\\) 发生变化，而标准差却保持不变。在这种情况下，各子组的样本标准差仍然可以作为 \\(\\sigma\\) 的估计量，而 \\(S\\) 却不能。\n即使整个 过程 看似均处于受控状态，\\(\\sigma\\) 的无偏估计量 \\(\\frac{\\overline{S}}{c(n)}\\) 仍然要优于样本标准差 \\(S\\)。这是因为：我们不能确定在此期间均值终没有发生变化。例如，即使所有子组均值都落在控制限内，我们判断该 过程 处于受控状态，但这并不能保证不存在某些特定原因导致的差异（这些特定原因导致的差异可能导致均值发生变化，但这些变化尚未在图表中体现出来）。这意味着在实际操作中，即使假设 过程 处于受控状态并持续生产产品，我们也需要认识到可能会存在某些特定原因导致的差异。由此认为，\\(\\frac{\\overline{S}}{c(n)}\\) 是一个比样本标准差更“安全”的估计量。换句话说，当 过程 始终受控时，\\(\\frac{\\overline{S}}{c(n)}\\) 的表现可能不如样本标准差好；但如果均值存在些微小变化，\\(\\frac{\\overline{S}}{c(n)}\\) 的表现会比样本标准差要好很多。\n2.\n以前，我们常使用基于子组极差（subgroup ranges）——即子组中最大值与最小值之差来作为 \\(\\sigma\\) 的估计量。这种方法的目的主要是简化必要的计算量（显然，计算极差比计算子组的样本标准差要容易得多）。然而，随着现代计算机能力的增强，计算量已经不再是一个需要考虑的限制因素。此外，标准差估计量的方差比极差估计量的方差更小，并且鲁棒性也更好（即使背后的数据分布不是正态分布，标准差估计量仍能提供合理的总体标准差估计）。因此，在本书中，我们不考虑极差估计量。",
    "crumbs": [
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>质量控制</span>"
    ]
  },
  {
    "objectID": "chapter_13/13.html#sec-13_3",
    "href": "chapter_13/13.html#sec-13_3",
    "title": "13  质量控制",
    "section": "13.3 \\(\\text{S}\\)-控制图",
    "text": "13.3 \\(\\text{S}\\)-控制图\n小节 13.2 中介绍的基于 \\(\\overline{X}\\) 的控制图主要用于检测总体均值的变化。但有时候，我们也需要关注总体方差可能发生变化的情况下，此时可以使用 \\(\\text{S}\\)-控制图。\n假设 过程 在受控状态下所生产的产品具有可测量的特性，这些特性服从均值为 \\(\\mu\\)、方差为 \\(\\sigma^2\\) 的正态分布。若 \\(S_i\\) 是第 \\(i\\) 个子组的样本标准差，则：\n\\(S_i = \\sqrt{\\frac{\\sum_{j=1}^n \\left( X_{(i-1)n+j} - \\overline{X}_i \\right)^2}{n-1}}\\)\n如 小节 13.2.1 所述：\n\\[\nE[S_i] = c(n)\\sigma\n\\tag{13.5}\\]\n此外，\\(S_i\\) 的方差为：\n\\[\n\\begin{align}\n\\text{Var}(S_i) &= E[S_i^2] - \\left(E[S_i]\\right)^2 \\\\\n&= \\sigma^2 - c^2(n)\\sigma^2 \\\\\n&= \\sigma^2[1 - c^2(n)]\n\\end{align}\n\\tag{13.6}\\]\n当 过程 处于受控状态时，\\(S_i\\) 服从一个常数（\\(\\sigma / \\sqrt{n-1}\\)）乘以一个自由度为 \\(n-1\\) 的卡方随机变量的平方根（\\(\\sqrt{\\chi^2_{n-1}}\\)）的分布（\\(\\frac{\\sigma}{\\sqrt{n-1}}\\sqrt{\\chi^2_{n-1}}\\)）。\n可以证明，\\(S_i\\) 落在其均值 3 个标准差范围内的概率接近于 1，即：\n\\(P\\{E[S_i] - 3\\sqrt{\\text{Var}(S_i)} &lt; S_i &lt; E[S_i] + 3\\sqrt{\\text{Var}(S_i)}\\} \\approx 0.99\\)\n因此，利用 式 13.5 和 式 13.6 中的 \\(E[S_i]\\) 和 \\(\\text{Var}(S_i)\\)，\\(\\text{S}\\)-控制图的上、下控制限可以设置为：\n\\[\n\\begin{align}\n\\text{UCL} &= \\sigma \\left[c(n) + 3\\sqrt{1 - c^2(n)}\\right] \\\\\n\\text{LCL} &= \\sigma \\left[c(n) - 3\\sqrt{1 - c^2(n)}\\right]\n\\end{align}\n\\tag{13.7}\\]\n在图中连续绘制 \\(S_i\\)，以确认 \\(S_i\\) 是否落在上、下控制限之内。当某个 \\(S_i\\) 落在控制限之外时，应该停止 过程，并认为该 过程 已经处于失控状态。\n当我们从起始阶段开始绘制控制图时，\\(\\sigma\\) 还是未知的，此时可以使用 \\(\\overline{S}/c(n)\\) 来估计 \\(\\sigma\\)。基于 式 13.7，估计的控制限为：\n\\[\n\\begin{align}\n\\text{UCL} &= \\overline{S} \\left[1 + 3\\sqrt{\\frac{1 - c^2(n)}{c^2(n)}}\\right] \\\\\n\\text{LCL} &= \\overline{S} \\left[1 - 3\\sqrt{\\frac{1 - c^2(n)}{c^2(n)}}\\right]\n\\end{align}\n\\tag{13.8}\\]\n就像在刚开始绘制 \\(\\overline{X}\\) 控制图时那样，在绘制 \\(\\text{S}\\)-控制图时，也应检查 \\(k\\) 个子组的样本标准差 \\(S_1, S_2, \\dots, S_k\\) 是否都落在控制限内。如果任何一个子组的 \\(S_i\\) 落在控制限之外，则应舍弃这些子组并重新计算 \\(\\overline{S}\\)。\n\n例 13.1 一个新启动的 过程 的 20 个子组（每组大小为 5）的 \\(\\overline{X}\\) 和 \\(S\\) 值 如下表所示。\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSub-group\n\\(\\overline{X}\\)\n\\(S\\)\nSub-group\n\\(\\overline{X}\\)\n\\(S\\)\nSub-group\n\\(\\overline{X}\\)\n\\(S\\)\nSub-group\n\\(\\overline{X}\\)\n\\(S\\)\n\n\n\n\n1\n35.1\n4.2\n6\n36.4\n4.5\n11\n38.1\n4.2\n16\n41.3\n8.2\n\n\n2\n33.2\n4.4\n7\n35.9\n3.4\n12\n37.6\n3.9\n17\n35.7\n8.1\n\n\n3\n31.7\n2.5\n8\n38.4\n5.1\n13\n38.8\n3.2\n18\n36.3\n4.2\n\n\n4\n35.4\n3.2\n9\n35.7\n3.8\n14\n34.3\n4.0\n19\n35.4\n4.1\n\n\n5\n34.5\n2.6\n10\n27.2\n6.2\n15\n43.2\n3.5\n20\n34.6\n3.7\n\n\n\n由于 \\(\\overline{\\overline{X}} = 35.94\\)，\\(\\overline{S} = 4.35\\)，\\(c(5) = 0.9400\\)，根据 式 13.4 和 式 13.8 可以得出 \\(\\overline{X}\\) 和 \\(S\\) 的初始上下控制限为：\n\\(\\text{UCL}(\\overline{X}) = 42.149\\) \\(\\text{LCL}(\\overline{X}) = 29.731\\) \\(\\text{UCL}(S) = 9.087\\) \\(\\text{LCL}(S) = -0.386\\)\n根据上述控制限绘制的 \\(S\\) 控制图和 \\(\\overline{X}\\) 控制图分别如 图 13.2 (a) 和 图 13.2 (b)。由于 \\(\\overline{X}_{10}\\) 和 \\(\\overline{X}_{15}\\) 超出了 \\(\\overline{X}\\) 的控制限，必须剔除这些子组，并重新计算控制限（我们将必要的计算留作练习）。\n\n代码\nlibrary(ggplot2)\n\n# S control chart.\nx &lt;- c(4.2, 4.4, 2.5, 3.2, 2.6, 4.5, 3.4, 5.1, 3.8, 6.2, 4.2, 3.9, \n       3.2, 4.0, 3.5, 8.2, 8.1, 4.2, 4.1, 3.7)\ni &lt;- seq_along(x)\ndf &lt;- data.frame(i=i, x=x)\n\nUCL &lt;- 9.087   # 上控制限\nLCL &lt;- -0.386  # 下控制限\n\nggplot(df, aes(x = i, y = x)) +\n  geom_point(shape = 4, size = 2) +  # 绘制均值点\n  geom_hline(yintercept = UCL, color = \"blue\", linetype = \"dashed\", size = 1) +  # 上控制限\n  geom_hline(yintercept = LCL, color = \"blue\", linetype = \"dashed\", size = 1) +  # 下控制限\n  annotate(\"text\", x = 11, y = UCL, label = \"UCL\", hjust = 0, vjust = -0.5, color = \"blue\") +  # 标注UCL\n  annotate(\"text\", x = 11, y = LCL, label = \"LCL\", hjust = 0, vjust = 1.5, color = \"blue\") +  # 标注LCL\n  labs(title = \"S Control Chart\", x = \"Subgroup\", y = expression(S)) +  # 添加标题和轴标签\n  scale_x_continuous(limits = c(1, 20),\n                     breaks = seq(1, 20, by = 1)) + \n  theme_minimal()  # 使用简洁主题\n\n\n# \\overline{X} control chart.\nx &lt;- c(35.1, 33.2, 31.7, 35.4, 34.5, \n       36.4, 35.9, 38.4, 35.7, 27.2, \n       38.1, 37.6, 38.8, 34.3, 43.2, \n       41.3, 35.7, 36.3, 35.4, 34.6)\ni &lt;- seq_along(x)\ndf &lt;- data.frame(i=i, x=x)\n\nUCL &lt;- 42.149   # 上控制限\nLCL &lt;- 29.731  # 下控制限\n\nggplot(df, aes(x = i, y = x)) +\n  geom_point(shape = 4, size = 2) +  # 绘制均值点\n  geom_hline(yintercept = UCL, color = \"blue\", linetype = \"dashed\", size = 1) +  # 上控制限\n  geom_hline(yintercept = LCL, color = \"blue\", linetype = \"dashed\", size = 1) +  # 下控制限\n  annotate(\"text\", x = 11, y = UCL, label = \"UCL\", hjust = 0, vjust = -0.5, color = \"blue\") +  # 标注UCL\n  annotate(\"text\", x = 11, y = LCL, label = \"LCL\", hjust = 0, vjust = 1.5, color = \"blue\") +  # 标注LCL\n  labs(title = \"bar{X} Control Chart\", x = \"Subgroup\", y = expression(bar(X))) +  # 添加标题和轴标签\n  scale_x_continuous(limits = c(1, 20),\n                     breaks = seq(1, 20, by = 1)) + \n  theme_minimal()  # 使用简洁主题\n\n\n\n\n\n\n\n\n\n\n\n\n(a) \\(S\\)-控制图\n\n\n\n\n\n\n\n\n\n\n\n(b) \\(\\overline{X}\\)-控制图\n\n\n\n\n\n\n\n图 13.2\n\n\n\n\\(\\blacksquare\\)",
    "crumbs": [
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>质量控制</span>"
    ]
  },
  {
    "objectID": "chapter_13/13.html#sec-13_4",
    "href": "chapter_13/13.html#sec-13_4",
    "title": "13  质量控制",
    "section": "13.4 不合格品率控制图",
    "text": "13.4 不合格品率控制图\n当测量的数据值是在某个范围内连续变化时，可以使用 \\(\\overline{X}\\)-控制图和 \\(S\\)-控制图判断 过程 是否处于受控状态。但有时候，可直接将所生产的产品分类为有缺陷或无缺陷，此时，我们依然可以构建控制图。\n假设当 过程 处于受控状态时，所生产的每个产品出现缺陷的概率相互独立且为 \\(p\\)。令 \\(X\\) 表示大小为 \\(n\\) 的产品子组中缺陷产品的数量，那么在 过程 受控的假设下，\\(X\\) 将是一个参数为 \\((n, p)\\) 的二项随机分布。如果 \\(F = X / n\\) 是子组缺陷产品的比例，那么在 过程 受控的假设下，其均值和标准差由以下公式给出：\n\\(E[F]=\\frac{E[X]}{n}=\\frac{np}{n}=p\\)\n\\(\\sqrt{\\text{Var}(F)}=\\sqrt{\\frac{\\text{Var}(X)}{n^2}}=\\sqrt{\\frac{np(1 - p)}{n^2}}=\\sqrt{\\frac{p(1 - p)}{n}}\\)\n因此，当 过程 处于受控状态时，大小为 \\(n\\) 的子组中缺陷产品的比例很可能在以下范围内：\n\\(\\text{LCL}=p - 3\\sqrt{\\frac{p(1 - p)}{n}}, \\quad \\text{UCL}=p + 3\\sqrt{\\frac{p(1 - p)}{n}}\\)\n对于本节的场景，子组大小 \\(n\\) 通常比 \\(\\overline{X}\\)-控制图和 \\(S\\)-控制图中使用的 4~10 的典型值要大得多。选择更大的 \\(n\\) 的主要原因在于：如果 \\(p\\) 很小且 \\(n\\) 的大小不合理，那么即使 过程 失控，大多数子组也将没有缺陷产品。因此，与 \\(np\\) 不接近于零的 \\(n\\) 相比，\\(np\\) 接近于零的 \\(n\\) 在检测质量变化时需要花费更长的时间。\n当然，要启动这样一个控制图，我们首先必须要估计 \\(p\\)。为此，选择 \\(k\\) 个子组，并尽量使 \\(k\\geq20\\)，同时令 \\(F_i\\) 表示第 \\(i\\) 个子组中缺陷产品的比例。\\(p\\) 的估计值由 \\(\\overline{F}\\) 给出，其定义为：\n\\(\\overline{F}=\\frac{F_1+\\cdots + F_k}{k}\\)\n由于 \\(nF_i\\) 等于第 \\(i\\) 个子组中的缺陷产品数量，则 \\(\\overline{F}\\) 也可以表示为：\n\\[\n\\begin{align*}\n\\overline{F}&=\\frac{nF_1+\\cdots + nF_k}{nk}\\\\\n&=\\frac{\\text{所有子组中的缺陷产品总数}}{\\text{所有子组中的产品总数}}\n\\end{align*}\n\\]\n换句话说，\\(p\\) 的估计值就是所检查产品中缺陷产品的比例。此时上控制限和下控制限由以下公式给出：\n\\(\\text{LCL}=\\overline{F}-3\\sqrt{\\frac{\\overline{F}(1 - \\overline{F})}{n}}, \\quad \\text{UCL}=\\overline{F}+3\\sqrt{\\frac{\\overline{F}(1 - \\overline{F})}{n}}\\)\n现在，我们就可以检查子组的缺陷比例 \\(F_1,F_2,\\cdots,F_k\\) 是否落在如上的控制限内。如果某些子组超出了控制限范围，那么应该剔除相应的子组，并重新计算 \\(\\overline{F}\\)。\n\n例 13.2 对于一台自动螺丝机生产线而言，我们从每小时生产的产品中连续抽取 50 个螺丝作为样本，每个螺丝或者为合格品或者为缺陷品。对 20 个这样的样本进行检测，得到以下数据。\n\n\n\n子组\n缺陷产品个数\nF\n子组\n缺陷产品个数\nF\n\n\n\n\n1\n6\n.12\n11\n1\n.02\n\n\n2\n5\n.10\n12\n3\n.06\n\n\n3\n3\n.06\n13\n2\n.04\n\n\n4\n0\n.00\n14\n0\n.00\n\n\n5\n1\n.02\n15\n1\n.02\n\n\n6\n2\n.04\n16\n1\n.02\n\n\n7\n1\n.02\n17\n0\n.00\n\n\n8\n0\n.00\n18\n2\n.04\n\n\n9\n2\n.04\n19\n1\n.02\n\n\n10\n1\n.02\n20\n2\n.04\n\n\n\n\\(\\overline{F} = \\frac{缺陷产品总数}{产品总数} = \\frac{34}{1000} = 0.034\\)\n因此，\n\\[\n\\begin{align*}\n\\text{UCL}&= 0.034 + 3\\sqrt{\\frac{(0.034)(0.968)}{50}}= 0.1109\\\\\n\\text{LCL}&= 0.034 - 3\\sqrt{\\frac{(0.034)(0.966)}{50}}=- 0.0429\n\\end{align*}\n\\]\n由于第一个子组中的缺陷产品比例超出了上控制限，我们需要剔除该子组并重新计算 \\(\\overline{F}\\)：\n\\(\\overline{F}=\\frac{34 - 6}{950}=0.0295\\)\n因此，新的上控制限和下控制限为 \\(0.0295\\pm\\sqrt{(0.0295)(1 - 0.0295)/50}\\)，即\n\\(\\text{LCL}=-0.0423, \\quad \\text{UCL}=0.1013\\)\n由于其余子组的缺陷品比例都落在控制限内，我们可以接受这样的结论：当 过程 受控时，子组中的缺陷品比例应低于 \\(0.1013\\)。\\(\\blacksquare\\)\n\n\n\n\n\n\n\n备注\n\n\n\n请注意，即使质量变化可能会意味着质量提升，我们也试图检测到任何质量上的变化。也就是说，即使次品出现的概率降低，我们也将该过程视为“失控”。这样做的原因是，注意到质量上的任何变化（无论是变好还是变差）都很重要，以便能够评估变化的原因。换句话说，如果产品质量出现了提升，那么分析生产过程以确定质量提升的原因就很重要。（也就是说，我们做对了哪些事情？）",
    "crumbs": [
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>质量控制</span>"
    ]
  },
  {
    "objectID": "chapter_13/13.html#sec-13_5",
    "href": "chapter_13/13.html#sec-13_5",
    "title": "13  质量控制",
    "section": "13.5 缺陷数控制图",
    "text": "13.5 缺陷数控制图\n在本节中，我们将考虑由一个或一组产品构成的产品单元中的缺陷产品数量的场景，例如：飞机机翼中有缺陷的铆钉数量，某芯片公司每天生产的有缺陷的计算机芯片数量。本节分析的场景中，通常待检测的产品的数量比较大，并且实际出现缺陷的概率都很小，所以假设由此产生的缺陷数量服从泊松分布是合理的。因此，我们假设，当 过程 处于受控状态时，单位缺陷数量（number of defects per unit）服从均值为 \\(\\lambda\\) 的泊松分布。\n如果我们令 \\(X_i\\) 表示第 \\(i\\) 个单元中的缺陷数量，那么，由于泊松随机变量的方差等于其均值，当 过程 处于受控状态时：\n\\(E[X_i]=\\lambda, \\quad \\text{Var}(X_i)=\\lambda\\)\n因此，当 过程 处于受控状态时，\\(X_i\\) 很可能在 \\(\\lambda\\pm3\\sqrt{\\lambda}\\) 范围内，所以上控制限和下控制限由以下公式给出：\n\\(\\text{UCL}=\\lambda + 3\\sqrt{\\lambda}, \\quad \\text{LCL}=\\lambda - 3\\sqrt{\\lambda}\\)\n如前所述，当一开始绘制控制图、且 \\(\\lambda\\) 未知时，应该使用 \\(k\\) 个单元的样本来估计 \\(\\lambda\\)：\n\\(\\overline{X}=(X_1+\\cdots + X_k)/k\\)\n由此我们得到控制限：\n\\(\\overline{X}+3\\sqrt{\\overline{X}} \\quad, \\quad \\overline{X}-3\\sqrt{\\overline{X}}\\)\n如果所有的 \\(X_i\\)（\\(i = 1,\\cdots,k\\)）都落在控制限内，那么我们就假设 过程 处于受控状态，且 \\(\\lambda = \\overline{X}\\)。如果存在 \\(X_i\\) 超出控制限，那么就剔除这些数据并重新计算 \\(\\overline{X}\\)，依此类推。\n在每个产品（或每天）的平均缺陷数较小的情况下，应该将产品（天数）组合起来，并使用给定数量——比如 \\(n\\) 个产品（或 \\(n\\) 天）——的缺陷数作为样本数据。由于独立泊松随机变量的和仍然是均值为 \\(\\lambda\\) 的泊松随机变量，因此给定数量的缺陷数据将是一个均值更大的 \\(\\lambda\\) 的泊松随机变量。所以，当每个产品的平均缺陷数小于 25 时，这种产品组合的方式是有用的。\n为了体会产品组合的优势，假设当 过程 处于受控状态时，每个产品的平均缺陷数为 4，并且假设发生了一些情况，导致这个值从 4 变为 6，也就是说，产品缺陷数增加了 1 个标准差。那么，当连续数据由 \\(n\\) 个产品中的缺陷数组成时，平均要生产多少个产品才能判断 过程 为失控状态。\n由于在受控状态下，\\(n\\) 个产品样本中的缺陷数服从均值和方差都等于 \\(4n\\) 的泊松分布，所以控制限为 \\(4n\\pm3\\sqrt{4n}\\) ，即 \\(4n\\pm6\\sqrt{n}\\)。现在，如果每个产品的平均缺陷数变为 6，那么将服从均值为 \\(6n\\) 的泊松分布，所以此时样本落在控制限之外的概率（称其为 \\(p(n)\\)）由下式给出：\n\\(p(n)=P\\{Y &gt; 4n + 6\\sqrt{n}\\}+P\\{Y &lt; 4n - 6\\sqrt{n}\\}\\)\n其中 \\(Y\\) 服从均值为 \\(6n\\) 的泊松分布。现在\n\\[\n\\begin{align*}\np(n) &\\approx P\\{Y &gt; 4n + 6\\sqrt{n}\\} \\\\\n&=P\\left\\{\\frac{Y - 6n}{\\sqrt{6n}}&gt;\\frac{6\\sqrt{n}-2n}{\\sqrt{6n}}\\right\\}\\\\\n&\\approx P\\left\\{Z&gt;\\frac{6\\sqrt{n}-2n}{\\sqrt{6n}}\\right\\}\\quad \\text{其中 }Z\\sim \\mathcal{N}(0,1)\\\\\n&=1 - \\Phi\\left(\\sqrt{6}-2\\sqrt{\\frac{n}{6}}\\right)\n\\end{align*}\n\\]\n因为每个数据值落在控制限之外的概率为 \\(p(n)\\)，所以得到一个落在控制限之外的数据值所需的产品数量是一个参数为 \\(p(n)\\) 的几何随机变量，因此其均值为 \\(1 / p(n)\\)。最后，由于每个数据值对应 \\(n\\) 个产品，所以在 过程 被判定为失控之前生产的物品数量的均值为 \\(n / p(n)\\)，所以失控时生产的产品平均数量为：\n\\[\nn/(1 - \\Phi(\\sqrt{6}-\\sqrt{\\frac{2n}{3}}))\n\\]\n表 13.2 中给出了不同的 \\(n\\) 所对应的平均产品数量。由于当 过程 处于受控状态时，\\(n\\) 的值越大越好（在 过程 被错误地判定为失控之前生产的产品的平均数量约为 \\(n / 0.0027\\)），从 表 13.2 中可以明显看出，我们应该至少组合 9 个产品。这意味着每个数据值（等于组合中的缺陷数量）的均值至少为 \\(9\\times4 = 36\\)。\n\n\n\n表 13.2\n\n\n\n\n\n\\(n\\)\n平均产品数量\n\n\n\n\n1\n19.6\n\n\n2\n20.66\n\n\n3\n19.80\n\n\n4\n19.32\n\n\n5\n18.80\n\n\n6\n18.18\n\n\n7\n18.13\n\n\n8\n18.02\n\n\n9\n18\n\n\n10\n18.18\n\n\n11\n18.33\n\n\n12\n18.51\n\n\n\n\n\n\n\n习题 13.3 对于某汽车厂商而言，以每 10 辆汽车为单元，连续单元发现的缺陷数量如下表所示：\n\n\n\n汽车\n缺陷量\n汽车\n缺陷量\n汽车\n缺陷量\n汽车\n缺陷量\n\n\n\n\n1\n141\n6\n74\n11\n63\n16\n68\n\n\n2\n162\n7\n85\n12\n74\n17\n95\n\n\n3\n150\n8\n95\n13\n103\n18\n81\n\n\n4\n111\n9\n76\n14\n81\n19\n102\n\n\n5\n92\n10\n68\n15\n94\n20\n73\n\n\n\n整个生产过程看起来是否一直处于受控状态？\n\n\n解 13.3. 因为 \\(\\overline{X}=94.4\\)，所以控制限为：\n\\[\n\\begin{align*}\n\\text{LCL}&=94.4 - 3\\sqrt{94.4}=65.25\\\\\n\\text{UCL}&=94.4 + 3\\sqrt{94.4}=123.55\n\\end{align*}\n\\]\n由于前三个数据值大于上控制限（UCL），删除这三个数据并重新计算样本均值。由此可得：\n\\(\\overline{X}=\\frac{(94.4)\\times20-(141 + 162+150)}{17}=84.41\\)\n所以新的控制限为：\n\\[\n\\begin{align*}\n\\text{LCL}&=84.41 - 3\\sqrt{84.41}=56.85\\\\\n\\text{UCL}&=84.41 + 3\\sqrt{84.41}=111.97\n\\end{align*}\n\\]\n此时，因为其余 17 个数据值都落在控制限内，我们可以宣称该 过程 现在处于受控状态，均值为 84.41。然而，由于在达到受控状态之前，缺陷的平均数量似乎一开始就很高，所以数据值 \\(X_4\\) 也很可能是在 过程 处于受控状态之前产生的。因此，在这种情况下，需要删除 \\(X_4\\) 并重新计算似乎是比较谨慎的做法。基于其余 16 个数据值，我们得到：\n\\[\n\\begin{align*}\n\\overline{X}&=82.56\\\\\n\\text{LCL}&=82.56 - 3\\sqrt{82.56}=55.30\\\\\n\\text{UCL}&=82.56 + 3\\sqrt{82.56}=109.82\n\\end{align*}\n\\]\n所以，该过程现在看起来处于受控状态，其均值为 82.56。 \\(\\blacksquare\\)",
    "crumbs": [
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>质量控制</span>"
    ]
  },
  {
    "objectID": "chapter_13/13.html#sec-13_6",
    "href": "chapter_13/13.html#sec-13_6",
    "title": "13  质量控制",
    "section": "13.6 用于检测总体均值变化的控制图",
    "text": "13.6 用于检测总体均值变化的控制图\n小节 13.2 中给出的 \\(\\overline{X}\\)-控制图 的主要缺点在于对总体均值的微小变化不敏感。也就是说，当总体均值出现较小的变化时，由于图中的每个点仅依赖于单个子组，因此往往具有相对较大的方差，所以需要大量的数据点才能检测到总体均值出现的较小的变化。为了解决这个问题，可以让图中的每个数据点不仅取决于最近的子组均值，还取决于其他子组均值。目前，有三种方法可以实现该目的：\n\n移动平均控制图（moving averages）\n指数加权移动平均控制图（exponentially weighted moving averages）\n累计和控制图（cumulative sum）\n\n\n13.6.1 移动平均控制图\n通过不断绘制最近 \\(k\\) 个子组的平均值可以得到跨度为 \\(k\\) 的移动平均控制图。也就是说，在 \\(t\\) 时刻的移动平均值 \\(M_t\\) 为：\n\\(M_t=\\frac{\\overline{X}_t+\\overline{X}_{t - 1}+\\cdots+\\overline{X}_{t - k + 1}}{k}\\)\n其中 \\(\\overline{X}_i\\) 是第 \\(i\\) 个子组的平均值，并且：\n\\(kM_t=\\overline{X}_t+\\overline{X}_{t - 1}+\\cdots+\\overline{X}_{t - k + 1}\\)\n\\(kM_{t + 1}=\\overline{X}_{t + 1}+\\overline{X}_t+\\cdots+\\overline{X}_{t - k + 2}\\)\n于是，\\(kM_{t + 1}-kM_t\\) 得到：\n\\(kM_{t + 1}-kM_t=\\overline{X}_{t + 1}-\\overline{X}_{t - k + 1}\\)\n即：\n\\(M_{t + 1}=M_t+\\frac{\\overline{X}_{t + 1}-\\overline{X}_{t - k + 1}}{k}\\)\n换句话说，\\(t + 1\\) 时刻的移动平均值等于 \\(t\\) 时刻的移动平均值加上 \\(1/k\\) 乘以移动平均值中新添加的值（\\(\\overline{X}_{t + 1}\\)）与需要删除的值（\\(\\overline{X}_{t - k + 1}\\)）之间的差值。当 \\(t\\) 小于 \\(k\\) 时，\\(M_t\\) 定义为前 \\(t\\) 个子组的平均值，即：\n\\(M_t=\\frac{\\overline{X}_1+\\cdots+\\overline{X}_t}{t} , \\quad \\text{如果} t &lt; k\\)\n假设当 过程 处于受控状态时，连续样本数据来自均值为 \\(\\mu\\)、方差为 \\(\\sigma^{2}\\) 的正态总体。因此，如果子组大小为 \\(n\\)，那么 \\(\\overline{X}_{i}\\) 服从均值为 \\(\\mu\\)、方差为 \\(\\sigma^{2}/n\\) 的正态分布。由此可知，\\(m\\) 个 \\(\\overline{X}_{i}\\) 的平均值将服从均值为 \\(\\mu\\)、方差为 \\(\\text{Var}(\\overline{X}_{i})/m=\\sigma^{2}/nm\\) 的正态分布。所以，当 过程 处于受控状态时：\n\\[\n\\begin{align}\nE[M_{t}]&=\\mu \\\\\n\\text{Var}(M_{t}) &=\n\\begin{cases}\n\\sigma^{2}/nt & \\text{如果 } t &lt; k \\\\\n\\sigma^{2}/nk & \\text{否则}\n\\end{cases}\n\\end{align}\n\\]\n因为正态随机变量几乎总是位于其均值的 3 个标准差内，所以对于 \\(M_{t}\\)，我们有以下上、下控制限：\n\\[\n\\begin{align}\n\\text{UCL} &=\n\\begin{cases}\n\\mu + 3\\sigma/\\sqrt{nt} & \\text{如果 } t &lt; k \\\\\n\\mu + 3\\sigma/\\sqrt{nk} & \\text{否则}\n\\end{cases} \\\\\n\\text{LCL} &=\n\\begin{cases}\n\\mu - 3\\sigma/\\sqrt{nt} & \\text{如果 } t &lt; k \\\\\n\\mu - 3\\sigma/\\sqrt{nk} & \\text{否则}\n\\end{cases}\n\\end{align}\n\\]\n换句话说，除了前 \\(k - 1\\) 个移动平均值之外，每当移动平均值与 \\(\\mu\\) 的差值超过 \\(3\\sigma/\\sqrt{nk}\\) 时，就可以判定 过程 处于失控状态。\n\n例 13.3 当某制造商的生产 过程 处于受控状态时，其所生产的产品的某测量值服从均值为 10、标准差为 2 的正态分布。以下的模拟数据表示来自均值为 11、标准差为 2 的正态总体的 25 个子组（每个子组大小为 5）的平均值。也就是说，这些数据表示 过程 失控后，其均值从 10 增加到 11 时的子组平均值。表 13.3 给出了这 25 个子组的平均值，以及当 \\(k = 8\\) 时的移动平均值和上下控制限。对于 \\(t&gt;8\\)，下控制限和上控制限分别为 9.051318 和 10.94868。\n\n\n\n表 13.3: * 表示过程失控\n\n\n\n\n\n\\(t\\)\n\\(\\overline{X}_t\\)\n\\(M_t\\)\n\\(LCL\\)\n\\(UCL\\)\n\n\n\n\n1\n9.617728\n9.617728\n7.316719\n12.68328\n\n\n2\n10.25437\n9.936049\n8.102634\n11.89737\n\n\n3\n9.876195\n9.913098\n8.450807\n11.54919\n\n\n4\n10.79338\n10.13317\n8.658359\n11.34164\n\n\n5\n10.60699\n10.22793\n8.8\n11.2\n\n\n6\n10.48396\n10.2706\n8.904554\n11.09545\n\n\n7\n13.33961\n10.70903\n8.95815\n11.01419\n\n\n8\n9.462969\n10.55328\n9.051318\n10.94868\n\n\n9\n10.14556\n10.61926\n\n\n\n\n10\n11.66342\n10.79539\n\n\n\n\n*11\n11.55484\n11.00634\n\n\n\n\n*12\n11.26203\n11.06492\n\n\n\n\n*13\n12.31473\n11.27839\n\n\n\n\n*14\n9.220009\n11.1204\n\n\n\n\n15\n11.25206\n10.85945\n\n\n\n\n16\n10.48662\n10.98741\n\n\n\n\n17\n9.025091\n10.84735\n\n\n\n\n18\n9.693386\n10.6011\n\n\n\n\n19\n11.45989\n10.58923\n\n\n\n\n20\n12.44213\n10.73674\n\n\n\n\n21\n11.18981\n10.59613\n\n\n\n\n22\n11.56674\n10.88947\n\n\n\n\n23\n9.869849\n10.71669\n\n\n\n\n24\n12.11311\n10.92\n\n\n\n\n*25\n11.48656\n11.22768\n\n\n\n\n\n\n\n\n如表所示，第一个超出其控制限的移动平均值出现在 \\(t=11\\)，其他类似情况出现在 12、13、14、16 和 25。有趣的是，通常的控制图——即 \\(k = 1\\) 的移动平均值——会在 \\(t=7\\) 时判定 过程 失控，因为 \\(\\overline{X}_{7}\\) 非常大。然而，这是该图唯一会表明 过程 失控的点（见 图 13.3）。\n\n\n代码\nlibrary(ggplot2)\n\nx &lt;- c(9.617728, 10.25437, 9.876195, 10.79338, 10.60699, 10.48396, 13.33961, 9.462969, 10.14556, \n       11.66342, 11.55484, 11.26203, 12.31473, 9.220009, 11.25206, 10.48662, 9.025091, 9.693386, \n       11.45989, 12.44213, 11.18981, 11.56674, 9.869849, 12.11311, 11.48656)\ni &lt;- seq_along(x)\ndf &lt;- data.frame(i=i, x=x)\n\nmu &lt;- 10       # 均值\nsigma &lt;- 2  # 标准差\nn &lt;- 5        # 子组样本量\n\nUCL &lt;- mu + 3 * sigma / sqrt(n)  # 上控制限\nLCL &lt;- mu - 3 * sigma / sqrt(n)  # 下控制限\n\nggplot(df, aes(x = i, y = x)) +\n  geom_point(shape = 4, size = 2) +  # 绘制均值点\n  geom_hline(yintercept = UCL, color = \"blue\", linetype = \"dashed\", size = 1) +  # 上控制限\n  geom_hline(yintercept = LCL, color = \"blue\", linetype = \"dashed\", size = 1) +  # 下控制限\n  annotate(\"text\", x = 11, y = UCL, label = \"UCL\", hjust = 0, vjust = -0.5, color = \"blue\") +  # 标注UCL\n  annotate(\"text\", x = 11, y = LCL, label = \"LCL\", hjust = 0, vjust = 1.5, color = \"blue\") +  # 标注LCL\n  scale_x_continuous(limits = c(1, 25),\n                     breaks = seq(1, 25, by = 1)) + \n  theme_minimal()  # 使用简洁主题\n\n\n\n\n\n\n\n\n图 13.3: \\(\\overline{X}\\)-控制图\n\n\n\n\n\n均值变化大小与合适的移动平均跨度大小 \\(k\\) 之间往往存在负相关性。也就是说，均值变化越小，\\(k\\) 的取值应该越大。\\(\\blacksquare\\)\n\n\n\n13.6.2 指数加权移动平均控制图\n小节 13.6.1 中的 移动平均控制图 在每个 \\(t\\) 时刻都考虑了到该时刻为止的所有子组平均值的加权平均值，其中最近的 \\(k\\) 个子组的权重为 \\(1/k\\) ，其他子组的权重为 0。这似乎是检测总体均值微小变化的最有效的方式，所以也引发了对其他可能性的思考——采用其他的权重来计算加权平均值。\n令\n\\[\nW_t=\\alpha\\overline{X}_t+(1 - \\alpha)W_{t - 1}\n\\tag{13.9}\\]\n其中 \\(\\alpha\\) 是介于 0 和 1 之间的常数，并且\n\\(W_0=\\mu\\)\n我们称 \\(W_t, t = 0,1,2,\\cdots\\) 为 指数加权移动平均值。为了理解为什么要如此称呼这个序列，我们需要注意到：如果不断地用@eq-13_6_1 替换该式右侧的 \\(W\\)，我们会得到：\n\\[\n\\begin{align*}\nW_t&=\\alpha\\overline{X}_t+(1 - \\alpha)[\\alpha\\overline{X}_{t - 1}+(1 - \\alpha)W_{t - 2}] \\\\\n&=\\alpha\\overline{X}_t+\\alpha(1 - \\alpha)\\overline{X}_{t - 1}+(1 - \\alpha)^2W_{t - 2}\\\\\n&=\\alpha\\overline{X}_t+\\alpha(1 - \\alpha)\\overline{X}_{t - 1}+(1 - \\alpha)^2[\\alpha\\overline{X}_{t - 2}+(1 - \\alpha)W_{t - 3}]\\\\\n&=\\alpha\\overline{X}_t+\\alpha(1 - \\alpha)\\overline{X}_{t - 1}+\\alpha(1 - \\alpha)^2\\overline{X}_{t - 2}+(1 - \\alpha)^3W_{t - 3}\\\\\n&\\vdots\\\\\n&=\\alpha\\overline{X}_t+\\alpha(1 - \\alpha)\\overline{X}_{t - 1}+\\alpha(1 - \\alpha)^2\\overline{X}_{t - 2}+\\cdots\\\\\n&+\\alpha(1 - \\alpha)^{t - 1}\\overline{X}_1+(1 - \\alpha)^t\\mu\n\\end{align*}\n\\tag{13.10}\\]\n因此，从 式 13.10 中，我们可以看出，\\(W_t\\) 是到 \\(t\\) 时刻为止所有子组平均值的加权平均值，最近的子组的权重为 \\(\\alpha\\)，然后对于之后的子组不停的乘以 \\(1 - \\alpha\\) 以持续降低其对应子组的权重，最后受控总体均值的权重为 \\((1 - \\alpha)^t\\)。\n\\(\\alpha\\) 的值越小，后续子组的权重就越均匀。例如，如果 \\(\\alpha = 0.1\\)，那么初始权重是 0.1，后续权重以 0.9 为因子不断减小；也就是说，权重依次是 \\(0.1, 0.09, 0.081, 0.073, 0.066, 0.059, \\cdots\\)。另一方面，如果 \\(\\alpha = 0.4\\)，那么权重将依次是 \\(0.4, 0.24, 0.144, 0.087, 0.052, \\cdots\\)。\n由于权重 \\(\\alpha(1 - \\alpha)^{i - 1}, i = 1, 2, \\cdots\\) ，可以写成\n\\(\\alpha(1 - \\alpha)^{i - 1}=\\overline{\\alpha}e^{-\\beta i}\\)\n其中，\\(\\overline{\\alpha}=\\frac{\\alpha}{1 - \\alpha}, \\quad \\beta = -\\log(1 - \\alpha)\\)\n所以，我们说数据是通过连续的“指数加权” 所得到的。（见 图 13.4）。\n\n\n代码\n# 设置alpha值\nalpha &lt;- 0.4\n# 生成i的序列，这里从1到10\ni &lt;- seq(1, 10, 0.1)\n# 计算权重\nweights &lt;- alpha * (1 - alpha)^(i - 1)\n# 绘制图形\nplot(i, weights, type = \"l\", lty = 1, lwd = 2, col = \"blue\",\n     xlab = \"i\",\n     ylab = expression(alpha * (1 - alpha)^(i - 1)))\n\n\n\n\n\n\n\n\n图 13.4: 当\\(\\alpha=0.4\\)时\\(\\alpha(1-\\alpha)^{i-1}\\)的函数图\n\n\n\n\n\n为了计算 \\(W_t\\) 的均值和方差，我们需要回想一下：当 过程 处于受控状态时，子组平均值 \\(\\overline{X}_i\\) 是相互独立的正态随机变量，并且每个子组的平均值的均值为 \\(\\mu\\)、方差为 \\(\\sigma^{2}/n\\)。因此，使用 式 13.10，有：\n\\[\n\\begin{align*}\nE[W_t]&=\\mu[\\alpha+\\alpha(1 - \\alpha)+\\alpha(1 - \\alpha)^2+\\cdots+\\alpha(1 - \\alpha)^{t - 1}+(1 - \\alpha)^t]\\\\\n&=\\frac{\\mu\\alpha[1-(1 - \\alpha)^t]}{1-(1 - \\alpha)}+\\mu(1 - \\alpha)^t\\\\\n&=\\mu\n\\end{align*}\n\\]\n再次使用 式 13.10 以确定方差：\n\\[\n\\begin{align*}\n\\text{Var}(W_t)&=\\frac{\\sigma^{2}}{n}\\left\\{\\alpha^{2}+[\\alpha(1 - \\alpha)]^{2}+[\\alpha(1 - \\alpha)^2]^{2}+\\cdots+[\\alpha(1 - \\alpha)^{t - 1}]^{2}\\right\\}\\\\\n&=\\frac{\\sigma^{2}}{n}\\alpha^{2}[1+\\beta+\\beta^{2}+\\cdots+\\beta^{t - 1}] \\quad \\text{其中 } \\beta=(1 - \\alpha)^2\\\\\n&=\\frac{\\sigma^{2}\\alpha^{2}[1-(1 - \\alpha)^{2t}]}{n[1-(1 - \\alpha)^2]}\\\\\n&=\\frac{\\sigma^{2}\\alpha[1-(1 - \\alpha)^{2t}]}{n(2 - \\alpha)}\n\\end{align*}\n\\]\n因此，当 \\(t\\) 很大时，只要 过程 始终保持在受控状态：\n\\[\n\\begin{align*}\nE[W_t]&=\\mu\\\\\n\\text{Var}(W_t)&\\approx\\frac{\\sigma^{2}\\alpha}{n(2 - \\alpha)} \\quad \\text{因为 } (1 - \\alpha)^{2t}\\approx0\n\\end{align*}\n\\]\n因此，\\(W_t\\) 的上、下控制限由以下公式给出：\n\\[\n\\begin{align*}\n\\text{UCL}&=\\mu + 3\\sigma\\sqrt{\\frac{\\alpha}{n(2 - \\alpha)}}\\\\\n\\text{LCL}&=\\mu - 3\\sigma\\sqrt{\\frac{\\alpha}{n(2 - \\alpha)}}\n\\end{align*}\n\\]\n注意，当指数加权移动平均控制图的控制限与跨度为 \\(k\\) 的移动平均控制图（在初始的 \\(k\\) 个值之后）中的控制限相同时：\n\\[\n\\frac{3\\sigma}{\\sqrt{nk}}=3\\sigma\\sqrt{\\frac{\\alpha}{n(2 - \\alpha)}}\n\\]\n即，\n\\[\nk=\\frac{2 - \\alpha}{\\alpha} \\quad \\text{或} \\quad \\alpha=\\frac{2}{k + 1}\n\\]\n\n习题 13.4 一家维修店会派一名工人前往预约者家中维修电子设备。收到维修电话后，维修店会派遣一名工人，该工人在完成维修工作后需要电话汇报维修情况。历史数据表明，从派遣维修人员到其电话汇报之间的时间服从正态分布，其均值为 62 分钟，标准差为 24 分钟。为了关注从派遣维修人员到其电话汇报之间的时间的任何变化，该维修店绘制了一张标准的指数加权移动平均（EWMA）控制图，图中每个数据点是连续 4 次维修时间的平均值，且加权因子 \\(\\alpha = 0.25\\)。如果该控制图的当前值为 60，并且以下是接下来的 16 个子组平均值，我们能得出什么结论？\n48, 52, 70, 62, 57, 81, 56, 59, 77, 82, 78, 80, 74, 82, 68, 84\n\n\n解 13.4. 从 \\(W_0 = 60\\) 开始，可以根据公式：\n\\(W_t = 0.25\\overline{X}_t + 0.75W_{t - 1}\\)\n计算得到 \\(W_1,\\cdots,W_{16}\\) 的连续值。\n计算结果如下：\n\\[\n\\begin{align*}\nW_1&=(0.25)(48)+(0.75)(60)=57\\\\\nW_2&=(0.25)(52)+(0.75)(57)=55.75\\\\\nW_3&=(0.25)(70)+(0.75)(55.75)=59.31\\\\\nW_4&=(0.25)(62)+(0.75)(59.31)=59.98\\\\\nW_5&=(0.25)(57)+(0.75)(59.98)=59.24\\\\\nW_6&=(0.25)(81)+(0.75)(59.24)=64.68\n\\end{align*}\n\\]\n以此类推，\\(W_7\\) 到 \\(W_{16}\\) 的值如下：\n\\(62.50, 61.61, 65.48, 69.60, 71.70, 73.78, 73.83, 75.87, 73.90, 76.43\\)\n因为 \\(3\\sqrt{\\frac{0.25}{1.75}}\\frac{24}{\\sqrt{4}} = 13.61\\)，因此在加权因子 \\(\\alpha = 0.25\\) 时的指数加权移动平均（EWMA）控制图的控制限为：\n\\[\n\\begin{align*}\n\\text{LCL}&=62 - 13.61 = 48.39\\\\\n\\text{UCL}&=62 + 13.61 = 75.61\n\\end{align*}\n\\]\n因此，根据 EWMA 控制图，我们会判断在 \\(W_{14}\\)（以及 \\(W_{16}\\)）之后，系统将处于失控状态。另一方面，有趣的是，子组标准差为 \\(\\sigma/\\sqrt{n}=12\\)，但是没有任何一个数据与 \\(\\mu = 62\\) 之间的差距超过了 2 个标准差，所以标准的 \\(\\overline{X}\\)-控制图并不会判定系统失控。\\(\\blacksquare\\)\n\n\n例 13.4 对于 例 13.3 中的数据，如果使用 \\(\\alpha=\\frac{2}{9}\\) 的 EWMA 控制图，我们得到如下的数据(*表示失控)。\n\n\n\n\\(t\\)\n\\(\\overline{X}_t\\)\n\\(W_t\\)\n\\(t\\)\n\\(\\overline{X}_t\\)\n\\(W_t\\)\n\n\n\n\n1\n9.617728\n9.915051\n14\n9.220009\n10.84522\n\n\n2\n10.25437\n9.990456\n15\n11.25206\n10.93563\n\n\n3\n9.867195\n9.963064\n16\n10.48662\n10.83585\n\n\n4\n10.79338\n10.14758\n17\n9.025091\n10.43346\n\n\n5\n10.60699\n10.24967\n18\n9.693386\n10.269\n\n\n6\n10.48396\n10.30174\n19\n11.45989\n10.53364\n\n\n*7\n13.33961\n10.97682\n*20\n12.44213\n10.95775\n\n\n8\n9.462969\n10.64041\n*21\n11.18981\n11.00932\n\n\n9\n10.14556\n10.53044\n*22\n11.56674\n11.13319\n\n\n10\n11.66342\n10.78221\n23\n9.869849\n10.85245\n\n\n*11\n11.55484\n10.95391\n*24\n12.11311\n11.13259\n\n\n*12\n11.26203\n11.02238\n*25\n11.48656\n11.21125\n\n\n*13\n12.31473\n11.30957\n\n\n\n\n\n\n\n\n代码\nlibrary(ggplot2)\n\nx &lt;- c(9.915051, 9.990456, 9.963064, 10.14758, 10.24967, 10.30174, 10.97682, 10.64041, 10.53044, \n       10.78221, 10.95391, 11.02238, 11.30957, 10.84522, 10.93563, 10.83585, 10.43346, 10.269, \n       10.53364, 10.95775, 11.00932, 11.13319, 10.85245, 11.13259, 11.21125)\ni &lt;- seq_along(x)\ndf &lt;- data.frame(i=i, x=x)\n\nUCL &lt;- 10.94868  # 上控制限\nLCL &lt;- 9.051318  # 下控制限\n\nggplot(df, aes(x = i, y = x)) +\n  geom_point(shape = 4, size = 2) +  # 绘制均值点\n  geom_hline(yintercept = UCL, color = \"blue\", linetype = \"dashed\", size = 1) +  # 上控制限\n  geom_hline(yintercept = LCL, color = \"blue\", linetype = \"dashed\", size = 1) +  # 下控制限\n  annotate(\"text\", x = 11, y = UCL, label = \"UCL\", hjust = 0, vjust = -0.5, color = \"blue\") +  # 标注UCL\n  annotate(\"text\", x = 11, y = LCL, label = \"LCL\", hjust = 0, vjust = 1.5, color = \"blue\") +  # 标注LCL\n  scale_x_continuous(limits = c(1, 25),\n                     breaks = seq(1, 25, by = 1)) + \n  theme_minimal()  # 使用简洁主题\n\n\n\n\n\n\n\n\n图 13.5: 移动平均控制图\n\n\n\n\n\n因为 \\(\\text{UCL} = 10.94868, \\text{LCL}=9.051318\\)，因此，根据 图 13.5，当 \\(t=7\\) 时，过程 就开始处于失控状态。\\(\\blacksquare\\)\n\n\n\n13.6.3 累计和控制图\n在检测较小的均值变化或者中等规模的均值变化方面，累计和（通常简称为 cu-sum）控制图也是一种较为有效的检测方法。\n假设 \\(\\overline{X}_1, \\overline{X}_2, \\cdots\\) 表示大小为 \\(n\\) 的子组的连续平均值，并且当 过程 处于受控状态时，这些随机变量的均值为 \\(\\mu\\)，标准差为 \\(\\sigma/\\sqrt{n}\\)。最初，假设我们只对检测均值何时增加感兴趣。（单边）累计和控制图可用于检测均值增加的场景，其运作方式如下：\n选择大于 0 的常数 \\(d\\) 和 \\(B\\) ，并令\n\\(Y_j = \\overline{X}_j - \\mu - d\\sigma/\\sqrt{n}, \\quad j\\geq1\\)\n注意，当 过程 处于受控状态时，\\(E[\\overline{X}_j] = \\mu\\) ，所以\n\\(E[Y_j] = -d\\sigma/\\sqrt{n} &lt; 0\\)\n现在，令\n\\(\\begin{align*} S_0 &= 0\\\\ S_{j + 1} &= \\max\\{S_j + Y_{j + 1}, 0\\}, \\quad j\\geq0 \\end{align*}\\)\n参数为 \\(d\\) 和 \\(B\\) 的累计和控制图会持续绘制 \\(S_j\\)，并在满足 \\(S_j &gt; B\\sigma/\\sqrt{n}\\) 的第一个 \\(j\\) 时判断均值已经增加。\n为了理解这个控制图背后的原理，假设我们决定持续绘制到目前为止观察到的所有随机变量 \\(Y_i\\) 的总和。也就是说，假设我们决定绘制 \\(P_j\\) 序列，其中\n\\(P_j = \\sum_{i = 1}^{j}Y_i\\) 或者 \\(\\begin{align*} P_0 &= 0\\\\ P_{j + 1} &= P_j + Y_{j + 1}, \\quad j\\geq0 \\end{align*}\\)\n当系统一直处于受控状态时，所有的 \\(Y_i\\) 的期望值均为负数，因此我们会期望 \\(P_j\\) 为负数。因此，如果 \\(P_j\\) 的值变得很大——比如说，大于 \\(B\\sigma/\\sqrt{n}\\)——那么这将是 过程 失控的有力证据。然而，问题在于，如果系统在很长时间后才失控，那么那时 \\(P_j\\) 的值很可能是非常小的负数（因为在失控之前我们一直在对均值为负数的随机变量求和），因此需要经过很长的时间才能令 \\(P_j\\) 的值超过 \\(B\\sigma/\\sqrt{n}\\)。因此，为了在 过程 处于受控状态时避免 \\(P_j\\) 变成非常小的负数，累计和控制图采用了一个简单的技巧：每当 \\(P_j\\) 变为负数时就将其重置为 0。也就是说，\\(S_j\\) 是直到时间 \\(j\\) 为止所有 \\(Y_i\\) 的累计和（但是，每当所有 \\(Y_i\\) 的累计总和小于 0 时，\\(S_j\\) 将被重置为 0）。\n\n例 13.5 假设子组平均值的均值、标准差分别为 \\(\\mu = 30\\)、\\(\\sigma/\\sqrt{n}=8\\)，考虑绘制参数 \\(d = 0.5\\)，\\(B = 5\\) 的累计和控制图。如果前八个子组的平均值为 29, 33, 35, 42, 36, 44, 43, 45，\n那么 \\(Y_j=\\overline{X}_j - 30 - 4=\\overline{X}_j - 34\\) 为：\n\\(Y_1=-5\\)，\\(Y_2=-1\\)，\\(Y_3 = 1\\)，\\(Y_4 = 8\\)，\\(Y_5 = 2\\)，\\(Y_6 = 10\\)，\\(Y_7 = 9\\)，\\(Y_8 = 11\\)\n因此，\n\\[\n\\begin{align*}\nS_1&=\\max\\{-5, 0\\}=0\\\\\nS_2&=\\max\\{-1, 0\\}=0\\\\\nS_3&=\\max\\{1, 0\\}=1\\\\\nS_4&=\\max\\{9, 0\\}=9\\\\\nS_5&=\\max\\{11, 0\\}=11\\\\\nS_6&=\\max\\{21, 0\\}=21\\\\\nS_7&=\\max\\{30, 0\\}=30\\\\\nS_8&=\\max\\{41, 0\\}=41\n\\end{align*}\n\\]\n由于控制限为 \\(B\\sigma/\\sqrt{n}=5\\times(8)=40\\)，因此根据累计和控制图，在观察到第八个子组的平均值后会，我们将判断均值已经增加。\\(\\blacksquare\\)\n\n为了检测均值的正向或负向变化，我们可以同时使用两个单边累计和控制图。首先，\\(E[X_i]\\) 的减小等价于 \\(E[-X_i]\\) 的增加，因此，我们可以通过对子组平均值的负值运行单边累计和控制图来检测产品均值的减小。也就是说，对于指定的参数 \\(d\\) 和 \\(B\\)，我们不仅要像之前那样绘制量 \\(S_j\\)，而且还令\n\\(W_j = -\\overline{X}_j - (-\\mu) - d\\sigma/\\sqrt{n}=\\mu - \\overline{X}_j - d\\sigma/\\sqrt{n}\\)\n并且，\\(\\begin{align*} T_0&=0\\\\ T_{j + 1}&=\\max\\{T_j + W_{j + 1}, 0\\}, \\quad j\\geq0 \\end{align*}\\)\n然后也绘制 \\(T_j\\) 的值。\n当 \\(S_j\\) 或 \\(T_j\\) 首次超过 \\(B\\sigma/\\sqrt{n}\\) 时，就判定 过程 失控。\n总之，用于检测所生产产品的均值变化的累计和控制图的步骤如下：\n\n选择大于 0 的常数 \\(d\\) 和 \\(B\\)\n使用连续的子组平均值来确定 \\(S_j\\) 和 \\(T_j\\)\n当 \\(S_j\\) 或 \\(T_j\\) 首次超过 \\(B\\sigma/\\sqrt{n}\\) 时，则判定 过程 失控\n\n\\(d\\) 和 \\(B\\) 的取值一般有 3 种：\n\n\\(d = 0.25\\)，\\(B = 8.00\\)\n\\(d = 0.50\\)，\\(B = 4.77\\)\n\\(d = 1\\) ，\\(B = 2.49\\)\n\n如上的任何一种选择所产生的控制规则的误报率都与在子组平均值与 \\(\\mu\\) 的差值首次超过 \\(3\\sigma/\\sqrt{n}\\) 时就判定 过程 失控的 \\(\\overline{X}\\)-控制图大致相同。作为一个通用的经验法则，当想要防范的均值变化越小时，所选的 \\(d\\) 值就应该越小。",
    "crumbs": [
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>质量控制</span>"
    ]
  },
  {
    "objectID": "chapter_13/13.html#problems",
    "href": "chapter_13/13.html#problems",
    "title": "13  质量控制",
    "section": "Problems",
    "text": "Problems",
    "crumbs": [
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>质量控制</span>"
    ]
  },
  {
    "objectID": "chapter_14/14.html",
    "href": "chapter_14/14.html",
    "title": "14  Life testing",
    "section": "",
    "text": "14.1 Introduction",
    "crumbs": [
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Life testing</span>"
    ]
  },
  {
    "objectID": "chapter_14/14.html#hazardrate-functions",
    "href": "chapter_14/14.html#hazardrate-functions",
    "title": "14  Life testing",
    "section": "14.2 Hazardrate functions",
    "text": "14.2 Hazardrate functions",
    "crumbs": [
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Life testing</span>"
    ]
  },
  {
    "objectID": "chapter_14/14.html#the-exponential-distribution-in-life-testing.",
    "href": "chapter_14/14.html#the-exponential-distribution-in-life-testing.",
    "title": "14  Life testing",
    "section": "14.3 The exponential distribution in life testing.",
    "text": "14.3 The exponential distribution in life testing.",
    "crumbs": [
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Life testing</span>"
    ]
  },
  {
    "objectID": "chapter_14/14.html#a-two-sample-problem",
    "href": "chapter_14/14.html#a-two-sample-problem",
    "title": "14  Life testing",
    "section": "14.4 A two-sample problem",
    "text": "14.4 A two-sample problem",
    "crumbs": [
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Life testing</span>"
    ]
  },
  {
    "objectID": "chapter_14/14.html#the-weibull-distribution-in-life-testing",
    "href": "chapter_14/14.html#the-weibull-distribution-in-life-testing",
    "title": "14  Life testing",
    "section": "14.5 The Weibull distribution in life testing",
    "text": "14.5 The Weibull distribution in life testing",
    "crumbs": [
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Life testing</span>"
    ]
  },
  {
    "objectID": "chapter_14/14.html#problems",
    "href": "chapter_14/14.html#problems",
    "title": "14  Life testing",
    "section": "Problems",
    "text": "Problems",
    "crumbs": [
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Life testing</span>"
    ]
  },
  {
    "objectID": "chapter_15/15.html",
    "href": "chapter_15/15.html",
    "title": "15  Simulation, bootstrap statistical methods, and permutation tests",
    "section": "",
    "text": "15.1 Introduction",
    "crumbs": [
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>Simulation, bootstrap statistical methods, and permutation tests</span>"
    ]
  },
  {
    "objectID": "chapter_15/15.html#random-numbers",
    "href": "chapter_15/15.html#random-numbers",
    "title": "15  Simulation, bootstrap statistical methods, and permutation tests",
    "section": "15.2 Random numbers",
    "text": "15.2 Random numbers",
    "crumbs": [
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>Simulation, bootstrap statistical methods, and permutation tests</span>"
    ]
  },
  {
    "objectID": "chapter_15/15.html#the-bootstrap-method",
    "href": "chapter_15/15.html#the-bootstrap-method",
    "title": "15  Simulation, bootstrap statistical methods, and permutation tests",
    "section": "15.3 The bootstrap method",
    "text": "15.3 The bootstrap method",
    "crumbs": [
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>Simulation, bootstrap statistical methods, and permutation tests</span>"
    ]
  },
  {
    "objectID": "chapter_15/15.html#permutation-tests",
    "href": "chapter_15/15.html#permutation-tests",
    "title": "15  Simulation, bootstrap statistical methods, and permutation tests",
    "section": "15.4 Permutation tests",
    "text": "15.4 Permutation tests",
    "crumbs": [
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>Simulation, bootstrap statistical methods, and permutation tests</span>"
    ]
  },
  {
    "objectID": "chapter_15/15.html#generating-discrete-random-variables",
    "href": "chapter_15/15.html#generating-discrete-random-variables",
    "title": "15  Simulation, bootstrap statistical methods, and permutation tests",
    "section": "15.5 Generating discrete random variables",
    "text": "15.5 Generating discrete random variables",
    "crumbs": [
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>Simulation, bootstrap statistical methods, and permutation tests</span>"
    ]
  },
  {
    "objectID": "chapter_15/15.html#generating-continuous-random-variables",
    "href": "chapter_15/15.html#generating-continuous-random-variables",
    "title": "15  Simulation, bootstrap statistical methods, and permutation tests",
    "section": "15.6 Generating continuous random variables",
    "text": "15.6 Generating continuous random variables",
    "crumbs": [
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>Simulation, bootstrap statistical methods, and permutation tests</span>"
    ]
  },
  {
    "objectID": "chapter_15/15.html#determining-the-number-of-simulation-runs-in-a-monte-carlo-study",
    "href": "chapter_15/15.html#determining-the-number-of-simulation-runs-in-a-monte-carlo-study",
    "title": "15  Simulation, bootstrap statistical methods, and permutation tests",
    "section": "15.7 Determining the number of simulation runs in a Monte Carlo study",
    "text": "15.7 Determining the number of simulation runs in a Monte Carlo study",
    "crumbs": [
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>Simulation, bootstrap statistical methods, and permutation tests</span>"
    ]
  },
  {
    "objectID": "chapter_15/15.html#problems",
    "href": "chapter_15/15.html#problems",
    "title": "15  Simulation, bootstrap statistical methods, and permutation tests",
    "section": "Problems",
    "text": "Problems",
    "crumbs": [
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>Simulation, bootstrap statistical methods, and permutation tests</span>"
    ]
  },
  {
    "objectID": "chapter_16/16.html",
    "href": "chapter_16/16.html",
    "title": "16  Machine learning and big data",
    "section": "",
    "text": "16.1 Introduction",
    "crumbs": [
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>Machine learning and big data</span>"
    ]
  },
  {
    "objectID": "chapter_16/16.html#late-flight-probabilities",
    "href": "chapter_16/16.html#late-flight-probabilities",
    "title": "16  Machine learning and big data",
    "section": "16.2 Late flight probabilities",
    "text": "16.2 Late flight probabilities",
    "crumbs": [
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>Machine learning and big data</span>"
    ]
  },
  {
    "objectID": "chapter_16/16.html#the-naive-bayes-approach",
    "href": "chapter_16/16.html#the-naive-bayes-approach",
    "title": "16  Machine learning and big data",
    "section": "16.3 The naive Bayes approach",
    "text": "16.3 The naive Bayes approach",
    "crumbs": [
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>Machine learning and big data</span>"
    ]
  },
  {
    "objectID": "chapter_16/16.html#distance-based-estimators.the-k-nearest-neighbors-rule",
    "href": "chapter_16/16.html#distance-based-estimators.the-k-nearest-neighbors-rule",
    "title": "16  Machine learning and big data",
    "section": "16.4 Distance-based estimators.The \\(k\\)-nearest neighbors rule",
    "text": "16.4 Distance-based estimators.The \\(k\\)-nearest neighbors rule",
    "crumbs": [
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>Machine learning and big data</span>"
    ]
  },
  {
    "objectID": "chapter_16/16.html#assessing-the-approaches",
    "href": "chapter_16/16.html#assessing-the-approaches",
    "title": "16  Machine learning and big data",
    "section": "16.5 Assessing the approaches",
    "text": "16.5 Assessing the approaches",
    "crumbs": [
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>Machine learning and big data</span>"
    ]
  },
  {
    "objectID": "chapter_16/16.html#when-characterizing-vectors-are-quantitative",
    "href": "chapter_16/16.html#when-characterizing-vectors-are-quantitative",
    "title": "16  Machine learning and big data",
    "section": "16.6 When characterizing vectors are quantitative",
    "text": "16.6 When characterizing vectors are quantitative",
    "crumbs": [
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>Machine learning and big data</span>"
    ]
  },
  {
    "objectID": "chapter_16/16.html#choosing-the-best-probability-a-bandit-problem",
    "href": "chapter_16/16.html#choosing-the-best-probability-a-bandit-problem",
    "title": "16  Machine learning and big data",
    "section": "16.7 Choosing the best probability: a bandit problem",
    "text": "16.7 Choosing the best probability: a bandit problem",
    "crumbs": [
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>Machine learning and big data</span>"
    ]
  },
  {
    "objectID": "chapter_16/16.html#problems",
    "href": "chapter_16/16.html#problems",
    "title": "16  Machine learning and big data",
    "section": "16.8 Problems",
    "text": "16.8 Problems",
    "crumbs": [
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>Machine learning and big data</span>"
    ]
  },
  {
    "objectID": "test.html",
    "href": "test.html",
    "title": "17  测试脚本",
    "section": "",
    "text": "图 17.1 展示了对温度和臭氧水平之间的进一步研究.\n\n\n代码\nlibrary(ggplot2)\n\nggplot(airquality, aes(Temp, Ozone)) + \n  geom_point() + \n  geom_smooth(method = \"loess\")\n\n\n\n\n\n\n\n\n图 17.1: 温度和臭氧水平\n\n\n\n\n\n\n\n代码\nlibrary(knitr)\ndf &lt;- data.frame(Name = c(\"Alice\", \"Bob\", \"Charlie\"), Age = c(25, 30, 35))  \nkable(df)\n\n\n\n\n表 17.1: 年龄分布\n\n\n\n\n\n\nName\nAge\n\n\n\n\nAlice\n25\n\n\nBob\n30\n\n\nCharlie\n35",
    "crumbs": [
      "<span class='chapter-number'>17</span>  <span class='chapter-title'>测试脚本</span>"
    ]
  },
  {
    "objectID": "appendices.html",
    "href": "appendices.html",
    "title": "附录 A — 表格",
    "section": "",
    "text": "表 A.1: \\(C(m, d, \\alpha)\\) 的值\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\(d\\)\n\\(\\alpha\\)\nm=2\nm=3\nm=4\nm=5\nm=6\nm=7\nm=8\nm=9\nm=10\nm=11\n\n\n\n\n5\n.05\n3.64\n4.60\n5.22\n5.67\n6.03\n6.33\n6.58\n6.80\n6.99\n7.17\n\n\n\n.01\n5.70\n6.98\n7.80\n8.42\n8.91\n9.32\n9.67\n9.97\n10.24\n10.48\n\n\n6\n.05\n3.46\n4.34\n4.90\n5.30\n5.63\n5.90\n6.12\n6.32\n6.49\n6.65\n\n\n\n.01\n5.24\n6.33\n7.03\n7.56\n7.97\n8.32\n8.61\n8.87\n9.10\n9.30\n\n\n7\n.05\n3.34\n4.16\n4.68\n5.06\n5.36\n5.61\n5.82\n6.00\n6.16\n6.30\n\n\n\n.01\n4.95\n5.92\n6.54\n7.01\n7.37\n7.68\n7.94\n8.17\n8.37\n8.55\n\n\n8\n.05\n3.26\n4.04\n4.53\n4.89\n5.17\n5.40\n5.60\n5.77\n5.92\n6.05\n\n\n\n.01\n4.75\n5.64\n6.20\n6.62\n6.96\n7.24\n7.47\n7.68\n7.86\n8.03\n\n\n9\n.05\n3.20\n3.95\n4.41\n4.76\n5.02\n5.24\n5.43\n5.59\n5.74\n5.87\n\n\n\n.01\n4.60\n5.43\n5.96\n6.35\n6.66\n6.91\n7.13\n7.33\n7.49\n7.65\n\n\n10\n.05\n3.15\n3.88\n4.33\n4.65\n4.91\n5.12\n5.30\n5.46\n5.60\n5.72\n\n\n\n.01\n4.48\n5.27\n5.77\n6.14\n6.43\n6.67\n6.87\n7.05\n7.21\n7.36\n\n\n11\n.05\n3.11\n3.82\n4.26\n4.57\n4.82\n5.03\n5.20\n5.35\n5.49\n5.61\n\n\n\n.01\n4.39\n5.15\n5.62\n5.97\n6.25\n6.48\n6.67\n6.84\n6.99\n7.13\n\n\n12\n.05\n3.08\n3.77\n4.20\n4.51\n4.75\n4.95\n5.12\n5.27\n5.39\n5.51\n\n\n\n.01\n4.32\n5.05\n5.50\n5.84\n6.10\n6.32\n6.51\n6.67\n6.81\n6.94\n\n\n13\n.05\n3.06\n3.73\n4.15\n4.45\n4.69\n4.88\n5.05\n5.19\n5.32\n5.43\n\n\n\n.01\n4.26\n4.96\n5.40\n5.73\n5.98\n6.19\n6.37\n6.53\n6.67\n6.79\n\n\n14\n.05\n3.03\n3.70\n4.11\n4.41\n4.64\n4.83\n4.99\n5.13\n5.25\n5.36\n\n\n\n.01\n4.21\n4.89\n5.32\n5.63\n5.88\n6.08\n6.26\n6.41\n6.54\n6.66\n\n\n15\n.05\n3.01\n3.67\n4.08\n4.37\n4.59\n4.78\n4.94\n5.08\n5.20\n5.31\n\n\n\n.01\n4.17\n4.84\n5.25\n5.56\n5.80\n5.99\n6.16\n6.31\n6.44\n6.55\n\n\n16\n.05\n3.00\n3.65\n4.05\n4.33\n4.56\n4.74\n4.90\n5.03\n5.15\n5.26\n\n\n\n.01\n4.13\n4.79\n5.19\n5.49\n5.72\n5.92\n6.08\n6.22\n6.35\n6.46\n\n\n17\n.05\n2.98\n3.63\n4.02\n4.30\n4.52\n4.70\n4.86\n4.99\n5.11\n5.21\n\n\n\n.01\n4.10\n4.74\n5.14\n5.43\n5.66\n5.85\n6.01\n6.15\n6.27\n6.38\n\n\n18\n.05\n2.97\n3.61\n4.00\n4.28\n4.49\n4.67\n4.82\n4.96\n5.07\n5.17\n\n\n\n.01\n4.07\n4.70\n5.09\n5.38\n5.60\n5.79\n5.94\n6.08\n6.20\n6.31\n\n\n19\n.05\n2.96\n3.59\n3.98\n4.25\n4.47\n4.65\n4.79\n4.92\n5.04\n5.14\n\n\n\n.01\n4.05\n4.67\n5.05\n5.33\n5.55\n5.73\n5.89\n6.02\n6.14\n6.25\n\n\n20\n.05\n2.95\n3.58\n3.96\n4.23\n4.45\n4.62\n4.77\n4.90\n5.01\n5.11\n\n\n\n.01\n4.02\n4.64\n5.02\n5.29\n5.51\n5.69\n5.84\n5.97\n6.09\n6.19\n\n\n24\n.05\n2.92\n3.53\n3.90\n4.17\n4.37\n4.54\n4.68\n4.81\n4.92\n5.01\n\n\n\n.01\n3.96\n4.55\n4.91\n5.17\n5.37\n5.54\n5.69\n5.81\n5.92\n6.02\n\n\n30\n.05\n2.89\n3.49\n3.85\n4.10\n4.30\n4.46\n4.60\n4.72\n4.82\n4.92\n\n\n\n.01\n3.89\n4.45\n4.80\n5.05\n5.24\n5.40\n5.54\n5.65\n5.76\n5.85\n\n\n40\n.05\n2.86\n3.44\n3.79\n4.04\n4.23\n4.39\n4.52\n4.63\n4.73\n4.82\n\n\n\n.01\n3.82\n4.37\n4.70\n4.93\n5.11\n5.26\n5.39\n5.50\n5.60\n5.69\n\n\n60\n.05\n2.83\n3.40\n3.74\n3.98\n4.16\n4.31\n4.44\n4.55\n4.65\n4.73\n\n\n\n.01\n3.76\n4.28\n4.59\n4.82\n4.99\n5.13\n5.25\n5.36\n5.45\n5.53\n\n\n120\n.05\n2.80\n3.36\n3.68\n3.92\n4.10\n4.24\n4.36\n4.47\n4.56\n4.64\n\n\n\n.01\n3.70\n4.20\n4.50\n4.71\n4.87\n5.01\n5.12\n5.21\n5.30\n5.37\n\n\n∞\n.05\n2.77\n3.31\n3.63\n3.86\n4.03\n4.17\n4.29\n4.39\n4.47\n4.55\n\n\n\n.01\n3.64\n4.12\n4.40\n4.60\n4.76\n4.88\n4.99\n5.08\n5.16\n5.23",
    "crumbs": [
      "附录",
      "<span class='chapter-number'>A</span>  <span class='chapter-title'>表格</span>"
    ]
  }
]