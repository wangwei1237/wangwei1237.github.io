<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>ç”¨ç¤ºä¾‹æ­å¼€ MCP çš„ç¥ç§˜é¢çº±</title>
    <url>/2025/04/17/Unveiling-the-Mystery-of-MCP-with-Examples/</url>
    <content><![CDATA[<p><img src="/2025/04/17/Unveiling-the-Mystery-of-MCP-with-Examples/1.jpg" alt></p>
<p>2024 å¹´ 11 æœˆ 25 æ—¥ï¼ŒAnthropic åœ¨å®˜æ–¹åšå®¢ <a href="https://www.anthropic.com/news/model-context-protocol">Introducing the Model Context Protocol</a> ä¸­æ­£å¼å¼€æºäº†å¯ä»¥å°†å„ç§å·¥å…·é“¾æ¥åˆ° LLM çš„ MCPï¼ˆ<em>Model Context Protocol</em>ï¼‰åè®®ï¼Œä»¥å¢å¼º LLM çš„èƒ½åŠ›ã€‚</p>
<blockquote>
<p>Today, weâ€™re open-sourcing the Model Context Protocol (MCP), a new standard for connecting AI assistants to the systems where data lives, including content repositories, business tools, and development environments. Its aim is to help frontier models produce better, more relevant responses.</p>
</blockquote>
<span id="more"></span>
<h2 id="ç¼˜èµ·">ç¼˜èµ·</h2>
<p>èµ·åˆçš„æ—¶å€™ï¼ŒMCP å¹¶æ²¡æœ‰å¼•èµ·æˆ‘çš„æ³¨æ„ï¼Œå› ä¸ºæ ¹æ® <a href="https://modelcontextprotocol.io/introduction">MCP å®˜æ–¹æ–‡æ¡£</a> ä¸­å¯¹ MCP æ¶æ„çš„æè¿°å¯çŸ¥ï¼Œå®¿ä¸»ç¨‹åºé€šè¿‡ <code>MCP-Client</code> å’Œ <code>MCP-Server</code> è¿›è¡Œé€šä¿¡ä»¥è·å¾—å½“å‰å¯ç”¨çš„å¤–éƒ¨å·¥å…·åˆ—è¡¨ä¿¡æ¯ï¼ŒåŒæ—¶å®¿ä¸»ç¨‹åºé€šè¿‡ <code>MCP-Client</code> å‘ <code>MCP-Server</code> å‘é€è¯·æ±‚ä»¥è·å¾—å…·ä½“çš„å¤–éƒ¨æ•°æ®æˆ–è€…å¤–éƒ¨ API çš„è°ƒç”¨ã€‚</p>
<pre class="mermaid">flowchart LR
    %% å­å›¾ Your Computer åŒºåŸŸ
    subgraph "Your Computer"
        direction TB
        Host["Host with MCP Client<br>(Claude, IDEs, Tools)"]
        S1["MCP Server A"]
        S2["MCP Server B"]
        S3["MCP Server C"]
        D1[("Local<br>Data Source A")]
        D2[("Local<br>Data Source B")]
        
        Host e1@-->|MCP Protocol| S1
        Host e2@-->|MCP Protocol| S2
        Host e3@-->|MCP Protocol| S3
        S1 e4@--> D1
        S2 e5@--> D2
        e1@{ animate: true }
        e2@{ animate: true }
        e3@{ animate: true }
        e4@{ animate: true }
        e5@{ animate: true }
    end

    %% å­å›¾ Internet åŒºåŸŸåœ¨å³ä¾§
    subgraph "Internet"
        direction TB
        D3[("Remote<br>Service C")]
    end

    S3 e6@-->|Web APIs| D3
    e6@{ animate: true }</pre>
<p>ä»¥è·å–å¤©æ°”ä¿¡æ¯çš„åœºæ™¯ä¸ºä¾‹ï¼šå®¿ä¸»ç¨‹åºé€šè¿‡ <code>MCP-Client</code> å‘ <code>MCP-Server</code> å‘é€è¯·æ±‚ä»¥è·å–å¤©æ°”ä¿¡æ¯ï¼Œ<code>MCP-Server</code> ä¼šè°ƒç”¨å…·ä½“çš„å¤©æ°”æœåŠ¡ API è·å–ç»“æœå¹¶è¿”å›ç»™ <code>MCP-Client</code>ã€‚</p>
<pre class="mermaid">sequenceDiagram
    autonumber
    participant Client as Client
    participant MCP as MCP Server
    participant WeatherTool as Weather Service

    Client->>MCP: mcp.call("weather.get", {"city": "Tokyo"})
    MCP->>WeatherTool: GET /weather?city=Tokyo
    WeatherTool-->>MCP: { "temp": 18, "humidity": 65 }
    MCP-->>Client: Result({ "temp": 18, "humidity": 65 })</pre>
<p>è€Œè¿™ä¸ªè¿‡ç¨‹å®é™…ä¸Šå’Œ OpenAI çš„ <a href="https://platform.openai.com/docs/guides/function-calling?api-mode=responses"><code>Function Calling</code></a> æ²¡æœ‰å¤ªå¤§åŒºåˆ«ï¼Œè¡¨é¢ä¸Šçœ‹èµ·æ¥ä»…ä»…æ˜¯å¯¹å·¥å…·çš„å‘ç°æ–¹å¼è¿›è¡Œäº†é‡æ–°å®šä¹‰è€Œå·²ã€‚çœ‹èµ·æ¥ï¼ŒMCP å¼•å…¥äº† <code>Client</code> å’Œ <code>Server</code> çš„æ¦‚å¿µï¼Œå®é™…ä¸Šåªæ˜¯å°† <code>Function Calling</code> ä¸­çš„å·¥å…·å‘ç°å’Œè°ƒç”¨è¿›è¡Œäº†æ‹†åˆ†ï¼Œæœ¬è´¨ä¸Šå¹¶æ²¡æœ‰å¸¦æ¥æ–°çš„ä¸œè¥¿ã€‚å› æ­¤ï¼Œå½“ MCP åˆšåˆšå‘å¸ƒçš„æ—¶å€™ï¼Œæˆ‘åªæ˜¯ç®€å•çœ‹äº†ä¸€ä¸‹è€Œå·²ï¼Œå¹¶æ²¡æœ‰æ·±å…¥ç ”ç©¶ã€‚</p>
<p>ç›´åˆ° 2025 å¹´ 3 æœˆçš„æ—¶å€™ï¼ŒMCP çªç„¶çˆ†çº¢ï¼Œæˆä¸ºäº† LLM é¢†åŸŸçš„çƒ­é—¨è¯é¢˜ã€‚</p>
<ul>
<li>3 æœˆ 8 æ—¥ï¼ŒLangChain CEO Harrison Chase ä¸ LangChain åˆ›å§‹å·¥ç¨‹å¸ˆã€LangGraph è´Ÿè´£äºº Nuno Campos å›´ç»•ç€ <a href="https://blog.langchain.dev/mcp-fad-or-fixture/"><em>MCP æ˜¯çœŸæ­£çš„æŠ€æœ¯çªç ´ï¼Œè¿˜æ˜¯ AI ç‚’ä½œæµªæ½®ä¸‹çš„åˆä¸€æœµæµªèŠ±ï¼Ÿ</em></a> è¿™ä¸€è¯é¢˜å±•å¼€äº†æ¿€åŠ±çš„è®¨è®ºã€‚åœ¨è®¨è®ºä¸­ï¼ŒHarrison æ›´çœ‹å¥½ MCPï¼Œå¹¶è®¤ä¸ºå¦‚æœéœ€è¦å‘æ— æ³•æ§åˆ¶çš„æ™ºèƒ½ä½“ä¸­å¼•å…¥å·¥å…·ï¼ŒMCP å°±æ˜¯æœ€å¥½çš„é€‰æ‹©ã€‚è€Œ Nuno åˆ™è®¤ä¸ºï¼ŒMCP çš„æ½œåŠ›ä¸Šé™ä¹Ÿå°±åˆ° Zapier è¿™ä¸ªç¨‹åº¦äº†ï¼Œå®ƒè‡³å°‘å¾—å˜å¾—æ›´åƒ OpenAI çš„è‡ªå®šä¹‰ GPTï¼Œæ‰é…å¾—ä¸Šå¤§å®¶å¦‚ä»Šå¯¹å®ƒçš„å…³æ³¨å’ŒæœŸå¾…ã€‚</li>
<li>3 æœˆ 9 æ—¥ï¼ŒLangChain åœ¨ <a href="https://x.com/LangChainAI/status/1898410721215750487">X å¹³å°ä¸Šå‘èµ·äº†ä¸€é¡¹æŠ•ç¥¨</a>ï¼šç»“åˆå®é™…ç”¨ä¾‹ã€ä¸ OpenAI Plugin çš„æ¯”è¾ƒä»¥åŠ MCP è‡ªèº«çš„å±€é™æ€§ï¼Œå¤§å®¶è®¤ä¸º MCP åˆ°åº•æ˜¯æ˜™èŠ±ä¸€ç°ã€è¿˜æ˜¯æœªæ¥æ ‡å‡†ï¼Ÿæ ¹æ® 473 ä¸ªç”¨æˆ·çš„æŠ•ç¥¨ç»“æœæ˜¾ç¤ºï¼Œæœ‰ 40.8% çš„äººè®¤ä¸º MCP æ˜¯æœªæ¥æ ‡å‡†ï¼Œ25.8% çš„äººè®¤ä¸º MCP åªæ˜¯æ˜™èŠ±ä¸€ç°ï¼Œå‰©ä¸‹ 33.4% çš„äººé€‰æ‹©è§‚æœ›ã€‚<br>
<img src="/2025/04/17/Unveiling-the-Mystery-of-MCP-with-Examples/langchain_vote.png" alt></li>
<li>3 æœˆ 27 æ—¥ï¼ŒOpenAI çš„ CEO Sam Altman åœ¨ <a href="https://x.com/sama/status/1904957253456941061">X å¹³å°å‘æ¶ˆæ¯ç§°</a>ï¼šæˆ‘ä»¬å¾ˆé«˜å…´åœ¨æˆ‘ä»¬çš„äº§å“ä¸­å¢åŠ å¯¹ MCP çš„æ”¯æŒï¼Œagent SDK å·²ç»å¯ä»¥æ”¯æŒ MCPï¼Œå¹¶ä¸” ChatGPT æ¡Œé¢åº”ç”¨ç¨‹åº å’Œ API ä¹Ÿå°†å¾ˆå¿«å°±ä¼šå¢åŠ å¯¹ MCP çš„æ”¯æŒã€‚OpenAI å¯¹ MCP çš„æ”¯æŒï¼Œæ— ç–‘åŠ é€Ÿäº† MCP çš„å‘å±•ï¼ŒåŒæ—¶ä¹Ÿæ„å‘³ç€ MCP æˆä¸ºè¡Œä¸šæ ‡å‡†çš„å¯èƒ½æ€§ä¹Ÿè¶Šæ¥è¶Šå¤§ã€‚</li>
<li>4 æœˆï¼Œé˜¿é‡Œäº‘ã€è…¾è®¯äº‘ã€ç™¾åº¦æ™ºèƒ½äº‘ç­‰äº‘æœåŠ¡å•†ä¹Ÿçº·çº·å®£å¸ƒæ”¯æŒ MCP åè®®ï¼Œè¿›ä¸€æ­¥åŠ é€Ÿäº† MCP åœ¨å›½å†…çš„å‘å±•ã€‚</li>
<li>æ ¹æ® <a href="https://smithery.ai/">Smithery</a>ã€<a href="https://github.com/modelcontextprotocol/servers">modelcontextprotocol/servers</a>ã€<a href="https://modelscope.cn/mcp">modelscope MCP å¹¿åœº</a> ç­‰å¹³å°çš„ä¿¡æ¯ï¼Œç›®å‰å·²ç»æœ‰ä¸Šåƒæ¬¾ MCP å·¥å…·å¯ä¾›ä½¿ç”¨ï¼Œä»æ­¤ä¹Ÿå¯ä»¥çœ‹å‡º MCP çš„ç¤¾åŒºç”Ÿæ€å‘å±•ä¹‹å¿«ã€‚</li>
</ul>
<p>çœŸæ­£ä»¤æˆ‘å¿ƒåŠ¨ã€æƒ³è¦æ·±å…¥ç ”ç©¶ä¸€ä¸‹ MCP çš„äº‹æƒ…è¿˜æ˜¯ 4 æœˆ 8 æ—¥ Github å®˜æ–¹å¼€æºäº†è‡ªå·±çš„ MCP Serverâ€”â€”<a href="https://github.com/github/github-mcp-server">github-mcp-server</a> ä»¥é‡æ–°å®šä¹‰ GitHub è‡ªåŠ¨åŒ–ã€‚æˆ‘è‡ªå·±å¹³æ—¶ä½¿ç”¨ Github æ¯”è¾ƒå¤šï¼Œå¾ˆå¤šé¡¹ç›®éƒ½ä¼šé‡‡ç”¨ Github çš„ Actions è§¦å‘ç›¸å…³çš„è‡ªåŠ¨åŒ–æµæ°´çº¿æ‰§è¡Œï¼Œæ—©åœ¨ 2021 å¹´<a href="/2021/06/15/Preliminary-Exploration-of-the-GraphQL/">è°ƒç ” GraphQL</a> çš„æ—¶å€™ï¼Œå°±å¯¹ Github çš„ API è¿›è¡Œäº†éå¸¸æ·±å…¥çš„ç ”ç©¶ã€‚å› æ­¤ï¼ŒGithub MCP Server çš„å¼€æºå¯¹æˆ‘è§¦åŠ¨æ¯”è¾ƒå¤§ï¼Œæˆ‘ç¬¬ä¸€æ¬¡èŒç”Ÿäº†æƒ³çœ‹çœ‹ MCP ç©¶ç«Ÿæ˜¯ä»€ä¹ˆçš„æƒ³æ³•ã€‚</p>
<p>äºæ˜¯ï¼Œæˆ‘å¼€å§‹ç–¯ç‹‚çš„åœ¨ Github Copilot ä¸­ã€åœ¨ Cline ä¸­ã€åœ¨å…¶ä»–çš„å¼€æº MCP Client ä¸­ä¸åœçš„ä½¿ç”¨ Github MCP Serverï¼Œä¹Ÿåœ¨ä¸åœçš„ä½¿ç”¨è¿‡ç¨‹ä¸­æ…¢æ…¢çš„å¯¹ MCP æœ‰äº†æ›´æ–°çš„è®¤è¯†ã€‚</p>
<p>æœ¬æ–‡å°†ä»¥ <a href="https://github.com/adhikasp/mcp-client-cli">mcp-client-cli</a> å’Œ <a href="https://github.com/github/github-mcp-server">github-mcp-server</a>ã€<a href="https://github.com/CodeByWaqas/weather-mcp-server">weather-mcp-server</a>ã€<a href="https://github.com/bytebase/dbhub">dbhub</a> ä¸ºå…·ä½“çš„ä¾‹å­ï¼Œæ¥ä¸€æ­¥æ­¥çš„æ­å¼€ MCP çš„ç¥ç§˜é¢çº±ã€‚</p>
<h2 id="function-calling">Function Calling</h2>
<p>é¢„è®­ç»ƒå¤§æ¨¡å‹çš„è®­ç»ƒçŸ¥è¯†å­˜åœ¨ä¸€ä¸ªæˆªæ­¢æ—¥æœŸï¼Œä¾‹å¦‚ <a href="https://platform.openai.com/docs/models/o3">o3</a> çš„è®­ç»ƒçŸ¥è¯†æˆªæ­¢æ—¥æœŸæ˜¯ 2024 å¹´ 6 æœˆ 1 æ—¥ï¼Œ<a href="https://platform.openai.com/docs/models/gpt-4o">GPT-4o</a> çš„è®­ç»ƒçŸ¥è¯†æˆªæ­¢æ—¥æœŸæ˜¯ 2023 å¹´ 10 æœˆ 1 æ—¥ã€‚</p>
<p><img src="/2025/04/17/Unveiling-the-Mystery-of-MCP-with-Examples/openai_kco.png" alt="ä¸åŒæ¨¡å‹çš„è®­ç»ƒæ•°æ®æˆªæ­¢æ—¥æœŸ"></p>
<p>å¤§è¯­è¨€æ¨¡å‹çš„æœ¬è´¨æ˜¯åœ¨è®­ç»ƒçŸ¥è¯†çš„ç¯å¢ƒä¸­ï¼Œé¢„æµ‹ä¸‹ä¸€ä¸ª tokenã€‚å¦‚æœä¸èƒ½ä¸å¤–éƒ¨ç³»ç»Ÿäº¤äº’ï¼Œæ¨¡å‹å°±åªèƒ½æ¨¡ä»¿ï¼Œæ— æ³•æˆä¸ºçœŸæ­£èƒ½å¹²äº‹çš„â€œåŠ©æ‰‹â€ã€‚æ¨¡å‹ä¹Ÿæ°¸è¿œåªèƒ½åœ¨â€œè¯­è¨€çš„æ²™ç®±â€ä¸­ç©è€ï¼Œæ— æ³•è·³å‡ºæ¨¡å‹çš„çŸ¥è¯†è¾¹ç•Œå»æ”¹å˜ä¸–ç•Œã€‚æœ€ç»ˆï¼Œæ¨¡å‹æ— æ³•å›ç­”æŸäº›æœ€æ–°çš„ã€è¶…å‡ºå…¶è®­ç»ƒæˆªæ­¢æ—¥æœŸçš„é—®é¢˜ï¼Œä¹Ÿæ— æ³•å®ŒæˆæŸäº›ç‰¹å®šçš„åŠ¨ä½œï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>æ˜å¤©åŒ—äº¬çš„å¤©æ°”å¦‚ä½•</li>
<li>é¢„å®šä¸€å¼ ä»åŒ—äº¬åˆ°å¤©æ´¥çš„ç«è½¦ç¥¨</li>
<li>â€¦â€¦</li>
</ul>
<p>ä¸ºæ­¤ï¼ŒOpenAI åœ¨ 2023 å¹´ 6 æœˆ 13 æ—¥å‘å¸ƒäº† <a href="https://openai.com/index/function-calling-and-other-api-updates/">Function Calling</a> åŠŸèƒ½ï¼Œå¼€å‘è€…å¯ä»¥é€šè¿‡ Function Calling è§£å†³æ¨¡å‹ä¸å¤–éƒ¨ç³»ç»Ÿäº¤äº’ã€è°ƒç”¨é€»è¾‘ç¨‹åºã€è·å–æœ€æ–°æ•°æ®ç­‰æ–¹é¢çš„å…³é”®é™åˆ¶ï¼Œä»¥å®ç°åœ¨éœ€è¦æ—¶è°ƒç”¨å¤–éƒ¨ API è·å–æœ€æ–°ä¿¡æ¯æˆ–æ‰§è¡Œç‰¹å®šæ“ä½œï¼Œè¿›è€Œä½¿å¾—å¤§è¯­è¨€æ¨¡å‹ä»â€œå¯¹è¯ç”Ÿæˆå™¨â€å‡çº§ä¸ºâ€œæ™ºèƒ½åŠ©æ‰‹â€ã€‚</p>
<p>æ ¹æ® <a href="https://platform.openai.com/docs/guides/function-calling?api-mode=responses">OpenAI çš„å®˜æ–¹æ–‡æ¡£ä¸­ç»™å‡ºçš„ç¤ºä¾‹ä»£ç </a>ï¼Œé€šè¿‡ Function Calling æŸ¥è¯¢å¤©æ°”ä¿¡æ¯çš„æ­¥éª¤å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre class="mermaid">sequenceDiagram
    participant Developer
    participant Model

    Note over Developer,Model: Step 1 - Tool Definitions + Messages
    Developer->>Model: get_weather(location)<br>â€œWhatâ€™s the weather in Beijing?â€

    Note over Model: Step 2 - Tool Calls
    Model->>Developer: get_weather("Beijing")

    Note over Developer: Step 3 - Execute Function Code
    Developer->>Developer: get_weather("Beijing")<br>â†’ {"temperature": 14}

    Note over Developer,Model: Step 4 - Results
    Developer->>Model: All prior messages +<br>{"temperature": 14}

    Note over Model,Developer: Step 5 - Final Response
    Model->>Developer: "Itâ€™s currently 14Â°C in Beijing."</pre>
<h2 id="function-calling-çš„å±€é™æ€§">Function Calling çš„å±€é™æ€§</h2>
<ul>
<li>åœ¨ Function Calling ä¸­ï¼Œå¼€å‘è€…å¿…é¡»ä½¿ç”¨å®¿ä¸»è¯­è¨€ç¼–å†™ <code>tools</code> ä¸­å®šä¹‰çš„å·¥å…·ï¼Œè€Œä¸åŒçš„å®¿ä¸»å¯èƒ½ä¼šé‡‡ç”¨ä¸åŒçš„å˜æˆè¯­è¨€ï¼ˆpythonï¼Œjavascriptï¼Œgolangâ€¦â€¦ï¼‰ã€‚å› æ­¤ï¼Œå¯¹äºæŸä¸€å·¥å…·ï¼ˆ<code>get_weather()</code>ï¼‰è€Œè¨€ï¼Œè¯¥å·¥å…·çš„å¼€å‘è€…éœ€è¦é’ˆå¯¹ä¸åŒçš„å®¿ä¸»è¯­è¨€æ¥é‡æ–°ç¼–å†™è¯¥å·¥å…·ï¼Œæ— è®ºæ€æ ·ï¼Œè¿™éƒ½æ˜¯ä¸€ä»¶ä»¤äººè®¨åŒä¸ç—›è‹¦çš„äº‹æƒ…ã€‚è€Œè¿™ç§é‡å¤çš„ã€å…¼å®¹é€‚é…å·¥ä½œï¼Œå¿…ç„¶ä¼šé™ä½å·¥å…·æä¾›è€…çš„ç»´æŠ¤çƒ­æƒ…ï¼Œå·¥å…·æä¾›è€…ä¹Ÿä¸å¤ªå¯èƒ½å°†è‡ªå·±çš„å·¥å…·å…±äº«ç»™å…¶ä»–å®¿ä¸»ä½¿ç”¨ï¼Œå› æ­¤ä¹Ÿæ— æ³•å½¢æˆè‰¯å¥½çš„å·¥å…·å…±äº«ç”Ÿæ€ã€‚è¿™ä¹Ÿæ˜¯ Function Calling å‘å¸ƒè¿™ä¹ˆé•¿æ—¶é—´ä»¥æ¥ä¸€ç›´æ²¡æœ‰å½¢æˆè‰¯å¥½çš„å·¥å…·ç”Ÿæ€çš„åŸå› ä¹‹ä¸€ã€‚</li>
</ul>
<pre class="mermaid">    flowchart LR
    subgraph Host
        Python["Python"] 
        Golang["Golang"] 
        JavaScript["Java<br>Script"] 
    end

    subgraph Host Tools
        Python["Python"] e1@--> PythonTools[py_tools]
        Golang["Golang"] e2@--> GoTools[go_tools]
        JavaScript["Java<br>Script"] e3@--> JsTools[js_tools]
    end

    PythonTools e4@--> SharedTools[tools]
    JsTools e5@--> SharedTools
    GoTools e6@--> SharedTools

    e1@{ animate: true }
    e2@{ animate: true }
    e3@{ animate: true }
    e4@{ animate: true }
    e5@{ animate: true }
    e6@{ animate: true }</pre>
<ul>
<li>åœ¨ Function Calling ä¸­ï¼ŒLLM èƒ½å¤Ÿæ£€æµ‹åˆ°çš„å·¥å…·æ˜¯é€šè¿‡ç¡¬ç¼–ç çš„æ–¹å¼è¿›è¡Œæ³¨å†Œçš„ï¼Œç¼ºä¹åŠ¨æ€åŠ è½½æˆ–è€…çƒ­æ›´æ–°çš„èƒ½åŠ›ï¼Œæ¯æ¬¡æ–°å¢å·¥å…·éƒ½éœ€è¦ä¿®æ”¹å®¿ä¸»ä»£ç ç”šè‡³é‡æ–°ç¼–è¯‘å®¿ä¸»ä»£ç ï¼Œå¯¹äºä¸­å¤§å‹çš„å®¿ä¸»è€Œè¨€ï¼Œé‡æ–°ç¼–è¯‘ã€é‡æ–°å‘å¸ƒéƒ½æ„å‘³ç€é¢å¤–çš„é£é™©å’Œæˆæœ¬ã€‚</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">response = client.responses.create(</span><br><span class="line">    model=<span class="string">&quot;gpt-4.1&quot;</span>,</span><br><span class="line">    <span class="built_in">input</span>=input_messages,</span><br><span class="line">    tools=tools,</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<ul>
<li>åœ¨ Function Calling ä¸­ï¼Œå¯¹å·¥å…·çš„è°ƒç”¨æ˜¯åŒæ­¥ã€å³æ—¶è°ƒç”¨ï¼Œæ•´ä¸ªè¿‡ç¨‹ä¸èƒ½æŒ‚èµ·ä»»åŠ¡æˆ–ä¸­æ–­åæ¢å¤ï¼Œä¹Ÿæ— æ³•æœ‰æ•ˆçš„å¼•å…¥äººå·¥æ ¡éªŒæœºåˆ¶ï¼Œå¯¹äºæŸäº›éœ€è¦äººå·¥ç¡®è®¤çš„ä»»åŠ¡ï¼ˆä¾‹å¦‚ï¼šæ˜¯å¦ç»§ç»­å‘é€é‚®ä»¶ã€æ˜¯å¦ç»§ç»­åˆ é™¤ç­‰ï¼‰ï¼ŒFunction Calling æ— æ³•æ»¡è¶³éœ€æ±‚ã€‚</li>
</ul>
<pre class="mermaid">flowchart LR
    Q[Query:<br>é¢„å®šæ˜å¤©åŒ—äº¬åˆ°å¤©æ´¥çš„è½¦ç¥¨] --> A[å‡½æ•°è°ƒç”¨ï¼š<br>æŸ¥è¯¢å¯é¢„è®¢è½¦ç¥¨]
    A --> B[äººå·¥å¹²é¢„ï¼š<br>é€‰æ‹©è½¦æ¬¡]
    B --> C[å‡½æ•°è°ƒç”¨ï¼š<br> æäº¤è®¢å•]
    C -->D[äººå·¥å¹²é¢„ï¼š<br> è®¢å•ç¡®è®¤]
    D -->E[å‡½æ•°è°ƒç”¨ï¼š<br> æ‰§è¡Œé¢„å®š]
    E --> F[ä»»åŠ¡å®Œæˆ]</pre>
<h2 id="mcp">MCP</h2>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition note"><p class="admonition-title">ä¸‡èƒ½çš„æŠ½è±¡å±‚ï¼Œæ— æ‰€ä¸èƒ½çš„ä¸­é—´ä»¶
</p><p><strong>æ²¡æœ‰ä»€ä¹ˆæ˜¯æŠ½è±¡ä¸€å±‚è§£å†³ä¸äº†çš„äº‹æƒ…ï¼Œå¦‚æœæœ‰ï¼Œé‚£å°±å†æŠ½è±¡ä¸€å±‚ã€‚</strong></p>
</div>
<h3 id="http-åè®®çš„ä¾‹å­">http åè®®çš„ä¾‹å­</h3>
<p>æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸ªä½¿ç”¨ golang ç¼–å†™æœåŠ¡æ¨¡å—çš„ä¾‹å­ï¼Œå…¥ä¸‹æ‰€ç¤ºï¼š</p>
<pre class="mermaid">flowchart LR
 subgraph s2["åŸºäº http çš„æœåŠ¡ç½‘å…³"]
        Nginx["Nginx"]
        ClientNew["Client"]
        ServiceA_new["Service A - Golang"]
        ServiceB_new["Service B - Python"]
  end
 subgraph s3["ä½¿ç”¨ golang å¼€å‘çš„æœåŠ¡æ¨¡å—"]
        ClientOld["Client"]
        GoModule["module M <br> golang"]
        ServiceA_old["Service A"]
        ServiceB_old["Service B"]

        ClientOld -- ç§æœ‰åè®® --> GoModule
        GoModule -- golangä»£ç  --> ServiceA_old
        GoModule -- golangä»£ç  --> ServiceB_old
  end
    ClientNew -- HTTP --> Nginx
    Nginx -- HTTP --> ServiceA_new & ServiceB_new
    s3 e1@ == ä½¿ç”¨ http åè®®æŠ½è±¡ä¸€å±‚ ==> s2

    style Nginx fill:#f9f,stroke:#333,stroke-width:1px
    e1@{ animate: true }</pre>
<p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œ<code>Client</code> ç§æœ‰é€šä¿¡åè®®ä¸ golang ç¼–å†™çš„ <code>Module M</code> é€šä¿¡ï¼Œè¯¥æ¨¡å—ä¼šæä¾› <code>Service A</code> å’Œ <code>Service B</code> ä¸¤ç§æœåŠ¡ã€‚æ­¤æ—¶ï¼Œå¦‚æœè¦ä¸º <code>Module M</code> å¢åŠ æ–°çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬åˆ™éœ€è¦ä¿®æ”¹åŸæœ‰çš„ <code>Service A</code> æˆ–è¿™ <code>Service B</code> çš„ä»£ç ï¼Œæˆ–è€…æ–°å¢ä¸€ä¸ª golang ç¼–å†™çš„ <code>Service C</code>ã€‚è€Œå¦‚æœæ­¤æ—¶ï¼Œä½ çš„å›¢é˜Ÿä¸­ golang å¼€å‘äººå‘˜æ­£åœ¨é«˜ä¼˜å¤„ç†å…¶ä»–é¡¹ç›®ï¼Œåªæœ‰ python å¼€å‘äººå‘˜æœ‰æ—¶é—´å¯ä»¥å¤„ç†è¿™ä¸ªé—®é¢˜ï¼Œé‚£ä¹ˆä½ å°±åªèƒ½ç­‰ç€äº†ã€‚</p>
<p>å½“ç„¶ï¼Œå¤§è¯­è¨€æ¨¡å‹çš„ç¼–ç¨‹èƒ½åŠ›å·²ç»ç›¸å½“æ£’äº†ï¼Œæˆ‘ä»¬å¯ä»¥å‡è®¾ python å¼€å‘è€…å¯ä»¥åœ¨å¤§è¯­è¨€æ¨¡å‹çš„å¸®åŠ©ä¸‹å®Œæˆ golang æ–°æœåŠ¡ <code>Service C</code> çš„å¼€å‘ã€‚ä½†æ˜¯æ¥ä¸‹æ¥çš„æµ‹è¯•ã€å‘å¸ƒã€ä¸Šçº¿ç­‰å·¥ä½œä»ç„¶éœ€è¦ç¹ççš„æµç¨‹ã€‚</p>
<p>è€Œå¦‚æœæˆ‘ä»¬æŠ½è±¡ä¸€å±‚ï¼Œ åœ¨ <code>Module M</code> ä¸ <code>Service A</code>ã€<code>Service B</code> ä¹‹é—´å¢åŠ ä¸€ä¸ª http çš„æœåŠ¡ç½‘å…³ <code>Nginx</code>ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ http åè®®æ¥è¿›è¡Œé€šä¿¡å¹¶æä¾›æœåŠ¡äº†ã€‚å¯¹äºæ–°å¢åŠ  <code>Service C</code> æ¨¡å—ï¼Œpython å¼€å‘äººå‘˜å®Œå…¨å¯ä»¥ä½¿ç”¨è‡ªå·±ç†Ÿæ‚‰çš„å¼€å‘æ ˆã€å‘å¸ƒæµç¨‹æ¥è¿›è¡Œå¼€å‘ã€æµ‹è¯•ã€å‘å¸ƒç­‰å·¥ä½œã€‚å½“ <code>Service C</code> æ¨¡å—å‘å¸ƒä¹‹åï¼Œåªéœ€è¦åœ¨ <code>Nginx</code> ä¸­å¢åŠ ä¸€æ¡è·¯ç”±è§„åˆ™å³å¯å®ç°æœåŠ¡çš„å‘å¸ƒã€‚åªè¦æˆ‘ä»¬å…è®¸ï¼Œå›¢é˜Ÿä¸­çš„ NodeJS å¼€å‘è€…ã€Java å¼€å‘è€…â€¦â€¦ä¸åŒè¯­è¨€æ ˆçš„å¼€å‘è€…éƒ½å¯ä»¥ä½¿ç”¨è‡ªå·±ç†Ÿæ‚‰çš„è¯­è¨€æ ˆæ¥æ‰©å±• <code>Module M</code>æœåŠ¡çš„åŠŸèƒ½ï¼Œè€Œ <code>Module M</code> çš„ç”Ÿæ€ä¹Ÿå°†è¶Šæ¥è¶Šä¸°å¯Œã€‚</p>
<p>åœ¨ http åè®®çš„åŸºç¡€ä¸Šï¼Œé€šè¿‡æŠ½è±¡å‡ºä¸€å±‚ <code>Nginx</code> æœåŠ¡ç½‘å…³å±‚ï¼Œæˆ‘ä»¬ä»æ¶æ„ä¸Šè§£å†³äº†ä¸åŒè¯­è¨€ã€ä¸åŒå¼€å‘æ ˆä¹‹é—´çš„è€¦åˆé—®é¢˜ï¼ŒåŒæ—¶ä¹Ÿè§£å†³äº†æœåŠ¡æ¨¡å—çš„çƒ­æ›´æ–°é—®é¢˜ã€‚</p>
<h3 id="mcp-åè®®çš„æœ¬è´¨">MCP åè®®çš„æœ¬è´¨</h3>
<p>ä»æœ¬è´¨ä¸Šï¼Œ<code>MCP åè®®</code> å’Œ <code>http åè®®</code> ä¸€æ ·ï¼Œæ˜¯å¤§è¯­è¨€æ¨¡å‹ä¸ä¸åŒå·¥å…·çš„é€šä¿¡åè®®ï¼Œå¤§æ¨¡å‹åŠ©æ‰‹ç¨‹åºä¸­çš„ <code>MCP Client</code> é€šè¿‡ <code>MCP åè®®</code> ä¸ <code>MCP Server</code> é€šä¿¡ï¼Œä»¥è·å–å·¥å…·åˆ—è¡¨å¹¶è°ƒç”¨å·¥å…·ã€‚æˆ‘ä»¬åœ¨æ¥å›é¡¾ä¸€ä¸‹æœ¬æ–‡å¼€å¤´æåˆ°çš„ MCP çš„æ¶æ„å›¾ï¼š</p>
<pre class="mermaid">flowchart LR
    %% å­å›¾ Your Computer åŒºåŸŸ
    subgraph "Your Computer"
        direction TB
        Host["Host with MCP Client<br>(Claude, IDEs, Tools)"]
        S1["MCP Server A"]
        S2["MCP Server B"]
        S3["MCP Server C"]
        D1[("Local<br>Data Source A")]
        D2[("Local<br>Data Source B")]
        
        Host e1@-->|MCP Protocol| S1
        Host e2@-->|MCP Protocol| S2
        Host e3@-->|MCP Protocol| S3
        S1 e4@--> D1
        S2 e5@--> D2
        e1@{ animate: true }
        e2@{ animate: true }
        e3@{ animate: true }
        e4@{ animate: true }
        e5@{ animate: true }
    end

    %% å­å›¾ Internet åŒºåŸŸåœ¨å³ä¾§
    subgraph "Internet"
        direction TB
        D3[("Remote<br>Service C")]
    end

    S3 e6@-->|Web APIs| D3
    e6@{ animate: true }</pre>
<p>å¦‚ä¸Šçš„ MCP æ¶æ„æ€»å…±åˆ†ä¸ºäº†äº”ä¸ªéƒ¨åˆ†ï¼š</p>
<ul>
<li><code>MCP Hosts</code>: Hosts æ˜¯æŒ‡é€šè¿‡ MCP åè®®è®¿é—®å¤–éƒ¨æ•°æ®çš„åº”ç”¨ç¨‹åºï¼Œä¾‹å¦‚ Claude Desktopã€Clineã€‚</li>
<li><code>MCP Clients</code>: å®¢æˆ·ç«¯æ˜¯åœ¨ Hosts åº”ç”¨ç¨‹åºå†…ï¼Œç”¨äºç»´æŠ¤ä¸ Server é€šä¿¡çš„æ¨¡å—ã€‚</li>
<li><code>MCP Servers</code>: é€šè¿‡æ ‡å‡†åŒ–çš„ <code>MCP åè®®</code>ï¼Œä¸º <code>MCP Client</code> æä¾›å·¥å…·ï¼ŒåŒæ—¶å…·ä½“çš„å·¥å…·æ‰§è¡Œä¹Ÿæ˜¯é€šè¿‡ <code>MCP Server</code> æ¥å®Œæˆã€‚</li>
<li><code>Local Data Sources</code>: æœ¬åœ°æ•°æ®èµ„æºï¼šæ–‡ä»¶ã€æ•°æ®åº“å’Œ APIã€‚</li>
<li><code>Remote Services</code>: ç½‘ç»œèµ„æºï¼šæ–‡ä»¶ã€æ•°æ®åº“å’Œ APIã€‚</li>
</ul>
<h2 id="åº”ç”¨-github-mcp-server">åº”ç”¨ github-mcp-server</h2>
<p>4 æœˆ 8 æ—¥ Github å®˜æ–¹å¼€æºäº†è‡ªå·±çš„ MCP Serverâ€”â€”<a href="https://github.com/github/github-mcp-server">github-mcp-server</a>ï¼Œå€ŸåŠ© github-mcp-serverï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è‡ªç„¶è¯­è¨€ä¸ Github è¿›è¡Œé€šä¿¡ä»¥é‡æ–°å®šä¹‰ GitHub è‡ªåŠ¨åŒ–ã€‚github-mcp-server æ˜¯ä¸€ä¸ªä½¿ç”¨ golang ç¼–å†™çš„ MCP Serverï¼Œå…¶åº•å±‚ä½¿ç”¨ <a href="https://github.com/google/go-github">go-github åŒ…</a> å®ç°äº†å¯¹ Github API çš„è°ƒç”¨ã€‚</p>
<p>ä»¥ <code>issue</code> ç›¸å…³çš„å·¥å…·ä¸ºä¾‹ï¼Œåœ¨ github-mcp-server ä¸­ï¼Œå…¶å…·ä½“çš„å®ç°é€»è¾‘ä½äº <a href="https://github.com/github/github-mcp-server/blob/main/pkg/github/issues.go">github-mcp-server/pkg/github/issues.go</a> æ–‡ä»¶ï¼Œå…¶æ ¸å¿ƒä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight golang"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> github</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;github.com/google/go-github/v69/github&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// GetIssue creates a tool to get details of a specific issue in a GitHub repository.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetIssue</span><span class="params">(getClient GetClientFn, t translations.TranslationHelperFunc)</span> <span class="params">(tool mcp.Tool, handler server.ToolHandlerFunc)</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> mcp.NewTool(<span class="string">&quot;get_issue&quot;</span>,</span><br><span class="line">			mcp.WithDescription(t(<span class="string">&quot;TOOL_GET_ISSUE_DESCRIPTION&quot;</span>, <span class="string">&quot;Get details of a specific issue in a GitHub repository&quot;</span>)),</span><br><span class="line">			...</span><br><span class="line">		), <span class="comment">// å·¥å…·å®šä¹‰</span></span><br><span class="line">		<span class="function"><span class="keyword">func</span><span class="params">(ctx context.Context, request mcp.CallToolRequest)</span> <span class="params">(*mcp.CallToolResult, error)</span></span> &#123;</span><br><span class="line">            ...</span><br><span class="line">			client, err := getClient(ctx)</span><br><span class="line">			issue, resp, err := client.Issues.Get(ctx, owner, repo, issueNumber)</span><br><span class="line">			r, err := json.Marshal(issue)</span><br><span class="line">			<span class="keyword">return</span> mcp.NewToolResultText(<span class="keyword">string</span>(r)), <span class="literal">nil</span></span><br><span class="line">		&#125; <span class="comment">// å·¥å…·è°ƒç”¨</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition note"><p class="admonition-title">VSCode ä¸­ä½¿ç”¨ github-mcp-server
</p><ol>
<li>æ ¹æ® github-mcp-server çš„æ–‡æ¡£ï¼Œæˆ‘ä»¬åœ¨æœ¬åœ°ç¼–è¯‘å¹¶ç”Ÿæˆ github-mcp-server å¯æ‰§è¡Œæ–‡ä»¶</li>
<li>åœ¨ VSCode ä¸­ç¼–è¾‘ <code>User/settings.json</code> æ–‡ä»¶ï¼Œå¢åŠ æ–‡æ¡£ä¸­ç»™å‡ºçš„ <code>MCP Server</code> é…ç½®
<img src="/2025/04/17/Unveiling-the-Mystery-of-MCP-with-Examples/githubmcpserver-vscode-setting.png" alt></li>
<li>ä½¿ç”¨ VSCode çš„ GitHub Copilot æ’ä»¶ï¼Œå¹¶é€‰æ‹© <code>ä»£ç†</code> æ¨¡å¼ï¼Œå¤§æ¨¡å‹é€‰æ‹© GPT-4oï¼Œå°±å¯ä»¥ä½¿ç”¨è‡ªç„¶è¯­è¨€æ¥ä¸ Github è¿›è¡Œäº¤äº’ã€‚
<img src="/2025/04/17/Unveiling-the-Mystery-of-MCP-with-Examples/github_mcp_server_demo.gif" alt></li>
</ol>
</div>
<p>ä¸ºäº†æµ‹è¯•æˆ‘ä»¬æœ¬åœ°ç¼–è¯‘çš„ github-mcp-server çš„å¯ç”¨æ€§ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨å¦‚ä¸‹çš„é›†ä¸­æ–¹å¼ï¼š</p>
<ol>
<li>
<p>é€šè¿‡ stdio ç®¡é“çš„æ–¹å¼æ¥ä¸ github-mcp-server è¿›è¡Œäº¤äº’ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥å¯åŠ¨ github-mcp-serverï¼š</p>
 <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="string">&#x27;&#123;&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;id&quot;:1,&quot;method&quot;:&quot;tools/list&quot;&#125;&#x27;</span> | /Users/wangwei17/Documents/Project/github/github-mcp-server/github-mcp-server stdio</span><br><span class="line"></span><br><span class="line">$ GitHub MCP Server running on stdio</span><br><span class="line">&#123;<span class="string">&quot;jsonrpc&quot;</span>:<span class="string">&quot;2.0&quot;</span>,<span class="string">&quot;id&quot;</span>:1,<span class="string">&quot;result&quot;</span>:&#123;<span class="string">&quot;tools&quot;</span>:[&#123;<span class="string">&quot;description&quot;</span>:<span class="string">&quot;Add a comment to an existing issue&quot;</span>, ...</span><br><span class="line">...</span><br><span class="line">...&#125;]&#125;&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>é€šè¿‡ @modelcontextprotocol/inspector å·¥å…·ä¸ github-mcp-server è¿›è¡Œäº¤äº’ã€‚</p>
 <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ npx @modelcontextprotocol/inspector github-mcp-server stdio</span><br><span class="line"></span><br><span class="line">$ Starting MCP inspector...</span><br><span class="line">âš™ï¸ Proxy server listening on port 6277</span><br><span class="line">ğŸ” MCP Inspector is up and running at http://127.0.0.1:6274 ğŸš€</span><br></pre></td></tr></table></figure>
<p><img src="/2025/04/17/Unveiling-the-Mystery-of-MCP-with-Examples/mcp-inspector.png" alt></p>
</li>
</ol>
<h2 id="å¼€å‘-sendmail-mcp-server">å¼€å‘ SendMail MCP Server</h2>
<p>ä½¿ç”¨ Python çš„ <a href="https://pypi.org/project/mcp/"><code>mcp</code></a> åº“ï¼Œå¯ä»¥å¿«é€Ÿå¼€å‘ä¸€ä¸ª MCP Serverã€‚æˆ‘ä»¬ä»¥å‘é€é‚®ä»¶ä¸ºä¾‹ï¼Œæ¥ç¼–å†™ä¸€ä¸ªç®€å•çš„ MCP Serverã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> mcp.server.fastmcp <span class="keyword">import</span> FastMCP</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="comment"># initialize server</span></span><br><span class="line">mcp = FastMCP(<span class="string">&quot;sendmail-server&quot;</span>)</span><br><span class="line">USER_AGENT = <span class="string">&quot;sendmail-app/1.0&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">Send_mail</span>(<span class="params">mailto: <span class="built_in">str</span></span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot; Mock function to send a email to &#123;mailto&#125;. &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="string">&quot;mailto&quot;</span>: mailto,</span><br><span class="line">        <span class="string">&quot;subject&quot;</span>: <span class="string">&quot;Hello from MCP&quot;</span>,</span><br><span class="line">        <span class="string">&quot;body&quot;</span>: <span class="string">&quot;This is a test email sent from MCP server.&quot;</span>,</span><br><span class="line">        <span class="string">&quot;status&quot;</span>: <span class="string">&quot;sent&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"><span class="meta">@mcp.tool()</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">send</span>(<span class="params">mailto: <span class="built_in">str</span></span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot; It send a mail to a specific user. </span></span><br><span class="line"><span class="string">    Args:</span></span><br><span class="line"><span class="string">        mailto (str): The user&#x27;s email address for who can received the email are required.</span></span><br><span class="line"><span class="string">    Returns:</span></span><br><span class="line"><span class="string">        dict: The send status.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    status = <span class="keyword">await</span> Send_mail(mailto)</span><br><span class="line">    <span class="keyword">if</span> status:</span><br><span class="line">        <span class="keyword">return</span> json.dumps(status)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    mcp.run(transport=<span class="string">&quot;stdio&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>åˆ©ç”¨ @modelcontextprotocol/inspector æµ‹è¯•æˆ‘ä»¬ç¼–å†™çš„ sendmail MCP Server æ˜¯å¦å¯ç”¨ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ npx @modelcontextprotocol/inspector python3.13 sendmail.py</span><br><span class="line">Starting MCP inspector...</span><br><span class="line">âš™ï¸ Proxy server listening on port 6277</span><br><span class="line">ğŸ” MCP Inspector is up and running at http://127.0.0.1:6274 ğŸš€</span><br></pre></td></tr></table></figure>
<p><img src="/2025/04/17/Unveiling-the-Mystery-of-MCP-with-Examples/sendmail-inspector.png" alt></p>
<p>ä¿®æ”¹ VSCode çš„ <code>User/settings.json</code> æ–‡ä»¶ï¼Œå¢åŠ  <code> sendmail MCP Server</code> çš„ç›¸å…³é…ç½®ï¼š</p>
<p><img src="/2025/04/17/Unveiling-the-Mystery-of-MCP-with-Examples/sendmail-setting.png" alt></p>
<p>ä½¿ç”¨ VSCode çš„ GitHub Copilot æ’ä»¶ï¼Œä½¿ç”¨è‡ªç„¶è¯­è¨€æ¥ä¸ sendmail MCP Server è¿›è¡Œäº¤äº’ï¼š</p>
<p><img src="/2025/04/17/Unveiling-the-Mystery-of-MCP-with-Examples/sendmail_mcp_server_demo.gif" alt></p>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition note"><p class="admonition-title">MCP Server å¹³å°
</p><p><a href="https://smithery.ai/">Smithery</a> æ˜¯ä¸€ä¸ªåŸºäº MCP åè®®çš„å¼€æºå¹³å°ï¼Œæä¾›äº†å¤šç§ MCP Server çš„å®ç°ï¼ŒåŒ…æ‹¬å¤©æ°”ã€ç¿»è¯‘ã€è®¡ç®—å™¨ç­‰åŠŸèƒ½ã€‚ç±»ä¼¼çš„å¹³å°è¿˜æœ‰ï¼š</p>
<ul>
<li><a href="https://github.com/modelcontextprotocol/servers">modelcontextprotocol/servers</a></li>
<li><a href="https://modelscope.cn/mcp">modelscope MCP å¹¿åœº</a>
æˆ‘ä»¬å¯ä»¥åœ¨è¿™äº›å¹³å°ä¸Šç›´æ¥ä½¿ç”¨è¿™äº› MCP Serverï¼Œæˆ–è€…å‚è€ƒå¹³å°ä¸Šçš„ MCP Server ä»£ç æ¥å®ç°è‡ªå·±çš„ MCP Serverã€‚</li>
</ul>
</div>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition note"><p class="admonition-title">MCP çš„å¼ºå¤§æ‰©å±•èƒ½åŠ›
</p><p>ä»å¦‚ä¸Šçš„ github-mcp-serverã€weather-mcp-server çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼šæˆ‘ä»¬å¹¶æ²¡æœ‰ä¿®æ”¹ VSCode çš„æºä»£ç ï¼Œä¹Ÿæ²¡æœ‰ä¿®æ”¹ Github Copilot æ’ä»¶çš„æºä»£ç ï¼Œæˆ‘ä»¬åªæ˜¯é€šè¿‡ä¿®æ”¹äº† settings.json æ–‡ä»¶å°±æŠŠ golang è¯­è¨€ç¼–å†™çš„ github-mcp-server å’Œ python è¯­è¨€ç¼–å†™çš„ sendmail-mcp-server é›†æˆåˆ°äº† Github Copilot æ’ä»¶ä¸­ã€‚è¿™æ ·åšçš„å¥½å¤„åœ¨äºï¼š</p>
<ul>
<li>é€šè¿‡æŠ½è±¡å‡ºä¸€å±‚ MCP åè®®ï¼Œé™ä½äº†ä¸åŒè¯­è¨€ä¹‹é—´çš„è€¦åˆåº¦ï¼Œé™ä½äº†æºç å˜åŠ¨å¸¦æ¥çš„é£é™©å’Œæˆæœ¬</li>
<li>å¼€å‘è€…å¯ä»¥ä½¿ç”¨è‡ªå·±æ›´æ“…é•¿ã€æ›´å–œæ¬¢çš„ç¼–ç¨‹è¯­è¨€æ¥å‘å¸ƒ MCP Server</li>
</ul>
</div>
<h2 id="mcp-client">MCP Client</h2>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ VSCode ä¸­çš„ GitHub Copilot æˆ–è€… cline æ’ä»¶æ¥ä½œä¸º <code>MCP Hosts</code>ï¼Œä½†æ˜¯è¿™ç§ <code>MCP Hosts</code> å¾ˆéš¾é›†æˆåˆ°æˆ‘ä»¬ç°æœ‰çš„å·¥ä½œæµç³»ç»Ÿä¸­ã€‚å› æ­¤ï¼Œé™¤äº†è¿™ç§ IDE ç±»å‹çš„ <code>MCP Hosts</code> ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜ä¼šé‡åˆ°åŸºäºæºç çš„ <code>MCP Hosts</code>ï¼Œä»¥ä¾¿å°† MCP çš„å¼ºå¤§èƒ½åŠ›é›†æˆåˆ°ç°æœ‰çš„å·¥ä½œæµç³»ç»Ÿä¸­ã€‚</p>
<p>æˆ‘é€‰æ‹© python è¯­è¨€ç¼–å†™çš„ <a href="https://github.com/adhikasp/mcp-client-cli">adhikasp/mcp-client-cli</a> ä½œä¸º <code>MCP Hosts</code> æ¥æ¢ç´¢ MCPï¼Œè¯¥é¡¹ç›®ç›®å‰çš„ <a href="https://github.com/search?q=mcp+client+language%3APython&amp;type=repositories&amp;l=Python&amp;s=stars&amp;o=desc">stars</a> æ•°ç›¸å¯¹è¾ƒå¤šï¼Œæ”¯æŒçš„èƒ½åŠ›ä¹Ÿæ¯”è¾ƒä¸°å¯Œã€‚åœ¨è¯¥é¡¹ç›®çš„æ–‡æ¡£ä¸­ï¼Œæœ‰å¦‚ä¸‹çš„æè¿°ï¼š</p>
<blockquote>
<p>A simple CLI program to run LLM prompt and implement Model Context Protocol (MCP) client.</p>
<p>You can use any MCP-compatible servers from the convenience of your terminal.</p>
<p>This act as alternative client beside Claude Desktop. Additionally you can use any LLM provider like OpenAI, Groq, or local LLM model via llama.</p>
</blockquote>
<p><code>adhikasp/mcp-client-cli</code> æ˜¯ä½œä¸ºä¸€ä¸ª python åº“æ¥æä¾›çš„ï¼Œå› æ­¤å¯ä»¥ä½œä¸ºä¸€ä¸ªæœ¬åœ°å‘½ä»¤æ¥ä½¿ç”¨ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ pip install mcp-client-cli</span><br><span class="line">$ <span class="built_in">which</span> llm </span><br><span class="line">/Library/Frameworks/Python.framework/Versions/3.13/bin/llm</span><br><span class="line">$ cat /Library/Frameworks/Python.framework/Versions/3.13/bin/llm</span><br><span class="line"><span class="meta">#!/Library/Frameworks/Python.framework/Versions/3.13/bin/python3.13</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line">import re</span><br><span class="line">import sys</span><br><span class="line">from mcp_client_cli.cli import main</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    sys.argv[0] = re.sub(r<span class="string">&#x27;(-script\.pyw|\.exe)?$&#x27;</span>, <span class="string">&#x27;&#x27;</span>, sys.argv[0])</span><br><span class="line">    sys.exit(main())</span><br></pre></td></tr></table></figure>
<p><img src="/2025/04/17/Unveiling-the-Mystery-of-MCP-with-Examples/mcp_client_usage_demo.gif" alt></p>
<p>æˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠ <a href="https://github.com/adhikasp/mcp-client-cli">adhikasp/mcp-client-cli</a> å…‹éš†åˆ°æœ¬åœ°ï¼Œç›´æ¥ä½¿ç”¨ python è¿è¡Œè¯¥é¡¹ç›®çš„ <code>cli.py</code> æ–‡ä»¶æ¥ä½¿ç”¨ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git <span class="built_in">clone</span> https://github.com/adhikasp/mcp-client-cli.git</span><br><span class="line">$ <span class="built_in">cd</span> mcp-client-cli</span><br><span class="line">$ pip install -e .</span><br><span class="line">$ python3.13 -m src.mcp_client_cli.cli <span class="string">&quot;wangwei1237/wangwei1237.github.io_srcä»“åº“ä¸­ï¼Œè¯„è®ºæ•°æœ€å¤šçš„ issue æ˜¯å“ªä¸ªï¼Ÿ&quot;</span></span><br></pre></td></tr></table></figure>
<p><img src="/2025/04/17/Unveiling-the-Mystery-of-MCP-with-Examples/mcp-cli-develop.png" alt></p>
<h2 id="é…ç½®-adhikasp-mcp-client-cli">é…ç½® adhikasp/mcp-client-cli</h2>
<p>é¦–å…ˆä¿®æ”¹ <code>~/.llm/config.json</code> é…ç½®æ–‡ä»¶ä¸º <code>adhikasp/mcp-client-cli</code> å¢åŠ å¤§è¯­è¨€æ¨¡å‹é…ç½®å’Œ <code>MCP Server</code>ï¼ˆ<a href="https://github.com/github/github-mcp-server">github-mcp-server</a>ï¼Œ<a href="https://github.com/bytebase/dbhub">dbhub</a>ï¼Œ<a href="https://github.com/CodeByWaqas/weather-mcp-server">weather-mcp-server</a>ï¼Œsendmailï¼‰</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;systemPrompt&quot;</span>: <span class="string">&quot;You are an AI assistant helping a software engineer...&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;llm&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;provider&quot;</span>: <span class="string">&quot;openai&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;model&quot;</span>: <span class="string">&quot;gpt-4o-mini-2024-07-18&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;api_key&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;temperature&quot;</span>: <span class="number">0.7</span>,</span><br><span class="line">    <span class="attr">&quot;base_url&quot;</span>: <span class="string">&quot;https://api.openai.com/v1&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;mcpServers&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;github&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;command&quot;</span>: <span class="string">&quot;/Users/wangwei17/Documents/Project/github/github-mcp-server/github-mcp-server&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;args&quot;</span>: [</span><br><span class="line">        <span class="string">&quot;stdio&quot;</span></span><br><span class="line">      ],</span><br><span class="line">      <span class="attr">&quot;env&quot;</span>: &#123;&#125;,</span><br><span class="line">      <span class="attr">&quot;enabled&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">&quot;requires_confirmation&quot;</span>: [</span><br><span class="line">        <span class="string">&quot;list_issues&quot;</span>,</span><br><span class="line">        <span class="string">&quot;create_issue&quot;</span>,</span><br><span class="line">        <span class="string">&quot;update_issue&quot;</span></span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;dbhub-demo&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;command&quot;</span>: <span class="string">&quot;/usr/local/bin/node&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;args&quot;</span>: [</span><br><span class="line">        <span class="string">&quot;/Users/wangwei17/Documents/Project/github/dbhub/dist/index.js&quot;</span>,</span><br><span class="line">        <span class="string">&quot;--transport&quot;</span>,</span><br><span class="line">        <span class="string">&quot;stdio&quot;</span>,</span><br><span class="line">        <span class="string">&quot;--dsn&quot;</span>,</span><br><span class="line">        <span class="string">&quot;sqlite:///Users/wangwei17/.llm/conversations.db&quot;</span></span><br><span class="line">      ],</span><br><span class="line">      <span class="attr">&quot;env&quot;</span>: &#123;&#125;,</span><br><span class="line">      <span class="attr">&quot;enabled&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">&quot;requires_confirmation&quot;</span>: [</span><br><span class="line">        <span class="string">&quot;run_query&quot;</span></span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;weather&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;command&quot;</span>: <span class="string">&quot;/usr/local/bin/python3.13&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;args&quot;</span>: [</span><br><span class="line">        <span class="string">&quot;/Users/wangwei17/Documents/Project/github/weather-mcp-server/src/resources/server.py&quot;</span></span><br><span class="line">      ],</span><br><span class="line">      <span class="attr">&quot;env&quot;</span>: &#123;&#125;,</span><br><span class="line">      <span class="attr">&quot;enabled&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">&quot;requires_confirmation&quot;</span>: []</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;sendmail&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;command&quot;</span>: <span class="string">&quot;/usr/local/bin/python3.13&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;args&quot;</span>: [</span><br><span class="line">        <span class="string">&quot;/Users/wangwei17/Documents/Project/github/sendmail/sendmail.py&quot;</span></span><br><span class="line">      ],</span><br><span class="line">      <span class="attr">&quot;enabled&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">&quot;requires_confirmation&quot;</span>: [],</span><br><span class="line">      <span class="attr">&quot;env&quot;</span>: &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>mcpServers.server.command: æŒ‡å®š MCP Server çš„æ‰§è¡Œå‘½ä»¤</li>
<li>mcpServers.server.args: æŒ‡å®š MCP Server çš„æ‰§è¡Œå‚æ•°</li>
<li>mcpServers.server.env: æŒ‡å®š MCP Server çš„ç¯å¢ƒå˜é‡ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ <code>export</code> å‘½ä»¤æ¥è®¾ç½® MCP Server æ‰§è¡Œæ—¶ç”¨åˆ°çš„ç¯å¢ƒå˜é‡ã€‚ä¾‹å¦‚ï¼Œgithub-mcp-server çš„ <code>GITHUB_PERSONAL_ACCESS_TOKEN</code>ã€weather-mcp-server çš„ <code>WEATHER_API_KEY</code>â€¦â€¦</li>
<li>mcpServers.server.enabled: æ˜¯å¦å¯ç”¨è¯¥ MCP Serverï¼Œå°¤å…¶æ˜¯å½“ MCP Servers æä¾›çš„å·¥å…·éå¸¸å¤šï¼Œéœ€è¦è¿›è¡Œçº§è”é€‰æ‹©å·¥å…·æ—¶ï¼Œå¯ä»¥åœ¨é€‰æ‹©å·¥å…·ä¹‹å‰å…ˆé€‰æ‹© MCP Server å¹¶ç”¨è¯¥å­—æ®µæ¥æ§åˆ¶å½“å‰çš„ MCP Server æ˜¯å¦è¿›è¡Œåç»­å·¥å…·çš„ç­›é€‰ï¼Œè¿™æ ·å¯ä»¥å‡å°‘ä¸å¿…è¦çš„è®¡ç®—èµ„æºæ¶ˆè€—ã€‚</li>
<li>mcpServers.server.requires_confirmation: æ˜¯å¦éœ€è¦äººå·¥ç¡®è®¤ï¼Œé»˜è®¤å€¼ä¸º falseã€‚å¯¹äºä¸€äº›éœ€è¦äººå·¥ç¡®è®¤çš„æ“ä½œï¼Œä¾‹å¦‚ï¼šåˆ é™¤æ–‡ä»¶ã€å‘é€é‚®ä»¶ç­‰æ“ä½œï¼Œå¯ä»¥è®¾ç½®ä¸º trueã€‚è¿™æ ·åœ¨æ‰§è¡Œè¿™äº›æ“ä½œæ—¶ï¼Œä¼šå¼¹å‡ºä¸€ä¸ªç¡®è®¤æ¡†ï¼Œè¦æ±‚ç”¨æˆ·ç¡®è®¤åæ‰èƒ½æ‰§è¡Œã€‚</li>
</ul>
<p><img src="/2025/04/17/Unveiling-the-Mystery-of-MCP-with-Examples/mcp-cli-listtools.png" alt></p>
<h2 id="adhikasp-mcp-client-cli-çš„ç‰¹ç‚¹">adhikasp/mcp-client-cli çš„ç‰¹ç‚¹</h2>
<p>æ ¹æ® <a href="https://github.com/adhikasp/mcp-client-cli/blob/master/c4_diagram.png">adhikasp/mcp-client-cli çš„ç»“æ„å›¾</a> ä»¥åŠæºç ï¼Œæˆ‘ä»¬å¯ä»¥ä¸€çª¥ adhikasp/mcp-client-cli ç©¶ç«Ÿæœ‰å“ªäº›ç‰¹ç‚¹ã€‚æºç é¢å‰äº†æ— ç§˜å¯†ã€‚</p>
<p><img src="/2025/04/17/Unveiling-the-Mystery-of-MCP-with-Examples/mcp-client-cli-c4-diagram.png" alt></p>
<h3 id="1-å¯¹è¯æŒä¹…åŒ–-æ”¯æŒå¤šè½®å¯¹è¯">1.å¯¹è¯æŒä¹…åŒ–ï¼Œæ”¯æŒå¤šè½®å¯¹è¯</h3>
<p><code>adhikasp/mcp-client-cli</code> æ˜¯ä¸€ä¸ªåŸºäº <a href="https://python.langchain.com/docs/introduction/">LangChain</a> å¼€å‘çš„ <code>MCP Host</code>ï¼Œé€šè¿‡ LangChain æä¾›çš„åº•å±‚èƒ½åŠ›å®ç°äº† Agent çš„å¤šè½®å¯¹è¯èƒ½åŠ›ã€‚</p>
<p>æ¯ä¸€è½®å¯¹è¯ï¼Œ<code>adhikasp/mcp-client-cli</code> éƒ½ä¼šç”Ÿæˆä¸€ä¸ª <code>thread_id</code> æ¥æ ‡è¯†è¯¥è½®å¯¹è¯çš„å”¯ä¸€æ€§ï¼ŒåŒæ—¶è¯¥ <code>thread_id</code> ä¼šæŒä¹…åŒ–åˆ° sqlite æ•°æ®åº“ï¼ˆ<code>conversations.db</code>ï¼‰ä¸­çš„ <code>last_conversation</code> è¡¨ã€‚æ¯ä¸€æ¬¡å¯¹è¯çš„å†…å®¹ä¹Ÿä¼šæŒä¹…åŒ–åˆ° sqlite æ•°æ®åº“ï¼ˆ<code>conversations.db</code>ï¼‰ä¸­çš„ <code>checkpointer</code> è¡¨ã€‚æ ¹æ®å¦‚ä¸Šä¸¤ä¸ªè¡¨çš„æŒä¹…åŒ–ä¿¡æ¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨åç»­çš„å¯¹è¯ä¸­ï¼Œä½¿ç”¨ <code>thread_id</code> æ¥è·å–ä¹‹å‰çš„å¯¹è¯å†…å®¹ï¼Œä»è€Œå®ç°å¤šè½®å¯¹è¯çš„èƒ½åŠ›ã€‚</p>
<p><img src="/2025/04/17/Unveiling-the-Mystery-of-MCP-with-Examples/last_conversation.png" alt></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¦‚æœåŒ…å«å‚æ•° cï¼Œåˆ™è¡¨ç¤ºæ˜¯è¿ç»­å¯¹è¯ï¼Œè®¾ç½® is_continuation ä¸º True</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">parse_query</span>(<span class="params">args: argparse.Namespace</span>) -&gt; <span class="built_in">tuple</span>[HumanMessage, <span class="built_in">bool</span>]:</span></span><br><span class="line">    query_text = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> query_parts:</span><br><span class="line">        <span class="keyword">if</span> query_parts[<span class="number">0</span>] == <span class="string">&#x27;c&#x27;</span>:</span><br><span class="line">            is_continuation = <span class="literal">True</span></span><br><span class="line">            query_text = <span class="string">&#x27; &#x27;</span>.join(query_parts[<span class="number">1</span>:])</span><br><span class="line">    ...</span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœæ˜¯è¿ç»­å¯¹è¯ï¼Œåˆ™ä» last_conversation è¡¨ä¸­è·å–ä¸Šä¸€æ¬¡å¯¹è¯çš„ thread_idï¼Œå¹¶ä» checkpointer è¡¨ä¸­è·å–ä¸Šä¸€æ¬¡å¯¹è¯çš„å†…å®¹ï¼Œå¹¶è¿½åŠ åˆ°å½“å‰å¯¹è¯å†…å®¹ä¸­ã€‚</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">handle_conversation</span>(<span class="params">args: argparse.Namespace, query: HumanMessage, </span></span></span><br><span class="line"><span class="function"><span class="params">                            is_conversation_continuation: <span class="built_in">bool</span>, app_config: AppConfig</span>) -&gt; <span class="literal">None</span>:</span></span><br><span class="line">    conversation_manager = ConversationManager(SQLITE_DB)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">with</span> AsyncSqliteSaver.from_conn_string(SQLITE_DB) <span class="keyword">as</span> checkpointer:</span><br><span class="line">        store = SqliteStore(SQLITE_DB)</span><br><span class="line">        memories = <span class="keyword">await</span> get_memories(store)</span><br><span class="line">        formatted_memories = <span class="string">&quot;\n&quot;</span>.join(<span class="string">f&quot;- <span class="subst">&#123;memory&#125;</span>&quot;</span> <span class="keyword">for</span> memory <span class="keyword">in</span> memories)</span><br><span class="line">        agent_executor = create_react_agent(</span><br><span class="line">            model, tools, state_schema=AgentState, </span><br><span class="line">            state_modifier=prompt, checkpointer=checkpointer, store=store</span><br><span class="line">        )</span><br><span class="line">    thread_id = (<span class="keyword">await</span> conversation_manager.get_last_id() <span class="keyword">if</span> is_conversation_continuation </span><br><span class="line">                    <span class="keyword">else</span> uuid.uuid4().<span class="built_in">hex</span>)</span><br><span class="line">    ......</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ python3.13 -m src.mcp_client_cli.cli <span class="string">&quot;What&#x27;s the captical of the China?&quot;</span></span><br><span class="line">$ python3.13 -m src.mcp_client_cli.cli c <span class="string">&quot;Whatâ€™s the weather like tomorrow?&quot;</span></span><br></pre></td></tr></table></figure>
<p><img src="/2025/04/17/Unveiling-the-Mystery-of-MCP-with-Examples/mcp_client_cli_conversation_demo.gif" alt></p>
<h3 id="2-æ”¯æŒç²˜è´´æ¿å’Œå¤šæ¨¡æ€è¾“å…¥">2.æ”¯æŒç²˜è´´æ¿å’Œå¤šæ¨¡æ€è¾“å…¥</h3>
<p>å¯¹äºç²˜è´´æ¿å’Œå›¾ç‰‡è¾“å…¥çš„æ”¯æŒä»£ç ï¼Œå¯ä»¥å‚è€ƒ <code>parse_query()</code>ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¯ä»¥é€šè¿‡å‰ªè´´æ¿æˆ–è€…ç®¡é“çš„æ–¹å¼æ¥è¾“å…¥æ•°æ®ï¼ŒåŒæ—¶æ”¯æŒå›¾åƒæ•°æ®çš„è¾“å…¥</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">parse_query</span>(<span class="params">args: argparse.Namespace</span>) -&gt; <span class="built_in">tuple</span>[HumanMessage, <span class="built_in">bool</span>]:</span></span><br><span class="line">    <span class="comment"># Handle clipboard content if requested</span></span><br><span class="line">    <span class="keyword">if</span> query_parts <span class="keyword">and</span> query_parts[<span class="number">0</span>] == <span class="string">&#x27;cb&#x27;</span>:</span><br><span class="line">        <span class="comment"># Remove &#x27;cb&#x27; from query parts</span></span><br><span class="line">        query_parts = query_parts[<span class="number">1</span>:]</span><br><span class="line">        <span class="comment"># Try to get content from clipboard</span></span><br><span class="line">        clipboard_result = get_clipboard_content()</span><br><span class="line">        <span class="keyword">if</span> clipboard_result:</span><br><span class="line">            content, mime_type = clipboard_result</span><br><span class="line">            <span class="keyword">if</span> mime_type:  <span class="comment"># It&#x27;s an image</span></span><br><span class="line">                stdin_image = base64.b64encode(content).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">            <span class="keyword">else</span>:  <span class="comment"># It&#x27;s text</span></span><br><span class="line">                stdin_content = content</span><br><span class="line">                ...</span><br><span class="line">    <span class="comment"># Check if there&#x27;s input from pipe</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="keyword">not</span> sys.stdin.isatty():</span><br><span class="line">        stdin_data = sys.stdin.buffer.read()</span><br><span class="line">        <span class="comment"># Try to detect if it&#x27;s an image</span></span><br><span class="line">        image_type = imghdr.what(<span class="literal">None</span>, h=stdin_data)</span><br><span class="line">        <span class="keyword">if</span> image_type:</span><br><span class="line">            <span class="comment"># It&#x27;s an image, encode it as base64</span></span><br><span class="line">            stdin_image = base64.b64encode(stdin_data).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">            mime_type = mimetypes.guess_type(<span class="string">f&quot;dummy.<span class="subst">&#123;image_type&#125;</span>&quot;</span>)[<span class="number">0</span>] <span class="keyword">or</span> <span class="string">f&quot;image/<span class="subst">&#123;image_type&#125;</span>&quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># It&#x27;s text</span></span><br><span class="line">            stdin_content = stdin_data.decode(<span class="string">&#x27;utf-8&#x27;</span>).strip()</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ cat ../wangwei1237.github.io_src/<span class="built_in">source</span>/_posts/Unveiling-the-Mystery-of-MCP-with-Examples/mcp-client-cli-c4-diagram.png | python3.13 -m src.mcp_client_cli.cli <span class="string">&quot;è¯·æè¿°ä¸€ä¸‹è¿™å¼ å›¾ä¸­çš„ä¿¡æ¯&quot;</span></span><br><span class="line">$ python3.13 -m src.mcp_client_cli.cli c <span class="string">&quot;åœ¨å›¾ä¸­ï¼ŒConversation Manager æ˜¯é€šè¿‡ä»€ä¹ˆæ•°æ®åº“ä½œä¸ºæŒä¹…åŒ–å­˜å‚¨çš„ï¼Ÿ&quot;</span></span><br></pre></td></tr></table></figure>
<p><img src="/2025/04/17/Unveiling-the-Mystery-of-MCP-with-Examples/mcp_client_cli_image_understanding.gif" alt></p>
<h3 id="3-é‡è¦ä¿¡æ¯å­˜å‚¨åœ¨ç³»ç»Ÿç¯å¢ƒå˜é‡ä¸­-å®‰å…¨æ€§æ›´é«˜">3.é‡è¦ä¿¡æ¯å­˜å‚¨åœ¨ç³»ç»Ÿç¯å¢ƒå˜é‡ä¸­ï¼Œå®‰å…¨æ€§æ›´é«˜</h3>
<p>ä¸åŒçš„ <code>MCP Server</code> åœ¨è¿è¡Œæ—¶ï¼Œéœ€è¦ä¸€å®šçš„é‰´æƒä¿¡æ¯ï¼Œä¾‹å¦‚ï¼šgithub-mcp-server çš„ <code>GITHUB_PERSONAL_ACCESS_TOKEN</code>ã€weather-mcp-server çš„ <code>WEATHER_API_KEY</code> ç­‰ç­‰ã€‚</p>
<p>è™½ç„¶ <code>adhikasp/mcp-client-cli</code> å¯ä»¥åœ¨ <code>~/.llm/config.json</code> ä¸­çš„ <code>mcpServers.server.env</code> ä¸­é…ç½®è¿™äº›ä¿¡æ¯ï¼Œä½†æ˜¯ <code>~/.llm/config.json</code> ä½œä¸ºç³»ç»Ÿçš„ä¸€éƒ¨åˆ†ï¼Œå¯èƒ½éœ€è¦æ‰˜ç®¡åœ¨ git ä»“åº“ä¸­ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯èƒ½ä¼šå¸¦æ¥ä¿¡æ¯çš„æ³„éœ²ï¼Œå› æ­¤è¿™ç§æ–¹å¼å¹¶ä¸å®‰å…¨ã€‚</p>
<p>é€šè¿‡é˜…è¯» <code>adhikasp/mcp-client-cli</code> çš„æºç ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ<code>adhikasp/mcp-client-cli</code> ä¼šä¼˜å…ˆä»ç³»ç»Ÿç¯å¢ƒå˜é‡ä¸­è·å–è¿™äº›ä¿¡æ¯ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™ä¼šä» <code>~/.llm/config.json</code> ä¸­è·å–ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ•æ„Ÿä¿¡æ¯å­˜å‚¨åœ¨ç³»ç»Ÿç¯å¢ƒå˜é‡ä¸­ï¼Œä»¥æ­¤æ¥é¿å…ä¿¡æ¯çš„æ³„éœ²ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">handle_conversation</span>(<span class="params">args: argparse.Namespace, query: HumanMessage, </span></span></span><br><span class="line"><span class="function"><span class="params">                            is_conversation_continuation: <span class="built_in">bool</span>, app_config: AppConfig</span>) -&gt; <span class="literal">None</span>:</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;Handle the main conversation flow.&quot;&quot;&quot;</span></span><br><span class="line">    server_configs = [</span><br><span class="line">        McpServerConfig(</span><br><span class="line">            server_name=name,</span><br><span class="line">            server_param=StdioServerParameters(</span><br><span class="line">                command=config.command,</span><br><span class="line">                args=config.args <span class="keyword">or</span> [],</span><br><span class="line">                env=&#123;**(config.env <span class="keyword">or</span> &#123;&#125;), **os.environ&#125; <span class="comment"># é…ç½®æ–‡ä»¶ä¸­çš„ç¯å¢ƒå˜é‡ä¸ç³»ç»Ÿç¯å¢ƒå˜é‡åˆå¹¶</span></span><br><span class="line">            ),</span><br><span class="line">            exclude_tools=config.exclude_tools <span class="keyword">or</span> []</span><br><span class="line">        )</span><br><span class="line">        <span class="keyword">for</span> name, config <span class="keyword">in</span> app_config.get_enabled_servers().items()</span><br><span class="line">    ]</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure>
<h3 id="4-æ”¯æŒå¯¹è¯è¿‡ç¨‹ä¸­çš„äººå·¥ç¡®è®¤">4.æ”¯æŒå¯¹è¯è¿‡ç¨‹ä¸­çš„äººå·¥ç¡®è®¤</h3>
<p>adhikasp/mcp-client-cli ä½¿ç”¨ <code>OutputHandler</code> å’Œ <code>agent_executor.astream(...) </code> çš„æµå¼äº¤äº’é€»è¾‘ï¼Œå®ç°äº†åœ¨å·¥å…·è°ƒç”¨å‰è¿›è¡Œäººå·¥ç¡®è®¤çš„åŠŸèƒ½ã€‚ä¸ºäº†é¿å…è¿‡åº¦çš„äººå·¥ç¡®è®¤ï¼Œè¿˜åœ¨é…ç½®ä¸­å¢åŠ äº† <code>mcpServers.server.requires_confirmation</code> å­—æ®µæ¥æ§åˆ¶åœ¨æ‰§è¡Œå·¥å…·ä¹‹å‰æ˜¯å¦éœ€è¦äººå·¥ç¡®è®¤ã€‚åªæœ‰ <code>mcpServers.server.requires_confirmation= true</code> çš„å·¥å…·æ‰ä¼šåœ¨æ‰§è¡Œä¹‹å‰è¿›è¡Œäººå·¥ç¡®è®¤ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åœ¨å·¥å…·è°ƒç”¨ä¹‹å‰ï¼Œæ£€æŸ¥æ˜¯å¦éœ€è¦äººå·¥ç¡®è®¤ï¼Œsrc/mcp_client_cli/output.py</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">confirm_tool_call</span>(<span class="params">self, config: <span class="built_in">dict</span>, chunk: <span class="built_in">any</span></span>) -&gt; <span class="built_in">bool</span>:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> self._is_tool_call_requested(chunk, config):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    self.stop()</span><br><span class="line">    is_confirmed = self._ask_tool_call_confirmation()</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> is_confirmed:</span><br><span class="line">        self.md += <span class="string">&quot;# Tool call denied&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> self.text_only:</span><br><span class="line">        self.start()</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">handle_conversation</span>(<span class="params">args: argparse.Namespace, query: HumanMessage, </span></span></span><br><span class="line"><span class="function"><span class="params">                            is_conversation_continuation: <span class="built_in">bool</span>, app_config: AppConfig</span>) -&gt; <span class="literal">None</span>:</span></span><br><span class="line">    output = OutputHandler(text_only=args.text_only, only_last_message=args.no_intermediates)</span><br><span class="line">    output.start()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">async</span> <span class="keyword">for</span> chunk <span class="keyword">in</span> agent_executor.astream(</span><br><span class="line">            input_messages,</span><br><span class="line">            stream_mode=[<span class="string">&quot;messages&quot;</span>, <span class="string">&quot;values&quot;</span>],</span><br><span class="line">            config=&#123;<span class="string">&quot;configurable&quot;</span>: &#123;<span class="string">&quot;thread_id&quot;</span>: thread_id, <span class="string">&quot;user_id&quot;</span>: <span class="string">&quot;myself&quot;</span>&#125;, </span><br><span class="line">                    <span class="string">&quot;recursion_limit&quot;</span>: <span class="number">100</span>&#125;</span><br><span class="line">        ):</span><br><span class="line">            output.update(chunk)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> args.no_confirmations: <span class="comment"># å¦‚æœéœ€è¦ç¡®è®¤ï¼Œå¹¶ä¸”ç”¨æˆ·æ²¡æœ‰ç‚¹å‡»ç¡®è®¤ï¼Œåˆ™åœæ­¢</span></span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> output.confirm_tool_call(app_config.__dict__, chunk):</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        output.finish()</span><br></pre></td></tr></table></figure>
<p><img src="/2025/04/17/Unveiling-the-Mystery-of-MCP-with-Examples/human_check.png" alt></p>
]]></content>
      <categories>
        <category>LLM</category>
      </categories>
      <tags>
        <tag>MCP</tag>
        <tag>Agent</tag>
      </tags>
  </entry>
  <entry>
    <title>å¤§æ¨¡å‹è¯„æµ‹ 7 æ¡åŸåˆ™</title>
    <url>/2025/03/29/Seven-Principles-for-Large-Model-Evaluation/</url>
    <content><![CDATA[<p><img src="/2025/03/29/Seven-Principles-for-Large-Model-Evaluation/1.png" alt></p>
<p>ç™½å±…æ˜“åœ¨ã€Šé’±å¡˜æ¹–æ˜¥è¡Œã€‹ä¸­å†™é“ï¼š</p>
<blockquote>
<p>å­¤å±±å¯ºåŒ—è´¾äº­è¥¿ï¼Œæ°´é¢åˆå¹³äº‘è„šä½ã€‚å‡ å¤„æ—©èºäº‰æš–æ ‘ï¼Œè°å®¶æ–°ç‡•å•„æ˜¥æ³¥ã€‚ä¹±èŠ±æ¸æ¬²è¿·äººçœ¼ï¼Œæµ…è‰æ‰èƒ½æ²¡é©¬è¹„ã€‚</p>
</blockquote>
<p>2025 å¹´ çš„æ˜¥å¤©ï¼Œå¤§æ¨¡å‹çš„å‘å±•ä¹Ÿæ­£å¦‚è¯—å¥ä¸­æ‰€æè¿°çš„æ„å¢ƒé‚£èˆ¬ï¼šç™¾èŠ±é½æ”¾ï¼Œç™¾å®¶äº‰é¸£ã€‚åœ¨è¿™ä¸ªæ—¶å€™ï¼Œå¤§æ¨¡å‹çš„è¯„æµ‹ä¹Ÿå˜å¾—è¶Šæ¥è¶Šé‡è¦ã€‚ä½†æ˜¯ï¼Œå¦‚ä½•æ‰èƒ½ç¡®ä¿åœ¨è¯„æµ‹å¤§æ¨¡å‹æ—¶ï¼Œèƒ½å¤Ÿå¾—åˆ°æ­£ç¡®ã€å®¢è§‚çš„ç»“è®ºå‘¢ï¼Ÿé€šè¿‡å¤§é‡çš„å®è·µã€æˆ‘ä»¬æ•´ç†å‡ºäº†ä»¥ä¸‹ 7 æ¡åŸåˆ™ï¼Œå¸Œæœ›èƒ½å¤Ÿå¸®åŠ©å¤§å®¶åœ¨è¯„æµ‹å¤§æ¨¡å‹æ—¶ï¼Œå¾—åˆ°æ›´åŠ ç½®ä¿¡çš„ç»“è®ºã€‚</p>
<span id="more"></span>
<h2 id="1-è¯„æµ‹æ ·æœ¬å¿…é¡»æ— æ­§ä¹‰">1. è¯„æµ‹æ ·æœ¬å¿…é¡»æ— æ­§ä¹‰</h2>
<p>è¯„æµ‹æ•°æ®é›†ä¸­çš„æ ·æœ¬æè¿°å¿…é¡»æ˜¯å‡†ç¡®çš„ã€æ— æ­§ä¹‰çš„ï¼Œå­˜åœ¨æ­§ä¹‰çš„æ ·æœ¬æ— åŠä¿è¯æœ€ç»ˆçš„è¯„ä¼°ç»“è®ºçš„å‡†ç¡®æ€§ã€‚</p>
<p>æœ€å…¸å‹çš„å°±æ˜¯ OpenAI åœ¨ 24 å¹´ 8 æœˆ å‘å¸ƒçš„ SWE-bench Verified æ•°æ®é›†ï¼ŒOpenAI è®¤ä¸º åŸå§‹ SWE-bench ä½ä¼°äº†å¤§æ¨¡å‹åœ¨ä»£ç æ–¹é¢çš„èƒ½åŠ›ï¼Œäºæ˜¯å¯¹è¯¥æ•°æ®è¿›è¡Œäº†é‡æ–°æ ‡æ³¨å¹¶æ„å»ºäº† SWE-bench Verified æ•°æ®é›†ã€‚åœ¨æ•´ä¸ªæ ‡æ³¨çš„è¿‡ç¨‹ä¸­ï¼ŒOpenAI å‘ç°ï¼šåŸå§‹ SWE-bench ä¸­çš„æ ·æœ¬æœ‰å¾ˆå¤§ä¸€éƒ¨åˆ†æ˜¯ä¸åˆæ ¼çš„ã€‚</p>
<table>
<thead>
<tr>
<th>38.3% çš„æ ·æœ¬é—®é¢˜é™ˆè¿°ä¸å¤Ÿæ˜ç¡®</th>
<th>61.1% çš„æ ·æœ¬å› ä¸ºå•å…ƒæµ‹è¯•é—®é¢˜å°†æœ‰æ•ˆè§£å†³æ–¹æ¡ˆé”™è¯¯åœ°æ ‡è®°ä¸ºä¸æ­£ç¡®</th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="/2025/03/29/Seven-Principles-for-Large-Model-Evaluation/2.png" alt></td>
<td><img src="/2025/03/29/Seven-Principles-for-Large-Model-Evaluation/3.png" alt></td>
</tr>
</tbody>
</table>
<h6 id="æ­§ä¹‰è¯„æµ‹æ ·æœ¬ä¸¾ä¾‹">æ­§ä¹‰è¯„æµ‹æ ·æœ¬ä¸¾ä¾‹</h6>
<table>
<thead>
<tr>
<th>åŸå§‹å›¾ç‰‡</th>
<th>å«æœ‰æ­§ä¹‰çš„æ ·æœ¬ Query</th>
<th>ä¿®æ”¹åæ— æ­§ä¹‰çš„æ ·æœ¬ Query</th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="/2025/03/29/Seven-Principles-for-Large-Model-Evaluation/4.png" alt></td>
<td>ä¸ºä»€ä¹ˆ A æ˜¯å¯¹çš„ï¼Ÿ<br> * A æ˜¯å¯¹çš„ <br> * A æ˜¯é”™è¯¯çš„ï¼Œå› ä¸ºé¢˜ç›®é—®çš„æ˜¯é”™è¯¯çš„é€‰é¡¹æ˜¯å“ªä¸ªï¼Ÿ</td>
<td>ä¸ºä»€ä¹ˆè¿™é“é¢˜çš„ç­”æ¡ˆæ˜¯ Aï¼Ÿ</td>
</tr>
<tr>
<td><img src="/2025/03/29/Seven-Principles-for-Large-Model-Evaluation/5.png" alt></td>
<td>è¿™æ˜¯ä»€ä¹ˆå°è¯´ï¼Ÿ <br> * è’²æ¾é¾„çš„ã€Šç‹¼ä¸‰åˆ™Â·å…¶ä¸€ã€‹ <br> * ä¸œç”°é›†ä¸­çš„ã€Šä¸œéƒ­å…ˆç”Ÿå’Œç‹¼ã€‹ï¼Œè™½ç„¶å¯èƒ½æ€§éå¸¸å°</td>
<td>è¿™æ˜¯è’²æ¾é¾„çš„å“ªç¯‡å°è¯´ï¼Ÿ</td>
</tr>
</tbody>
</table>
<h2 id="2-å¿…é¡»è¦†ç›–æ¨¡å‹çš„æ–°å¢èƒ½åŠ›">2. å¿…é¡»è¦†ç›–æ¨¡å‹çš„æ–°å¢èƒ½åŠ›</h2>
<p>æ¨¡å‹åœ¨ä¸æ–­ä¼˜åŒ–çš„è¿‡ç¨‹ä¸­ï¼Œä¼šé’ˆå¯¹ç‰¹å®šåœºæ™¯è¿›è¡Œä¼˜åŒ–ï¼Œè¯„æµ‹çš„æ ·æœ¬å¿…é¡»èƒ½å¤Ÿè¦†ç›–è¿™äº›ç‰¹å®šåœºæ™¯ï¼Œå¦åˆ™å°±æ— æ³•å¯¹æ¨¡å‹æ€§èƒ½è¿›è¡Œæ­£ç¡®çš„è¯„ä¼°ã€‚</p>
<p>2025 å¹´ 2æœˆï¼Œä¸‡ç›¸2.1 å®£å¸ƒå¼€æºï¼Œå…¶ä¼˜åŠ¿åœ¨äºï¼šé•¿æç¤ºè¯éµå¾ªï¼Œäººç‰©å¤æ‚è¿åŠ¨ï¼Œå¤šä¸»ä½“äº’åŠ¨ç­‰ã€‚æˆ‘ä»¬åœ¨ä¸åŒçš„æ•°æ®é›†ä¸ŠåŒæ—¶å¯¹ä¸‡ç›¸ 2.1 å’Œå¯çµ 1.6 è¿›è¡Œäº†è¯„ä¼°ï¼Œå´å¾—å‡ºäº†ç›¸åçš„ç»“è®ºã€‚</p>
<table>
<thead>
<tr>
<th></th>
<th>å‚è€ƒå›¾ç‰‡</th>
<th>åˆ›æ„æè¿°</th>
<th>ä¸‡ç›¸ 2.1</th>
<th>å¯çµ 1.6</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ•°æ®é›† A</td>
<td><img src="/2025/03/29/Seven-Principles-for-Large-Model-Evaluation/6.png" alt></td>
<td>é©¬è½¦æ²¿ç€å°è·¯å‰è¡Œã€‚å‡å±±é€æ¸æµ®ç°ï¼Œå‘¨å›´çš„äº‘å±‚ä¸€ç‚¹ç‚¹æ•£å¼€</td>
<td><div class="bili_video"><div style="position: relative; width: 100%; height: 0; padding-bottom: 75%;"><iframe src="https://player.bilibili.com/player.html?aid=114251247124657&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position: absolute; width: 100%; height: 100%; left: 0; top: 0;"> </iframe></div></div></td>
<td><div class="bili_video"><div style="position: relative; width: 100%; height: 0; padding-bottom: 75%;"><iframe src="https://player.bilibili.com/player.html?aid=114243512830835&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position: absolute; width: 100%; height: 100%; left: 0; top: 0;"> </iframe></div></div></td>
</tr>
<tr>
<td>æ•°æ®é›† B</td>
<td><img src="/2025/03/29/Seven-Principles-for-Large-Model-Evaluation/7.png" alt></td>
<td>ç”Ÿæˆè§†é¢‘ï¼Œè§†é¢‘ä¸­å¹¿è¢¤æ— å çš„ç¿ ç»¿è‰åŸï¼Œå¾®é£æ‹‚åŠ¨è‰æµªï¼Œè¿œå¤„å±±å³¦è¿ç»µèµ·ä¼ä¸è“å¤©ç›¸æ¥ï¼Œé˜³å…‰æ´’ä¸‹ã€‚ä¸€ä½èº«ç€ç»šä¸½æ°‘æ—æœé¥°çš„æ¼‚äº®å¥³æ€§éª‘æ‰‹åŒè…¿è½»å¤¹é©¬è…¹ï¼Œç¼°ç»³ä¸€ç”©ï¼Œéªé©¬å‰è¹„æ‰¬èµ·ï¼Œå˜¶é¸£ä¸€å£°ã€‚éª‘æ‰‹éª‘ç€éªé©¬åœ¨è‰åŸä¸Šçºµæƒ…å¥”è·‘ï¼Œé©¬è¹„æº…èµ·è‰å±‘ï¼Œé©¬é¬ƒé£æ‰¬ï¼Œèº«å§¿çŸ«å¥ï¼Œä¸è‰åŸèä¸ºä¸€ä½“ã€‚</td>
<td><div class="bili_video"><div style="position: relative; width: 100%; height: 0; padding-bottom: 75%;"><iframe src="https://player.bilibili.com/player.html?aid=114251247193854&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position: absolute; width: 100%; height: 100%; left: 0; top: 0;"> </iframe></div></div></td>
<td><div class="bili_video"><div style="position: relative; width: 100%; height: 0; padding-bottom: 75%;"><iframe src="https://player.bilibili.com/player.html?aid=114251263903246&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position: absolute; width: 100%; height: 100%; left: 0; top: 0;"> </iframe></div></div></td>
</tr>
</tbody>
</table>
<h2 id="3-è¯„æµ‹æ ·æœ¬å¿…é¡»åˆ†åœºæ™¯ç»„ç»‡">3. è¯„æµ‹æ ·æœ¬å¿…é¡»åˆ†åœºæ™¯ç»„ç»‡</h2>
<p>åœ¨è¯„æµ‹å¤§æ¨¡å‹çš„è§†è§‰ç†è§£ç†è§£èƒ½åŠ›çš„æ—¶å€™ï¼Œæˆ‘ä»¬å‘ç°ï¼Œä¸åŒçš„åœºæ™¯ä¸‹ï¼Œå¤§æ¨¡å‹çš„è¡¨ç°å·®å¼‚å¾ˆå¤§ã€‚å¦‚æœå•ç‹¬çœ‹æŸä¸ªåœºæ™¯çš„æ•ˆæœï¼Œå¯èƒ½ A æ¨¡å‹æ•ˆæœå¥½ï¼ŒB æ¨¡å‹æ•ˆæœå·®ã€‚ä½†å¦‚æœåœ¨å¦å¤–çš„åœºæ™¯ï¼Œå´å‘ç° B æ¨¡å‹æ•ˆæœå¥½ï¼ŒA æ¨¡å‹æ•ˆæœå·®ã€‚</p>
<table>
<thead>
<tr>
<th style="text-align:center">æ¨¡å‹</th>
<th style="text-align:center">æ•´ä½“å¹³å‡å€¼</th>
<th style="text-align:center">å›¾åƒå†…å®¹æå–</th>
<th style="text-align:center">å›¾åƒé—®ç­”æ¨ç†</th>
<th style="text-align:center">å›¾åƒå¼‚å¸¸è¯†åˆ«</th>
<th style="text-align:center">æ–‡åˆ›</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">A</td>
<td style="text-align:center"><strong>1.57</strong></td>
<td style="text-align:center">1.75</td>
<td style="text-align:center">1.67</td>
<td style="text-align:center">0.57</td>
<td style="text-align:center">1.52</td>
</tr>
<tr>
<td style="text-align:center">B</td>
<td style="text-align:center">1.56</td>
<td style="text-align:center"><strong>1.79</strong></td>
<td style="text-align:center">1.65</td>
<td style="text-align:center">0.57</td>
<td style="text-align:center">1.48</td>
</tr>
<tr>
<td style="text-align:center">C</td>
<td style="text-align:center">1.54</td>
<td style="text-align:center">1.64</td>
<td style="text-align:center">1.8</td>
<td style="text-align:center">0.29</td>
<td style="text-align:center">1.48</td>
</tr>
<tr>
<td style="text-align:center">D</td>
<td style="text-align:center">1.52</td>
<td style="text-align:center">1.39</td>
<td style="text-align:center"><strong>1.83</strong></td>
<td style="text-align:center">0.43</td>
<td style="text-align:center"><strong>1.6</strong></td>
</tr>
<tr>
<td style="text-align:center">E</td>
<td style="text-align:center">1.36</td>
<td style="text-align:center">1.46</td>
<td style="text-align:center">1.47</td>
<td style="text-align:center">0.57</td>
<td style="text-align:center">1.32</td>
</tr>
<tr>
<td style="text-align:center">F</td>
<td style="text-align:center">1.28</td>
<td style="text-align:center">1.43</td>
<td style="text-align:center">1.33</td>
<td style="text-align:center">0.29</td>
<td style="text-align:center">1.32</td>
</tr>
</tbody>
</table>
<h2 id="4-å¤§æ¨¡å‹çš„å‚æ•°å¿…é¡»æ˜ç¡®">4. å¤§æ¨¡å‹çš„å‚æ•°å¿…é¡»æ˜ç¡®</h2>
<p>è™½ç„¶æ˜¯ç›¸åŒçš„æ¨¡å‹ï¼Œä½†æ˜¯æˆ‘ä»¬åœ¨è¯„æµ‹ä¸­å‘ç°å¯¹äºåŒæ ·çš„ Queryï¼Œä¸åŒçš„æ¸ é“è·å¾—çš„ç»“æœå¹¶ä¸ç›¸åŒï¼Œå› æ­¤åœ¨è¯„æµ‹æ—¶ï¼Œå¿…é¡»æ˜ç¡®äº§ç”Ÿå½“å‰ç»“æœçš„ä¸ªæ¨¡å‹çš„å‚æ•°ã€‚</p>
<table>
<thead>
<tr>
<th style="text-align:center">å‚è€ƒå›¾ç‰‡</th>
<th style="text-align:center">åˆ›æ„æè¿°</th>
<th style="text-align:center">å®˜ç½‘æ•ˆæœ</th>
<th style="text-align:center">è‡ªéƒ¨ç½²æ•ˆæœ</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><img src="/2025/03/29/Seven-Principles-for-Large-Model-Evaluation/8.png" alt></td>
<td style="text-align:center">çˆ±å› æ–¯å¦æ­£åœ¨è®¤çœŸçš„ä¸Šè¯¾ï¼Œçªç„¶ï¼Œä»–åœä¸‹æ‰‹ä¸­çš„ç²‰ç¬”ï¼Œè½¬èº«é¢å‘å­¦ç”Ÿï¼Œè°ƒçš®åœ°ä¼¸å‡ºèˆŒå¤´ï¼Œçœ¼ç›çœ¯æˆä¸€æ¡ç¼ï¼Œè„¸ä¸Šéœ²å‡ºä¸€ä¸ªå¯çˆ±çš„ç¬‘å®¹ï¼Œä»¿ä½›åœ¨å’Œå­¦ç”Ÿä»¬å¼€ä¸€ä¸ªå°ç©ç¬‘ã€‚</td>
<td style="text-align:center"><div class="bili_video"><div style="position: relative; width: 100%; height: 0; padding-bottom: 75%;"><iframe src="https://player.bilibili.com/player.html?aid=114251247125730&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position: absolute; width: 100%; height: 100%; left: 0; top: 0;"> </iframe></div></div></td>
<td style="text-align:center"><div class="bili_video"><div style="position: relative; width: 100%; height: 0; padding-bottom: 75%;"><iframe src="https://player.bilibili.com/player.html?aid=114251247127496&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position: absolute; width: 100%; height: 100%; left: 0; top: 0;"> </iframe></div></div></td>
</tr>
</tbody>
</table>
<p>å†æ¯”å¦‚ï¼Œå¯¹äºæ¨ç†æ¨¡å‹è€Œè¨€ï¼Œå¦‚æœæ˜¯ API è®¿é—®æ¨¡å‹ï¼Œåˆ™ä¼šç¼ºå°‘è”ç½‘æœç´¢çš„èƒ½åŠ›ï¼Œä½†æ˜¯å¦‚æœæ˜¯ WEB è®¿é—®æ¨¡å‹ï¼Œåˆ™å¯ä»¥å¢åŠ è”ç½‘æœç´¢èƒ½åŠ›ã€‚</p>
<p><img src="/2025/03/29/Seven-Principles-for-Large-Model-Evaluation/10.png" alt></p>
<h2 id="5-è¯„ä¼°æ ·æœ¬å¿…é¡»ç»†åŒ–æ‰“åˆ†å‡†åˆ™">5. è¯„ä¼°æ ·æœ¬å¿…é¡»ç»†åŒ–æ‰“åˆ†å‡†åˆ™</h2>
<p>åªè¿›è¡Œæ•´ä½“è¯„ä¼°å®¹æ˜“å¿½ç•¥æ¨¡å‹çš„åœ¨ç‰¹æ®Šåœºæ™¯ä¸‹çš„ä¼˜åŠ¿ï¼Œä¹Ÿå®¹æ˜“å¿½ç•¥æ¨¡å‹åœ¨ç‰¹æ®Šåœºæ™¯ä¸‹çš„ç¼ºç‚¹ã€‚</p>
<table>
<thead>
<tr>
<th style="text-align:center">å‚è€ƒå›¾ç‰‡</th>
<th style="text-align:center">åˆ›æ„æè¿°</th>
<th style="text-align:center">æ¨¡å‹ A æ•ˆæœ</th>
<th style="text-align:center">æ¨¡å‹ B æ•ˆæœ</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><img src="/2025/03/29/Seven-Principles-for-Large-Model-Evaluation/11.png" alt></td>
<td style="text-align:center">å›¾ä¸­æœ‰ä¸¤ä½å¹´è½»æ¼‚äº®çš„å¥³ç”Ÿåœ¨é…’å§å–é…’ï¼Œè¯·æ ¹æ®å›¾ç‰‡ç”Ÿæˆä»–ä»¬ä¸€è¾¹å–é…’ï¼Œä¸€è¾¹å°½æƒ…èˆåŠ¨ï¼Œæ´»åŠ›å››å°„çš„è§†é¢‘ã€‚è§†é¢‘ä¸­é…’å§çš„å½©è‰²éœ“è™¹ç¯ç¼“æ…¢çš„é—ªçƒï¼ŒæŠ•å°„å‡ºè¿·å¹»çš„å…‰å½±ï¼Œå¹¶è¥é€ å‡ºèŠ‚æ—¥èˆ¬çš„æ°›å›´ã€‚ä¸¤ä½ä¸»è§’éšç€èŠ‚å¥æ‘†åŠ¨èº«ä½“ï¼Œè„¸ä¸Šæ´‹æº¢ç€ç¿çƒ‚ç¬‘å®¹ï¼Œå½¼æ­¤çœ¼ç¥äº¤æµï¼Œæµéœ²å‡ºäº²å¯†ä¸å–œæ‚¦ã€‚</td>
<td style="text-align:center"><div class="bili_video"><div style="position: relative; width: 100%; height: 0; padding-bottom: 75%;"><iframe src="https://player.bilibili.com/player.html?aid=114243512828076&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position: absolute; width: 100%; height: 100%; left: 0; top: 0;"> </iframe></div></div></td>
<td style="text-align:center"><div class="bili_video"><div style="position: relative; width: 100%; height: 0; padding-bottom: 75%;"><iframe src="https://player.bilibili.com/player.html?aid=114243512831662&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position: absolute; width: 100%; height: 100%; left: 0; top: 0;"> </iframe></div></div></td>
</tr>
<tr>
<td style="text-align:center"><img src="/2025/03/29/Seven-Principles-for-Large-Model-Evaluation/12.png" alt></td>
<td style="text-align:center">ç”·äººçœ‹å‘å·¦ä¾§ï¼Œè¯´ç€è¯</td>
<td style="text-align:center"><div class="bili_video"><div style="position: relative; width: 100%; height: 0; padding-bottom: 75%;"><iframe src="https://player.bilibili.com/player.html?aid=114243512828838&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position: absolute; width: 100%; height: 100%; left: 0; top: 0;"> </iframe></div></div></td>
<td style="text-align:center"><div class="bili_video"><div style="position: relative; width: 100%; height: 0; padding-bottom: 75%;"><iframe src="https://player.bilibili.com/player.html?aid=114243512830377&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position: absolute; width: 100%; height: 100%; left: 0; top: 0;"> </iframe></div></div></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th></th>
<th>æ•´ä½“æ‰“åˆ†</th>
<th>è¿åŠ¨å¤æ‚åº¦</th>
<th>ç»†èŠ‚æ•ˆæœ</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ¨¡å‹ A</td>
<td>1.5</td>
<td>2</td>
<td>1</td>
</tr>
<tr>
<td>æ¨¡å‹ B</td>
<td>1.5</td>
<td>1</td>
<td>2</td>
</tr>
</tbody>
</table>
<p>å¯¹äº VBench æ¦œå•ï¼Œå¯¹äºä¸åŒçš„è§†é¢‘ç”Ÿæˆæ¨¡å‹ï¼Œä»å•ç»´åº¦æ‰“åˆ†æ¥çœ‹ï¼Œä¸åŒæ¨¡å‹ä¹‹é—´æœ‰å¾ˆå¤§çš„åŒºåˆ«ã€‚ä½†æ˜¯ä»æ€»åˆ†æ¥ï¼Œæ¨¡å‹ä¹‹é—´çš„å·®è·åè€Œå˜çš„ä¸æ˜æ˜¾äº†ï¼ˆ80%~86%ä¹‹é—´çš„æ¨¡å‹æœ‰30+ä¸ªï¼‰ã€‚</p>
<table>
<thead>
<tr>
<th>VBench æ‰“åˆ†ç»´åº¦</th>
<th>VBench æ¦œå•</th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="/2025/03/29/Seven-Principles-for-Large-Model-Evaluation/13.png" alt></td>
<td><img src="/2025/03/29/Seven-Principles-for-Large-Model-Evaluation/14.png" alt></td>
</tr>
</tbody>
</table>
<p>ä»æ•°å­¦çš„è§’åº¦çœ‹å¾…åˆ†ç»´åº¦æ‰“åˆ†çš„å¿…è¦æ€§ã€‚å‡è®¾æ¨¡å‹å…·å¤‡ 3 ä¸ªæŒ‡æ ‡ï¼Œè€ƒè™‘åˆ°æ¨¡å‹çš„éšæœºæ€§ï¼Œæ‰€ä»¥è¿™ 3 ä¸ªæŒ‡æ ‡æ˜¯ä¸€ä¸ªéšæœºå˜é‡ï¼Œå¹¶å‡å®šå…¶å‡ç¬¦åˆæ ‡å‡†æ­£æ€åˆ†å¸ƒâ€”â€”<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>X</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>X</mi><mn>3</mn></msub><mo>âˆ¼</mo><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">X_1, X_2,X_3 \sim \mathcal{N}(0,1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆ¼</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.14736em;">N</span></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span>ã€‚<br>
å› ä¸ºä¸‰ä¸ªæŒ‡æ ‡æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œå› æ­¤ï¼Œæ¨¡å‹çš„æ•´ä½“æŒ‡æ ‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mn>4</mn></msub><mo>=</mo><msub><mi>X</mi><mn>1</mn></msub><mo>+</mo><msub><mi>X</mi><mn>2</mn></msub><mo>+</mo><msub><mi>X</mi><mn>3</mn></msub><mo>âˆ¼</mo><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>3</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">X_4 = X_1 + X_2 + X_3 \sim \mathcal{N}(0,3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆ¼</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.14736em;">N</span></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">3</span><span class="mclose">)</span></span></span></span>ã€‚<br>
ç”±äºæ•´ä½“çš„æ–¹å·® <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Ïƒ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\sigma^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span> å˜å¤§ï¼Œå› æ­¤åœ¨è¿›è¡Œæ¨æ–­ç»Ÿè®¡æ—¶ï¼Œç»Ÿè®¡é‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mo>=</mo><msqrt><mi>n</mi></msqrt><mfrac><mrow><mover accent="true"><mi>x</mi><mo>Ë‰</mo></mover><mo>âˆ’</mo><msub><mi>Î¼</mi><mn>0</mn></msub></mrow><mi>Ïƒ</mi></mfrac></mrow><annotation encoding="application/x-tex">Z=\sqrt{n}\frac{\bar{x}-\mu_0}{\sigma}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.199439em;vertical-align:-0.345em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8002800000000001em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathdefault">n</span></span></span><span style="top:-2.76028em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.23972em;"><span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.854439em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">Ïƒ</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.446108em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.56778em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mtight"><span class="mord mathdefault mtight">x</span></span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="accent-body" style="left:-0.22222em;"><span class="mord mtight">Ë‰</span></span></span></span></span></span></span><span class="mbin mtight">âˆ’</span><span class="mord mtight"><span class="mord mathdefault mtight">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> ä¼šå˜å°ï¼Œè¿›è€Œå¯¼è‡´åŒè¾¹æ£€éªŒçš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>âˆ’</mo><mtext>value</mtext><mo>=</mo><mn>2</mn><mo>Ã—</mo><mo stretchy="false">(</mo><mn>1</mn><mo>âˆ’</mo><mi mathvariant="normal">Î¦</mi><mo stretchy="false">(</mo><mi mathvariant="normal">âˆ£</mi><mi>Z</mi><mi mathvariant="normal">âˆ£</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p-\text{value} = 2 \times (1 - \Phi(|Z|))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord text"><span class="mord">value</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Î¦</span><span class="mopen">(</span><span class="mord">âˆ£</span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mord">âˆ£</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span> ä¼šå˜å¤§ï¼Œä»è€Œå¯¼è‡´æ— æ³•å¯¹ä¸åŒæ¨¡å‹çš„èƒ½åŠ›è¿›è¡ŒåŒºåˆ†ã€‚</p>
<p><img src="/2025/03/29/Seven-Principles-for-Large-Model-Evaluation/14_1.png" alt></p>
<h2 id="6-å‡¡ä¸»è§‚-å¿…åŒç›²">6. å‡¡ä¸»è§‚ï¼Œå¿…åŒç›²</h2>
<p>å¯¹äºä¸»è§‚è¯„ä¼°ï¼Œå½“è¿ç»­è¯„ä¼°æ—¶é—´è¶…è¿‡ 20 åˆ†é’Ÿæ—¶ï¼Œæ‰“åˆ†çš„å‡†ç¡®æ€§å¼€å§‹ä¸‹é™ã€‚å°¤å…¶æ˜¯å¯¹äºæ¨ç†æ¨¡å‹å’Œå›¾ç‰‡ç†è§£åœºæ™¯çš„è¯„ä¼°ï¼Œæ¨¡å‹çš„ç”Ÿæˆå†…å®¹è¶Šæ¥è¶Šå¤æ‚ï¼Œè¯„ä¼°éš¾åº¦è¶Šæ¥è¶Šå¤§ï¼Œä¸ºäº†é¿å…äººçš„ç–²åŠ³å¸¦æ¥çš„æ‰“åˆ†ç½®ä¿¡åº¦ä¸‹é™ï¼Œå¿…é¡»é‡‡ç”¨å…¨åŒç›²çš„è¯„ä¼°æ‰‹æ®µã€‚</p>
<h2 id="7-å‡¡ç»Ÿè®¡-å¿…æ¨æ–­">7. å‡¡ç»Ÿè®¡ï¼Œå¿…æ¨æ–­</h2>
<p>è¯„æµ‹æ˜¯æŠ½æ ·é—®é¢˜ï¼Œæ ·æœ¬çš„æè¿°æ€§ç»Ÿè®¡æŒ‡æ ‡ï¼ˆå‡å€¼ï¼Œä¸­ä½æ•°ç­‰ï¼‰ä¸ä»£è¡¨å…¨ä½“ã€‚æ ·æœ¬ç»Ÿè®¡é‡æ•°å€¼çš„ç»å¯¹æ’åºå¹¶ä¸ä¸€å®šæ„å‘³ç€æ¨¡å‹ A å°±è‚¯å®šæ¯”æ¨¡å‹ B è¦å¥½ã€‚</p>
<table>
<thead>
<tr>
<th>gpt-4o-system-card</th>
<th>VBench çš„æ¦œå•ï¼Œ86.22%å’Œ85.71% ä¹‹é—´èƒ½è¯´æ˜ä»€ä¹ˆï¼Ÿ</th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="/2025/03/29/Seven-Principles-for-Large-Model-Evaluation/15.png" alt></td>
<td><img src="/2025/03/29/Seven-Principles-for-Large-Model-Evaluation/16.png" alt></td>
</tr>
</tbody>
</table>
<p>è®ºæ–‡ <a href="https://arxiv.org/abs/2403.15250">Comprehensive Reassessment of Large-Scale Evaluation Outcomes in LLMs: A Multifaceted Statistical Approach</a> ä¸­æå‡ºï¼šåœ¨è¯„ä¼°å¤§æ¨¡å‹æ—¶ï¼Œéœ€è¦å¯¹è¯„ä¼°çš„æè¿°æ€§ç»Ÿè®¡ç»“æœè¿›è¡Œæ¨æ–­å†è¯„ä¼°ï¼Œä¾‹å¦‚å‡è®¾æ£€éªŒã€æ–¹å·®åˆ†æç­‰ã€‚</p>
<p><img src="/2025/03/29/Seven-Principles-for-Large-Model-Evaluation/17.png" alt></p>
<p>ä¸åŒå¤§æ¨¡å‹å¯¹ä¸‰ç±» Query çš„å‡ºå›¾ç‡æ•°æ®æ¨æ–­åˆ†æï¼š<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><mtext>æ¨¡å‹Aä¸æ¨¡å‹Bçš„å‡ºå›¾ç‡ä¸€è‡´</mtext><mspace width="1em"><mi>v</mi><mi>s</mi><mi mathvariant="normal">.</mi><mspace width="1em"><msub><mi>H</mi><mn>1</mn></msub><mo>:</mo><mtext>æ¨¡å‹Aä¸æ¨¡å‹Bçš„å‡ºå›¾ç‡ä¸ä¸€è‡´</mtext></mspace></mspace></mrow><annotation encoding="application/x-tex">H_0: \text{æ¨¡å‹Aä¸æ¨¡å‹Bçš„å‡ºå›¾ç‡ä¸€è‡´} \quad vs. \quad H_1: \text{æ¨¡å‹Aä¸æ¨¡å‹Bçš„å‡ºå›¾ç‡ä¸ä¸€è‡´}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord text"><span class="mord cjk_fallback">æ¨¡å‹</span><span class="mord">A</span><span class="mord cjk_fallback">ä¸æ¨¡å‹</span><span class="mord">B</span><span class="mord cjk_fallback">çš„å‡ºå›¾ç‡ä¸€è‡´</span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">s</span><span class="mord">.</span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord text"><span class="mord cjk_fallback">æ¨¡å‹</span><span class="mord">A</span><span class="mord cjk_fallback">ä¸æ¨¡å‹</span><span class="mord">B</span><span class="mord cjk_fallback">çš„å‡ºå›¾ç‡ä¸ä¸€è‡´</span></span></span></span></span></p>
<h6 id="query-ç±»åˆ«-a">Query ç±»åˆ« A</h6>
<table>
<thead>
<tr>
<th>æ¨¡å‹</th>
<th>å‡ºå›¾é‡</th>
<th>æœªå‡ºå›¾é‡</th>
<th>å‡ºå›¾ç‡</th>
</tr>
</thead>
<tbody>
<tr>
<td>A</td>
<td>65</td>
<td>85</td>
<td>43%</td>
</tr>
<tr>
<td>B</td>
<td>54</td>
<td>96</td>
<td>36%</td>
</tr>
</tbody>
</table>
<p><img src="/2025/03/29/Seven-Principles-for-Large-Model-Evaluation/18.png" alt></p>
<h6 id="query-ç±»åˆ«-b">Query ç±»åˆ« B</h6>
<table>
<thead>
<tr>
<th>æ¨¡å‹</th>
<th>å‡ºå›¾é‡</th>
<th>æœªå‡ºå›¾é‡</th>
<th>å‡ºå›¾ç‡</th>
</tr>
</thead>
<tbody>
<tr>
<td>A</td>
<td>95</td>
<td>25</td>
<td>79%</td>
</tr>
<tr>
<td>B</td>
<td>83</td>
<td>37</td>
<td>69%</td>
</tr>
</tbody>
</table>
<p><img src="/2025/03/29/Seven-Principles-for-Large-Model-Evaluation/19.png" alt></p>
<h6 id="query-ç±»åˆ«-c">Query ç±»åˆ« C</h6>
<table>
<thead>
<tr>
<th>æ¨¡å‹</th>
<th>å‡ºå›¾é‡</th>
<th>æœªå‡ºå›¾é‡</th>
<th>å‡ºå›¾ç‡</th>
</tr>
</thead>
<tbody>
<tr>
<td>A</td>
<td>12</td>
<td>122</td>
<td>9%</td>
</tr>
<tr>
<td>B</td>
<td>23</td>
<td>111</td>
<td>17%</td>
</tr>
</tbody>
</table>
<p><img src="/2025/03/29/Seven-Principles-for-Large-Model-Evaluation/20.png" alt></p>
]]></content>
      <categories>
        <category>LLM</category>
      </categories>
      <tags>
        <tag>è¯„æµ‹</tag>
      </tags>
  </entry>
  <entry>
    <title>å¯¹å¤§æ¨¡å‹æŠ€æœ¯æ¼”åŒ–çš„æ€è€ƒ</title>
    <url>/2024/12/01/Reflections-on-the-LLMs-Technological-Evolution/</url>
    <content><![CDATA[<p><img src="/2024/12/01/Reflections-on-the-LLMs-Technological-Evolution/ai-generated.jpg" alt></p>
<p>æœ€è¿‘çš„ä¸€æ®µæ—¶é—´ï¼Œä¸ºäº†æ»¡è¶³è‡ªå·±å¯¹äº OpenAI å‘å¸ƒçš„ <em><a href="https://openai.com/index/api-prompt-caching/">Prompt Caching in the API</a></em> çš„å¼ºçƒˆå¥½å¥‡å¿ƒï¼Œå¯¹å¤§æ¨¡å‹çš„ç›¸å…³è®ºæ–‡å’ŒæŠ€æœ¯åšäº†éå¸¸å¤šçš„æ¢³ç†ï¼ŒåŒ…æ‹¬äº†å¤§æ¨¡å‹çš„åº•å±‚åŸç† Transformer æ¶æ„ï¼Œåˆ° GPTæ¶æ„ çš„æ¼”å˜ï¼Œåˆ°å¤§æ¨¡å‹çš„è¿è¡Œæ—¶æ¨ç†ã€åœ¨çº¿æ¨ç†ä¼˜åŒ–â€¦â€¦</p>
<p>å½“æˆ‘åä¸‹æ¥ç»†ç»†çš„å›å‘³è¿™æ®µè§£æƒ‘çš„æ—¶å…‰ï¼Œæ‰å‘ç°ç•…æ¸¸äºå¤§æ¨¡å‹å‘å±•ä¹‹è·¯çš„æ²¿é€”é£æ™¯äº¦ç™¾èŠ±ç››å¼€ã€‚æ°å·§ä»Šå¹´çš„å·¥ä½œå¤§å¤šå’Œæ•ˆç‡ä¼˜åŒ–æœ‰å…³ï¼Œå†å›é¡¾ä¸€ä¸‹è‡ªå·±çš„å·¥ä½œï¼Œå‘ç°è¿™å…¶ä¸­ä¹Ÿå­˜åœ¨å¾ˆå¤šç›¸ä¼¼çš„åœ°æ–¹ï¼Œä¾‹å¦‚ï¼šé—®é¢˜çš„é‡åŒ–ä¸åˆ†æï¼Œä¼˜åŒ–æ–¹æ¡ˆçš„æ‹†è§£ï¼Œåå­—è·¯å£æ”¯å‡ºçš„æŠ€æœ¯ä¿¡ä»°â€¦â€¦</p>
<span id="more"></span>
<h2 id="é‡åŒ–ä¸åˆ†æ">é‡åŒ–ä¸åˆ†æ</h2>
<p>å¤§æ¨¡å‹çš„å¾ˆå¤šæŠ€æœ¯å¹¶éå…¨éƒ¨æ¥è‡ªä¸¥æ ¼çš„æ•°å­¦æ¨å¯¼ï¼Œè€Œæ˜¯åŸºäºå¤§é‡çš„å®éªŒæ•°æ®ï¼Œç„¶åé€šè¿‡å¯¹å®éªŒæ•°æ®çš„é‡åŒ–åˆ†æå¾—å‡ºç»“è®ºã€‚å› æ­¤ï¼Œåœ¨å¾ˆå¤šçš„è®ºæ–‡ä¸­ï¼Œç»å¸¸éƒ½ä¼šçœ‹åˆ°å¦‚ä¸‹çš„æè¿°ï¼š</p>
<blockquote>
<ul>
<li>
<p><strong>Experiments</strong> on two machine translation tasks show these models to be superior in quality while being more parallelizable and requiring significantly less time to train. (<em>From: Attention is all you need</em>)</p>
</li>
<li>
<p>In our <strong>experiments</strong>, we use a multi-layer Transformer decoder for the language model, which is<br>
a variant of the transformer. This model applies a multi-headed self-attention operation over the<br>
input context tokens followed by position-wise feedforward layers to produce an output distribution<br>
over target tokens. (<em>From: Improving Language Understanding by Generative Pre-Training</em>)</p>
</li>
<li>
<p>We study <strong>empirical</strong> scaling laws for language model performance on the cross-entropy loss. (<em>From: Scaling Laws for Neural Language Models</em>)</p>
</li>
<li>
<p>Our <strong>experiments</strong> reveal that, at small batch sizes, the decode cost per token can be as high as âˆ¼ 200 times the prefill cost per token.(<em>From: SARATHI: Efficient LLM Inference by Piggybacking Decodes with Chunked Prefills</em>)</p>
</li>
<li>
<p>Our second idea is our <strong>empirical</strong> finding that LLMs can operate on attention states with discontinuous position IDs.(<em>From: PROMPT CACHE: MODULAR ATTENTION REUSE FOR LOW-LATENCY INFERENCE</em>)</p>
</li>
</ul>
</blockquote>
<p>åœ¨è¿™é‡Œé¢ï¼Œæœ€ä¸ºå…¸å‹çš„ç ”ç©¶å½“å± OpenAI åœ¨ 2020 å¹´ 1 æœˆ å‘è¡¨çš„ <em><a href="https://arxiv.org/abs/2001.08361">Scaling Laws for Neural Language Models</a></em> ï¼Œè¿™ç¯‡è®ºæ–‡é€šè¿‡å®éªŒçš„é‡åŒ–åˆ†æå¯¹å¤§æ¨¡å‹çš„æ€§èƒ½ã€å‚æ•°é‡ã€è®­ç»ƒæ•°æ®ã€è®¡ç®—é‡ä¹‹é—´çš„å…³è”æ€§è¿›è¡Œäº†æ·±å…¥çš„åˆ†æï¼Œå¹¶æå‡ºäº†å¤§æ¨¡å‹é¢†åŸŸçš„ â€œScaling Lawsâ€ ç†è®ºï¼Œä¸ºåç»­å¤§æ¨¡å‹çš„å‘å±•æä¾›äº†é‡è¦çš„æŒ‡å¯¼æ„ä¹‰ã€‚</p>
<p>è‡ªä»è°·æ­Œçš„ç¿»è¯‘å›¢é˜Ÿåœ¨ 2018 å¹´æå‡º Transformer æ¶æ„ä¹‹åï¼Œéå¸¸å¤šçš„ç ”ç©¶è€…éƒ½åœ¨æ¢ç´¢ä¸åŒçš„æ¨¡å‹ç»“æ„ï¼Œå¹¶åœ¨ä¸åŒçš„ä»»åŠ¡ä¸Šå–å¾—äº†æ–°çš„ SOTAï¼Œä½†æ˜¯åœ¨ OpenAI å‘è¡¨ <em>Scaling Laws</em> ä¹‹å‰å´å¾ˆå°‘æœ‰äººè€ƒè™‘å½±å“æ¨¡å‹æ€§èƒ½çš„ä¸»è¦å› ç´ ç©¶ç«Ÿæ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p>æˆ–è€…ï¼Œåœ¨ OpenAI å‘è¡¨ <em>Scaling Laws</em> ä¹‹å‰ï¼Œä¹Ÿæœ‰ç ”ç©¶è€…å¯¹å½±å“æ¨¡å‹æ€§èƒ½çš„ç›¸å…³å› ç´ è¿›è¡Œäº†é‡åŒ–çš„ç ”ç©¶æˆ–è€…åˆ†æï¼Œæˆ–è€…ä¹Ÿå‘ç°äº†åˆæ­¥çš„ç»“è®º<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup>ï¼Œä½†æ˜¯ä»ç„¶æ²¡æœ‰äººå¯¹è¿™äº›å¤§é‡çš„å®éªŒæ•°æ®è¿›è¡Œé‡åŒ–åˆ†æå¹¶æå‡º <em>Scaling Laws</em> çš„å…·ä½“æ•°å­¦è¡¨ç¤º<sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup>ã€‚</p>
<p>å½“ç„¶ï¼Œç«™åœ¨ä»Šå¤©çš„è§†è§’å†æ¥å›é¡¾ <em>Scaling Laws</em> çš„å®šä¹‰ï¼Œæˆ‘ä»¬ä¼šå‘ç°è¿™é‡Œé¢å…¶å®å¹¶æ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«é«˜æ·±çš„æŠ€æœ¯ï¼Œåªæ˜¯åˆ©ç”¨å®éªŒåšäº†é‡åŒ–åˆ†æå¹¶ç”¨æ•°å­¦è¯­è¨€æ¥è¡¨è¿°æ‰€å‘ç°çš„è§„å¾‹ã€‚æˆ–è®¸ï¼Œæˆ‘ä»¬ä¼šè¯´ï¼Œè¿™ä¸ªå®éªŒæˆ‘ä»¬ä¹Ÿèƒ½åšï¼Œå°±å¥½åƒå¦‚æœæ—¶å…‰å€’æµï¼Œæˆ‘ä»¬ä¹Ÿèƒ½æå‡º <em>Scaling Laws</em> ä¸€æ ·ã€‚ä½†æ˜¯ï¼Œç›´åˆ° OpenAI å‘è¡¨äº† <em>Scaling Laws</em>ï¼Œä¹Ÿæ²¡æœ‰å›¢é˜Ÿèƒ½å¤Ÿè¿™æ ·ç³»ç»Ÿçš„æå‡º <em>Scaling Laws</em>ã€‚</p>
<p>æ‰€è°“ <em>Scaling laws</em> å…¶å®å°±æ˜¯ä¸€ç§æè¿°ç³»ç»Ÿéšç€è§„æ¨¡çš„å˜åŒ–è€Œå‘ç”Ÿçš„è§„å¾‹æ€§å˜åŒ–çš„æ•°å­¦è¡¨è¾¾â€”â€”é€šå¸¸è¡¨ç°ä¸ºéšç€ç³»ç»Ÿè§„æ¨¡çš„å¢åŠ ï¼ŒæŸäº›å¯æµ‹é‡çš„ç‰¹å¾å‘ˆç°å‡ºçš„æŸç§å›ºå®šçš„æ¯”ä¾‹å…³ç³»ã€‚</p>
<p>2018 å¹´ 6 æœˆï¼ŒOpenAI å‘å¸ƒäº† 116M å‚æ•°è§„æ¨¡çš„ GPT-1 æ¨¡å‹ï¼ˆImproving Language Understanding by Generative Pre-Trainingï¼‰ï¼Œ2019 å¹´ 4 æœˆï¼Œä»–ä»¬åˆå‘å¸ƒäº† 1.5B å‚æ•°è§„æ¨¡çš„ GPT-2 æ¨¡å‹ï¼ˆLanguage Models are Few-Shot Learnersï¼‰ï¼Œéšç€å‚æ•°è§„æ¨¡çš„å¢åŠ ï¼Œæ¨¡å‹æ€§èƒ½ä¹Ÿå‘ˆç°å‡ºäº†æ˜æ˜¾çš„çº¿æ€§å¢é•¿ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œå¦‚ä½•èƒ½å¤Ÿè®©æ¨¡å‹çš„æ€§èƒ½å†ä¸Šä¸€ä¸ªæ–°çš„å°é˜¶å‘¢ï¼ŸGPT-2 æ¨¡å‹çš„å‚æ•°é‡è¾¾åˆ°äº† 1.5Bï¼Œè®­ç»ƒæ•°æ®é‡è¾¾åˆ°äº† 40GBï¼Œè®­ç»ƒçš„æˆæœ¬ä¹Ÿé«˜è¾¾ 256$ æ¯å°æ—¶<sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup>ï¼ˆæ€»æˆæœ¬é¢„ä¼°åœ¨ 10 ä¸‡$ å·¦å³ï¼‰ï¼Œæ¥ä¸‹æ¥çš„æ–¹å‘å°†æ˜¯ä»€ä¹ˆï¼Ÿå‚æ•°é‡è¦ç»§ç»­å¢åŠ åˆ°å¤šå°‘ï¼Ÿéœ€è¦å¤šå°‘è®­ç»ƒæ•°æ®ï¼Ÿ</p>
<p>å¦‚æœå®Œå…¨æ˜¯èµ°ä¸€æ­¥çœ‹ä¸€æ­¥çš„æ€è·¯ï¼Œæˆ–è€…æ•°æ®é‡ä¸å¤Ÿã€æˆ–è€…æ•°æ®é‡è¿‡å¤§ï¼Œå¯¼è‡´æµªè´¹éå¸¸å¤šçš„è®¡ç®—èµ„æºï¼Œåå¤çš„è¿­ä»£æ¢ç´¢ä¹Ÿä¼šè®©è®­ç»ƒæˆæœ¬å˜å¾—æ— æ¯”åºå¤§ã€‚è¿™å¯èƒ½æ˜¯ OpenAI å›¢é˜Ÿå½“æ—¶é¢ä¸´çš„æœ€å¤§é—®é¢˜ã€‚å› æ­¤åœ¨ç»§ç»­è®­ç»ƒä¸‹ä¸€ä»£å¤§æ¨¡å‹ä¹‹å‰ï¼Œä»–ä»¬å¼€å§‹è®¤çœŸçš„æ€è€ƒè¿™äº›é—®é¢˜ï¼Œé€šè¿‡ä¸€ç³»åˆ—çš„å®éªŒé‡åŒ–åˆ†æï¼Œäº 2020 å¹´ 1 æœˆæå‡ºäº† <em>Scaling Laws for Neural Language Models</em>ï¼Œå¹¶ç”¨æ­¤æ¥æŒ‡å¯¼åç»­æ›´å¤§æ¨¡å‹çš„è®­ç»ƒã€‚</p>
<p>4 ä¸ªæœˆä¹‹åï¼Œ2020 å¹´ 5 æœˆï¼Œ175B å‚æ•°çš„ GPT-3 æ¨¡å‹ï¼ˆLanguage Models are Few-Shot Learnersï¼‰æ­£å¼å‘å¸ƒã€‚åœ¨ GPT-3 çš„è®ºæ–‡ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†å¦‚ä¸‹æè¿°ï¼š</p>
<blockquote>
<ul>
<li>
<p>Based on the analysis in Scaling Laws For Neural Language Models, we train much larger models on many fewer tokens than is typical.</p>
</li>
<li>
<p>applied scaling laws to help predict and guide model and data scaling decisions for the research.</p>
</li>
</ul>
</blockquote>
<h3 id="scaling-laws">Scaling Laws</h3>
<p>å¤§è¯­è¨€æ¨¡å‹çš„ <em>Scaling Laws</em> æè¿°çš„æ˜¯æ¨¡å‹çš„æ€§èƒ½ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">L</span></span></span></span>ï¼Œ æ¨¡å‹çš„å‚æ•°é‡å¤§å° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span>ï¼Œè®­ç»ƒæ¨¡å‹çš„æ•°æ®å¤§å° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span></span></span></span>ï¼Œä»¥åŠè®­ç»ƒæ¨¡å‹ä½¿ç”¨çš„è®¡ç®—é‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span></span> ä¹‹é—´çš„å…³ç³»ã€‚<sup class="footnote-ref"><a href="#fn4" id="fnref4">[4]</a></sup>åœ¨è®ºæ–‡ä¸­ï¼Œé‡‡ç”¨æµ‹è¯•é›†ä¸Šäº¤å‰ç†µæ¥è¡¨å¾æ¨¡å‹çš„æ€§èƒ½ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">L</span></span></span></span>ï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo>=</mo><mo>âˆ’</mo><mfrac><mn>1</mn><mi>T</mi></mfrac><munderover><mo>âˆ‘</mo><mrow><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mi>T</mi></munderover><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi mathvariant="normal">âˆ£</mi><mi mathvariant="script">D</mi><mi mathvariant="normal">âˆ£</mi></mrow></munderover><msubsup><mover accent="true"><mi>y</mi><mo>^</mo></mover><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mi>log</mi><mo>â¡</mo><mi>p</mi><mo stretchy="false">(</mo><msubsup><mi>y</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mi mathvariant="normal">âˆ£</mi><msub><mi>w</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>w</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator="true">,</mo><msub><mi>w</mi><mi>t</mi></msub><mo separator="true">;</mo><mi>Î¸</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">L = - \frac{1}{T} \sum_{t = 0}^{T} \sum_{i = 1}^{\vert \mathcal{D} \vert} \hat{y}_{t + 1}^{i} \log p(y_{t + 1}^{i} \vert w_1, w_2, \cdots, w_t; \theta)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">L</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.2386740000000005em;vertical-align:-1.277669em;"></span><span class="mord">âˆ’</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em;"><span style="top:-1.882887em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.267113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.9610050000000003em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.386005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ£</span><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.02778em;">D</span></span><span class="mord mtight">âˆ£</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">^</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.874664em;"><span style="top:-2.4530000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.305331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.874664em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.305331em;"><span></span></span></span></span></span></span><span class="mord">âˆ£</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">Î¸</span><span class="mclose">)</span></span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">D</mi></mrow><annotation encoding="application/x-tex">\mathcal{D}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.02778em;">D</span></span></span></span></span> è¡¨ç¤º token å­—å…¸è¡¨ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span></span></span></span> è¡¨ç¤ºæ–‡æœ¬æ ·æœ¬è¢«åˆ’åˆ†ä¸º token åçš„é•¿åº¦ã€‚è®ºæ–‡åŒæ—¶ç»™å‡ºäº†åœ¨ä½¿ç”¨ Transformer æ¶æ„è®­ç»ƒæ¨¡å‹æ—¶ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span></span>ã€<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span>ã€<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span></span></span></span> ä¹‹é—´çš„å…³ç³»è¿‘ä¼¼äºï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo>=</mo><mn>6</mn><mi>N</mi><mi>D</mi></mrow><annotation encoding="application/x-tex">C = 6ND
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">6</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span></span></span></span></span></p>
<p><em>Scaling Laws</em> çš„æ ¸å¿ƒå°±æ˜¯ï¼šå¯¹äºè®¡ç®—é‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span></span>ï¼Œæ¨¡å‹å‚æ•°é‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span>ï¼Œæ•°æ®é›†å¤§å° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span></span></span></span> è€Œè¨€ï¼Œå½“ä¸å—å…¶ä»–ä¸¤ä¸ªå› ç´ åˆ¶çº¦æ—¶ï¼Œæ¨¡å‹çš„æ€§èƒ½ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">L</span></span></span></span> ä¸æ¯ä¸ªå› ç´ éƒ½å‘ˆç°å¹‚å¾‹å…³ç³»ï¼Œå³ï¼šï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mrow><mo fence="true">(</mo><mfrac><mi>c</mi><mi>x</mi></mfrac><mo fence="true">)</mo></mrow><mi>Î±</mi></msup></mrow><annotation encoding="application/x-tex">L(x) = \left(\frac{c}{x}\right)^{\alpha}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">L</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.890292em;vertical-align:-0.686em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10756em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">c</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.204292em;"><span style="top:-3.6029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.0037em;">Î±</span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">L</span></span></span></span> ä¸ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span></span> çš„å¹‚å¾‹å…³ç³»å‘Šè¯‰æˆ‘ä»¬ï¼Œä¸ºäº†å¾—åˆ°æ›´é«˜æ€§èƒ½çš„æ¨¡å‹ï¼Œæˆ‘ä»¬æ˜¯éœ€è¦ä»˜å‡ºä¸€å®šçš„ä»£ä»·çš„ã€‚è®ºæ–‡ä¸­æå‡ºï¼Œæ¯å¢åŠ  10 å€çš„è®¡ç®—é‡ï¼Œæ•°æ®é›†å¤§å°åº”è¯¥å¢åŠ çº¦ 1.8 å€ï¼Œæ¨¡å‹å‚æ•°é‡åº”è¯¥å¢åŠ çº¦ 5.5 å€ã€‚</p>
<h3 id="æ•ˆèƒ½å·¥ä½œçš„é‡åŒ–">æ•ˆèƒ½å·¥ä½œçš„é‡åŒ–</h3>
<p>å›å¤´æƒ³ä¸€ä¸‹ä»Šå¹´çš„æ•ˆèƒ½å·¥ä½œï¼Œå…¶å®å’Œ <em>Scaling Laws</em> çš„æ€è·¯éå¸¸ç›¸ä¼¼ï¼Œæˆ‘ä»¬ä¹Ÿæ˜¯é€šè¿‡å¤§é‡çš„å®è¯æ•°æ®çš„é‡åŒ–åˆ†ææ¥æŒ‡å¯¼æˆ‘ä»¬çš„å·¥ä½œã€‚æˆ‘ä»¬è®¤ä¸ºè´¨é‡æ˜¯å½±å“å½“å‰æ•ˆç‡çš„æ ¸å¿ƒå› ç´ ï¼Œæ‰€ä»¥æˆ‘ä»¬é€šè¿‡è´¨é‡æ•°æ®çš„åˆ†é˜¶æ®µåˆ†å¸ƒæ¥æŒ‡å¯¼å¹¶ä¼˜åŒ–æˆ‘ä»¬çš„å·¥ä½œã€‚</p>
<p>è™½ç„¶å¬èµ·æ¥éå¸¸ç®€å•ï¼Œä½†æ˜¯å½“æˆ‘ä»¬çœŸæ­£å¼€å§‹åšçš„æ—¶å€™ï¼Œæˆ‘ä»¬å‘ç°ï¼Œä¹‹å‰æˆ‘ä»¬éƒ½å¿½ç•¥äº†è¿™äº›æ•°æ®ï¼Œä¹‹å‰æˆ‘ä»¬ä¹Ÿä»æ¥æ²¡æœ‰åˆ©ç”¨è¿™äº›æ•°æ®æ¥åšæ›´å¥½çš„é‡åŒ–åˆ†æã€‚åœ¨è¡¡é‡æ•ˆèƒ½æå‡çš„é‡åŒ–åˆ†æä¸­ï¼Œæˆ‘ä»¬ä¹Ÿå‘ç°ï¼Œç¡®å®æœ‰å¾ˆå¤šå…·ä½“å·¥ä½œçš„å·¥æ—¶æ— æ³•ç²¾å‡†çš„è·å–ï¼Œä½†æ˜¯æˆ‘ä»¬é‡‡ç”¨äº†å¾ˆå¤šçš„è¿‘ä¼¼åŸåˆ™æ¥ä¼°ç®—å¯¹åº”çš„æ•ˆèƒ½ï¼Œå¹¶ä¸”æå‡ºäº†ç”¨èŠ‚çœçš„å·¥æ—¶é‡æ¥è¡¨å¾æ•ˆèƒ½æå‡çš„æ€è·¯ã€‚</p>
<p>å°±åƒ OpenAI ç”¨è®­ç»ƒé˜¶æ®µçš„äº¤å‰ç†µæ¥è¡¨å¾æ¨¡å‹æ€§èƒ½ä¸€æ ·ï¼Œè¿™å¯èƒ½ä¼šå­˜åœ¨ä¸€å®šçš„ä¸åˆç†æ€§ï¼ˆä¾‹å¦‚ï¼Œè™½ç„¶äº¤å‰ç†µä¸‹é™äº† 10%ï¼Œä½†å¹¶ä¸ç­‰ä»·äºæ¨¡å‹åœ¨ä¸‹æ¸¸ä»»åŠ¡ä¸Šçš„ <em>æ€§èƒ½</em> åªæå‡äº†ç™¾åˆ†ä¹‹åï¼Œæœ‰å¯èƒ½æ¨¡å‹åœ¨ä¸‹æ¸¸ä»»åŠ¡ä¸Šçš„æ€§èƒ½æœ‰éå¸¸å¤§å¹…åº¦çš„æå‡ï¼‰ï¼Œä½†æ˜¯è¿™ç¡®æ˜¯ä¸€ç§éå¸¸ç®€ä¾¿çš„æ–¹å¼ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬ä¹ŸçŸ¥é“ç”¨èŠ‚çœçš„å·¥æ—¶é‡æ¥è¡¨å¾æ•ˆèƒ½æå‡çš„æ–¹å¼å¹¶ä¸å‡†ç¡®ï¼Œä½†æ˜¯è¿™æ˜¯æˆ‘ä»¬èƒ½å¤Ÿæƒ³åˆ°çš„æœ€ä¾¿æ·çš„æ–¹å¼ã€‚</p>
<p>åœ¨æˆ‘ä»¬çš„æ•ˆèƒ½æå‡å·¥ä½œä¸­ï¼Œæˆ‘ä»¬æ—¶åˆ»åˆ©ç”¨é‡åŒ–åˆ†ææ¥åˆ»ç”»å¹¶æŒ‡å¯¼æˆ‘ä»¬çš„å·¥ä½œï¼Œæˆ‘ä»¬èƒ½å¤Ÿä»é‡åŒ–åˆ†æä¸­å‘ç°æˆ‘ä»¬ä¸‹ä¸€æ­¥çš„æ ¸å¿ƒå·¥ä½œå’Œé‡ç‚¹æ–¹å‘ï¼Œå¹¶ä¸”èƒ½å¤Ÿè¿‘ä¼¼çš„é¢„ä¼°å‡ºå®Œæˆè¿™äº›å·¥ä½œæˆ‘ä»¬å¯ä»¥ä¼˜åŒ–çš„æ•ˆæœã€‚</p>
<p><img src="/2024/12/01/Reflections-on-the-LLMs-Technological-Evolution/demo_2.png" alt></p>
<h3 id="é‡åŒ–çš„å¥½å¤„">é‡åŒ–çš„å¥½å¤„</h3>
<p>å·¥ä½œä¸­ï¼Œé‡åŒ–æ˜¯åŒºåˆ†äº‹å®ã€æ„Ÿå—ã€è¯„ä»·çš„æœ‰æ•ˆæ‰‹æ®µã€‚åŒæ ·çš„ä¸€ä»¶äº‹ï¼Œä¸åŒäººçš„è®¤çŸ¥ã€èƒŒæ™¯ä¸åŒï¼Œå¯¹è¿™ä»¶äº‹çš„æ„Ÿå—ä¹Ÿä¸ç›¸åŒã€è‡ªç„¶è¯„ä»·ä¹Ÿå°±ä¸åŒã€‚è€Œé‡åŒ–å¯ä»¥æŠŠä¸åŒäººçš„èƒŒæ™¯ã€è®¤çŸ¥å¯¹é½åˆ°åŒä¸€æ°´å¹³ï¼Œä»è€Œæœ‰åŠ©äºå½¢æˆæ›´ä¸ºå®¢è§‚ã€ä¸€è‡´çš„æ„Ÿå—å’Œè¯„ä»·ã€‚</p>
<p>å·¥ä½œä¸­ï¼Œç»å¸¸å¬åˆ°å¤§å®¶è¯´ï¼šè¿™ä¸ªéœ€æ±‚å¤ªå¤æ‚äº†ï¼Œè¿™ä¸ªéœ€æ±‚çš„äº¤ä»˜è´¨é‡å¤ªå·®äº†ï¼Œè¿™ä¸ªéœ€æ±‚çš„äº¤ä»˜é€Ÿåº¦å¤ªæ…¢äº†â€¦â€¦æˆ‘ä»¬æŸ¥çœ‹éœ€æ±‚çš„ BUG æ•°é‡ï¼Œå‘ç°è¿™ä¸ªéœ€æ±‚ä¹Ÿåªæœ‰ 5 ä¸ª BUG è€Œå·²ã€‚åªæ˜¯è¿‘æœŸçš„éœ€æ±‚çš„ BUG é‡éƒ½æ¯”è¾ƒå°‘ï¼ˆåªæœ‰ 2~3 ä¸ªï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šè§‰å¾—è¿™ä¸ªéœ€æ±‚çš„è´¨é‡æ¯”è¾ƒå·®ã€‚ä½†æ˜¯ï¼Œå®é™…ä¸Šï¼Œæˆ‘ä»¬æ‹‰é•¿æ—¶é—´çº¿ï¼ˆ2 ä¸ªå­£åº¦ï¼‰å¯¹éœ€æ±‚çš„è´¨é‡ï¼ˆç”¨è¡¨ç¤ºå•éœ€æ±‚ BUG é‡çš„éšæœºå˜é‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span> è¡¨ç¤ºéœ€æ±‚è´¨é‡ï¼‰è¿›è¡Œç»Ÿè®¡åˆ†æå‘ç°ï¼šç±»ä¼¼éœ€æ±‚ï¼ˆæ ·æœ¬é‡ä¸º 40ï¼‰çš„ BUG é‡çš„å‡å€¼ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¼</mi><mo>=</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">\mu = 4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">Î¼</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">4</span></span></span></span>ï¼Œæ–¹å·® <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Ïƒ</mi><mn>2</mn></msup><mo>=</mo><mn>16</mn></mrow><annotation encoding="application/x-tex">\sigma^2 = 16</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">6</span></span></span></span>ï¼Œå‡å®š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span> æœä»æ­£æ€åˆ†å¸ƒï¼Œé‚£ä¹ˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span> çš„ 95% ç½®ä¿¡åŒºé—´ä¸ºï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¼</mi><mo>Â±</mo><mn>1.96</mn><mfrac><mi>Ïƒ</mi><msqrt><mi>n</mi></msqrt></mfrac><mo>=</mo><mn>4</mn><mo>Â±</mo><mn>1.96</mn><mfrac><mn>8</mn><msqrt><mn>40</mn></msqrt></mfrac><mo>=</mo><mo stretchy="false">(</mo><mn>2.8</mn><mo separator="true">,</mo><mn>5.2</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mu \pm 1.96\frac{\sigma}{\sqrt{n}} = 4 \pm 1.96 \frac{8}{\sqrt{40}} = (2.8, 5.2)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">Î¼</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Â±</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.03756em;vertical-align:-0.9300000000000002em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">9</span><span class="mord">6</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10756em;"><span style="top:-2.30972em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8002800000000001em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathdefault">n</span></span></span><span style="top:-2.76028em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.23972em;"><span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">Ïƒ</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.9300000000000002em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Â±</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.25144em;vertical-align:-0.93em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">9</span><span class="mord">6</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.2027799999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.90722em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">4</span><span class="mord">0</span></span></span><span style="top:-2.86722em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.13278em;"><span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">8</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.93em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mord">.</span><span class="mord">8</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">5</span><span class="mord">.</span><span class="mord">2</span><span class="mclose">)</span></span></span></span></span></p>
<p>æ‰€ä»¥ï¼Œå•éœ€æ±‚ 5 ä¸ª BUGæ˜¯ä¸€ä¸ªæ­£å¸¸çš„èŒƒå›´ï¼Œä¸èƒ½è¯´æ˜è¿™ä¸ªéœ€æ±‚çš„è´¨é‡å·®ï¼Œæ²¡æœ‰å¿…è¦é‡‡å–ç‰¹æ®Šçš„ä¼˜åŒ–æ–¹æ¡ˆã€‚å¦‚æœæ²¡æœ‰å¿…è¦çš„é‡åŒ–åˆ†æï¼Œæˆ‘ä»¬å°±å®¹æ˜“é™·å…¥ä¸ªäººæ„Ÿå—çš„æ³¥æ½­ï¼Œå¹¶åšå‡ºå¹¶ä¸æ­£ç¡®çš„åˆ¤æ–­å’Œå·¥ä½œæ–¹å‘ã€‚</p>
<ul>
<li>ç±»ä¼¼éœ€æ±‚çš„ BUG é‡çš„å‡å€¼çš„ 95% ç½®ä¿¡åŒºé—´ä¼°è®¡ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>2.8</mn><mo separator="true">,</mo><mn>5.2</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(2.8, 5.2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mord">.</span><span class="mord">8</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">5</span><span class="mord">.</span><span class="mord">2</span><span class="mclose">)</span></span></span></span> è¿™æ˜¯å…·ä½“çš„æ¨æ–­é‡åŒ–æ•°æ®ã€æ˜¯å®¢è§‚äº‹å®ã€‚</li>
<li>è¿™ä¸ªéœ€æ±‚çš„äº¤ä»˜è´¨é‡å¤ªå·®äº†ï¼Œè¿™æ˜¯ä¸€ç§ä¸ªäººæ„Ÿå—ã€‚</li>
<li>æˆ‘ä»¬éœ€è¦é‡‡å–å¿…è¦çš„æ‰‹æ®µæ”¾ç½®éœ€æ±‚è´¨é‡æŒç»­æ¶åŒ–ï¼Œè¿™æ˜¯ä¸€ç§åŸºäºä¸ªäººæ„Ÿå—çš„è¯„ä»·ç»“æœã€‚</li>
</ul>
<p>å°¤å…¶æ˜¯å¯¹äºä¼˜åŒ–å·¥ä½œï¼Œé‡åŒ–åˆ†æéƒ½æ˜¯ä¸€åˆ‡å·¥ä½œçš„èµ·ç‚¹ï¼Œæ˜¯æˆ‘ä»¬å¯åŠ¨ä»»ä½•ä¼˜åŒ–å·¥ä½œçš„å‰æï¼Œèƒ½å¤Ÿä¿éšœæˆ‘ä»¬å§‹ç»ˆåœ¨æ­£ç¡®çš„æ–¹å‘ä¸Šå‰è¿›ã€‚</p>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition note"><p class="admonition-title">é‡åŒ–æ˜¯å·¥ä½œçš„èµ·ç‚¹
</p><p>ç”¨ä»€ä¹ˆæŒ‡æ ‡æ¥åˆ»ç”»éœ€æ±‚çš„å¤æ‚æ€§ï¼Ÿç”¨ä»€ä¹ˆæŒ‡æ ‡æ¥åˆ»ç”»éœ€æ±‚çš„äº¤ä»˜é€Ÿåº¦ï¼Ÿè¿™äº›æŒ‡æ ‡è¿‡å»ä¸€æ®µæ—¶é—´çš„ç»Ÿè®¡æ•°æ®æ˜¯æ€æ ·çš„ï¼Ÿæˆ‘ä»¬åŸºäºè¿™äº›æ•°æ®çš„æ¨æ–­åˆæ˜¯ä»€ä¹ˆï¼Ÿé’ˆå¯¹è¿™äº›æ¨æ–­æˆ‘ä»¬éœ€è¦é‡‡å–ä»€ä¹ˆåŠ¨ä½œï¼Ÿâ€¦â€¦</p>
</div>
<h2 id="ä¼˜åŒ–çš„æ€è·¯">ä¼˜åŒ–çš„æ€è·¯</h2>
<h3 id="å¤§æ¨¡å‹çš„æ¨ç†ä¼˜åŒ–">å¤§æ¨¡å‹çš„æ¨ç†ä¼˜åŒ–</h3>
<p>å¤§æ¨¡å‹çš„æ¨ç†ä¼˜åŒ–æŠ€æœ¯æœ‰å¦‚ä¸‹çš„æ€è·¯ï¼š</p>
<ul>
<li>åœ¨æ¨ç†è®¾å¤‡ä¸Šä» CPU è¿ç§»åˆ° GPUï¼Œä»è€Œå¯ä»¥ GPU é«˜å¹¶è¡Œçš„ç‰¹å¾æ¥è§£å†³æ¨ç†è¿‡ç¨‹ä¸­çš„å¤§é‡çš„çŸ©é˜µè¿ç®—ï¼Œæå‡æ¨ç†çš„é€Ÿåº¦ã€‚</li>
<li>ä¸æ–­ç»†åŒ–çš„å¹¶è¡ŒåŒ–å¤„ç†ï¼Œä»æ¨ç†é˜¶æ®µçš„ <code>Prefill é˜¶æ®µ</code>ã€<code>Decode é˜¶æ®µ</code> åˆ†ç¦»ï¼Œåˆ°è¯·æ±‚çº§åˆ«çš„ <code>Batching</code> æ‰¹å¤„ç†åˆ°è¯·æ±‚çº§åˆ«çš„ <code>Micro-Batching</code> æ‰¹å¤„ç†ï¼Œç„¶åå†åˆ° Token çº§åˆ«çš„ <code>Piggybacking</code> æ‰¹å¤„ç†ï¼Œä»è€Œå¯ä»¥æœ€å¤§ç¨‹åº¦çš„å‡å°‘æ¨ç†è¿‡ç¨‹çš„æ— æ•ˆç­‰å¾…ï¼Œæå‡æ¨ç†çš„é€Ÿåº¦å’Œ GPU çš„ååã€‚<sup class="footnote-ref"><a href="#fn5" id="fnref5">[5]</a></sup></li>
<li>KV ç¼“å­˜ã€Prompt Caching æŠ€æœ¯ï¼Œé¿å…æ¨ç†è¿‡ç¨‹ä¸­çš„é‡å¤è®¡ç®—ï¼Œä»è€Œæå‡æ¨ç†çš„é€Ÿåº¦ã€‚</li>
<li>é‡åŒ–æŠ€æœ¯ï¼Œç”¨ <code>INT8</code> æ¥æ›¿æ¢ <code>FLOAT16</code>ã€<code>FLOAT32</code> çš„æµ®ç‚¹è®¡ç®—ï¼Œé™ä½æ¨ç†è¿‡ç¨‹çš„è®¡ç®—å¤æ‚åº¦ï¼Œåœ¨ä¿éšœæ¨ç†æ•ˆæœçš„æƒ…å†µä¸‹æå‡æ¨ç†çš„é€Ÿåº¦ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨ Netflex å¼€å‘çš„è§†é¢‘ç”»è´¨è¯„ä¼°å·¥å…· <a href="https://github.com/Netflix/vmaf">VMAF</a> ä¸­çœ‹åˆ°åŒæ ·çš„ä¼˜åŒ–æŠ€æœ¯ã€‚</li>
<li>â€¦â€¦</li>
</ul>
<p>æ‰€ä»¥æˆ‘ä»¬çœ‹åˆ°ï¼Œæ¨ç†ä¼˜åŒ–çš„æ€è·¯å¤§è‡´ä¸Šå¯ä»¥åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼š</p>
<ul>
<li>å»æ‰ä¸å¿…è¦çš„ç­‰å¾…</li>
<li>å‡å°‘é‡å¤çš„è®¡ç®—</li>
<li>ä¼˜åŒ–è®¡ç®—çš„ç®—æ³•</li>
</ul>
<p><img src="/2024/12/01/Reflections-on-the-LLMs-Technological-Evolution/2.png" alt="æ¨ç†ä¼˜åŒ–çš„æŠ€æœ¯çº¿æ¡"></p>
<h3 id="æ•ˆèƒ½å·¥ä½œçš„ä¼˜åŒ–">æ•ˆèƒ½å·¥ä½œçš„ä¼˜åŒ–</h3>
<p>å›é¡¾ä»Šå¹´çš„æ•ˆèƒ½å·¥ä½œï¼Œæˆ‘æ‰å‘ç°æ•´ä½“çš„ä¼˜åŒ–æ€è·¯å’Œå¤§æ¨¡å‹çš„æ¨ç†ä¼˜åŒ–æ€è·¯åŸºæœ¬ä¸€è‡´ï¼šæˆ‘ä»¬æ²¡æœ‰åƒä¹‹å‰é‚£æ ·ä»…ä»æ•ˆèƒ½çš„ç»´åº¦æ¥æ€è€ƒé—®é¢˜ï¼Œè€Œæ˜¯åœ¨ä¿éšœè´¨é‡è¿™ä¸ªçº¦æŸæ¡ä»¶ä¸‹ï¼Œä»ç­‰å¾…ã€é‡å¤ã€ä¼˜åŒ–è¿™ä¸‰ä¸ªæ­£äº¤çš„ç»´åº¦å¼€å±•æ•ˆèƒ½æå‡å·¥ä½œï¼Œè¿›è€Œè¾¾åˆ°æå‡äº¤ä»˜æ•ˆèƒ½çš„ç›®æ ‡ã€‚</p>
<p>è¦å®ç°è¿™ç§åŒ…å«çº¦æŸæ¡ä»¶çš„ä¼˜åŒ–ï¼Œéœ€è¦æˆ‘ä»¬é¦–å…ˆä»ç«¯åˆ°ç«¯çš„å…¨å±€å·¥ä½œè¿›è¡Œåˆ†æï¼Œç„¶åå¯¹æ¯ä¸ªé˜¶æ®µçš„å·¥ä½œæ•ˆèƒ½è¿›è¡Œé‡åŒ–ï¼Œå†å¯¹ä¸åŒé˜¶æ®µçš„çš„å·¥ä½œè¿›è¡Œåˆ†æï¼Œä»è€Œè¯†åˆ«å‡ºï¼š</p>
<ul>
<li>å“ªäº›å·¥ä½œå­˜åœ¨ç€éå¿…é¡»çš„ç­‰å¾…ï¼Œä¾‹å¦‚æµ‹è¯•ç¯å¢ƒçš„ç­‰å¾…ï¼Œä¸åŒå›¢é˜Ÿåˆå¹¶ä»£ç ä¹‹é—´çš„ç­‰å¾…ï¼Œâ€¦â€¦</li>
<li>å“ªäº›å·¥ä½œå­˜åœ¨çš„å¤§é‡çš„é‡å¤ï¼Œä¾‹å¦‚å¤šè½®è¿­ä»£æµ‹è¯•ä¸­çš„é‡å¤æµ‹è¯•</li>
<li>å“ªäº›å·¥ä½œçš„æ–¹å¼éœ€è¦è¿›ä¸€æ­¥ä¼˜åŒ–ï¼Œä¾‹å¦‚æ‰‹å·¥æµ‹è¯•æ˜¯å¦å¯ä»¥è½¬å˜ä¸ºè‡ªåŠ¨åŒ–æµ‹è¯•ï¼Ÿ</li>
</ul>
<p>è¿›è€Œæ ¹æ®è¯†åˆ«å‡ºçš„ä¸åŒé˜¶æ®µçš„é—®é¢˜ï¼Œé‡‡å–æœ‰é’ˆå¯¹æ€§çš„æ–¹æ¡ˆè¿›è¡Œä¼˜åŒ–ï¼Œä»è€Œæå‡æ•´ä½“çš„äº¤ä»˜æ•ˆèƒ½ã€‚åœ¨æ•´ä¸ªä¼˜åŒ–è¿‡ç¨‹ä¸­ï¼Œå› ä¸ºæœ‰è´¨é‡è¿™ä¸ªä¼˜åŒ–çš„çº¦æŸæ¡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åšåˆ°åœ¨æˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„èŒƒå›´å†…åšåˆ°æ•ˆèƒ½æå‡çš„æœ€å¤§åŒ–ï¼Œåšåˆ°äº†å¿«ï¼Œä½†åˆä¸æ˜¯æ— æé™çš„å¿«ã€‚</p>
<p>åˆ˜æ¶¦å…ˆç”Ÿåœ¨ 2024 å¹´åº¦æ¼”è®²ã€Šè¿›åŒ–çš„åŠ›é‡ã€‹ä¸­æåˆ°äº† <strong>è¶Šæ±‡ä¹Œé¸¡å·</strong> çš„ä¾‹å­<sup class="footnote-ref"><a href="#fn6" id="fnref6">[6]</a></sup>ï¼š</p>
<blockquote>
<p>æˆ‘ä»¬çš„å·¥å‚ï¼Œæ¯å¤©ä¼šåœ¨ä¸é”ˆé’¢å°é¢ä¸Šï¼ŒåŠ å·¥é¸¡è‚‰ã€‚ç„¶åï¼Œæ¸…ç†å°é¢ï¼Œå†åŠ å·¥é¸¡æ¶ã€‚</p>
<p>æ¸…ç†å°é¢çš„è¿‡ç¨‹ï¼Œè¦èŠ± 4 åˆ†é’Ÿã€‚ä¸€ä½å‘˜å·¥æå‡ºæ¥ï¼Œè¦ä¸å’±ä»¬ç”¨æ¡Œå«å§ï¼Ÿå°±åƒåƒé¥­æ—¶é“ºä¸ªé¤å«ï¼Œåƒå®Œç›´æ¥æ¢æ–°çš„ã€‚è¿™æ ·ï¼Œæ¸…ç†å°é¢çš„æ—¶é—´ï¼Œå°±ä» 4 åˆ†é’Ÿç¼©çŸ­åˆ°äº† 1 åˆ†é’Ÿã€‚</p>
<p>ä»¥å‰æˆ‘ä»¬ç”¨ â€œé•Šå­â€ å»é™¤é¸¡æ¶çš„å†…è„ï¼Œè¦èŠ± 14 åˆ° 20 ç§’ã€‚æ‰€ä»¥è¿™æ´»ï¼Œéœ€è¦ 5 ä¸ªäººå¹²ã€‚</p>
<p>ä¸€ä½å‘˜å·¥æå‡ºæ¥ï¼Œè¦ä¸æˆ‘ä»¬è¯•è¯• â€œå¼¯å¤´æ°´æœå‰â€ å‘¢ï¼Ÿç»“æœï¼Œç”¨å‰å­ä¸€è¯•ï¼Œæ—¶é—´å‡ ä¹å‡åŠï¼ä»æ­¤ï¼Œ5 ä¸ªäººçš„æ´»ï¼Œç°åœ¨ 3 ä¸ªäººå°±èƒ½æå®šã€‚</p>
</blockquote>
<p>è¿™å°±æ˜¯ï¼šå‡å°‘æµªè´¹ï¼Œé™ä½é‡å¤ã€‚è¿™å°±æ˜¯åœ¨ä¿éšœè´¨é‡çš„å‰æä¸‹ï¼Œæå‡æ•ˆç‡ã€‚ä½æˆæœ¬çš„æ ¸å¿ƒï¼Œä¸æ˜¯é™ä½å“è´¨ï¼Œè€Œæ˜¯å‡å°‘æµªè´¹ã€‚</p>
<h3 id="æ§åˆ¶çš„é‡è¦æ€§">æ§åˆ¶çš„é‡è¦æ€§</h3>
<p>åœ¨ <a href="/2021/12/04/Should-the-new-business-production-development-focus-on-internal-quality/">æ–°ä¸šåŠ¡çš„å¼€å‘å°±ä¸éœ€è¦é‡è§†å†…éƒ¨è´¨é‡å—ï¼Ÿ</a> è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘æåˆ°ï¼š</p>
<blockquote>
<p>æ ¹æ® Martin Fowler çš„ <em>è½¯ä»¶ç´¯è®¡åŠŸèƒ½</em> æ¨¡å‹ï¼Œå¦‚æœä¸é‡è§† <em>å†…éƒ¨è´¨é‡</em>ï¼Œæ•°å‘¨ä¹‹åï¼Œç³Ÿç³•çš„ <em>å†…éƒ¨è´¨é‡</em> å°±ä¼šä¸¥é‡å½±å“è½¯ä»¶çš„äº¤ä»˜æ•ˆç‡ã€‚å› æ­¤ï¼Œåªæœ‰åœ¨ä¸€å¼€å§‹å°±é‡è§†è½¯ä»¶çš„ <em>å†…éƒ¨è´¨é‡</em>ï¼Œæ‰èƒ½çœŸæ­£æœ‰æ•ˆçš„æå‡æ–°ä¸šåŠ¡çš„ä»·å€¼æ¢ç´¢æ•ˆç‡ã€‚</p>
</blockquote>
<p>åœ¨äº¤ä»˜è¿‡ç¨‹ä¸­ï¼Œä¸€å‘³åœ°æ±‚å¿«ï¼Œä¸€å‘³åœ°è¿½æ±‚è¶…å‡ºè‡ªå·±æ§åˆ¶èŒƒå›´çš„å¿«ï¼Œæœ€ç»ˆåªä¼šè®©æ•ˆç‡å˜å¾—æ›´ç³Ÿç³•ã€‚</p>
<p>æ¸…ä»£çš„æ–‡å­¦å®¶å‘¨å®¹å†™è¿‡ä¸€ç¯‡æ•£æ–‡ ã€Šå°æ¸¯æ¸¡è€…ã€‹ï¼Œè¿™ç¯‡æ‚è®°æ•£æ–‡ï¼Œé€šè¿‡çŸ­çŸ­ä¸åˆ°äºŒç™¾ä¸ªå­—ï¼Œé€šè¿‡è‡ªå·±æœªå¬ <em>æ¸¡è€…</em> ç¼“è¡Œçš„å»ºè®®ï¼Œå¸Œæœ›é€šè¿‡ <em>æ€¥è¡Œ</em> è€Œè¾¾åˆ°åœ¨åŸé—¨å…³é—­ä¹‹å‰å…¥åŸçš„ç›®æ ‡ï¼Œæœ€ç»ˆå› ä¸º <em>æ€¥è¡Œ</em> è€Œæ²¡æœ‰å…¥åŸçš„æ•…äº‹ï¼Œæ¥è¯´æ˜äº† <strong>æ¬²é€Ÿåˆ™ä¸è¾¾</strong> çš„é“ç†ã€‚</p>
<blockquote>
<p>åºšå¯…å†¬ï¼Œäºˆè‡ªå°æ¸¯æ¬²å…¥è›Ÿå·åŸï¼Œå‘½å°å¥šä»¥æœ¨ç®€æŸä¹¦ä»ã€‚æ—¶è¥¿æ—¥æ²‰å±±ï¼Œæ™šçƒŸè¦æ ‘ï¼Œæœ›åŸäºŒé‡Œè®¸ã€‚<br>
å› é—®æ¸¡è€…ï¼šâ€œå°šå¯å¾—å—é—¨å¼€å¦ï¼Ÿâ€ æ¸¡è€…ç†Ÿè§†å°å¥šï¼Œåº”æ›°ï¼šâ€œå¾è¡Œä¹‹ï¼Œå°šå¼€ä¹Ÿï¼› é€Ÿè¿›ï¼Œåˆ™é˜–ã€‚â€<br>
äºˆæ„ ä¸ºæˆã€‚è¶‹è¡ŒåŠåŠï¼Œå°å¥šä»†ï¼ŒæŸæ–­ä¹¦å´©ï¼Œå•¼ï¼Œæœªå³èµ·ã€‚ç†ä¹¦å°±æŸï¼Œè€Œå‰é—¨å·²ç‰¡ä¸‹çŸ£ã€‚<br>
äºˆçˆ½ç„¶æ€æ¸¡è€…è¨€è¿‘é“ã€‚å¤©ä¸‹ä¹‹ä»¥èºæ€¥è‡ªè´¥ï¼Œç©·æš®è€Œæ— æ‰€å½’å®¿è€…ï¼Œå…¶çŠ¹æ˜¯ä¹Ÿå¤«ï¼Œå…¶çŠ¹æ˜¯ä¹Ÿå¤«ï¼</p>
</blockquote>
<h2 id="æŠ€æœ¯çš„ä¿¡ä»°">æŠ€æœ¯çš„ä¿¡ä»°</h2>
<p>å¦‚æœæˆ‘ä»¬å›é¡¾ä¸€ä¸‹ GPT çš„å‘å±•å†ç¨‹ï¼Œæˆ‘ä»¬å°±ä¼šå‘ç° OpenAI çš„å¯¹å¤§æ¨¡å‹çš„æŠ€æœ¯ä¿¡ä»°ã€‚å½“æŠ€æœ¯è·¯çº¿å‡ºç°å²”è·¯å£æ—¶ï¼ŒæŠ€æœ¯ä¿¡ä»°èƒ½å¤Ÿç¡®ä¿å›¢é˜Ÿä¸ä¼šåœ¨æŠ€æœ¯è·¯çº¿ä¸Šæ‘‡æ‘†ä¸å®šå¹¶å§‹ç»ˆå‘ç€è‡ªå·±è®¤å®šçš„æ–¹å‘å‰è¿›ã€‚</p>
<p>åœ¨æŠ€æœ¯ä¿¡ä»°çš„åŠ æŒä¸‹ï¼Œå›¢é˜Ÿä¼šåšå®šè‡ªå·±çš„æŠ€æœ¯è·¯çº¿ï¼Œå¹¶ä¸åœåœ°ç”¨å®è·µçš„æ–¹å¼å»éªŒè¯è‡ªå·±çš„æŠ€æœ¯ä¿¡ä»°ï¼Œå¹¶åœ¨ä¸æ–­çš„éªŒè¯ä¸­ä¿®æ­£è‡ªå·±çš„æŠ€æœ¯æ–¹å‘ã€‚</p>
<p><img src="/2024/12/01/Reflections-on-the-LLMs-Technological-Evolution/llm_his.png" alt></p>
<ul>
<li>2018 å¹´ 6 æœˆï¼ŒOpenAI å‘å¸ƒäº†åŸºäº Transformer æ¶æ„çš„è‡ªå›å½’æ¨¡å‹ GPT-1ï¼Œå¼€å¯äº†ä»–ä»¬çš„ AGI ä¹‹æ—…ã€‚</li>
<li>4 ä¸ªæœˆåï¼Œ2018 å¹´ 10 æœˆï¼Œè°·æ­Œå°±å‘å¸ƒäº†åŸºäº Transformer æ¶æ„çš„è‡ªç¼–ç æ¨¡å‹ BERTã€‚ä¸ GPT-1 ç›¸æ¯”ï¼ŒBERT åœ¨å¾ˆå¤šä¸‹æ¸¸ä»»åŠ¡ä¸Šè¡¨ç°å‡ºæ›´å¼ºåŠ²çš„æ€§èƒ½ï¼Œå¹¶ä¸”ä¹Ÿåˆ·æ–°äº†å¤šä¸ªæ¦œå•çš„è®°å½•ã€‚åœ¨å¾ˆé•¿ä¸€æ®µæ—¶é—´é‡Œï¼ŒBERTï¼ˆåŠå…¶å˜ä½“ï¼‰ä¸€ç›´å¤„äºå„ç±»æ¦œå•çš„é¦–ä½ï¼Œæ˜¯äººä»¬è°ˆè®ºçš„ç„¦ç‚¹ã€‚</li>
</ul>
<p>åœ¨è¿™ä¸ªæ—¶å€™ï¼Œå¦‚æœæˆ‘ä»¬æ˜¯ OpenAI å›¢é˜Ÿï¼Œæˆ‘ä»¬å°†å¦‚ä½•åˆ¤æ–­æŠ€æœ¯çš„æ–¹å‘ï¼Ÿåœ¨æœ‰æ›´å¼ºå¤§çš„æ¶æ„ä¸ºå‰æå¾—æƒ…å†µä¸‹ï¼Œæ˜¯å¦è¿˜è¦ç»§ç»­åšæŒè‡ªå·±è‡ªå›å½’çš„æ¶æ„ï¼Ÿ</p>
<p>ç½®èº«äºå†å²ä¹‹ä¸­ï¼Œåœ¨ BERT å‘å¸ƒä¹‹åï¼Œå¦‚æœæˆ‘ä»¬ä¹Ÿè¦è¿›å…¥åˆ°å¤§æ¨¡å‹çš„é¢†åŸŸï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨æŠ€æœ¯é€‰å‹ä¸Šå°†ä½œå‡ºä½•ç§æŠ‰æ‹©ï¼Ÿ</p>
<p>å¹¸è¿çš„æ˜¯ï¼ŒOpenAI å›¢é˜Ÿå¹¶æ²¡æœ‰å› ä¸º BERT çš„å‘å¸ƒè€Œæ‘‡æ‘†ï¼Œè¿™ç§æŠ€æœ¯çš„åšå®šï¼Œæ‰æœ‰äº† 4 å¹´ä¹‹åçš„ 2022 å¹´çš„ ChatGPT çš„å‘å¸ƒï¼Œä¹Ÿæ‰æœ‰äº†ä¹‹åçš„å¤§æ¨¡å‹çš„ç«çˆ†ã€‚</p>
<p>åœ¨ç ”ç©¶å¤§æ¨¡å‹çš„ä»£ç èƒ½åŠ›æ—¶ï¼Œå¯¹ AGI çš„æŠ€æœ¯ä¿¡ä»°æ¨åŠ¨ OpenAI å‘ç°äº† SWE æ•°æ®é›†å­˜åœ¨çš„é—®é¢˜ï¼Œå¹¶æ¨åŠ¨ä»–ä»¬äº SWE çš„ä½œè€…ä¸€èµ·åˆä½œæå‡ºäº†æ›´å¥½çš„æ•°æ®é›†â€”â€”<a href="https://openai.com/index/introducing-swe-bench-verified/">SWE-bench Verified</a>ï¼Œä»¥æ›´å¥½çš„è¯„ä¼°å¤§æ¨¡å‹çš„èƒ½åŠ›ã€‚</p>
<p>é’ˆå¯¹ <a href="https://openai.com/index/introducing-swe-bench-verified/">SWE-bench Verified</a> æˆ‘ä»¬ä¼šè¯´ï¼Œè¿™ä¸å°±æ˜¯ä¸ªæ•°æ®é›†å—ï¼Œè¿™æœ‰ä»€ä¹ˆæŠ€æœ¯å«é‡ã€è¿™æœ‰ä»€ä¹ˆéš¾åº¦å‘¢ï¼Ÿæˆ‘ä»¬è¦æ˜¯åšæˆ‘ä»¬ä¹Ÿå¯ä»¥åšå‡ºæ¥ã€‚ä½†æ˜¯å°±åƒä¹‹å‰è¯´çš„ <code>Scaling Laws</code> ä¸€æ ·ï¼Œè™½ç„¶ç®€å•ï¼Œä½†æ˜¯åœ¨ OpenAI ä¹‹å‰ï¼Œç¡®å®ä¹Ÿæ²¡æœ‰å›¢é˜ŸçœŸæ­£ç³»ç»ŸåŒ–çš„æå‡ºæ¥ã€‚</p>
<p>æŠ€æœ¯å‘å±•æ—¥æ–°æœˆå¼‚ï¼ŒæŠ€æœ¯ä¿¡ä»°èƒ½å¤Ÿè®©å›¢é˜Ÿé¿å…ç›²ç›®è·Ÿéšçƒ­ç‚¹ï¼Œç¡®ä¿å›¢é˜Ÿèƒ½å¤Ÿæ²¿ç€æ—¢å®šçš„æŠ€æœ¯è„‰ç»œå‘å±•ã€‚å›¢é˜Ÿä¸ä½†èƒ½å¤Ÿé™ä½æŠ€æœ¯è·¯çº¿åå¤å˜æ›´æ‰€å¸¦æ¥çš„æˆæœ¬ï¼Œä¹Ÿèƒ½ä¿è¯è‡ªèº«åœ¨æ—¥æ–°æœˆå¼‚çš„æŠ€æœ¯æµªæ½®ä¸­å…·å¤‡è¶³å¤Ÿçš„è‡ªä¸»æ€§å’Œè¯è¯­æƒã€‚</p>
<p>å¦‚ OpenAI æ‰€å®è·µçš„é‚£æ ·ï¼ŒæŠ€æœ¯ä¿¡ä»°å¯ä»¥è®©å›¢é˜Ÿæ–‡åŒ–æ›´åŠ å†…æ•›ä¸åšéŸ§ã€‚ç ”å‘äººå‘˜ä¸å†æ˜¯å•çº¯çš„â€œä»»åŠ¡æ‰§è¡Œè€…â€ï¼Œè€Œæ˜¯å¯¹æ‰€ç ”äº§å“ä¸æŠ€æœ¯å……æ»¡çƒ­å¿±çš„æ¢ç´¢è€…ã€‚å›¢é˜Ÿæˆå‘˜ä¼šç›¸ä¿¡ï¼Œè‡ªå·±çš„æ¯ä¸€æ¬¡å®éªŒã€æ¯ä¸€æ¬¡æ•°æ®é›†ä¼˜åŒ–ã€æ¯ä¸€æ®µä»£ç æ”¹è¿›ï¼Œéƒ½å°†åœ¨é€šå¾€æ›´é«˜å±‚æ¬¡æ™ºèƒ½çš„è·¯é€”ä¸­å‘æŒ¥ä½œç”¨ã€‚åœ¨è¿™ç§å……æ»¡ä¿¡ä»°çš„æ°›å›´ä¸­ï¼Œå¤±è´¥ä¸å†æ˜¯é˜»ç¢å‰è¡Œçš„å£å’ï¼Œè€Œæˆä¸ºéªŒè¯æ€è·¯ã€æ¿€å‘åˆ›æ„çš„åŠ©åŠ›ã€‚åœ¨è¿™ç§é•¿æœŸæŠ•å…¥ä¸åšæŒä¸‹ï¼ŒæŠ€æœ¯ä¿¡ä»°æœ€ç»ˆè½¬åŒ–ä¸ºç»„ç»‡çš„æ ¸å¿ƒç«äº‰åŠ›ï¼Œä½¿å›¢é˜Ÿåœ¨æ—¥ç›Šæ¿€çƒˆçš„å¤§æ¨¡å‹ç«èµ›ä¸­å±¹ç«‹ä¸å€’ã€‚</p>
<h2 id="å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</h2>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p><a href="https://arxiv.org/abs/1712.00409">Deep Learning Scaling is Predictable, Empirically</a> <a href="#fnref1" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn2" class="footnote-item"><p><a href="https://mp.weixin.qq.com/s/mBgXZZLpg-7bcQqlrXu8EA">Scaling Law ç™¾åº¦æœ€æ—©æå‡ºï¼Ÿï¼OpenAI/Claude éƒ½å—å®ƒå¯å‘ï¼ŒIlya å‡ºç°åœ¨è‡´è°¢åå•ä¸­</a> <a href="#fnref2" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn3" class="footnote-item"><p><a href="https://en.wikipedia.org/wiki/GPT-2">GPT-2</a> <a href="#fnref3" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn4" class="footnote-item"><p><a href="https://arxiv.org/abs/2001.08361">Scaling Laws for Neural Language Models</a> <a href="#fnref4" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn5" class="footnote-item"><p><a href="https://arxiv.org/abs/2308.16369">SARATHI: Efficient LLM Inference by Piggybacking Decodes with Chunked Prefills</a> <a href="#fnref5" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn6" class="footnote-item"><p><a href="https://mp.weixin.qq.com/s?__biz=MjM5NjA3MzYxNA==&amp;mid=2652200096&amp;idx=1&amp;sn=988d7f5ddaae6460be20498c3d3d9323&amp;chksm=bc40431d308a044b00410fec5557557a6ec92154f712913b6cbeb6e9bf5095703d65a18b4e19&amp;scene=27">è¿›åŒ–çš„åŠ›é‡ï¼šåˆ˜æ¶¦ 2024 å¹´åº¦æ¼”è®²</a> <a href="#fnref6" class="footnote-backref">â†©ï¸</a></p>
</li>
</ol>
</section>
]]></content>
      <categories>
        <category>æ€»ç»“</category>
      </categories>
      <tags>
        <tag>å®è·µ</tag>
        <tag>æ€è€ƒ</tag>
      </tags>
  </entry>
  <entry>
    <title>Prompt Cache ç©¶ç«Ÿæ˜¯ä»€ä¹ˆï¼Ÿ</title>
    <url>/2024/11/23/insight-of-the-prompt-cache/</url>
    <content><![CDATA[<p><img src="/2024/11/23/insight-of-the-prompt-cache/context_caching.png" alt></p>
<p>åœ¨ä»‹ç»äº† <a href="/2024/10/16/What-exactly-is-attention/">Transformer</a> æ¨¡å‹ã€<a href="/2024/10/31/From-Transformer-To-GPT/">GPT</a> æ¨¡å‹ã€<a href="/2024/11/16/The-LLMs-Runtime-Inference-and-KV-Cache/">å¤§æ¨¡å‹çš„è¿è¡Œæ—¶æ¨ç†å’Œ KV Cache</a> åï¼Œæˆ‘ä»¬ç»ˆäºè¶Šæ¥è¶Šæ¥è¿‘äºæœ€åŸå§‹çš„ç›®æ ‡ï¼šOpenAI 2024 å¹´ 10 æœˆ 1 æ—¥å‘å¸ƒçš„ <a href="https://openai.com/index/api-prompt-caching/">Prompt Caching in the API</a>ã€‚è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬å°±æ¥ä»‹ç»ä¸€ä¸‹ <code>Prompt Cache</code> ç›¸å…³æŠ€æœ¯çš„å‘å±•å¹¶å¯¹ OpenAI çš„ <code>Prompt Caching</code> æŠ€æœ¯æ–¹æ¡ˆè¿›è¡Œç®€å•çš„åˆ†æã€‚</p>
<span id="more"></span>
<h2 id="kv-cache">KV Cache</h2>
<p>æ ¹æ® <a href="/2024/11/16/The-LLMs-Runtime-Inference-and-KV-Cache/">å¤§æ¨¡å‹çš„è¿è¡Œæ—¶æ¨ç†å’Œ KV Cache</a> ä¸­çš„ä»‹ç»ï¼Œå¦‚æœè¾“å…¥ prompt çš„é•¿åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> ä¸ª tokensâ€”â€”<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>s</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>s</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">s_1, s_2,...,s_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œå¤§æ¨¡å‹ä¼šæ ¹æ®è¿™ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> ä¸ª tokens ç”Ÿæˆäº†åç»­çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span> ä¸ª tokensâ€”â€”<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>s</mi><mrow><mi>n</mi><mo>+</mo><mn>2</mn></mrow></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>s</mi><mrow><mi>n</mi><mo>+</mo><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">s_{n+1}, s_{n+2}, ...,s_{n+k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.638891em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span>ã€‚</p>
<p>å¦‚æœæ²¡æœ‰ <code>KV ç¼“å­˜</code>ï¼Œåˆ™æ¯ç”Ÿæˆä¸€ä¸ªæ–°çš„ token <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mrow><mi>n</mi><mo>+</mo><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">s_{n+k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.638891em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œéƒ½éœ€è¦é‡æ–°è®¡ç®— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>s</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>s</mi><mrow><mi>n</mi><mo>+</mo><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">s_1,s_2,...,s_{n+k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.638891em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span> ä¹‹é—´çš„æ³¨æ„åŠ›ã€‚</p>
<p>ä½†æ˜¯ï¼Œåœ¨ <code>KV ç¼“å­˜</code> æœºåˆ¶ä¸‹ï¼Œ<code>prefill é˜¶æ®µ</code> ä¼šè®¡ç®—è¾“å…¥åºåˆ—ä¸­çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> ä¸ª tokens ä¹‹é—´çš„æ³¨æ„åŠ› <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mn>0</mn></msub><mo>=</mo><mo stretchy="false">{</mo><mo stretchy="false">(</mo><msub><mi>k</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>v</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mtext>Â </mtext><mi mathvariant="normal">âˆ£</mi><mtext>Â </mtext><mi>i</mi><mo>â‰¤</mo><mi>n</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">S_0=\{(k_i, v_i)\ |\ i \le n\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace">Â </span><span class="mord">âˆ£</span><span class="mspace">Â </span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">n</span><span class="mclose">}</span></span></span></span>ï¼Œå¹¶å°† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>k</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>v</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(k_i, v_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> ç¼“å­˜åœ¨ <code>KV ç¼“å­˜</code> ä¸­ã€‚å¯¹äºåç»­ç”Ÿæˆçš„æ¯ä¸€ä¸ª token <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mrow><mi>n</mi><mo>+</mo><mi>j</mi></mrow></msub><mo stretchy="false">(</mo><mi>j</mi><mo>â‰¤</mo><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">s_{n+j}(j\le k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span>ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ <code>KV ç¼“å­˜</code> ä¸­çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>j</mi></msub><mo>=</mo><mo stretchy="false">{</mo><mo stretchy="false">(</mo><msub><mi>k</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>v</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mtext>Â </mtext><mi mathvariant="normal">âˆ£</mi><mtext>Â </mtext><mi>i</mi><mo>&lt;</mo><mi>n</mi><mo>+</mo><mi>j</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">S_j=\{(k_i, v_i)\ | \ i \lt n + j \}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace">Â </span><span class="mord">âˆ£</span><span class="mspace">Â </span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">}</span></span></span></span> æ¥è®¡ç®—æ–° token <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mrow><mi>n</mi><mo>+</mo><mi>j</mi></mrow></msub><mo stretchy="false">(</mo><mi>j</mi><mo>â‰¤</mo><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">s_{n+j}(j\le k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span> çš„è‡ªæ³¨æ„åŠ›ã€‚</p>
<p>ä»¤æ¨¡å‹çš„ç»´åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">d_{model}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold">W</mi><mi>Q</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{W}^Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">Q</span></span></span></span></span></span></span></span></span></span></span>ã€<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold">W</mi><mi>K</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{W}^K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07153em;">K</span></span></span></span></span></span></span></span></span></span></span>ã€<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold">W</mi><mi>V</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{W}^V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">V</span></span></span></span></span></span></span></span></span></span></span> çš„ç»´åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>h</mi><mi>e</mi><mi>a</mi><mi>d</mi></mrow></msub></mrow><annotation encoding="application/x-tex">d_{head}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">d</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œåˆ™åˆ©ç”¨ <code>KV ç¼“å­˜</code> å¯ä»¥å°†è®¡ç®—æ³¨æ„åŠ›çš„æµ®ç‚¹æ•°è®¡ç®—é‡ä» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>6</mn><mi>n</mi><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub><msub><mi>d</mi><mrow><mi>h</mi><mi>e</mi><mi>a</mi><mi>d</mi></mrow></msub><mo>+</mo><mn>4</mn><msup><mi>n</mi><mn>2</mn></msup><msub><mi>d</mi><mrow><mi>h</mi><mi>e</mi><mi>a</mi><mi>d</mi></mrow></msub></mrow><annotation encoding="application/x-tex">6nd_{model}d_{head} + 4n^2d_{head}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord">6</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">d</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.964108em;vertical-align:-0.15em;"></span><span class="mord">4</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">d</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> é™ä½åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>6</mn><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub><msub><mi>d</mi><mrow><mi>h</mi><mi>e</mi><mi>a</mi><mi>d</mi></mrow></msub><mo>+</mo><mn>4</mn><mi>n</mi><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">6d_{model}d_{head} + 4nd_{model}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord">6</span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">d</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord">4</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup>ï¼Œæ•´ä½“çš„è®¡ç®—é‡é™ä½äº† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>100</mn><mo stretchy="false">(</mo><mn>1</mn><mo>âˆ’</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mo stretchy="false">)</mo><mi mathvariant="normal">%</mi></mrow><annotation encoding="application/x-tex">100(1 - \frac{1}{n})\%</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mord">%</span></span></span></span>ã€‚</p>
<h2 id="prompt-cache">Prompt Cache</h2>
<p><code>KV ç¼“å­˜</code> å¯ä»¥æ˜¾è‘—é™ä½ä¸€ä¸ªè¯·æ±‚ä¸­çš„æ³¨æ„åŠ›çš„é‡å¤è®¡ç®—ã€‚ä½†æ˜¯ï¼Œå®é™…åº”ç”¨ä¸­ï¼Œä¸åŒçš„è¯·æ±‚ä¹Ÿç»å¸¸ä¼šæœ‰å¾ˆå¤šé‡å¤çš„å†…å®¹ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>
<p>æ ¹æ® Prompt æ¨¡ç‰ˆæ´¾ç”Ÿçš„ Prompt åœ¨è¯·æ±‚ LLM æ—¶é€šå¸¸åŒ…å«ï¼šç³»ç»Ÿæç¤ºã€è§’è‰²æŒ‡å®šã€æŒ‡ä»¤æè¿°ã€æ ·ä¾‹è¯´æ˜ã€è‡ªå®šä¹‰çš„åŠ¨æ€å†…å®¹â€¦â€¦</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>SystemÂ PromptÂ </mtext><mi mathvariant="normal">âˆ£</mi><mtext>Â RoleÂ SettingÂ </mtext><mi mathvariant="normal">âˆ£</mi><mtext>Â InstructionÂ DescriptionÂ </mtext><mi mathvariant="normal">âˆ£</mi><mtext>Â FewÂ ShotÂ </mtext><mi mathvariant="normal">âˆ£</mi><mtext>Â UserÂ Query......</mtext></mrow><annotation encoding="application/x-tex">\text{System Prompt} \ | \ \text{Role Setting} \ | \ \text{Instruction Description} \ | \ \text{Few Shot} \ | \ \text{User Query......}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">SystemÂ Prompt</span></span><span class="mspace">Â </span><span class="mord">âˆ£</span><span class="mspace">Â </span><span class="mord text"><span class="mord">RoleÂ Setting</span></span><span class="mspace">Â </span><span class="mord">âˆ£</span><span class="mspace">Â </span><span class="mord text"><span class="mord">InstructionÂ Description</span></span><span class="mspace">Â </span><span class="mord">âˆ£</span><span class="mspace">Â </span><span class="mord text"><span class="mord">FewÂ Shot</span></span><span class="mspace">Â </span><span class="mord">âˆ£</span><span class="mspace">Â </span><span class="mord text"><span class="mord">UserÂ Query......</span></span></span></span></span></span></p>
<p>è¿™å…¶ä¸­ï¼Œç³»ç»Ÿæç¤ºè¯ã€è§’è‰²è®¾å®šã€æŒ‡ä»¤æè¿°ã€å…·ä½“ä¾‹å­ç­‰éƒ½æ˜¯é€šç”¨çš„æ¨¡ç‰ˆå†…å®¹ï¼ŒåŒä¸€ç±»å‹çš„ä»»åŠ¡ä»…åœ¨æœ€åçš„ç”¨æˆ·è‡ªå®šä¹‰éƒ¨åˆ†ä¸åŒã€‚</p>
</li>
<li>
<p>Chat Robot ä¹‹é—´çš„å¤šè½®å¯¹è¯ï¼Œéšç€å¯¹è¯è½®æ¬¡çš„ä¸æ–­å¢åŠ ï¼Œæ–°çš„å¯¹è¯å†…å®¹ä¼šä½œä¸ºå¯¹è¯å†å²ä¸æ–­çš„å¢åŠ åˆ° Prompt ä¸­å¹¶é‡æ–°å‘é€ç»™å¤§ LLMï¼Œå½“å¯¹è¯å†å²è¾ƒå¤šçš„æ—¶å€™ï¼Œå°±ä¼šå¯¼è‡´å’Œå¤§æ¨¡å‹çš„æ¯æ¬¡å¯¹è¯éƒ½ä¼šæºå¸¦å¤§é‡çš„é‡å¤å†…å®¹ã€‚</p>
</li>
<li>
<p>ä½¿ç”¨æ‰¹å¤„ç†æ–¹å¼è°ƒç”¨ LLM è§£å†³ç‰¹å®šçš„ä»»åŠ¡ï¼Œæ¯”å¦‚ä»¥ä½¿ç”¨å¤§æ¨¡å‹è¿›è¡Œå›¾ç‰‡åˆ†æï¼Œæ­¤æ—¶è¾“å…¥çš„ Prompt çš„å‰é¢éƒ¨åˆ†å†…å®¹éƒ½æ˜¯ä¸€è‡´çš„ï¼Œåªæ˜¯æœ€åè¦åˆ†æçš„å›¾ç‰‡å†…å®¹ä¸ä¸€è‡´ã€‚</p>
</li>
</ul>
<p>å¦‚å‰æ‰€è¿°ï¼Œ<code>KV ç¼“å­˜</code> å¯ä»¥è§£å†³å•ä¸ªè¯·æ±‚å†…çš„è‡ªå›å½’è¿‡ç¨‹ä¸­çš„æ³¨æ„åŠ›æœºåˆ¶çš„é‡å¤è®¡ç®—é—®é¢˜ï¼Œæå‡ LLM çš„æ€§èƒ½ï¼Œä½†æ˜¯æ— æ³•è§£å†³å¦‚ä¸Šåœºæ™¯ä¸­å­˜åœ¨çš„è·¨è¯·æ±‚é—´çš„æ³¨æ„åŠ›æœºåˆ¶çš„é‡å¤è®¡ç®—é—®é¢˜ã€‚<code>Prompt Cache</code> å°±æ˜¯è§£å†³è·¨è¯·æ±‚é—´çš„æ³¨æ„åŠ›æœºåˆ¶é‡å¤è®¡ç®—çš„é—®é¢˜ï¼Œä»è€Œæå‡åç»­è¯·æ±‚çš„æ€§èƒ½ï¼Œå°¤å…¶æ˜¯æå‡ <code>prefill é˜¶æ®µ</code> çš„æ€§èƒ½ï¼ˆé™ä½ TTFTï¼‰ã€‚</p>
<ul>
<li>2024 å¹´ 5 æœˆ 14 æ—¥ï¼Œè°·æ­Œä¸º Gemini æ¨¡å‹å®£å¸ƒäº†ä¸€ç³»åˆ—çš„æ–°ç‰¹æ€§ï¼Œå…¶ä¸­å°±åŒ…æ‹¬å¯ä»¥é™ä½è´¹ç”¨çš„ <code>Context Caching</code>ã€‚<sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup></li>
<li>2024 å¹´ 7 æœˆ 1 æ—¥ï¼Œæœˆä¹‹æš—é¢å®£å¸ƒå¯åŠ¨ <code>Context Cache</code> çš„å…¬æµ‹ï¼Œå¯¹äºè¯·æ±‚é¢‘ç¹ã€é‡å¤å¼•ç”¨å¤§é‡åˆå§‹ä¸Šä¸‹æ–‡çš„åœºæ™¯ï¼Œå¯ä»¥é™ä½ 83% çš„ TTFT åŒæ—¶è´¹ç”¨æœ€é«˜é™ä½ 90%ã€‚<sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup></li>
<li>2024 å¹´ 8 æœˆ 2 æ—¥ï¼ŒDeepSeek åœ¨ API æ¨¡å‹ä¸Šæ”¯æŒäº†ç¡¬ç›˜ <code>Prompt Cache</code>ï¼ŒæŠŠæœ¬æ¥å°±ç™½èœä»·çš„ API ä»·æ ¼åˆé™ä½äº†ä¸€ä¸ªæ•°é‡çº§<sup class="footnote-ref"><a href="#fn4" id="fnref4">[4]</a></sup>ï¼Œåœ¨å‘½ä¸­ç¼“å­˜çš„æƒ…å†µä¸‹ï¼Œæ¯ç™¾ä¸‡è¾“å…¥ tokens ä»… 0.014$ï¼Œå‡ ä¹è¦ç­‰åŒäºå…è´¹äº†ã€‚</li>
<li>2024 å¹´ 8 æœˆ 15 æ—¥ï¼ŒClaude ä¹Ÿå®£å¸ƒåœ¨ Claude 3.5 Sonnetã€Claude 3 Opusã€Claude 3 Haiku æ¨¡å‹ä¸Šæ”¯æŒ <code>Prompt Cache</code>ã€‚å¯¹äºè¾ƒé•¿çš„ promptsï¼Œä½¿ç”¨ <code>Prompt Cache</code> å¯ä»¥æŠŠè´¹ç”¨æœ€é«˜é™ä½ 90%ã€è¯·æ±‚å»¶è¿Ÿæœ€é«˜é™ä½ 85%ã€‚<sup class="footnote-ref"><a href="#fn5" id="fnref5">[5]</a></sup></li>
<li>2024 å¹´ 10 æœˆ 1 æ—¥ï¼ŒOpenAI ä¹Ÿå®£å¸ƒåœ¨å…¶æœ€æ–°çš„æ¨¡å‹ç‰ˆæœ¬ GPT-4oã€GPT-4o miniã€o1-previewã€o1-mini ä¸Šæ”¯æŒ <code>Prompt Cache</code>ï¼Œä½¿ç”¨ <code>Prompt Cache</code> æŠ€æœ¯ï¼Œå¯ä»¥ä¸ºå¼€å‘è€…æä¾›æ›´å¿«çš„è¯·æ±‚å“åº”é€Ÿåº¦å’Œä½è‡³ 50% çš„è´¹ç”¨ã€‚<sup class="footnote-ref"><a href="#fn6" id="fnref6">[6]</a></sup></li>
</ul>
<h2 id="prompt-cache-æŠ€æœ¯æ–¹æ¡ˆ">Prompt Cache æŠ€æœ¯æ–¹æ¡ˆ</h2>
<p><code>Prompt Cache</code> å¹¶ä¸æ˜¯ä¸€ç§ä¼ ç»Ÿçš„ç¼“å­˜æŠ€æœ¯ï¼Œä¼ ç»Ÿçš„ç¼“å­˜æŠ€æœ¯é€šå¸¸ç”¨äºä¸´æ—¶å­˜å‚¨æ•°æ®ä»¥ä¾¿äºå†æ¬¡è¯·æ±‚ç›¸åŒçš„æ•°æ®æ—¶å¯ä»¥åŠ é€Ÿæ•°æ®çš„è®¿é—®é€Ÿåº¦ã€‚ä¼ ç»Ÿçš„ç¼“å­˜æŠ€æœ¯é€šå¸¸ç”¨äºå¤„ç†é™æ€å†…å®¹è¾“å‡ºï¼Œä¾‹å¦‚ç½‘é¡µå†…å®¹ï¼Œjsã€cssã€image ç­‰é™æ€å†…å®¹ï¼Œæ•°æ®åº“æŸ¥è¯¢ç»“æœâ€¦â€¦</p>
<p>åœ¨ä¼ ç»Ÿçš„ç¼“å­˜æŠ€æœ¯ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>key-value</code> çš„ç»“æ„æ¥ç»„ç»‡å¹¶è®¿é—®ç¼“å­˜å†…å®¹ï¼Œä¾‹å¦‚æˆ‘ä»¬å¯ä»¥æŠŠæŸä¸ª <code>url</code> ä½œä¸º <code>key</code>ã€å¹¶å°†å…¶å¯¹åº”çš„ç½‘é¡µå†…å®¹ä½œä¸º <code>value</code> ç¼“å­˜èµ·æ¥ï¼Œä»¥ä¾¿æœ‰å…¶ä»–ç”¨æˆ·å†æ¬¡è¯·æ±‚è¯¥ <code>url</code> æ—¶å¯ä»¥ç›´æ¥ä»ç¼“å­˜ä¸­æå–åˆ°è¯¥ç½‘é¡µçš„å†…å®¹ï¼Œä»è€ŒåŠ é€Ÿç½‘é¡µçš„è®¿é—®é€Ÿåº¦ã€‚</p>
<p>åœ¨å®é™…ä¸­ï¼Œç¡®å®å­˜åœ¨ä¸åŒç”¨æˆ·è¯·æ±‚çš„å†…å®¹å¤§è‡´ç›¸ä¼¼ï¼Œå› æ­¤å¯ä»¥åˆ©ç”¨ <code>key-value</code> çš„ä¼ ç»Ÿç¼“å­˜æŠ€æœ¯æ¥è§£å†³ä¸€éƒ¨åˆ†åœºæ™¯çš„è®¿é—®é€Ÿåº¦é—®é¢˜ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>Query 1ï¼šå¤©ç©ºä¸ºä»€ä¹ˆæ˜¯è“è‰²çš„ï¼Ÿ</li>
<li>Query 2ï¼šä¸ºä»€ä¹ˆå¤©ç©ºæ˜¯è“è‰²çš„ï¼Ÿ</li>
<li>Query 3ï¼šå¤©ç©ºä¸ºä»€ä¹ˆæ˜¯è“çš„ï¼Ÿ</li>
<li>â€¦â€¦</li>
</ul>
<p>ä½†æ˜¯ï¼Œå¯¹äº LLM è€Œè¨€ï¼Œåœ¨å¤§éƒ¨åˆ†åœºæ™¯ä¸‹ï¼ŒLLM æ ¹æ®å›ºå®šçš„ä¸Šä¸‹æ–‡å†…å®¹å’Œå¯å˜çš„ç”¨æˆ·è¾“å…¥å†…å®¹åŠ¨æ€ç”Ÿæˆè¾“å‡ºã€‚å› æ­¤ï¼Œåœ¨å¤§éƒ¨åˆ†åœºæ™¯ä¸‹ï¼Œä¼ ç»Ÿçš„ <code>key-value</code> ç¼“å­˜æŠ€æœ¯å¹¶ä¸é€‚ç”¨äºå¤§æ¨¡å‹é¢†åŸŸã€‚</p>
<p>æ ¹æ®å¦‚ä¸Šçš„è¿™ä¸¤ç§åœºæ™¯ï¼Œ<code>Prompt Cache</code> æŠ€æœ¯ä¹ŸåŸºæœ¬ä¸Šåˆ’åˆ†ä¸ºä¸¤ç§ï¼š</p>
<ul>
<li>è¾“å…¥æ•´ä½“ä¸€è‡´æ—¶ï¼Œåˆ©ç”¨ <code>key-value</code> çš„ä¼ ç»Ÿç¼“å­˜æŠ€æœ¯å¯¹ç›¸ä¼¼è¯·æ±‚çš„è¾“å‡ºå†…å®¹è¿›è¡Œç¼“å­˜ï¼Œä¾‹å¦‚  GPTCache: Semantic Cache for LLMs<sup class="footnote-ref"><a href="#fn7" id="fnref7">[7]</a></sup>ã€‚</li>
<li>è¾“å…¥å‰ç¼€ä¸€è‡´æ—¶ï¼Œåˆ©ç”¨ <code>KV ç¼“å­˜</code> æŠ€æœ¯é¿å…æ³¨æ„åŠ›é‡å¤è®¡ç®—å¸¦æ¥çš„è®¡ç®—å¼€é”€ï¼Œä»è€Œæå‡å¤§æ¨¡å‹å“åº”é€Ÿåº¦ï¼Œä¾‹å¦‚è€¶é²å¤§å­¦å’Œè°·æ­Œç ”å‘çš„ Prompt Cache: Modular Attention Reuse æŠ€æœ¯<sup class="footnote-ref"><a href="#fn1" id="fnref1:1">[1:1]</a></sup>ã€‚</li>
</ul>
<h3 id="gptcache-semantic-cache-for-llms">GPTCache: Semantic Cache for LLMs</h3>
<p>GPTCache: Semantic Cache for LLMs <sup class="footnote-ref"><a href="#fn7" id="fnref7:1">[7:1]</a></sup> æ˜¯ä¸€ç§å…¸å‹çš„ä¼ ç»Ÿç¼“å­˜æŠ€æœ¯ï¼ŒGPTCache çš„æœ¬è´¨æ˜¯æŠŠ <code>Query-Response</code> ç¼“å­˜åˆ° Redis ä¸­ï¼Œå½“æœ‰è¯­ä¹‰ä¸Šç›¸ä¼¼çš„ <code>Query</code> æ—¶ï¼Œç›´æ¥ä» Redis ä¸­è¿”å›ç¼“å­˜çš„ç»“æœè€Œä¸éœ€è¦ LLM å†é‡å¤è®¡ç®—å¹¶ç”Ÿæˆç»“æœï¼Œä»è€Œé™ä½å¤§æ¨¡å‹çš„æ¨ç†æˆæœ¬å¹¶æå‡å“åº”æ€§èƒ½ã€‚ä½†æ˜¯è¿™ç§æ–¹å¼åªé€‚ç”¨äºè¯­ä¹‰ä¸Šéå¸¸ç›¸ä¼¼çš„è¯·æ±‚ï¼Œå¯¹äºå¦‚ä¸‹çš„è¯·æ±‚åˆ™ä¸é€‚ç”¨ï¼š</p>
<ul>
<li>Query 1ï¼šå¤©ç©ºä¸ºä»€ä¹ˆæ˜¯è“è‰²çš„ï¼Ÿ</li>
<li>Query 2ï¼šå¤©ç©ºä¸ºä»€ä¹ˆæ˜¯è“è‰²çš„ï¼Œè¯·ç»™å‡ºè¯¦ç»†çš„ç‰©ç†å­¦ä¸Šçš„è§£é‡Šï¼Ÿ</li>
</ul>
<p>GPTCache çš„æ¶æ„å¦‚ä¸‹æ‰€ç¤º<sup class="footnote-ref"><a href="#fn8" id="fnref8">[8]</a></sup>ï¼š</p>
<p><img src="/2024/11/23/insight-of-the-prompt-cache/17325377216331.jpg" alt></p>
<h3 id="prompt-cache-modular-attention-reuse">Prompt Cache: Modular Attention Reuse</h3>
<p>è€¶é²å¤§å­¦å’Œè°·æ­Œè”åˆå‘å¸ƒçš„ Prompt Cache: Modular Attention Reuse <sup class="footnote-ref"><a href="#fn1" id="fnref1:2">[1:2]</a></sup> åœ¨æœ¬è´¨ä¸Šæ—¶åŸºäº <code>KV ç¼“å­˜</code> çš„ <code>Prompt Cache</code> æŠ€æœ¯ï¼Œå°†è¯·æ±‚å†…çš„ <code>KV ç¼“å­˜</code> æŠ€æœ¯æ‰©å±•åˆ°äº†è¯·æ±‚é—´ï¼Œä»è€Œå¯ä»¥éå¸¸å¥½çš„è§£å†³å¦‚ä¸‹çš„åœºæ™¯ï¼š</p>
<ul>
<li>Query 1ï¼šå¤©ç©ºä¸ºä»€ä¹ˆæ˜¯è“è‰²çš„ï¼Ÿ</li>
<li>Query 2ï¼šå¤©ç©ºä¸ºä»€ä¹ˆæ˜¯è“è‰²çš„ï¼Œè¯·ç»™å‡ºè¯¦ç»†çš„ç‰©ç†å­¦ä¸Šçš„è§£é‡Šï¼Ÿ</li>
</ul>
<blockquote>
<p>æœ¬èŠ‚ä¸­æåˆ°çš„ <code>Prompt Cache</code> å‡æŒ‡ä»£è®ºæ–‡ <em>Prompt Cache: Modular Attention Reuse</em> ä¸­çš„ <code>Prompt Cache</code>ã€‚</p>
</blockquote>
<p><code>Prompt Cache</code> çš„åŸºæœ¬æ€æƒ³æ˜¯ï¼šåœ¨æ¨ç†é˜¶æ®µï¼Œä»¥æ–‡æœ¬ç‰‡æ®µï¼ˆtext segmentï¼‰ä¸ºå•ä½ï¼ŒæŠŠé¢‘ç¹å‡ºç°çš„æ–‡æœ¬æ®µå¯¹åº”çš„æ³¨æ„åŠ›çŠ¶æ€ï¼ˆç»“æœï¼‰å­˜å‚¨ä¸‹æ¥ï¼›åœ¨ä¹‹åè¯·æ±‚çš„æ¨ç†æ—¶ï¼Œå¦‚æœé‡åˆ°ç›¸åŒçš„æ–‡æœ¬æ®µï¼Œå°±ç›´æ¥ä½¿ç”¨ç¼“å­˜çš„æ³¨æ„åŠ›çŠ¶æ€ï¼ˆç»“æœï¼‰ã€‚</p>
<p>ä¸ºäº†å®ç°è¿™ä¸ªç›®æ ‡ï¼Œæœ‰ä¸¤ä¸ªæŒ‘æˆ˜éœ€è¦è§£å†³ï¼š</p>
<ul>
<li>Transformers æ¶æ„ä¸­å­˜åœ¨ä½ç½®ç¼–ç ï¼Œå› æ­¤ tokens ä¹‹é—´çš„è‡ªæ³¨æ„åŠ›çŠ¶æ€ï¼ˆç»“æœï¼‰ä¸ä½ç½®æœ‰å…³ã€‚æ‰€ä»¥ï¼Œåªæœ‰å½“ç›¸åŒçš„æ–‡æœ¬æ®µå‡ºç°åœ¨ç›¸åŒä½ç½®æ—¶ï¼Œæ‰èƒ½å¤ç”¨è¯¥æ–‡æœ¬æ®µçš„è‡ªæ³¨æ„åŠ›çŠ¶æ€ï¼ˆç»“æœï¼‰ã€‚</li>
<li>å¿…é¡»å…·å¤‡æœ‰æ•ˆè¯†åˆ«å·²ç»ç¼“å­˜äº†è‡ªæ³¨æ„åŠ›çŠ¶æ€ï¼ˆç»“æœï¼‰çš„æ–‡æœ¬æ®µçš„èƒ½åŠ›ï¼Œè¿™æ ·ç³»ç»Ÿæ‰èƒ½å¤Ÿä½¿ç”¨è¿™äº›æ–‡æœ¬æ®µç¼“å­˜çš„è‡ªæ³¨æ„åŠ›çŠ¶æ€ï¼ˆç»“æœï¼‰ã€‚</li>
</ul>
<p>ä¸ºäº†è§£å†³å¦‚ä¸Šçš„ä¸¤ä¸ªéš¾é¢˜ï¼Œ<code>Prompt Cache</code> é‡‡å–äº†å¦‚ä¸‹çš„æŠ€æœ¯æ–¹æ¡ˆå’Œæ¢ç´¢ï¼š</p>
<ul>
<li>è®ºæ–‡ä¸­æåˆ°ï¼Œä½œè€…é€šè¿‡å®éªŒè¯æ˜ï¼šè™½ç„¶è‡ªæ³¨æ„åŠ›æœºåˆ¶å’Œä½ç½®ç¼–ç æœ‰å…³ï¼Œä½†æ˜¯åªè¦ä¿æŒè¾“å…¥ tokens ä¹‹é—´çš„ç›¸å¯¹ä½ç½®ä¸å˜ï¼Œé‚£ä¹ˆå¤§è¯­è¨€æ¨¡å‹çš„è¾“å‡ºè´¨é‡å°±ä¸ä¼šå—åˆ°å½±å“ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥æå–è¾“å…¥ prompts çš„ä¸åŒç‰‡æ®µçš„æ³¨æ„åŠ›çŠ¶æ€ï¼ˆç»“æœï¼‰ï¼Œå¹¶å°†å®ƒä»¬æ‹¼æ¥åœ¨ä¸€èµ·ï¼Œä»è€Œæ„å»ºæ–°çš„è¯­ä¹‰ã€‚</li>
<li>æå‡ºäº†ä¸€ç§æç¤ºè¯æ ‡è®°è¯­è¨€ (<em>PMLï¼šPrompt Markup Language</em>) ä»¥æ˜ç¡® prompt çš„ç»“æ„ã€‚PML  å°†å¯é‡ç”¨çš„æ–‡æœ¬æ®µè¡¨ç¤ºä¸ºæ¨¡å—ï¼Œä»è€Œè§£å†³äº†æœ‰æ•ˆè¯†åˆ«å¯å¤ç”¨çš„æ–‡æœ¬æ®µçš„é—®é¢˜ã€‚</li>
</ul>
<p>ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æœ‰ä¸€æ¡å¦‚ä¸‹çš„ promptï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">PROMPT &#x3D; &quot;&quot;&quot;</span><br><span class="line">SystemPrompt</span><br><span class="line">Context</span><br><span class="line">Examples</span><br><span class="line"></span><br><span class="line">Query: q?</span><br><span class="line">Answer: </span><br><span class="line">&quot;&quot;&quot;</span><br></pre></td></tr></table></figure>
<p>æ ¹æ®è®ºæ–‡ä¸­çš„ PML çš„å®šä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥æ„å»ºå¦‚ä¸‹çš„ prompt schemaï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;prompt schema&#x3D;&quot;TaskPrompt&quot;&gt;</span><br><span class="line">  &lt;SystemPrompt&#x2F;&gt;</span><br><span class="line">  &lt;Context&#x2F;&gt;</span><br><span class="line">  &lt;Examples&#x2F;&gt;</span><br><span class="line">  Query: q? Answer: </span><br><span class="line">&lt;&#x2F;prompt&gt;</span><br></pre></td></tr></table></figure>
<p>åœ¨æ¨ç†æ—¶ï¼Œ<code>Prompt Cache</code> çš„å¤„ç†æµç¨‹å¦‚ä¸‹ï¼š</p>
<ul>
<li>æ£€ç´¢ç¼“å­˜çš„æ³¨æ„åŠ›çŠ¶æ€ï¼ˆç»“æœï¼‰ï¼šä»ç¼“å­˜ä¸­è·å– SystemPrompt, Context, Examples çš„æ³¨æ„åŠ›çŠ¶æ€ï¼ˆç»“æœï¼‰ã€‚</li>
<li>å¤„ç†æ–°æ–‡æœ¬ï¼šç”¨æˆ·è¾“å…¥çš„æ–‡æœ¬éƒ½æœªç¼“å­˜ï¼Œéœ€è¦é‡æ–°è®¡ç®—æ³¨æ„åŠ›çŠ¶æ€ï¼ˆç»“æœï¼‰ï¼Œä¾‹å¦‚ä¸Šä¾‹ä¸­çš„ <code>Query: q? Answer: </code> å°±æ˜¯æœªç¼“å­˜çš„éƒ¨åˆ†ã€‚</li>
<li>åˆå¹¶æ³¨æ„åŠ›çŠ¶æ€ï¼ˆç»“æœï¼‰ï¼šæŒ‰é¡ºåºæ‹¼æ¥ SystemPrompt + Context + Examples + UserPrompt çš„æ³¨æ„åŠ›çŠ¶æ€ï¼ˆç»“æœï¼‰ã€‚</li>
<li>ç”Ÿæˆå“åº”ï¼šä½¿ç”¨åˆå¹¶åçš„æ³¨æ„åŠ›çŠ¶æ€ï¼ˆç»“æœï¼‰æ¥ç”Ÿæˆ LLM çš„å“åº”ã€‚</li>
</ul>
<p>æ›´è¯¦ç»†çš„ä¾‹å­å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="/2024/11/23/insight-of-the-prompt-cache/17325398113275.jpg" alt></p>
<h2 id="openai-api-ä¸­çš„-prompt-caching">OpenAI API ä¸­çš„ Prompt Caching</h2>
<p>å¯¹äº OpenAI API ä¸­æä¾›çš„ <code>Prompt Caching</code> æŠ€æœ¯å¤§æ¦‚ç‡ä¹Ÿæ˜¯åŸºäº <code>KV ç¼“å­˜</code> æŠ€æœ¯æ¥é¿å…è·¨è¯·æ±‚é—´çš„æ³¨æ„åŠ›é‡å¤è®¡ç®—æ¥æå‡ <code>prefill é˜¶æ®µ</code> çš„æ€§èƒ½å¹¶å®ç°è´¹ç”¨é™ä½çš„ç›®çš„ã€‚OpenAI çš„ <code>Prompt Caching</code> è¦æ±‚å¿…é¡»æœ‰ç²¾å‡†åŒ¹é…çš„å‰ç¼€ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æ¨æµ‹ï¼ŒOpenAI å¯èƒ½å¹¶æ²¡æœ‰ä½¿ç”¨è€¶é²å¤§å­¦çš„ <code>Prompt Cache</code> æŠ€æœ¯ï¼Œè€Œæ˜¯é‡‡ç”¨äº†ä¸€ç§æ›´ä¸ºç®€ä¾¿çš„æ–¹æ¡ˆã€‚</p>
<p>æ ¹æ® OpenAI å®˜ç½‘çš„ä»‹ç»ï¼ŒOpenAI ä¼šè‡ªåŠ¨ä¸º GPT-4oã€GPT-4o-miniã€o1-previewã€o1-mini æ¨¡å‹ä»¥åŠè¿™äº›æ¨¡å‹çš„å¾®è°ƒç‰ˆæœ¬å¼€å¯ <code>Prompt Caching</code> åŠŸèƒ½ã€‚å½“é€šè¿‡ API è°ƒç”¨å¯¹åº”çš„æ¨¡å‹ï¼Œå¹¶ä¸”è¾“å…¥ prompts çš„é•¿åº¦å¤§äº 1024 æ—¶ï¼ŒOpenAI ä¼šè‡ªåŠ¨ä¸ºè¿™äº›è¯·æ±‚å¼€å¯ <code>Prompt Caching</code> åŠŸèƒ½ï¼Œä»¥æå‡æ¨¡å‹çš„å“åº”é€Ÿåº¦ã€‚</p>
<p>ä¹‹æ‰€ä»¥é‡‡ç”¨ 1024 ä¸ª tokens çš„é˜ˆå€¼ï¼Œå¯èƒ½æ˜¯ä¸€ä¸ªæƒè¡¡çš„ç»“æœï¼Œæ¯•ç«Ÿ <code>Prompt Caching</code> åœ¨æœ¬è´¨ä¸Šæ—¶ä¸€ç§ <strong>é€šè¿‡ç©ºé—´æ¢æ—¶é—´</strong> çš„æŠ€æœ¯ï¼Œè™½ç„¶å¯ä»¥æå‡è¯·æ±‚çš„å“åº”é€Ÿåº¦ï¼Œä½†æ˜¯ä¹Ÿä¼šå¯¼è‡´ GPU å†…å­˜çš„è¿‡æ¸¡æ¶ˆè€—ï¼Œä»è€Œå½±å“åˆ°å•ä¸ª GPU çš„ååã€‚å› æ­¤ï¼Œå½“è¯·æ±‚ä¸­çš„ prompts é•¿åº¦æ¯”è¾ƒå°æ—¶ï¼Œ<code>Prompt Caching</code> çš„ ROI å°±æ¯”è¾ƒä½äº†ã€‚</p>
<p>SARATHI æå‡ºçš„ <code>chunked-prefills</code> æŠ€æœ¯å¯ä»¥å…è®¸æˆ‘ä»¬å°†ä¸€ä¸ª <code>prefill é˜¶æ®µ</code> çš„è¯·æ±‚æ‹†åˆ†ä¸ºå¤§å°ç›¸ç­‰çš„å—ï¼ŒåŒæ—¶åˆ©ç”¨æŠŠä¸€ä¸ª <code>prefill-chunk</code> å’Œå¤šä¸ª <code>decode</code> æ„å»ºæˆä¸€ä¸ªæ‰¹å¤„ç†è¯·æ±‚çš„è¿™ç§æ­ä¾¿è½¦ï¼ˆ<em>piggyback</em>ï¼‰çš„æŠ€æœ¯æ¥å®ç°è§£ç æœ€å¤§åŒ–æ‰¹å¤„ç†ï¼ˆdecode-maximal batchingï¼‰ï¼Œè¿›è€Œé¿å…äº†æ¨¡å‹åœ¨æµæ°´çº¿å¹¶è¡Œä¸­å­˜åœ¨çš„æµæ°´çº¿ç­‰å¾…é—®é¢˜ï¼Œä»è€Œæé«˜å¤§æ¨¡å‹çš„æ¨ç†æ€§èƒ½ã€‚<sup class="footnote-ref"><a href="#fn9" id="fnref9">[9]</a></sup></p>
<p><img src="/2024/11/23/insight-of-the-prompt-cache/17325284975396.jpg" alt></p>
<p>OpenAI å¤§æ¦‚ç‡ä¹Ÿé‡‡ç”¨äº†ç±»ä¼¼ SARATHI ä¸­çš„ <code>chunked-prefills</code> æŠ€æœ¯ï¼Œå› æ­¤å¯ä»¥å®ç°ç¼“å­˜ä¸åŒè¯·æ±‚é—´çš„æœ€é•¿å‰ç¼€æ¥è¾¾åˆ°åŠ é€Ÿè®¡ç®—çš„æ•ˆæœã€‚OpenAI åœ¨å¯¹è¾“å…¥ prompts è¿›è¡Œåˆ†å—æ—¶ï¼Œé‡‡ç”¨çš„åˆ†å—å¤§å°ä¸º 128 tokensï¼Œä»¥å®ç°æœ€å¤§ç¨‹åº¦çš„å¯æ§æ€§ã€‚</p>
<p>æ ¹æ® OpenAI çš„ä»‹ç»<sup class="footnote-ref"><a href="#fn6" id="fnref6:1">[6:1]</a></sup>ï¼Œå½“ç”¨æˆ·è¾“å…¥ prompts çš„é•¿åº¦è¶…è¿‡ 1024 ä¸ª tokens æ—¶ï¼š</p>
<ul>
<li>API é¦–å…ˆä¼šè®¡ç®—è¯¥è¯·æ±‚çš„æœ€é•¿å‰ç¼€ï¼Œå¹¶å°†è¯¥æœ€é•¿å‰ç¼€çš„ç»“æœç¼“å­˜èµ·æ¥ï¼ˆ<code>KV ç¼“å­˜</code>ï¼‰ï¼Œè¯¥æœ€é•¿å‰ç¼€çš„é•¿åº¦ä» 1024 å¼€å§‹ï¼Œå¹¶ä¸”ä»¥ 128 çš„å¤§å°é€æ­¥é€’å¢ã€‚</li>
<li>å½“è¯¥ç”¨æˆ·çš„ä¸‹ä¸€ä¸ªè¯·æ±‚åŒ…å«è¯¥æœ€é•¿å‰ç¼€æ—¶ï¼ŒAPI åˆ™å¯ä»¥ç›´æ¥å¤ç”¨æœ€é•¿å‰ç¼€çš„æ³¨æ„åŠ›ç»“æœã€å¹¶ä¸”ä¾èµ–ç¼“å­˜ç»“æœä»…è®¡ç®—æœ€é•¿å‰ç¼€ä¹‹åçš„ tokens çš„æ³¨æ„åŠ›ç»“æœå®ç°è¯·æ±‚çš„åŠ é€Ÿã€‚</li>
</ul>
<p>åŸºäº Transformer æ¶æ„çš„å¤§æ¨¡å‹åˆ©ç”¨ <strong>å› æœè®¡ç®—</strong>ï¼ˆ<em>causal computation</em>ï¼‰æ¥è®¡ç®—è‡ªæ³¨æ„åŠ›ï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨ <code>Prompt Caching</code> æ—¶å¿…é¡»ä¿è¯è¯·æ±‚é—´å­˜åœ¨ä¸€è‡´çš„å‰ç¼€ã€‚å› æ­¤ï¼ŒOpenAI çš„å®˜æ–¹æ–‡æ¡£ä¸­è¯´ï¼šåªæœ‰å½“è¯·æ±‚é—´å­˜åœ¨å®Œå…¨ä¸€è‡´çš„å‰ç¼€æ—¶ï¼Œæ‰ä¼šå‘½ä¸­ <code>Prompt Caching</code><sup class="footnote-ref"><a href="#fn10" id="fnref10">[10]</a></sup>ã€‚</p>
<blockquote>
<p>Cache hits are only possible for exact prefix matches within a prompt.</p>
<p>To realize caching benefits, place static content like instructions and examples at the beginning of your prompt, and put variable content, such as user-specific information, at the end.<br>
<img src="/2024/11/23/insight-of-the-prompt-cache/17325296211790.jpg" alt></p>
</blockquote>
<p>æ ¹æ® OpenAI çš„å®˜æ–¹æ–‡æ¡£ï¼Œ<code>Prompt Caching</code> çš„æµç¨‹å¦‚ä¸‹<sup class="footnote-ref"><a href="#fn10" id="fnref10:1">[10:1]</a></sup>ï¼š</p>
<ul>
<li><strong>Cache Lookup</strong>ï¼šæ£€æŸ¥è¾“å…¥ prompts çš„å‰ç¼€æ˜¯å¦ä½äºç¼“å­˜</li>
<li><strong>Cache Hit</strong>ï¼šå¦‚æœæ‰¾åˆ°åŒ¹é…çš„å‰ç¼€ï¼Œåˆ™ä½¿ç”¨ç¼“å­˜ç»“æœ</li>
<li><strong>Cache Miss</strong>ï¼šå¦åˆ™ï¼ŒæŒ‰ç…§å®Œæˆçš„å¤„ç†æ–¹å¼ä»å¤´å¤„ç†è¯¥è¯·æ±‚ï¼Œå¹¶å°†å¯¹åº”çš„ç»“æœç¼“å­˜èµ·æ¥ä»¥å¤‡å°†æ¥ä½¿ç”¨</li>
</ul>
<p>ä¸ºäº†é¿å…æ— æ•ˆçš„ç¼“å­˜å ç”¨ï¼Œå¯¹äºç¼“å­˜çš„æœ€é•¿å‰ç¼€è®¡ç®—ç»“æœï¼Œå¦‚æœæ²¡æœ‰åœ¨ 5~10 åˆ†é’Ÿå†…å†æ¬¡è®¿é—®è¯¥ç¼“å­˜ç»“æœï¼ŒOpenAI å°†æ¸…ç©ºè¯¥ç¼“å­˜ã€‚åœ¨éé«˜å³°æ—¶æ®µï¼Œç¼“å­˜å¯ä»¥ä¿å­˜é•¿è¾¾ 1 å°æ—¶ã€‚</p>
<p><code>Prompt Caching</code> å¯ç”¨äº 1024 ä¸ªæˆ–æ›´å¤š tokens çš„ promptsï¼Œå¹¶ä¸”ç¼“å­˜ä»¥ 128 ä¸ª token ä¸æ–­å¢åŠ ï¼Œä¹Ÿå°±æ˜¯è¯´è¯·æ±‚ä¸­ç¼“å­˜çš„ tokens æ•°é‡å°†å§‹ç»ˆä¸ºï¼š1024ã€1152ã€1280ã€1408â€¦â€¦</p>
<p>å¯ä»¥é€šè¿‡ API å“åº”ä¸­çš„ <code>usage.prompt_tokens_details.cached_tokens</code> å­—æ®µæ¥æŸ¥çœ‹è¯·æ±‚æ˜¯å¦å‘½ä¸­ <code>Prompt Caching</code> ä»¥åŠå‘½ä¸­ <code>Prompt Caching</code> çš„ tokens æ•°é‡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&quot;usage&quot;: &#123;</span><br><span class="line">  &quot;prompt_tokens&quot;: 2006,</span><br><span class="line">  &quot;completion_tokens&quot;: 300,</span><br><span class="line">  &quot;total_tokens&quot;: 2306,</span><br><span class="line">  &quot;prompt_tokens_details&quot;: &#123;</span><br><span class="line">    &quot;cached_tokens&quot;: 1920</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;completion_tokens_details&quot;: &#123;</span><br><span class="line">    &quot;reasoning_tokens&quot;: 0,</span><br><span class="line">    &quot;accepted_prediction_tokens&quot;: 0,</span><br><span class="line">    &quot;rejected_prediction_tokens&quot;: 0</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ä¸¾ä¸ªä¾‹å­ğŸŒ°">ä¸¾ä¸ªä¾‹å­ğŸŒ°</h2>
<p>æˆ‘æœ‰ä¸€ä¸ªå›¾ç‰‡å†…å®¹åˆ†æçš„æœåŠ¡ï¼Œè¯¥æœåŠ¡å…è®¸ç”¨æˆ·è¾“å…¥ä¸€å¼ å›¾ç‰‡å’Œä¸€æ®µæ–‡æœ¬æè¿°ï¼Œç„¶ååˆ¤æ–­å›¾ç‰‡å†…å®¹å’Œæ–‡æœ¬æè¿°ä¹‹é—´çš„ç›¸å…³æ€§ï¼Œå¹¶æ ¹æ®ç›¸å…³æ€§ç»™äºä¸€ä¸ªæ‰“åˆ†ã€‚</p>
<p>ç®€ä¾¿æœŸé—´ï¼Œæˆ‘ä½¿ç”¨ GPT-4o æ¨¡å‹æ¥å®ç°è¿™ä¸ªåŠŸèƒ½ï¼Œæ•´ä½“çš„ prompts å¾—æ ¼å¼å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="/2024/11/23/insight-of-the-prompt-cache/pic_prompt.png" alt></p>
<p>ä¸€èˆ¬è€Œè¨€ï¼Œæˆ‘ä¼šä¸€æ¬¡åˆ†æå‡ ç™¾å¼ å›¾ç‰‡ï¼Œå¹¶ä¸”ç”¨äºå›¾ç‰‡åˆ†æçš„ prompts çš„é•¿åº¦éå¸¸å¤§ï¼Œå¹³å‡é•¿åº¦åœ¨ 1200 ä¸ª tokens å·¦å³ã€‚è€Œå…¶ä¸­çš„è§’è‰²è®¾å®šã€åˆ†æè§„åˆ™ã€æ‰“åˆ†è§„åˆ™çš„æè¿°éƒ¨åˆ†åœ¨ 1000 ä¸ª tokens å·¦å³ï¼Œå¹¶ä¸”æ˜¯å›ºå®šä¸å˜çš„ï¼Œå˜åŒ–çš„å›¾ç‰‡å’Œæ–‡æœ¬miaonæè¿°éƒ¨åˆ†åœ¨ 200 ä¸ª tokens å·¦å³ï¼ˆå…¶ä¸­å›¾ç‰‡å›ºå®š 85 ä¸ª tokensï¼‰ã€‚æ‰€ä»¥åœ¨æ²¡æœ‰ <code>Prompt Caching</code> ä¹‹å‰ï¼Œæ¯æ¬¡è¯·æ±‚éƒ½ä¼šé‡å¤è®¡ç®— 1000 ä¸ª tokensï¼ˆå æ¯” 80%ï¼‰ï¼Œä»è€Œé€ æˆå¤§é‡çš„é‡å¤è®¡ç®—ï¼Œè¿›è€Œå¸¦æ¥äº†æ›´å¤šçš„è´¹ç”¨ã€‚</p>
<p>åœ¨ <code>Prompt Caching</code> ä¹‹åï¼Œæˆ‘æ¯æ¬¡è¯·æ±‚åªéœ€è¦è®¡ç®— 200 ä¸ª tokensï¼ˆå æ¯” 20%ï¼‰ï¼Œä»è€ŒèŠ‚çœäº† 80% çš„è®¡ç®—é‡å’Œè´¹ç”¨ï¼Œå…·ä½“çš„ GPT-4o çš„ API å“åº”å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&quot;usage&quot;: &#123;</span><br><span class="line">  &quot;prompt_tokens&quot;: 1135, </span><br><span class="line">  &quot;completion_tokens&quot;: 284, </span><br><span class="line">  &quot;total_tokens&quot;: 1419, </span><br><span class="line">  &quot;prompt_tokens_details&quot;: &#123;</span><br><span class="line">    &quot;cached_tokens&quot;: 1024</span><br><span class="line">  &#125;, </span><br><span class="line">  &quot;completion_tokens_details&quot;: &#123;</span><br><span class="line">    &quot;reasoning_tokens&quot;: 0</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä»ä¸Šè¿°çš„ç»“æœå¯ä»¥å‘ç°ï¼Œä½¿ç”¨ <code>Prompt Caching</code> ä¹‹åï¼Œè¯¥è¯·æ±‚æœ‰ 1024 ä¸ª tokensï¼ˆå æ¯” 90%ï¼‰å‘½ä¸­äº†ç¼“å­˜ï¼Œä»è€ŒèŠ‚çœäº† 90% çš„è´¹ç”¨ã€‚</p>
<h2 id="å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</h2>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p><a href="https://arxiv.org/abs/2311.04934v2">Prompt Cache: Modular Attention Reuse For Low-Latency Inference</a> <a href="#fnref1" class="footnote-backref">â†©ï¸</a> <a href="#fnref1:1" class="footnote-backref">â†©ï¸</a> <a href="#fnref1:2" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn2" class="footnote-item"><p><a href="https://simonwillison.net/2024/May/14/context-caching-for-google-gemini/">Context caching for Google Gemini</a> <a href="#fnref2" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn3" class="footnote-item"><p><a href="https://platform.moonshot.cn/blog/posts/context-caching">Context Caching æ­£å¼å…¬æµ‹</a> <a href="#fnref3" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn4" class="footnote-item"><p><a href="https://api-docs.deepseek.com/news/news0802">DeepSeek API introduces Context Caching on Disk, cutting prices by an order of magnitude</a> <a href="#fnref4" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn5" class="footnote-item"><p><a href="https://www.anthropic.com/news/prompt-caching">Prompt caching with Claude</a> <a href="#fnref5" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn6" class="footnote-item"><p><a href="https://openai.com/index/api-prompt-caching/">Prompt Caching in the API</a> <a href="#fnref6" class="footnote-backref">â†©ï¸</a> <a href="#fnref6:1" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn7" class="footnote-item"><p><a href="https://arxiv.org/abs/2411.05276v1">GPT Semantic Cache: Reducing LLM Costs and Latency via Semantic Embedding Caching</a> <a href="#fnref7" class="footnote-backref">â†©ï¸</a> <a href="#fnref7:1" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn8" class="footnote-item"><p><a href="https://github.com/zilliztech/GPTCache">GPTCache : A Library for Creating Semantic Cache for LLM Queries</a> <a href="#fnref8" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn9" class="footnote-item"><p><a href="https://arxiv.org/abs/2308.16369">SARATHI: Efficient LLM Inference by Piggybacking Decodes with Chunked Prefills</a> <a href="#fnref9" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn10" class="footnote-item"><p><a href="https://platform.openai.com/docs/guides/prompt-caching">Prompt caching: Reduce latency and cost with Prompt Caching</a> <a href="#fnref10" class="footnote-backref">â†©ï¸</a> <a href="#fnref10:1" class="footnote-backref">â†©ï¸</a></p>
</li>
</ol>
</section>
]]></content>
      <categories>
        <category>LLM</category>
      </categories>
      <tags>
        <tag>Prompt Cache</tag>
        <tag>LLM Interface</tag>
      </tags>
  </entry>
  <entry>
    <title>å¤§æ¨¡å‹çš„è¿è¡Œæ—¶æ¨ç†å’Œ KV Cache</title>
    <url>/2024/11/16/The-LLMs-Runtime-Inference-and-KV-Cache/</url>
    <content><![CDATA[<p><img src="/2024/11/16/The-LLMs-Runtime-Inference-and-KV-Cache/Prefill-and-decoding-phase-in-the-LLM-inference.png" alt></p>
<p>åœ¨ <a href="/2024/10/16/What-exactly-is-attention/">è‡ªæ³¨æ„åŠ›ç©¶ç«Ÿæ˜¯ä»€ä¹ˆï¼Ÿ</a> å’Œ <a href="/2024/10/31/From-Transformer-To-GPT/">ä» Transformer åˆ° GPT</a> ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº† Transformer æ¶æ„çš„è¯¦ç»†ç»†èŠ‚ï¼Œå¹¶ä»‹ç»äº†åŸºäº Transformer çš„ GPT æ¶æ„çš„ç»†èŠ‚ã€‚è·ç¦»æˆ‘ä»¬æ¢ç©¶ <a href="https://openai.com/index/api-prompt-caching/">Prompt Caching</a> çš„åŸç†åˆè¿‘äº†ä¸€æ­¥ã€‚å°±åƒ <code>ç¨‹åº</code> å’Œ <code>è¿›ç¨‹</code> ä¹‹é—´çš„åŒºåˆ«ä¸€æ ·ï¼ŒPrompt Caching å±äºè¿è¡Œæ—¶çš„èŒƒç•´ï¼Œå› æ­¤åœ¨æ¢ç©¶ <a href="https://openai.com/index/api-prompt-caching/">Prompt Caching</a> çš„åŸç†ä¹‹å‰ï¼Œæˆ‘ä»¬è¿˜è¦ç»§ç»­äº†è§£å¤§æ¨¡å‹åœ¨éƒ¨ç½²å’Œè¿è¡Œæ—¶æ¨ç†æ–¹é¢çš„ç»†èŠ‚ã€‚</p>
<span id="more"></span>
<h2 id="prefill-é˜¶æ®µ-decode-é˜¶æ®µè¯¦è§£">Prefill é˜¶æ®µ &amp; Decode é˜¶æ®µè¯¦è§£</h2>
<p>æ¯ä¸ª Transformer æ¶æ„çš„å¤§å‹è¯­è¨€æ¨¡å‹çš„æ¨ç†è¯·æ±‚éƒ½ä¼šç»å†ä¸¤ä¸ªé˜¶æ®µï¼š<code>prefill é˜¶æ®µ</code> å’Œ <code>decode é˜¶æ®µ</code>ã€‚<code>prefill é˜¶æ®µ</code> ä¼šå¯¹è¾“å…¥çš„ prompts è¿›è¡Œå¤„ç†ï¼Œè€Œ <code>decode é˜¶æ®µ</code> åˆ™ä¸»è¦æ˜¯åˆ©ç”¨è‡ªå›å½’çš„æ–¹å¼æ¥ç”Ÿæˆ tokensã€‚å¦‚ä¸‹å›¾æ‰€ç¤º<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup>ï¼Œä¸€ä¸ªè¯·æ±‚ä»…éœ€è¦ç»å† 1 æ¬¡ <code>prefill é˜¶æ®µ</code>ï¼Œä½†å´éœ€è¦ç»å†å¤šæ¬¡ <code>decode é˜¶æ®µ</code>ï¼Œæ¯ç”Ÿæˆ 1 ä¸ª token å°±éœ€è¦ 1 æ¬¡ <code>decode é˜¶æ®µ</code>ï¼Œè¿™ä¸€ç‰¹æ€§ä¹Ÿå°†æ˜¾è‘—å½±å“åˆ°å¤§è¯­è¨€æ¨¡å‹çš„æ•´ä½“æ¨ç†æ•ˆç‡ã€‚</p>
<p><img src="/2024/11/16/The-LLMs-Runtime-Inference-and-KV-Cache/17320037998361.jpg" alt="From https://arxiv.org/abs/2407.12391v1"></p>
<h3 id="prefill-decode">Prefill &amp; Decode</h3>
<p>Transformer æ¶æ„çš„æ¨ç†ä» <code>prefill é˜¶æ®µ</code> å¼€å§‹ï¼Œåœ¨è¯¥é˜¶æ®µä¸­ï¼Œæ¨¡å‹ä¼šå¹¶è¡Œå¤„ç†ç»™å®š <code>batch size</code> ä¸‹çš„æ‰€æœ‰çš„è¾“å…¥ tokensã€‚æ­¤æ—¶ï¼ŒTransformer è§£ç å™¨çš„è¾“å…¥æ˜¯ä¸€ä¸ªå½¢çŠ¶ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>B</mi><mo separator="true">,</mo><mi>L</mi><mo separator="true">,</mo><mi>H</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[B, L, H]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">L</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mclose">]</span></span></span></span> çš„å¼ é‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">X</mi></mrow><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">X</span></span></span></span></span>ï¼Œå…¶ä¸­ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span></span> è¡¨ç¤ºæ‰¹å¤„ç†ä¸­æ‰€åŒ…å«çš„è¯·æ±‚ä¸ªæ•°ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">L</span></span></span></span> è¡¨ç¤ºæ¯ä¸ªè¯·æ±‚çš„ prompt  é•¿åº¦ï¼Œä¹Ÿå°±æ˜¯ç»™å®šæŸ¥è¯¢ä¸­è¾“å…¥ tokens çš„æ•°é‡ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span></span></span></span> æ˜¯æ¨¡å‹çš„ï¼ˆåµŒå…¥å‘é‡ï¼‰ç»´åº¦ï¼ˆä¾‹å¦‚ï¼Œå¯¹äº GPT-3 æ¨¡å‹æ¥è¯´ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span></span></span></span> çš„å€¼ä¸º 12288ï¼‰ã€‚</p>
<p><img src="/2024/11/16/The-LLMs-Runtime-Inference-and-KV-Cache/17319145519382.jpg" alt></p>
<p><code>decode é˜¶æ®µ</code> çš„æ“ä½œä¸ <code>prefill é˜¶æ®µ</code> å®Œå…¨ç›¸åŒï¼Œå”¯ä¸€çš„åŒºåˆ«æ˜¯ <code>decode é˜¶æ®µ</code> ä»…é’ˆå¯¹ä¸Šä¸€æ¬¡è‡ªå›å½’è¿­ä»£ä¸­ç”Ÿæˆçš„å•ä¸ª tokenã€‚å› æ­¤ï¼Œåœ¨ <code>decode é˜¶æ®µ</code> ä¸­ï¼ŒTransformer è§£ç å™¨çš„è¾“å…¥æ˜¯ä¸€ä¸ªå½¢çŠ¶ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>B</mi><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mi>H</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[B, 1, H]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mclose">]</span></span></span></span> çš„å¼ é‡ã€‚<br>
<img src="/2024/11/16/The-LLMs-Runtime-Inference-and-KV-Cache/17319151377664.jpg" alt></p>
<p>æ­¤å¤–ï¼Œå¯¹æ¯ä¸ªæ–°ç”Ÿæˆçš„ token çš„æ³¨æ„åŠ›çš„è®¡ç®—ä¾èµ–äºåŒä¸€è¯·æ±‚ä¸­æ‰€æœ‰çš„ã€å…ˆå‰çš„ tokens çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">k</mi></mrow><annotation encoding="application/x-tex">\mathbf{k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">k</span></span></span></span></span> å‘é‡å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">v</mi></mrow><annotation encoding="application/x-tex">\mathbf{v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.44444em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span></span></span></span> å‘é‡ï¼ˆç»´åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><msub><mi>d</mi><mrow><mi>h</mi><mi>e</mi><mi>a</mi><mi>d</mi></mrow></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[1,d_{head}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">d</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span>ï¼‰ã€‚åœ¨æ¯æ¬¡è¿­ä»£ä¸­ï¼Œä¸ºäº†é¿å…é‡æ–°è®¡ç®—æ‰€æœ‰çš„ã€å…ˆå‰çš„ tokens çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">k</mi></mrow><annotation encoding="application/x-tex">\mathbf{k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">k</span></span></span></span></span> å‘é‡å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">v</mi></mrow><annotation encoding="application/x-tex">\mathbf{v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.44444em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span></span></span></span> å‘é‡ï¼Œå¤§éƒ¨åˆ†çš„æ¨ç†æ¡†æ¶éƒ½ä¼šå°†è¿™äº›å‘é‡å€¼ç¼“å­˜åˆ° GPU å†…å­˜ä¸­ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„ <code>KV ç¼“å­˜</code>ã€‚</p>
<p>å¦‚æœæ¨¡å‹çš„è§£ç å™¨æ€»å…±æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mrow><mi>l</mi><mi>a</mi><mi>y</mi><mi>e</mi><mi>r</mi><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">n_{layers}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> å±‚ã€æ¯å±‚æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mrow><mi>h</mi><mi>e</mi><mi>a</mi><mi>d</mi><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">n_{heads}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä¸ªæ³¨æ„åŠ›å¤´ã€æ¯ä¸ªæ³¨æ„åŠ›å¤´çš„ç»´åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>h</mi><mi>e</mi><mi>a</mi><mi>d</mi></mrow></msub></mrow><annotation encoding="application/x-tex">d_{head}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">d</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ã€æ¨¡å‹çš„ç²¾åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">p_m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼ˆå•ä½ä¸º Byteï¼‰ï¼Œé‚£ä¹ˆæ¯ä¸ª token éœ€è¦çš„ <code>KV ç¼“å­˜</code> çš„å¤§å°ä¸ºï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>âˆ—</mo><msub><mi>n</mi><mrow><mi>l</mi><mi>a</mi><mi>y</mi><mi>e</mi><mi>r</mi><mi>s</mi></mrow></msub><mo>âˆ—</mo><msub><mi>n</mi><mrow><mi>h</mi><mi>e</mi><mi>a</mi><mi>d</mi><mi>s</mi></mrow></msub><mo>âˆ—</mo><msub><mi>d</mi><mrow><mi>h</mi><mi>e</mi><mi>a</mi><mi>d</mi></mrow></msub><mo>âˆ—</mo><msub><mi>p</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">2 * n_{layers} * n_{heads} * d_{head} * p_m
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.751388em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.61528em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">d</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>ä»¥ GPT-3 æ¨¡å‹ä¸ºä¾‹ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mrow><mi>l</mi><mi>a</mi><mi>y</mi><mi>e</mi><mi>r</mi><mi>s</mi></mrow></msub><mo>=</mo><mn>96</mn></mrow><annotation encoding="application/x-tex">n_{layers}=96</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">9</span><span class="mord">6</span></span></span></span>ã€<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mrow><mi>h</mi><mi>e</mi><mi>a</mi><mi>d</mi><mi>s</mi></mrow></msub><mo>=</mo><mn>96</mn></mrow><annotation encoding="application/x-tex">n_{heads}=96</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">9</span><span class="mord">6</span></span></span></span>ã€<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>h</mi><mi>e</mi><mi>a</mi><mi>d</mi></mrow></msub><mo>=</mo><mn>128</mn></mrow><annotation encoding="application/x-tex">d_{head}=128</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">d</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">2</span><span class="mord">8</span></span></span></span>ï¼Œå¦‚æœæ¨¡å‹ç²¾åº¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>m</mi></msub><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">p_m=2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span>ï¼Œé‚£ä¹ˆæ¯ä¸ª token éœ€è¦çš„ <code>KV ç¼“å­˜</code> çš„å¤§å°ä¸ºï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>âˆ—</mo><mn>96</mn><mo>âˆ—</mo><mn>96</mn><mo>âˆ—</mo><mn>128</mn><mo>âˆ—</mo><mn>2</mn><mo>â‰ˆ</mo><mn>4.5</mn><mi>M</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">2 * 96 * 96 * 128 * 2 \approx 4.5 MB
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">9</span><span class="mord">6</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">9</span><span class="mord">6</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">2</span><span class="mord">8</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰ˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">4</span><span class="mord">.</span><span class="mord">5</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span></span></span></p>
<p>å› æ­¤ï¼Œå¦‚æœæ¨¡å‹çš„ä¸Šä¸‹æ–‡çª—å£å¤§å°æ˜¯ 1000ï¼Œåˆ™å¯¹äºæ¯ä¸ªè¯·æ±‚è€Œè¨€ï¼Œéœ€è¦çš„ <code>KV ç¼“å­˜</code> çš„å¤§å°ä¸ºï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1000</mn><mo>âˆ—</mo><mn>4.5</mn><mi>M</mi><mi>B</mi><mo>â‰ˆ</mo><mn>4.4</mn><mi>G</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">1000 * 4.5 MB \approx 4.4 GB
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">4</span><span class="mord">.</span><span class="mord">5</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰ˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">4</span><span class="mord">.</span><span class="mord">4</span><span class="mord mathdefault">G</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span></span></span></p>
<p>ä»¥ LLaMa-13B æ¨¡å‹ä¸ºä¾‹ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mrow><mi>l</mi><mi>a</mi><mi>y</mi><mi>e</mi><mi>r</mi><mi>s</mi></mrow></msub><mo>=</mo><mn>40</mn></mrow><annotation encoding="application/x-tex">n_{layers}=40</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">4</span><span class="mord">0</span></span></span></span>ã€<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mrow><mi>h</mi><mi>e</mi><mi>a</mi><mi>d</mi><mi>s</mi></mrow></msub><mo>=</mo><mn>40</mn></mrow><annotation encoding="application/x-tex">n_{heads}=40</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">4</span><span class="mord">0</span></span></span></span>ã€<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>h</mi><mi>e</mi><mi>a</mi><mi>d</mi></mrow></msub><mo>=</mo><mn>128</mn></mrow><annotation encoding="application/x-tex">d_{head}=128</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">d</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">2</span><span class="mord">8</span></span></span></span>ï¼Œå¦‚æœæ¨¡å‹ç²¾åº¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>m</mi></msub><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">p_m=2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span>ï¼Œé‚£ä¹ˆæ¯ä¸ª token éœ€è¦çš„ <code>KV ç¼“å­˜</code> çš„å¤§å°ä¸ºï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>âˆ—</mo><mn>40</mn><mo>âˆ—</mo><mn>40</mn><mo>âˆ—</mo><mn>128</mn><mo>âˆ—</mo><mn>2</mn><mo>â‰ˆ</mo><mn>800</mn><mi>K</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">2 * 40 * 40 * 128 * 2 \approx 800 KB
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">4</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">4</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">2</span><span class="mord">8</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰ˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">8</span><span class="mord">0</span><span class="mord">0</span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span></span></span></p>
<p>å› æ­¤ï¼Œå¦‚æœæ¨¡å‹çš„ä¸Šä¸‹æ–‡çª—å£å¤§å°æ˜¯ 1000ï¼Œåˆ™å¯¹äºæ¯ä¸ªè¯·æ±‚è€Œè¨€ï¼Œéœ€è¦çš„ <code>KV ç¼“å­˜</code> çš„å¤§å°ä¸ºï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1000</mn><mo>âˆ—</mo><mn>800</mn><mi>K</mi><mi>B</mi><mo>â‰ˆ</mo><mn>781</mn><mi>M</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">1000 * 800 KB \approx 781 MB
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">8</span><span class="mord">0</span><span class="mord">0</span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰ˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">7</span><span class="mord">8</span><span class="mord">1</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span></span></span></p>
<h3 id="å„é˜¶æ®µçš„è®¡ç®—ç‰¹æ€§">å„é˜¶æ®µçš„è®¡ç®—ç‰¹æ€§</h3>
<blockquote>
<p>æœ¬èŠ‚ä¸­æ‰€æœ‰çš„å®éªŒæ•°æ®å‡æ¥è‡ª SARATHI<sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup>ã€‚</p>
</blockquote>
<p><a href="https://arxiv.org/abs/2308.16369">SARATHI</a> ç»™å‡ºäº†åœ¨ä¸åŒçš„ <code>batch size</code> ä¸‹ï¼Œéƒ¨ç½²åœ¨ <a href="https://www.nvidia.com/en-us/design-visualization/rtx-a6000/">A6000</a> GPU ä¸Šçš„ LLaMa-13B å¤§æ¨¡å‹åœ¨å¤„ç†é•¿åº¦ä¸º 1024 çš„ prompt æ—¶çš„ä¸åŒæ¨ç†é˜¶æ®µçš„å• token è€—æ—¶å¯¹æ¯”ã€‚</p>
<p><img src="/2024/11/16/The-LLMs-Runtime-Inference-and-KV-Cache/17319839433982.jpg" alt="From SARATHI, https://arxiv.org/abs/2308.16369"><br>
ä»å›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼š</p>
<ul>
<li><code>prefill é˜¶æ®µ</code> ä¼šå¹¶è¡Œå¤„ç†è¾“å…¥åºåˆ—ä¸­çš„æ‰€æœ‰ tokensï¼Œå¤„ç†è¿‡ç¨‹æ¶‰åŠè‡ªæ³¨æ„åŠ›è®¡ç®—ç­‰çš„å¤§é‡çŸ©é˜µè¿ç®—ï¼Œå±äºè®¡ç®—å¯†é›†å‹ä»»åŠ¡ã€‚å› æ­¤ï¼Œå¯¹äºä¸åŒçš„ <code>batch size</code>ï¼Œ<code>prefill é˜¶æ®µ</code> çš„å• token è€—æ—¶å‡ ä¹æ˜¯ä¸€è‡´çš„ï¼Œå³ä½¿åœ¨ <code>batch size</code> æ¯”è¾ƒå°çš„æƒ…å†µä¸‹ï¼ˆä¾‹å¦‚ <code>batch size</code> ä¸º 1ï¼‰ä¹Ÿèƒ½ä»¤ GPU çš„è´Ÿè½½è¾¾åˆ°é¥±å’ŒçŠ¶æ€ã€‚</li>
<li><code>decode é˜¶æ®µ</code> åœ¨æ¯æ¬¡è‡ªå›å½’è¿­ä»£ä¸­ä»…å¤„ç†ä¸€ä¸ª tokenï¼Œè¿™å°±å¯¼è‡´åœ¨ <code>batch size</code> è¾ƒå°çš„æƒ…å†µä¸‹ï¼ŒGPU çš„åˆ©ç”¨ç‡éå¸¸ä½ã€‚æ‰€ä»¥æˆ‘ä»¬çœ‹åˆ°ï¼Œéšç€ <code>batch size</code> çš„å¢åŠ ï¼Œè¯¥é˜¶æ®µçš„å• token è€—æ—¶å‘ˆç°æ˜¾è‘—çš„é™ä½è¶‹åŠ¿ã€‚å°¤å…¶æ˜¯å½“ <code>batch size</code> æ¯”è¾ƒå°æ—¶ï¼ˆä¸º 1 æ—¶ï¼‰ï¼Œå• token çš„ <code>decode</code> æˆæœ¬æ˜¯ <code>prefill</code> æˆæœ¬çš„ 200 å€ã€‚ç”±äºè¯¥é˜¶æ®µéœ€è¦é¢‘ç¹åœ°è¯»å– <code>KV ç¼“å­˜</code>ï¼Œå¯¼è‡´ IO å¼€é”€è¾ƒå¤§ï¼Œå¢åŠ  <code>batch size</code> èƒ½æ›´æœ‰æ•ˆåœ°åˆ†æ‘Š IO æˆæœ¬ï¼Œæ‰€ä»¥å¯ä»¥æ˜¾è‘—é™ä½ <code>decode é˜¶æ®µ</code> çš„å¼€é”€ã€‚ä½†æ˜¯ï¼Œæ¯•ç«Ÿè¯¥é˜¶æ®µçš„ IO å¼€é”€è¿‡å¤§ï¼Œè¯¥é˜¶æ®µä»ç„¶æ˜¯ IO å¯†é›†å‹ä»»åŠ¡ï¼Œå³ä¾¿ <code>batch size</code> å†å¤§ï¼ˆæ¯”å¦‚ä¸º 18 æ—¶ï¼‰ä¹Ÿä¸èƒ½ä»¤ GPU å®Œå…¨é¥±å’Œã€‚æ‰€ä»¥å½“ <code>batch size</code> æ¯”è¾ƒå¤§æ—¶ï¼ˆä¸º 18 æ—¶ï¼‰ï¼Œå• token çš„ <code>decode</code> æˆæœ¬è™½ç„¶é™ä½è‡³ <code>prefill</code> æˆæœ¬çš„ 4 å€ï¼Œä½†æ˜¯å’Œè®¡ç®—å¯†é›†å‹çš„ <code>prefill é˜¶æ®µ</code> ç›¸æ¯”ï¼Œå• token çš„æˆæœ¬ä¾ç„¶å¾ˆé«˜ã€‚</li>
</ul>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <a href="https://docs.nvidia.com/deeplearning/performance/dl-performance-gpu-background/index.html">arithmetic intensity</a>â€”â€”æ¯æ¬¡å†…å­˜ IO å¯¹åº”çš„è®¡ç®—é‡â€”â€”æ¥åŒºåˆ†è®¡ç®—å¯†é›†å‹ä»»åŠ¡å’Œå†…å­˜å¯†é›†å‹ä»»åŠ¡ã€‚å¦‚æœ <code>arithmetic intensity</code> å¤§äº GPU çš„æ¯ IO æ“ä½œçš„è®¡ç®—é‡ï¼Œåˆ™å¯ä»¥è®¤ä¸ºæ”¹ä»»åŠ¡æ˜¯è®¡ç®—å¯†é›†å‹ä»»åŠ¡ï¼Œå¦åˆ™å°±æ˜¯ IO å¯†é›†å‹ä»»åŠ¡ã€‚<sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup></p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>arithmeticÂ intensity</mtext><mo>=</mo><mfrac><mtext>#ops</mtext><mtext>#bytes</mtext></mfrac></mrow><annotation encoding="application/x-tex">\text{arithmetic intensity} = \frac{\text{\#ops}}{\text{\#bytes}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord text"><span class="mord">arithmeticÂ intensity</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.25188em;vertical-align:-0.8804400000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">#bytes</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">#ops</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">{</mo><mtable rowspacing="0.3599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>è®¡ç®—å¯†é›†å‹</mtext><mo separator="true">,</mo><mspace width="1em"></mspace></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>i</mi><mi>f</mi><mtext>Â arithmeticÂ intensity</mtext><mo>&gt;</mo><mfrac><mrow><mi>G</mi><mi>P</mi><msup><mi>U</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><mi>s</mi><mtext>Â </mtext><mi>F</mi><mi>L</mi><mi>O</mi><mi>P</mi><mi>S</mi></mrow><mrow><mi>G</mi><mi>P</mi><msup><mi>U</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><mi>s</mi><mtext>Â </mtext><mi>M</mi><mi>e</mi><mi>m</mi><mi>o</mi><mi>r</mi><mi>y</mi><mtext>Â </mtext><mi>B</mi><mi>a</mi><mi>n</mi><mi>d</mi><mi>w</mi><mi>i</mi><mi>d</mi><mi>t</mi><mi>h</mi></mrow></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>IOÂ å¯†é›†å‹</mtext><mo separator="true">,</mo><mspace width="1em"></mspace></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>o</mi><mi>t</mi><mi>h</mi><mi>e</mi><mi>r</mi><mi>w</mi><mi>i</mi><mi>s</mi><mi>e</mi></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">\begin{cases}
\text{è®¡ç®—å¯†é›†å‹}, \quad &amp; if\ \text{arithmetic intensity} \gt \frac{GPU&#x27;s\ FLOPS}{GPU&#x27;s\ Memory\ Bandwidth}\\
\text{IO å¯†é›†å‹}, \quad &amp; otherwise
\end{cases}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.0000299999999998em;vertical-align:-1.25003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7145539999999997em;"><span style="top:-3.7145539999999997em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord cjk_fallback">è®¡ç®—å¯†é›†å‹</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"></span></span></span><span style="top:-2.225446em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">IOÂ </span><span class="mord cjk_fallback">å¯†é›†å‹</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.2145540000000001em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7145539999999997em;"><span style="top:-3.7145539999999997em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mspace">Â </span><span class="mord text"><span class="mord">arithmeticÂ intensity</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.97348em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">G</span><span class="mord mathdefault mtight" style="margin-right:0.13889em;">P</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mord mathdefault mtight">s</span><span class="mspace mtight"><span class="mtight">Â </span></span><span class="mord mathdefault mtight" style="margin-right:0.10903em;">M</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="mspace mtight"><span class="mtight">Â </span></span><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight" style="margin-right:0.02691em;">w</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">h</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">G</span><span class="mord mathdefault mtight" style="margin-right:0.13889em;">P</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278285714285715em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mord mathdefault mtight">s</span><span class="mspace mtight"><span class="mtight">Â </span></span><span class="mord mathdefault mtight" style="margin-right:0.13889em;">F</span><span class="mord mathdefault mtight">L</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">O</span><span class="mord mathdefault mtight" style="margin-right:0.13889em;">P</span><span class="mord mathdefault mtight" style="margin-right:0.05764em;">S</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.481108em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-2.225446em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathdefault">o</span><span class="mord mathdefault">t</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord mathdefault">e</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.2145540000000001em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p><a href="https://www.nvidia.com/en-us/design-visualization/rtx-a6000/">A6000</a> GPU æ¯ç§’å•ç²¾åº¦è®¡ç®—æ¬¡æ•°ä¸º 38.7 TFLOPSï¼Œå†…å­˜å¸¦å®½ä¸º 768 GB/s <sup class="footnote-ref"><a href="#fn4" id="fnref4">[4]</a></sup>ï¼Œå› æ­¤ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>G</mi><mi>P</mi><msup><mi>U</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><mi>s</mi><mtext>Â </mtext><mi>F</mi><mi>L</mi><mi>O</mi><mi>P</mi><mi>S</mi></mrow><mrow><mi>G</mi><mi>P</mi><msup><mi>U</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><mi>s</mi><mtext>Â </mtext><mi>M</mi><mi>e</mi><mi>m</mi><mi>o</mi><mi>r</mi><mi>y</mi><mtext>Â </mtext><mi>B</mi><mi>a</mi><mi>n</mi><mi>d</mi><mi>w</mi><mi>i</mi><mi>d</mi><mi>t</mi><mi>h</mi></mrow></mfrac><mo>â‰ˆ</mo><mn>50</mn></mrow><annotation encoding="application/x-tex">\frac{GPU&#x27;s\ FLOPS}{GPU&#x27;s\ Memory\ Bandwidth} \approx 50</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.454588em;vertical-align:-0.481108em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.97348em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">G</span><span class="mord mathdefault mtight" style="margin-right:0.13889em;">P</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mord mathdefault mtight">s</span><span class="mspace mtight"><span class="mtight">Â </span></span><span class="mord mathdefault mtight" style="margin-right:0.10903em;">M</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="mspace mtight"><span class="mtight">Â </span></span><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight" style="margin-right:0.02691em;">w</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">h</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">G</span><span class="mord mathdefault mtight" style="margin-right:0.13889em;">P</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278285714285715em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mord mathdefault mtight">s</span><span class="mspace mtight"><span class="mtight">Â </span></span><span class="mord mathdefault mtight" style="margin-right:0.13889em;">F</span><span class="mord mathdefault mtight">L</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">O</span><span class="mord mathdefault mtight" style="margin-right:0.13889em;">P</span><span class="mord mathdefault mtight" style="margin-right:0.05764em;">S</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.481108em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰ˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">5</span><span class="mord">0</span></span></span></span>ï¼Œå› æ­¤å¦‚æœ <code>arithmetic intensity</code> å¤§äº 50ï¼Œåˆ™æ„å‘³ç€åœ¨ A6000 GPU ä¸Šï¼Œè¯¥ä»»åŠ¡æ˜¯è®¡ç®—å¯†é›†å‹ä»»åŠ¡ï¼Œå¯ä»¥éå¸¸å¥½çš„åˆ©ç”¨ GPU çš„è®¡ç®—èƒ½åŠ›ï¼›å¦åˆ™ï¼Œä»»åŠ¡ä¼šå—é™äº IO æ“ä½œè€Œæ— æ³•æœ‰æ•ˆåˆ©ç”¨ GPU çš„èƒ½åŠ›ã€‚</p>
<p><a href="https://arxiv.org/abs/2308.16369">SARATHI</a> ç»™å‡ºäº† <a href="https://www.nvidia.com/en-us/design-visualization/rtx-a6000/">A6000</a> GPU ä¸Šéƒ¨ç½²çš„ LLaMa-13B å¤§æ¨¡å‹åœ¨ä¸åŒ <code>batch size</code> ä¸‹çš„å„é˜¶æ®µçš„ <code>arithmetic intensity</code>ã€‚</p>
<blockquote>
<p>æ³¨æ„ï¼šä¸ºäº†èƒ½å¤Ÿè®© <code>decode é˜¶æ®µ</code> è¾¾åˆ°éå¸¸é«˜çš„ <code>batch size</code>ï¼Œåœ¨å®éªŒä¸­ï¼Œå½“ <code>batch size</code> ä¸º 256 æ—¶ï¼Œæ¨¡å‹çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mrow><mi>l</mi><mi>a</mi><mi>y</mi><mi>e</mi><mi>r</mi><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">n_{layers}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> æ˜¯ 1 è€Œä¸æ˜¯åŸå§‹çš„ 40ã€‚</p>
</blockquote>
<p><img src="/2024/11/16/The-LLMs-Runtime-Inference-and-KV-Cache/17319876353902.jpg" alt="From SARATHI, https://arxiv.org/abs/2308.16369"><br>
ä»ä¸Šå›¾å¯ä»¥çœ‹åˆ°ï¼š</p>
<ul>
<li>å³ä½¿ <code>batch size</code> ä¸º 1 æ—¶ï¼Œ<code>prefill é˜¶æ®µ</code> çš„æ‰€æœ‰æ“ä½œéƒ½å…·æœ‰å¾ˆé«˜çš„ <code>arithmetic intensity</code>ï¼ˆè¿œå¤§äº 50ï¼‰ï¼›è€Œæ­¤æ—¶ï¼Œ<code>decode é˜¶æ®µ</code> çš„ <code>arithmetic intensity</code> åªæœ‰ä¸ªä½æ•°ï¼ˆè¿œå°äº 50ï¼‰ï¼Œåœ¨æ•°é‡çº§ä¸Šä¸‹é™äº† 2 ä¸ªæ•°é‡çº§ã€‚å½“ <code>batch size</code> ä¸º 8 æ—¶ï¼Œä¸ <code>prefill é˜¶æ®µ</code> ç›¸æ¯”ï¼Œ<code>decode é˜¶æ®µ</code> çš„ <code>arithmetic intensity</code> ä¸‹é™äº† 3 ä¸ªæ•°é‡çº§ã€‚</li>
<li>åªæœ‰åœ¨éå¸¸å¤§çš„ <code>batch size</code> æ—¶ï¼ˆ256ï¼‰ï¼Œ<code>decode é˜¶æ®µ</code> æ‰ä¼šå˜æˆè®¡ç®—å¯†é›†å‹ä»»åŠ¡ã€‚ç„¶è€Œï¼Œç”±äºæ¯ä¸ªè¯·æ±‚éƒ½éœ€è¦ <code>KV ç¼“å­˜</code>ï¼Œå› æ­¤ï¼Œåœ¨å®è·µä¸­ï¼Œå¦‚æ­¤é«˜çš„ <code>batch size</code> æ˜¯ä¸å¯è¡Œçš„ã€‚ä¾‹å¦‚ï¼Œå¯¹äº LLaMA 13B æ¨¡å‹ï¼Œåœ¨è¾“å…¥åºåˆ—é•¿åº¦ä¸º 1K çš„æƒ…å†µä¸‹ï¼Œåœ¨ <a href="https://www.nvidia.com/en-us/design-visualization/rtx-a6000/">A6000</a> GPU ä¸Šï¼Œæœ€å¤šå¯ä»¥å¤„ç† 18 ä¸ªè¯·æ±‚ã€‚å› æ­¤ï¼Œåœ¨å®é™…çš„åº”ç”¨ä¸­ï¼Œåœ¨å®é™…å¯è¡Œçš„ <code>batch size</code> çš„å¤§å°èŒƒå›´å†…ï¼Œ<code>decode é˜¶æ®µ</code> ä»ç„¶æ˜¯ IO å¯†é›†å‹ä»»åŠ¡ï¼Œä¼šå—åˆ° IO å’Œå†…å­˜çš„é™åˆ¶ã€‚</li>
</ul>
<p>äºæ˜¯ <a href="https://arxiv.org/abs/2308.16369">SARATHI</a> ç»™å‡ºäº†å¦‚ä¸‹çš„ <a href="https://www.nvidia.com/en-us/design-visualization/rtx-a6000/">A6000</a> GPU ä¸Šéƒ¨ç½²çš„ LLaMa-13B å¤§æ¨¡å‹åœ¨ä¸åŒ <code>batch size</code> ä¸‹çš„å„é˜¶æ®µçš„ token ååé‡ï¼ˆæ¯æ¯«ç§’å¤„ç†çš„ tokens æ•°é‡ï¼‰ã€‚</p>
<blockquote>
<p>æ³¨æ„ï¼šä¸ºäº†èƒ½å¤Ÿè®© <code>decode é˜¶æ®µ</code> è¾¾åˆ°éå¸¸é«˜çš„ <code>batch size</code>ï¼Œåœ¨å®éªŒä¸­ï¼Œå½“ <code>batch size</code> ä¸º 256 æ—¶ï¼Œæ¨¡å‹çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mrow><mi>l</mi><mi>a</mi><mi>y</mi><mi>e</mi><mi>r</mi><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">n_{layers}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> æ˜¯ 1 è€Œä¸æ˜¯åŸå§‹çš„ 40ã€‚</p>
</blockquote>
<p><img src="/2024/11/16/The-LLMs-Runtime-Inference-and-KV-Cache/17319948375916.jpg" alt="From SARATHI, https://arxiv.org/abs/2308.16369"></p>
<p>å¦‚å›¾æ‰€ç¤ºï¼š</p>
<ul>
<li>å½“ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>Ã—</mo><mi>L</mi><mo>â‰¥</mo><mn>512</mn></mrow><annotation encoding="application/x-tex">B \times L \ge 512</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">L</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">5</span><span class="mord">1</span><span class="mord">2</span></span></span></span> æ—¶ï¼Œ<code>prefill é˜¶æ®µ</code> çš„ååé‡åœ¨ 180 tokens/ms å·¦å³æ—¶è¾¾åˆ°é¥±å’Œã€‚ä¾‹å¦‚ï¼Œå½“ <code>batch size</code> ä¸º 1 æ—¶ï¼Œå½“è¯·æ±‚çš„è¾“å…¥åºåˆ—é•¿åº¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo>â‰¥</mo><mn>512</mn></mrow><annotation encoding="application/x-tex">L \ge 512</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">L</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">5</span><span class="mord">1</span><span class="mord">2</span></span></span></span> æ—¶å°±å·²ç»è¾¾åˆ°å³°å€¼ååé‡ã€‚</li>
<li>ç›¸æ¯”ä¹‹ä¸‹ï¼Œå½“ <code>batch size</code> æ¯”è¾ƒå°çš„æ—¶å€™ï¼Œ<code>decode é˜¶æ®µ</code> çš„ååé‡å‘ˆç°çº¿æ€§å¢é•¿çš„è¶‹åŠ¿ã€‚åªæœ‰å½“ <code>batch size</code> è¾¾åˆ° 256 æ—¶ï¼Œ<code>decode é˜¶æ®µ</code> çš„ååé‡æ‰è¾¾åˆ°å³°å€¼ã€‚ä½†æ˜¯ï¼Œå¦‚å‰æ‰€è¿°ï¼Œå®é™…ä¸Šï¼Œæ— æ³•å®ç°å¦‚æ­¤é«˜çš„ <code>batch size</code>ã€‚</li>
</ul>
<h2 id="å¤š-gpu-æ¨ç†">å¤š GPU æ¨ç†</h2>
<p>éšç€å¤§è¯­è¨€æ¨¡å‹çš„å‚æ•°é‡ä¸æ–­å¢åŠ ï¼ŒæŠŠæ¨¡å‹æ‰©å±•åˆ°å¤šä¸ª GPU å¹¶ä¸”é‡‡ç”¨å¤šèŠ‚ç‚¹éƒ¨ç½²è¶Šæ¥è¶Šæœ‰å¿…è¦æ€§ã€‚ä»¥ GPT-3 ä¸ºä¾‹ï¼Œå…¶æ¨¡å‹çš„å‚æ•°å¤§å°ä¸º 1750 äº¿ï¼Œå¦‚æœæ¨¡å‹çš„ç²¾åº¦ä¸º FP16ï¼Œé‚£ä¹ˆéœ€è¦ 350GB çš„å†…å­˜æ‰èƒ½å®Œå…¨åŠ è½½æ¨¡å‹ã€‚ä½†æ˜¯ï¼Œ<a href="https://www.nvidia.com/en-us/design-visualization/rtx-a6000/">A6000</a> æ˜¾å¡çš„å†…å­˜æ˜¯ 48GBï¼Œæœ€æ–°çš„ <a href="https://www.nvidia.com/en-us/data-center/a100/">A100</a> æ˜¾å¡çš„å†…å­˜å¯ä»¥è¾¾åˆ° 80GBï¼Œç”±æ­¤å¯ä»¥çœ‹å‡ºï¼Œå•å— GPU æ— æ³•åŠ è½½ 1750 äº¿å‚æ•°çš„ GPT-3 å¹¶ä½¿å…¶è¿è¡Œã€‚</p>
<p>åŒæ—¶ï¼Œå¦‚å‰æ‰€è¿°ï¼Œå¤§å‹è¯­è¨€æ¨¡å‹åœ¨æ¨ç†é˜¶æ®µçš„ååé‡â€”â€”å°¤å…¶æ˜¯ <code>decode é˜¶æ®µ</code> çš„ååé‡å—é™äº GPU ä¸Šçš„ <code>batch size</code> çš„æœ€å¤§å€¼ã€‚å¦‚æœæ¨¡å‹å¯ä»¥å¹¶è¡Œï¼Œå¹¶å°†æ¨¡å‹çš„æƒé‡å‚æ•°åˆ†æ•£åˆ°å¤šä¸ª GPU ä¸Šï¼Œé‚£ä¹ˆå°±å¯ä»¥é‡Šæ”¾å•ä¸ª GPU çš„å†…å­˜ä»¥æ”¯æŒæ›´å¤§çš„ <code>batch size</code>ï¼Œè¿›è€Œæé«˜æ¨¡å‹çš„æ¨ç†æ•ˆç‡å’Œååã€‚ç›®å‰ä¸»è¦æœ‰ä¸¤ç§æ–¹æ¡ˆæ¥å®ç°æ¨¡å‹å¹¶è¡Œï¼štensor-parallelism(<em>TP</em>) å’Œ pipeline-parallelism(<em>PP</em>)<sup class="footnote-ref"><a href="#fn5" id="fnref5">[5]</a></sup>ã€‚</p>
<p><code>tensor-parallelism</code> æŠŠæ¨¡å‹çš„æ¯ä¸€å±‚çš„æƒé‡åˆ†æ•£åˆ°ä¸åŒçš„ GPU ä¸Šï¼Œæ¯ä¸ª GPU éƒ½å°†åŒ…å«æ¨¡å‹çš„æ‰€æœ‰å±‚ï¼Œåªæ˜¯æ¯ä¸€å±‚çš„å‚æ•°æƒé‡ä¼šé™ä½ã€‚æ­¤æ—¶ï¼Œæ¨¡å‹çš„æƒé‡å’Œ <code>KV ç¼“å­˜</code> ä¹Ÿä¼šå¹³å‡åˆ†é…åˆ°å„ä¸ª GPU èŠ‚ç‚¹ï¼Œä»è€Œä½¿å¾—æ¯ä¸ª GPU çš„ <code>batch size</code> å¯ä»¥æ€§æ‰©å±•ã€‚æˆ‘ä»¬å¯ä»¥æŠŠæ¨¡å‹ä¸­æŸä¸€å±‚æ¶‰åŠåˆ°çš„æƒé‡åˆ†æ•£åˆ° 2 ä¸ª GPU ä¸Šï¼Œå…¶è®¡ç®—è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤º<sup class="footnote-ref"><a href="#fn6" id="fnref6">[6]</a></sup>ã€‚</p>
<p><img src="/2024/11/16/The-LLMs-Runtime-Inference-and-KV-Cache/17320000591724.jpg" alt><br>
ä¾‹å¦‚ï¼Œå¯ä»¥é‡‡ç”¨ <code>tensor-parallelism</code> æŠŠ GPT-3 éƒ¨ç½²åˆ° 20 ä¸ª <a href="https://www.nvidia.com/en-us/design-visualization/rtx-a6000/">A6000</a> GPUï¼Œæ¯ä¸ª GPU åªéœ€ 17.5 GB çš„å†…å­˜å°±å¯ä»¥å­˜å‚¨æ¨¡å‹å‚æ•°ï¼Œè€Œå‰©ä½™çš„å†…å­˜åˆ™å¯ç”¨äºä¸åŒ <code>batch size</code> çš„ç”¨æˆ·è¯·æ±‚å’Œ <code>KV ç¼“å­˜</code>ï¼Œä»è€Œä½¿å¾—å•ä¸ª GPU çš„ <code>batch size</code> å¯ä»¥çº¿æ€§å¢åŠ ã€‚</p>
<p>ç„¶è€Œï¼Œç”±äºæ¨¡å‹çš„æ¯å±‚æœ‰ä¸¤æ¬¡ <a href="https://docs.nvidia.com/deeplearning/nccl/user-guide/docs/usage/collectives.html"><code>all-reduce</code> æ“ä½œ</a><sup class="footnote-ref"><a href="#fn7" id="fnref7">[7]</a></sup>ï¼ˆä¸€æ¬¡åœ¨æ³¨æ„åŠ›è®¡ç®—ï¼Œå¦ä¸€æ¬¡åœ¨å‰å‘ç¥ç»ç½‘ç»œï¼‰ï¼Œè¿™æ— ç–‘å¸¦æ¥äº†å¾ˆé«˜çš„é€šä¿¡æˆæœ¬ã€‚</p>
<p><code>pipeline-parallelism</code> ä¸»è¦ç”¨äºå¤§è¯­è¨€æ¨¡å‹çš„è·¨èŠ‚ç‚¹éƒ¨ç½²ï¼Œä¸ <code>tensor-parallelism</code> ç›¸æ¯”ï¼Œ<code>pipeline-parallelism</code> æŒ‰å±‚å¯¹æ¨¡å‹è¿›è¡Œæ‹†åˆ†ï¼Œå…¶ä¸­æ¯ä¸ª GPU è´Ÿè´£æ¨¡å‹ä¸­çš„éƒ¨åˆ†å±‚çš„å…¨éƒ¨è®¡ç®—ï¼Œå¹¶ä¸”åŒ…å«è¿™äº›å±‚çš„æ‰€æœ‰å‚æ•°æƒé‡ã€‚<code>pipeline-parallelism</code> çš„ç¤ºæ„å›¾å¦‚ä¸‹æ‰€ç¤º<sup class="footnote-ref"><a href="#fn5" id="fnref5:1">[5:1]</a></sup>ï¼š</p>
<p><img src="/2024/11/16/The-LLMs-Runtime-Inference-and-KV-Cache/17320030900440.jpg" alt></p>
<p>ä¾‹å¦‚ï¼Œå¯ä»¥é‡‡ç”¨ <code>pipeline-parallelism</code> æŠŠ GPT-3 éƒ¨ç½²åˆ° 12 ä¸ª <a href="https://www.nvidia.com/en-us/design-visualization/rtx-a6000/">A6000</a> GPUï¼Œæ¯ä¸ª GPU åªéœ€è¦è´Ÿè´£å…¶ä¸­ 8 å±‚çš„è®¡ç®—ï¼Œé€šè¿‡è¿™ç§æ–¹å¼æ¥é‡Šæ”¾ GPU çš„å†…å­˜ä»è€Œæå‡å•ä¸ª GPU çš„ <code>batch size</code>ã€‚</p>
<p>åœ¨ <code>pipeline-parallelism</code> ä¸­ï¼Œä¸ºäº†ä½¿æµæ°´çº¿ä¸­çš„æ‰€æœ‰ GPU éƒ½ä¿æŒå¿™ç¢Œï¼Œè¿˜ä¼šé‡‡ç”¨ <code>micro-batching</code> æŠ€æœ¯<sup class="footnote-ref"><a href="#fn8" id="fnref8">[8]</a></sup>ã€‚ä¸ <code>tensor-parallelism</code> ç›¸æ¯”ï¼Œ<code>pipeline-parallelism</code> åªéœ€è¦é€šè¿‡ç‚¹å¯¹ç‚¹çš„æ–¹å¼ä¸ºå¤šå±‚è®¡ç®—å‘é€ä¸€æ¬¡æœ€ç»ˆè®¡ç®—ç»“æœï¼Œå› æ­¤ <code>pipeline-parallelism</code> å…·æœ‰æ›´å¥½çš„è®¡ç®—é€šä¿¡æ¯”ä¼˜åŠ¿ã€‚å› æ­¤ï¼Œå½“ GPU é›†ç¾¤ä¸­ç¼ºä¹åƒ <a href="https://www.nvidia.com/en-us/design-visualization/nvlink-bridges/">NVLink</a> è¿™æ ·çš„é«˜é€Ÿè¿æ¥é€šé“æ—¶ï¼Œ<code>pipeline-parallelism</code> æ˜¯ç›®å‰å”¯ä¸€å¯è¡Œçš„æ¨¡å‹å¹¶è¡Œæ–¹æ³•ã€‚</p>
<p><code>tensor-parallelism</code> å’Œ <code>pipeline-parallelism</code> ä¹‹é—´çš„ä¸åŒå¯ä»¥å‚è§ä¸‹å›¾<sup class="footnote-ref"><a href="#fn9" id="fnref9">[9]</a></sup>ï¼š</p>
<p><img src="/2024/11/16/The-LLMs-Runtime-Inference-and-KV-Cache/17320028806804.jpg" alt></p>
<h2 id="æ€§èƒ½æŒ‡æ ‡">æ€§èƒ½æŒ‡æ ‡</h2>
<p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œé€šå¸¸ä¼šé€šè¿‡å¹¶è¡ŒåŒ–æŠ€æœ¯å°†å¤§æ¨¡å‹éƒ¨ç½²åœ¨å¤šä¸ª GPU ç»“ç‚¹ã€‚ä¸ºäº†æå‡ç”¨æˆ·ä½“éªŒï¼Œåœ¨å®é™…å“åº”ç”¨æˆ·è¯·æ±‚æ—¶ï¼Œä¹Ÿä¼šé€šè¿‡æ‰¹å¤„ç†å’Œæ¨ç†é˜¶æ®µæ‹†åˆ†ç­‰æŠ€æœ¯æå‡æ•´ä½“ç³»ç»Ÿçš„æ€§èƒ½ã€‚</p>
<p>å¦‚å‰æ‰€è¿°ï¼Œ<code>prefill é˜¶æ®µ</code> å’Œ <code>decode é˜¶æ®µ</code> å¯¹äº GPU çš„è´Ÿè½½ä»¥åŠæ‰¹å¤„ç†çš„ <code>batch size</code> å¤§å°å¹¶ä¸ç›¸åŒï¼Œä¸åŒé˜¶æ®µæœ‰å„è‡ªçš„ç‰¹ç‚¹ï¼Œå¹¶ä¸” <code>prefill é˜¶æ®µ</code> ä¸»è¦å½±å“ <code>First Token</code> çš„æ€§èƒ½ï¼Œè€Œ <code>decode é˜¶æ®µ</code> åˆ™ä¸»è¦å½±å“ç³»ç»Ÿçš„å†…å­˜å’Œååï¼Œè¿›è€Œå½±å“åç»­ token çš„ç”Ÿæˆæ€§èƒ½ã€‚å› æ­¤ï¼Œåœ¨è¯„ä¼°å¤§æ¨¡å‹çš„æ€§èƒ½æŒ‡æ ‡æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ç»¼åˆè€ƒè™‘è¿™äº›å› ç´ ï¼Œæ¥è®¾è®¡å¯¹åº”çš„æŒ‡æ ‡ï¼Œè¿™æ ·æ‰èƒ½ä»ç³»ç»Ÿå±‚é¢åšæ›´å¥½çš„ä¼˜åŒ–ã€‚</p>
<p>ä»ç”¨æˆ·è¯·æ±‚å±‚é¢æ¥çœ‹ï¼Œå¤§æ¨¡å‹æœåŠ¡å“åº”ç”¨æˆ·çš„è¯·æ±‚æµç¨‹å¦‚ä¸‹æ‰€ç¤º<sup class="footnote-ref"><a href="#fn10" id="fnref10">[10]</a></sup>ï¼š</p>
<p><img src="/2024/11/16/The-LLMs-Runtime-Inference-and-KV-Cache/17320781354210.jpg" alt></p>
<p>æ‰€ä»¥ï¼Œè¯„ä¼°å¤§æ¨¡å‹çš„æ€§èƒ½æŒ‡æ ‡ä¸»è¦æœ‰ï¼š</p>
<ul>
<li>
<p>TTFTï¼ˆTime To First Tokenï¼‰ï¼šç”¨äºè¡¡é‡ä»ç”¨æˆ·å‘é€å®Œè¯·æ±‚åˆ°æ¥æ”¶åˆ°ç¬¬ä¸€ä¸ª token æ‰€ç”¨çš„æ—¶é—´ï¼Œå¯ä»¥ç”¨è¯¥æŒ‡æ ‡è¯„ä¼° <code>prefill é˜¶æ®µ</code> çš„æ€§èƒ½ã€‚<br>
<img src="/2024/11/16/The-LLMs-Runtime-Inference-and-KV-Cache/17320783298264.jpg" alt="ç”Ÿæˆ First Token"></p>
</li>
<li>
<p>E2ELatencyï¼ˆEnd-to-End Latencyï¼‰ï¼šç”¨äºè¡¡é‡ä»ç”¨æˆ·å‘é€å®Œè¯·æ±‚åˆ°æ¥å—åˆ°æœ€åä¸€ä¸ª token æ‰€ç”¨çš„æ€»æ—¶é—´ã€‚<br>
<img src="/2024/11/16/The-LLMs-Runtime-Inference-and-KV-Cache/17320783489548.jpg" alt="ç”Ÿæˆæ‰€æœ‰ Token"></p>
</li>
<li>
<p>ITLï¼ˆInter-Token Latencyï¼‰ï¼šç”¨äºè¡¡é‡ <code>decode é˜¶æ®µ</code> ç”Ÿæˆçš„ token ä¹‹é—´çš„æ—¶é—´ï¼Œå¯ä»¥ç”¨æ¥è¯„ä¼°æµå¼è¾“å‡ºè¿‡ç¨‹æ˜¯å¦å­˜åœ¨å¡é¡¿ã€‚ITL çš„è®¡ç®—æ–¹å¼ä¸ºï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mi>T</mi><mi>L</mi><mo>=</mo><mfrac><mtext>E2ELatencyÂ -Â TTFT</mtext><mrow><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><mi>l</mi><mi>O</mi><mi>u</mi><mi>t</mi><mi>p</mi><mi>u</mi><mi>t</mi><mi>T</mi><mi>o</mi><mi>k</mi><mi>e</mi><mi>n</mi><mi>s</mi><mo>âˆ’</mo><mn>1</mn></mrow></mfrac></mrow><annotation encoding="application/x-tex">ITL = \frac{\text{E2ELatency - TTFT}}{TotalOutputTokens - 1}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord mathdefault">L</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.24077em;vertical-align:-0.8804400000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603299999999998em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord mathdefault">o</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord mathdefault">u</span><span class="mord mathdefault">t</span><span class="mord mathdefault">p</span><span class="mord mathdefault">u</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">E2ELatencyÂ -Â TTFT</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
</li>
<li>
<p>TPOTï¼ˆTime Per Output Tokenï¼‰ï¼šä¸ä¸Šé¢ä»‹ç»çš„å¹³å‡ ITL çš„æ¦‚å¿µæ˜¯ä¸€è‡´çš„ã€‚</p>
</li>
<li>
<p>RPSï¼ˆRequests Per Secondï¼‰ï¼šç”¨äºè¡¡é‡ç³»ç»Ÿæ¯ç§’å¯ä»¥ç›¸åº”çš„è¯·æ±‚æ€»æ•°ï¼Œå¯ä»¥ç”¨æ¥è¯„ä¼°ç³»ç»Ÿçš„ååã€‚</p>
</li>
<li>
<p>TPSï¼ˆTokens Per Secondï¼‰ï¼šç”¨æˆ·è¡¡é‡ç³»ç»Ÿæ¯ç§’å¯ä»¥ç”Ÿæˆçš„ tokenæ˜¯æ€»æ•°ï¼Œå¯ä»¥å’Œ RPS ä¸€èµ·æ¥è¯„ä¼°ç³»ç»Ÿæ•´ä½“çš„ååå’Œæ€§èƒ½ã€‚</p>
</li>
</ul>
<h2 id="isl-osl">ISL &amp; OSL</h2>
<p>åœ¨ç³»ç»Ÿå±‚é¢æ¥è¯´ï¼Œéœ€è¦ç‰¹åˆ«å…³æ³¨ç”¨æˆ·è¯·æ±‚çš„è¾“å…¥ã€è¾“å‡º tokens æ•°é‡çš„ç‰¹æ€§ï¼š</p>
<ul>
<li>
<p>æ›´é•¿çš„è¾“å…¥ promptï¼ˆISL: Input Sequence Lengthï¼‰ä¼šå¯¼è‡´ <code>prefill é˜¶æ®µ</code> çš„è®¡ç®—é‡æ›´å¤§ï¼Œè¿›è€Œå¸¦æ¥æ›´å¤§çš„ TTFTã€‚<br>
<img src="/2024/11/16/The-LLMs-Runtime-Inference-and-KV-Cache/17320800431179.jpg" alt="From https://pytorch2024.sched.com/event/1fHnQ/understanding-the-llm-inference-workload-mark-moyou-nvidia"></p>
</li>
<li>
<p>æ›´é•¿çš„è¾“å‡º tokensï¼ˆOSL: Output Sequence Lengthï¼‰ä¼šå¯¼è‡´ GPU é•¿æ—¶é—´æ¶ˆè€— <code>KV ç¼“å­˜</code>ï¼Œè¿›è€Œå ç”¨æ›´å¤šçš„ç³»ç»Ÿèµ„æºï¼Œå¹¶ä¸æ–­é™ä½ç³»ç»Ÿçš„æ•´ä½“ååã€‚</p>
</li>
</ul>
<p>ä¸€èˆ¬è€Œè¨€ï¼Œå¯ä»¥æ ¹æ® ISL å’Œ OSL å°†ç”¨æˆ·è¯·æ±‚åˆ†ä¸ºå¦‚ä¸‹çš„å››ç§ç±»å‹<sup class="footnote-ref"><a href="#fn11" id="fnref11">[11]</a></sup>ï¼š</p>
<ul>
<li>LISOï¼ˆLong Input Short Outputï¼‰ï¼šæ€»ç»“ä¼šè®®æ‘˜è¦ï¼Œæ€»ç»“è¾ƒé•¿æ–‡ç« çš„æ ¸å¿ƒè§‚ç‚¹ç­‰åœºæ™¯ã€‚</li>
<li>LILOï¼ˆLong Input Long Outputï¼‰ï¼šç¿»è¯‘ï¼Œæ–‡ç« æ¶¦è‰²ï¼Œä»£ç ä¿®æ”¹ç­‰åœºæ™¯ã€‚</li>
<li>SILOï¼ˆShort Input Long Outputï¼‰ï¼šæ–‡æœ¬åˆ›ä½œâ€”â€”ä»¥åŒ—äº¬çš„ç§‹å¤©ä¸ºé¢˜å†™ä¸€ç¯‡ 300 å­—çš„ä½œæ–‡ã€‚</li>
<li>SISOï¼ˆShort Input Short Outputï¼‰ï¼šé—®ç­”åœºæ™¯â€”â€”A100 GPU çš„å†…å­˜è§„æ ¼ã€‚</li>
</ul>
<p><img src="/2024/11/16/The-LLMs-Runtime-Inference-and-KV-Cache/17320806601823.jpg" alt="From https://pytorch2024.sched.com/event/1fHnQ/understanding-the-llm-inference-workload-mark-moyou-nvidia"></p>
<p>å¦‚æœä¸å¯¹ç”¨æˆ·è¯·æ±‚ç±»å‹è¿›è¡Œåˆç†çš„è°ƒåº¦ï¼Œå°±ä¼šå½¢æˆå¦‚ä¸‹æ‰€ç¤ºçš„æƒ…å†µï¼Œå¹¶æœ€ç»ˆå½±å“æ•´ä½“çš„ç”¨æˆ·ä½“éªŒã€‚<br>
<img src="/2024/11/16/The-LLMs-Runtime-Inference-and-KV-Cache/17320807534949.jpg" alt="From https://pytorch2024.sched.com/event/1fHnQ/understanding-the-llm-inference-workload-mark-moyou-nvidia"></p>
<h2 id="kv-ç¼“å­˜è¯¦è§£">KV ç¼“å­˜è¯¦è§£</h2>
<p>åœ¨ <em>Prefill &amp; Decode</em> éƒ¨åˆ†ï¼Œæˆ‘ä»¬æåˆ°äº† <code>KV ç¼“å­˜</code> å¹¶ç»™å‡ºäº†ä¸åŒæ¨¡å‹çš„å• token <code>KV ç¼“å­˜</code> å ç”¨çš„å†…å­˜ç©ºé—´ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥è¯¦ç»†ä»‹ç»ä¸‹ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ <code>KV ç¼“å­˜</code>ã€‚</p>
<p>åœ¨å¤§æ¨¡å‹çš„æ¨ç†è¿‡ç¨‹ä¸­ï¼Œå½“è§£ç å™¨ç”Ÿæˆä¸‹ä¸€ä¸ª token ä¹‹åï¼Œä¼šå°†è¯¥ token è¿½åŠ åˆ°åŸå§‹çš„ prompt ä¸­å¹¶é‡æ–°è¾“å…¥è§£ç å™¨å¹¶é¢„æµ‹ä¸‹ä¸€ä¸ª tokenã€‚å› æ­¤ï¼Œåœ¨ä¸€æ¬¡è¯·æ±‚ä¸­ï¼Œprompt çš„é•¿åº¦æ˜¯ä¸æ–­å¢åŠ çš„ï¼Œå¹¶ä¸”æ¯æ¬¡æ¨ç†éƒ½ä¼šé‡æ–°è®¡ç®—å¦‚ä¸‹æ‰€ç¤ºçš„æ³¨æ„åŠ›ã€‚</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Attention</mtext><mo stretchy="false">(</mo><mi mathvariant="bold">Q</mi><mo separator="true">,</mo><mi mathvariant="bold">K</mi><mo separator="true">,</mo><mi mathvariant="bold">V</mi><mo stretchy="false">)</mo><mo>=</mo><mtext>softmax</mtext><mrow><mo fence="true">(</mo><mfrac><mrow><mi mathvariant="bold">Q</mi><msup><mi mathvariant="bold">K</mi><mi>T</mi></msup></mrow><msqrt><msub><mi>d</mi><mi>k</mi></msub></msqrt></mfrac><mo fence="true">)</mo></mrow><mi mathvariant="bold">V</mi></mrow><annotation encoding="application/x-tex">\text{Attention}(\mathbf{Q},\mathbf{K},\mathbf{V})=\text{softmax}\left(\frac{\mathbf{Q}\mathbf{K}^T}{\sqrt{d_k}}\right)\mathbf{V}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Attention</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">Q</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf">K</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.468361em;vertical-align:-0.95003em;"></span><span class="mord text"><span class="mord">softmax</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5183309999999999em;"><span style="top:-2.25278em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85722em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.81722em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.18278000000000005em;"><span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">Q</span></span><span class="mord"><span class="mord"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.93em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span></span></span></span></span></p>
<p>å…¶ä¸­ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">Q</mi><mo separator="true">,</mo><mi mathvariant="bold">K</mi><mo separator="true">,</mo><mi mathvariant="bold">V</mi><mo>âˆˆ</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mi>L</mi><mo>Ã—</mo><msub><mi>d</mi><mrow><mi>h</mi><mi>e</mi><mi>a</mi><mi>d</mi></mrow></msub></mrow></msup></mrow><annotation encoding="application/x-tex">\mathbf{Q}, \mathbf{K}, \mathbf{V} \in \mathbb{R}^{L \times d_{head}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8805499999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathbf">Q</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf">K</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8491079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">L</span><span class="mbin mtight">Ã—</span><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">d</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>ã€‚</p>
<p>æˆ‘ä»¬å°†å¯¹åº”çš„çŸ©é˜µè½¬æ¢æˆå‘é‡çš„å‘é‡çš„è¡¨ç¤ºæ–¹å¼ï¼Œä¾‹å¦‚ï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">Q</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>q</mi><mn>11</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>q</mi><mn>12</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">â‹¯</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>q</mi><mrow><mn>1</mn><msub><mi>d</mi><mrow><mi>h</mi><mi>e</mi><mi>a</mi><mi>d</mi></mrow></msub></mrow></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>q</mi><mn>21</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>q</mi><mn>22</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">â‹¯</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>q</mi><mrow><mn>2</mn><msub><mi>d</mi><mrow><mi>h</mi><mi>e</mi><mi>a</mi><mi>d</mi></mrow></msub></mrow></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>q</mi><mrow><mi>L</mi><mn>1</mn></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>q</mi><mrow><mi>L</mi><mn>2</mn></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">â‹¯</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>q</mi><mrow><mi>L</mi><msub><mi>d</mi><mrow><mi>h</mi><mi>e</mi><mi>a</mi><mi>d</mi></mrow></msub></mrow></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="bold">q</mi><mn>1</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="bold">q</mi><mn>2</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="bold">q</mi><mi>L</mi></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{Q} = \begin{bmatrix}
q_{11} &amp; q_{12} &amp; \cdots &amp; q_{1d_{head}} \\
q_{21} &amp; q_{22} &amp; \cdots &amp; q_{2d_{head}} \\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
q_{L1} &amp; q_{L2} &amp; \cdots &amp; q_{Ld_{head}}
\end{bmatrix} =
\begin{bmatrix}
\mathbf{q}_1 \\
\mathbf{q}_2 \\
\vdots \\
\mathbf{q}_L
\end{bmatrix}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8805499999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathbf">Q</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:5.459999999999999em;vertical-align:-2.4799999999999995em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.953995em;"><span style="top:-1.3499850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.4999850000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.0959850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.6919850000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.712975em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-4.953995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4500349999999997em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9799999999999995em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7674999999999996em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675000000000006em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">L</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9799999999999995em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7674999999999996em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675000000000006em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">L</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9799999999999995em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="minner">â‹¯</span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="minner">â‹¯</span></span></span><span style="top:-2.7674999999999996em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675000000000006em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="minner">â‹¯</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9799999999999995em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999985em;"><span style="top:-2.55em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">d</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.25586em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999985em;"><span style="top:-2.55em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">d</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.25586em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7674999999999996em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675000000000006em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999985em;"><span style="top:-2.55em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">L</span><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">d</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.25586em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.953995em;"><span style="top:-1.3499850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.4999850000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.0959850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.6919850000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.712975em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-4.953995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4500349999999997em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:5.459999999999999em;vertical-align:-2.4799999999999995em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.953995em;"><span style="top:-1.3499850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.4999850000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.0959850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.6919850000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.712975em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-4.953995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4500349999999997em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9799999999999995em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7674999999999996em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675000000000006em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.953995em;"><span style="top:-1.3499850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.4999850000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.0959850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.6919850000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.712975em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-4.953995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4500349999999997em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>äºæ˜¯ï¼Œæˆ‘ä»¬å¾—åˆ°ï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">Q</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="bold">q</mi><mn>1</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="bold">q</mi><mn>2</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="bold">q</mi><mi>L</mi></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo separator="true">,</mo><mtext>Â </mtext><mi mathvariant="bold">K</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="bold">k</mi><mn>1</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="bold">k</mi><mn>2</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="bold">k</mi><mi>L</mi></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo separator="true">,</mo><mtext>Â </mtext><mi mathvariant="bold">V</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="bold">v</mi><mn>1</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="bold">v</mi><mn>2</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="bold">v</mi><mi>L</mi></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{Q} = 
\begin{bmatrix}
\mathbf{q}_1 \\
\mathbf{q}_2 \\
\vdots \\
\mathbf{q}_L
\end{bmatrix}, \ 
\mathbf{K} = 
\begin{bmatrix}
\mathbf{k}_1 \\
\mathbf{k}_2 \\
\vdots \\
\mathbf{k}_L
\end{bmatrix}, \ 
\mathbf{V} = 
\begin{bmatrix}
\mathbf{v}_1 \\
\mathbf{v}_2 \\
\vdots \\
\mathbf{v}_L
\end{bmatrix}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8805499999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathbf">Q</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:5.459999999999999em;vertical-align:-2.4799999999999995em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.953995em;"><span style="top:-1.3499850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.4999850000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.0959850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.6919850000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.712975em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-4.953995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4500349999999997em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9799999999999995em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7674999999999996em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675000000000006em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.953995em;"><span style="top:-1.3499850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.4999850000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.0959850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.6919850000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.712975em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-4.953995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4500349999999997em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace">Â </span><span class="mord"><span class="mord mathbf">K</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:5.459999999999999em;vertical-align:-2.4799999999999995em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.953995em;"><span style="top:-1.3499850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.4999850000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.0959850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.6919850000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.712975em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-4.953995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4500349999999997em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9799999999999995em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7674999999999996em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675000000000006em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.953995em;"><span style="top:-1.3499850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.4999850000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.0959850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.6919850000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.712975em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-4.953995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4500349999999997em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace">Â </span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:5.459999999999999em;vertical-align:-2.4799999999999995em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.953995em;"><span style="top:-1.3499850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.4999850000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.0959850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.6919850000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.712975em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-4.953995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4500349999999997em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9799999999999995em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7674999999999996em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675000000000006em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.953995em;"><span style="top:-1.3499850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.4999850000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.0959850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.6919850000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.712975em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-4.953995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4500349999999997em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>å…¶ä¸­ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">q</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">k</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">v</mi><mi>i</mi></msub><mo>âˆˆ</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mn>1</mn><mo>Ã—</mo><msub><mi>d</mi><mrow><mi>h</mi><mi>e</mi><mi>a</mi><mi>d</mi></mrow></msub></mrow></msup></mrow><annotation encoding="application/x-tex">\mathbf{q}_i, \mathbf{k}_i, \mathbf{v}_i \in \mathbb{R}^{1 \times d_{head}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8491079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">Ã—</span><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">d</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>â‹¯</mo><mi>L</mi></mrow><annotation encoding="application/x-tex">i = 1 \cdots L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">L</span></span></span></span>ã€‚</p>
<p>äºæ˜¯ï¼Œæƒé‡çš„è®¡ç®—å¯ä»¥è¡¨ç¤ºä¸ºå¦‚ä¸‹çš„å½¢å¼ï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">Q</mi><msup><mi mathvariant="bold">K</mi><mi>T</mi></msup><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="bold">q</mi><mn>1</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="bold">q</mi><mn>2</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="bold">q</mi><mi>L</mi></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msubsup><mi mathvariant="bold">k</mi><mn>1</mn><mi>T</mi></msubsup><mo separator="true">,</mo><msubsup><mi mathvariant="bold">k</mi><mn>2</mn><mi>T</mi></msubsup><mo separator="true">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator="true">,</mo><msubsup><mi mathvariant="bold">k</mi><mi>L</mi><mi>T</mi></msubsup></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi mathvariant="bold">q</mi><mn>1</mn></msub><mo>â‹…</mo><msub><mi mathvariant="bold">k</mi><mn>1</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi mathvariant="bold">q</mi><mn>1</mn></msub><mo>â‹…</mo><msub><mi mathvariant="bold">k</mi><mn>2</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">â‹¯</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi mathvariant="bold">q</mi><mn>1</mn></msub><mo>â‹…</mo><msub><mi mathvariant="bold">k</mi><mi>L</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi mathvariant="bold">q</mi><mn>2</mn></msub><mo>â‹…</mo><msub><mi mathvariant="bold">k</mi><mn>1</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi mathvariant="bold">q</mi><mn>2</mn></msub><mo>â‹…</mo><msub><mi mathvariant="bold">k</mi><mn>2</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">â‹¯</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi mathvariant="bold">q</mi><mn>2</mn></msub><mo>â‹…</mo><msub><mi mathvariant="bold">k</mi><mi>L</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi mathvariant="bold">q</mi><mi>L</mi></msub><mo>â‹…</mo><msub><mi mathvariant="bold">k</mi><mn>1</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi mathvariant="bold">q</mi><mi>L</mi></msub><mo>â‹…</mo><msub><mi mathvariant="bold">k</mi><mn>2</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">â‹¯</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi mathvariant="bold">q</mi><mi>L</mi></msub><mo>â‹…</mo><msub><mi mathvariant="bold">k</mi><mi>L</mi></msub></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{Q}\mathbf{K}^T = \begin{bmatrix}
\mathbf{q}_1 \\
\mathbf{q}_2 \\
\vdots \\
\mathbf{q}_L
\end{bmatrix} 
\begin{bmatrix}
\mathbf{k}_1^T, 
\mathbf{k}_2^T, \cdots,\mathbf{k}_L^T
\end{bmatrix} = 
\begin{bmatrix}
\mathbf{q}_1 \cdot \mathbf{k}_1 &amp; \mathbf{q}_1 \cdot \mathbf{k}_2 &amp; \cdots &amp; \mathbf{q}_1 \cdot \mathbf{k}_L \\
\mathbf{q}_2 \cdot \mathbf{k}_1 &amp; \mathbf{q}_2 \cdot \mathbf{k}_2 &amp; \cdots &amp; \mathbf{q}_2 \cdot \mathbf{k}_L \\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
\mathbf{q}_L \cdot \mathbf{k}_1 &amp; \mathbf{q}_L \cdot \mathbf{k}_2 &amp; \cdots &amp; \mathbf{q}_L \cdot \mathbf{k}_L
\end{bmatrix}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0857709999999998em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathbf">Q</span></span><span class="mord"><span class="mord"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:5.459999999999999em;vertical-align:-2.4799999999999995em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.953995em;"><span style="top:-1.3499850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.4999850000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.0959850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.6919850000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.712975em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-4.953995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4500349999999997em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9799999999999995em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7674999999999996em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675000000000006em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.953995em;"><span style="top:-1.3499850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.4999850000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.0959850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.6919850000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.712975em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-4.953995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4500349999999997em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8506654999999999em;"><span style="top:-3.0093345em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-2.4518920000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.24810799999999997em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-2.4518920000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.24810799999999997em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-2.424669em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.275331em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3506655em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:5.459999999999999em;vertical-align:-2.4799999999999995em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.953995em;"><span style="top:-1.3499850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.4999850000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.0959850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.6919850000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.712975em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-4.953995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4500349999999997em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9799999999999995em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7674999999999996em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675000000000006em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9799999999999995em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7674999999999996em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675000000000006em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9799999999999995em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="minner">â‹¯</span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="minner">â‹¯</span></span></span><span style="top:-2.7674999999999996em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675000000000006em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="minner">â‹¯</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9799999999999995em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7674999999999996em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675000000000006em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.953995em;"><span style="top:-1.3499850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.4999850000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.0959850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.6919850000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.712975em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-4.953995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4500349999999997em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>å› ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msqrt><msub><mi>d</mi><mi>k</mi></msub></msqrt></mrow><annotation encoding="application/x-tex">\sqrt{d_k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.18278000000000005em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85722em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.81722em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.18278000000000005em;"><span></span></span></span></span></span></span></span></span> æ˜¯ä¸€ä¸ªå¸¸æ•°ï¼Œå› æ­¤åœ¨è®¡ç®— <code>softmax()</code> æ—¶ï¼Œå¯ä»¥å…ˆå¿½ç•¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msqrt><msub><mi>d</mi><mi>k</mi></msub></msqrt></mrow><annotation encoding="application/x-tex">\sqrt{d_k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.18278000000000005em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85722em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.81722em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.18278000000000005em;"><span></span></span></span></span></span></span></span></span>ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸ºäº†åˆ†ææ–¹ä¾¿ï¼Œæˆ‘ä»¬ä»¤</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Attention</mtext><mo stretchy="false">(</mo><mi mathvariant="bold">Q</mi><mo separator="true">,</mo><mi mathvariant="bold">K</mi><mo separator="true">,</mo><mi mathvariant="bold">V</mi><mo stretchy="false">)</mo><mo>=</mo><mi>S</mi><mrow><mo fence="true">(</mo><mi mathvariant="bold">Q</mi><msup><mi mathvariant="bold">K</mi><mi mathvariant="bold">T</mi></msup><mo fence="true">)</mo></mrow><mi mathvariant="bold">V</mi></mrow><annotation encoding="application/x-tex">\text{Attention}(\mathbf{Q},\mathbf{K},\mathbf{V})=S\left(\mathbf{Q}\mathbf{K^T}\right)\mathbf{V}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Attention</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">Q</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf">K</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2432869999999998em;vertical-align:-0.35001em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathbf">Q</span></span><span class="mord"><span class="mord"><span class="mord mathbf">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8932769999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">T</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span></span></span></span></span></p>
<p>æ¥æ›¿æ¢è‡ªæ³¨æ„åŠ›æœºåˆ¶çš„è®¡ç®—ã€‚</p>
<p>äºæ˜¯ï¼Œæˆ‘ä»¬å¾—åˆ°å¦‚ä¸‹çš„ç»“æœï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>S</mi><mrow><mo fence="true">(</mo><mi mathvariant="bold">Q</mi><msup><mi mathvariant="bold">K</mi><mi mathvariant="bold">T</mi></msup><mo fence="true">)</mo></mrow><mi mathvariant="bold">V</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>S</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">q</mi><mn>1</mn></msub><mo>â‹…</mo><msub><mi mathvariant="bold">k</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>S</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">q</mi><mn>1</mn></msub><mo>â‹…</mo><msub><mi mathvariant="bold">k</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">â‹¯</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>S</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">q</mi><mn>1</mn></msub><mo>â‹…</mo><msub><mi mathvariant="bold">k</mi><mi>L</mi></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>S</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">q</mi><mn>2</mn></msub><mo>â‹…</mo><msub><mi mathvariant="bold">k</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>S</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">q</mi><mn>2</mn></msub><mo>â‹…</mo><msub><mi mathvariant="bold">k</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">â‹¯</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>S</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">q</mi><mn>2</mn></msub><mo>â‹…</mo><msub><mi mathvariant="bold">k</mi><mi>L</mi></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>S</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">q</mi><mi>L</mi></msub><mo>â‹…</mo><msub><mi mathvariant="bold">k</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>S</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">q</mi><mi>L</mi></msub><mo>â‹…</mo><msub><mi mathvariant="bold">k</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">â‹¯</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>S</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">q</mi><mi>L</mi></msub><mo>â‹…</mo><msub><mi mathvariant="bold">k</mi><mi>L</mi></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="bold">v</mi><mn>1</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="bold">v</mi><mn>2</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="bold">v</mi><mi>L</mi></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>S</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">q</mi><mn>1</mn></msub><mo>â‹…</mo><msub><mi mathvariant="bold">k</mi><mn>1</mn></msub><mo stretchy="false">)</mo><msub><mi mathvariant="bold">v</mi><mn>1</mn></msub><mo>+</mo><mi>S</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">q</mi><mn>1</mn></msub><mo>â‹…</mo><msub><mi mathvariant="bold">k</mi><mn>2</mn></msub><mo stretchy="false">)</mo><msub><mi mathvariant="bold">v</mi><mn mathvariant="bold">2</mn></msub><mo>+</mo><mo>â‹¯</mo><mo>+</mo><mi>S</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">q</mi><mn>1</mn></msub><mo>â‹…</mo><msub><mi mathvariant="bold">k</mi><mi>L</mi></msub><mo stretchy="false">)</mo><msub><mi mathvariant="bold">v</mi><mi>L</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>S</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">q</mi><mn>2</mn></msub><mo>â‹…</mo><msub><mi mathvariant="bold">k</mi><mn>1</mn></msub><mo stretchy="false">)</mo><msub><mi mathvariant="bold">v</mi><mn>1</mn></msub><mo>+</mo><mi>S</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">q</mi><mn>2</mn></msub><mo>â‹…</mo><msub><mi mathvariant="bold">k</mi><mn>2</mn></msub><mo stretchy="false">)</mo><msub><mi mathvariant="bold">v</mi><mn>2</mn></msub><mo>+</mo><mo>â‹¯</mo><mo>+</mo><mi>S</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">q</mi><mn>2</mn></msub><mo>â‹…</mo><msub><mi mathvariant="bold">k</mi><mi>L</mi></msub><mo stretchy="false">)</mo><msub><mi mathvariant="bold">v</mi><mi>L</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>S</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">q</mi><mi>L</mi></msub><mo>â‹…</mo><msub><mi mathvariant="bold">k</mi><mn>1</mn></msub><mo stretchy="false">)</mo><msub><mi mathvariant="bold">v</mi><mn>1</mn></msub><mo>+</mo><mi>S</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">q</mi><mi>L</mi></msub><mo>â‹…</mo><msub><mi mathvariant="bold">k</mi><mn>2</mn></msub><mo stretchy="false">)</mo><msub><mi mathvariant="bold">v</mi><mn>2</mn></msub><mo>+</mo><mo>â‹¯</mo><mo>+</mo><mi>S</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">q</mi><mi>L</mi></msub><mo>â‹…</mo><msub><mi mathvariant="bold">k</mi><mi>L</mi></msub><mo stretchy="false">)</mo><msub><mi mathvariant="bold">v</mi><mi>L</mi></msub></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
S\left(\mathbf{Q}\mathbf{K^T}\right)\mathbf{V} &amp;=
\begin{bmatrix}
S(\mathbf{q}_1 \cdot \mathbf{k}_1) &amp; S(\mathbf{q}_1 \cdot \mathbf{k}_2) &amp; \cdots &amp; S(\mathbf{q}_1 \cdot \mathbf{k}_L) \\
S(\mathbf{q}_2 \cdot \mathbf{k}_1) &amp; S(\mathbf{q}_2 \cdot \mathbf{k}_2) &amp; \cdots &amp; S(\mathbf{q}_2 \cdot \mathbf{k}_L) \\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
S(\mathbf{q}_L \cdot \mathbf{k}_1) &amp; S(\mathbf{q}_L \cdot \mathbf{k}_2) &amp; \cdots &amp; S(\mathbf{q}_L \cdot \mathbf{k}_L)
\end{bmatrix}
\begin{bmatrix}
\mathbf{v}_1 \\
\mathbf{v}_2 \\
\vdots \\
\mathbf{v}_L
\end{bmatrix} \\
\\
\\
&amp; = \begin{bmatrix}
S(\mathbf{q}_1 \cdot \mathbf{k}_1)\mathbf{v}_1 + S(\mathbf{q}_1 \cdot \mathbf{k}_2)\mathbf{v_2} + \cdots + S(\mathbf{q}_1 \cdot \mathbf{k}_L)\mathbf{v}_L \\
S(\mathbf{q}_2 \cdot \mathbf{k}_1)\mathbf{v}_1 + S(\mathbf{q}_2 \cdot \mathbf{k}_2)\mathbf{v}_2 + \cdots + S(\mathbf{q}_2 \cdot \mathbf{k}_L)\mathbf{v}_L \\
\vdots \\
S(\mathbf{q}_L \cdot \mathbf{k}_1)\mathbf{v}_1 + S(\mathbf{q}_L \cdot \mathbf{k}_2)\mathbf{v}_2 + \cdots + S(\mathbf{q}_L \cdot \mathbf{k}_L)\mathbf{v}_L
\end{bmatrix}
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:14.519999999999996em;vertical-align:-7.009999999999998em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:7.509999999999999em;"><span style="top:-9.509999999999998em;"><span class="pstrut" style="height:4.9799999999999995em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathbf">Q</span></span><span class="mord"><span class="mord"><span class="mord mathbf">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8932769999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">T</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span></span></span><span style="top:-5.89em;"><span class="pstrut" style="height:4.9799999999999995em;"></span><span class="mord"></span></span><span style="top:-4.389999999999999em;"><span class="pstrut" style="height:4.9799999999999995em;"></span><span class="mord"></span></span><span style="top:-0.7500000000000009em;"><span class="pstrut" style="height:4.9799999999999995em;"></span><span class="mord"></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:7.009999999999998em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:7.509999999999999em;"><span style="top:-9.509999999999998em;"><span class="pstrut" style="height:4.9799999999999995em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.953995em;"><span style="top:-1.3499850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.4999850000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.0959850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.6919850000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.712975em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-4.953995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4500349999999997em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9799999999999995em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-2.7674999999999996em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675000000000006em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9799999999999995em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-2.7674999999999996em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675000000000006em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9799999999999995em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="minner">â‹¯</span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="minner">â‹¯</span></span></span><span style="top:-2.7674999999999996em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675000000000006em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="minner">â‹¯</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9799999999999995em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-2.7674999999999996em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675000000000006em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.953995em;"><span style="top:-1.3499850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.4999850000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.0959850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.6919850000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.712975em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-4.953995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4500349999999997em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.953995em;"><span style="top:-1.3499850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.4999850000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.0959850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.6919850000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.712975em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-4.953995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4500349999999997em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9799999999999995em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7674999999999996em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675000000000006em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.953995em;"><span style="top:-1.3499850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.4999850000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.0959850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.6919850000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.712975em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-4.953995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4500349999999997em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-0.7500000000000018em;"><span class="pstrut" style="height:4.9799999999999995em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.953995em;"><span style="top:-1.3499850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.4999850000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.0959850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.6919850000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.712975em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-4.953995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4500349999999997em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9799999999999995em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.01597em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7674999999999996em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675000000000006em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.953995em;"><span style="top:-1.3499850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.4999850000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.0959850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.6919850000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.712975em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-4.953995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4500349999999997em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:7.009999999999997em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>å¦‚ä¸Šæ˜¯æ²¡æœ‰å¢åŠ  Causal Maskï¼ˆå› æœæ©ç ï¼‰<sup class="footnote-ref"><a href="#fn12" id="fnref12">[12]</a></sup>çš„æƒ…å†µï¼Œå½“å¢åŠ  Causal Mask ååˆ™ä¼šå˜æˆå¦‚ä¸‹çš„ç»“æœï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>S</mi><mrow><mo fence="true">(</mo><mi mathvariant="bold">Q</mi><msup><mi mathvariant="bold">K</mi><mi mathvariant="bold">T</mi></msup><mo fence="true">)</mo></mrow><mi mathvariant="bold">V</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>S</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">q</mi><mn>1</mn></msub><mo>â‹…</mo><msub><mi mathvariant="bold">k</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">â‹¯</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>S</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">q</mi><mn>2</mn></msub><mo>â‹…</mo><msub><mi mathvariant="bold">k</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>S</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">q</mi><mn>2</mn></msub><mo>â‹…</mo><msub><mi mathvariant="bold">k</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">â‹¯</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>S</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">q</mi><mi>L</mi></msub><mo>â‹…</mo><msub><mi mathvariant="bold">k</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>S</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">q</mi><mi>L</mi></msub><mo>â‹…</mo><msub><mi mathvariant="bold">k</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">â‹¯</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>S</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">q</mi><mi>L</mi></msub><mo>â‹…</mo><msub><mi mathvariant="bold">k</mi><mi>L</mi></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="bold">v</mi><mn>1</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="bold">v</mi><mn>2</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="bold">v</mi><mi>L</mi></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>S</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">q</mi><mn>1</mn></msub><mo>â‹…</mo><msub><mi mathvariant="bold">k</mi><mn>1</mn></msub><mo stretchy="false">)</mo><msub><mi mathvariant="bold">v</mi><mn>1</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>S</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">q</mi><mn>2</mn></msub><mo>â‹…</mo><msub><mi mathvariant="bold">k</mi><mn>1</mn></msub><mo stretchy="false">)</mo><msub><mi mathvariant="bold">v</mi><mn>1</mn></msub><mo>+</mo><mi>S</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">q</mi><mn>2</mn></msub><mo>â‹…</mo><msub><mi mathvariant="bold">k</mi><mn>2</mn></msub><mo stretchy="false">)</mo><msub><mi mathvariant="bold">v</mi><mn>2</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>S</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">q</mi><mi>L</mi></msub><mo>â‹…</mo><msub><mi mathvariant="bold">k</mi><mn>1</mn></msub><mo stretchy="false">)</mo><msub><mi mathvariant="bold">v</mi><mn>1</mn></msub><mo>+</mo><mi>S</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">q</mi><mi>L</mi></msub><mo>â‹…</mo><msub><mi mathvariant="bold">k</mi><mn>2</mn></msub><mo stretchy="false">)</mo><msub><mi mathvariant="bold">v</mi><mn>2</mn></msub><mo>+</mo><mo>â‹¯</mo><mo>+</mo><mi>S</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">q</mi><mi>L</mi></msub><mo>â‹…</mo><msub><mi mathvariant="bold">k</mi><mi>L</mi></msub><mo stretchy="false">)</mo><msub><mi mathvariant="bold">v</mi><mi>L</mi></msub></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
S\left(\mathbf{Q}\mathbf{K^T}\right)\mathbf{V} &amp;=
\begin{bmatrix}
S(\mathbf{q}_1 \cdot \mathbf{k}_1) &amp; 0 &amp; \cdots &amp; 0 \\
S(\mathbf{q}_2 \cdot \mathbf{k}_1) &amp; S(\mathbf{q}_2 \cdot \mathbf{k}_2) &amp; \cdots &amp; 0 \\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
S(\mathbf{q}_L \cdot \mathbf{k}_1) &amp; S(\mathbf{q}_L \cdot \mathbf{k}_2) &amp; \cdots &amp; S(\mathbf{q}_L \cdot \mathbf{k}_L)
\end{bmatrix}
\begin{bmatrix}
\mathbf{v}_1 \\
\mathbf{v}_2 \\
\vdots \\
\mathbf{v}_L
\end{bmatrix} \\
\\
\\
&amp; = \begin{bmatrix}
S(\mathbf{q}_1 \cdot \mathbf{k}_1)\mathbf{v}_1 \\
S(\mathbf{q}_2 \cdot \mathbf{k}_1)\mathbf{v}_1 + S(\mathbf{q}_2 \cdot \mathbf{k}_2)\mathbf{v}_2 \\
\vdots \\
S(\mathbf{q}_L \cdot \mathbf{k}_1)\mathbf{v}_1 + S(\mathbf{q}_L \cdot \mathbf{k}_2)\mathbf{v}_2 + \cdots + S(\mathbf{q}_L \cdot \mathbf{k}_L)\mathbf{v}_L
\end{bmatrix}
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:14.519999999999996em;vertical-align:-7.009999999999998em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:7.509999999999999em;"><span style="top:-9.509999999999998em;"><span class="pstrut" style="height:4.9799999999999995em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathbf">Q</span></span><span class="mord"><span class="mord"><span class="mord mathbf">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8932769999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">T</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span></span></span><span style="top:-5.89em;"><span class="pstrut" style="height:4.9799999999999995em;"></span><span class="mord"></span></span><span style="top:-4.389999999999999em;"><span class="pstrut" style="height:4.9799999999999995em;"></span><span class="mord"></span></span><span style="top:-0.7500000000000009em;"><span class="pstrut" style="height:4.9799999999999995em;"></span><span class="mord"></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:7.009999999999998em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:7.509999999999999em;"><span style="top:-9.509999999999998em;"><span class="pstrut" style="height:4.9799999999999995em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.953995em;"><span style="top:-1.3499850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.4999850000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.0959850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.6919850000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.712975em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-4.953995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4500349999999997em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9799999999999995em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-2.7674999999999996em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675000000000006em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9799999999999995em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-2.7674999999999996em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675000000000006em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9799999999999995em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="minner">â‹¯</span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="minner">â‹¯</span></span></span><span style="top:-2.7674999999999996em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675000000000006em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="minner">â‹¯</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9799999999999995em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.7674999999999996em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675000000000006em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.953995em;"><span style="top:-1.3499850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.4999850000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.0959850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.6919850000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.712975em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-4.953995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4500349999999997em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.953995em;"><span style="top:-1.3499850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.4999850000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.0959850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.6919850000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.712975em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-4.953995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4500349999999997em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9799999999999995em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7674999999999996em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675000000000006em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.953995em;"><span style="top:-1.3499850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.4999850000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.0959850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.6919850000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.712975em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-4.953995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4500349999999997em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-0.7500000000000018em;"><span class="pstrut" style="height:4.9799999999999995em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.953995em;"><span style="top:-1.3499850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.4999850000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.0959850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.6919850000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.712975em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-4.953995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4500349999999997em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9799999999999995em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7674999999999996em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675000000000006em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.953995em;"><span style="top:-1.3499850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.4999850000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.0959850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.6919850000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.712975em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-4.953995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4500349999999997em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:7.009999999999997em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>å› æ­¤å¯ä»¥çœ‹åˆ°ï¼Œå½“æ²¡æœ‰å¢åŠ  Causal Mask æ—¶ï¼Œå¯¹äºç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span></span></span></span> æ¬¡è¿­ä»£è€Œè¨€ï¼Œå…¶æ³¨æ„åŠ›æœºåˆ¶çš„è®¡ç®—æ–¹å¼å¦‚ä¸‹ï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mrow><mo fence="true">(</mo><mi mathvariant="bold">Q</mi><msup><mi mathvariant="bold">K</mi><mi mathvariant="bold">T</mi></msup><mo fence="true">)</mo></mrow><mi mathvariant="bold">V</mi><msub><mi mathvariant="normal">âˆ£</mi><mi>l</mi></msub><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>L</mi></munderover><mi>S</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">q</mi><mi>l</mi></msub><mo>â‹…</mo><msub><mi mathvariant="bold">k</mi><mi>j</mi></msub><mo stretchy="false">)</mo><msub><mi mathvariant="bold">v</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">S\left(\mathbf{Q}\mathbf{K^T}\right)\mathbf{V}|_{l} = \sum_{j=1}^{L}S(\mathbf{q}_l \cdot \mathbf{k}_j)\mathbf{v}_j
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2432869999999998em;vertical-align:-0.35001em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathbf">Q</span></span><span class="mord"><span class="mord"><span class="mord mathbf">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8932769999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">T</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span><span class="mord"><span class="mord">âˆ£</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.2421130000000007em;vertical-align:-1.4137769999999998em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000006em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">L</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>å½“å¢åŠ  Causal Mask åï¼Œå¯¹äºç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span></span></span></span> æ¬¡è¿­ä»£è€Œè¨€ï¼Œå…¶æ³¨æ„åŠ›æœºåˆ¶çš„è®¡ç®—æ–¹å¼å¦‚ä¸‹ï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mrow><mo fence="true">(</mo><mi mathvariant="bold">Q</mi><msup><mi mathvariant="bold">K</mi><mi mathvariant="bold">T</mi></msup><mo fence="true">)</mo></mrow><mi mathvariant="bold">V</mi><msub><mi mathvariant="normal">âˆ£</mi><mi>l</mi></msub><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>l</mi></munderover><mi>S</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">q</mi><mi>l</mi></msub><mo>â‹…</mo><msub><mi mathvariant="bold">k</mi><mi>j</mi></msub><mo stretchy="false">)</mo><msub><mi mathvariant="bold">v</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">S\left(\mathbf{Q}\mathbf{K^T}\right)\mathbf{V}|_{l} = \sum_{j=1}^{l}S(\mathbf{q}_l \cdot \mathbf{k}_j)\mathbf{v}_j
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2432869999999998em;vertical-align:-0.35001em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathbf">Q</span></span><span class="mord"><span class="mord"><span class="mord mathbf">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8932769999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">T</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span><span class="mord"><span class="mord">âˆ£</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.2498900000000006em;vertical-align:-1.4137769999999998em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8361130000000006em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>å¦‚æœè¾“å…¥çš„ prompt çš„åˆå§‹ token ä¸ªæ•°ä¸º 1ï¼Œé‚£ä¹ˆéšç€ç”Ÿæˆçš„è¿›è¡Œï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¦‚ä¸‹çš„å˜åŒ–ï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>S</mi><mrow><mo fence="true">(</mo><mi mathvariant="bold">Q</mi><msup><mi mathvariant="bold">K</mi><mi mathvariant="bold">T</mi></msup><mo fence="true">)</mo></mrow><mi mathvariant="bold">V</mi><msub><mi mathvariant="normal">âˆ£</mi><mn>1</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mn>1</mn></munderover><mi>S</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">q</mi><mn>1</mn></msub><mo>â‹…</mo><msub><mi mathvariant="bold">k</mi><mi>j</mi></msub><mo stretchy="false">)</mo><msub><mi mathvariant="bold">v</mi><mi>j</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>S</mi><mrow><mo fence="true">(</mo><mi mathvariant="bold">Q</mi><msup><mi mathvariant="bold">K</mi><mi mathvariant="bold">T</mi></msup><mo fence="true">)</mo></mrow><mi mathvariant="bold">V</mi><msub><mi mathvariant="normal">âˆ£</mi><mn>2</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mn>2</mn></munderover><mi>S</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">q</mi><mn>2</mn></msub><mo>â‹…</mo><msub><mi mathvariant="bold">k</mi><mi>j</mi></msub><mo stretchy="false">)</mo><msub><mi mathvariant="bold">v</mi><mi>j</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>S</mi><mrow><mo fence="true">(</mo><mi mathvariant="bold">Q</mi><msup><mi mathvariant="bold">K</mi><mi mathvariant="bold">T</mi></msup><mo fence="true">)</mo></mrow><mi mathvariant="bold">V</mi><msub><mi mathvariant="normal">âˆ£</mi><mn>3</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mn>3</mn></munderover><mi>S</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">q</mi><mn>3</mn></msub><mo>â‹…</mo><msub><mi mathvariant="bold">k</mi><mi>j</mi></msub><mo stretchy="false">)</mo><msub><mi mathvariant="bold">v</mi><mi>j</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>S</mi><mrow><mo fence="true">(</mo><mi mathvariant="bold">Q</mi><msup><mi mathvariant="bold">K</mi><mi mathvariant="bold">T</mi></msup><mo fence="true">)</mo></mrow><mi mathvariant="bold">V</mi><msub><mi mathvariant="normal">âˆ£</mi><mi>L</mi></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>L</mi></munderover><mi>S</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold">q</mi><mi>L</mi></msub><mo>â‹…</mo><msub><mi mathvariant="bold">k</mi><mi>j</mi></msub><mo stretchy="false">)</mo><msub><mi mathvariant="bold">v</mi><mi>j</mi></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
S\left(\mathbf{Q}\mathbf{K^T}\right)\mathbf{V}|_{1} &amp;= \sum_{j=1}^{1}S(\mathbf{q}_1 \cdot \mathbf{k}_j)\mathbf{v}_j \\
S\left(\mathbf{Q}\mathbf{K^T}\right)\mathbf{V}|_{2} &amp;= \sum_{j=1}^{2}S(\mathbf{q}_2 \cdot \mathbf{k}_j)\mathbf{v}_j \\
S\left(\mathbf{Q}\mathbf{K^T}\right)\mathbf{V}|_{3} &amp;= \sum_{j=1}^{3}S(\mathbf{q}_3 \cdot \mathbf{k}_j)\mathbf{v}_j \\
\vdots \\
S\left(\mathbf{Q}\mathbf{K^T}\right)\mathbf{V}|_{L} &amp;= \sum_{j=1}^{L}S(\mathbf{q}_L \cdot \mathbf{k}_j)\mathbf{v}_j
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:16.246783em;vertical-align:-7.873391500000001em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:8.3733915em;"><span style="top:-10.4006145em;"><span class="pstrut" style="height:3.8283360000000006em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathbf">Q</span></span><span class="mord"><span class="mord"><span class="mord mathbf">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8932769999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">T</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span><span class="mord"><span class="mord">âˆ£</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-6.885724500000002em;"><span class="pstrut" style="height:3.8283360000000006em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathbf">Q</span></span><span class="mord"><span class="mord"><span class="mord mathbf">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8932769999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">T</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span><span class="mord"><span class="mord">âˆ£</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.370834500000001em;"><span class="pstrut" style="height:3.8283360000000006em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathbf">Q</span></span><span class="mord"><span class="mord"><span class="mord mathbf">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8932769999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">T</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span><span class="mord"><span class="mord">âˆ£</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-0.15705750000000007em;"><span class="pstrut" style="height:3.8283360000000006em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:2.3312785000000003em;"><span class="pstrut" style="height:3.8283360000000006em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathbf">Q</span></span><span class="mord"><span class="mord"><span class="mord mathbf">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8932769999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">T</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span><span class="mord"><span class="mord">âˆ£</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">L</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:7.873391500000001em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:8.3733915em;"><span style="top:-10.4006145em;"><span class="pstrut" style="height:3.8283360000000006em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8011130000000004em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span><span style="top:-6.885724500000002em;"><span class="pstrut" style="height:3.8283360000000006em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8011130000000004em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.370834500000001em;"><span class="pstrut" style="height:3.8283360000000006em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8011130000000004em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span><span style="top:2.3312785000000003em;"><span class="pstrut" style="height:3.8283360000000006em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000006em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">L</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:7.873391500000001em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>æ‰€ä»¥ï¼Œå½“ç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span></span></span></span> æ¬¡è¿­ä»£æ—¶ï¼Œå¯¹äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">q</mi></mrow><annotation encoding="application/x-tex">\mathbf{q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.63888em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathbf">q</span></span></span></span></span> è€Œè¨€ï¼Œåªç”¨åˆ°äº†å½“å‰çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">q</mi><mi>l</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{q}_l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.63888em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œä½†æ˜¯å¯¹äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">k</mi></mrow><annotation encoding="application/x-tex">\mathbf{k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">k</span></span></span></span></span>ã€<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">v</mi></mrow><annotation encoding="application/x-tex">\mathbf{v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.44444em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span></span></span></span> è€Œè¨€ï¼Œåˆ™ä¼šé‡å¤ä½¿ç”¨åˆ°ä¹‹å‰çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">k</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{k}_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ã€<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">v</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{v}_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.59444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>â‹¯</mo><mo stretchy="false">(</mo><mi>l</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">i=1\cdots (l-1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span>ï¼‰ï¼Œä¸ºäº†é¿å…é‡å¤è®¡ç®—ï¼Œå› æ­¤éœ€è¦å¯¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">k</mi></mrow><annotation encoding="application/x-tex">\mathbf{k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">k</span></span></span></span></span>ã€<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">v</mi></mrow><annotation encoding="application/x-tex">\mathbf{v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.44444em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span></span></span></span> è¿›è¡Œç¼“å­˜ï¼Œè¿™ä¹Ÿå°±æ˜¯ <code>KV ç¼“å­˜</code> çš„æ¦‚å¿µã€‚</p>
<p>å…·ä½“çš„è¿‡ç¨‹å¦‚ä¸‹æ‰€ç¤º<sup class="footnote-ref"><a href="#fn1" id="fnref1:1">[1:1]</a></sup>ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">Input P : encoded <span class="built_in">input</span> sequence [p1, p2, ..., pl]</span><br><span class="line">Output X: generated new sequence [].</span><br><span class="line">    </span><br><span class="line"><span class="number">1</span>: Forward Pass [p1, p2, ..., pl]</span><br><span class="line"><span class="number">2</span>: Store the KV cache: [(k1, v1), (k2, v2), ..., (kl, vl)]</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>: <span class="keyword">for</span> i <span class="keyword">from</span> <span class="number">1</span> to M do</span><br><span class="line"><span class="number">4</span>:     Predict the <span class="built_in">next</span> token pl+i using the KV cache.</span><br><span class="line"><span class="number">5</span>:     Store (kl+i, vl+i) to the KV cache.</span><br><span class="line"><span class="number">6</span>:     X â† X âˆª &#123;pl+i&#125;</span><br><span class="line"></span><br><span class="line"><span class="number">7</span>:     <span class="keyword">if</span> pl+i <span class="keyword">is</span> EOS token <span class="keyword">or</span> <span class="built_in">len</span>(X)&gt;<span class="built_in">max</span> length then</span><br><span class="line"><span class="number">8</span>:         <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>å¼•å…¥ <code>KV ç¼“å­˜</code> åï¼Œå¯¹äºç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span></span></span></span> æ¬¡è¿­ä»£è€Œè¨€ï¼Œå…¶æ³¨æ„åŠ›æœºåˆ¶çš„è®¡ç®—æ–¹å¼å¦‚ä¸‹<sup class="footnote-ref"><a href="#fn13" id="fnref13">[13]</a></sup>ï¼š</p>
<p><img src="/2024/11/16/The-LLMs-Runtime-Inference-and-KV-Cache/kv_cache_cacluation_demo.gif" alt></p>
<h2 id="å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</h2>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p><a href="https://arxiv.org/abs/2407.12391v1">LLM Inference Serving: Survey of Recent Advances and Opportunities</a> <a href="#fnref1" class="footnote-backref">â†©ï¸</a> <a href="#fnref1:1" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn2" class="footnote-item"><p><a href="https://arxiv.org/abs/2308.16369">SARATHI: Efficient LLM Inference by Piggybacking Decodes with Chunked Prefills</a> <a href="#fnref2" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn3" class="footnote-item"><p><a href="https://docs.nvidia.com/deeplearning/performance/dl-performance-gpu-background/index.html">GPU Performance Background Userâ€™s Guide</a> <a href="#fnref3" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn4" class="footnote-item"><p><a href="https://resources.nvidia.com/en-us-briefcase-for-datasheets/proviz-print-nvidia-1?ncid=no-ncid">NVIDIA RTX A6000</a> <a href="#fnref4" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn5" class="footnote-item"><p><a href="https://docs.nvidia.com/nemo-framework/user-guide/latest/nemotoolkit/features/parallelisms.html">NVIDIA NeMo Framework User Guide: Parallelisms</a> <a href="#fnref5" class="footnote-backref">â†©ï¸</a> <a href="#fnref5:1" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn6" class="footnote-item"><p><a href="https://lightning.ai/lightning-ai/studios/tensor-parallelism-supercharging-large-model-training-with-pytorch-lightning">Tensor Parallelism: Supercharging Large Model Training with PyTorch Lightning</a> <a href="#fnref6" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn7" class="footnote-item"><p><a href="https://docs.nvidia.com/deeplearning/nccl/user-guide/docs/usage/collectives.html">Collective Operations</a> <a href="#fnref7" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn8" class="footnote-item"><p><a href="https://developer.nvidia.com/blog/mastering-llm-techniques-inference-optimization/">Mastering LLM Techniques: Inference Optimization</a> <a href="#fnref8" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn9" class="footnote-item"><p><a href="https://uvadlc-notebooks.readthedocs.io/en/latest/tutorial_notebooks/scaling/JAX/pipeline_parallel_simple.html">Pipeline Parallelism</a> <a href="#fnref9" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn10" class="footnote-item"><p><a href="https://docs.nvidia.com/nim/benchmarking/llm/latest/metrics.html">NIM for LLM Benchmarking Guide: Metrics</a> <a href="#fnref10" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn11" class="footnote-item"><p><a href="https://pytorch2024.sched.com/event/1fHnQ/understanding-the-llm-inference-workload-mark-moyou-nvidia">Understanding the LLM Inference Workload - Mark Moyou, NVIDIA</a> <a href="#fnref11" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn12" class="footnote-item"><p><a href="https://discuss.huggingface.co/t/difference-between-attention-mask-and-causal-mask/104922">Difference Between Attention Mask and Causal Mask</a> <a href="#fnref12" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn13" class="footnote-item"><p><a href="https://medium.com/@joaolages/kv-caching-explained-276520203249">Transformers KV Caching Explained</a> <a href="#fnref13" class="footnote-backref">â†©ï¸</a></p>
</li>
</ol>
</section>
]]></content>
      <categories>
        <category>LLM</category>
      </categories>
      <tags>
        <tag>Prefill</tag>
        <tag>KV Cache</tag>
        <tag>Runtime Inference</tag>
      </tags>
  </entry>
  <entry>
    <title>ä» Transformer åˆ° GPT</title>
    <url>/2024/10/31/From-Transformer-To-GPT/</url>
    <content><![CDATA[<p><img src="/2024/10/31/From-Transformer-To-GPT/1.png" alt><br>
åœ¨ <a href="/2024/10/16/What-exactly-is-attention/">è‡ªæ³¨æ„åŠ›ç©¶ç«Ÿæ˜¯ä»€ä¹ˆï¼Ÿ</a> ä¸€æ–‡ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†åŸºäºæ³¨æ„åŠ›æœºåˆ¶çš„ Transformer æ¨¡å‹çš„åŸºæœ¬åŸç†å’Œæ¶æ„ã€‚</p>
<ul>
<li>2017å¹´ 6 æœˆï¼Œè°·æ­Œæœºå™¨ç¿»è¯‘å›¢é˜Ÿæå‡ºçš„æœºå™¨ç¿»è¯‘æ¨¡å‹ Transformer å°±åƒå¤§è¯­è¨€æ¨¡å‹çš„ä¸€é¢—ç§å­ä¸€æ ·ï¼Œæ‚„ç„¶è½åœ°ç”Ÿæ ¹ï¼Œå¹¶è¿…é€Ÿå¸­å·äº† AI é¢†åŸŸã€‚</li>
<li>ä¸€å¹´ä¹‹åï¼Œ2018 å¹´ 6 æœˆï¼ŒOpenAI å‘å¸ƒäº†åŸºäº Transformer æ¶æ„çš„ GPT-1<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup>ï¼Œè™½ç„¶å½“æ—¶è¿˜å­˜åœ¨ä¸€äº›å±€é™æ€§ï¼Œä¾‹å¦‚å½“æ—¶è¿˜ä¸èƒ½æ ¹æ®ä¸€ä¸ªç»™å®šçš„æ ‡é¢˜æ¥ç”Ÿæˆä¸€ç¯‡æ–°é—»æŠ¥é“ï¼›ä½†æ˜¯ï¼Œè°ä¹Ÿæ²¡æƒ³åˆ°ï¼Œå°±æ˜¯è¿™ä¸ªæ¡†æ¶ï¼Œåœ¨ 4 å¹´ä¹‹åæˆä¸ºäº† AI é¢†åŸŸæœ€ç‚™æ‰‹å¯çƒ­çš„æ¨¡å‹ã€‚</li>
<li>4 ä¸ªæœˆåï¼Œ2018 å¹´ 10 æœˆï¼Œè°·æ­Œä¹Ÿå‘å¸ƒäº†åŸºäº Transformer æ¶æ„çš„ BERT æ¨¡å‹<sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup>ï¼Œä¸ GPT-1 ç›¸æ¯”ï¼ŒBERT åœ¨å¾ˆå¤šä¸‹æ¸¸ä»»åŠ¡ä¸Šè¡¨ç°å‡ºæ›´å¼ºåŠ²çš„æ€§èƒ½ï¼Œå¹¶ä¸”ä¹Ÿåˆ·æ–°äº†å¤šä¸ªæ¦œå•çš„è®°å½•ã€‚åœ¨å¾ˆé•¿ä¸€æ®µæ—¶é—´é‡Œï¼ŒBERTï¼ˆåŠå…¶å˜ä½“ï¼‰ä¸€ç›´å¤„äºå„ç±»æ¦œå•çš„é¦–ä½ï¼Œæ˜¯äººä»¬è°ˆè®ºçš„ç„¦ç‚¹ã€‚</li>
<li>ç›´åˆ° 2022 å¹´ 3 æœˆï¼ŒOpenAI å‘å¸ƒäº† GPT-3.5<sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup>ï¼Œå¹¶åŸºäº GPT-3.5 äºå½“å¹´çš„ 11 æœˆ 30 æ—¥æ­£å¼å‘å¸ƒäº†é¢å‘æ¶ˆè´¹ç”¨æˆ·çš„äº§å“â€”â€”ChatGPTï¼Œå¤§æ¨¡å‹å†æ¬¡å¼•èµ·äº†åœˆå†…ã€åœˆå¤–çš„å¹¿æ³›è®¨è®ºï¼Œå¼€å¯äº†æ–°ä¸€è½®çš„å¤§æ¨¡å‹æ—¶ä»£ã€‚</li>
</ul>
<p>è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬å°±æ¥è¯¦ç»†çš„ä»‹ç»ä¸€ä¸‹ä¼ å¥‡çš„ GPT æ¨¡å‹ä»¥åŠå…¶åŸç†ï¼Œæ…¢æ…¢æ­å¼€ GPT é‚£ç¥ç§˜çš„é¢çº±ï¼Œä¹Ÿä¸ºåç»­å¯¹ <a href="https://openai.com/index/api-prompt-caching/">Prompt Caching</a> çš„è®¨è®ºæ‰“ä¸‹åšå®çš„åŸºç¡€ã€‚</p>
<span id="more"></span>
<h2 id="å¤§è¯­è¨€æ¨¡å‹æ—è°±">å¤§è¯­è¨€æ¨¡å‹æ—è°±</h2>
<p><a href="https://arxiv.org/abs/2304.13712">A Survey on ChatGPT and Beyond</a> ç»™å‡ºäº†åŸºäº Transformer æ¶æ„çš„å¤§è¯­è¨€æ¨¡å‹çš„å‘å±•æ¦‚å†µå’Œä¸åŒæ¨¡å‹ä¹‹é—´çš„æ¼”åŒ–å…³ç³»<sup class="footnote-ref"><a href="#fn4" id="fnref4">[4]</a></sup>ï¼š</p>
<p><img src="/2024/10/31/From-Transformer-To-GPT/LLMTree.jpeg" alt="å¤§è¯­è¨€æ¨¡å‹è¿›åŒ–æ ‘"></p>
<p>ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œå¤§è¯­è¨€æ¨¡å‹çš„æ¶æ„æ•´ä½“ä¸Šå¯ä»¥åˆ†ä¸º Enoder-Onlyã€Encoder-Decoderã€Decoder-Only ä¸‰ç±»ï¼š</p>
<ul>
<li>Encoder-Only æ¨¡å‹ï¼šä»…åŒ…å« Transformer ä¸­çš„ç¼–ç å™¨éƒ¨åˆ†ï¼Œä¸»è¦ç”¨äºä»è¾“å…¥æ•°æ®æå–ç‰¹å¾æˆ–è¡¨ç¤ºï¼Œæœ€å…¸å‹çš„ä»£è¡¨å°±æ˜¯ 2018 å¹´ 10 æœˆï¼Œè°·æ­Œä¹Ÿå‘å¸ƒçš„ BERT<sup class="footnote-ref"><a href="#fn2" id="fnref2:1">[2:1]</a></sup>ã€‚</li>
<li>Encoder-Decoder æ¨¡å‹ï¼šåŒ…å«å®Œæ•´çš„ Transformer çš„ç¼–ç å™¨å’Œè§£ç å™¨ï¼Œç¼–ç å™¨è´Ÿè´£å°†è¾“å…¥åºåˆ—è½¬æ¢ä¸ºå‹ç¼©çš„ä¸­é—´è¡¨ç¤ºï¼Œè§£ç å™¨åˆ™åŸºäºè¿™ä¸ªä¸­é—´è¡¨ç¤ºç”Ÿæˆç›®æ ‡è¾“å‡ºåºåˆ—ï¼Œæœ€å…¸å‹çš„ä»£è¡¨å°±æ˜¯ 2019 å¹´ è°·æ­Œå‘å¸ƒçš„ T5 æ¨¡å‹<sup class="footnote-ref"><a href="#fn5" id="fnref5">[5]</a></sup>ã€‚</li>
<li>Decoder-Only æ¨¡å‹ï¼šä»…åŒ…å« Transformer ä¸­çš„è§£ç å™¨éƒ¨åˆ†ï¼Œä¸“æ³¨äºä½¿ç”¨ <strong>è‡ªå›å½’</strong> çš„æ–¹å¼æ ¹æ®å‰é¢ç”Ÿæˆçš„å†…å®¹ç”Ÿæˆæ–°çš„åºåˆ—ï¼Œæ–°çš„è¾“å‡ºä»…ä¾èµ–äºå‰é¢ç”Ÿæˆçš„æ‰€æœ‰å†…å®¹ï¼Œæœ€å…¸å‹çš„ä»£è¡¨å°±æ˜¯ 2018 å¹´ 6 æœˆï¼ŒOpenAI å‘å¸ƒçš„ GPT-1<sup class="footnote-ref"><a href="#fn1" id="fnref1:1">[1:1]</a></sup>ã€‚2020 å¹´ 1æœˆï¼ŒOpenAI å‘å¸ƒäº†æ‰€è°“çš„è¯­è¨€æ¨¡å‹çš„ <strong>Scaling Law</strong> <sup class="footnote-ref"><a href="#fn6" id="fnref6">[6]</a></sup>ï¼Œå°¤å…¶æ˜¯åœ¨ å½“å‰çš„ 5 æœˆå‘å¸ƒ GPT-3<sup class="footnote-ref"><a href="#fn7" id="fnref7">[7]</a></sup> ä¹‹åï¼ŒDecoder-Only æ¶æ„æˆä¸ºäº†è¯­è¨€æ¨¡å‹é¢†åŸŸçš„ä¸»æµæ¶æ„ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬æ‰€ç†ŸçŸ¥çš„å¤§éƒ¨åˆ†çš„å¤§è¯­è¨€æ¨¡å‹éƒ½æ˜¯åŸºäº Decoder-Only æ¶æ„ï¼ŒçœŸå¯è°“æ˜¯ä¸€æç‹¬ç§€ã€‚</li>
</ul>
<h2 id="è‡ªç¼–ç -è‡ªå›å½’">è‡ªç¼–ç &amp;è‡ªå›å½’</h2>
<p>å¯¹äº <strong>ã€åŒ—äº¬çš„ç§‹å¤©æ˜¯æœ€ç¾çš„å­£èŠ‚ï¼Œæˆ‘çˆ±åŒ—äº¬ã€</strong> è¿™å¥è¯ï¼Œå¦‚æœæˆ‘ä»¬å¯¹è¿™å¥è¯ä¸­çš„è¯è¿›è¡Œéšæœºæ©ç ï¼ˆé®ç›–ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°å¦‚ä¸‹çš„æ©ç ç»“æœï¼š</p>
<blockquote>
<p>åŒ—äº¬çš„<code>__</code>æ˜¯æœ€ç¾çš„å­£èŠ‚ï¼Œæˆ‘çˆ±åŒ—äº¬</p>
</blockquote>
<p>æˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯è®©æ¨¡å‹æ¥é¢„æµ‹ç©ºç™½å¤„çš„è¢«æ©ç æ‰çš„è¯ã€‚æœ‰ä¸¤ç§æ¨¡å‹å¯ä»¥å®Œæˆè¿™ä¸ªä»»åŠ¡ï¼šè‡ªç¼–ç æ¨¡å‹ï¼ˆAuto-Encoderï¼‰å’Œè‡ªå›å½’æ¨¡å‹ï¼ˆAuto-Regressiveï¼‰ã€‚</p>
<h3 id="è‡ªç¼–ç æ¨¡å‹">è‡ªç¼–ç æ¨¡å‹</h3>
<p>è‡ªç¼–ç æ¨¡å‹åœ¨é¢„æµ‹ <code>ç©ºç™½è¯</code> æ—¶ä¼šåŒæ—¶ä»ä¸¤ä¸ªæ–¹å‘é˜…è¯»å¥å­ï¼Œå¯ä»¥åŒæ—¶åˆ©ç”¨æ­£å‘é¢„æµ‹å’Œåå‘é¢„æµ‹çš„ä¼˜åŠ¿æ¥å®Œæˆé¢„æµ‹ï¼š</p>
<ul>
<li>å¦‚æœä½¿ç”¨æ­£å‘é¢„æµ‹ï¼Œé‚£ä¹ˆæ¨¡å‹ä¼šä»å·¦åˆ°å³è¯»å–æ‰€æœ‰çš„è¯ï¼Œç›´åˆ°é‡åˆ° <code>ç©ºç™½è¯</code>ï¼Œç„¶åè¿›è¡Œé¢„æµ‹ï¼š</li>
</ul>
<blockquote>
<p>åŒ—äº¬çš„<code>__</code></p>
</blockquote>
<ul>
<li>å¦‚æœä½¿ç”¨åå‘é¢„æµ‹ï¼Œé‚£ä¹ˆæ¨¡å‹ä¼šä»å³åˆ°å·¦è¯»å–æ‰€æœ‰çš„è¯ï¼Œç›´åˆ°é‡åˆ° <code>ç©ºç™½è¯</code>ï¼Œç„¶åè¿›è¡Œé¢„æµ‹ï¼š</li>
</ul>
<blockquote>
<p><code>__</code>æ˜¯æœ€ç¾çš„å­£èŠ‚ï¼Œæˆ‘çˆ±åŒ—äº¬</p>
</blockquote>
<p>ä»ä¸¤ä¸ªæ–¹å‘è¯»å–å¥å­ï¼Œæ¨¡å‹èƒ½å¤Ÿæ›´åŠ å…¨é¢å’Œæ¸…æ™°çš„ç†è§£å¥å­ï¼Œå› æ­¤è‡ªç¼–ç æ¨¡å‹èƒ½å¤Ÿç»™å‡ºæ›´å¥½çš„ç»“æœã€‚è¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆæ¯” GPT-1 æ™š 4 ä¸ªæœˆå‘å¸ƒ BERT æ¨¡å‹åœ¨å½“æ—¶èƒ½å¤Ÿè·å¾—æ›´å¥½çš„æ•ˆæœçš„ä¸»è¦åŸå› <sup class="footnote-ref"><a href="#fn2" id="fnref2:2">[2:2]</a></sup>ï¼Œä¹Ÿæ˜¯ 2021 å¹´ä»¥å‰ï¼Œä»¥ BERT ä¸ºä»£è¡¨çš„è‡ªç¼–ç æ¨¡å‹èƒ½å¤Ÿä¸€éª‘ç»å°˜çš„åŸå› ã€‚</p>
<p><img src="/2024/10/31/From-Transformer-To-GPT/bert_result.png" alt="æ¥æºï¼šBERT, Pre-training of Deep Bidirectional Transformers for Language Understanding"></p>
<h3 id="è‡ªå›å½’æ¨¡å‹">è‡ªå›å½’æ¨¡å‹</h3>
<p>ä¸è‡ªç¼–ç æ¨¡å‹ä¸åŒï¼Œè‡ªå›å½’æ¨¡å‹åœ¨é¢„æµ‹ <code>ç©ºç™½è¯</code> æ—¶è¦ä¹ˆä»…ä½¿ç”¨æ­£å‘é¢„æµ‹ï¼Œè¦ä¹ˆä»…ä½¿ç”¨åå‘é¢„æµ‹ï¼Œè€Œä¸èƒ½åƒè‡ªç¼–ç æ¨¡å‹é‚£æ ·å¯ä»¥åŒæ—¶åˆ©ç”¨æ­£å‘é¢„æµ‹å’Œåå‘é¢„æµ‹çš„ä¼˜åŠ¿æ¥å®Œæˆé¢„æµ‹ã€‚å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œåœ¨é¢„æµ‹ <code>ç©ºç™½è¯</code> æ—¶ï¼Œè‡ªå›å½’æ¨¡å‹ä¼šä½¿ç”¨æ­£å‘é¢„æµ‹ï¼š</p>
<blockquote>
<p>åŒ—äº¬çš„<code>__</code></p>
</blockquote>
<p>æœ¬è´¨ä¸Šï¼Œè‡ªå›å½’æ¨¡å‹æ˜¯å•å‘é¢„æµ‹æ¨¡å‹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè‡ªå›å½’æ¨¡å‹åªèƒ½æ²¿ä¸€ä¸ªæ–¹å‘æ¥ç†è§£å¥å­å¹¶åšå‡ºé¢„æµ‹ã€‚è¿™ä¹Ÿå°±æ˜¯æˆ‘ä»¬é€šå¸¸æ‰€è¯´çš„ï¼šGPT åªèƒ½æ ¹æ®è¾“å…¥åºåˆ—ä¸­çš„å‰é¢çš„å†…å®¹æ¥é¢„æµ‹åºåˆ—ä¸­çš„ä¸‹ä¸€ä¸ªè¯ã€‚</p>
<h2 id="gpt-æ¨¡å‹">GPT æ¨¡å‹</h2>
<h3 id="gpt-1">GPT-1</h3>
<p>åœ¨ <em>Improving Language Understanding by Generative Pre-Training</em> <sup class="footnote-ref"><a href="#fn1" id="fnref1:2">[1:2]</a></sup> ä¸­ï¼ŒOpenAI æå‡ºäº† GPT-1 çš„æ¨¡å‹æ¶æ„ï¼ˆé¢„è®­ç»ƒæ¨¡å‹+ä¸‹æ¸¸ä»»åŠ¡å¾®è°ƒï¼‰ï¼Œå¹¶ä¸”å…¶æ ¸å¿ƒæ˜¯ä¸€ç§ <strong>å¤šå±‚ Transformer è§£ç å™¨</strong> çš„ Transformer æ¶æ„å˜ä½“ã€‚GPT-1 å…ˆè®¡ç®—è¾“å…¥çš„ä¸Šä¸‹æ–‡ tokens çš„å¤šå¤´è‡ªæ³¨æ„åŠ›ï¼Œç„¶ååœ¨ç»è¿‡å‰å‘åé¦ˆç½‘ç»œçš„å¤„ç†ï¼Œæœ€ç»ˆç”Ÿæˆç›®æ ‡è¾“å‡º token çš„æ¦‚ç‡åˆ†å¸ƒã€‚åœ¨è®ºæ–‡çš„ç¬¬ 3 èŠ‚ Framework ä¸­ï¼Œç»™å‡ºäº†æ¨¡å‹çš„æ•´ä½“æ¶æ„æè¿°ï¼š</p>
<blockquote>
<p>In our experiments, we use a <strong>multi-layer Transformer decoder</strong> for the language model, which is a variant of the transformer. This model applies a multi-headed self-attention operation over the input context tokens followed by position-wise feedforward layers to produce an output distribution over target tokens.</p>
</blockquote>
<p>åœ¨è®ºæ–‡çš„ç¬¬ 4 èŠ‚ Experiments ä¸­ï¼Œç»™å‡ºäº†æ¨¡å‹çš„è¯¦ç»†å‚æ•°å’Œè®­ç»ƒç»†èŠ‚ï¼ŒåŒ…æ‹¬æ¨¡å‹è¶…å‚æ•°ã€è®­ç»ƒæ•°æ®é›†å’Œè®­ç»ƒè¿‡ç¨‹ç­‰ï¼š</p>
<blockquote>
<p><strong>Model specifications</strong></p>
<ul>
<li>Our model largely follows the original transformer work.</li>
<li>We trained a 12-layer decoder-only transformer with masked self-attention heads (768 dimensional states and 12 attention heads).</li>
<li>For the position-wise feed-forward networks, we used 3072 dimensional inner states. We used the Adam optimization scheme with a max learning rate of 2.5e-4. The learning rate was increased linearly from zero over the first 2000 updates and annealed to 0 using a cosine schedule. We train for 100 epochs on minibatches of 64 randomly sampled, contiguous sequences of 512 tokens.</li>
<li>Since layernorm is used extensively throughout the model, a simple weight initialization of N(0,0.02) was sufficient.</li>
<li>We used a bytepair encoding (BPE) vocabulary with 40,000 merges and residual, embedding, and attention dropouts with a rate of 0.1 for regularization. We also employed a modified version of L2 regularization proposed in , with w= 0.01 on all non bias or gain weights. For the activation function, we used the Gaussian Error Linear Unit (GELU).</li>
<li>We used learned position embeddings instead of the sinusoidal version proposed in the original work.</li>
</ul>
</blockquote>
<h3 id="gpt-2">GPT-2</h3>
<p>åœ¨ <em>Language Models are Unsupervised Multitask Learners</em> <sup class="footnote-ref"><a href="#fn8" id="fnref8">[8]</a></sup> ä¸­çš„ç¬¬ 2 èŠ‚ Approach ä¸­ï¼Œç»™å‡ºäº† GPT-2 å’Œ GPT-1 åœ¨å¤„ç†ä¸‹æ¸¸ä»»åŠ¡çš„æ•°æ®çš„ä¸åŒï¼š</p>
<ul>
<li>GPT-1 å¯¹ä¸‹æ¸¸ä»»åŠ¡çš„æ•°æ®è¿›è¡Œäº†æ ‡æ³¨å’Œå¤„ç†ï¼ŒåŠ å…¥äº†ä¸€äº›ç‰¹æ®Šçš„è¯å…ƒï¼ˆ&lt;s&gt;ï¼Œ&lt;e&gt;ï¼Œ&lt;$&gt;ï¼‰ï¼Œåˆ†åˆ«è¡¨ç¤ºå¼€å§‹ã€æå–ã€åˆ†éš”ã€‚åœ¨é¢„è®­ç»ƒé˜¶æ®µï¼Œæ¨¡å‹æ²¡æœ‰è§è¿‡è¿™äº›è¯å…ƒï¼Œå› æ­¤æ¨¡å‹å¿…é¡»ç»è¿‡å¾®è°ƒé˜¶æ®µçš„é‡æ–°è®­ç»ƒåæ‰ä¼šè®¤è¯†è¿™äº›æ–°å¢åŠ çš„è¯å…ƒã€‚</li>
<li>åœ¨ GPT-2 çš„ Zero-Shot çš„è®¾å®šä¸‹ï¼Œå¯¹äºä¸‹æ¸¸ä»»åŠ¡è€Œè¨€ï¼Œæ¨¡å‹ä¸èƒ½å†æ¬¡è¢«è°ƒæ•´å’Œæ›´æ–°ï¼Œå› æ­¤å°±æ— æ³•å†å¼•å…¥ä¸€äº›æ–°çš„è¯å…ƒã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºä¸‹æ¸¸ä»»åŠ¡çš„è¾“å…¥ï¼Œæ¨¡å‹åœ¨é¢„è®­ç»ƒé˜¶æ®µéƒ½åº”è¯¥è§è¿‡ï¼Œè¿™è¦æ±‚æ¨¡å‹çš„è¾“å…¥å¿…é¡»æ›´æ¥è¿‘äººç±»çš„è‡ªç„¶è¯­è¨€ã€‚åœ¨å»ºæ¨¡è¿‡ç¨‹ä¸­ï¼Œåªæœ‰ä¸€ä¸ªå­¦ä¹ ä»»åŠ¡ï¼Œå³ç»™å®šè¾“å…¥åºåˆ—æ¥é¢„æµ‹è¾“å‡ºå•è¯çš„æ¦‚ç‡ï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>o</mi><mi>u</mi><mi>t</mi><mi>p</mi><mi>u</mi><mi>t</mi><mi mathvariant="normal">âˆ£</mi><mi>i</mi><mi>n</mi><mi>p</mi><mi>u</mi><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(output|input)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord mathdefault">o</span><span class="mord mathdefault">u</span><span class="mord mathdefault">t</span><span class="mord mathdefault">p</span><span class="mord mathdefault">u</span><span class="mord mathdefault">t</span><span class="mord">âˆ£</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault">p</span><span class="mord mathdefault">u</span><span class="mord mathdefault">t</span><span class="mclose">)</span></span></span></span>ã€‚åŒæ—¶ï¼Œæ¨¡å‹åº”è¯¥èƒ½å¤Ÿæ‰§è¡Œè®¸å¤šä¸åŒçš„ä»»åŠ¡ï¼Œä¸åŒçš„ä»»åŠ¡ï¼Œå³ä½¿è¾“å…¥ç›¸åŒï¼Œæ¨¡å‹çš„è¾“å‡ºä¹Ÿåº”è¯¥ä¸åŒï¼Œå› æ­¤æ¨¡å‹çš„å­¦ä¹ ç›®æ ‡å°±å˜æˆäº†åœ¨ç»™å®šè¾“å…¥å’Œä»»åŠ¡çš„å‰æä¸‹é¢„æµ‹è¾“å‡ºçš„æ¦‚ç‡ï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>o</mi><mi>u</mi><mi>t</mi><mi>p</mi><mi>u</mi><mi>t</mi><mi mathvariant="normal">âˆ£</mi><mi>i</mi><mi>n</mi><mi>p</mi><mi>u</mi><mi>t</mi><mo separator="true">,</mo><mi>t</mi><mi>a</mi><mi>s</mi><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(output|input, task)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord mathdefault">o</span><span class="mord mathdefault">u</span><span class="mord mathdefault">t</span><span class="mord mathdefault">p</span><span class="mord mathdefault">u</span><span class="mord mathdefault">t</span><span class="mord">âˆ£</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault">p</span><span class="mord mathdefault">u</span><span class="mord mathdefault">t</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span>ã€‚</li>
</ul>
<p>åœ¨æ¨¡å‹çš„åç»­å‘å±•ä¸­ï¼Œæˆ‘ä»¬ç§° GPT-2 ä¸­è¿™ç§æ›´æ¥è¿‘äººç±»è‡ªç„¶è¯­è¨€çš„è¾“å…¥ä¸º <strong>æç¤ºè¯</strong>ï¼ˆ<em>Prompt</em>ï¼‰ï¼ŒGPT-2 çš„è¿™ç§ Zero-Shot è®¾å®šå’Œä½¿ç”¨è‡ªç„¶è¯­è¨€æç¤ºè¯æ¥æŒ‡å¯¼é¢„è®­ç»ƒæ¨¡å‹æ‰§è¡Œä¸‹æ¸¸ä»»åŠ¡æ˜¯ GPT-2 çš„æœ€å¤§èƒ†çš„ä¸€æ­¥ã€‚</p>
<p>ä½†æ˜¯ï¼Œåœ¨æ¨¡å‹ç»“æ„ä¸Šï¼Œè®ºæ–‡çš„ç¬¬ 2.3 èŠ‚ Model ä¸­æŒ‡å‡ºï¼ŒGPT-2 ä¸ GPT-1 ç›¸æ¯”åŸºæœ¬ä¸€è‡´ï¼Œä»…ä»…æ˜¯åšäº†ä¸€äº›å°çš„ä¿®æ”¹è€Œå·²ï¼š</p>
<ul>
<li>æŠŠ Post-LN æ”¹æˆäº† Pre-LN</li>
<li>åœ¨æœ€åä¸€ä¸ª Transformer-Decoder æ¨¡å—ä¹‹åå¢åŠ äº†ä¸€ä¸ª Norm å±‚ã€‚</li>
<li>æ‰©å¤§äº† Transformer-Encoder æ¨¡å—çš„å±‚æ•°ä»¥åŠæ¨¡å‹å¯¹åº”çš„è¶…å‚æ•°çš„å¢åŠ ã€‚</li>
</ul>
<blockquote>
<p>We use a Transformer based architecture for our LMs.</p>
<ul>
<li>The model largely follows the details of the OpenAI GPT model (Radford et al., 2018) with a few modifications.</li>
<li>Layer normalization was moved to the input of each sub-block, similar to a pre-activation residual network and an additional layer normalization was added after the final self-attention block.</li>
</ul>
</blockquote>
<h3 id="gpt-3">GPT-3</h3>
<p>GPT-1 æå‡ºçš„â€œé¢„è®­ç»ƒæ¨¡å‹+ä¸‹æ¸¸ä»»åŠ¡å¾®è°ƒâ€çš„æ¨¡å¼æœ‰ä¸€ä¸ªå¾ˆå¤§çš„é™åˆ¶ï¼šä¸‹æ¸¸ä»»åŠ¡éœ€è¦é’ˆå¯¹ç‰¹å®šä»»åŠ¡æ ‡æ³¨æ•°æ®é›†ã€‚GPT-2 è™½ç„¶å¯ä»¥å® Zero-Shotï¼Œå¹¶ä¸å†éœ€è¦é’ˆå¯¹ç‰¹å®šä»»åŠ¡æ ‡æ³¨æ•°æ®é›†ï¼Œä½†åœ¨å½“æ—¶ä»ç„¶å­˜åœ¨å¾ˆå¤šé™åˆ¶å¯¼è‡´æ¨¡å‹å¹¶æ²¡æœ‰è¾¾åˆ° SOTA çš„æ•ˆæœã€‚</p>
<p>ä»åº”ç”¨çš„è§’åº¦è®²ï¼ŒæŒç»­æå‡ Zero-Shot çš„æ•ˆæœéå¸¸å¿…è¦ï¼Œå› ä¸ºå¯¹äºâ€œé¢„è®­ç»ƒæ¨¡å‹+ä¸‹æ¸¸ä»»åŠ¡å¾®è°ƒâ€è€Œè¨€ï¼š</p>
<ul>
<li>ä¸åŒçš„ä¸‹æ¸¸ä»»åŠ¡éƒ½éœ€è¦å¤§é‡çš„æ ‡æ³¨æ•°æ®é›†ï¼Œä½†æ˜¯ä¸‹æ¸¸ä»»åŠ¡ç±»å‹éå¸¸å¤šï¼Œå¦‚æœæ¯ä¸ªä»»åŠ¡éƒ½è¦æ”¶é›†æ•°æ®é›†å¹¶å¾®è°ƒçš„è¯ï¼Œæˆæœ¬ç›¸å¯¹è¾ƒå¤§ã€‚</li>
<li>åœ¨ä¸‹æ¸¸ä»»åŠ¡ä¸Šå¾®è°ƒä¹‹åçš„æ•ˆæœå¥½å¹¶ä¸ä¸€å®šèƒ½è¯´æ˜é¢„è®­ç»ƒçš„å¤§æ¨¡å‹æ³›åŒ–æ•ˆæœå¥½ï¼Œè¿˜æœ‰å¯èƒ½æ˜¯è¿‡æ‹Ÿåˆäº†é¢„è®­ç»ƒæ•°æ®é›†æ‰€åŒ…å«çš„ä¸€éƒ¨åˆ†å¾®è°ƒä»»åŠ¡çš„æ•°æ®è€Œå·²ã€‚å› æ­¤ï¼Œå¯¹äºä¸‹æ¸¸ä»»åŠ¡è€Œè¨€ï¼Œå¦‚æœä¸éœ€è¦é’ˆå¯¹æ€§çš„å¾®è°ƒï¼Œé‚£ä¹ˆèµ·å†³å®šæ€§ä½œç”¨çš„å°±æ˜¯é¢„è®­ç»ƒæ¨¡å‹çš„æ³›åŒ–æ€§ã€‚</li>
<li>ä»äººç±»å­¦ä¹ ä¸€ä¸ªæ–°æŠ€èƒ½çš„è§’åº¦çœ‹ï¼Œæˆ‘ä»¬æ‰§è¡Œä¸€ä¸ªæ–°çš„ä»»åŠ¡æ—¶å¹¶ä¸éœ€è¦å·¨å¤§çš„æ•°æ®é›†ï¼Œå¯èƒ½çœ‹ä¸€ä¸¤ä¸ªä¾‹å­å°±å­¦ä¼šäº†ã€‚</li>
</ul>
<p>å¯¹äºæ‰€æœ‰ç±»å‹çš„ä»»åŠ¡ï¼Œåœ¨æ²¡æœ‰ä»»ä½•æ¢¯åº¦æ›´æ–°æˆ–å¾®è°ƒçš„æƒ…å†µä¸‹ï¼ŒGPT-3 åªéœ€é€šè¿‡è‡ªç„¶è¯­è¨€æ–‡æœ¬çš„æ–¹å¼ç»™å‡ºå°‘é‡ç¤ºä¾‹å¹¶æŒ‡å®šä»»åŠ¡å°±å¯ä»¥å®Œæˆå¯¹åº”çš„ä»»åŠ¡ã€‚</p>
<p>åœ¨ <em>Language Models are Few-Shot Learners</em> <sup class="footnote-ref"><a href="#fn7" id="fnref7:1">[7:1]</a></sup> çš„ç¬¬ 2.1 èŠ‚ Model and Architectures ä¸­æŒ‡å‡ºï¼ŒGPT-3 å’Œ GPT-2 çš„æ¨¡å‹æ¶æ„æ˜¯ä¸€è‡´çš„ï¼Œå¹¶ä¸”ä¸ºäº†éªŒè¯å…ˆå‰çš„è®ºæ–‡ <em>Scaling Laws for Neural Language Models</em> <sup class="footnote-ref"><a href="#fn6" id="fnref6:1">[6:1]</a></sup> ä¸­æå‡ºçš„â€œScaling Lawsâ€ï¼ŒOpenAI ç‰¹æ„è®­ç»ƒäº† 8 ä¸ªä¸åŒè§„æ¨¡çš„æ¨¡å‹ã€‚</p>
<blockquote>
<ul>
<li>We use the same model and architecture as GPT-2, including the modified initialization, pre-normalization, and reversible tokenization described therein, with the exception that we use alternating dense and locally banded sparse attention patterns in the layers of the transformer, similar to the Sparse Transformer.</li>
<li>To study the dependence of ML performance on model size, we train 8 different sizes of model, ranging over three orders of magnitude from 125 million parameters to 175 billion parameters, with the last being the model we call GPT-3.</li>
</ul>
</blockquote>
<h3 id="gpt-æ¶æ„çš„æ¼”åŒ–">GPT æ¶æ„çš„æ¼”åŒ–</h3>
<p>å› æ­¤ï¼Œæ ¹æ®å¦‚ä¸Šçš„æè¿°ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡º GPT ç³»åˆ—æ¨¡å‹æ¶æ„çš„æ¼”åŒ–è¿‡ç¨‹å¦‚ä¸‹ï¼š</p>
<p><img src="/2024/10/31/From-Transformer-To-GPT/GPTX_arch.png" alt="ä» Transformer åˆ° GPT æ¶æ„çš„æ¼”åŒ–"></p>
<p>åˆ©ç”¨å¦‚ä¸Šçš„æ¨¡å‹æ¶æ„ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°å¦‚ä¸‹æ‰€ç¤ºçš„å†…å®¹ç”Ÿæˆä»»åŠ¡ï¼š</p>
<p><img src="/2024/10/31/From-Transformer-To-GPT/GPT_demo_for_student.gif" alt="ä½¿ç”¨ GPT è¿›è¡Œå†…å®¹ç»­å†™çš„ç¤ºä¾‹"></p>
<h2 id="gpt-çš„å‹ç¼©æœ¬è´¨">GPT çš„å‹ç¼©æœ¬è´¨</h2>
<p>åœ¨å¦‚ä¸Šçš„ demo ä¸­ï¼ŒGPT æ˜¯å¦‚ä½•æ ¹æ®æç¤ºè¯æ¥ç”Ÿæˆä¸‹ä¸€ä¸ªè¯å‘¢ï¼Ÿ</p>
<p>åœ¨ <a href="/2024/10/16/What-exactly-is-attention/">è‡ªæ³¨æ„åŠ›ç©¶ç«Ÿæ˜¯ä»€ä¹ˆï¼Ÿ</a> è¿™ç¯‡æ–‡ç« çš„ <em>ä¸¾ä¸ªä¾‹å­ğŸŒ°</em> è¿™ä¸€èŠ‚æˆ‘ä»¬æåˆ°ï¼Œç»è¿‡çŸ©é˜µçš„çº¿æ€§å˜æ¢åï¼Œ<code>I am good</code> è¿™ä¸‰ä¸ªè¯çš„è¯å‘é‡ä¹‹é—´å¯ä»¥è¡¨ç¤ºæˆå¦‚ä¸‹çš„å½¢å¼ï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi mathvariant="bold">z</mi><mi mathvariant="bold">I</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mn>0.97</mn><mo>â‹…</mo><msub><mi mathvariant="bold">x</mi><mi mathvariant="bold">I</mi></msub><mo>+</mo><mn>0.02</mn><mo>â‹…</mo><msub><mi mathvariant="bold">x</mi><mrow><mi mathvariant="bold">a</mi><mi mathvariant="bold">m</mi></mrow></msub><mo>+</mo><mn>0.01</mn><mo>â‹…</mo><msub><mi mathvariant="bold">x</mi><mrow><mi mathvariant="bold">g</mi><mi mathvariant="bold">o</mi><mi mathvariant="bold">o</mi><mi mathvariant="bold">d</mi></mrow></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi mathvariant="bold">z</mi><mrow><mi mathvariant="bold">a</mi><mi mathvariant="bold">m</mi></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mn>0.27</mn><mo>â‹…</mo><msub><mi mathvariant="bold">x</mi><mi mathvariant="bold">I</mi></msub><mo>+</mo><mn>0.73</mn><mo>â‹…</mo><msub><mi mathvariant="bold">x</mi><mrow><mi mathvariant="bold">a</mi><mi mathvariant="bold">m</mi></mrow></msub><mo>+</mo><mn>0.00</mn><mo>â‹…</mo><msub><mi mathvariant="bold">x</mi><mrow><mi mathvariant="bold">g</mi><mi mathvariant="bold">o</mi><mi mathvariant="bold">o</mi><mi mathvariant="bold">d</mi></mrow></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi mathvariant="bold">z</mi><mrow><mi mathvariant="bold">g</mi><mi mathvariant="bold">o</mi><mi mathvariant="bold">o</mi><mi mathvariant="bold">d</mi></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mn>0.90</mn><mo>â‹…</mo><msub><mi mathvariant="bold">x</mi><mi mathvariant="bold">I</mi></msub><mo>+</mo><mn>0.05</mn><mo>â‹…</mo><msub><mi mathvariant="bold">x</mi><mrow><mi mathvariant="bold">a</mi><mi mathvariant="bold">m</mi></mrow></msub><mo>+</mo><mn>0.05</mn><mo>â‹…</mo><msub><mi mathvariant="bold">x</mi><mrow><mi mathvariant="bold">g</mi><mi mathvariant="bold">o</mi><mi mathvariant="bold">o</mi><mi mathvariant="bold">d</mi></mrow></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
\mathbf{z_{I}}    &amp;= 0.97 \cdot \mathbf{x_{I}} + 0.02 \cdot \mathbf{x_{am}} + 0.01 \cdot \mathbf{x_{good}} \\
\mathbf{z_{am}}   &amp;= 0.27 \cdot \mathbf{x_{I}} + 0.73 \cdot \mathbf{x_{am}} + 0.00 \cdot \mathbf{x_{good}} \\
\mathbf{z_{good}} &amp;= 0.90 \cdot \mathbf{x_{I}} + 0.05 \cdot \mathbf{x_{am}} + 0.05 \cdot \mathbf{x_{good}}
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.500000000000002em;vertical-align:-2.000000000000001em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5000000000000004em;"><span style="top:-4.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33027699999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight">I</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.161108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight">a</span><span class="mord mathbf mtight">m</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-1.6599999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight" style="margin-right:0.01597em;">g</span><span class="mord mathbf mtight">o</span><span class="mord mathbf mtight">o</span><span class="mord mathbf mtight">d</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.000000000000001em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5000000000000004em;"><span style="top:-4.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span><span class="mord">7</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33027699999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight">I</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.161108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight">a</span><span class="mord mathbf mtight">m</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight" style="margin-right:0.01597em;">g</span><span class="mord mathbf mtight">o</span><span class="mord mathbf mtight">o</span><span class="mord mathbf mtight">d</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">2</span><span class="mord">7</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33027699999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight">I</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">7</span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.161108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight">a</span><span class="mord mathbf mtight">m</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight" style="margin-right:0.01597em;">g</span><span class="mord mathbf mtight">o</span><span class="mord mathbf mtight">o</span><span class="mord mathbf mtight">d</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-1.6599999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33027699999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight">I</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">5</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.161108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight">a</span><span class="mord mathbf mtight">m</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">5</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight" style="margin-right:0.01597em;">g</span><span class="mord mathbf mtight">o</span><span class="mord mathbf mtight">o</span><span class="mord mathbf mtight">d</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.000000000000001em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>æ¢å¥è¯è¯´ï¼Œç»è¿‡è‡ªæ³¨æ„åŠ›æœºåˆ¶åï¼Œæç¤ºè¯ä¸­çš„æœ€åä¸€ä¸ªè¯éƒ½å°†åŒ…å«æç¤ºè¯ä¸­çš„ä»»ä½•ä¸€ä¸ªå•è¯çš„ä¿¡æ¯ã€‚éšç€ Transformer-Decoder çš„å±‚çº§ä¸æ–­å¢åŠ ï¼Œæç¤ºè¯ä¸­çš„æœ€åä¸€ä¸ªè¯æ‰€åŒ…å«çš„ä¿¡æ¯å°†ä¼šè¶Šæ¥è¶Šä¸°å¯Œã€è¶Šæ¥è¶Šç²¾å‡†ã€‚ä»å¦ä¸€ä¸ªè§’åº¦æ¥è®²ï¼Œç»è¿‡å¤šå±‚ Transformer-Decoder ä¹‹åï¼Œæç¤ºè¯ä¸­çš„æ‰€æœ‰ä¿¡æ¯å°†å‹ç¼©è‡³äº†æœ€åä¸€ä¸ªè¯å‘é‡ä¸­ï¼Œç„¶åï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨æœ€åä¸€ä¸ªè¯å‘é‡æ¥ç”Ÿæˆä¸‹ä¸€ä¸ªè¯ã€‚</p>
<p>å…·ä½“çš„è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="/2024/10/31/From-Transformer-To-GPT/llm_compress.png" alt="è¯å‘é‡çš„å¤„ç†æµç¨‹"></p>
<p>è¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆ OpenAI å‰é¦–å¸­ç§‘å­¦å®¶ Ilya Sutskever åœ¨<a href="https://www.youtube.com/watch?v=goOa0biX6Tc&amp;ab_channel=FuVenture">å…¬å¼€é‡‡è®¿</a> ä¸­æŒ‡å‡ºå¤§è§„æ¨¡é¢„è®­ç»ƒæœ¬è´¨ä¸Šæ˜¯åœ¨åšä¸€ä¸ªä¸–ç•ŒçŸ¥è¯†çš„å‹ç¼©ï¼Œä»è€Œèƒ½å¤Ÿå­¦ä¹ åˆ°ä¸€ä¸ªç¼–ç ä¸–ç•ŒçŸ¥è¯†çš„å‚æ•°æ¨¡å‹ï¼Œè¿™ä¸ªæ¨¡å‹èƒ½å¤Ÿé€šè¿‡è§£å‹ç¼©æ‰€éœ€è¦çš„çŸ¥è¯†æ¥è§£å†³çœŸå®ä¸–ç•Œçš„ä»»åŠ¡ã€‚</p>
<p>æ‰€ä»¥ Ilya Sutskever ä¸€ç›´çš„ä¿¡å¿µå°±æ˜¯ï¼š</p>
<blockquote>
<p>å¦‚æœèƒ½å¤Ÿé«˜æ•ˆçš„å‹ç¼©ä¿¡æ¯ï¼Œå°±å·²ç»å¾—åˆ°äº†çŸ¥è¯†ã€‚æƒ³é«˜æ•ˆå‹ç¼©ä¿¡æ¯ï¼Œå°±ä¸€å®šå¾—æœ‰ä¸€äº›çŸ¥è¯†ï¼Œæ‰€ä»¥ä»–åšä¿¡ GPT-3 å’Œæœ€æ–°çš„ GPT-4ï¼Œå®ƒä»¬å·²ç»æœ‰äº†ä¸€ä¸ªä¸–ç•Œæ¨¡å‹åœ¨é‡Œé¢ï¼GPT å­¦çš„å…¶å®ä¸æ˜¯è¯­è¨€ï¼Œè€Œæ˜¯è¯­è¨€èƒŒåçš„é‚£ä¸ªçœŸå®ä¸–ç•Œã€‚</p>
</blockquote>
<p>åœ¨ <a href="https://arxiv.org/pdf/2309.10668">Language Modeling Is Compression</a> è¿™ç¯‡è®ºæ–‡ä¸­ï¼Œä½œè€…ä¹Ÿæåˆ°ï¼š</p>
<blockquote>
<p>ç”±äºå¤§æ¨¡å‹è¡¨ç°å‡ºå¼ºæ‚çš„é¢„æµ‹èƒ½åŠ›ï¼Œå› æ­¤å®ƒä»¬éå¸¸é€‚åˆæˆä¸ºå¼ºå¤§çš„å‹ç¼©å™¨ã€‚æˆ‘ä»¬é€šè¿‡å‹ç¼©çš„è§†è§’æ¥çœ‹å¾…å¤§æ¨¡å‹çš„é¢„æµ‹é—®é¢˜ï¼Œå¹¶è¯„ä¼°äº†å¤§æ¨¡å‹çš„å‹ç¼©èƒ½åŠ›ã€‚</p>
</blockquote>
<h2 id="gpt-æ¨¡å‹çš„å‚æ•°é‡">GPT æ¨¡å‹çš„å‚æ•°é‡</h2>
<p>åœ¨ <em>Language Models are Few-Shot Learners</em> <sup class="footnote-ref"><a href="#fn7" id="fnref7:2">[7:2]</a></sup> ä¸­æåˆ°ï¼ŒGPT-3 çš„å‚æ•°æ•°é‡æ˜¯ 1750 äº¿ï¼Œæˆ‘ä»¬ä¹Ÿç»å¸¸è¯´ ChatGPT çš„å‚æ•°æ•°é‡æ˜¯ 1750 äº¿ï¼Œé‚£ä¹ˆå¦‚ä½•è®¡ç®—æ¨¡å‹çš„å‚æ•°æ•°é‡å‘¢ï¼Ÿ</p>
<p>æ—¢ç„¶ GPT-3 çš„æ¶æ„ã€è¶…å‚æ•°éƒ½æ˜¯å…¬å¼€çš„ï¼Œæˆ‘ä»¬ä¸å¦¨æŒ‰ç…§ç›¸å…³æ•°æ®æ¥æµ‹ç®—ä¸€ä¸‹ GPT-3 çš„å‚æ•°æ•°é‡ï¼Œä¹Ÿå€Ÿè¿™ä¸ªæœºä¼šç†Ÿæ‚‰ä¸€ä¸‹ GPT ç³»åˆ—æ¨¡å‹çš„ç»†èŠ‚ã€‚</p>
<p>å¯¹äºä¹‹å‰çš„æ–‡æœ¬ç”Ÿæˆçš„ä¾‹å­ï¼Œä¸‹å›¾å±•ç¤ºäº†å…¶ä¸­çš„ä¸€ä¸ªè¿­ä»£çš„è¯¦ç»†è¿‡ç¨‹ï¼š</p>
<p><img src="/2024/10/31/From-Transformer-To-GPT/GPT_arch_detail.png" alt="GPT é¢„æµ‹ä¸‹ä¸€ä¸ªè¯çš„è¯¦ç»†è¿‡ç¨‹"></p>
<p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå¯¹äº GPT æ¶æ„è€Œè¨€ï¼Œæ•´ä¸ªé¢„æµ‹çš„è¿‡ç¨‹å¯ä»¥åˆ†ä¸º 6 ä¸ªæ­¥éª¤ï¼š</p>
<ol>
<li>
<p>åˆ†è¯<br>
å¯¹äºåŸå§‹çš„è¾“å…¥ <code>æˆ‘æ˜¯ä¸€ä¸ªå­¦ç”Ÿ</code>ï¼Œé¦–å…ˆéœ€è¦ä½¿ç”¨æŸç§åˆ†è¯ç®—æ³•è¿›è¡Œåˆ†è¯ï¼Œå¹¶å¾—åˆ°åˆ†è¯ä¹‹åçš„ Tokens åºåˆ—ï¼š</p>
<blockquote>
<p>tokens = [æˆ‘æ˜¯, ä¸€ä¸ª, å­¦ç”Ÿ]</p>
</blockquote>
<p>ä»¥ GPT-3 ä¸ºä¾‹ï¼Œæ¨¡å‹çš„æ€»è¯æ±‡é‡ï¼ˆtokensï¼‰ä¸º 50257ï¼Œæ¯ä¸ª token éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„ ID åºå·ï¼Œæ¯”å¦‚ <code>tokens = [æˆ‘æ˜¯, ä¸€ä¸ª, å­¦ç”Ÿ]</code> å¯¹åº”çš„ ID åºå·ä¸ºï¼š</p>
<blockquote>
<p>tokens = [176389, 22912, 52770]</p>
</blockquote>
<p>å¯¹äºåˆ†è¯è€Œè¨€ï¼Œå¹¶ä¸æ¶‰åŠåˆ°ä»»ä½•çš„æ¨¡å‹å‚æ•°ï¼Œç”±äºæ¶‰åŠåˆ°çš„è®¡ç®—é‡å¹¶ä¸å¤§ï¼Œå› æ­¤æ•´ä½“çš„æ“ä½œå‡åœ¨ CPU ä¸Šå®Œæˆã€‚å¾—åˆ° tokens åï¼Œç„¶åå°†å¯¹åº”çš„åºåˆ—å‘é€ç»™ GPU è¿›è¡Œè®¡ç®—ã€‚</p>
</li>
<li>
<p>è¯åµŒå…¥<br>
æ¨¡å‹éœ€è¦æ ¹æ® <code>tokens = [176389, 22912, 52770]</code> ä¸­çš„ ID å¾—åˆ°å¯¹åº” token çš„è¯å‘é‡ï¼Œå¹¶ç»„è£…æˆçŸ©é˜µå½¢å¼çš„è¾“å…¥åºåˆ— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">X</mi></mrow><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">X</span></span></span></span></span>ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œéœ€è¦ä½¿ç”¨æ¨¡å‹çš„è¯åµŒå…¥çŸ©é˜µï¼Œè¯¥çŸ©é˜µçš„æ¯ä¸€è¡Œä»£è¡¨ä¸€ä¸ª token çš„è¯å‘é‡ï¼Œè¯åµŒå…¥çŸ©é˜µçš„ç»´åº¦ä¾èµ–äºå…·ä½“çš„æ¨¡å‹ã€‚ä»¥ GPT-3 ä¸ºä¾‹ï¼Œå…¶è¯æ±‡é‡ä¸º 50257ï¼Œæ¯ä¸ª token çš„ç»´åº¦ä¸º 12288ï¼Œæ‰€ä»¥ GPT-3 çš„è¯åµŒå…¥çŸ©é˜µçš„ç»´åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>50257</mn><mo>Ã—</mo><mn>12288</mn></mrow><annotation encoding="application/x-tex">50257 \times 12288</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">5</span><span class="mord">0</span><span class="mord">2</span><span class="mord">5</span><span class="mord">7</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">2</span><span class="mord">2</span><span class="mord">8</span><span class="mord">8</span></span></span></span>ï¼Œä¹Ÿå°±æ˜¯å…±è®¡æœ‰ <code>617,558,016</code> ä¸ªå‚æ•°ã€‚</p>
</li>
<li>
<p>ä½ç½®åµŒå…¥<br>
æ ¹æ® <a href="/2024/10/16/What-exactly-is-attention/#transformer-%E4%B8%AD%E7%9A%84-positional-encoding">è‡ªæ³¨æ„åŠ›ç©¶ç«Ÿæ˜¯ä»€ä¹ˆï¼Ÿä¸­çš„ Transformer ä¸­çš„ Positional Encoding ä¸€èŠ‚</a> ä¸­çš„ä»‹ç»ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å¯¹è¾“å…¥çš„çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">X</mi></mrow><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">X</span></span></span></span></span> å¢åŠ ä½ç½®ä¿¡æ¯ï¼Œå¹¶å¾—åˆ°å«æœ‰ä½ç½®ä¿¡æ¯çš„è¾“å…¥çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">X</mi></mrow><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">X</span></span></span></span></span>ã€‚è€Œåœ¨è¯¥æ­¥éª¤ä¸­ï¼Œéœ€è¦ä½¿ç”¨åˆ°æ¨¡å‹çš„ä½ç½®åµŒå…¥çŸ©é˜µï¼Œè¯¥çŸ©é˜µçš„è¡Œæ•°å’Œæ¨¡å‹çš„ä¸Šä¸‹æ–‡å¤§å°ä¸€è‡´ï¼Œå¹¶ä¸”æ¯ä¸€è¡Œçš„å¤§å°å’Œæ¨¡å‹çš„è¯åµŒå…¥çŸ©é˜µä¸­æ¯ä¸ª token çš„ç»´åº¦ä¸€è‡´ã€‚ä»¥ GPT-3 ä¸ºä¾‹ï¼Œå…¶æ¨¡å‹ä¸Šä¸‹æ–‡å¤§å°ä¸º 2048ï¼Œæ‰€ä»¥ GPT-3 çš„ä½ç½®åµŒå…¥çŸ©é˜µçš„ç»´åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2048</mn><mo>Ã—</mo><mn>12288</mn></mrow><annotation encoding="application/x-tex">2048 \times 12288</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mord">4</span><span class="mord">8</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">2</span><span class="mord">2</span><span class="mord">8</span><span class="mord">8</span></span></span></span>ï¼Œä¹Ÿå°±æ˜¯å…±è®¡æœ‰ <code>25,165,824</code> ä¸ªå‚æ•°ã€‚</p>
</li>
<li>
<p>è®¡ç®—è‡ªæ³¨æ„åŠ›<br>
æ¥ä¸‹æ¥ï¼Œéœ€è¦æ ¹æ®è¾“å…¥çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">X</mi></mrow><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">X</span></span></span></span></span> è®¡ç®—è‡ªæ³¨æ„åŠ›ï¼Œæ ¹æ®ä¹‹å‰çš„ä»‹ç»ï¼Œéœ€è¦é¦–å…ˆåˆ©ç”¨ 3 ä¸ªæƒé‡çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold">W</mi><mi>Q</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{W}^Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">Q</span></span></span></span></span></span></span></span></span></span></span>ã€<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold">W</mi><mi>K</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{W}^K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07153em;">K</span></span></span></span></span></span></span></span></span></span></span>ã€<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold">W</mi><mi>V</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{W}^V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">V</span></span></span></span></span></span></span></span></span></span></span> å¯¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">X</mi></mrow><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">X</span></span></span></span></span> è¿›è¡Œçº¿æ€§å˜æ¢å¹¶å¾—åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">Q</mi></mrow><annotation encoding="application/x-tex">\mathbf{Q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8805499999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathbf">Q</span></span></span></span></span>ã€<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">K</mi></mrow><annotation encoding="application/x-tex">\mathbf{K}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">K</span></span></span></span></span>ã€<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">V</mi></mrow><annotation encoding="application/x-tex">\mathbf{V}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span></span></span></span>ï¼Œç„¶ååˆ©ç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Attention</mtext><mo stretchy="false">(</mo><mi mathvariant="bold">Q</mi><mo separator="true">,</mo><mi mathvariant="bold">K</mi><mo separator="true">,</mo><mi mathvariant="bold">V</mi><mo stretchy="false">)</mo><mo>=</mo><mtext>softmax</mtext><mrow><mo fence="true">(</mo><mfrac><mrow><mi mathvariant="bold">Q</mi><msup><mi mathvariant="bold">K</mi><mi>T</mi></msup></mrow><msqrt><msub><mi>d</mi><mi>k</mi></msub></msqrt></mfrac><mo fence="true">)</mo></mrow><mi mathvariant="bold">V</mi></mrow><annotation encoding="application/x-tex">\text{Attention}(\mathbf{Q},\mathbf{K},\mathbf{V})=\text{softmax}\left(\frac{\mathbf{Q}\mathbf{K}^T}{\sqrt{d_k}}\right)\mathbf{V}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Attention</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">Q</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf">K</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.80002em;vertical-align:-0.65002em;"></span><span class="mord text"><span class="mord">softmax</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.089473em;"><span style="top:-2.5864385em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8622307142857143em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mtight" style="padding-left:0.833em;"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.8222307142857144em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.08em;"><svg width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.17776928571428574em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.446108em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">Q</span></span><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">K</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9190928571428572em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.538em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span></span></span></span> è®¡ç®—è‡ªæ³¨æ„åŠ›ã€‚åœ¨ GPT-3 ä¸­ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold">W</mi><mi>Q</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{W}^Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">Q</span></span></span></span></span></span></span></span></span></span></span>ã€<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold">W</mi><mi>K</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{W}^K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07153em;">K</span></span></span></span></span></span></span></span></span></span></span>ã€<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold">W</mi><mi>V</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{W}^V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">V</span></span></span></span></span></span></span></span></span></span></span> çš„ç»´åº¦å‡ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>12288</mn><mo>Ã—</mo><mn>128</mn></mrow><annotation encoding="application/x-tex">12288 \times 128</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mord">2</span><span class="mord">2</span><span class="mord">8</span><span class="mord">8</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">2</span><span class="mord">8</span></span></span></span>ï¼Œå¹¶ä¸”æ¯ä¸ªè§£ç å™¨åŒ…å« 96 ä¸ªè‡ªæ³¨æ„åŠ›æ¨¡å—ï¼Œå› æ­¤å…±è®¡æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>12288</mn><mo>Ã—</mo><mn>128</mn><mo>Ã—</mo><mn>3</mn><mo>Ã—</mo><mn>96</mn></mrow><annotation encoding="application/x-tex">12288 \times 128 \times 3 \times 96</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mord">2</span><span class="mord">2</span><span class="mord">8</span><span class="mord">8</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mord">2</span><span class="mord">8</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">9</span><span class="mord">6</span></span></span></span>â€”â€”å³ <code>452,984,832</code> ä¸ªå‚æ•°ã€‚å¯¹äºå¤šå¤´æ³¨æ„åŠ›è®¡ç®—çš„ç»“æœï¼Œè¿˜éœ€è¦ä½¿ç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>96</mn><mo>âˆ—</mo><mn>128</mn><mo>Ã—</mo><mn>12288</mn></mrow><annotation encoding="application/x-tex">96*128 \times 12288</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">9</span><span class="mord">6</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mord">2</span><span class="mord">8</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">2</span><span class="mord">2</span><span class="mord">8</span><span class="mord">8</span></span></span></span> çš„çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold">W</mi><mi>O</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{W}^O</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">O</span></span></span></span></span></span></span></span></span></span></span> å¯¹å…¶è¿›è¡Œçº¿æ€§å˜æ¢ï¼Œå› æ­¤è¿˜éœ€è¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>96</mn><mo>âˆ—</mo><mn>128</mn><mo>Ã—</mo><mn>12288</mn></mrow><annotation encoding="application/x-tex">96*128 \times 12288</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">9</span><span class="mord">6</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mord">2</span><span class="mord">8</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">2</span><span class="mord">2</span><span class="mord">8</span><span class="mord">8</span></span></span></span>â€”â€”å³ <code>150,994,944</code> ä¸ªå‚æ•°ã€‚å› æ­¤ï¼Œå¯¹äºæ¯ä¸ªè§£ç å™¨è€Œè¨€ï¼Œè‡ªæ³¨æ„åŠ›æ¨¡å—çš„å‚æ•°å…±è®¡æœ‰ <code>603,979,776</code> ä¸ªå‚æ•°ã€‚è€Œ GPT-3 ä¸­ï¼Œå…±è®¡åŒ…å« 96 ä¸ªè§£ç å™¨ï¼Œå› æ­¤å…±è®¡æœ‰ <code>57,982,058,496</code> ä¸ªå‚æ•°ã€‚</p>
</li>
</ol>
<p><img src="/2024/10/31/From-Transformer-To-GPT/mhattention_parameters.png" alt></p>
<ol start="5">
<li>å‰å‘åé¦ˆç½‘ç»œå¤„ç†<br>
å‰å‘è¿æ¥å±‚çš„è®¡ç®—å…¬å¼ä¸ºï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>FFN</mtext><mo stretchy="false">(</mo><mi mathvariant="bold">x</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">(</mo><mfrac><mrow><mi mathvariant="bold">x</mi><msub><mi mathvariant="bold">W</mi><mn>1</mn></msub><mo>+</mo><msub><mi mathvariant="bold">b</mi><mn>1</mn></msub></mrow><mn>2</mn></mfrac><mo>â‹…</mo><mi mathvariant="normal">Î¦</mi><mo stretchy="false">(</mo><mi mathvariant="bold">x</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow><msub><mi mathvariant="bold">W</mi><mn>2</mn></msub><mo>+</mo><msub><mi mathvariant="bold">b</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\text{FFN}(\mathbf{x}) = \left( \frac{\mathbf{x}\mathbf{W}_1 + \mathbf{b}_1}{2} \cdot \Phi(\mathbf{x}) \right)\mathbf{W}_2 + \mathbf{b}_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">FFN</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2462179999999998em;vertical-align:-0.35001em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8962079999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">x</span></span><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight" style="margin-right:0.01597em;">W</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">b</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">Î¦</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span></span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">b</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œå› æ­¤ï¼Œå…¶å‚æ•°åŒ…æ‹¬å››ä¸ªéƒ¨åˆ†ï¼šä¸¤ä¸ªæƒé‡çŸ©é˜µå’Œä¸¤ä¸ªåç½®å˜æ¢ã€‚æƒé‡çŸ©é˜µçš„ç»´åº¦ = è¯å‘é‡ç»´åº¦ * éšè—å±‚ç»´åº¦ï¼Œåœ¨ GPT-3 ä¸­ï¼Œéšè—å±‚ç»´åº¦ä¸º 4 å€è¯å‘é‡ç»´åº¦ï¼Œå› æ­¤ï¼Œå‰å‘åé¦ˆç½‘ç»œçš„å‚æ•°é‡ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>12288</mn><mo>âˆ—</mo><mo stretchy="false">(</mo><mn>12288</mn><mo>âˆ—</mo><mn>4</mn><mo stretchy="false">)</mo><mo>âˆ—</mo><mn>2</mn><mo>+</mo><mn>12288</mn><mo>âˆ—</mo><mn>4</mn><mo>+</mo><mn>12288</mn></mrow><annotation encoding="application/x-tex">12288 * (12288 * 4) * 2 + 12288 * 4 + 12288</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">2</span><span class="mord">2</span><span class="mord">8</span><span class="mord">8</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mord">2</span><span class="mord">2</span><span class="mord">8</span><span class="mord">8</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">4</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">2</span><span class="mord">2</span><span class="mord">8</span><span class="mord">8</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">2</span><span class="mord">2</span><span class="mord">8</span><span class="mord">8</span></span></span></span>â€”â€”å³ <code>1,208,020,992</code> ä¸ªå‚æ•°ã€‚è€Œ GPT-3 ä¸­ï¼Œå…±è®¡åŒ…å« 96 ä¸ªè§£ç å™¨ï¼Œå› æ­¤å…±è®¡æœ‰ <code>115,970,015,232</code> ä¸ªå‚æ•°ã€‚</li>
<li>çº¿æ€§å±‚ç”Ÿæˆ logit å‘é‡ å¹¶è®¡ç®—æ¦‚ç‡<br>
æœ€ç»ˆï¼Œç»è¿‡ 96 å±‚çš„è§£ç å™¨ä¹‹åï¼Œæˆ‘ä»¬å¾—åˆ°äº†æœ€åä¸€ä¸ªè¯çš„å‘é‡è¡¨ç¤º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">h</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{h}_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">h</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œç„¶ååˆ©ç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>softmax</mtext><mo stretchy="false">(</mo><msub><mi mathvariant="bold">h</mi><mi>n</mi></msub><msubsup><mi mathvariant="bold">W</mi><mi>e</mi><mi>T</mi></msubsup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{softmax}(\mathbf{h}_n\mathbf{W}_e^T)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">softmax</span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">h</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-2.4530000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">e</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> è®¡ç®—ä¸‹ä¸€ä¸ªè¯çš„å¯èƒ½æ¦‚ç‡ã€‚ç”±äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="bold">W</mi><mi>e</mi><mi>T</mi></msubsup></mrow><annotation encoding="application/x-tex">\mathbf{W}_e^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.088331em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-2.4530000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">e</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span> å’Œæ¨¡å‹çš„è¯å‘é‡çŸ©é˜µæ˜¯ä¸€è‡´çš„ï¼Œå› æ­¤ä¸éœ€è¦é¢å¤–çš„å‚æ•°ã€‚</li>
</ol>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition note"><p class="admonition-title">å½’ä¸€åŒ–å±‚çš„å‚æ•°
</p><p>å¯¹äº GPT-3 æ¨¡å‹è€Œè¨€ï¼Œé™¤äº†å¦‚ä¸Šçš„æ­¥éª¤å¤–ï¼Œåœ¨æ¯ä¸€ä¸ªè§£ç å™¨ä¸­ï¼Œè¿˜ä¼šæœ‰ 2 ä¸ªå½’ä¸€åŒ–å±‚ï¼ŒåŒæ—¶åœ¨æœ€åä¸€ä¸ªè§£ç å™¨ä¹‹åï¼Œè¿˜å¢åŠ äº†ä¸€ä¸ªé¢å¤–çš„å½’ä¸€åŒ–å±‚ï¼Œå…¶ä¸»è¦ä½œç”¨ä¸ºï¼š</p>
<ul>
<li>ç¨³å®šè®­ç»ƒè¿‡ç¨‹ï¼šåœ¨æ·±åº¦ç¥ç»ç½‘ç»œä¸­ï¼Œå±‚å½’ä¸€åŒ–é€šè¿‡å°†æ¯å±‚çš„è¾“å…¥æ ‡å‡†åŒ–ä¸ºç›¸åŒçš„åˆ†å¸ƒï¼Œå‡å°‘äº†æ¢¯åº¦çˆ†ç‚¸æˆ–æ¢¯åº¦æ¶ˆå¤±çš„é—®é¢˜ï¼Œä½¿æ¨¡å‹èƒ½å¤Ÿæ›´ç¨³å®šåœ°è¿›è¡Œè®­ç»ƒã€‚</li>
<li>åŠ é€Ÿæ”¶æ•›ï¼šå½’ä¸€åŒ–å±‚å¯ä»¥ä½¿æ¨¡å‹åœ¨è®­ç»ƒä¸­æ›´å¿«åœ°æ‰¾åˆ°åˆé€‚çš„æƒé‡å‚æ•°ï¼Œé€šå¸¸ä¼šåŠ å¿«æ¨¡å‹çš„æ”¶æ•›é€Ÿåº¦ï¼Œä»è€Œç¼©çŸ­è®­ç»ƒæ—¶é—´ã€‚</li>
<li>å‡å°å†…éƒ¨åå˜é‡åç§»ï¼šå½’ä¸€åŒ–å±‚é€šè¿‡ä½¿è¾“å…¥åˆ†å¸ƒä¿æŒä¸€è‡´ï¼Œå‡å°‘äº†æ¯å±‚çš„æ¿€æ´»åˆ†å¸ƒéšè®­ç»ƒè€Œå‘ç”Ÿçš„å˜åŒ–ï¼Œä»è€Œæœ‰åŠ©äºæ¨¡å‹æ›´å®¹æ˜“æ•æ‰æ•°æ®çš„ç‰¹å¾ã€‚</li>
<li>æå‡æ³›åŒ–èƒ½åŠ›ï¼šå½’ä¸€åŒ–æ“ä½œå¯ä»¥ä½¿æ¨¡å‹çš„è®­ç»ƒæ›´å…·é²æ£’æ€§ï¼Œä»è€Œåœ¨æµ‹è¯•æ•°æ®ä¸Šè¡¨ç°æ›´å¥½ï¼Œæé«˜æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ã€‚</li>
</ul>
<p>å½’ä¸€åŒ–å±‚åªæ¶‰åŠåˆ°ä¸¤ä¸ªå‚æ•°ï¼šç¼©æ”¾å‚æ•°ï¼ˆgammaï¼‰å’Œåç§»å‚æ•°ï¼ˆbetaï¼‰ï¼Œè¿™ä¸¤ä¸ªå‚æ•°çš„å¤§å°å’Œæ¨¡å‹çš„è¯å‘é‡ç»´åº¦å¤§å°ä¸€è‡´ã€‚å› æ­¤ï¼Œå¯¹äº GPT-3 è€Œè¨€ï¼Œæ¯ä¸ªå½’ä¸€åŒ–å±‚éœ€è¦ <code>12288 * 2 = 24,576</code> ä¸ªå‚æ•°ã€‚</p>
</div>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„ä»£ç æ¥è®¡ç®— GPT çš„å‚æ•°æ•°é‡ï¼Œå®Œæ•´çš„ä»£ç å‚è§ <a href="https://github.com/wangwei1237/R/blob/main/llm_parameters.R">llm_parameters.R</a>ã€‚</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">get_llm_parameters_cnt &lt;- <span class="keyword">function</span>(</span><br><span class="line">  model_name = <span class="string">&quot;&quot;</span>,</span><br><span class="line">  n_vocabulary,    <span class="comment"># æ¨¡å‹çš„æ€» token é‡</span></span><br><span class="line">  n_ctx,           <span class="comment"># æ¨¡å‹çš„ prompt çª—å£å¤§å°</span></span><br><span class="line">  d_model,         <span class="comment"># æ¨¡å‹çš„ embedding å‘é‡ç»´åº¦</span></span><br><span class="line">  d_q,             <span class="comment"># W^Q çŸ©é˜µçš„è¡Œå‘é‡ç»´åº¦</span></span><br><span class="line">  d_k,             <span class="comment"># W^K çŸ©é˜µçš„è¡Œå‘é‡ç»´åº¦</span></span><br><span class="line">  d_v,             <span class="comment"># W^V çŸ©é˜µçš„è¡Œå‘é‡ç»´åº¦</span></span><br><span class="line">  n_heads,         <span class="comment"># æ¯ä¸€ä¸ªè§£ç å™¨ä¸­å¤šå¤´æ³¨æ„åŠ›çŸ©é˜µçš„å¤´æ•°</span></span><br><span class="line">  n_layers,        <span class="comment"># è§£ç å™¨çš„å±‚æ•°</span></span><br><span class="line">  d_ff             <span class="comment"># å‰å‘åé¦ˆç½‘ç»œéšè—å±‚çš„ç»´åº¦</span></span><br><span class="line">) &#123;</span><br><span class="line">  n_embedding  &lt;- n_vocabulary * d_model</span><br><span class="line">  n_position   &lt;- n_ctx * d_model</span><br><span class="line"></span><br><span class="line">  <span class="comment"># n_layers å±‚è§£ç å™¨çš„æ€»å‚æ•°</span></span><br><span class="line">  n_attention  &lt;- n_layers * single_decoder_attention_cnt(d_model,</span><br><span class="line">                                                          d_q,</span><br><span class="line">                                                          d_k,</span><br><span class="line">                                                          d_v,</span><br><span class="line">                                                          n_heads)</span><br><span class="line">  n_ffn        &lt;- n_layers * single_decoder_ffn_cnt(d_model, d_ff)</span><br><span class="line">  n_norm       &lt;- n_layers * single_decoder_norm_cnt(d_model)</span><br><span class="line">  n_top_norm   &lt;- 2 * d_model <span class="comment"># æœ€é¡¶å±‚çš„ Norm å±‚çš„å‚æ•°</span></span><br><span class="line"></span><br><span class="line">  total_params &lt;- n_embedding + n_position + n_attention + n_ffn + n_norm +</span><br><span class="line">    n_top_norm</span><br><span class="line"></span><br><span class="line">  <span class="comment"># è¾“å‡ºç›¸å…³å‚æ•°</span></span><br><span class="line">  df &lt;- data.frame(Model     = model_name,</span><br><span class="line">                   Embedding = n_embedding,</span><br><span class="line">                   Emd_Rate  = <span class="built_in">round</span>(n_embedding / total_params, <span class="number">1</span>),</span><br><span class="line">                   Position  = n_position,</span><br><span class="line">                   Attention = n_attention,</span><br><span class="line">                   Atn_Rate  = <span class="built_in">round</span>(n_attention / total_params, <span class="number">1</span>),</span><br><span class="line">                   Ffn       = n_ffn,</span><br><span class="line">                   Ffn_Rate  = <span class="built_in">round</span>(n_ffn / total_params, <span class="number">1</span>),</span><br><span class="line">                   Norm      = n_norm,</span><br><span class="line">                   Total     = total_params)</span><br><span class="line">  print(kable(df, format = <span class="string">&quot;markdown&quot;</span>))</span><br><span class="line"></span><br><span class="line">  <span class="built_in">return</span>(total_params)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ ¹æ®è®ºæ–‡ä¸­å…¬å¼€çš„æ¨¡å‹è¶…å‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸åŒæ¨¡å‹çš„å‚æ•°æ•°é‡ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">llm_list &lt;- <span class="built_in">list</span>(</span><br><span class="line">  <span class="built_in">list</span>(model_name = <span class="string">&quot;GPT-1&quot;</span>,</span><br><span class="line">       n_vocabulary = <span class="number">40000</span>,</span><br><span class="line">       n_ctx = <span class="number">512</span>,</span><br><span class="line">       d_model = <span class="number">768</span>,</span><br><span class="line">       d_q = <span class="number">64</span>,</span><br><span class="line">       d_k = <span class="number">64</span>,</span><br><span class="line">       d_v = <span class="number">64</span>,</span><br><span class="line">       n_heads = <span class="number">12</span>,</span><br><span class="line">       n_layers = <span class="number">12</span>,</span><br><span class="line">       d_ff = <span class="number">768</span> * <span class="number">4</span>),</span><br><span class="line">  ...</span><br><span class="line">  ...</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">get_llm_list_parameters_cnt(llm_list)</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th style="text-align:left">Model</th>
<th style="text-align:right">Embedding</th>
<th style="text-align:right">Emd_Rate</th>
<th style="text-align:right">Position</th>
<th style="text-align:right">Attention</th>
<th style="text-align:right">Atn_Rate</th>
<th style="text-align:right">Ffn</th>
<th style="text-align:right">Ffn_Rate</th>
<th style="text-align:right">Norm</th>
<th style="text-align:right">Total</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">GPT-1</td>
<td style="text-align:right">30720000</td>
<td style="text-align:right">0.3</td>
<td style="text-align:right">393216</td>
<td style="text-align:right">28311552</td>
<td style="text-align:right">0.2</td>
<td style="text-align:right">56669184</td>
<td style="text-align:right">0.5</td>
<td style="text-align:right">36864</td>
<td style="text-align:right">116132352</td>
</tr>
<tr>
<td style="text-align:left">GPT-2-Small</td>
<td style="text-align:right">38597376</td>
<td style="text-align:right">0.3</td>
<td style="text-align:right">786432</td>
<td style="text-align:right">28311552</td>
<td style="text-align:right">0.2</td>
<td style="text-align:right">56669184</td>
<td style="text-align:right">0.5</td>
<td style="text-align:right">36864</td>
<td style="text-align:right">124402944</td>
</tr>
<tr>
<td style="text-align:left">GPT-3-Small</td>
<td style="text-align:right">38597376</td>
<td style="text-align:right">0.3</td>
<td style="text-align:right">1572864</td>
<td style="text-align:right">28311552</td>
<td style="text-align:right">0.2</td>
<td style="text-align:right">56669184</td>
<td style="text-align:right">0.5</td>
<td style="text-align:right">36864</td>
<td style="text-align:right">125189376</td>
</tr>
<tr>
<td style="text-align:left">GPT-3-Medium</td>
<td style="text-align:right">51463168</td>
<td style="text-align:right">0.1</td>
<td style="text-align:right">2097152</td>
<td style="text-align:right">100663296</td>
<td style="text-align:right">0.3</td>
<td style="text-align:right">201449472</td>
<td style="text-align:right">0.6</td>
<td style="text-align:right">98304</td>
<td style="text-align:right">355773440</td>
</tr>
<tr>
<td style="text-align:left">GPT-3-Large</td>
<td style="text-align:right">77194752</td>
<td style="text-align:right">0.1</td>
<td style="text-align:right">3145728</td>
<td style="text-align:right">226492416</td>
<td style="text-align:right">0.3</td>
<td style="text-align:right">453169152</td>
<td style="text-align:right">0.6</td>
<td style="text-align:right">147456</td>
<td style="text-align:right">760152576</td>
</tr>
<tr>
<td style="text-align:left">GPT-3-XL</td>
<td style="text-align:right">102926336</td>
<td style="text-align:right">0.1</td>
<td style="text-align:right">4194304</td>
<td style="text-align:right">603979776</td>
<td style="text-align:right">0.4</td>
<td style="text-align:right">805552128</td>
<td style="text-align:right">0.5</td>
<td style="text-align:right">196608</td>
<td style="text-align:right">1516853248</td>
</tr>
<tr>
<td style="text-align:left">GPT-3-2.7B</td>
<td style="text-align:right">128657920</td>
<td style="text-align:right">0.0</td>
<td style="text-align:right">5242880</td>
<td style="text-align:right">838860800</td>
<td style="text-align:right">0.3</td>
<td style="text-align:right">1678131200</td>
<td style="text-align:right">0.6</td>
<td style="text-align:right">327680</td>
<td style="text-align:right">2651225600</td>
</tr>
<tr>
<td style="text-align:left">GPT-3-6.7B</td>
<td style="text-align:right">205852672</td>
<td style="text-align:right">0.0</td>
<td style="text-align:right">8388608</td>
<td style="text-align:right">2147483648</td>
<td style="text-align:right">0.3</td>
<td style="text-align:right">4295622656</td>
<td style="text-align:right">0.6</td>
<td style="text-align:right">524288</td>
<td style="text-align:right">6657880064</td>
</tr>
<tr>
<td style="text-align:left">GPT-3-13B</td>
<td style="text-align:right">258320980</td>
<td style="text-align:right">0.0</td>
<td style="text-align:right">10526720</td>
<td style="text-align:right">4210688000</td>
<td style="text-align:right">0.3</td>
<td style="text-align:right">8455300000</td>
<td style="text-align:right">0.7</td>
<td style="text-align:right">822400</td>
<td style="text-align:right">12935668380</td>
</tr>
<tr>
<td style="text-align:left">GPT-3-175B</td>
<td style="text-align:right">617558016</td>
<td style="text-align:right">0.0</td>
<td style="text-align:right">25165824</td>
<td style="text-align:right">57982058496</td>
<td style="text-align:right">0.3</td>
<td style="text-align:right">115970015232</td>
<td style="text-align:right">0.7</td>
<td style="text-align:right">4718592</td>
<td style="text-align:right">174599540736</td>
</tr>
</tbody>
</table>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition attention"><p class="admonition-title">Attention Is (Not) All You Need
</p><p>æ ¹æ®å¦‚ä¸Šçš„å‚æ•°é‡è¡¨æ ¼ï¼Œåœ¨ GPT æ¶æ„ä¸­ï¼ŒAttention å±‚çš„å‚æ•°å æ•´ä¸ªæ¨¡å‹çš„å‚æ•°çš„å æ¯”åœ¨ 20%~40%ï¼Œç‰¹åˆ«åœ¨ GPT-3-175B æ¨¡å‹ä¸­ï¼ŒAttention å±‚çš„å‚æ•°å æ¯”åªæœ‰ 30%ã€‚å› æ­¤ï¼Œåœ¨å¤§æ¨¡å‹æ¶æ„ä¸­ï¼ŒAttention å¹¶éæ˜¯æ¨¡å‹çš„å…¨éƒ¨ï¼Œ<em>Attention Is <strong>(Not)</strong> All You Need</em>ï¼Œè¿™ä¸€ç‚¹éœ€è¦ç‰¹åˆ«çš„æ³¨æ„ã€‚</p>
</div>
<h2 id="å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</h2>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p><a href="https://openai.com/index/language-unsupervised/">Improving Language Understanding by Generative Pre-Training</a> <a href="#fnref1" class="footnote-backref">â†©ï¸</a> <a href="#fnref1:1" class="footnote-backref">â†©ï¸</a> <a href="#fnref1:2" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn2" class="footnote-item"><p><a href="https://arxiv.org/abs/1810.04805">BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding</a> <a href="#fnref2" class="footnote-backref">â†©ï¸</a> <a href="#fnref2:1" class="footnote-backref">â†©ï¸</a> <a href="#fnref2:2" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn3" class="footnote-item"><p><a href="https://arxiv.org/abs/2203.02155">Training language models to follow instructions with human feedback</a> <a href="#fnref3" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn4" class="footnote-item"><p><a href="https://arxiv.org/abs/2304.13712">Harnessing the Power of LLMs in Practice: A Survey on ChatGPT and Beyond</a> <a href="#fnref4" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn5" class="footnote-item"><p><a href="https://arxiv.org/abs/1910.10683">Exploring the Limits of Transfer Learning with a Unified Text-to-Text Transformer</a> <a href="#fnref5" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn6" class="footnote-item"><p><a href="https://arxiv.org/abs/2001.08361">Scaling Laws for Neural Language Models</a> <a href="#fnref6" class="footnote-backref">â†©ï¸</a> <a href="#fnref6:1" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn7" class="footnote-item"><p><a href="https://arxiv.org/abs/2005.14165">Language Models are Few-Shot Learners</a> <a href="#fnref7" class="footnote-backref">â†©ï¸</a> <a href="#fnref7:1" class="footnote-backref">â†©ï¸</a> <a href="#fnref7:2" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn8" class="footnote-item"><p><a href="https://cdn.openai.com/better-language-models/language_models_are_unsupervised_multitask_learners.pdf">Language Models are Unsupervised Multitask Learners</a> <a href="#fnref8" class="footnote-backref">â†©ï¸</a></p>
</li>
</ol>
</section>
]]></content>
      <categories>
        <category>LLM</category>
      </categories>
      <tags>
        <tag>GPT</tag>
        <tag>Transformer</tag>
      </tags>
  </entry>
  <entry>
    <title>è‡ªæ³¨æ„åŠ›ç©¶ç«Ÿæ˜¯ä»€ä¹ˆï¼Ÿ</title>
    <url>/2024/10/16/What-exactly-is-attention/</url>
    <content><![CDATA[<p><img src="/2024/10/16/What-exactly-is-attention/1.png" alt></p>
<p>æœ€è¿‘çš„ 1 å¹´å¤šä»¥æ¥ï¼Œä¸€ç›´ä½¿ç”¨ æ–‡å¿ƒä¸€è¨€ã€è±†åŒ…ã€Kimi ç­‰å¤§æ¨¡å‹æ¥å¸®åŠ©è‡ªå·±æé«˜å„ç§åœºæ™¯çš„æ•ˆç‡ï¼Œä½†æ˜¯ä¸€ç›´æ²¡æœ‰å¯¹å½“å‰å¤§æ¨¡å‹çš„åº•å±‚åŸç†åšæ·±å…¥äº†è§£ã€‚åœ¨ç¼–å†™ <a href="https://wangwei1237.github.io/LLM_in_Action/">Large Language Model in Action</a> è¿™æœ¬ä¹¦çš„æ—¶å€™ï¼Œæˆ‘ä¹Ÿæ›¾è¯´è¿‡ï¼š</p>
<blockquote>
<p>è¿™æ˜¯ä¸€æœ¬å…³äºå¤§è¯­è¨€æ¨¡å‹å®è·µçš„ä¹¦ç±ï¼Œè€Œä¸æ˜¯ä¸€æœ¬æ·±å…¥ç ”ç©¶å¤§è¯­è¨€æ¨¡å‹çš„è¿è¡ŒåŸç†å’Œåº•å±‚ç®—æ³•çš„ä¹¦ç±ã€‚</p>
</blockquote>
<p>ä½†æ˜¯ï¼Œ2024 å¹´ 10 æœˆ 1 æ—¥ï¼ŒOpenAI å‘å¸ƒäº† <a href="https://openai.com/index/api-prompt-caching/">Prompt Caching in the API</a> ä»¥æå‡å¤§è¯­è¨€æ¨¡å‹ API çš„æ€§èƒ½ã€‚å½“å¬åˆ°è¿™ä¸ªæ¶ˆæ¯çš„æ—¶å€™ï¼Œæˆ‘æ„Ÿåˆ°éå¸¸éœ‡æƒŠï¼Œä¹Ÿéå¸¸å…´å¥‹ï¼Œäºæ˜¯æ¥ä¸‹æ¥çš„å‡ å¤©æˆ‘æ€»æƒ³ææ˜ç™½è¿™èƒŒåçš„åŸç†æ˜¯ä»€ä¹ˆï¼Œè¿™é‡Œçš„ <code>prompt caching</code> åˆç©¶ç«Ÿæ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p>äºæ˜¯ï¼Œæˆ‘æƒ³ï¼Œæ˜¯æ—¶å€™éœ€è¦æ·±å…¥äº†è§£ä¸€ä¸‹å½“å‰å¤§æ¨¡å‹çš„èµ·ç‚¹â€”â€”Transformer æ¨¡å‹ï¼Œä¹Ÿæ˜¯æ—¶å€™éœ€è¦æ·±å…¥äº†è§£ä¸€ä¸‹ç©¶ç«Ÿä»€ä¹ˆæ˜¯è‡ªæ³¨æ„åŠ›æœºåˆ¶ã€‚</p>
<span id="more"></span>
<h2 id="å‘é‡çš„ç‚¹ç§¯å’ŒçŸ©é˜µè¡¨ç¤º">å‘é‡çš„ç‚¹ç§¯å’ŒçŸ©é˜µè¡¨ç¤º</h2>
<p>ä»¤ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">x</mi></mrow><annotation encoding="application/x-tex">\mathbf{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.44444em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">x</span></span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">y</mi></mrow><annotation encoding="application/x-tex">\mathbf{y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.63888em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span></span></span> è¡¨ç¤ºç»´åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> çš„å‘é‡ï¼Œå³ï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mi mathvariant="bold">x</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo stretchy="false">[</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mi mathvariant="bold">y</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo stretchy="false">[</mo><msub><mi>y</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>y</mi><mi>n</mi></msub><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
\mathbf{x} &amp;= [x_1, x_2, ..., x_n] \\
\mathbf{y} &amp;= [y_1, y_2, ..., y_n]
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.0000000000000004em;vertical-align:-1.2500000000000002em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7500000000000002em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.2500000000000002em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7500000000000002em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.2500000000000002em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>åˆ™ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">x</mi></mrow><annotation encoding="application/x-tex">\mathbf{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.44444em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">x</span></span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">y</mi></mrow><annotation encoding="application/x-tex">\mathbf{y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.63888em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span></span></span> çš„ç‚¹ç§¯è¿ç®—ï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â‹…</mo></mrow><annotation encoding="application/x-tex">\cdot</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.44445em;vertical-align:0em;"></span><span class="mord">â‹…</span></span></span></span>ï¼‰å¯ä»¥è¡¨ç¤ºè¿™ä¸¤ä¸ªå‘é‡ä¹‹é—´çš„ç›¸ä¼¼åº¦ï¼Œå‘é‡ç‚¹ç§¯è¶Šå¤§ï¼Œè¡¨æ˜ä¸¤ä¸ªå‘é‡è¶Šç›¸ä¼¼ã€‚</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">x</mi><mo>â‹…</mo><mi mathvariant="bold">y</mi><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><msub><mi>x</mi><mi>i</mi></msub><msub><mi>y</mi><mi>i</mi></msub></mrow><mo>=</mo><msub><mi>x</mi><mn>1</mn></msub><msub><mi>y</mi><mn>1</mn></msub><mo>+</mo><msub><mi>x</mi><mn>2</mn></msub><msub><mi>y</mi><mn>2</mn></msub><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><msub><mi>x</mi><mi>n</mi></msub><msub><mi>y</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{x} \cdot \mathbf{y} = \sum_{i=1}^{n}{x_iy_i} = x_1y_1 + x_2y_2 +...+ x_ny_n
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.44445em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">x</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.63888em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>å¦‚æœç”¨å‘é‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">x</mi></mrow><annotation encoding="application/x-tex">\mathbf{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.44444em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">x</span></span></span></span></span> è¡¨ç¤ºä¸€ä¸ªè¯çš„è¯å‘é‡ï¼Œå¯¹äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span> ä¸ªè¯å‘é‡è€Œè¨€ï¼Œå…¶ä»»æ„ä¸¤ä¸ªè¯å‘é‡ä¹‹é—´çš„ç›¸ä¼¼åº¦å¯ä»¥è¡¨ç¤ºä¸ºï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">x</mi><mi mathvariant="bold">i</mi></msub><mo>â‹…</mo><msub><mi mathvariant="bold">x</mi><mi mathvariant="bold">j</mi></msub><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><msub><mi>x</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><msub><mi>x</mi><mrow><mi>j</mi><mi>k</mi></mrow></msub></mrow><mo>=</mo><msub><mi>x</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><msub><mi>x</mi><mrow><mi>j</mi><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>x</mi><mrow><mi>i</mi><mn>2</mn></mrow></msub><msub><mi>x</mi><mrow><mi>j</mi><mn>2</mn></mrow></msub><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><msub><mi>x</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub><msub><mi>x</mi><mrow><mi>j</mi><mi>n</mi></mrow></msub><mspace width="1em"><mi mathvariant="normal">âˆ€</mi><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator="true">,</mo><mi>m</mi></mspace></mrow><annotation encoding="application/x-tex">\mathbf{x_i} \cdot \mathbf{x_j} = \sum_{k=1}^{n}{x_{ik}x_{jk}} = x_{i1}x_{j1} + x_{i2}x_{j2} + ... + x_{in}x_{jn} \quad \forall i,j = 1,2,\cdots,m
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.59445em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.730548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.9535100000000005em;vertical-align:-1.302113em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.8478869999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.300005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8694379999999999em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8694379999999999em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord">âˆ€</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">m</span></span></span></span></span></p>
<p>å¦‚æœç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>Ã—</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">m \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> çš„çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">X</mi></mrow><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">X</span></span></span></span></span> æ¥è¡¨ç¤º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span> ä¸ªè¯å‘é‡ï¼Œ</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">X</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="bold">x</mi><mn mathvariant="bold">1</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="bold">x</mi><mn mathvariant="bold">2</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="bold">x</mi><mi mathvariant="bold">m</mi></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>x</mi><mn>11</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>x</mi><mn>12</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">â‹¯</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>x</mi><mrow><mn>1</mn><mi>n</mi></mrow></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>x</mi><mn>21</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>x</mi><mn>22</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">â‹¯</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>x</mi><mrow><mn>2</mn><mi>n</mi></mrow></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>x</mi><mrow><mi>m</mi><mn>1</mn></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>x</mi><mrow><mi>m</mi><mn>2</mn></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">â‹¯</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>x</mi><mrow><mi>m</mi><mi>n</mi></mrow></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{X} = \begin{bmatrix}
\mathbf{x_1} \\
\mathbf{x_2} \\
\vdots \\
\mathbf{x_m}
\end{bmatrix} = \begin{bmatrix}
x_{11} &amp; x_{12} &amp; \cdots &amp; x_{1n} \\
x_{21} &amp; x_{22} &amp; \cdots &amp; x_{2n} \\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
x_{m1} &amp; x_{m2} &amp; \cdots &amp; x_{mn}
\end{bmatrix}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">X</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:5.459999999999999em;vertical-align:-2.4799999999999995em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.953995em;"><span style="top:-1.3499850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.4999850000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.0959850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.6919850000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.712975em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-4.953995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4500349999999997em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9799999999999995em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-2.7674999999999996em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675000000000006em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.161108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.953995em;"><span style="top:-1.3499850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.4999850000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.0959850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.6919850000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.712975em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-4.953995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4500349999999997em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:5.459999999999999em;vertical-align:-2.4799999999999995em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.953995em;"><span style="top:-1.3499850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.4999850000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.0959850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.6919850000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.712975em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-4.953995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4500349999999997em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9799999999999995em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7674999999999996em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675000000000006em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9799999999999995em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7674999999999996em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675000000000006em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9799999999999995em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="minner">â‹¯</span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="minner">â‹¯</span></span></span><span style="top:-2.7674999999999996em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675000000000006em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="minner">â‹¯</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9799999999999995em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7674999999999996em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675000000000006em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.953995em;"><span style="top:-1.3499850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.4999850000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.0959850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.6919850000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.712975em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-4.953995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4500349999999997em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>åˆ™ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">S</mi><mo>=</mo><mi mathvariant="bold">X</mi><msup><mi mathvariant="bold">X</mi><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{S} = \mathbf{X} \mathbf{X}^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">S</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">X</span></span><span class="mord"><span class="mord"><span class="mord mathbf">X</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span> ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>Ã—</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">m \times m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span> çš„çŸ©é˜µï¼Œå¹¶ä¸” <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mi mathvariant="bold">x</mi><mi mathvariant="bold">i</mi></msub><mo>â‹…</mo><msub><mi mathvariant="bold">x</mi><mi mathvariant="bold">j</mi></msub></mrow><annotation encoding="application/x-tex">s_{ij} = \mathbf{x_i} \cdot \mathbf{x_j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.59445em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.730548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></span> è¡¨ç¤ºç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span> ä¸ªè¯å‘é‡å’Œç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span></span></span></span> ä¸ªè¯å‘é‡ä¹‹é—´çš„ç›¸ä¼¼åº¦ã€‚</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">X</mi><msup><mi mathvariant="bold">X</mi><mi>T</mi></msup><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi mathvariant="bold">x</mi><mn mathvariant="bold">1</mn></msub><mo>â‹…</mo><msub><mi mathvariant="bold">x</mi><mn mathvariant="bold">1</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi mathvariant="bold">x</mi><mn mathvariant="bold">1</mn></msub><mo>â‹…</mo><msub><mi mathvariant="bold">x</mi><mn mathvariant="bold">2</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">â‹¯</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi mathvariant="bold">x</mi><mn mathvariant="bold">1</mn></msub><mo>â‹…</mo><msub><mi mathvariant="bold">x</mi><mi mathvariant="bold">m</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi mathvariant="bold">x</mi><mn mathvariant="bold">2</mn></msub><mo>â‹…</mo><msub><mi mathvariant="bold">x</mi><mn mathvariant="bold">1</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi mathvariant="bold">x</mi><mn mathvariant="bold">2</mn></msub><mo>â‹…</mo><msub><mi mathvariant="bold">x</mi><mn mathvariant="bold">2</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">â‹¯</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi mathvariant="bold">x</mi><mn mathvariant="bold">2</mn></msub><mo>â‹…</mo><msub><mi mathvariant="bold">x</mi><mi mathvariant="bold">m</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi mathvariant="bold">x</mi><mi mathvariant="bold">m</mi></msub><mo>â‹…</mo><msub><mi mathvariant="bold">x</mi><mn mathvariant="bold">1</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi mathvariant="bold">x</mi><mi mathvariant="bold">m</mi></msub><mo>â‹…</mo><msub><mi mathvariant="bold">x</mi><mn mathvariant="bold">2</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">â‹¯</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi mathvariant="bold">x</mi><mi mathvariant="bold">m</mi></msub><mo>â‹…</mo><msub><mi mathvariant="bold">x</mi><mi mathvariant="bold">m</mi></msub></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{X}\mathbf{X}^T = \begin{bmatrix}
\mathbf{x_1} \cdot \mathbf{x_1} &amp; \mathbf{x_1} \cdot \mathbf{x_2} &amp; \cdots &amp; \mathbf{x_1} \cdot \mathbf{x_m} \\
\mathbf{x_2} \cdot \mathbf{x_1} &amp; \mathbf{x_2} \cdot \mathbf{x_2}  &amp; \cdots &amp; \mathbf{x_2} \cdot \mathbf{x_m} \\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
\mathbf{x_m} \cdot \mathbf{x_1} &amp; \mathbf{x_m} \cdot \mathbf{x_2}  &amp; \cdots &amp; \mathbf{x_m} \cdot \mathbf{x_m}
\end{bmatrix}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8913309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">X</span></span><span class="mord"><span class="mord"><span class="mord mathbf">X</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:5.459999999999999em;vertical-align:-2.4799999999999995em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.953995em;"><span style="top:-1.3499850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.4999850000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.0959850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.6919850000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.712975em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-4.953995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4500349999999997em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9799999999999995em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-2.7674999999999996em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675000000000006em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.161108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9799999999999995em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-2.7674999999999996em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675000000000006em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.161108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9799999999999995em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="minner">â‹¯</span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="minner">â‹¯</span></span></span><span style="top:-2.7674999999999996em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675000000000006em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="minner">â‹¯</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9799999999999995em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.161108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.161108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-2.7674999999999996em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675000000000006em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.161108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.161108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.953995em;"><span style="top:-1.3499850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.4999850000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.0959850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.6919850000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.712975em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-4.953995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4500349999999997em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>ä½¿ç”¨ <code>softmax()</code> å‡½æ•°å¯¹çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">S</mi></mrow><annotation encoding="application/x-tex">\mathbf{S}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">S</span></span></span></span></span> è¿›è¡Œå½’ä¸€åŒ–å¤„ç†å¾—åˆ°çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">W</mi><mo>=</mo><mtext>softmax</mtext><mrow><mo fence="true">(</mo><mi mathvariant="bold">X</mi><msup><mi mathvariant="bold">X</mi><mi>T</mi></msup><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{W} = \text{softmax}\left(\mathbf{X}\mathbf{X}^T\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.20001em;vertical-align:-0.35001em;"></span><span class="mord text"><span class="mord">softmax</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathbf">X</span></span><span class="mord"><span class="mord"><span class="mord mathbf">X</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span>ï¼Œä½¿å¾— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">W</mi></mrow><annotation encoding="application/x-tex">\mathbf{W}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span></span></span> ä¸­æ¯ä¸€è¡Œçš„æ‰€æœ‰å…ƒç´ ä¹‹å’Œéƒ½ä¸º 1ï¼Œäºæ˜¯æ¯ä¸€è¡Œçš„å„ä¸ªå…ƒç´ å°±å¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªæƒé‡ã€‚</p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>w</mi><mrow><mi>i</mi><mn>2</mn></mrow></msub><mo separator="true">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator="true">,</mo><msub><mi>w</mi><mrow><mi>i</mi><mi>m</mi></mrow></msub></mrow><annotation encoding="application/x-tex">w_{i1},w_{i2},\cdots,w_{im}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> åˆ†åˆ«è¡¨ç¤ºç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span> ä¸ªè¯å‘é‡å’Œç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator="true">,</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">1,2,\cdots,m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">m</span></span></span></span> ä¸ªè¯å‘é‡ä¹‹é—´çš„ç›¸ä¼¼åº¦æƒé‡ï¼Œç”¨è¯¥æƒé‡åˆ†åˆ«ä¹˜ä»¥å¯¹åº”çš„è¯å‘é‡ï¼Œäºæ˜¯æˆ‘ä»¬å¾—åˆ°äº†ç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span> ä¸ªè¯çš„æ–°çš„è¡¨è¾¾å½¢å¼ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">z</mi><mi mathvariant="bold">i</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{z_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.59444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>ï¼ŒæŸä¸ªè¯å‘é‡çš„æƒé‡è¶Šå¤§ï¼Œè¡¨ç¤ºç›¸ä¼¼åº¦è¶Šé«˜ã€‚</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">z</mi><mi mathvariant="bold">i</mi></msub><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mrow><msub><mi>w</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><msub><mi mathvariant="bold">x</mi><mi mathvariant="bold">k</mi></msub></mrow><mo>=</mo><msub><mi>w</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><msub><mi mathvariant="bold">x</mi><mn mathvariant="bold">1</mn></msub><mo>+</mo><msub><mi>w</mi><mrow><mi>i</mi><mn>2</mn></mrow></msub><msub><mi mathvariant="bold">x</mi><mn mathvariant="bold">2</mn></msub><mo>+</mo><mo>â‹¯</mo><mo>+</mo><msub><mi>w</mi><mrow><mi>i</mi><mi>m</mi></mrow></msub><msub><mi mathvariant="bold">x</mi><mi mathvariant="bold">m</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{z_i} = \sum_{k=1}^{m}{w_{ik}\mathbf{x_k}} = w_{i1}\mathbf{x_1} + w_{i2}\mathbf{x_2} + \cdots + w_{im}\mathbf{x_m} 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.59444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.9535100000000005em;vertical-align:-1.302113em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.8478869999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.300005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.59444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.161108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>å¯¹äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span> ä¸ªè¯å‘é‡éƒ½æ‰§è¡Œå¦‚ä¸Šçš„æ“ä½œå¯ä»¥å¾—åˆ°ï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">Z</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="bold">z</mi><mn mathvariant="bold">1</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="bold">z</mi><mn mathvariant="bold">2</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="bold">z</mi><mi mathvariant="bold">m</mi></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>w</mi><mn>11</mn></msub><msub><mi mathvariant="bold">x</mi><mn mathvariant="bold">1</mn></msub><mo>+</mo><msub><mi>w</mi><mn>12</mn></msub><msub><mi mathvariant="bold">x</mi><mn mathvariant="bold">2</mn></msub><mo>+</mo><mo>â‹¯</mo><mo>+</mo><msub><mi>w</mi><mrow><mn>1</mn><mi>m</mi></mrow></msub><msub><mi mathvariant="bold">x</mi><mi mathvariant="bold">m</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>w</mi><mn>21</mn></msub><msub><mi mathvariant="bold">x</mi><mn mathvariant="bold">1</mn></msub><mo>+</mo><msub><mi>w</mi><mn>22</mn></msub><msub><mi mathvariant="bold">x</mi><mn mathvariant="bold">2</mn></msub><mo>+</mo><mo>â‹¯</mo><mo>+</mo><msub><mi>w</mi><mrow><mn>2</mn><mi>m</mi></mrow></msub><msub><mi mathvariant="bold">x</mi><mi mathvariant="bold">m</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">â‹®</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>w</mi><mrow><mi>m</mi><mn>1</mn></mrow></msub><msub><mi mathvariant="bold">x</mi><mn mathvariant="bold">1</mn></msub><mo>+</mo><msub><mi>w</mi><mrow><mi>m</mi><mn>2</mn></mrow></msub><msub><mi mathvariant="bold">x</mi><mn mathvariant="bold">2</mn></msub><mo>+</mo><mo>â‹¯</mo><mo>+</mo><msub><mi>w</mi><mrow><mi>m</mi><mi>m</mi></mrow></msub><msub><mi mathvariant="bold">x</mi><mi mathvariant="bold">m</mi></msub></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{Z} = \begin{bmatrix}
\mathbf{z_1} \\
\mathbf{z_2} \\
\vdots \\
\mathbf{z_m}
\end{bmatrix} = \begin{bmatrix}
w_{11}\mathbf{x_1} + w_{12}\mathbf{x_2} + \cdots + w_{1m}\mathbf{x_m} \\
w_{21}\mathbf{x_1} + w_{22}\mathbf{x_2} + \cdots + w_{2m}\mathbf{x_m} \\
\vdots \\
w_{m1}\mathbf{x_1} + w_{m2}\mathbf{x_2} + \cdots + w_{mm}\mathbf{x_m}
\end{bmatrix}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">Z</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:5.459999999999999em;vertical-align:-2.4799999999999995em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.953995em;"><span style="top:-1.3499850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.4999850000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.0959850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.6919850000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.712975em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-4.953995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4500349999999997em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9799999999999995em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-2.7674999999999996em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675000000000006em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.161108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.953995em;"><span style="top:-1.3499850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.4999850000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.0959850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.6919850000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.712975em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-4.953995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4500349999999997em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:5.459999999999999em;vertical-align:-2.4799999999999995em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.953995em;"><span style="top:-1.3499850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.4999850000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.0959850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.6919850000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.712975em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-4.953995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4500349999999997em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9799999999999995em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.161108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.161108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-2.7674999999999996em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">â‹®</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675000000000006em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.161108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.953995em;"><span style="top:-1.3499850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.4999850000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.0959850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.6919850000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.712975em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-4.953995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.4500349999999997em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>å®é™…ä¸Šï¼Œå¯ä»¥è¯æ˜ï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">Z</mi><mo>=</mo><mi mathvariant="bold">W</mi><mi mathvariant="bold">X</mi><mo>=</mo><mtext>softmax</mtext><mrow><mo fence="true">(</mo><mi mathvariant="bold">X</mi><msup><mi mathvariant="bold">X</mi><mi>T</mi></msup><mo fence="true">)</mo></mrow><mi mathvariant="bold">X</mi></mrow><annotation encoding="application/x-tex">\mathbf{Z} = \mathbf{W}\mathbf{X} = \text{softmax}\left(\mathbf{X}\mathbf{X}^T\right)\mathbf{X}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">Z</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span><span class="mord"><span class="mord mathbf">X</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2413409999999998em;vertical-align:-0.35001em;"></span><span class="mord text"><span class="mord">softmax</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathbf">X</span></span><span class="mord"><span class="mord"><span class="mord mathbf">X</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf">X</span></span></span></span></span></span></p>
<p>äºæ˜¯ï¼Œå¯¹äºåŸå§‹çš„è¯å‘é‡çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">X</mi></mrow><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">X</span></span></span></span></span> è€Œè¨€ï¼Œç»è¿‡ä¸€äº›åˆ—çš„çŸ©é˜µä¹˜æ³•è¿ç®—ï¼Œæˆ‘ä»¬å¾—åˆ°äº†æ ¹æ®ç›¸å…³æ€§æƒé‡çš„åŠ æƒè¯å‘é‡è¡¨ç¤ºã€‚ä¹Ÿå°±æ˜¯è¯´åŸå§‹çš„è¯å‘é‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">x</mi><mi mathvariant="bold">i</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{x_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.59444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> å¯ä»¥è¡¨ç¤ºä¸ºæ‰€æœ‰è¯å‘é‡çš„åŠ æƒè¡¨ç¤º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">z</mi><mi mathvariant="bold">i</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{z_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.59444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>ã€‚æ‰€ä»¥ï¼Œå¯ä»¥ç”¨ <code>Attention</code> æ¥è§£é‡Šä¸€å¥è¯ä¸­ä¸åŒè¯ä¹‹é—´çš„ç›¸äº’å…³ç³»ã€‚Transformer æ¨¡å‹ä¸­çš„ <code>Attention</code> å…¶å®å°±æ˜¯çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">Z</mi></mrow><annotation encoding="application/x-tex">\mathbf{Z}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">Z</span></span></span></span></span>ï¼Œæ‰€ä»¥ Transformer å¯ä»¥ç†è§£è¾“å…¥åºåˆ—ä¸­çš„ä¸åŒçš„éƒ¨åˆ†ï¼Œå¹¶åˆ†æè¾“å…¥åºåˆ—ä¸­ä¸åŒè¯ä¹‹é—´çš„å…³ç³»ï¼Œè¿›è€Œæ•è·åˆ°ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚</p>
<p>äº†è§£å¦‚ä¸Šä»‹ç»çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>softmax</mtext><mrow><mo fence="true">(</mo><mi mathvariant="bold">X</mi><msup><mi mathvariant="bold">X</mi><mi>T</mi></msup><mo fence="true">)</mo></mrow><mi mathvariant="bold">X</mi></mrow><annotation encoding="application/x-tex">\text{softmax}\left(\mathbf{X}\mathbf{X}^T\right)\mathbf{X}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.20001em;vertical-align:-0.35001em;"></span><span class="mord text"><span class="mord">softmax</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathbf">X</span></span><span class="mord"><span class="mord"><span class="mord mathbf">X</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf">X</span></span></span></span></span> èƒŒåçš„é€»è¾‘å¯¹äºç†è§£ Transformer ä¸­çš„å„ä¸ªçŸ©é˜µçš„å«ä¹‰è‡³å…³é‡è¦ï¼Œå› æ­¤æˆ‘ä»¬èŠ±äº†å¾ˆå¤§çš„ç¯‡å¹…æ¥å¯¹å…¶è¿›è¡Œåˆ†æã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç”¨ä¸€ä¸ªå…·ä½“çš„ä¾‹å­æ¥å±•ç¤ºå¦‚ä¸Šçš„è¿‡ç¨‹ã€‚</p>
<h3 id="ä¸¾ä¸ªä¾‹å­ğŸŒ°">ä¸¾ä¸ªä¾‹å­ğŸŒ°</h3>
<p>ä»¥ <code>I am good</code> è¿™å¥è¯ä¸ºä¾‹ï¼Œæˆ‘ä»¬ç”¨è¯å‘é‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">x</mi><mn mathvariant="bold">1</mn></msub></mrow><annotation encoding="application/x-tex">\mathbf{x_1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.59444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> è¡¨ç¤º <code>I</code>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">x</mi><mn mathvariant="bold">2</mn></msub></mrow><annotation encoding="application/x-tex">\mathbf{x_2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.59444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> è¡¨ç¤º <code>am</code>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">x</mi><mn mathvariant="bold">3</mn></msub></mrow><annotation encoding="application/x-tex">\mathbf{x_3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.59444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> è¡¨ç¤º <code>good</code>ï¼Œå¯¹åº”çš„è¯å‘é‡åˆ†åˆ«ä¸ºï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi mathvariant="bold">x</mi><mn mathvariant="bold">1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mn>3</mn><mo separator="true">,</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi mathvariant="bold">x</mi><mn mathvariant="bold">2</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>3</mn><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi mathvariant="bold">x</mi><mn mathvariant="bold">3</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
\mathbf{x_1} &amp;= [1, 3, 2] \\
\mathbf{x_2} &amp;= [1, 1, 3] \\
\mathbf{x_3} &amp;= [1, 2, 1]
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.500000000000002em;vertical-align:-2.000000000000001em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5000000000000004em;"><span style="top:-4.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-1.6599999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.000000000000001em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5000000000000004em;"><span style="top:-4.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mclose">]</span></span></span><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">3</span><span class="mclose">]</span></span></span><span style="top:-1.6599999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.000000000000001em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬æœ‰çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">X</mi></mrow><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">X</span></span></span></span></span>ï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">X</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>3</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>3</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{X} = \begin{bmatrix}
1 &amp; 3 &amp; 2 \\
1 &amp; 1 &amp; 3 \\
1 &amp; 2 &amp; 1
\end{bmatrix}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">X</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.6010299999999997em;vertical-align:-1.55002em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0510099999999998em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.8099900000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-4.05101em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0510099999999998em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.8099900000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-4.05101em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>äºæ˜¯ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">W</mi></mrow><annotation encoding="application/x-tex">\mathbf{W}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span></span></span> çŸ©é˜µçš„è®¡ç®—è¿‡ç¨‹å¦‚ä¸‹ï¼š</p>
<p><img src="/2024/10/16/What-exactly-is-attention/zmatrix.png" alt></p>
<p>æƒé‡çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">W</mi></mrow><annotation encoding="application/x-tex">\mathbf{W}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span></span></span> ä¸­æŸä¸€è¡Œåˆ†åˆ«ä¸ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">X</mi></mrow><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">X</span></span></span></span></span> çš„ä¸€åˆ—ç›¸ä¹˜ï¼Œå¦‚å‰æ‰€è¿°ï¼Œè¯¥æ“ä½œç›¸å½“äºå¯¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">X</mi></mrow><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">X</span></span></span></span></span> ä¸­å„è¡Œå‘é‡ï¼ˆä¸åŒçš„è¯å‘é‡ï¼‰åŠ æƒæ±‚å’Œï¼Œå¾—åˆ°çš„ç»“æœæ˜¯æ¯ä¸ªè¯å‘é‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">x</mi><mi mathvariant="bold">i</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{x_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.59444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> ç»è¿‡åŠ æƒæ±‚å’Œä¹‹åçš„æ–°è¡¨ç¤º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">z</mi><mi mathvariant="bold">i</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{z_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.59444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>ï¼Œè€Œæƒé‡çŸ©é˜µåˆ™æ˜¯ç»è¿‡ç›¸ä¼¼åº¦å’Œå½’ä¸€åŒ–è®¡ç®—è€Œå¾—åˆ°çš„ã€‚</p>
<p><img src="/2024/10/16/What-exactly-is-attention/vec_matrix.png" alt></p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi mathvariant="bold">z</mi><mi mathvariant="bold">I</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mn>0.97</mn><mo>â‹…</mo><msub><mi mathvariant="bold">x</mi><mi mathvariant="bold">I</mi></msub><mo>+</mo><mn>0.02</mn><mo>â‹…</mo><msub><mi mathvariant="bold">x</mi><mrow><mi mathvariant="bold">a</mi><mi mathvariant="bold">m</mi></mrow></msub><mo>+</mo><mn>0.01</mn><mo>â‹…</mo><msub><mi mathvariant="bold">x</mi><mrow><mi mathvariant="bold">g</mi><mi mathvariant="bold">o</mi><mi mathvariant="bold">o</mi><mi mathvariant="bold">d</mi></mrow></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi mathvariant="bold">z</mi><mrow><mi mathvariant="bold">a</mi><mi mathvariant="bold">m</mi></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mn>0.27</mn><mo>â‹…</mo><msub><mi mathvariant="bold">x</mi><mi mathvariant="bold">I</mi></msub><mo>+</mo><mn>0.73</mn><mo>â‹…</mo><msub><mi mathvariant="bold">x</mi><mrow><mi mathvariant="bold">a</mi><mi mathvariant="bold">m</mi></mrow></msub><mo>+</mo><mn>0.00</mn><mo>â‹…</mo><msub><mi mathvariant="bold">x</mi><mrow><mi mathvariant="bold">g</mi><mi mathvariant="bold">o</mi><mi mathvariant="bold">o</mi><mi mathvariant="bold">d</mi></mrow></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi mathvariant="bold">z</mi><mrow><mi mathvariant="bold">g</mi><mi mathvariant="bold">o</mi><mi mathvariant="bold">o</mi><mi mathvariant="bold">d</mi></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mn>0.90</mn><mo>â‹…</mo><msub><mi mathvariant="bold">x</mi><mi mathvariant="bold">I</mi></msub><mo>+</mo><mn>0.05</mn><mo>â‹…</mo><msub><mi mathvariant="bold">x</mi><mrow><mi mathvariant="bold">a</mi><mi mathvariant="bold">m</mi></mrow></msub><mo>+</mo><mn>0.05</mn><mo>â‹…</mo><msub><mi mathvariant="bold">x</mi><mrow><mi mathvariant="bold">g</mi><mi mathvariant="bold">o</mi><mi mathvariant="bold">o</mi><mi mathvariant="bold">d</mi></mrow></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
\mathbf{z_{I}}    &amp;= 0.97 \cdot \mathbf{x_{I}} + 0.02 \cdot \mathbf{x_{am}} + 0.01 \cdot \mathbf{x_{good}} \\
\mathbf{z_{am}}   &amp;= 0.27 \cdot \mathbf{x_{I}} + 0.73 \cdot \mathbf{x_{am}} + 0.00 \cdot \mathbf{x_{good}} \\
\mathbf{z_{good}} &amp;= 0.90 \cdot \mathbf{x_{I}} + 0.05 \cdot \mathbf{x_{am}} + 0.05 \cdot \mathbf{x_{good}}
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.500000000000002em;vertical-align:-2.000000000000001em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5000000000000004em;"><span style="top:-4.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33027699999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight">I</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.161108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight">a</span><span class="mord mathbf mtight">m</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-1.6599999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight" style="margin-right:0.01597em;">g</span><span class="mord mathbf mtight">o</span><span class="mord mathbf mtight">o</span><span class="mord mathbf mtight">d</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.000000000000001em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5000000000000004em;"><span style="top:-4.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span><span class="mord">7</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33027699999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight">I</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.161108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight">a</span><span class="mord mathbf mtight">m</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight" style="margin-right:0.01597em;">g</span><span class="mord mathbf mtight">o</span><span class="mord mathbf mtight">o</span><span class="mord mathbf mtight">d</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">2</span><span class="mord">7</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33027699999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight">I</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">7</span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.161108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight">a</span><span class="mord mathbf mtight">m</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight" style="margin-right:0.01597em;">g</span><span class="mord mathbf mtight">o</span><span class="mord mathbf mtight">o</span><span class="mord mathbf mtight">d</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-1.6599999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33027699999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight">I</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">5</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.161108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight">a</span><span class="mord mathbf mtight">m</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">5</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight" style="margin-right:0.01597em;">g</span><span class="mord mathbf mtight">o</span><span class="mord mathbf mtight">o</span><span class="mord mathbf mtight">d</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.000000000000001em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<h3 id="r-å®ç°è¿‡ç¨‹">R å®ç°è¿‡ç¨‹</h3>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">softmax &lt;- <span class="keyword">function</span>(mat) &#123;</span><br><span class="line">  exp_mat &lt;- <span class="built_in">exp</span>(mat)           <span class="comment"># å¯¹çŸ©é˜µä¸­çš„æ¯ä¸ªå…ƒç´ å–æŒ‡æ•°</span></span><br><span class="line">  row_sums &lt;- rowSums(exp_mat)  <span class="comment"># è®¡ç®—æ¯è¡Œçš„æ€»å’Œ</span></span><br><span class="line">  softmax_mat &lt;- sweep(exp_mat, <span class="number">1</span>, row_sums, FUN = <span class="string">&quot;/&quot;</span>)  <span class="comment"># å¯¹æ¯è¡Œè¿›è¡Œå½’ä¸€åŒ–</span></span><br><span class="line">  <span class="built_in">return</span>(softmax_mat)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">X &lt;- matrix(<span class="built_in">c</span>(<span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>), nrow = <span class="number">3</span>, byrow = <span class="literal">TRUE</span>)</span><br><span class="line">W &lt;- softmax(X %*% t(X))</span><br><span class="line">Z &lt;- W %*% X</span><br><span class="line">print(Z)</span><br><span class="line"></span><br><span class="line"><span class="comment">#=================================================================</span></span><br><span class="line"></span><br><span class="line">     [,<span class="number">1</span>]     [,<span class="number">2</span>]     [,<span class="number">3</span>]</span><br><span class="line">[<span class="number">1</span>,]    <span class="number">1</span> <span class="number">2.957691</span> <span class="number">2.011295</span></span><br><span class="line">[<span class="number">2</span>,]    <span class="number">1</span> <span class="number">1.540148</span> <span class="number">2.722573</span></span><br><span class="line">[<span class="number">3</span>,]    <span class="number">1</span> <span class="number">2.864164</span> <span class="number">2.000000</span></span><br></pre></td></tr></table></figure>
<h3 id="å¼•å…¥æ–°çš„çŸ©é˜µ">å¼•å…¥æ–°çš„çŸ©é˜µ</h3>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬å¼•å…¥ä¸€ä¸ªæ–°çš„çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">Y</mi></mrow><annotation encoding="application/x-tex">\mathbf{Y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.02875em;">Y</span></span></span></span></span>ï¼Œå¹¶ä»¤</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">Z</mi><mo>=</mo><mtext>softmax</mtext><mrow><mo fence="true">(</mo><mi mathvariant="bold">X</mi><msup><mi mathvariant="bold">Y</mi><mi>T</mi></msup><mo fence="true">)</mo></mrow><mi mathvariant="bold">Y</mi><mo>=</mo><mi mathvariant="bold">W</mi><mi mathvariant="bold">Y</mi></mrow><annotation encoding="application/x-tex">\mathbf{Z} = \text{softmax}\left(\mathbf{X}\mathbf{Y}^T\right)\mathbf{Y} = \mathbf{W}\mathbf{Y}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">Z</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2413409999999998em;vertical-align:-0.35001em;"></span><span class="mord text"><span class="mord">softmax</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathbf">X</span></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.02875em;">Y</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.02875em;">Y</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span><span class="mord"><span class="mord mathbf" style="margin-right:0.02875em;">Y</span></span></span></span></span></span></p>
<p>æ ¹æ®ä¹‹å‰çš„æè¿°ï¼Œæ­¤æ—¶çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">Z</mi></mrow><annotation encoding="application/x-tex">\mathbf{Z}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">Z</span></span></span></span></span> ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">X</mi></mrow><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">X</span></span></span></span></span> ä¸­çš„æ¯ä¸€ä¸ªè¯å‘é‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">x</mi><mi mathvariant="bold">i</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{x_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.59444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> åœ¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">Y</mi></mrow><annotation encoding="application/x-tex">\mathbf{Y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.02875em;">Y</span></span></span></span></span> ä¸­çš„æ¯ä¸€ä¸ªè¯å‘é‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">y</mi><mi mathvariant="bold">j</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{y_j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.730548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.01597em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></span> çš„åŠ æƒè¡¨ç¤ºï¼Œå³ï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">x</mi><mi mathvariant="bold">i</mi></msub><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mrow><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi mathvariant="bold">y</mi><mi mathvariant="bold">j</mi></msub></mrow></mrow><annotation encoding="application/x-tex">\mathbf{x_i} = \sum_{j=1}^{m}{w_{ij}\mathbf{y_j}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.59444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.0651740000000007em;vertical-align:-1.4137769999999998em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000007em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.01597em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><img src="/2024/10/16/What-exactly-is-attention/w_xy.png" alt></p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi mathvariant="bold">z</mi><mi mathvariant="bold">I</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mn>0.95</mn><mo>â‹…</mo><msub><mi mathvariant="bold">y</mi><mtext>æˆ‘</mtext></msub><mo>+</mo><mn>0.05</mn><mo>â‹…</mo><msub><mi mathvariant="bold">y</mi><mtext>å¾ˆå¥½</mtext></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi mathvariant="bold">z</mi><mrow><mi mathvariant="bold">a</mi><mi mathvariant="bold">m</mi></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mn>0.12</mn><mo>â‹…</mo><msub><mi mathvariant="bold">y</mi><mtext>æˆ‘</mtext></msub><mo>+</mo><mn>0.88</mn><mo>â‹…</mo><msub><mi mathvariant="bold">y</mi><mtext>å¾ˆå¥½</mtext></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi mathvariant="bold">z</mi><mrow><mi mathvariant="bold">g</mi><mi mathvariant="bold">o</mi><mi mathvariant="bold">o</mi><mi mathvariant="bold">d</mi></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mn>0.88</mn><mo>â‹…</mo><msub><mi mathvariant="bold">y</mi><mtext>æˆ‘</mtext></msub><mo>+</mo><mn>0.12</mn><mo>â‹…</mo><msub><mi mathvariant="bold">y</mi><mtext>å¾ˆå¥½</mtext></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
\mathbf{z_{I}}    &amp;= 0.95 \cdot \mathbf{y_{\text{æˆ‘}}} + 0.05 \cdot \mathbf{y_{\text{å¾ˆå¥½}}} \\
\mathbf{z_{am}}   &amp;= 0.12 \cdot \mathbf{y_{\text{æˆ‘}}} + 0.88 \cdot \mathbf{y_{\text{å¾ˆå¥½}}} \\
\mathbf{z_{good}} &amp;= 0.88 \cdot \mathbf{y_{\text{æˆ‘}}} + 0.12 \cdot \mathbf{y_{\text{å¾ˆå¥½}}} 
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.500000000000002em;vertical-align:-2.000000000000001em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5000000000000004em;"><span style="top:-4.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33027699999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight">I</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.161108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight">a</span><span class="mord mathbf mtight">m</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-1.6599999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight" style="margin-right:0.01597em;">g</span><span class="mord mathbf mtight">o</span><span class="mord mathbf mtight">o</span><span class="mord mathbf mtight">d</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.000000000000001em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5000000000000004em;"><span style="top:-4.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span><span class="mord">5</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.01597em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord cjk_fallback mtight">æˆ‘</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">5</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.01597em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord cjk_fallback mtight">å¾ˆå¥½</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.01597em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord cjk_fallback mtight">æˆ‘</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">8</span><span class="mord">8</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.01597em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord cjk_fallback mtight">å¾ˆå¥½</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-1.6599999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">8</span><span class="mord">8</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.01597em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord cjk_fallback mtight">æˆ‘</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.01597em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord cjk_fallback mtight">å¾ˆå¥½</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.000000000000001em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>å¦‚ä¸Šçš„è®¡ç®—å’Œæƒé‡åªæ˜¯ä¸ºäº†è¯´æ˜åŸç†è€Œéšæœºé€‰æ‹©çš„æ•°æ®ï¼Œå¹¶ä¸ä»£è¡¨çœŸå®çš„ç›¸å…³æ€§ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ° <code>good</code> å’Œ <code>æˆ‘</code>ï¼ˆè€Œä¸æ˜¯ <code>å¾ˆå¥½</code>ï¼‰ ä¹‹é—´çš„å…³ç³»æœ€ç›¸ä¼¼ã€‚</p>
<h2 id="transformer-ä¸­çš„è‡ªæ³¨æ„åŠ›">Transformer ä¸­çš„è‡ªæ³¨æ„åŠ›</h2>
<p>è®ºæ–‡ <a href="https://arxiv.org/html/1706.03762v7">Attention Is All You Need</a> çš„ 3.2 èŠ‚å¯¹ Attention çš„æè¿°å¦‚ä¸‹<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup>ï¼š</p>
<blockquote>
<p>An attention function can be described as mapping a query and a set of key-value pairs to an output, where the query, keys, values, and output are all vectors.</p>
<p>The output is computed as a weighted sum of the values, where the weight assigned to each value is computed by a compatibility function of the query with the corresponding key.</p>
</blockquote>
<p>è®ºæ–‡ä¸­ä¹Ÿç»™å‡ºäº† Self-Attention çš„è®¡ç®—å…¬å¼ï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Attention</mtext><mo stretchy="false">(</mo><mi mathvariant="bold">Q</mi><mo separator="true">,</mo><mi mathvariant="bold">K</mi><mo separator="true">,</mo><mi mathvariant="bold">V</mi><mo stretchy="false">)</mo><mo>=</mo><mtext>softmax</mtext><mrow><mo fence="true">(</mo><mfrac><mrow><mi mathvariant="bold">Q</mi><msup><mi mathvariant="bold">K</mi><mi>T</mi></msup></mrow><msqrt><msub><mi>d</mi><mi>k</mi></msub></msqrt></mfrac><mo fence="true">)</mo></mrow><mi mathvariant="bold">V</mi></mrow><annotation encoding="application/x-tex">\text{Attention}(\mathbf{Q},\mathbf{K},\mathbf{V})=\text{softmax}\left(\frac{\mathbf{Q}\mathbf{K}^T}{\sqrt{d_k}}\right)\mathbf{V}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Attention</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">Q</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf">K</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.468361em;vertical-align:-0.95003em;"></span><span class="mord text"><span class="mord">softmax</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5183309999999999em;"><span style="top:-2.25278em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85722em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.81722em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.18278000000000005em;"><span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">Q</span></span><span class="mord"><span class="mord"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.93em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span></span></span></span></span></p>
<p>å…¶ä¸­ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">Q</mi></mrow><annotation encoding="application/x-tex">\mathbf{Q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8805499999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathbf">Q</span></span></span></span></span>ã€<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">K</mi></mrow><annotation encoding="application/x-tex">\mathbf{K}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">K</span></span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">V</mi></mrow><annotation encoding="application/x-tex">\mathbf{V}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span></span></span></span> éƒ½æ˜¯çŸ©é˜µï¼Œåˆ†åˆ«ä»£è¡¨ <code>Query</code>ã€<code>Key</code> å’Œ <code>Value</code>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">d_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">K</mi></mrow><annotation encoding="application/x-tex">\mathbf{K}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">K</span></span></span></span></span> çš„è¡Œå‘é‡ç»´åº¦ã€‚ <code>Query</code>ã€<code>Key</code> å’Œ <code>Value</code> éƒ½æ˜¯ä¸ºäº†è®¡ç®— <code>è‡ªæ³¨æ„åŠ›</code> è€Œå¼•å…¥çš„æŠ½è±¡çš„æ¦‚å¿µï¼Œå®ƒä»¬éƒ½æ˜¯å¯¹åŸå§‹çš„è¾“å…¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">X</mi></mrow><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">X</span></span></span></span></span> çš„çº¿æ€§å˜æ¢ã€‚</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mi mathvariant="bold">Q</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi mathvariant="bold">X</mi><msup><mi mathvariant="bold">W</mi><mi>Q</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mi mathvariant="bold">K</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi mathvariant="bold">X</mi><msup><mi mathvariant="bold">W</mi><mi>K</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mi mathvariant="bold">V</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi mathvariant="bold">X</mi><msup><mi mathvariant="bold">W</mi><mi>V</mi></msup></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
\mathbf{Q} &amp;= \mathbf{X}\mathbf{W}^Q \\
\mathbf{K} &amp;= \mathbf{X}\mathbf{W}^K \\
\mathbf{V} &amp;= \mathbf{X}\mathbf{W}^V
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.653993000000002em;vertical-align:-2.076996500000001em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5769965000000004em;"><span style="top:-4.685665500000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">Q</span></span></span></span><span style="top:-3.1343345em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">K</span></span></span></span><span style="top:-1.5830034999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.076996500000001em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5769965000000004em;"><span style="top:-4.685665500000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathbf">X</span></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.891331em;"><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">Q</span></span></span></span></span></span></span></span></span></span><span style="top:-3.1343345em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathbf">X</span></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07153em;">K</span></span></span></span></span></span></span></span></span></span><span style="top:-1.5830034999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathbf">X</span></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">V</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.076996500000001em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>å› ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">X</mi></mrow><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">X</span></span></span></span></span> æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>Ã—</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">m \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> çš„çŸ©é˜µï¼Œæ‰€ä»¥å¦‚æœä»¤ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold">W</mi><mi>Q</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{W}^Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">Q</span></span></span></span></span></span></span></span></span></span></span>ã€<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold">W</mi><mi>K</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{W}^K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07153em;">K</span></span></span></span></span></span></span></span></span></span></span>ã€<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold">W</mi><mi>V</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{W}^V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">V</span></span></span></span></span></span></span></span></span></span></span> å‡æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>Ã—</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">n \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> çš„å•ä½çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">I</mi></mrow><annotation encoding="application/x-tex">\mathbf{I}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">I</span></span></span></span></span>ï¼Œé‚£ä¹ˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">X</mi></mrow><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">X</span></span></span></span></span> ç»è¿‡çº¿æ€§å˜æ¢ï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">I</mi></mrow><annotation encoding="application/x-tex">\mathbf{I}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">I</span></span></span></span></span>ï¼‰åå¾—åˆ°çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">Q</mi></mrow><annotation encoding="application/x-tex">\mathbf{Q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8805499999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathbf">Q</span></span></span></span></span>ã€<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">K</mi></mrow><annotation encoding="application/x-tex">\mathbf{K}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">K</span></span></span></span></span>ã€<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">V</mi></mrow><annotation encoding="application/x-tex">\mathbf{V}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span></span></span></span> ä»ç„¶æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">X</mi></mrow><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">X</span></span></span></span></span>ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥ç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">X</mi></mrow><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">X</span></span></span></span></span> æ›¿æ¢ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">Q</mi></mrow><annotation encoding="application/x-tex">\mathbf{Q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8805499999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathbf">Q</span></span></span></span></span>ã€<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">K</mi></mrow><annotation encoding="application/x-tex">\mathbf{K}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">K</span></span></span></span></span>ã€<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">V</mi></mrow><annotation encoding="application/x-tex">\mathbf{V}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span></span></span></span>ï¼Œé‚£ä¹ˆå…¬å¼å°±å˜æˆäº†ï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Attention</mtext><mo stretchy="false">(</mo><mi mathvariant="bold">Q</mi><mo separator="true">,</mo><mi mathvariant="bold">K</mi><mo separator="true">,</mo><mi mathvariant="bold">V</mi><mo stretchy="false">)</mo><mo>=</mo><mtext>softmax</mtext><mrow><mo fence="true">(</mo><mfrac><mrow><mi mathvariant="bold">X</mi><msup><mi mathvariant="bold">X</mi><mi>T</mi></msup></mrow><msqrt><msub><mi>d</mi><mi>k</mi></msub></msqrt></mfrac><mo fence="true">)</mo></mrow><mi mathvariant="bold">X</mi></mrow><annotation encoding="application/x-tex">\text{Attention}(\mathbf{Q},\mathbf{K},\mathbf{V})=\text{softmax}\left(\frac{\mathbf{X}\mathbf{X}^T}{\sqrt{d_k}}\right)\mathbf{X}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Attention</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">Q</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf">K</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.468361em;vertical-align:-0.95003em;"></span><span class="mord text"><span class="mord">softmax</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5183309999999999em;"><span style="top:-2.25278em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85722em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.81722em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.18278000000000005em;"><span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">X</span></span><span class="mord"><span class="mord"><span class="mord mathbf">X</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.93em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf">X</span></span></span></span></span></span></p>
<p>è¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¹‹å‰é¢è¯´ï¼šTransformer æ¨¡å‹ä¸­çš„ <code>Attention</code> å…¶å®å°±æ˜¯å¯¹åŸå§‹è¾“å…¥è¯å‘é‡çš„åŠ æƒæ±‚å’Œè€Œå¾—åˆ°çš„æ–°çš„è¡¨ç¤ºï¼Œåœ¨æ–°çš„è¡¨ç¤ºä¸­ï¼ŒTransformer å¯ä»¥ç†è§£è¾“å…¥åºåˆ—ä¸­çš„ä¸åŒçš„éƒ¨åˆ†ï¼Œå¹¶åˆ†æè¾“å…¥åºåˆ—ä¸­ä¸åŒè¯ä¹‹é—´çš„å…³ç³»ï¼Œè¿›è€Œæ•è·åˆ°ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚</p>
<p>å®é™…ä¸Šï¼Œä¸ºäº†å¢å¼ºå¢å¼ºæ¨¡å‹çš„æ‹Ÿåˆèƒ½åŠ›ï¼Œæˆ‘ä»¬å¹¶ä¸ä¼šé‡‡ç”¨å•ä½çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">I</mi></mrow><annotation encoding="application/x-tex">\mathbf{I}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">I</span></span></span></span></span> å¯¹çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">X</mi></mrow><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">X</span></span></span></span></span> åšçº¿æ€§å˜æ¢ï¼Œè€Œæ˜¯åˆ†åˆ«é‡‡ç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold">W</mi><mi>Q</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{W}^Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">Q</span></span></span></span></span></span></span></span></span></span></span>ã€<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold">W</mi><mi>K</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{W}^K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07153em;">K</span></span></span></span></span></span></span></span></span></span></span>ã€<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold">W</mi><mi>V</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{W}^V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">V</span></span></span></span></span></span></span></span></span></span></span> è¿™ä¸‰ä¸ªå¯ä»¥é€šè¿‡å¤§é‡è¯­æ–™è®­ç»ƒè€Œå­¦ä¹ åˆ°çš„å‚æ•°çŸ©é˜µï¼ˆå‚æ•°çŸ©é˜µå¯ä»¥æ˜¯ä»»ä½•ç»´åº¦ï¼Œä½†è¡Œå‘é‡ä¸ªæ•°å¿…é¡»å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">X</mi></mrow><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">X</span></span></span></span></span> çš„è¡Œå‘é‡ç»´åº¦ä¸€è‡´ï¼‰ã€‚</p>
<p>é™¤æ­¤ä¹‹å¤–ï¼Œåœ¨è®¡ç®— <code>softmax()</code> ä¹‹å‰ï¼ŒTransformer ä¼šç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msqrt><msub><mi>d</mi><mi>k</mi></msub></msqrt></mrow><annotation encoding="application/x-tex">\sqrt{d_k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.18278000000000005em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85722em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.81722em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.18278000000000005em;"><span></span></span></span></span></span></span></span></span> å¯¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">Q</mi><msup><mi mathvariant="bold">K</mi><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{Q}\mathbf{K}^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.035771em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathbf">Q</span></span><span class="mord"><span class="mord"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span> çš„ç»“æœè¿›è¡Œç¼©æ”¾ï¼Œæ‰€ä»¥è®ºæ–‡ä¸­ä¹ŸæŠŠ <code>è‡ªæ³¨æ„åŠ›</code> å«ä½œï¼šScaled Dot-Product Attentionã€‚å½“ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">d_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å¾ˆå¤§æ—¶ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">Q</mi><msup><mi mathvariant="bold">K</mi><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{Q}\mathbf{K}^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.035771em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathbf">Q</span></span><span class="mord"><span class="mord"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span> çš„å‘é‡ç‚¹ç§¯ä¼šéå¸¸å¤§ï¼Œå¦‚æœä¸è¿›è¡Œç¼©æ”¾ï¼Œ<code>softmax()</code> çš„æ¢¯åº¦ä¼šéå¸¸å°ï¼Œè¿›è€Œå¯¼è‡´åœ¨åå‘ä¼ æ’­æ—¶ï¼Œæ¨¡å‹å‚æ•°æ›´æ–°çš„é€Ÿåº¦ä¼šå˜æ…¢ï¼Œç”šè‡³æ¥è¿‘åœæ»ï¼Œå½±å“æ¨¡å‹çš„å­¦ä¹ æ•ˆç‡ã€‚</p>
<p>è‡ªæ³¨æ„åŠ›æœºåˆ¶çš„æ•´ä½“æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="/2024/10/16/What-exactly-is-attention/sattention.png" alt="è‡ªæ³¨æ„åŠ›æœºåˆ¶"></p>
<p>æ‰€ä»¥ï¼Œæ ¹æ® <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Attention</mtext><mo stretchy="false">(</mo><mi mathvariant="bold">Q</mi><mo separator="true">,</mo><mi mathvariant="bold">K</mi><mo separator="true">,</mo><mi mathvariant="bold">V</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{Attention}(\mathbf{Q},\mathbf{K},\mathbf{V})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Attention</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">Q</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf">K</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span><span class="mclose">)</span></span></span></span>ï¼ŒTransformer å¯ä»¥ç†è§£ä¸€å¥è¯ä¸­ä¸åŒè¯ä¹‹é—´çš„ç›¸äº’å…³ç³»ã€‚</p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">Q</mi><mo separator="true">,</mo><mi mathvariant="bold">K</mi><mo separator="true">,</mo><mi mathvariant="bold">V</mi></mrow><annotation encoding="application/x-tex">\mathbf{Q},\mathbf{K},\mathbf{V}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8805499999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathbf">Q</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf">K</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span></span></span></span> å’ŒåŸå§‹è¾“å…¥ä¹‹é—´çš„å…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤º<sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup>ï¼š</p>
<p><img src="/2024/10/16/What-exactly-is-attention/qkv.png" alt="è®¡ç®— Qã€Kã€V çŸ©é˜µçš„ç¤ºä¾‹"></p>
<h3 id="scaled-çš„è¯´æ˜">Scaled çš„è¯´æ˜</h3>
<p>å¯¹äºä¸€ä¸ª <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>Ã—</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">m\times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> çš„çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">A</mi></mrow><annotation encoding="application/x-tex">\mathbf{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">A</span></span></span></span></span>ï¼Œ<code>softmax()</code> çš„è®¡ç®—å¦‚ä¸‹ï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>softmax</mtext><mo stretchy="false">(</mo><msub><mi mathvariant="bold">A</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><mfrac><msup><mi>e</mi><msub><mi mathvariant="bold">A</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></msup><mrow><munderover><mo>âˆ‘</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msup><mi>e</mi><msub><mi mathvariant="bold">A</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">\text{softmax}(\mathbf{A}_{ij}) = \frac{e^{\mathbf{A}_{ij}}}{\sum_{k=1}^{n}e^{\mathbf{A}_{ik}}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord text"><span class="mord">softmax</span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">A</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.514279em;vertical-align:-0.994002em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.520277em;"><span style="top:-2.305708em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.769277em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">A</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.843277em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">A</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2818857142857143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.994002em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">d_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å˜å¤§æ—¶ï¼Œä¼šå­˜åœ¨å‘é‡ç‚¹ç§¯ç»“æœè¿‡å¤§çš„å¯èƒ½æ€§ï¼Œå¦‚æœ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">A</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathbf{A}_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.972218em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">A</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> å¾ˆå¤§ï¼Œåˆ™ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>e</mi><msub><mi mathvariant="bold">A</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></msup></mrow><annotation encoding="application/x-tex">e^{\mathbf{A}_{ij}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.843277em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.843277em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">A</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2818857142857143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> ä¼šè¿…é€Ÿè¶‹è¿‘äºæ— ç©·å¤§ï¼Œè€Œè¡Œå‘é‡ä¸­å…¶ä½™è¾ƒå°çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">A</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathbf{A}_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.972218em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">A</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> åˆ™ä¼šå˜å¾—ç›¸å¯¹è¾ƒå°ã€‚æ­¤æ—¶ï¼Œ<code>softmax()</code> çš„ç»“æœä¼šå‘ 0 æˆ– 1 çš„ä¸¤ä¸ªæç«¯å€¼æ¨ç§»ã€‚</p>
<p>æ ¹æ® <code>softmax()</code> çš„æ¢¯åº¦å®šä¹‰<sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup>ï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">âˆ‚</mi><mtext>softmax</mtext><mo stretchy="false">(</mo><msub><mi mathvariant="bold">A</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">âˆ‚</mi><msub><mi mathvariant="bold">A</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow></mfrac><mo>=</mo><mtext>softmax</mtext><mo stretchy="false">(</mo><msub><mi mathvariant="bold">A</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mn>1</mn><mo>âˆ’</mo><mtext>softmax</mtext><mo stretchy="false">(</mo><msub><mi mathvariant="bold">A</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\frac{\partial \text{softmax}(\mathbf{A}_{ij})}{\partial \mathbf{A}_{ij}} = \text{softmax}(\mathbf{A}_{ij})(1 - \text{softmax}(\mathbf{A}_{ij}))
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.399108em;vertical-align:-0.972108em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">âˆ‚</span><span class="mord"><span class="mord"><span class="mord mathbf">A</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">âˆ‚</span><span class="mord text"><span class="mord">softmax</span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">A</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.972108em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord text"><span class="mord">softmax</span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">A</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord text"><span class="mord">softmax</span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">A</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></p>
<p>å½“ <code>softmax()</code> çš„è¾“å‡ºå€¼è¿‡äºæç«¯ï¼ˆè¾“å‡º 0 æˆ– 1ï¼‰æ—¶ï¼Œ<code>softmax()</code> çš„æ¢¯åº¦ç»“æœå°†è¶‹è¿‘äºé›¶ï¼Œåœ¨åå‘ä¼ æ’­æ—¶ï¼Œæ¨¡å‹å‚æ•°çš„æ›´æ–°é€Ÿåº¦ä¼šéå¸¸æ…¢ï¼Œç”šè‡³æ¥è¿‘åœæ»ã€‚è¿™ä¹Ÿå°±æ˜¯æ‰€è°“çš„æ¢¯åº¦æ¶ˆå¤±ï¼ˆvanishing gradientï¼‰é—®é¢˜ï¼Œæ¢¯åº¦æ¶ˆå¤±ä¼šå¯¼è‡´æ¨¡å‹è®­ç»ƒæ•ˆç‡æå¤§é™ä½ï¼Œç‰¹åˆ«æ˜¯åœ¨æ·±åº¦ç¥ç»ç½‘ç»œä¸­ï¼Œæ¢¯åº¦æ¶ˆå¤±å¯èƒ½ä¼šå¯¼è‡´ç½‘ç»œæ— æ³•æœ‰æ•ˆå­¦ä¹ ã€‚</p>
<p>ä¸ºäº†é¿å…æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><msqrt><msub><mi>d</mi><mi>k</mi></msub></msqrt></mfrac></mrow><annotation encoding="application/x-tex">\frac{1}{\sqrt{d_k}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.383108em;vertical-align:-0.538em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.5864385em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8622307142857143em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mtight" style="padding-left:0.833em;"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.8222307142857144em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.08em;"><svg width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.17776928571428574em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.538em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> ç¼©æ”¾ç‚¹ç§¯ç»“æœï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi mathvariant="bold">Q</mi><msup><mi mathvariant="bold">K</mi><mi>T</mi></msup></mrow><msqrt><msub><mi>d</mi><mi>k</mi></msub></msqrt></mfrac></mrow><annotation encoding="application/x-tex">\frac{\mathbf{Q}\mathbf{K}^T}{\sqrt{d_k}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.627473em;vertical-align:-0.538em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.089473em;"><span style="top:-2.5864385em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8622307142857143em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mtight" style="padding-left:0.833em;"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.8222307142857144em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.08em;"><svg width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.17776928571428574em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.446108em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">Q</span></span><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">K</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9190928571428572em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.538em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>ã€‚ç¼©æ”¾ä¹‹åï¼Œç‚¹ç§¯ç»“æœçš„æ•°å€¼ä¼šå˜å°ï¼Œç¡®ä¿ <code>softmax()</code> çš„è¾“å…¥ä¸ä¼šè¿‡å¤§ï¼Œé¿å… <code>softmax()</code> è¾“å‡ºè¿‡äºæç«¯çš„å€¼ï¼Œä»è€Œä½¿å¾— <code>softmax()</code> çš„æ¢¯åº¦æ›´åŠ é€‚ä¸­ï¼Œè¿›è€Œæ›´æœ‰åˆ©äºæ¨¡å‹çš„æœ‰æ•ˆè®­ç»ƒã€‚</p>
<h3 id="multi-head-attention">Multi-Head Attention</h3>
<p>å›æƒ³ä¸€ä¸‹å‰é¢æˆ‘ä»¬ä»‹ç»çš„ <code>I am good</code> çš„ä¾‹å­ï¼Œæˆ‘ä»¬å‡è®¾è¯¥ç»“æœå°±æ˜¯æŒ‰ç…§ Transforer ä¸­çš„è‡ªæ³¨æ„åŠ›æœºåˆ¶è®¡ç®—è€Œæ¥ï¼Œé‚£ä¹ˆ <code>good</code> çš„è‡ªæ³¨æ„åŠ›ä¸ºï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">z</mi><mrow><mi mathvariant="bold">g</mi><mi mathvariant="bold">o</mi><mi mathvariant="bold">o</mi><mi mathvariant="bold">d</mi></mrow></msub><mo>=</mo><mn>0.90</mn><mo>â‹…</mo><msub><mi mathvariant="bold">v</mi><mi mathvariant="bold">I</mi></msub><mo>+</mo><mn>0.05</mn><mo>â‹…</mo><msub><mi mathvariant="bold">v</mi><mrow><mi mathvariant="bold">a</mi><mi mathvariant="bold">m</mi></mrow></msub><mo>+</mo><mn>0.05</mn><mo>â‹…</mo><msub><mi mathvariant="bold">v</mi><mrow><mi mathvariant="bold">g</mi><mi mathvariant="bold">o</mi><mi mathvariant="bold">o</mi><mi mathvariant="bold">d</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathbf{z_{good}} = 0.90 \cdot \mathbf{v_{I}} + 0.05 \cdot \mathbf{v_{am}} + 0.05 \cdot \mathbf{v_{good}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.730548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight" style="margin-right:0.01597em;">g</span><span class="mord mathbf mtight">o</span><span class="mord mathbf mtight">o</span><span class="mord mathbf mtight">d</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33027699999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.01597em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight">I</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">5</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.161108em;"><span style="top:-2.5500000000000003em;margin-left:-0.01597em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight">a</span><span class="mord mathbf mtight">m</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">5</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.730548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.01597em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight" style="margin-right:0.01597em;">g</span><span class="mord mathbf mtight">o</span><span class="mord mathbf mtight">o</span><span class="mord mathbf mtight">d</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>ç”±æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œ<code>good</code> çš„è‡ªæ³¨æ„åŠ›å€¼å®é™…ä¸Šç”± <code>I</code> çš„å€¼å‘é‡æ¥ä¸»å¯¼ã€‚</p>
<p>ä½†æ˜¯å¦‚æœæˆ‘ä»¬è¦è®¡ç®—ä¸‹å¥ä¸­çš„ <code>it</code> çš„è‡ªæ³¨æ„åŠ›å€¼å‘¢ï¼Ÿ<code>it</code> çš„è‡ªæ³¨æ„åŠ›å€¼åº”è¯¥ç”± <code>dog</code> ä¸»å¯¼è¿˜æ˜¯ç”± <code>food</code> ä¸»å¯¼å‘¢ï¼Ÿå½“ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“çš„çœ‹å‡ºï¼Œ<code>it</code> çš„è‡ªæ³¨æ„åŠ›å€¼åº”è¯¥ç”± <code>dog</code> ä¸»å¯¼ï¼Œä½†æ˜¯æœºå™¨å¦‚ä½•æ¥åˆ¤æ–­å‘¢ï¼Ÿ</p>
<blockquote>
<p>A dog ate the food because it was hungry.</p>
</blockquote>
<p>å¦‚æœ <code>it</code> çš„è‡ªæ³¨æ„åŠ›å€¼çš„ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼Œé‚£ä¹ˆ <code>it</code> çš„è‡ªæ³¨æ„åŠ›å€¼ç¡®å®ç”± <code>dog</code> ä¸»å¯¼ï¼š</p>
<p><img src="/2024/10/16/What-exactly-is-attention/msattention.png" alt></p>
<p>ä½†å¦‚æœ <code>it</code> çš„è‡ªæ³¨æ„åŠ›å€¼çš„ç»“æœå¦‚ä¸‹æ‰€ç¤ºå‘¢ï¼Ÿ</p>
<p><img src="/2024/10/16/What-exactly-is-attention/msattention_2.png" alt></p>
<p>å› æ­¤ï¼Œä¸ºäº†ç¡®ä¿ç»“æœçš„å‡†ç¡®æ€§ï¼Œæˆ‘ä»¬ä¸èƒ½ä¾èµ–ä¸€ä¸ªæ³¨æ„åŠ›çŸ©é˜µï¼Œè€Œåº”è¯¥è®¡ç®—å¤šä¸ªæ³¨æ„åŠ›çŸ©é˜µï¼Œå¹¶å°†è¿™å¤šä¸ªæ³¨æ„åŠ›çŸ©é˜µçš„ç»“æœæ•´åˆèµ·æ¥ï¼Œè¿™ä¹Ÿå°±æ˜¯ <code>Multi-Head Attention</code> çš„ç”±æ¥<sup class="footnote-ref"><a href="#fn4" id="fnref4">[4]</a></sup>ã€‚å¦‚æœæˆ‘ä»¬æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">h</span></span></span></span> ä¸ªæ³¨æ„åŠ›çŸ©é˜µï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æŒ‰å¦‚ä¸‹çš„æ–¹å¼å°†è¿™ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">h</span></span></span></span> ä¸ªæ³¨æ„åŠ›çŸ©é˜µçš„ç»“æœæ•´åˆèµ·æ¥å¾—åˆ°æœ€ç»ˆçš„æ³¨æ„åŠ›çŸ©é˜µï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>MultiHeadAttention</mtext><mo>=</mo><mtext>Concatenate</mtext><mo stretchy="false">(</mo><msub><mi mathvariant="bold">Z</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator="true">,</mo><msub><mi mathvariant="bold">Z</mi><mi>h</mi></msub><mo stretchy="false">)</mo><msup><mi mathvariant="bold">W</mi><mi>O</mi></msup></mrow><annotation encoding="application/x-tex">\text{MultiHeadAttention} = \text{Concatenate}(\mathbf{Z}_1,\cdots,\mathbf{Z}_h)\mathbf{W}^O
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord text"><span class="mord">MultiHeadAttention</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1413309999999999em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Concatenate</span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">Z</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">Z</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">h</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">O</span></span></span></span></span></span></span></span></span></span></span></span></p>
<h3 id="çŸ©é˜µ-w-o-çš„è¯´æ˜">çŸ©é˜µ W^O çš„è¯´æ˜</h3>
<p>æ ¹æ® <a href="https://arxiv.org/html/1706.03762v7">Attention Is All You Need</a> çš„ ç¬¬ 3.2.2 èŠ‚ <strong>Multi-Head Attention</strong> çš„æè¿°ï¼Œå¯¹äºå¤šå¤´æ³¨æ„åŠ›æœºåˆ¶ä¸­çš„ä»»ä½•ä¸€ä¸ªæ³¨æ„åŠ›å¤´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span> è€Œè¨€ï¼Œå…¶å„å‚æ•°çŸ©é˜µçš„ç»´åº¦å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<blockquote>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>W</mi><mi>i</mi><mi>Q</mi></msubsup><mo>âˆˆ</mo><msup><mi mathvariant="double-struck">R</mi><mrow><msub><mi>d</mi><mtext>model</mtext></msub><mo>Ã—</mo><msub><mi>d</mi><mi>k</mi></msub></mrow></msup></mrow><annotation encoding="application/x-tex">W_i^Q \in \mathbb{R}^{d_{\text{model}} \times d_k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.236103em;vertical-align:-0.276864em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.959239em;"><span style="top:-2.4231360000000004em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.1809080000000005em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">Q</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.276864em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8491079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">model</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span><span class="mbin mtight">Ã—</span><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>W</mi><mi>i</mi><mi>K</mi></msubsup><mo>âˆˆ</mo><msup><mi mathvariant="double-struck">R</mi><mrow><msub><mi>d</mi><mtext>model</mtext></msub><mo>Ã—</mo><msub><mi>d</mi><mi>k</mi></msub></mrow></msup></mrow><annotation encoding="application/x-tex">W_i^K \in \mathbb{R}^{d_{\text{model}} \times d_k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0999949999999998em;vertical-align:-0.258664em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-2.441336em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07153em;">K</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.258664em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8491079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">model</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span><span class="mbin mtight">Ã—</span><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>W</mi><mi>i</mi><mi>V</mi></msubsup><mo>âˆˆ</mo><msup><mi mathvariant="double-struck">R</mi><mrow><msub><mi>d</mi><mtext>model</mtext></msub><mo>Ã—</mo><msub><mi>d</mi><mi>v</mi></msub></mrow></msup></mrow><annotation encoding="application/x-tex">W_i^V \in \mathbb{R}^{d_{\text{model}} \times d_v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0999949999999998em;vertical-align:-0.258664em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-2.441336em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.258664em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8491079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">model</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span><span class="mbin mtight">Ã—</span><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>W</mi><mi>O</mi></msup><mo>âˆˆ</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mi>h</mi><msub><mi>d</mi><mi>v</mi></msub><mo>Ã—</mo><msub><mi>d</mi><mtext>model</mtext></msub></mrow></msup></mrow><annotation encoding="application/x-tex">W^O \in \mathbb{R}^{h d_v \times d_{\text{model}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.880431em;vertical-align:-0.0391em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">O</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8491079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">Ã—</span><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">model</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>
</blockquote>
<p>å…¶ä¸­ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mtext>model</mtext></msub></mrow><annotation encoding="application/x-tex">d_{\text{model}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">model</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä¸ºæ¨¡å‹è¯å‘é‡çš„ç»´åº¦ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">d_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><msub><mi mathvariant="bold">W</mi><mi mathvariant="bold">i</mi></msub><mi>Q</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{W_i}^Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0673409999999999em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.01597em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.917341em;"><span style="top:-3.1390100000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">Q</span></span></span></span></span></span></span></span></span></span></span>ã€<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><msub><mi mathvariant="bold">W</mi><mi mathvariant="bold">i</mi></msub><mi>K</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{W_i}^K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0673409999999999em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.01597em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.917341em;"><span style="top:-3.1390100000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07153em;">K</span></span></span></span></span></span></span></span></span></span></span>çš„åˆ—å‘é‡ç»´åº¦ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">d_v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><msub><mi mathvariant="bold">W</mi><mi mathvariant="bold">i</mi></msub><mi>V</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf {W_i}^V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0673409999999999em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.01597em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.917341em;"><span style="top:-3.1390100000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">V</span></span></span></span></span></span></span></span></span></span></span> çš„åˆ—å‘é‡ç»´åº¦ã€‚</p>
<p>æ‰€ä»¥ï¼ŒçŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold">W</mi><mi>O</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{W}^O</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">O</span></span></span></span></span></span></span></span></span></span></span> ä¸»è¦æœ‰ä¸¤ä¸ªä½œç”¨ï¼š</p>
<ul>
<li>æŠŠ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">h</span></span></span></span> ä¸ªæ³¨æ„åŠ›å¤´è¾“å‡ºçš„æ‹¼æ¥ç»“æœè½¬æ¢æˆå•ä¸ªæ³¨æ„åŠ›å¤´çš„ç»´åº¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="double-struck">R</mi><mrow><msub><mi>d</mi><mtext>model</mtext></msub><mo>Ã—</mo><msub><mi>d</mi><mi>v</mi></msub></mrow></msup></mrow><annotation encoding="application/x-tex">\mathbb{R}^{d_{\text{model}} \times d_v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">model</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span><span class="mbin mtight">Ã—</span><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></li>
<li>æŠŠå•ä¸ªæ³¨æ„åŠ›å¤´çš„ç»´åº¦å†æ¬¡è½¬æ¢ä¸ºæ¨¡å‹çš„è¯å‘é‡ç»´åº¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="double-struck">R</mi><mrow><msub><mi>d</mi><mtext>model</mtext></msub><mo>Ã—</mo><msub><mi>d</mi><mtext>model</mtext></msub></mrow></msup></mrow><annotation encoding="application/x-tex">\mathbb{R}^{d_{\text{model}} \times d_{\text{model}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">model</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span><span class="mbin mtight">Ã—</span><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">model</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></li>
</ul>
<p>å®é™…ä¸Šï¼Œå¦‚ä¸Šçš„æ“ä½œå…¶å®æ˜¯æŠŠä¸¤ä¸ªçº¿æ€§å˜æ¢æ“ä½œåˆå¹¶åˆ°äº†ä¸€ä¸ªçŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold">W</mi><mi>O</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{W}^O</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">O</span></span></span></span></span></span></span></span></span></span></span> ä¸­ã€‚åœ¨ <a href="https://www.3blue1brown.com/lessons/attention">Visualizing Attention, a Transformerâ€™s Heart</a> çš„ç¬¬ 23:08 çš„æ—¶å€™ï¼Œä¹Ÿå¯¹æ­¤è¿›è¡Œäº†è¯¦ç»†çš„è¯´æ˜<sup class="footnote-ref"><a href="#fn5" id="fnref5">[5]</a></sup>,<sup class="footnote-ref"><a href="#fn6" id="fnref6">[6]</a></sup>ã€‚</p>
<p><img src="/2024/10/16/What-exactly-is-attention/wo_note.png" alt></p>
<h2 id="transformer-ä¸­çš„-positional-encoding">Transformer ä¸­çš„ Positional Encoding</h2>
<p>å¯¹äº Transformer æ¨¡å‹è€Œè¨€ï¼Œä¸ºäº†ç¼©çŸ­è®­ç»ƒæ—¶é—´ï¼Œæˆ‘ä»¬ä¼šå°†ä¸€å¥è¯ä¸­çš„æ‰€æœ‰çš„è¯å¹¶è¡Œçš„è¾“å…¥åˆ°æ¨¡å‹ä¸­ã€‚ä½†æ˜¯ï¼Œè¿™ä¹Ÿå¸¦æ¥äº†ä¸€ä¸ªé—®é¢˜ï¼šå¹¶è¡Œè¾“å…¥çš„è¯å‘é‡ä¹‹é—´ä¸¢å¤±äº†ç›¸äº’ä¹‹é—´çš„ä½ç½®ä¿¡æ¯ã€‚è¯åºä¿¡æ¯èƒ½å¤Ÿå¸®åŠ© Transformer æ¨¡å‹å­¦ä¹ è¯ä¸è¯ä¹‹é—´çš„ç›¸äº’å…³ç³»ï¼Œå› æ­¤ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒTransformer ä¸­å¼•å…¥äº† <code>Positional Encoding</code>ã€‚</p>
<p>å¯¹äºä¸€ä¸ªç»™å®šçš„å¥å­ï¼Œä¾‹å¦‚ï¼š<code>I am good</code>ï¼Œæˆ‘ä»¬é¦–å…ˆè®¡ç®—æ¯ä¸ªå•è¯çš„è¯å‘é‡è¡¨ç¤ºï¼ˆå‡å®šè¯å‘é‡çš„ç»´åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">d_{model}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼‰ã€‚å¦‚æœ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub><mo>=</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">d_{model} = 4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">4</span></span></span></span>ï¼Œé‚£ä¹ˆå¯¹äº <code>I am good</code> è€Œè¨€ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn><mo>Ã—</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">3 \times 4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">4</span></span></span></span> çš„è¾“å…¥çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">X</mi></mrow><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">X</span></span></span></span></span>ï¼š</p>
<p><img src="/2024/10/16/What-exactly-is-attention/pe_input_x.png" alt="è¾“å…¥çŸ©é˜µ X"></p>
<p>å¦‚æœæŠŠ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">X</mi></mrow><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">X</span></span></span></span></span> ç›´æ¥è¾“å…¥åˆ° Transformer çš„ Encoder ä¸­ï¼Œé‚£ä¹ˆæ¨¡å‹æ— æ³•ç†è§£ä¸åŒå•è¯ä¹‹é—´çš„è¯åºã€‚æ‰€ä»¥ï¼Œéœ€è¦å¯¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">X</mi></mrow><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">X</span></span></span></span></span> å¢åŠ ä¸€äº›è¡¨ç¤ºè¯åºä¿¡æ¯çš„æ•°æ®ï¼Œä»¥ä¾¿æ¨¡å‹å¯ä»¥æ­£ç¡®ç†è§£å¥å­çš„å«ä¹‰ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ ä¸€ä¸ªåŒ…å«ä½ç½®ç¼–ç ä¿¡æ¯çš„çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">P</mi></mrow><annotation encoding="application/x-tex">\mathbf{P}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">P</span></span></span></span></span>ï¼Œç„¶åæŠŠçŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">P</mi></mrow><annotation encoding="application/x-tex">\mathbf{P}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">P</span></span></span></span></span> æ·»åŠ åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">X</mi></mrow><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">X</span></span></span></span></span> ä¸­ï¼Œå³å¯å¾—åˆ°åŒ…å«ä½ç½®ä¿¡æ¯çš„è¾“å…¥çŸ©é˜µã€‚</p>
<p>åœ¨ <a href="https://arxiv.org/html/1706.03762v7">Attention Is All You Need</a> çš„ç¬¬ 3.5 èŠ‚ <strong>Positional Encoding</strong> ä¸­ç»™å‡ºäº†ä½ç½®çŸ©é˜µçš„è®¡ç®—æ–¹å¼ï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi mathvariant="bold">P</mi><mo stretchy="false">(</mo><mi>p</mi><mi>o</mi><mi>s</mi><mo separator="true">,</mo><mn>2</mn><mi>i</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>s</mi><mi>i</mi><mi>n</mi><mrow><mo fence="true">(</mo><mfrac><mrow><mi>p</mi><mi>o</mi><mi>s</mi></mrow><mrow><mn>1000</mn><msup><mn>0</mn><mrow><mn>2</mn><mi>i</mi><mi mathvariant="normal">/</mi><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub></mrow></msup></mrow></mfrac><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi mathvariant="bold">P</mi><mo stretchy="false">(</mo><mi>p</mi><mi>o</mi><mi>s</mi><mo separator="true">,</mo><mn>2</mn><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>c</mi><mi>o</mi><mi>s</mi><mrow><mo fence="true">(</mo><mfrac><mrow><mi>p</mi><mi>o</mi><mi>s</mi></mrow><mrow><mn>1000</mn><msup><mn>0</mn><mrow><mn>2</mn><mi>i</mi><mi mathvariant="normal">/</mi><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub></mrow></msup></mrow></mfrac><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
\mathbf{P}(pos, 2i) &amp;= sin\left(\frac{pos}{10000^{2i/d_{model}}}\right) \\ 
\mathbf{P}(pos, 2i + 1) &amp;= cos\left(\frac{pos}{10000^{2i/d_{model}}}\right)
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.308em;vertical-align:-1.904em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.404em;"><span style="top:-4.404em;"><span class="pstrut" style="height:3.15em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">P</span></span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mord mathdefault">i</span><span class="mclose">)</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.15em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">P</span></span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.904em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.404em;"><span style="top:-4.404em;"><span class="pstrut" style="height:3.15em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1075599999999999em;"><span style="top:-2.2960000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.814em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathdefault mtight">i</span><span class="mord mtight">/</span><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.704em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.15em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1075599999999999em;"><span style="top:-2.2960000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.814em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathdefault mtight">i</span><span class="mord mtight">/</span><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.704em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.904em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>o</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">pos</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span></span></span></span> è¡¨ç¤ºå½“å‰çš„å•è¯åœ¨å¥å­ä¸­çš„ä½ç½®ï¼Œä¹Ÿå°±æ˜¯è¾“å…¥çŸ©é˜µçš„ç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>o</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">pos</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span></span></span></span> è¡Œï¼ˆä» 0 å¼€å§‹ç´¢å¼•ï¼‰ï¼›</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span> è¡¨ç¤ºå½“å‰çš„å•è¯åœ¨è¾“å…¥çŸ©é˜µä¸­çš„åˆ—ä½ç½®ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>i</mi></mrow><annotation encoding="application/x-tex">2i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord mathdefault">i</span></span></span></span> è¡¨ç¤º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">P</mi></mrow><annotation encoding="application/x-tex">\mathbf{P}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">P</span></span></span></span></span> çš„æ‰€æœ‰å¶æ•°åˆ—ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>i</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2i+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.74285em;vertical-align:-0.08333em;"></span><span class="mord">2</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> è¡¨ç¤ºæ‰€æœ‰çš„å¥‡æ•°åˆ—ã€‚</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">d_{model}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> æ˜¯è¯å‘é‡çš„ç»´åº¦ã€‚</li>
</ul>
<p>æ ¹æ®ä½ç½®çŸ©é˜µçš„è®¡ç®—å…¬å¼ï¼Œå¯¹ä¸æ‰€æœ‰çš„å¶æ•°åˆ—ï¼Œä½¿ç”¨æ­£å¼¦å‡½æ•°è®¡ç®—ä½ç½®ç¼–ç ä¿¡æ¯ï¼›å¯¹äºæ‰€æœ‰çš„å¥‡æ•°åˆ—ï¼Œä½¿ç”¨ä½™å¼¦å‡½æ•°è®¡ç®—ä½ç½®ç¼–ç ä¿¡æ¯ã€‚å¯¹äº <code>I am good</code> è€Œè¨€ï¼Œä½ç½®çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">P</mi></mrow><annotation encoding="application/x-tex">\mathbf{P}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">P</span></span></span></span></span> çš„è®¡ç®—ç»“æœå¦‚ä¸‹ï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mi mathvariant="bold">P</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mrow><mo fence="true">(</mo><mfrac><mrow><mi>p</mi><mi>o</mi><mi>s</mi></mrow><mrow><mn>1000</mn><msup><mn>0</mn><mn>0</mn></msup></mrow></mfrac><mo fence="true">)</mo></mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mrow><mo fence="true">(</mo><mfrac><mrow><mi>p</mi><mi>o</mi><mi>s</mi></mrow><mrow><mn>1000</mn><msup><mn>0</mn><mn>0</mn></msup></mrow></mfrac><mo fence="true">)</mo></mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mrow><mo fence="true">(</mo><mfrac><mrow><mi>p</mi><mi>o</mi><mi>s</mi></mrow><mrow><mn>1000</mn><msup><mn>0</mn><mrow><mn>2</mn><mi mathvariant="normal">/</mi><mn>4</mn></mrow></msup></mrow></mfrac><mo fence="true">)</mo></mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mrow><mo fence="true">(</mo><mfrac><mrow><mi>p</mi><mi>o</mi><mi>s</mi></mrow><mrow><mn>1000</mn><msup><mn>0</mn><mrow><mn>2</mn><mi mathvariant="normal">/</mi><mn>4</mn></mrow></msup></mrow></mfrac><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mrow><mo fence="true">(</mo><mfrac><mrow><mi>p</mi><mi>o</mi><mi>s</mi></mrow><mrow><mn>1000</mn><msup><mn>0</mn><mn>0</mn></msup></mrow></mfrac><mo fence="true">)</mo></mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mrow><mo fence="true">(</mo><mfrac><mrow><mi>p</mi><mi>o</mi><mi>s</mi></mrow><mrow><mn>1000</mn><msup><mn>0</mn><mn>0</mn></msup></mrow></mfrac><mo fence="true">)</mo></mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mrow><mo fence="true">(</mo><mfrac><mrow><mi>p</mi><mi>o</mi><mi>s</mi></mrow><mrow><mn>1000</mn><msup><mn>0</mn><mrow><mn>2</mn><mi mathvariant="normal">/</mi><mn>4</mn></mrow></msup></mrow></mfrac><mo fence="true">)</mo></mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mrow><mo fence="true">(</mo><mfrac><mrow><mi>p</mi><mi>o</mi><mi>s</mi></mrow><mrow><mn>1000</mn><msup><mn>0</mn><mrow><mn>2</mn><mi mathvariant="normal">/</mi><mn>4</mn></mrow></msup></mrow></mfrac><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mrow><mo fence="true">(</mo><mfrac><mrow><mi>p</mi><mi>o</mi><mi>s</mi></mrow><mrow><mn>1000</mn><msup><mn>0</mn><mn>0</mn></msup></mrow></mfrac><mo fence="true">)</mo></mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mrow><mo fence="true">(</mo><mfrac><mrow><mi>p</mi><mi>o</mi><mi>s</mi></mrow><mrow><mn>1000</mn><msup><mn>0</mn><mn>0</mn></msup></mrow></mfrac><mo fence="true">)</mo></mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mrow><mo fence="true">(</mo><mfrac><mrow><mi>p</mi><mi>o</mi><mi>s</mi></mrow><mrow><mn>1000</mn><msup><mn>0</mn><mrow><mn>2</mn><mi mathvariant="normal">/</mi><mn>4</mn></mrow></msup></mrow></mfrac><mo fence="true">)</mo></mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mrow><mo fence="true">(</mo><mfrac><mrow><mi>p</mi><mi>o</mi><mi>s</mi></mrow><mrow><mn>1000</mn><msup><mn>0</mn><mrow><mn>2</mn><mi mathvariant="normal">/</mi><mn>4</mn></mrow></msup></mrow></mfrac><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mn>0</mn><mi mathvariant="normal">/</mi><mn>100</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mn>0</mn><mi mathvariant="normal">/</mi><mn>100</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mn>1</mn><mi mathvariant="normal">/</mi><mn>100</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mn>1</mn><mi mathvariant="normal">/</mi><mn>100</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mn>2</mn><mi mathvariant="normal">/</mi><mn>100</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mn>2</mn><mi mathvariant="normal">/</mi><mn>100</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.841</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.54</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.01</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.99</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.909</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mn>0.416</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.02</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.99</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
\mathbf{P} &amp;= 
\begin{bmatrix}
sin\left(\frac{pos}{10000^{0}}\right) &amp; cos\left(\frac{pos}{10000^{0}}\right) &amp; sin\left(\frac{pos}{10000^{2/4}}\right) &amp; cos\left(\frac{pos}{10000^{2/4}}\right) \\
sin\left(\frac{pos}{10000^{0}}\right) &amp; cos\left(\frac{pos}{10000^{0}}\right) &amp; sin\left(\frac{pos}{10000^{2/4}}\right) &amp; cos\left(\frac{pos}{10000^{2/4}}\right) \\
sin\left(\frac{pos}{10000^{0}}\right) &amp; cos\left(\frac{pos}{10000^{0}}\right) &amp; sin\left(\frac{pos}{10000^{2/4}}\right) &amp; cos\left(\frac{pos}{10000^{2/4}}\right)
\end{bmatrix} \\
&amp;= \begin{bmatrix}
sin(0) &amp; cos(0) &amp; sin(0/100) &amp; cos(0 / 100) \\
sin(1) &amp; cos(1) &amp; sin(1/100) &amp; cos(1 / 100) \\
sin(2) &amp; cos(2) &amp; sin(2/100) &amp; cos(2 / 100) \\
\end{bmatrix} \\
&amp;= \begin{bmatrix}
0 &amp; 1 &amp; 0 &amp; 1 \\
0.841 &amp; 0.54 &amp; 0.01 &amp; 0.99 \\
0.909 &amp; -0.416 &amp; 0.02 &amp; 0.99 
\end{bmatrix}
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:11.808335em;vertical-align:-5.6541675em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:6.1541675em;"><span style="top:-8.1541675em;"><span class="pstrut" style="height:4.1031375em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">P</span></span></span></span><span style="top:-4.2000199999999985em;"><span class="pstrut" style="height:4.1031375em;"></span><span class="mord"></span></span><span style="top:-0.2989900000000001em;"><span class="pstrut" style="height:4.1031375em;"></span><span class="mord"></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:5.6541675em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:6.1541675em;"><span style="top:-8.1541675em;"><span class="pstrut" style="height:4.1031375em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0510099999999998em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.8099900000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-4.05101em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.1031375em;"><span style="top:-4.253137499999999em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7475em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span><span class="mord mtight">0</span><span class="mord mtight">0</span><span class="mord mtight"><span class="mord mtight">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7463142857142857em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.446108em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span><span style="top:-3.0177125000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7475em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span><span class="mord mtight">0</span><span class="mord mtight">0</span><span class="mord mtight"><span class="mord mtight">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7463142857142857em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.446108em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span><span style="top:-1.7822874999999998em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7475em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span><span class="mord mtight">0</span><span class="mord mtight">0</span><span class="mord mtight"><span class="mord mtight">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7463142857142857em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.446108em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.6031375em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.1031375em;"><span style="top:-4.253137499999999em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7475em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span><span class="mord mtight">0</span><span class="mord mtight">0</span><span class="mord mtight"><span class="mord mtight">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7463142857142857em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.446108em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span><span style="top:-3.0177125000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7475em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span><span class="mord mtight">0</span><span class="mord mtight">0</span><span class="mord mtight"><span class="mord mtight">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7463142857142857em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.446108em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span><span style="top:-1.7822874999999998em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7475em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span><span class="mord mtight">0</span><span class="mord mtight">0</span><span class="mord mtight"><span class="mord mtight">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7463142857142857em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.446108em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.6031375em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.1031375em;"><span style="top:-4.253137499999999em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7475em;"><span style="top:-2.614575em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span><span class="mord mtight">0</span><span class="mord mtight">0</span><span class="mord mtight"><span class="mord mtight">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8220357142857143em;"><span style="top:-2.8220357142857138em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">/</span><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.446108em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.38542499999999996em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span><span style="top:-3.0177125000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7475em;"><span style="top:-2.614575em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span><span class="mord mtight">0</span><span class="mord mtight">0</span><span class="mord mtight"><span class="mord mtight">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8220357142857143em;"><span style="top:-2.8220357142857138em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">/</span><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.446108em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.38542499999999996em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span><span style="top:-1.7822874999999998em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7475em;"><span style="top:-2.614575em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span><span class="mord mtight">0</span><span class="mord mtight">0</span><span class="mord mtight"><span class="mord mtight">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8220357142857143em;"><span style="top:-2.8220357142857138em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">/</span><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.446108em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.38542499999999996em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.6031375em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.1031375em;"><span style="top:-4.253137499999999em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7475em;"><span style="top:-2.614575em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span><span class="mord mtight">0</span><span class="mord mtight">0</span><span class="mord mtight"><span class="mord mtight">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8220357142857143em;"><span style="top:-2.8220357142857138em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">/</span><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.446108em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.38542499999999996em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span><span style="top:-3.0177125000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7475em;"><span style="top:-2.614575em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span><span class="mord mtight">0</span><span class="mord mtight">0</span><span class="mord mtight"><span class="mord mtight">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8220357142857143em;"><span style="top:-2.8220357142857138em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">/</span><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.446108em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.38542499999999996em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span><span style="top:-1.7822874999999998em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7475em;"><span style="top:-2.614575em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span><span class="mord mtight">0</span><span class="mord mtight">0</span><span class="mord mtight"><span class="mord mtight">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8220357142857143em;"><span style="top:-2.8220357142857138em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">/</span><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.446108em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.38542499999999996em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.6031375em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0510099999999998em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.8099900000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-4.05101em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-4.2000199999999985em;"><span class="pstrut" style="height:4.1031375em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0510099999999998em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.8099900000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-4.05101em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord">2</span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mopen">(</span><span class="mord">2</span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord">0</span><span class="mord">/</span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mclose">)</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord">1</span><span class="mord">/</span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mclose">)</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord">2</span><span class="mord">/</span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mopen">(</span><span class="mord">0</span><span class="mord">/</span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mclose">)</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mopen">(</span><span class="mord">1</span><span class="mord">/</span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mclose">)</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mopen">(</span><span class="mord">2</span><span class="mord">/</span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0510099999999998em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.8099900000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-4.05101em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-0.2989900000000001em;"><span class="pstrut" style="height:4.1031375em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0510099999999998em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.8099900000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-4.05101em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">8</span><span class="mord">4</span><span class="mord">1</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span><span class="mord">0</span><span class="mord">9</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mord">4</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ’</span><span class="mord">0</span><span class="mord">.</span><span class="mord">4</span><span class="mord">1</span><span class="mord">6</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">1</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span><span class="mord">9</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span><span class="mord">9</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0510099999999998em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.8099900000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-4.05101em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:5.6541675em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>äºæ˜¯ï¼Œæˆ‘ä»¬å¾—åˆ°äº†åŒ…å«ä½ç½®ä¿¡æ¯çš„è¾“å…¥çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">X</mi><mo>+</mo><mi mathvariant="bold">P</mi></mrow><annotation encoding="application/x-tex">\mathbf{X} + \mathbf{P}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76944em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathbf">X</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">P</span></span></span></span></span>ï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi mathvariant="bold">X</mi><mo>+</mo><mi mathvariant="bold">P</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1.8</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2.2</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>3.4</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>5.8</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>7.3</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>9.9</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>8.5</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>7.1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>9.1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>7.1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.9</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>10.1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>+</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.841</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.54</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.01</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.99</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.909</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mn>0.416</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.02</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.99</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1.8</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>3.2</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>3.4</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>6.8</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>8.141</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>10.44</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>8.51</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>8.09</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>10.009</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>6.684</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.92</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>11.09</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
\mathbf{X} + \mathbf{P} &amp;= 
\begin{bmatrix}
1.8 &amp; 2.2 &amp; 3.4 &amp; 5.8 \\
7.3 &amp; 9.9 &amp; 8.5 &amp; 7.1 \\
9.1 &amp; 7.1 &amp; 0.9 &amp; 10.1 
\end{bmatrix} + 
\begin{bmatrix}
0 &amp; 1 &amp; 0 &amp; 1 \\
0.841 &amp; 0.54 &amp; 0.01 &amp; 0.99 \\
0.909 &amp; -0.416 &amp; 0.02 &amp; 0.99 
\end{bmatrix} \\
&amp;= \begin{bmatrix}
1.8 &amp; 3.2 &amp; 3.4 &amp; 6.8 \\
8.141 &amp; 10.44 &amp; 8.51 &amp; 8.09 \\
10.009 &amp; 6.684 &amp; 0.92 &amp; 11.09
\end{bmatrix}
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:7.802059999999999em;vertical-align:-3.6510299999999996em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.1510299999999996em;"><span style="top:-6.1510299999999996em;"><span class="pstrut" style="height:4.05101em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">X</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathbf">P</span></span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:4.05101em;"></span><span class="mord"></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:3.6510299999999996em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.1510299999999996em;"><span style="top:-6.1510299999999996em;"><span class="pstrut" style="height:4.05101em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0510099999999998em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.8099900000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-4.05101em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mord">.</span><span class="mord">8</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">7</span><span class="mord">.</span><span class="mord">3</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">9</span><span class="mord">.</span><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord">.</span><span class="mord">2</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">9</span><span class="mord">.</span><span class="mord">9</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">7</span><span class="mord">.</span><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">3</span><span class="mord">.</span><span class="mord">4</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">8</span><span class="mord">.</span><span class="mord">5</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">5</span><span class="mord">.</span><span class="mord">8</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">7</span><span class="mord">.</span><span class="mord">1</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0510099999999998em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.8099900000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-4.05101em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0510099999999998em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.8099900000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-4.05101em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">8</span><span class="mord">4</span><span class="mord">1</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span><span class="mord">0</span><span class="mord">9</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mord">4</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ’</span><span class="mord">0</span><span class="mord">.</span><span class="mord">4</span><span class="mord">1</span><span class="mord">6</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">1</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span><span class="mord">9</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span><span class="mord">9</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0510099999999998em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.8099900000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-4.05101em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:4.05101em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0510099999999998em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.8099900000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-4.05101em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mord">.</span><span class="mord">8</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">8</span><span class="mord">.</span><span class="mord">1</span><span class="mord">4</span><span class="mord">1</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">0</span><span class="mord">9</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">3</span><span class="mord">.</span><span class="mord">2</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mord">0</span><span class="mord">.</span><span class="mord">4</span><span class="mord">4</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">6</span><span class="mord">.</span><span class="mord">6</span><span class="mord">8</span><span class="mord">4</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">3</span><span class="mord">.</span><span class="mord">4</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">8</span><span class="mord">.</span><span class="mord">5</span><span class="mord">1</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span><span class="mord">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">6</span><span class="mord">.</span><span class="mord">8</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">8</span><span class="mord">.</span><span class="mord">0</span><span class="mord">9</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mord">1</span><span class="mord">.</span><span class="mord">0</span><span class="mord">9</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0510099999999998em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.8099900000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-4.05101em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:3.6510299999999996em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>è®¡ç®—ä½ç½®çŸ©é˜µçš„ R ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä½ç½®ç¼–ç å‡½æ•°ï¼Œä» 0 å¼€å§‹è®¡ç®—</span></span><br><span class="line">get_position_encoding &lt;- <span class="keyword">function</span>(<span class="built_in">seq_len</span>, d_model) &#123;</span><br><span class="line">  position &lt;- 0:(<span class="built_in">seq_len</span> - <span class="number">1</span>)</span><br><span class="line">  div_term &lt;- <span class="built_in">exp</span>(seq(<span class="number">0</span>, d_model - <span class="number">1</span>, by = <span class="number">2</span>) * -(<span class="built_in">log</span>(<span class="number">10000</span>) / d_model))</span><br><span class="line">  </span><br><span class="line">  <span class="comment"># åˆå§‹åŒ–ä½ç½®ç¼–ç çŸ©é˜µ</span></span><br><span class="line">  position_enc &lt;- matrix(<span class="number">0</span>, nrow = <span class="built_in">seq_len</span>, ncol = d_model)</span><br><span class="line">  <span class="keyword">for</span> (pos <span class="keyword">in</span> <span class="number">0</span>:(<span class="built_in">seq_len</span> - <span class="number">1</span>)) &#123;</span><br><span class="line">    <span class="comment"># å¥‡æ•°ç´¢å¼•ï¼šsinå‡½æ•°</span></span><br><span class="line">    position_enc[pos + <span class="number">1</span>, seq(<span class="number">1</span>, d_model, by = <span class="number">2</span>)] &lt;- <span class="built_in">sin</span>(pos * div_term)</span><br><span class="line">    <span class="comment"># å¶æ•°ç´¢å¼•ï¼šcoså‡½æ•°</span></span><br><span class="line">    position_enc[pos + <span class="number">1</span>, seq(<span class="number">2</span>, d_model, by = <span class="number">2</span>)] &lt;- <span class="built_in">cos</span>(pos * div_term)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">return</span>(position_enc)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆä½ç½®ç¼–ç çŸ©é˜µ</span></span><br><span class="line">position_encoding_matrix &lt;- get_position_encoding(<span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹ä½ç½®ç¼–ç çŸ©é˜µ</span></span><br><span class="line">print(position_encoding_matrix)</span><br></pre></td></tr></table></figure>
<p>å¦‚æœä¸€ä¸ªå¥å­åŒ…å« 128 ä¸ªè¯ï¼Œæ¯ä¸ªè¯å‘é‡çš„ç»´åº¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub><mo>=</mo><mn>512</mn></mrow><annotation encoding="application/x-tex">d_{model} = 512</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">5</span><span class="mord">1</span><span class="mord">2</span></span></span></span>ï¼Œé‚£ä¹ˆä½ç½®ç¼–ç çŸ©é˜µçš„ç»´åº¦ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>128</mn><mo>Ã—</mo><mn>512</mn></mrow><annotation encoding="application/x-tex">128 \times 512</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mord">2</span><span class="mord">8</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">5</span><span class="mord">1</span><span class="mord">2</span></span></span></span>ï¼Œå¯ä»¥ç”¨å¦‚ä¸‹çš„ R ä»£ç ç”Ÿæˆä½ç½®ç¼–ç çŸ©é˜µï¼Œå¹¶å¯¹å…¶å¯è§†åŒ–ã€‚</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">position_encoding_matrix &lt;- get_position_encoding(<span class="number">128</span>, <span class="number">512</span>)</span><br><span class="line">position_encoding_df &lt;- melt(position_encoding_matrix)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»˜åˆ¶çƒ­å›¾</span></span><br><span class="line">ggplot(position_encoding_df, aes(x = Var2, y = Var1, fill = value)) +</span><br><span class="line">  geom_tile() +</span><br><span class="line">  scale_fill_viridis_c() +                     <span class="comment"># ä½¿ç”¨ç±»ä¼¼çš„é¢œè‰²æ˜ å°„</span></span><br><span class="line">  scale_y_reverse() + </span><br><span class="line">  theme_minimal(base_family = <span class="string">&quot;STKaiti&quot;</span>) + </span><br><span class="line">  scale_x_continuous(expand = expansion(mult = <span class="built_in">c</span>(<span class="number">0</span>, <span class="number">0.05</span>))) + </span><br><span class="line">  labs(title = <span class="string">&quot;Position Encoding å¯è§†åŒ–&quot;</span>,</span><br><span class="line">       x = <span class="string">&quot;Dimensions&quot;</span>, y = <span class="string">&quot;words&quot;</span>, fill = <span class="string">&quot;Value&quot;</span>) + </span><br><span class="line">  theme(panel.grid.major.x = element_blank(),  <span class="comment"># ç§»é™¤ x è½´çš„ä¸»è¦ç½‘æ ¼çº¿</span></span><br><span class="line">        panel.grid.minor.x = element_blank(),</span><br><span class="line">        panel.grid.minor.y = element_blank(),</span><br><span class="line">        axis.line = element_line(),           <span class="comment"># ä¿ç•™xè½´å’Œyè½´æœ¬èº«</span></span><br><span class="line">        axis.ticks = element_line(),          <span class="comment"># ä¿ç•™xè½´å’Œyè½´ä¸Šçš„åˆ»åº¦çº¿</span></span><br><span class="line">        legend.position = <span class="string">&quot;top&quot;</span>,              <span class="comment"># å›¾ä¾‹æ”¾ç½®åœ¨å·¦ä¸Šè§’</span></span><br><span class="line">        legend.justification = <span class="built_in">c</span>(<span class="number">0</span>, <span class="number">1</span>),       <span class="comment"># è®¾ç½®å›¾ä¾‹çš„å¯¹é½æ–¹å¼</span></span><br><span class="line">        legend.title = element_blank())</span><br></pre></td></tr></table></figure>
<p><img src="/2024/10/16/What-exactly-is-attention/pe_hot_image.png" alt></p>
<h2 id="transformer-ä¸­çš„-encoder">Transformer ä¸­çš„ Encoder</h2>
<p>åœ¨ <code>Multi-Head Attention</code> å’Œ <code>Positional Encoding</code> çš„åŸºç¡€ä¹‹ä¸Šï¼Œå†å¢åŠ å‰é¦ˆç½‘ç»œã€å åŠ å’Œå½’ä¸€ç»„ä»¶ï¼Œå°±å¾—åˆ°äº†å®Œæ•´çš„ Transformer Encoderã€‚å½“ç„¶ï¼Œå®é™…ä¸­ï¼Œå¯ä»¥å°† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span> ä¸ª Encoder ä¸€ä¸ªä¸€ä¸ªçš„å åŠ èµ·æ¥ï¼Œæœ€åä¸€ä¸ª Encoder çš„è¾“å‡ºå°±æ˜¯åŸå§‹è¾“å…¥å†…å®¹çš„ç‰¹å¾å€¼ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">R</mi></mrow><annotation encoding="application/x-tex">\mathbf{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">R</span></span></span></span></span>ï¼ˆçŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">R</mi></mrow><annotation encoding="application/x-tex">\mathbf{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">R</span></span></span></span></span> ä¸è¾“å…¥å†…å®¹çš„è¯å‘é‡çŸ©é˜µçš„ç»´åº¦æ˜¯ä¸€è‡´çš„ï¼‰ã€‚</p>
<p><img src="/2024/10/16/What-exactly-is-attention/encoder.png" alt="Encoder æ¶æ„å›¾"></p>
<h2 id="transformer-ä¸­çš„-decoder">Transformer ä¸­çš„ Decoder</h2>
<p>å‡è®¾æˆ‘ä»¬è¦æŠŠè‹±è¯­å¥å­ <code>I am a student</code>ï¼ˆåŸå¥ï¼‰ç¿»è¯‘æˆä¸­æ–‡ <code>æˆ‘æ˜¯ä¸€ä¸ªå­¦ç”Ÿ</code>ï¼ˆç›®æ ‡å¥ï¼‰ã€‚</p>
<ol>
<li>é¦–å…ˆï¼Œæˆ‘ä»¬æŠŠåŸå¥ <code>I am a student</code> è¾“å…¥åˆ° Transformer çš„ Encoder ä¸­ï¼Œè®© Encoder å­¦ä¹ åŸå¥å¹¶å¾—åˆ°åŸå¥çš„ç‰¹å¾çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">R</mi></mrow><annotation encoding="application/x-tex">\mathbf{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">R</span></span></span></span></span>ã€‚</li>
<li>ç„¶åï¼Œæˆ‘ä»¬æŠŠ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">R</mi></mrow><annotation encoding="application/x-tex">\mathbf{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">R</span></span></span></span></span> è¾“å…¥åˆ°è§£ç å™¨ï¼Œè§£ç å™¨æ ¹æ® <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">R</mi></mrow><annotation encoding="application/x-tex">\mathbf{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">R</span></span></span></span></span> å’Œè§£ç å™¨ä¹‹å‰çš„è¾“å‡ºä½œä¸ºè¾“å…¥ï¼Œå¹¶ç”Ÿæˆç›®æ ‡å¥ä¸­çš„ä¸‹ä¸€ä¸ªè¯ï¼Œç›´åˆ°ç”Ÿæˆç›®æ ‡å¥ä¸ºæ­¢ï¼ˆè§£ç å™¨æ¯æ¬¡è¿­ä»£ä¼šç”Ÿæˆä¸€ä¸ªè¯ï¼Œç›´åˆ°ç”Ÿæˆç›®æ ‡å¥ä¸ºæ­¢ï¼‰ã€‚</li>
</ol>
<p>å…·ä½“çš„ç”Ÿæˆè¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="/2024/10/16/What-exactly-is-attention/decode_demo1.gif" alt="è§£ç å™¨çš„ä¾‹å­"></p>
<h3 id="å¸¦æ©ç çš„å¤šå¤´æ³¨æ„åŠ›å±‚">å¸¦æ©ç çš„å¤šå¤´æ³¨æ„åŠ›å±‚</h3>
<p>ä»¥å¦‚ä¸Šçš„ç¿»è¯‘è®¤ä¸ºä¸ºä¾‹ï¼Œå‡è®¾è®­ç»ƒæ•°æ®é›†å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<table>
<thead>
<tr>
<th style="text-align:center">åŸå¥</th>
<th style="text-align:center">ç›®æ ‡å¥</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">I am a student</td>
<td style="text-align:center">æˆ‘æ˜¯ä¸€ä¸ªå­¦ç”Ÿ</td>
</tr>
<tr>
<td style="text-align:center">I am a teacher</td>
<td style="text-align:center">æˆ‘æ˜¯ä¸€ä¸ªè€å¸ˆ</td>
</tr>
<tr>
<td style="text-align:center">Good morning</td>
<td style="text-align:center">æ—©ä¸Šå¥½</td>
</tr>
<tr>
<td style="text-align:center">Thank you very much</td>
<td style="text-align:center">éå¸¸æ„Ÿè°¢ä½ </td>
</tr>
</tbody>
</table>
<p>ä¸Šè¡¨æ‰€ç¤ºçš„æ•°æ®é›†ç”±ä¸¤éƒ¨åˆ†æ„æˆï¼š<code>åŸå¥</code> å’Œ <code>ç›®æ ‡å¥</code>ã€‚å¦‚å‰æ‰€è¿°ï¼Œæˆ‘ä»¬ä¹Ÿäº†è§£äº†è§£ç å™¨åœ¨ <strong>è¿è¡Œæ—¶</strong> é€å­—ï¼ˆtokenï¼‰é¢„æµ‹ç›®æ ‡å¥çš„è¿‡ç¨‹ã€‚ä½†æ˜¯ï¼Œåœ¨è®­ç»ƒæ—¶ï¼Œç”±äºæˆ‘ä»¬æœ‰æ ‡æ³¨å¥½çš„ã€æ­£ç¡®çš„ <code>ç›®æ ‡å¥</code>ï¼Œæ‰€ä»¥ï¼Œä¸ºäº†ç®€åŒ–è®­ç»ƒè¿‡ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹æ•´ä¸ª <code>ç›®æ ‡å¥</code> ç¨ä½œä¿®æ”¹ç„¶åå°†å…¶ä½œä¸ºè¾“å…¥ï¼ˆè€Œä¸éœ€è¦åƒ <strong>è¿è¡Œæ—¶</strong> é‚£æ ·é€å­—è¾“å…¥ï¼‰ã€‚è§£ç å™¨æŠŠè¾“å…¥çš„ <strong>&lt;sos&gt;</strong>ï¼ˆstart of sequenceï¼‰ä½œä¸ºç¬¬ä¸€ä¸ª tokenï¼Œå¹¶åœ¨ä¹‹åçš„æ¯ä¸€æ­¥ä¸­æŠŠä¸‹ä¸€ä¸ªé¢„æµ‹ token è¿½åŠ åˆ°å½“å‰çš„è¾“å…¥ï¼Œä»¥é¢„æµ‹ç›®æ ‡å¥ï¼Œç›´åˆ°é¢„æµ‹è¾“å‡ºä¸º <strong>&lt;eos&gt;</strong>ï¼ˆend of sequenceï¼‰ä¸ºæ­¢ã€‚å› æ­¤ï¼Œåœ¨è®­ç»ƒæ—¶ï¼Œæˆ‘ä»¬åªéœ€è¦æŠŠ <strong>&lt;sos&gt;</strong> æ·»åŠ åˆ° <code>ç›®æ ‡å¥</code> çš„å¼€å¤´ï¼Œç„¶åå°†å…¶ä½œä¸ºè¾“å…¥å‘é€ç»™è§£ç å™¨ï¼Œå…·ä½“å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p>
<p><img src="/2024/10/16/What-exactly-is-attention/encoder_decoder_demo1.png" alt="Transformer ä¸­çš„ç¼–ç å™¨å’Œè§£ç å™¨"></p>
<p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå¦‚æœè¦æŠŠ <code>I am a student</code> ç¿»è¯‘æˆ <code>æˆ‘æ˜¯ä¸€ä¸ªå­¦ç”Ÿ</code>ï¼Œæˆ‘ä»¬åªéœ€è¦æŠŠ <code>&lt;sos&gt;æˆ‘æ˜¯ä¸€ä¸ªå­¦ç”Ÿ</code> ä½œä¸ºè¾“å…¥å‘é€ç»™è§£ç å™¨ï¼Œè§£ç å™¨çš„ç›®æ ‡æ˜¯æ ¹æ® <code>I am a student</code> å’Œ <code>&lt;sos&gt;æˆ‘æ˜¯ä¸€ä¸ªå­¦ç”Ÿ</code> é¢„æµ‹è¾“å‡º <code>æˆ‘æ˜¯ä¸€ä¸ªå­¦ç”Ÿ&lt;eos&gt;</code>ã€‚</p>
<p>å¯¹äºè§£ç å™¨çš„è¾“å…¥åºåˆ—è€Œè¨€ï¼Œæˆ‘ä»¬ä¼šå…ˆå°†å…¶è½¬æ¢æˆåµŒå…¥çŸ©é˜µå¹¶å¢åŠ ä½ç½®ç¼–ç ä¿¡æ¯å¾—åˆ°è¾“å…¥çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">X</mi></mrow><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">X</span></span></span></span></span>ï¼Œç„¶åæˆ‘ä»¬å°† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">X</mi></mrow><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">X</span></span></span></span></span> è¾“å…¥åˆ°ç¼–ç å™¨ä¸­è¿›è¡Œåç»­çš„é¢„æµ‹ã€‚å‡è®¾çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">X</mi></mrow><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">X</span></span></span></span></span> ä¸ºï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">X</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1.1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1.2</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1.3</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">â‹¯</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1.4</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1.5</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1.6</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1.7</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">â‹¯</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1.8</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1.2</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1.1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1.3</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">â‹¯</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1.2</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1.4</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1.5</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1.6</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">â‹¯</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1.7</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1.6</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1.3</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1.4</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">â‹¯</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1.5</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{X} = \begin{bmatrix}
1.1 &amp; 1.2  &amp; 1.3  &amp; \cdots &amp; 1.4 \\
1.5 &amp; 1.6  &amp; 1.7  &amp; \cdots &amp; 1.8 \\
1.2 &amp; 1.1  &amp; 1.3  &amp; \cdots &amp; 1.2 \\
1.4 &amp; 1.5  &amp; 1.6  &amp; \cdots &amp; 1.7 \\
1.6 &amp; 1.3  &amp; 1.4  &amp; \cdots &amp; 1.5
\end{bmatrix}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">X</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:6.00503em;vertical-align:-2.75004em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.2549900000000003em;"><span style="top:-1.0499800000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.1999800000000005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-2.79598em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.39198em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.9879800000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-4.0139700000000005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-5.25499em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.75004em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.2500000000000004em;"><span style="top:-5.410000000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mord">.</span><span class="mord">1</span></span></span><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mord">.</span><span class="mord">5</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mord">.</span><span class="mord">2</span></span></span><span style="top:-1.8099999999999998em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mord">.</span><span class="mord">4</span></span></span><span style="top:-0.6099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mord">.</span><span class="mord">6</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.7500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.2500000000000004em;"><span style="top:-5.410000000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mord">.</span><span class="mord">2</span></span></span><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mord">.</span><span class="mord">6</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mord">.</span><span class="mord">1</span></span></span><span style="top:-1.8099999999999998em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mord">.</span><span class="mord">5</span></span></span><span style="top:-0.6099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mord">.</span><span class="mord">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.7500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.2500000000000004em;"><span style="top:-5.410000000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mord">.</span><span class="mord">3</span></span></span><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mord">.</span><span class="mord">7</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mord">.</span><span class="mord">3</span></span></span><span style="top:-1.8099999999999998em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mord">.</span><span class="mord">6</span></span></span><span style="top:-0.6099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mord">.</span><span class="mord">4</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.7500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.2500000000000004em;"><span style="top:-5.410000000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="minner">â‹¯</span></span></span><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="minner">â‹¯</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="minner">â‹¯</span></span></span><span style="top:-1.8099999999999998em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="minner">â‹¯</span></span></span><span style="top:-0.6099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="minner">â‹¯</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.7500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.2500000000000004em;"><span style="top:-5.410000000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mord">.</span><span class="mord">4</span></span></span><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mord">.</span><span class="mord">8</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mord">.</span><span class="mord">2</span></span></span><span style="top:-1.8099999999999998em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mord">.</span><span class="mord">7</span></span></span><span style="top:-0.6099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mord">.</span><span class="mord">5</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.7500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.2549900000000003em;"><span style="top:-1.0499800000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.1999800000000005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-2.79598em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.39198em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.9879800000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-4.0139700000000005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-5.25499em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.75004em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>è§£ç å™¨é¦–å…ˆä¼šè®¡ç®— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">X</mi></mrow><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">X</span></span></span></span></span> çš„è‡ªæ³¨æ„åŠ›çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">Z</mi></mrow><annotation encoding="application/x-tex">\mathbf{Z}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">Z</span></span></span></span></span>ï¼Œç„¶åè®¡ç®—å¥å­ä¸­æ‰€æœ‰è¯ä¹‹é—´çš„å…³è”å¹¶æå–æ¯ä¸ªè¯çš„ä¿¡æ¯ã€‚ä½†æ˜¯ä¸ç¼–ç å™¨ä¸åŒçš„æ˜¯ï¼Œåœ¨è§£ç å™¨çš„ <strong>è¿è¡Œæ—¶</strong>ï¼Œè§£ç å™¨åªæ˜¯å°†ä¸Šä¸€ä¸ªæ­¥éª¤ç”Ÿæˆçš„è¯ä½œä¸ºè¾“å…¥ï¼Œè€Œä¸æ˜¯å°†æ•´ä¸ªè¾“å…¥åºåˆ—ä½œä¸ºè¾“å…¥ã€‚å› æ­¤ï¼Œåœ¨ç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span> æ­¥æ—¶ï¼Œè§£ç å™¨çš„è¾“å…¥ä¸­åªæœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mo>&lt;</mo><mi>s</mi><mi>o</mi><mi>s</mi><mo>&gt;</mo><mo separator="true">,</mo><mtext>æˆ‘</mtext><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[&lt;sos&gt;, æˆ‘]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">æˆ‘</span><span class="mclose">]</span></span></span></span>ï¼Œæ‰€ä»¥æˆ‘ä»¬åªèƒ½å¾—åˆ°è¿™ä¸¤ä¸ªè¯ä¹‹é—´çš„å…³è”ï¼Œè€Œä¸èƒ½å¾—åˆ°ä¹‹åçš„ä»»ä½•è¯çš„ä¿¡æ¯ã€‚</p>
<p>å› æ­¤ï¼Œåœ¨è®­ç»ƒæœŸé—´ï¼Œè™½ç„¶æˆ‘ä»¬å¯ä»¥å°†æ•´ä¸ª <code>ç›®æ ‡å¥</code> ä½œä¸ºè¾“å…¥ï¼Œä½†æ˜¯æˆ‘ä»¬ä»ç„¶éœ€è¦ä»¥è§£ç å™¨åœ¨ <code>è¿è¡Œæ—¶</code> çš„è¿è¡Œæ–¹å¼æ¥è®­ç»ƒæ¨¡å‹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨è®­ç»ƒæœŸé—´ï¼Œæˆ‘ä»¬åªèƒ½è®¡ç®— <code>ç›®æ ‡å¥</code> åºåˆ—ä¸­æŸä¸ªè¯å’Œè¯¥è¯ä¹‹å‰çš„æ‰€æœ‰è¯ä¹‹é—´çš„æ³¨æ„åŠ›ã€‚ä¸ºæ­¤ï¼Œå¯ä»¥å¼•å…¥ <code>æ©ç </code> çš„æ¦‚å¿µä»¥å®ç°è¿™ä¸ªç›®çš„ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬æƒ³è¦é¢„æµ‹ <code>&lt;sos&gt;æˆ‘</code> ä¹‹åçš„è¯ <code>æ˜¯</code>ï¼Œæ­¤æ—¶ï¼Œæ¨¡å‹åº”è¯¥åªçœ‹åˆ° <code>&lt;sos&gt;æˆ‘</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç”¨æ©ç æ¥é˜»æ­¢æ¨¡å‹çœ‹åˆ° <code>æˆ‘</code> ä¹‹åçš„è¯ã€‚</p>
<p><img src="/2024/10/16/What-exactly-is-attention/mask_demo.png" alt="æ©ç çš„ä¾‹å­"></p>
<p>æ ¹æ®æ³¨æ„åŠ›çŸ©é˜µçš„è®¡ç®—æ–¹å¼ï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Attention</mtext><mo stretchy="false">(</mo><mi mathvariant="bold">Q</mi><mo separator="true">,</mo><mi mathvariant="bold">K</mi><mo separator="true">,</mo><mi mathvariant="bold">V</mi><mo stretchy="false">)</mo><mo>=</mo><mtext>softmax</mtext><mrow><mo fence="true">(</mo><mfrac><mrow><mi mathvariant="bold">Q</mi><msup><mi mathvariant="bold">K</mi><mi>T</mi></msup></mrow><msqrt><msub><mi>d</mi><mi>k</mi></msub></msqrt></mfrac><mo fence="true">)</mo></mrow><mi mathvariant="bold">V</mi></mrow><annotation encoding="application/x-tex">\text{Attention}(\mathbf{Q},\mathbf{K},\mathbf{V})=\text{softmax}\left(\frac{\mathbf{Q}\mathbf{K}^T}{\sqrt{d_k}}\right)\mathbf{V}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Attention</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">Q</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf">K</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.468361em;vertical-align:-0.95003em;"></span><span class="mord text"><span class="mord">softmax</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5183309999999999em;"><span style="top:-2.25278em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85722em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.81722em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.18278000000000005em;"><span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">Q</span></span><span class="mord"><span class="mord"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.93em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span></span></span></span></span></p>
<p>æˆ‘ä»¬åœ¨è®¡ç®— <code>softmax()</code> ä¹‹å‰ï¼Œå¯¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi mathvariant="bold">Q</mi><msup><mi mathvariant="bold">K</mi><mi>T</mi></msup></mrow><msqrt><msub><mi>d</mi><mi>k</mi></msub></msqrt></mfrac></mrow><annotation encoding="application/x-tex">\frac{\mathbf{Q}\mathbf{K}^T}{\sqrt{d_k}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.627473em;vertical-align:-0.538em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.089473em;"><span style="top:-2.5864385em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8622307142857143em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mtight" style="padding-left:0.833em;"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.8222307142857144em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.08em;"><svg width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.17776928571428574em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.446108em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">Q</span></span><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">K</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9190928571428572em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.538em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> çŸ©é˜µè¿›è¡Œå¦‚ä¸‹çš„æ“ä½œå³å¯ï¼šåœ¨é¢„æµ‹ç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span> ä¸ªè¯çš„æ³¨æ„åŠ›æ—¶ï¼Œç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>âˆ’</mo><mi mathvariant="normal">âˆ</mi></mrow><annotation encoding="application/x-tex">-\infty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">âˆ’</span><span class="mord">âˆ</span></span></span></span> æ›¿æ¢ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi mathvariant="bold">Q</mi><msup><mi mathvariant="bold">K</mi><mi>T</mi></msup></mrow><msqrt><msub><mi>d</mi><mi>k</mi></msub></msqrt></mfrac></mrow><annotation encoding="application/x-tex">\frac{\mathbf{Q}\mathbf{K}^T}{\sqrt{d_k}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.627473em;vertical-align:-0.538em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.089473em;"><span style="top:-2.5864385em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8622307142857143em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mtight" style="padding-left:0.833em;"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.8222307142857144em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.08em;"><svg width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.17776928571428574em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.446108em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">Q</span></span><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">K</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9190928571428572em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.538em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> ä¸­è¯¥è¯ä¹‹åçš„æ‰€æœ‰ç‚¹ç§¯ç»“æœã€‚</p>
<p><img src="/2024/10/16/What-exactly-is-attention/mask_demo_2.png" alt="å¸¦æ©ç çš„æƒé‡çŸ©é˜µ"></p>
<p>æ­¤æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨ <code>softmax()</code> å¯¹å¦‚ä¸Šçš„æ©ç çŸ©é˜µè¿›è¡Œè®¡ç®—ï¼Œå¹¶ä¹˜ä»¥å¯¹åº”çš„çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">V</mi></mrow><annotation encoding="application/x-tex">\mathbf{V}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span></span></span></span>ï¼Œå¾—åˆ°æœ€ç»ˆçš„æ³¨æ„åŠ›çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">Z</mi></mrow><annotation encoding="application/x-tex">\mathbf{Z}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">Z</span></span></span></span></span>ã€‚åŒæ ·çš„ï¼Œå¦‚æœæˆ‘ä»¬æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">h</span></span></span></span> ä¸ªæ³¨æ„åŠ›çŸ©é˜µï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æŒ‰å¦‚ä¸‹çš„æ–¹å¼å°†è¿™ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">h</span></span></span></span> ä¸ªæ³¨æ„åŠ›çŸ©é˜µçš„ç»“æœæ•´åˆèµ·æ¥å¾—åˆ°æœ€ç»ˆçš„æ³¨æ„åŠ›çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">M</mi></mrow><annotation encoding="application/x-tex">\mathbf{M}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">M</span></span></span></span></span>ï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">M</mi><mo>=</mo><mtext>Concatenate</mtext><mo stretchy="false">(</mo><msub><mi mathvariant="bold">Z</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator="true">,</mo><msub><mi mathvariant="bold">Z</mi><mi>h</mi></msub><mo stretchy="false">)</mo><msup><mi mathvariant="bold">W</mi><mi>O</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{M} = \text{Concatenate}(\mathbf{Z}_1,\cdots,\mathbf{Z}_h)\mathbf{W}^O
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">M</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1413309999999999em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Concatenate</span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">Z</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">Z</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">h</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">O</span></span></span></span></span></span></span></span></span></span></span></span></p>
<h3 id="å¤šå¤´æ³¨æ„åŠ›å±‚">å¤šå¤´æ³¨æ„åŠ›å±‚</h3>
<p>ä¸ºäº†æ ¹æ®è§£ç å™¨ä¸­è®¡ç®—çš„ <code>åŸå¥</code> çš„æ³¨æ„åŠ›çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">R</mi></mrow><annotation encoding="application/x-tex">\mathbf{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">R</span></span></span></span></span> å’Œè§£ç å™¨ä¸­è®¡ç®—çš„ <code>ç›®æ ‡å¥</code> çš„å¸¦æ©ç çš„æ³¨æ„åŠ›çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">M</mi></mrow><annotation encoding="application/x-tex">\mathbf{M}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">M</span></span></span></span></span> æ¥é¢„æµ‹æœ€ç»ˆçš„ <code>ç›®æ ‡å¥</code>ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ªå¤šå¤´æ³¨æ„åŠ›å±‚ã€‚ç”±äºè¯¥å±‚æ¶‰åŠåˆ°äº†ç¼–ç å™¨ä¸è§£ç å™¨çš„äº¤äº’ï¼Œå› æ­¤ï¼Œè¿™ä¸€å±‚ä¹Ÿç§°ä¹‹ä¸º <strong>ç¼–ç å™¨-è§£ç å™¨æ³¨æ„åŠ›å±‚</strong>ï¼ˆEncoder-Decoder Attentionï¼‰ã€‚</p>
<p>å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶çš„ç¬¬ä¸€æ­¥å°±æ˜¯è¦åˆ›å»ºæŸ¥è¯¢çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">Q</mi></mrow><annotation encoding="application/x-tex">\mathbf{Q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8805499999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathbf">Q</span></span></span></span></span>ã€é”®çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">K</mi></mrow><annotation encoding="application/x-tex">\mathbf{K}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">K</span></span></span></span></span> å’Œå€¼çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">V</mi></mrow><annotation encoding="application/x-tex">\mathbf{V}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span></span></span></span>ã€‚å¦‚å‰æ‰€è¿°ï¼Œå¯ä»¥é€šè¿‡è¾“å…¥çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">X</mi></mrow><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">X</span></span></span></span></span> ä¹˜ä»¥æƒé‡çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold">W</mi><mi>Q</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{W}^Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">Q</span></span></span></span></span></span></span></span></span></span></span>ã€é”®çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold">W</mi><mi>K</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{W}^K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07153em;">K</span></span></span></span></span></span></span></span></span></span></span> å’Œå€¼çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold">W</mi><mi>V</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{W}^V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">V</span></span></span></span></span></span></span></span></span></span></span> å¾—åˆ°æŸ¥è¯¢çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">Q</mi></mrow><annotation encoding="application/x-tex">\mathbf{Q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8805499999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathbf">Q</span></span></span></span></span>ã€é”®çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">K</mi></mrow><annotation encoding="application/x-tex">\mathbf{K}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">K</span></span></span></span></span> å’Œå€¼çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">V</mi></mrow><annotation encoding="application/x-tex">\mathbf{V}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span></span></span></span>ã€‚ä½†æ˜¯ç°åœ¨ï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªè¾“å…¥çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">R</mi></mrow><annotation encoding="application/x-tex">\mathbf{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">R</span></span></span></span></span>ï¼ˆç¼–ç å™¨è¾“å‡ºçš„ç‰¹å¾çŸ©é˜µï¼‰ å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">M</mi></mrow><annotation encoding="application/x-tex">\mathbf{M}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">M</span></span></span></span></span>ï¼ˆè§£ç å™¨ä¸­å¸¦æ©ç çš„å¤šå¤´æ³¨æ„åŠ›å±‚è¾“å‡ºçš„æ³¨æ„åŠ›çŸ©é˜µï¼‰ï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•ä½¿ç”¨è¿™ä¸¤ä¸ªè¾“å…¥çŸ©é˜µå‘¢ï¼Ÿæ€ä¹ˆåˆ©ç”¨è¿™ä¸¤ä¸ªè¾“å…¥çŸ©é˜µç”ŸæˆæŸ¥è¯¢çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">Q</mi></mrow><annotation encoding="application/x-tex">\mathbf{Q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8805499999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathbf">Q</span></span></span></span></span>ã€é”®çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">K</mi></mrow><annotation encoding="application/x-tex">\mathbf{K}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">K</span></span></span></span></span> å’Œå€¼çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">V</mi></mrow><annotation encoding="application/x-tex">\mathbf{V}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span></span></span></span> å‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬ä½¿ç”¨çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">M</mi></mrow><annotation encoding="application/x-tex">\mathbf{M}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">M</span></span></span></span></span> ç”ŸæˆæŸ¥è¯¢çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">Q</mi></mrow><annotation encoding="application/x-tex">\mathbf{Q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8805499999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathbf">Q</span></span></span></span></span>ï¼Œä»¥ä½¿å¾—æŸ¥è¯¢çŸ©é˜µå¯ä»¥åŒ…å« <code>ç›®æ ‡å¥</code> çš„ç‰¹å¾ï¼›ä½¿ç”¨çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">R</mi></mrow><annotation encoding="application/x-tex">\mathbf{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">R</span></span></span></span></span> ç”Ÿæˆé”®çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">K</mi></mrow><annotation encoding="application/x-tex">\mathbf{K}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">K</span></span></span></span></span> å’Œå€¼çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">V</mi></mrow><annotation encoding="application/x-tex">\mathbf{V}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span></span></span></span>ï¼Œä»¥ä½¿å¾—é”®çŸ©é˜µå’Œå€¼çŸ©é˜µå¯ä»¥åŒ…å« <code>åŸå¥</code> çš„ç‰¹å¾ã€‚ç„¶åå†åˆ©ç”¨è®¡ç®—æ±‚å¾—çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">Q</mi></mrow><annotation encoding="application/x-tex">\mathbf{Q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8805499999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathbf">Q</span></span></span></span></span>ã€<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">K</mi></mrow><annotation encoding="application/x-tex">\mathbf{K}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">K</span></span></span></span></span>ã€<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">V</mi></mrow><annotation encoding="application/x-tex">\mathbf{V}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span></span></span></span> è®¡ç®—æ³¨æ„åŠ›çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">Z</mi></mrow><annotation encoding="application/x-tex">\mathbf{Z}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">Z</span></span></span></span></span>ã€‚å…·ä½“çš„æ­¥éª¤å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<ol>
<li>
<p>ä½¿ç”¨çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">M</mi></mrow><annotation encoding="application/x-tex">\mathbf{M}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">M</span></span></span></span></span> ä¹˜ä»¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold">W</mi><mi>Q</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{W}^Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">Q</span></span></span></span></span></span></span></span></span></span></span> ç”ŸæˆæŸ¥è¯¢çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">Q</mi></mrow><annotation encoding="application/x-tex">\mathbf{Q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8805499999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathbf">Q</span></span></span></span></span>ï¼Œä½¿ç”¨çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">R</mi></mrow><annotation encoding="application/x-tex">\mathbf{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">R</span></span></span></span></span> ä¹˜ä»¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold">W</mi><mi>K</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{W}^K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07153em;">K</span></span></span></span></span></span></span></span></span></span></span> ç”Ÿæˆé”®çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">K</mi></mrow><annotation encoding="application/x-tex">\mathbf{K}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">K</span></span></span></span></span>ï¼Œä½¿ç”¨çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">R</mi></mrow><annotation encoding="application/x-tex">\mathbf{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">R</span></span></span></span></span> ä¹˜ä»¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold">W</mi><mi>V</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{W}^V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">V</span></span></span></span></span></span></span></span></span></span></span> ç”Ÿæˆå€¼çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">V</mi></mrow><annotation encoding="application/x-tex">\mathbf{V}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span></span></span></span>ã€‚</p>
<p><img src="/2024/10/16/What-exactly-is-attention/m_r_qkv.png" alt="æ ¹æ®çŸ©é˜µ M å’ŒçŸ©é˜µ R åˆ›å»ºçŸ©é˜µ Qã€Kã€V"></p>
</li>
<li>
<p>è®¡ç®—æŸ¥è¯¢çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">Q</mi></mrow><annotation encoding="application/x-tex">\mathbf{Q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8805499999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathbf">Q</span></span></span></span></span> å’Œé”®çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold">K</mi><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{K}^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span> çš„ç‚¹ç§¯ï¼Œå¾—åˆ° <code>ç›®æ ‡å¥</code> ä¸­æ¯ä¸ªè¯å’Œ <code>åŸå¥</code> ä¸­æ¯ä¸ªè¯çš„ç›¸ä¼¼åº¦ã€‚</p>
<p><img src="/2024/10/16/What-exactly-is-attention/m_r_q_mul_k.png" alt="æŸ¥è¯¢çŸ©é˜µå’Œé”®çŸ©é˜µçš„ç‚¹ç§¯"></p>
</li>
<li>
<p>æ ¹æ® <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi mathvariant="bold">Q</mi><msup><mi mathvariant="bold">K</mi><mi>T</mi></msup></mrow><msqrt><msub><mi>d</mi><mi>k</mi></msub></msqrt></mfrac></mrow><annotation encoding="application/x-tex">\frac{\mathbf{Q}\mathbf{K}^T}{\sqrt{d_k}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.627473em;vertical-align:-0.538em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.089473em;"><span style="top:-2.5864385em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8622307142857143em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mtight" style="padding-left:0.833em;"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.8222307142857144em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.08em;"><svg width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.17776928571428574em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.446108em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">Q</span></span><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">K</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9190928571428572em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.538em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> å¾—åˆ°æƒé‡çŸ©é˜µï¼Œä¸ºäº†æ¼”ç¤ºæ–¹ä¾¿ï¼Œæ­¤å¤„æˆ‘ä»¬ä»¤ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>k</mi></msub><mo>=</mo><mn>64</mn></mrow><annotation encoding="application/x-tex">d_k = 64</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">6</span><span class="mord">4</span></span></span></span>ã€‚</p>
</li>
<li>
<p>æ ¹æ® <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>softmax</mtext><mrow><mo fence="true">(</mo><mfrac><mrow><mi mathvariant="bold">Q</mi><msup><mi mathvariant="bold">K</mi><mi>T</mi></msup></mrow><msqrt><msub><mi>d</mi><mi>k</mi></msub></msqrt></mfrac><mo fence="true">)</mo></mrow><mi mathvariant="bold">V</mi></mrow><annotation encoding="application/x-tex">\text{softmax}\left(\frac{\mathbf{Q}\mathbf{K}^T}{\sqrt{d_k}}\right) \mathbf{V}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.80002em;vertical-align:-0.65002em;"></span><span class="mord text"><span class="mord">softmax</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.089473em;"><span style="top:-2.5864385em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8622307142857143em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mtight" style="padding-left:0.833em;"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.8222307142857144em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.08em;"><svg width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.17776928571428574em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.446108em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">Q</span></span><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">K</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9190928571428572em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.538em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span></span></span></span> è®¡ç®—æ³¨æ„åŠ›çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">Z</mi></mrow><annotation encoding="application/x-tex">\mathbf{Z}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">Z</span></span></span></span></span>ã€‚</p>
<p><img src="/2024/10/16/What-exactly-is-attention/m_r_attention.png" alt></p>
<p>å¦‚å›¾æ‰€ç¤ºï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">z</mi><mtext>æˆ‘</mtext></msub><mo>=</mo><mn>0.99</mn><mo>â‹…</mo><msub><mi mathvariant="bold">v</mi><mi>I</mi></msub><mo>+</mo><mn>0.01</mn><mo>â‹…</mo><msub><mi mathvariant="bold">v</mi><mrow><mi>a</mi><mi>m</mi></mrow></msub><mo>+</mo><mn>0.0</mn><mo>â‹…</mo><msub><mi mathvariant="bold">v</mi><mi>a</mi></msub><mo>+</mo><mn>0.0</mn><mo>â‹…</mo><msub><mi mathvariant="bold">v</mi><mrow><mi>s</mi><mi>t</mi><mi>u</mi><mi>d</mi><mi>e</mi><mi>n</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathbf{z}_{æˆ‘} = 0.99 \cdot \mathbf{v}_{I} + 0.01 \cdot \mathbf{v}_{am} + 0.0 \cdot \mathbf{v}_{a} + 0.0 \cdot \mathbf{v}_{student}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.59444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">z</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord cjk_fallback mtight">æˆ‘</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span><span class="mord">9</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">I</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.59444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>ç”±æ­¤ï¼Œå¦‚ä¸Šçš„ç»“æœå¯ä»¥è®©æ¨¡å‹ç†è§£ <code>ç›®æ ‡å¥</code> ä¸­çš„ <code>æˆ‘</code> æŒ‡ä»£çš„å…¶å®å°±æ˜¯ <code>åŸå¥</code> ä¸­çš„ <code>I</code>ã€‚</p>
</li>
</ol>
<p>åŒæ ·çš„ï¼Œåœ¨è¯¥å±‚ä¸­ï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥æœ‰ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">h</span></span></span></span> ä¸ªæ³¨æ„åŠ›çŸ©é˜µï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æŒ‰å¦‚ä¸‹çš„æ–¹å¼å°†è¿™ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">h</span></span></span></span> ä¸ªæ³¨æ„åŠ›çŸ©é˜µçš„ç»“æœæ•´åˆèµ·æ¥å¾—åˆ°æœ€ç»ˆçš„æ³¨æ„åŠ›çŸ©é˜µ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">D</mi><mi mathvariant="bold">e</mi><mi mathvariant="bold">c</mi><mi mathvariant="bold">o</mi><mi mathvariant="bold">d</mi><mi mathvariant="bold">e</mi><mi mathvariant="bold">r</mi><mi mathvariant="bold">M</mi><mi mathvariant="bold">u</mi><mi mathvariant="bold">l</mi><mi mathvariant="bold">t</mi><mi mathvariant="bold">i</mi><mo>âˆ’</mo><mi mathvariant="bold">h</mi><mi mathvariant="bold">e</mi><mi mathvariant="bold">a</mi><mi mathvariant="bold">d</mi><mi mathvariant="bold">A</mi><mi mathvariant="bold">t</mi><mi mathvariant="bold">t</mi><mi mathvariant="bold">e</mi><mi mathvariant="bold">n</mi><mi mathvariant="bold">t</mi><mi mathvariant="bold">i</mi><mi mathvariant="bold">o</mi><mi mathvariant="bold">n</mi></mrow><annotation encoding="application/x-tex">\mathbf{Decoder Multi-head Attention}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathbf">D</span><span class="mord mathbf">e</span><span class="mord mathbf">c</span><span class="mord mathbf">o</span><span class="mord mathbf">d</span><span class="mord mathbf">e</span><span class="mord mathbf">r</span><span class="mord mathbf">M</span><span class="mord mathbf">u</span><span class="mord mathbf">l</span><span class="mord mathbf">t</span><span class="mord mathbf">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathbf">h</span><span class="mord mathbf">e</span><span class="mord mathbf">a</span><span class="mord mathbf">d</span><span class="mord mathbf">A</span><span class="mord mathbf">t</span><span class="mord mathbf">t</span><span class="mord mathbf">e</span><span class="mord mathbf">n</span><span class="mord mathbf">t</span><span class="mord mathbf">i</span><span class="mord mathbf">o</span><span class="mord mathbf">n</span></span></span></span></span>ï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="bold">D</mi><mi mathvariant="bold">e</mi><mi mathvariant="bold">c</mi><mi mathvariant="bold">o</mi><mi mathvariant="bold">d</mi><mi mathvariant="bold">e</mi><mi mathvariant="bold">r</mi><mi mathvariant="bold">M</mi><mi mathvariant="bold">u</mi><mi mathvariant="bold">l</mi><mi mathvariant="bold">t</mi><mi mathvariant="bold">i</mi><mo>âˆ’</mo><mi mathvariant="bold">h</mi><mi mathvariant="bold">e</mi><mi mathvariant="bold">a</mi><mi mathvariant="bold">d</mi><mi mathvariant="bold">A</mi><mi mathvariant="bold">t</mi><mi mathvariant="bold">t</mi><mi mathvariant="bold">e</mi><mi mathvariant="bold">n</mi><mi mathvariant="bold">t</mi><mi mathvariant="bold">i</mi><mi mathvariant="bold">o</mi><mi mathvariant="bold">n</mi></mrow><mo>=</mo><mtext>Concatenate</mtext><mo stretchy="false">(</mo><msub><mi mathvariant="bold">Z</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator="true">,</mo><msub><mi mathvariant="bold">Z</mi><mi>h</mi></msub><mo stretchy="false">)</mo><msup><mi mathvariant="bold">W</mi><mi>O</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{Decoder Multi-head Attention} = \text{Concatenate}(\mathbf{Z}_1,\cdots,\mathbf{Z}_h)\mathbf{W}^O
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathbf">D</span><span class="mord mathbf">e</span><span class="mord mathbf">c</span><span class="mord mathbf">o</span><span class="mord mathbf">d</span><span class="mord mathbf">e</span><span class="mord mathbf">r</span><span class="mord mathbf">M</span><span class="mord mathbf">u</span><span class="mord mathbf">l</span><span class="mord mathbf">t</span><span class="mord mathbf">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathbf">h</span><span class="mord mathbf">e</span><span class="mord mathbf">a</span><span class="mord mathbf">d</span><span class="mord mathbf">A</span><span class="mord mathbf">t</span><span class="mord mathbf">t</span><span class="mord mathbf">e</span><span class="mord mathbf">n</span><span class="mord mathbf">t</span><span class="mord mathbf">i</span><span class="mord mathbf">o</span><span class="mord mathbf">n</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1413309999999999em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Concatenate</span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">Z</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">Z</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">h</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">O</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>åŒç¼–ç å™¨ä¸€æ ·ï¼Œåœ¨å¤šå¤´æ³¨æ„åŠ›å±‚ä¹‹åï¼Œæˆ‘ä»¬è¿˜ä¼šå¢åŠ å åŠ å’Œå½’ä¸€ç»„ä»¶ã€å‰é¦ˆç½‘ç»œå±‚å¹¶æœ€ç»ˆæ„æˆäº†å®Œæ•´çš„è§£ç å™¨ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å°† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span> ä¸ªè§£ç å™¨ä¸€ä¸ªä¸€ä¸ªçš„å åŠ èµ·æ¥ï¼Œæœ€åä¸€ä¸ªè§£ç å™¨çš„è¾“å‡ºå°±æ˜¯æœ€ç»ˆçš„ <code>ç›®æ ‡å¥</code> çš„ç‰¹å¾å€¼ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">T</mi></mrow><annotation encoding="application/x-tex">\mathbf{T}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">T</span></span></span></span></span>ã€‚</p>
<p><img src="/2024/10/16/What-exactly-is-attention/encoder_decoder.png" alt="Decoder æ¶æ„å›¾"></p>
<h3 id="çº¿æ€§å±‚å’Œ-softmax-å±‚">çº¿æ€§å±‚å’Œ softmax å±‚</h3>
<p>ä¸€æ—¦è§£ç å™¨å­¦ä¹ åˆ°äº† <code>ç›®æ ‡å¥</code> çš„ç‰¹å¾å€¼ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">T</mi></mrow><annotation encoding="application/x-tex">\mathbf{T}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">T</span></span></span></span></span>ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨çº¿æ€§å±‚å’Œ <code>softmax</code> å±‚æ¥ç”Ÿæˆæœ€ç»ˆçš„ <code>ç›®æ ‡å¥</code>ã€‚çº¿æ€§å±‚å°†ç”Ÿæˆä¸€ä¸ª <code>logit</code> å‘é‡ï¼Œå…¶å¤§å°ç­‰äº <code>ç›®æ ‡å¥</code> ä¸­çš„è¯æ±‡é‡ã€‚å‡è®¾ç›®æ ‡å¥çš„è¯æ±‡é‡åªæœ‰ 4 ä¸ªè¯ç»„æˆï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mi>o</mi><mi>c</mi><mi>a</mi><mi>b</mi><mi>u</mi><mi>l</mi><mi>a</mi><mi>r</mi><mi>y</mi><mo>=</mo><mo stretchy="false">{</mo><mtext>æ˜¯</mtext><mo separator="true">,</mo><mtext>æˆ‘</mtext><mo separator="true">,</mo><mtext>å­¦ç”Ÿ</mtext><mo separator="true">,</mo><mtext>ä¸€ä¸ª</mtext><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">Vocabulary = \{ \text{æ˜¯}, \text{æˆ‘}, \text{å­¦ç”Ÿ}, \text{ä¸€ä¸ª} \}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mord mathdefault">o</span><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span><span class="mord mathdefault">b</span><span class="mord mathdefault">u</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord text"><span class="mord cjk_fallback">æ˜¯</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord text"><span class="mord cjk_fallback">æˆ‘</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord text"><span class="mord cjk_fallback">å­¦ç”Ÿ</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord text"><span class="mord cjk_fallback">ä¸€ä¸ª</span></span><span class="mclose">}</span></span></span></span></span></p>
<p>é‚£ä¹ˆï¼Œçº¿æ€§å±‚è¿”å›çš„ <code>logit</code> çš„å‘é‡çš„ç»´åº¦å°†æ˜¯ 4ã€‚ç„¶åä½¿ç”¨ <code>softmax()</code> å°† <code>logit</code> å‘é‡è½¬æ¢æˆæ¦‚ç‡è¡¨ç¤ºï¼Œæœ€åè¾“å‡ºå…·æœ‰æœ€é«˜æ¦‚ç‡å€¼çš„è¯çš„ç´¢å¼•å€¼ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå¦‚æœè§£ç å™¨çš„è¾“å…¥æ˜¯ <code>&lt;sos&gt;æˆ‘</code>ï¼Œåˆ™è§£ç å™¨éœ€è¦æ ¹æ®å½“å‰çš„è¾“å…¥é¢„æµ‹ä¸‹ä¸€ä¸ªè¯ã€‚æˆ‘ä»¬æŠŠæœ€é¡¶å±‚çš„è§£ç å™¨çš„è¾“å‡ºç‰¹å¾å€¼ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">T</mi></mrow><annotation encoding="application/x-tex">\mathbf{T}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">T</span></span></span></span></span> è¾“å…¥åˆ°çº¿æ€§å±‚ï¼Œå‡è®¾æˆ‘ä»¬å¾—åˆ°çš„ <code>logit</code> å‘é‡å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>logit</mtext><mo>=</mo><mo stretchy="false">[</mo><mn>39</mn><mo separator="true">,</mo><mn>20</mn><mo separator="true">,</mo><mn>31</mn><mo separator="true">,</mo><mn>35</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\text{logit} = [39, 20, 31, 35]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord text"><span class="mord">logit</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">3</span><span class="mord">9</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">3</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">3</span><span class="mord">5</span><span class="mclose">]</span></span></span></span></span></p>
<p>ç„¶åï¼Œæˆ‘ä»¬å¯¹å¦‚ä¸Šçš„ <code>logit</code> å‘é‡åº”ç”¨ <code>softmax()</code> è®¡ç®—ï¼Œå¹¶å¾—åˆ°å¦‚ä¸‹çš„æ¦‚ç‡å‘é‡ï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>probability</mtext><mo>=</mo><mo stretchy="false">[</mo><mn>0.98</mn><mo separator="true">,</mo><mn>0.00</mn><mo separator="true">,</mo><mn>0.00</mn><mo separator="true">,</mo><mn>0.12</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\text{probability} = [0.98, 0.00, 0.00, 0.12]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord text"><span class="mord">probability</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span><span class="mord">8</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span><span class="mord">2</span><span class="mclose">]</span></span></span></span></span></p>
<p>ä»ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œç´¢å¼•å€¼ä¸º 0 çš„è¯ <code>æ˜¯</code> å…·æœ‰æœ€é«˜çš„æ¦‚ç‡å€¼ï¼Œå› æ­¤ï¼Œè§£ç å™¨ä¼šè¾“å‡ºç´¢å¼•å€¼ä¸º 0 çš„è¯ <code>æ˜¯</code> ä½œä¸ºä¸‹ä¸€ä¸ªè¯ã€‚é€šè¿‡è¯¥æ–¹å¼ï¼Œè§£ç å™¨å¯ä»¥ä¸æ–­çš„é¢„æµ‹ <code>ç›®æ ‡å¥</code> ä¸­çš„ä¸‹ä¸€ä¸ªè¯ï¼Œç›´åˆ°è¾“å‡º <code>&lt;eos&gt;</code> ä¸ºæ­¢ã€‚</p>
<h2 id="transformer-æ•´ä½“æ¶æ„">Transformer æ•´ä½“æ¶æ„</h2>
<p>æ ¹æ®å¦‚ä¸Šçš„ä»‹ç»ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ° Transformer æ¨¡å‹çš„æ•´ä½“æ¶æ„å›¾ï¼š</p>
<p><img src="/2024/10/16/What-exactly-is-attention/transformer.png" alt="Transformer çš„æ¶æ„å›¾"></p>
<p>åœ¨ä¸Šå›¾ä¸­ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>Ã—</mo></mrow><annotation encoding="application/x-tex">N \times</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord">Ã—</span></span></span></span> è¡¨ç¤ºå¯ä»¥å †å  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span> ä¸ªç¼–ç å™¨å’Œè§£ç å™¨ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo>Ã—</mo></mrow><annotation encoding="application/x-tex">h \times</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">h</span><span class="mord">Ã—</span></span></span></span> è¡¨ç¤ºå¯ä»¥å †å  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">h</span></span></span></span> ä¸ªæ³¨æ„åŠ›çŸ©é˜µã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œä¸€æ—¦è¾“å…¥ <code>åŸå¥</code>ï¼Œç¼–ç å™¨å°±ä¼šå­¦ä¹  <code>åŸå¥</code> çš„ç‰¹å¾å¹¶å°†ç‰¹å¾å‘é€ç»™è§£ç å™¨ï¼Œè€Œè§£ç å™¨åˆ™ä¼šä¸æ–­çš„é¢„æµ‹å¹¶ç”Ÿæˆ <code>ç›®æ ‡å¥</code>ã€‚</p>
<p>åœ¨å†…å®¹ç”Ÿæˆçš„åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬æä¾›ç»™æ¨¡å‹çš„ <code>prompt</code> å°±ç›¸å½“äº <code>åŸå¥</code>ï¼Œè€Œ <code>ç›®æ ‡å¥</code> åˆ™ç›¸å½“äºç”Ÿæˆçš„å†…å®¹ã€‚ä» Transformer çš„æ•´ä½“æ¶æ„å›¾ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæ¨¡å‹ä¼šä¸æ–­çš„æ ¹æ® <code>prompt</code> å’Œ <code>ç›®æ ‡å¥</code> çš„ç‰¹å¾æ¥ç”Ÿæˆæœ€ç»ˆçš„ <code>ç›®æ ‡å¥</code>ï¼Œè€Œä¸ä¼šç”Ÿæˆä¸ <code>prompt</code> æ— å…³çš„å†…å®¹ï¼Œè¿™ä¹Ÿå°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„ <strong>ä¸Šä¸‹æ–‡å­¦ä¹ </strong>ï¼ˆICL: in context learningï¼‰ å’Œ <strong>æŒ‡ä»¤éµå¾ª</strong>ï¼ˆinstruction followingï¼‰ã€‚</p>
<h2 id="å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</h2>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p><a href="https://arxiv.org/html/1706.03762v7">Attention Is All You Need</a> <a href="#fnref1" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn2" class="footnote-item"><p><a href="https://jalammar.github.io/illustrated-transformer/">The Illustrated Transformer</a> <a href="#fnref2" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn3" class="footnote-item"><p><a href="https://eli.thegreenplace.net/2016/the-softmax-function-and-its-derivative/">The Softmax function and its derivative</a> <a href="#fnref3" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn4" class="footnote-item"><p><a href="https://medium.com/@ngiengkianyew/multi-headed-attention-8b940b76c351">Intuition for Multi-headed Attention</a> <a href="#fnref4" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn5" class="footnote-item"><p><a href="https://www.3blue1brown.com/lessons/attention">Visualizing Attention, a Transformerâ€™s Heart</a> <a href="#fnref5" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn6" class="footnote-item"><p><a href="https://www.bilibili.com/video/BV1TZ421j7Ke?spm_id_from=333.788.recommend_more_video.-1&amp;vd_source=fbeb46d16d08ad900fac814e55c3f27f">Visualizing Attention, a Transformerâ€™s Heartï¼ˆBç«™ç‰ˆï¼‰</a> <a href="#fnref6" class="footnote-backref">â†©ï¸</a></p>
</li>
</ol>
</section>
]]></content>
      <categories>
        <category>LLM</category>
      </categories>
      <tags>
        <tag>Transformer</tag>
        <tag>Attention</tag>
        <tag>è‡ªæ³¨æ„åŠ›æœºåˆ¶</tag>
      </tags>
  </entry>
  <entry>
    <title>æ¨æ–­ç»Ÿè®¡æ–¹æ³•åœ¨è¯„ä¼°åˆ†æä¸­çš„åº”ç”¨</title>
    <url>/2024/10/06/The-Statistical-Approach-for-the-Product-Evaluation/</url>
    <content><![CDATA[<p><img src="/2024/10/06/The-Statistical-Approach-for-the-Product-Evaluation/Inferential-Statistics.png" alt></p>
<p>åœ¨ <a href="/2024/08/17/The-Basic-Model-for-the-Product-Evaluation/">äº§å“è¯„æµ‹çš„åŸºæœ¬æ¨¡å‹</a> è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘æåˆ°äº†å¯¹ <strong>è¯„æµ‹çš„ç–‘æƒ‘</strong>ï¼š</p>
<blockquote>
<p>æ›¾ç»å¤šå°‘æ¬¡ï¼Œåœ¨ç³»ç»Ÿä¸Šçº¿ä¹‹å‰ï¼Œæˆ‘ä»¬ä»å¤šä¸ªæ–¹é¢è¿›è¡Œäº†è¯„æµ‹ï¼šæ€§èƒ½ä¹Ÿæå‡äº†ï¼Œæ•ˆæœä¹Ÿæå‡äº†ï¼Œæˆ‘ä»¬å…´é«˜é‡‡çƒˆçš„ä¸Šçº¿ï¼Œç„¶åæ¿€åŠ¨çš„ç­‰å¾…ç€å®éªŒæ•°æ®çš„äº§å‡ºï¼Œæœ€åå¾—åˆ°çš„å´æ˜¯æ•ˆæœä¸æ˜æ˜¾çš„ç»“è®ºã€‚å¤šå°‘ä¸ªä¸çœ çš„å¤œé‡Œï¼Œæˆ‘æ€»ä¼šé—®è‡ªå·±ï¼šæŠ€æœ¯ä¸Šå·²ç»æœ‰äº†å¾ˆå¤§çš„æå‡å•¦ï¼Œä¸ºä»€ä¹ˆå´æ²¡æœ‰åœ¨çº¿ä¸Šè¡¨ç°å‡ºå¯¹åº”çš„æ•ˆæœå‘¢ï¼Ÿè¿™ç©¶ç«Ÿæ˜¯ä¸ºä»€ä¹ˆå‘€ï¼Ÿ</p>
</blockquote>
<p>åŒæ—¶ï¼Œæ ¹æ®æˆ‘çš„è§‚å¯Ÿå’Œå®è·µï¼Œæå‡ºäº†è¯„æµ‹çš„åŸºæœ¬æ¨¡å‹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Perception</mtext><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mtext>Actual</mtext><mo separator="true">,</mo><mtext>Â Expected</mtext><mo separator="true">,</mo><mtext>Â UX</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{Perception} = f(\text{Actual}, \ \text{Expected}, \ \text{UX})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord text"><span class="mord">Perception</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord text"><span class="mord">Actual</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace">Â </span><span class="mord text"><span class="mord">Expected</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace">Â </span><span class="mord text"><span class="mord">UX</span></span><span class="mclose">)</span></span></span></span> æ¥è§£é‡Šäº†è¯„æµ‹çš„ç–‘æƒ‘ã€‚ä½†æ˜¯ï¼Œä»…ä»…ä¾é è¿™ä¸ªæ¨¡å‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾—å‡ºåˆç†çš„ç»“è®ºå—ï¼Ÿå¦‚ä¸Šçš„æ¨¡å‹ï¼Œåªèƒ½å¸®åŠ©æˆ‘ä»¬è·å¾—å‡†ç¡®çš„è§‚å¯Ÿæ•°æ®ï¼Œä½†æ˜¯å¦‚ä½•ä»å‡†ç¡®çš„è§‚å¯Ÿæ•°æ®ä¸­å¾—å‡ºåˆç†çš„ç»“è®ºå‘¢ï¼Ÿ</p>
<span id="more"></span>
<h2 id="ä¸¾ä¸ªä¾‹å­ğŸŒ°">ä¸¾ä¸ªä¾‹å­ğŸŒ°</h2>
<p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªè§†é¢‘ç¼–è§£ç çš„ä¾‹å­ï¼šæœ‰ 100 ä¸ªæºè§†é¢‘ï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mn>1</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>S</mi><mn>100</mn></msub></mrow><annotation encoding="application/x-tex">S_1,...,S_{100}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼‰ï¼Œæ¯ä¸ªè§†é¢‘éƒ½ä¼šé€šè¿‡ Aã€B ä¸¤ç»„ç¼–ç å‚æ•°è¿›è¡Œè½¬ç å¹¶å¾—åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mn>1</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><msub><mi>A</mi><mn>100</mn></msub></mrow><annotation encoding="application/x-tex">A_1,...A_{100}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mn>1</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><msub><mi>B</mi><mn>100</mn></msub></mrow><annotation encoding="application/x-tex">B_1,...B_{100}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä¸¤ç»„ç¼–ç åçš„è§†é¢‘ã€‚æˆ‘ä»¬å¯¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">A_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">B_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> è¿›è¡Œæˆå¯¹è¯„ä¼°ï¼Œå¾—åˆ°äº†å¦‚ä¸‹çš„ç»“æœï¼š</p>
<table>
<thead>
<tr>
<th>A å¥½äº B çš„è§†é¢‘æ•°é‡</th>
<th>A å·®äº B çš„è§†é¢‘æ•°é‡</th>
<th>å·®ä¸å¤šçš„è§†é¢‘æ•°é‡</th>
</tr>
</thead>
<tbody>
<tr>
<td><center>42</center></td>
<td><center>37</center></td>
<td><center>21</center></td>
</tr>
</tbody>
</table>
<p>é‚£ä¹ˆï¼ŒA ç¼–ç å‚æ•°å’Œ B ç¼–ç å‚æ•°ç©¶ç«Ÿå“ªä¸ªå¥½å‘¢ï¼Ÿè¿˜æ˜¯æ²¡æœ‰å·®åˆ«å‘¢ï¼Ÿ</p>
<p>å› ä¸º A ç¼–ç å‚æ•°æ›´å¥½çš„è§†é¢‘å æ¯”æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>42</mn><mi mathvariant="normal">/</mi><mn>100</mn><mo>=</mo><mn>42</mn><mi mathvariant="normal">%</mi></mrow><annotation encoding="application/x-tex">42/100 = 42\%</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">4</span><span class="mord">2</span><span class="mord">/</span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.80556em;vertical-align:-0.05556em;"></span><span class="mord">4</span><span class="mord">2</span><span class="mord">%</span></span></span></span>, B ç¼–ç å‚æ•°æ›´å¥½çš„è§†é¢‘å æ¯”æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>37</mn><mi mathvariant="normal">/</mi><mn>100</mn><mo>=</mo><mn>37</mn><mi mathvariant="normal">%</mi></mrow><annotation encoding="application/x-tex">37/100 = 37\%</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">3</span><span class="mord">7</span><span class="mord">/</span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.80556em;vertical-align:-0.05556em;"></span><span class="mord">3</span><span class="mord">7</span><span class="mord">%</span></span></span></span>ï¼Œæ‰€ä»¥ A ç¼–ç å‚æ•°çš„æ•ˆæœæ›´å¥½ã€‚æˆ‘ä»¬åœ¨ä»¥å¾€çš„è§†é¢‘è´¨é‡è¯„ä¼°ä¸­ï¼Œé‡‡ç”¨çš„å¤§å¤šéƒ½æ˜¯è¿™æ ·çš„æ–¹å¼æ¥åˆ†æè¯„ä¼°ç»“æœï¼Œä½†æ˜¯è¿™ä¸ªç»“è®ºæ˜¯æ­£ç¡®çš„å—ï¼Ÿ</p>
<p>åœ¨å¦‚ä¸Šçš„ç»“æœä¸­ï¼ŒA å’Œ B ä¹‹é—´æœ‰å·®å¼‚çš„æ•°æ®æ€»å…±æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>42</mn><mo>+</mo><mn>37</mn><mo>=</mo><mn>79</mn></mrow><annotation encoding="application/x-tex">42 + 37 = 79</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">4</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span><span class="mord">7</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">7</span><span class="mord">9</span></span></span></span> æ¡ã€‚è€Œåœ¨åœ¨ 79 æ¡æ•°æ®ä¸­ï¼ŒA è¦ä¹ˆæ¯” B å·®ï¼Œè¦ä¹ˆæ¯” B å¥½ï¼Œä»¤ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">X_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><mn>79</mn></mrow><annotation encoding="application/x-tex">i=1,...,79</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">7</span><span class="mord">9</span></span></span></span>ï¼‰è¡¨ç¤ºè¯„ä¼°çš„ç»“æœï¼Œé‚£ä¹ˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">X_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> æ˜¯ä¸€ä¸ªäºŒé¡¹åˆ†å¸ƒã€‚æˆ‘ä»¬å…ˆåˆ¤æ–­åœ¨ 5% çš„æ˜¾è‘—æ€§æ°´å¹³ä¸‹ï¼ŒA ä¸ B æ˜¯å¦æ²¡æœ‰æ˜¾è‘—å·®å¼‚ï¼Œå³ï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><mi>p</mi><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mspace width="1em"><mi>v</mi><mi>s</mi><mspace width="1em"><msub><mi>H</mi><mn>1</mn></msub><mo>:</mo><mi>p</mi><mo mathvariant="normal">â‰ </mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mspace></mspace></mrow><annotation encoding="application/x-tex">H_0: p = \frac{1}{2} \quad vs \quad H_1: p \neq \frac{1}{2}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel">î€ </span></span><span class="fix"></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„ <code>R</code> ä»£ç è¿›è¡Œæ£€éªŒï¼š</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">&gt; binom.test(<span class="number">42</span>, <span class="number">79</span>)</span><br><span class="line"></span><br><span class="line">	Exact binomial test</span><br><span class="line"></span><br><span class="line">data:  <span class="number">42</span> and <span class="number">79</span></span><br><span class="line">number of successes = <span class="number">42</span>, number of trials = <span class="number">79</span>, p-value = <span class="number">0.653</span></span><br><span class="line">alternative hypothesis: true probability of success is not equal to <span class="number">0.5</span></span><br><span class="line">95 percent confidence interval:</span><br><span class="line"> <span class="number">0.4159522</span> <span class="number">0.6448955</span></span><br><span class="line">sample estimates:</span><br><span class="line">probability of success </span><br><span class="line">             <span class="number">0.5316456</span> </span><br></pre></td></tr></table></figure>
<p>ä»ç»“æœå¯ä»¥çœ‹å‡ºï¼Œæ ¹æ®è¯„æµ‹æ•°æ®ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>âˆ’</mo><mtext>value</mtext><mo>=</mo><mn>0.653</mn></mrow><annotation encoding="application/x-tex">p-\text{value} = 0.653</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord text"><span class="mord">value</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">6</span><span class="mord">5</span><span class="mord">3</span></span></span></span>ï¼Œå› æ­¤åœ¨ 5% çš„æ˜¾è‘—æ€§æ°´å¹³ä¸‹ï¼Œæˆ‘ä»¬ä¸èƒ½æ‹’ç» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">p=\frac{1}{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>ï¼Œå³ A å’Œ B ä¹‹é—´æ²¡æœ‰å·®å¼‚çš„å‡è®¾ã€‚</p>
<p>åŒæ ·çš„ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>R</code> å¾—åˆ°å¦‚ä¸‹çš„å‡è®¾çš„æ£€éªŒç»“æœï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><mi>p</mi><mo>â‰¤</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mspace width="1em"><mi>v</mi><mi>s</mi><mspace width="1em"><msub><mi>H</mi><mn>1</mn></msub><mo>:</mo><mi>p</mi><mo>â‰¥</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mspace></mspace></mrow><annotation encoding="application/x-tex">H_0: p \le \frac{1}{2} \quad vs \quad H_1: p \ge \frac{1}{2}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8304100000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8304100000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">&gt; binom.test(<span class="number">42</span>, <span class="number">79</span>, alternative=<span class="string">&quot;greater&quot;</span>)</span><br><span class="line"></span><br><span class="line">	Exact binomial test</span><br><span class="line"></span><br><span class="line">data:  <span class="number">42</span> and <span class="number">79</span></span><br><span class="line">number of successes = <span class="number">42</span>, number of trials = <span class="number">79</span>, p-value = <span class="number">0.3265</span></span><br><span class="line">alternative hypothesis: true probability of success is greater than <span class="number">0.5</span></span><br><span class="line">95 percent confidence interval:</span><br><span class="line"> <span class="number">0.4333002</span> <span class="number">1.0000000</span></span><br><span class="line">sample estimates:</span><br><span class="line">probability of success </span><br><span class="line">             <span class="number">0.5316456</span></span><br></pre></td></tr></table></figure>
<p>ä»ç»“æœå¯ä»¥çœ‹å‡ºï¼Œæ ¹æ®è¯„æµ‹æ•°æ®ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>âˆ’</mo><mtext>value</mtext><mo>=</mo><mn>0.3265</mn></mrow><annotation encoding="application/x-tex">p-\text{value} = 0.3265</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord text"><span class="mord">value</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">3</span><span class="mord">2</span><span class="mord">6</span><span class="mord">5</span></span></span></span>ï¼Œå› æ­¤æˆ‘ä»¬æ— æ³•æ‹’ç» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>â‰¤</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">p \le \frac{1}{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8304100000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> å¾—åˆ° A æ›´å¥½çš„ç»“è®ºã€‚</p>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition note"><p class="admonition-title">â“
</p><p>åŒæ ·çš„ä¸€ä»½æ•°æ®åœ¨é‡‡ç”¨ä¸åŒçš„åˆ†ææ–¹æ³•æ—¶å¾—å‡ºäº†ä¸åŒçš„ç»“è®ºï¼Œå“ªä¸ªæ‰æ˜¯æ­£ç¡®çš„å‘¢ï¼Ÿ</p>
<p>è™½ç„¶åœ¨å¦‚ä¸Šçš„ä¾‹å­ä¸­ï¼Œæœ‰å¾ˆå¤šä¾‹å¦‚ï¼šæ˜¾è‘—æ€§æ°´å¹³ï¼Œ<em>p-value</em> ç­‰æœ¯è¯­ï¼Œä½†æ˜¯ä¸ç”¨æ‹…å¿ƒï¼Œåœ¨æ–‡ç« çš„åé¢ï¼Œæˆ‘ä»¬ä¼šè¯¦ç»†ä»‹ç»è¿™äº›æœ¯è¯­çš„å«ä¹‰ã€‚</p>
</div>
<h2 id="ä»€ä¹ˆæ˜¯æ¨æ–­ç»Ÿè®¡ï¼Ÿ">ä»€ä¹ˆæ˜¯æ¨æ–­ç»Ÿè®¡ï¼Ÿ</h2>
<p>ç»Ÿè®¡å­¦ï¼ˆ<em>Statistics</em>ï¼‰æ˜¯ä¸€é—¨ä»æ•°æ®ä¸­å­¦ä¹ çš„è‰ºæœ¯ï¼Œå®ƒåŒ…æ‹¬æ•°æ®çš„æ”¶é›†ï¼Œä¹ŸåŒ…æ‹¬é€šè¿‡åç»­çš„æ•°æ®æè¿°å’Œæ•°æ®åˆ†ææ¥è·å¾—ç»“è®ºã€‚å¯¹æ•°æ®çš„åˆ†ææœ‰ä¸¤ç§ä¸åŒçš„æ–¹å¼ï¼šæè¿°ç»Ÿè®¡å’Œæ¨æ–­ç»Ÿè®¡ï¼Œæè¿°ç»Ÿè®¡æ˜¯ç»Ÿè®¡å­¦çš„åŸºç¡€ï¼Œå…¶ä¸»è¦å¤„ç†æ ·æœ¬æ•°æ®ï¼›è€Œæ¨æ–­ç»Ÿè®¡åˆ™æ˜¯æè¿°ç»Ÿè®¡çš„å‡åï¼Œå…¶åˆ©ç”¨æ ·æœ¬æ•°æ®æ¥æ¨æµ‹æ€»ä½“ç‰¹å¾ã€‚</p>
<ul>
<li>
<p>æè¿°ç»Ÿè®¡ä¸»è¦å…³æ³¨äºæ•°æ®çš„æ”¶é›†ã€å¤„ç†ã€æ±‡æ€»ã€å›¾è¡¨æè¿°ã€æ¦‚æ‹¬ä¸åˆ†æï¼ŒåŒ…æ‹¬ç»Ÿè®¡æ•°æ®çš„æ”¶é›†æ–¹æ³•ã€æ•°æ®çš„åŠ å·¥å¤„ç†æ–¹æ³•ã€æ•°æ®çš„æ˜¾ç¤ºæ–¹æ³•ã€æ•°æ®çš„åˆ†å¸ƒç‰¹å¾ä¸åˆ†ææ–¹æ³•ç­‰ã€‚æè¿°ç»Ÿè®¡çš„ç›®çš„æ˜¯å°†æ•°æ®è½¬åŒ–ä¸ºæœ‰æ„ä¹‰çš„ä¿¡æ¯ï¼Œå¹¶å¸®åŠ©æˆ‘ä»¬ç†è§£æ•°æ®çš„ç‰¹å¾å’Œè§„å¾‹ã€‚å¸¸è§çš„æè¿°ç»Ÿè®¡åŒ…æ‹¬ç›´æ–¹å›¾ã€å¹³å‡æ•°ã€ä¸­ä½æ•°ã€ä¼—æ•°ç­‰ã€‚</p>
</li>
<li>
<p>æ¨æ–­ç»Ÿè®¡ä¸»è¦å…³æ³¨å¦‚ä½•åˆ©ç”¨æ ·æœ¬æ•°æ®æ¥æ¨æ–­æ€»ä½“ç‰¹å¾ï¼ŒåŒ…æ‹¬å‚æ•°ä¼°è®¡ï¼ˆä¾‹å¦‚å¹³å‡æ•°ã€æ ‡å‡†å·®çš„ä¼°è®¡ï¼‰å’Œå‡è®¾æ£€éªŒä¸¤ç§ç±»å‹ã€‚æ¨æ–­ç»Ÿè®¡å…è®¸æˆ‘ä»¬æ ¹æ®éƒ¨åˆ†æ•°æ®æ¥æ¨æ–­æ€»ä½“ç‰¹å¾ï¼Œä»è€Œæé«˜ç ”ç©¶çš„æ•ˆç‡å’Œå‡†ç¡®æ€§ã€‚å¸¸ç”¨çš„æ¨æ–­ç»Ÿè®¡åŒ…æ‹¬ç½®ä¿¡åŒºé—´ã€t æ£€éªŒã€æ–¹å·®åˆ†æç­‰ã€‚</p>
</li>
</ul>
<p>æ¨æ–­ç»Ÿè®¡æ˜¯æ•°æ®åˆ†æçš„å¼ºå¤§åŠ›é‡ï¼Œå…è®¸æˆ‘ä»¬èƒ½å¤Ÿæ ¹æ®æ ·æœ¬æ¥æ¨æ–­æ€»ä½“çš„ç‰¹å¾ï¼Œå¹¶å¯¹æ€»ä½“è¿›è¡Œé¢„æµ‹ã€‚</p>
<p>æ­£å¦‚æ•°æ®å¯è§†åŒ–é¢†åŸŸçš„å…ˆé©± William Cleveland æ‰€è¯´<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup>ï¼š</p>
<blockquote>
<p>ç°ä»£æ•°æ®åˆ†æçš„ç›®æ ‡æ˜¯é¢„æµ‹å’Œæ¨æ–­ï¼Œè€Œä¸ä»…ä»…æ˜¯æè¿°ï¼ˆThe goal of modern data analysis is prediction and inference, not just descriptionï¼‰ã€‚</p>
</blockquote>
<p>ç»Ÿè®¡å­¦é¢†åŸŸçš„æ³°æ–— John Tukey ç»™å‡ºäº†æ¨æ–­çš„å®šä¹‰ï¼Œè¿™æ„å‘³ç€æ¨æ–­ç»Ÿè®¡çš„æœ¬è´¨åœ¨äºä»æ•´ä½“çš„ä¸€å°éƒ¨åˆ†å‘Šè¯‰æˆ‘ä»¬æ•´ä½“çš„æƒ…å†µ<sup class="footnote-ref"><a href="#fn1" id="fnref1:1">[1:1]</a></sup>ï¼š</p>
<blockquote>
<p>æ¨æ–­ä¸æ˜¯æ¼”ç»ï¼Œè€Œæ˜¯å½’çº³ï¼ˆInference is not deduction; itâ€™s induction.ï¼‰ã€‚</p>
</blockquote>
<h2 id="åœ¨è¯„ä¼°ä¸­åº”ç”¨æ¨æ–­ç»Ÿè®¡">åœ¨è¯„ä¼°ä¸­åº”ç”¨æ¨æ–­ç»Ÿè®¡</h2>
<p>å¦‚ä»Šï¼Œéšç€å¤§æ¨¡å‹çš„å…´èµ·ï¼Œå¤§æ¨¡å‹è¯„ä¼°ä¹Ÿè¶Šæ¥è¶Šé‡è¦ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šçœ‹åˆ°å„ç§æ¦œå•å…¬å¸ƒçš„ä¸åŒå¤§æ¨¡å‹çš„èƒ½åŠ›æ’è¡Œï¼Œä¾‹å¦‚ <a href="https://huggingface.co/spaces/lmsys/chatbot-arena-leaderboard?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE3Mjg1MzMxNzAsImZpbGVHVUlEIjoiV2xBcmRndkdsNVNud3ZxMiIsImlhdCI6MTcyODUzMjg3MCwiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjotODkyNzg3NTY0Nn0.pvYtAUT7FOF_BXcGBDjMdtku1GHb_svVO8pqoHL__P4">Huggingface çš„ Chatbot Arena</a>ï¼Œ<a href="https://superclueai.com/">SuperGLUE æ¦œå•</a> ç­‰ã€‚</p>
<p>ä½†æ˜¯ï¼Œè¿™äº›æ¦œå•ä¸­çš„ä¸åŒæ‰“åˆ†ç©¶ç«Ÿæ„å‘³ç€ä»€ä¹ˆå‘¢ï¼Ÿåœ¨ä¸ºä¸šåŠ¡é€‰æ‹©æ¨¡å‹ã€ä¼˜åŒ–æ¨¡å‹çš„æ—¶å€™ï¼Œ79 åˆ†å°±ä¸€å®šæ¯” 78 åˆ†è¦å¥½å—ï¼Ÿå°±åƒä½“è‚²èµ›äº‹ä¸­ï¼Œè™½ç„¶æœ‰å† å†›å’Œäºšå†›ï¼Œä½†æ˜¯å† å†›å’Œäºšå†›ä¹‹é—´ä¼šå­˜åœ¨éå¸¸æ˜¾è‘—çš„å·®å¼‚å—ï¼Ÿ</p>
<p>åœ¨ <a href="https://arxiv.org/html/2403.15250v2">Comprehensive Reassessment of Large-Scale Evaluation Outcomes in LLMs: A Multifaceted Statistical Approach</a><sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup> è¿™ç¯‡æ–‡è®ºä¸­æåˆ°ï¼š</p>
<blockquote>
<p>The rapid growth of LLMs calls for more comprehensive and reliable evaluation methods. This necessitates broadening the scope of assessments, employing rigorous statistical methods.</p>
<p>Currently, fundamental statistical techniques, such as ANOVA or <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Ï‡</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\chi^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">Ï‡</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span> tests are missing in testing resulting data. These analyses are crucial for understanding whether LLM performance varies significantly across different training types, architectures, and parameter sizes.</p>
<p><img src="/2024/10/06/The-Statistical-Approach-for-the-Product-Evaluation/2.png" alt></p>
</blockquote>
<p>åœ¨ç¾å›½ï¼Œæ–°è¯ä¸Šå¸‚ä¹‹å‰å¿…é¡»ç»è¿‡ç¾å›½é£Ÿå“è¯å“ç›‘ç£ç®¡ç†å±€ï¼ˆFDAï¼‰çš„æ‰¹å‡†ï¼Œå³â€œæ–°è¯ç”³è¯·å®¡è¯„ç¨‹åºâ€ï¼ˆNDAï¼‰ï¼Œä»¥ç¡®ä¿è¯å“çš„å®‰å…¨æ€§å’Œæœ‰æ•ˆæ€§ã€‚å¹¶ä¸”ä¸ºäº†ç¡®ä¿è¯å“å®‰å…¨æ€§å’Œæœ‰æ•ˆæ€§è¯„ä¼°çš„ç§‘å­¦ä¸¥è°¨æ€§ï¼Œæ–°è¯çš„å®¡æ‰¹éœ€è¦æ ¹æ® <a href="https://www.fda.gov/regulatory-information/search-fda-guidance-documents/e9-statistical-principles-clinical-trials">ICH E9: Statistical Principles for Clinical Trials</a> ä¸­æä¾›çš„æ ‡å‡†çš„å®éªŒæ¡†æ¶å’Œè§„èŒƒçš„ç»Ÿè®¡æ–¹æ³•ã€‚</p>
<p>å›å¤´æƒ³æƒ³ï¼Œè™½ç„¶åœ¨æˆ‘ä»¬çš„è§†é¢‘è¯„ä¼°è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬è¿›è¡Œäº†å„ç§ç»“æœæ‰“åˆ†çš„ä¼˜åŒ–ï¼ˆæ¯”å¦‚å¼•å…¥ GSBï¼Œ <a href="/2024/03/13/How-to-calculate-the-ELO-ratings-for-multiple-sets-of-ACR-scores/">Elo æ‰“åˆ†</a>â€¦â€¦ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥æ›´ç²¾å‡†çš„åˆ»ç”»ä¸åŒç¼–è§£ç å™¨çš„æ•ˆæœï¼Œä½†æ˜¯æˆ‘ä»¬åªèƒ½ç»™å‡ºç»å¯¹æ’åºå´æ— æ³•åˆ¤æ–­ä¸åŒç¼–è§£ç å™¨ä¹‹é—´æ˜¯å¦å­˜åœ¨æ˜¾è‘—å·®å¼‚ï¼›æˆ‘ä»¬åªèƒ½è¯´åœ¨å½“å‰çš„æ ·æœ¬ä¸Šï¼Œå“ªä¸ªç¼–è§£ç å™¨çš„æ•ˆæœæ›´å¥½ï¼Œä½†æ˜¯å´æ— æ³•å°†è¿™ä¸ªç»“è®ºæ³›åŒ–åˆ°çº¿ä¸Šçš„æ‰€æœ‰è§†é¢‘ã€‚å°±åƒæˆ‘ä»¬åœ¨æ–‡ç« å¼€å¤´ä¸¾çš„ä¾‹å­é‚£æ ·ï¼Œ42% å°±ä¸€å®šæ¯” 37% è¦å¥½å—ï¼Ÿè€Œæ¨æ–­ç»Ÿè®¡æ–¹æ³•å°±å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½çš„åˆ†ææ•°æ®ï¼Œå¹¶å¾—å‡ºæ›´ä¸ºåˆç†çš„ç»“è®ºã€‚</p>
<h2 id="å‚æ•°ä¼°è®¡ä¸å‡è®¾æ£€éªŒ">å‚æ•°ä¼°è®¡ä¸å‡è®¾æ£€éªŒ</h2>
<p>å‚æ•°ä¼°è®¡å’Œå‡è®¾æ£€éªŒæ˜¯ç»Ÿè®¡æ¨æ–­ä¸­çš„ä¸¤ä¸ªåŸºæœ¬é—®é¢˜ï¼šå‚æ•°ä¼°è®¡æä¾›å¯¹æ€»ä½“å‚æ•°çš„ä¼°è®¡ï¼Œè€Œå‡è®¾æ£€éªŒåˆ™å¯¹æ€»ä½“å‚æ•°æ˜¯å¦ç­‰äºæŸä¸ªç‰¹å®šå€¼è¿›è¡Œæ£€éªŒã€‚</p>
<ul>
<li>å‚æ•°ä¼°è®¡ä¸»è¦è§£å†³å¦‚ä½•ä½¿ç”¨æ•°æ®æ¥ä¼°è®¡æ„Ÿå…´è¶£çš„å‚æ•°ã€‚ä¾‹å¦‚ï¼Œç§‘å­¦å®¶å¯èƒ½æƒ³è¦ç¡®å®šå—åˆ°é…¸é›¨å½±å“çš„ä¸­è¥¿éƒ¨æ¹–æ³Šçš„æ¯”ä¾‹ã€‚å‚æ•°ä¼°è®¡ä¸»è¦æœ‰ç‚¹ä¼°è®¡å’ŒåŒºé—´ä¼°è®¡ä¸¤ç§ã€‚ç‚¹ä¼°è®¡æ–¹æ³•ç”¨ä¸€ä¸ªæ•°å­—æ¥ä¼°è®¡æ„Ÿå…´è¶£çš„ç»Ÿè®¡é‡ï¼ˆä¾‹å¦‚ï¼Œä¸­è¥¿éƒ¨æ¹–æ³Šä¸­æœ‰ 47% çš„æ¹–æ³Šå—åˆ°äº†é…¸é›¨çš„å½±å“ï¼‰ã€‚åŒºé—´ä¼°è®¡åˆ™æ˜¯ä»¥ä¸€ä¸ªæ•°å€¼åŒºé—´çš„å½¢å¼æ¥ä¼°è®¡æ€»ä½“å‚æ•°çš„èŒƒå›´ï¼ˆä¾‹å¦‚ï¼Œä¸­è¥¿éƒ¨æ¹–æ³Šä¸­æœ‰ 45% ~ 49% çš„æ¹–æ³Šå—åˆ°äº†é…¸é›¨çš„å½±å“ï¼‰ã€‚åŒºé—´ä¼°è®¡æ–¹æ³•è¿˜å‘Šè¯‰æˆ‘ä»¬å¯¹å…¶ä¼°è®¡ç»“æœçš„ â€œç½®ä¿¡æ°´å¹³â€ï¼ˆ level of confidenceï¼‰ã€‚ä¾‹å¦‚ï¼Œå°½ç®¡æˆ‘ä»¬å¹¶ä¸èƒ½è‚¯å®š 47% å°±æ˜¯å—å½±å“çš„æ¹–æ³Šçš„ç¡®åˆ‡æ¯”ä¾‹ï¼Œä½†æˆ‘ä»¬å¾ˆå¯èƒ½æœ‰ 95% çš„ä¿¡å¿ƒè®¤ä¸ºå®é™…å—å½±å“çš„æ¹–æ³Šæ¯”ä¾‹åœ¨ 45% ~ 49% ä¹‹é—´ã€‚</li>
<li>å‡è®¾æ£€éªŒåˆ™æ˜¯åˆ©ç”¨æ•°æ®æ¥æ£€éªŒç‰¹å®šå‡è®¾çš„åˆç†æ€§ã€‚ä¾‹å¦‚ï¼Œå‡è®¾æ£€éªŒå¯èƒ½ä¼šæ‹’ç» â€œä¸­è¥¿éƒ¨å—é…¸é›¨å½±å“çš„æ¹–æ³Šå°‘äº 44%â€ è¿™æ ·çš„å‡è®¾ã€‚å»ºè®¾æ£€éªŒæŠ€æœ¯ä¼šæ¶‰åŠåˆ°å¦‚ä¸‹çš„æ¦‚å¿µï¼šç»Ÿè®¡é‡ï¼Œæ˜¾è‘—æ€§æ°´å¹³ï¼ŒåŸå‡è®¾ï¼Œå¤‡æ‹©å‡è®¾ï¼Œæ‹’ç»åŸŸï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>âˆ’</mo><mtext>value</mtext></mrow><annotation encoding="application/x-tex">p-\text{value}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord text"><span class="mord">value</span></span></span></span></span> ç­‰æ¦‚å¿µ<sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup>ï¼š
<ul>
<li>åŸå‡è®¾ï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">H_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼‰ï¼šè¿™æ˜¯æˆ‘ä»¬çš„èµ·ç‚¹ï¼ˆé»˜è®¤å‡è®¾ï¼‰ï¼Œé€šå¸¸è¡¨ç¤ºæ²¡æœ‰æ•ˆåº”ã€å·®å¼‚æˆ–å…³è”ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªæ–°è¯ä¸ç°æœ‰è¯ç‰©åœ¨ç–—æ•ˆä¸Šæ²¡æœ‰å·®å¼‚ã€‚</li>
<li>å¤‡æ‹©å‡è®¾ï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">H_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼‰ï¼šä¸åŸå‡è®¾ç›¸å¯¹ç«‹çš„å‡è®¾ï¼Œè¡¨ç¤ºå­˜åœ¨æŸç§æ•ˆåº”ã€å·®å¼‚æˆ–å…³è”ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªæ–°è¯æ¯”ç°æœ‰è¯ç‰©æ›´æœ‰æ•ˆã€‚</li>
<li>æ‹’ç»åŸŸï¼šæ£€éªŒç»Ÿè®¡é‡çš„å€¼åŸŸï¼Œå¦‚æœæ£€éªŒç»Ÿè®¡é‡çš„å€¼è½åœ¨è¿™ä¸ªåŒºåŸŸå†…ï¼Œæˆ‘ä»¬å°†æ‹’ç»åŸå‡è®¾ã€‚</li>
<li>æ˜¾è‘—æ€§æ°´å¹³ï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î±</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">Î±</span></span></span></span>ï¼‰ï¼šè¿™æ˜¯æˆ‘ä»¬æ„¿æ„æ‰¿æ‹…é”™è¯¯æ‹’ç»åŸå‡è®¾çš„æœ€å¤§é£é™©æ°´å¹³ï¼Œé€šå¸¸è®¾å®šä¸º 0.05 æˆ– 0.01ã€‚</li>
<li>æ£€éªŒç»Ÿè®¡é‡ï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span></span></span></span>ï¼‰ï¼šä¸€ä¸ªåŸºäºæ ·æœ¬æ•°æ®è®¡ç®—å‡ºçš„æ•°å€¼ï¼Œç”¨äºè¡¡é‡æ ·æœ¬ç»Ÿè®¡é‡ä¸åŸå‡è®¾ä¹‹é—´çš„å·®å¼‚ã€‚</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>âˆ’</mo><mtext>value</mtext></mrow><annotation encoding="application/x-tex">p-\text{value}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord text"><span class="mord">value</span></span></span></span></span>ï¼šåœ¨åŸå‡è®¾ä¸ºçœŸçš„æƒ…å†µä¸‹ï¼Œè§‚å¯Ÿåˆ°çš„æ ·æœ¬ç»“æœå‡ºç°çš„æ¦‚ç‡ï¼Œå¦‚æœ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>âˆ’</mo><mtext>value</mtext><mo>â‰¤</mo><mi>Î±</mi></mrow><annotation encoding="application/x-tex">p-\text{value} \le \alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83041em;vertical-align:-0.13597em;"></span><span class="mord text"><span class="mord">value</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">Î±</span></span></span></span>ï¼Œåˆ™æ‹’ç»é›¶å‡è®¾ï¼Œè¿™è¡¨æ˜è§‚å¯Ÿåˆ°çš„æ•ˆåº”æˆ–å·®å¼‚åœ¨ç»Ÿè®¡ä¸Šæ˜¯æ˜¾è‘—çš„ã€‚å¦‚æœ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>âˆ’</mo><mtext>value</mtext><mo>&gt;</mo><mi>Î±</mi></mrow><annotation encoding="application/x-tex">p-\text{value} \gt \alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="mord text"><span class="mord">value</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">Î±</span></span></span></span>ï¼Œåˆ™ä¸æ‹’ç»é›¶å‡è®¾ï¼Œè¿™è¡¨æ˜æ²¡æœ‰è¶³å¤Ÿçš„è¯æ®è¡¨æ˜è§‚å¯Ÿåˆ°çš„æ•ˆåº”æˆ–å·®å¼‚æ˜¯æ˜¾è‘—çš„ã€‚</li>
</ul>
</li>
</ul>
<p>å½“æ¶‰åŠåˆ°éœ€è¦åˆ¤æ–­å¤šç»„æ•°æ®æ—¶ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨ ANOVAï¼ˆåˆ†ææ–¹å·®ï¼‰å’Œå¡æ–¹æ£€éªŒæ¥æ£€éªŒä¸åŒæ–¹æ¡ˆçš„æ•ˆæœæ˜¯å¦ä¸€è‡´çš„å‡è®¾ã€‚ä¾‹å¦‚<sup class="footnote-ref"><a href="#fn4" id="fnref4">[4]</a></sup>ï¼š</p>
<blockquote>
<p>ç›®å‰å¸‚é¢ä¸Šæœ‰ 4 æ¬¾è½¯ä»¶å¯ä»¥æ•™æˆç”¨æˆ·å­¦ä¹ ä¸€é—¨æ–°çš„å˜æˆè¯­è¨€ï¼ŒæŸå¤§å…¬å¸æ­£åœ¨è€ƒè™‘å¤§è§„æ¨¡è´­ä¹°è¿™ 4 æ¬¾è½¯ä»¶ä¸­çš„ä¸€æ¬¾ã€‚å…¬å¸å†…éƒ¨ä¸€äº›èµ„æ·±äººå£«å£°ç§°ï¼Œè¿™å‡ æ¬¾è½¯ä»¶æ²¡æœ‰å¤ªå¤§çš„åŒºåˆ«ï¼Œå®ƒä»¬å¯¹ç”¨æˆ·çš„æœ€ç»ˆå­¦ä¹ æ•ˆæœå½±å“å¾ˆå°ã€‚ä¸ºäº†æ£€éªŒè¿™ä¸€å‡è®¾ï¼Œå…¬å¸å†³å®šé€‰æ‹© 160 åå·¥ç¨‹å¸ˆï¼Œå¹¶å°†ä»–ä»¬åˆ†æˆ 4 ç»„ï¼Œæ¯ç»„ 40 äººã€‚ç¬¬ <em>i</em> ç»„çš„å·¥ç¨‹å¸ˆä½¿ç”¨ç¬¬ <em>i</em> æ¬¾è½¯ä»¶æ¥å­¦ä¹ æ–°çš„è¯­è¨€ã€‚å½“æ‰€æœ‰å·¥ç¨‹å¸ˆå®Œæˆå­¦ä¹ åï¼Œå‚ä¸å­¦ä¹ çš„æ‰€æœ‰å·¥ç¨‹å¸ˆå°†è¿›è¡Œä¸€æ¬¡å…¨é¢è€ƒè¯•ã€‚å…¬å¸å¸Œæœ›ä½¿ç”¨è¿™æ¬¡è€ƒè¯•çš„ç»“æœæ¥ç¡®å®šä¸åŒçš„æ•™å­¦è½¯ä»¶æ˜¯å¦çœŸçš„å¯ä»¥äº’æ¢ã€‚è¯¥å…¬å¸éœ€è¦æ€ä¹ˆåšæ‰èƒ½å®ç°è¿™ä¸€ç‚¹ï¼Ÿ</p>
</blockquote>
<h2 id="æ¨èé˜…è¯»">æ¨èé˜…è¯»</h2>
<p>Introduction to Probability and Statistics for Engineers and Scientists (Sixth Edition) æ˜¯ä¸€æœ¬ä¸ºå·¥ç¨‹å¸ˆå’Œç§‘å­¦å®¶è€Œä½œçš„æœ‰å…³æ¦‚ç‡è®ºå’Œæ•°ç†ç»Ÿè®¡æ–¹é¢çš„ä¹¦ç±ã€‚è¿™æœ¬ä¹¦å±•ç¤ºäº†å¦‚ä½•åº”ç”¨æ¦‚ç‡è®ºæ¥æ´å¯Ÿç°å®ç”Ÿæ´»ä¸­çš„ç»Ÿè®¡é—®é¢˜ï¼Œä¹¦ä¸­ç²¾å¿ƒè®¾è®¡çš„æ¦‚ç‡è®ºç›¸å…³çš„å†…å®¹å°†çœŸå®ç°è±¡çš„æ¦‚ç‡æ¨¡å‹å’Œå…¶ç»Ÿè®¡ç¨‹åºå…³è”èµ·æ¥ï¼Œä»¥ä¾¿è¯»è€…èƒ½å¤Ÿæ›´ç›´è§‚çš„ç†è§£å®è·µå·¥ç¨‹å¸ˆå’Œç§‘å­¦å®¶æœ€å¸¸ç”¨çš„ç»Ÿè®¡ç¨‹åºå’Œç­–ç•¥ã€‚</p>
<p>å¯ä»¥ç‚¹å‡»<a href="https://wangwei1237.github.io/introduction_to_probability_and_statistics/">ğŸ”—é“¾æ¥</a>æ¥é˜…è¯»è¿™æœ¬ä¹¦çš„ä¸­æ–‡ç¿»è¯‘ç‰ˆã€‚</p>
<h2 id="å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</h2>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p><a href="https://aimarketingengineers.com/inferential-statistics/">inferential statistics</a> <a href="#fnref1" class="footnote-backref">â†©ï¸</a> <a href="#fnref1:1" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn2" class="footnote-item"><p><a href="https://arxiv.org/html/2403.15250v2">Comprehensive Reassessment of Large-Scale Evaluation Outcomes in LLMs: A Multifaceted Statistical Approach</a> <a href="#fnref2" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn3" class="footnote-item"><p><a href="https://mp.weixin.qq.com/s/UUIfY4oAvUXoxS-t1zPR2g">å‡è®¾æ£€éªŒ 101ï¼šåŸºäºæ•°æ®æ„å»ºçš„å¯ä¿¡ç»“è®º</a> <a href="#fnref3" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn4" class="footnote-item"><p><a href="https://wangwei1237.github.io/introduction_to_probability_and_statistics/chapter_10/10.html">æ–¹å·®åˆ†æ</a> <a href="#fnref4" class="footnote-backref">â†©ï¸</a></p>
</li>
</ol>
</section>
]]></content>
      <categories>
        <category>æ€»ç»“</category>
      </categories>
      <tags>
        <tag>è¯„æµ‹</tag>
        <tag>æ•°æ®åˆ†æ</tag>
        <tag>ç»Ÿè®¡å­¦</tag>
        <tag>æ¨æ–­ç»Ÿè®¡</tag>
      </tags>
  </entry>
  <entry>
    <title>äº§å“è¯„æµ‹çš„åŸºæœ¬æ¨¡å‹</title>
    <url>/2024/08/17/The-Basic-Model-for-the-Product-Evaluation/</url>
    <content><![CDATA[<p><img src="/2024/08/17/The-Basic-Model-for-the-Product-Evaluation/1.png" alt></p>
<p>2024 å¹´ 7 æœˆ 25 æ—¥ï¼Œæˆ‘é¢å‘å…¬å¸å†…éƒ¨åšäº†ä¸€æ¬¡å…³äºå¤§æ¨¡å‹å¤šæ¨¡æ€è¯„æµ‹çš„åˆ†äº«ï¼Œåœ¨è¿™æ¬¡çš„åˆ†äº«ä¸­ï¼Œæˆ‘æ€»ç»“äº†è‡ªå·±åœ¨äº§å“è¯„æµ‹å’Œåˆ†ææ–¹é¢å¤šå¹´æ¥çš„è§‚å¯Ÿã€å®è·µå’Œæ€è€ƒï¼Œå¹¶é¦–æ¬¡æå‡ºäº† <strong>äº§å“è¯„æµ‹çš„åŸºæœ¬æ¨¡å‹</strong> è¿™ä¸€æ¦‚å¿µï¼Œå¹¶ç”¨è¿™ä¸€æ¨¡å‹åˆ†æäº†æˆ‘ä»¬åœ¨å®è·µä¸­é‡åˆ°çš„é—®é¢˜ã€‚</p>
<p>ç°åœ¨ï¼ŒæŠŠ <strong>äº§å“è¯„æµ‹çš„åŸºæœ¬æ¨¡å‹</strong> è¿™éƒ¨åˆ†å†…å®¹å•ç‹¬æ•´ç†å‡ºæ¥ï¼Œä»¥ä¾¿èƒ½å¤Ÿè®©æ›´å¤šçš„äººå¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¨¡å‹æ›´å¥½åœ°è¿›è¡Œäº§å“è¯„æµ‹ã€‚</p>
<span id="more"></span>
<h2 id="è¯„æµ‹çš„ç–‘æƒ‘">è¯„æµ‹çš„ç–‘æƒ‘</h2>
<p>åˆšå·¥ä½œçš„æ—¶å€™ï¼Œç»å¸¸ä»äº‹æ€§èƒ½è¯„ä¼°å·¥ä½œä»¥è¯„ä¼°å½“å‰ç³»ç»Ÿçš„æ”¹åŠ¨æ˜¯å¦ä¼šå½±å“ç³»ç»Ÿçš„æ•´ä½“æ€§èƒ½ã€‚é‚£ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬æ€»èƒ½å¤Ÿæ‰¾åˆ°å„ç§æ–¹æ³•æ„é€ çº¿ä¸‹çš„æ€§èƒ½æµ‹è¯•ç¯å¢ƒï¼Œå¹¶ä¸”æ€§èƒ½æŒ‡æ ‡çš„æµ‹è¯•ç»“æœå¾€å¾€èƒ½å¤Ÿä»£è¡¨ä¸Šçº¿åçš„ç³»ç»Ÿçš„çœŸå®è¡¨ç°ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸Šçº¿å‰çš„æ€§èƒ½æµ‹è¯•ç»“æœå’Œä¸Šçº¿åçš„åéªŒè¡¨ç°ä¹‹é—´å…·å¤‡å¾ˆå¥½çš„ç›¸å…³æ€§ï¼Œæ‰€ä»¥ï¼Œæ€§èƒ½æµ‹è¯•ç»“æœèƒ½å¤Ÿè§£é‡Šã€ä»£è¡¨ä¸Šçº¿åçš„ç³»ç»Ÿæ€§èƒ½ã€‚</p>
<p>åæ¥ï¼Œå¼€å§‹å‚ä¸äº§å“è¯„æµ‹çš„å·¥ä½œï¼Œå¹¶ä¸”å¼€å§‹å‘ç°ï¼šä»è§£é‡Šã€æŒ‡å¯¼å±‚é¢è®²ï¼Œäº§å“è¯„æµ‹å’Œä¹‹å‰çš„æ€§èƒ½è¯„æµ‹éå¸¸ä¸åŒï¼Œäº§å“è¯„æµ‹çš„ç»“æœå’Œä¸Šçº¿ä¹‹åçš„åéªŒç»“æœä¹‹é—´å¾€å¾€æœ‰éå¸¸å¤§çš„åå·®ï¼Œç”šè‡³æ˜¯å®Œå…¨ç›¸åçš„ç»“è®ºã€‚</p>
<p>æ›¾ç»å¤šå°‘æ¬¡ï¼Œåœ¨ç³»ç»Ÿä¸Šçº¿ä¹‹å‰ï¼Œæˆ‘ä»¬ä»å¤šä¸ªæ–¹é¢è¿›è¡Œäº†è¯„æµ‹ï¼šæ€§èƒ½ä¹Ÿæå‡äº†ï¼Œæ•ˆæœä¹Ÿæå‡äº†ï¼Œæˆ‘ä»¬å…´é«˜é‡‡çƒˆçš„ä¸Šçº¿ï¼Œç„¶åæ¿€åŠ¨çš„ç­‰å¾…ç€å®éªŒæ•°æ®çš„äº§å‡ºï¼Œæœ€åå¾—åˆ°çš„å´æ˜¯æ•ˆæœä¸æ˜æ˜¾çš„ç»“è®ºã€‚å¤šå°‘ä¸ªä¸çœ çš„å¤œé‡Œï¼Œæˆ‘æ€»ä¼šé—®è‡ªå·±ï¼šæŠ€æœ¯ä¸Šå·²ç»æœ‰äº†å¾ˆå¤§çš„æå‡å•¦ï¼Œä¸ºä»€ä¹ˆå´æ²¡æœ‰åœ¨çº¿ä¸Šè¡¨ç°å‡ºå¯¹åº”çš„æ•ˆæœå‘¢ï¼Ÿè¿™ç©¶ç«Ÿæ˜¯ä¸ºä»€ä¹ˆå‘€ï¼Ÿ</p>
<h3 id="ç›¸æœº-vs-iphone">ç›¸æœº VS iPhone</h3>
<p>åæ¥ï¼Œæˆ‘çœ‹åˆ°äº†æ—§é‡‘å±±æ‘„å½±å¸ˆ <a href="https://om.co/about/">OM MALIK</a> åˆ¶ä½œçš„ä¸€å¼  <a href="https://om.co/2021/02/07/iphone-vs-camera-no-contest/">å…¨çƒç›¸æœºå’Œ iPhone é”€é‡çš„å¯¹æ¯”å›¾</a>ã€‚</p>
<p><img src="/2024/08/17/The-Basic-Model-for-the-Product-Evaluation/iPhonevsCameraSales2020.jpeg" alt></p>
<p>åœ¨è¿™å¼ å¯¹æ¯”å›¾ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥æ˜æ˜¾çœ‹åˆ°ç›¸æœºå’Œ iPhone ä¹‹é—´æ­¤æ¶ˆå½¼é•¿çš„æ€åŠ¿ï¼Œä»¥åŠä»¥ iPhone ä¸ºä»£è¡¨çš„æ™ºèƒ½æ‰‹æœºå¯¹ç›¸æœºå±•å¼€çš„é”€é‡ â€œå± æ€â€ï¼š</p>
<ul>
<li>2007 å¹´ iPhone é—®ä¸–æ—¶ï¼Œæ­£å¤„äºç›¸æœºçš„å·…å³°æ—¶æœŸï¼Œå…¶å¹´å‡ºè´§é‡éƒ½åœ¨ä¸Šäº¿å°å·¦å³ï¼ŒiPhone å¯¹ç›¸æœºè¡Œä¸šçš„å½±å“ä¹Ÿå¾®ä¹å…¶å¾®ã€‚</li>
<li>2012 å¹´ï¼Œéšç€ iPhone 5 çš„é¢ä¸–ï¼Œ800 ä¸‡åƒç´ çš„æ‰‹æœºç›¸æœºé•œå¤´å·²ç»å¼€å§‹å¯¹ç›¸æœºè¡Œä¸šå¸¦æ¥å†²å‡»ã€‚</li>
</ul>
<p>è¿‘å‡ å¹´çš„æƒ…å†µå°±æ›´ä¸ç”¨ä»‹ç»äº†ï¼Œå¯¹äºæ™®é€šæ¶ˆè´¹è€…è€Œè¨€ï¼Œæ‰‹æœºè¶³ä»¥æ»¡è¶³æ—¥å¸¸æ‹æ‘„éœ€æ±‚ï¼Œç›¸æœºçš„é”€é‡è¢«æåº¦å‹ç¼©ã€‚å¦‚ä»Šï¼Œç›¸æœºçš„å¹´å‡ºè´§é‡è¿˜ä¸åˆ° 1 åƒä¸‡å°ï¼Œå·²ç»ä¸è¶³é¼ç››æ—¶æœŸçš„ 10%ã€‚è€Œ iPhone çš„å‡ºè´§é‡å·²è¶…è¿‡ 2 äº¿å°ï¼Œæ˜¯ç›¸æœºçš„è¿‘ 30 å€ã€‚</p>
<p><img src="/2024/08/17/The-Basic-Model-for-the-Product-Evaluation/2.png" alt></p>
<p>åœ¨ <a href="https://www.dxomark.cn/smartphones-vs-cameras-closing-the-gap-on-image-quality/">æ™ºèƒ½æ‰‹æœºä¸ç›¸æœºå›¾åƒè´¨é‡ï¼šé€æ¸å¼¥åˆçš„å·®è·</a> è¿™ç¯‡æ–‡ç« ä¸­ï¼Œå¯¹æ¯”äº†ç›¸æœºå’Œæ‰‹æœºçš„æ‹ç…§ä½“éªŒï¼Œå…¶ä¸­ä¹Ÿæåˆ°åœ¨å¾ˆå¤šåœºæ™¯ä¸‹ï¼Œç›¸æœºçš„æ€§èƒ½ç¡®å®æ˜¯æ¯”å½“å‰çš„é«˜ç«¯æ‰‹æœºè¦å¥½å¾ˆå¤šçš„ã€‚æ‰€ä»¥ï¼Œä»æŠ€æœ¯è§’åº¦ä¸Šè®²ï¼Œç›¸æœºçš„èƒ½åŠ›å¹¶ä¸å·®ï¼Œç”šè‡³åœ¨æŸäº›åœºæ™¯ï¼ˆæ¯”å¦‚æŠ“æ‹ï¼‰è¿˜è¦ä¼˜äºæ‰‹æœºã€‚å°¤å…¶æ˜¯åœ¨å‡ å¹´å‰ï¼Œç›¸æœºçš„æ‹ç…§èƒ½åŠ›è¿œè¿œè¶…è¿‡æ‰‹æœºçš„æ—¶å€™ï¼Œç›¸æœºçš„é”€é‡ä¾ç„¶åœ¨æŒç»­ä¸‹è·Œã€‚</p>
<p>æŠ€æœ¯æ²¡é—®é¢˜å‘€ï¼Œç”¨æˆ·æ€ä¹ˆå°±æ˜¯ä¸ä¹°å‘¢ï¼Ÿ</p>
<h2 id="äº§å“è¯„æµ‹æ¨¡å‹">äº§å“è¯„æµ‹æ¨¡å‹</h2>
<p>æˆ‘ä¸€ç›´åœ¨æƒ³ï¼Œä¸ºä»€ä¹ˆäº§å“è¯„æµ‹çš„ç»“æœå’Œä¸Šçº¿åçš„åéªŒè¡¨ç°ä¹‹é—´å¾€å¾€æ¯”è¾ƒå¤§çš„åå·®å‘¢ï¼Ÿè¿™èƒŒåç©¶ç«Ÿéšè—ç€ä»€ä¹ˆç§˜å¯†å’Œè§„å¾‹å‘¢ï¼Ÿ</p>
<h3 id="ç”¨æˆ·ä½“éªŒæ¨¡å‹">ç”¨æˆ·ä½“éªŒæ¨¡å‹</h3>
<p>2021 å¹´åº•çš„æ—¶å€™ï¼ŒåŸºäºè‡ªå·±çš„è§‚å¯Ÿå’Œæ€è€ƒä»¥åŠé˜…è¯»çš„å¤§é‡èµ„æ–™ï¼Œæˆ‘å†™äº†ä¸€ç¯‡æ–‡ç« ï¼š<a href="/2021/12/17/the-QoE-model-for-production/">äº§å“çš„ç”¨æˆ·ä½“éªŒæ¨¡å‹</a> ï¼Œåœ¨è¿™ç¯‡æ–‡ç« ä¸­æå‡ºäº†å¦‚ä¸‹çš„ç”¨æˆ·ä½“éªŒæ¨¡å‹ï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>Q</mi><mi>o</mi><mi>E</mi><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.3599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>ç”¨æˆ·ä¸Šç˜¾</mtext><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>ifÂ Â </mtext><mi>Q</mi><mi>o</mi><mi>E</mi><mtext>Â </mtext><mo>&gt;</mo><mi mathvariant="normal">Î”</mi><mo separator="true">;</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>åŸºæœ¬æ»¡è¶³</mtext><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>ifÂ Â </mtext><mi mathvariant="normal">âˆ£</mi><mtext>Â </mtext><mi>Q</mi><mi>o</mi><mi>E</mi><mtext>Â </mtext><mi mathvariant="normal">âˆ£</mi><mo>&lt;</mo><mi>Îµ</mi><mo separator="true">;</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>ç”¨æˆ·ç¦»å»</mtext><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>ifÂ Â Â </mtext><mi>Q</mi><mi>o</mi><mi>E</mi><mtext>Â </mtext><mo>&lt;</mo><mo>âˆ’</mo><mi mathvariant="normal">Î”</mi></mrow></mstyle></mtd></mtr></mtable></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>s</mi><mi mathvariant="normal">.</mi><mi>t</mi><mi mathvariant="normal">.</mi><mtext>Â Â </mtext><mn>0</mn><mo>&lt;</mo><mi>Îµ</mi><mo>â‰ª</mo><mi mathvariant="normal">Î”</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
&amp;QoE = \begin{cases}
\text{ç”¨æˆ·ä¸Šç˜¾}, &amp;\text{if } \ QoE\  &gt; \Delta;\\
\text{åŸºæœ¬æ»¡è¶³}, &amp;\text{if } \ |\ QoE\ | &lt; \varepsilon;\\
\text{ç”¨æˆ·ç¦»å»}, &amp;\text{if } \ \ QoE\  &lt;  -\Delta
\end{cases}\\
&amp;\\
&amp; s.t. \ \ 0 &lt; \varepsilon \ll \Delta
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:7.62em;vertical-align:-3.5599999999999996em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.0600000000000005em;"><span style="top:-6.0600000000000005em;"><span class="pstrut" style="height:4.41em;"></span><span class="mord"></span></span><span style="top:-3.0100000000000007em;"><span class="pstrut" style="height:4.41em;"></span><span class="mord"></span></span><span style="top:-1.5100000000000007em;"><span class="pstrut" style="height:4.41em;"></span><span class="mord"></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:3.5599999999999996em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.0600000000000005em;"><span style="top:-6.0600000000000005em;"><span class="pstrut" style="height:4.41em;"></span><span class="mord"><span class="mord"></span><span class="mord mathdefault">Q</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.35002em;"><span style="top:-2.19999em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>â©</span></span></span><span style="top:-2.19499em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>âª</span></span></span><span style="top:-2.20499em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>âª</span></span></span><span style="top:-3.15001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>â¨</span></span></span><span style="top:-4.2950099999999996em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>âª</span></span></span><span style="top:-4.30501em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>âª</span></span></span><span style="top:-4.60002em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>â§</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.8500199999999998em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.41em;"><span style="top:-4.41em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord cjk_fallback">ç”¨æˆ·ä¸Šç˜¾</span></span><span class="mpunct">,</span></span></span><span style="top:-2.97em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord cjk_fallback">åŸºæœ¬æ»¡è¶³</span></span><span class="mpunct">,</span></span></span><span style="top:-1.5300000000000002em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord cjk_fallback">ç”¨æˆ·ç¦»å»</span></span><span class="mpunct">,</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.9099999999999997em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.41em;"><span style="top:-4.41em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">ifÂ </span></span><span class="mspace">Â </span><span class="mord mathdefault">Q</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace">Â </span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">Î”</span><span class="mpunct">;</span></span></span><span style="top:-2.97em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">ifÂ </span></span><span class="mspace">Â </span><span class="mord">âˆ£</span><span class="mspace">Â </span><span class="mord mathdefault">Q</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mspace">Â </span><span class="mord">âˆ£</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault">Îµ</span><span class="mpunct">;</span></span></span><span style="top:-1.5300000000000002em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">ifÂ </span></span><span class="mspace">Â </span><span class="mspace">Â </span><span class="mord mathdefault">Q</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace">Â </span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">âˆ’</span><span class="mord">Î”</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.9099999999999997em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.0100000000000007em;"><span class="pstrut" style="height:4.41em;"></span><span class="mord"><span class="mord"></span></span></span><span style="top:-1.5100000000000007em;"><span class="pstrut" style="height:4.41em;"></span><span class="mord"><span class="mord"></span><span class="mord mathdefault">s</span><span class="mord">.</span><span class="mord mathdefault">t</span><span class="mord">.</span><span class="mspace">Â </span><span class="mspace">Â </span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault">Îµ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰ª</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">Î”</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:3.5599999999999996em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><img src="/2021/12/17/the-QoE-model-for-production/2.png" alt></p>
<p>äº‹æƒ…å¥½åƒæ¸æ¸æ˜æ™°äº†èµ·æ¥ï¼Œä½†æ˜¯å¥½åƒè¿˜æ˜¯æ²¡æœ‰ä»æ ¹æœ¬ä¸Šè§£é‡Šäº§å“è¯„æµ‹çš„ç»“æœå’Œä¸Šçº¿åçš„åéªŒè¡¨ç°ä¹‹é—´å­˜åœ¨åå·®çš„åŸå› ã€‚</p>
<h3 id="è¯„æµ‹åŸºæœ¬æ¨¡å‹">è¯„æµ‹åŸºæœ¬æ¨¡å‹</h3>
<p>ç›´åˆ°æœ€è¿‘ï¼Œåœ¨ä¸€æ¬¡é’ˆå¯¹è¯­éŸ³çš„å¤šç»´åº¦è¯„ä¼°ä¸­ï¼Œæˆ‘ä»¬æ‰ä»å¤šä¸ªè§†è§’çš„è¯„ä¼°æ•°æ®ä¸­å¿½ç„¶å‘ç°äº†è¿™å…¶ä¸­çš„ç§˜å¯†ã€‚é«˜å…´ä¹‹æƒ…æº¢äºè¨€è¡¨ï¼Œå¯çœŸæ˜¯ï¼šæ½‡æ½‡é›¨ï¼Œé›¾è’™æµ“ï¼Œä¸€çº¿é˜³å…‰ç©¿äº‘å‡ºã€‚æˆ‘æŠŠæˆ‘ä»¬çš„å‘ç°ç§°ä¹‹ä¸ºï¼šäº§å“è¯„æµ‹çš„åŸºæœ¬æ¨¡å‹ã€‚</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Perception</mtext><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mtext>Actual</mtext><mo separator="true">,</mo><mtext>Â Expected</mtext><mo separator="true">,</mo><mtext>Â UX</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{Perception} = f(\text{Actual}, \ \text{Expected}, \ \text{UX}) 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord text"><span class="mord">Perception</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord text"><span class="mord">Actual</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace">Â </span><span class="mord text"><span class="mord">Expected</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace">Â </span><span class="mord text"><span class="mord">UX</span></span><span class="mclose">)</span></span></span></span></span></p>
<ul>
<li><strong>Perception</strong>ï¼šä»£è¡¨ç€ç”¨æˆ·ä½¿ç”¨äº§å“çš„æ„ŸçŸ¥ä½“éªŒã€‚</li>
<li><strong>Actual</strong>ï¼šä»£è¡¨ç€äº§å“çš„å®é™…å…·æœ‰çš„èƒ½åŠ›ï¼Œæ¯”å¦‚ ä½³èƒ½ EOS R5 Mark II ç›¸æœºå¯ä»¥æ‹æ‘„ 8K 60P çš„è§†é¢‘ã€‚</li>
<li><strong>Expected</strong>ï¼šä»£è¡¨ç€ç”¨æˆ·ä½¿ç”¨äº§å“ä¹‹å‰çš„é¢„æœŸï¼Œå³ç”¨æˆ·å¸Œæœ›è¿™ä¸ªäº§å“æœ‰ä»€ä¹ˆèƒ½åŠ›ï¼Œæ¯”å¦‚ç”¨æˆ·å¸Œæœ›å•åç›¸æœºèƒ½å¤Ÿæ‹å‡º 4K HDR çš„è§†é¢‘ã€‚</li>
<li><strong>UX</strong>ï¼šä»£è¡¨çš„ç”¨æˆ·ä½¿ç”¨äº§å“è¿‡ç¨‹ä¸­çš„äº¤äº’ä½“éªŒï¼Œæ¯”å¦‚ç›¸æœºçš„ 3Aâ€”â€”è‡ªåŠ¨å¯¹ç„¦ (AF)ã€è‡ªåŠ¨æ›å…‰ (AE) å’Œè‡ªåŠ¨ç™½å¹³è¡¡ (AWB)â€”â€”ä½¿å¾—æˆ‘ä»¬åœ¨æ‹ç…§è¿‡ç¨‹ä¸­ä¸éœ€è¦é¢‘ç¹è°ƒèŠ‚å„ç§å‚æ•°ï¼Œå¤§å¤§æå‡äº†ç”¨æˆ·æ‹ç…§çš„äº¤äº’ä½“éªŒã€‚</li>
</ul>
<p>ç”¨æˆ·çš„æ„ŸçŸ¥ä½“éªŒä¸ä»…ä»…ä¾èµ–äºäº§å“çš„å®é™…èƒ½åŠ›ï¼Œä¹Ÿä¸ä»…ä»…ä¸ç”¨æˆ·é¢„æœŸæœ‰å…³ï¼Œè€Œæ˜¯å’Œäº§å“çš„å®é™…èƒ½åŠ›ã€ç”¨æˆ·é¢„æœŸã€äº¤äº’ä½“éªŒè¿™ä¸‰è€…ï¼ˆæˆ‘ä»¬ç§°ä¹‹ä¸ºæ„ŸçŸ¥ä½“éªŒä¸‰è¦ç´ ï¼‰æœ‰å…³ï¼Œæ˜¯è¿™ä¸‰è€…å…±åŒå†³å®šçš„ã€‚æˆ‘ä»¬ä¹‹å‰çš„è¯„æµ‹å¾€å¾€åªå…³æ³¨äº†è¿™ä¸‰è€…ä¸­çš„æŸä¸ªæˆ–è€…æŸä¸¤ä¸ªå› ç´ ï¼Œå› æ­¤å¯¼è‡´äº†è¯„æµ‹ç»“æœå’Œä¸Šçº¿åçš„åéªŒè¡¨ç°ä¹‹é—´å­˜åœ¨åå·®ã€‚</p>
<h4 id="actual">Actual</h4>
<p>äº§å“çš„å®é™…èƒ½åŠ›å–å†³äºäº§å“çš„æŠ€æœ¯å®åŠ›ï¼Œæ˜¯äº§å“æ„ŸçŸ¥ä½“éªŒçš„åŸºç¡€å’Œæ ¹æœ¬ã€‚æ²¡æœ‰å¼ºå¤§çš„æŠ€æœ¯å®åŠ›ï¼Œå¾ˆéš¾çº¯é è´©å–é¢„æœŸå’Œåœ¨ç»†èŠ‚ä¸Šæ­»æ‰£äº¤äº’ä½“éªŒè€Œåšå‡ºè®©ç”¨æˆ·æ»¡æ„çš„äº§å“ï¼Œæ›´å¾ˆéš¾è·å¾—è¾ƒå¥½çš„ç”¨æˆ·æ„ŸçŸ¥ä½“éªŒã€‚</p>
<h4 id="expected">Expected</h4>
<p>ç”¨æˆ·é¢„æœŸæ˜¯æ„ŸçŸ¥ä½“éªŒçš„æ˜¾è‘—å½±å“åŠ›ï¼Œå½“ç”¨æˆ·æƒ³è¦ä¸€ä¸ªè‹¹æœæ—¶ï¼Œæˆ‘ä»¬å´ç»™äº†ä»–ä¸€è½¦é¦™è•‰ï¼Œå³ä¾¿æ˜¯æœ€å¥½çš„é¦™è•‰ï¼Œé‚£ä¹ˆç”¨æˆ·ä¹Ÿå¾ˆéš¾æ»¡æ„ã€‚åœ¨é›·å†›çš„ ã€Šå°ç±³åˆ›ä¸šæ€è€ƒã€‹è¿™æœ¬ä¹¦ä¸­ï¼Œé›·å†›å¯¹ç”¨æˆ·é¢„æœŸç»™äºˆäº†é«˜åº¦å…³æ³¨ã€‚</p>
<div class="douban-card-block">
	<a class="douban-card" href="https://book.douban.com/subject/36057097">
		<div class="douban-card-bgimg" style="background-image: url('https://images.weserv.nl/?url=https://img1.doubanio.com/view/subject/s/public/s34286309.jpg');"></div>
		<div class="douban-card-left">
			<div class="douban-card-img" style="background-image: url('https://images.weserv.nl/?url=https://img1.doubanio.com/view/subject/s/public/s34286309.jpg');"></div>
		</div>
		<div class="douban-card-right" style="line-height: 1.7;">
			<div class="douban-card-item"><span>ä¹¦å: </span><strong>å°ç±³åˆ›ä¸šæ€è€ƒ</strong></div>
			<div class="douban-card-item"><span>ä½œè€…: </span><span>é›·å†›</span></div>
			<div class="douban-card-item"><span>å‡ºç‰ˆå¹´ä»½: </span><span>2022-8-1</span></div>
			<div class="douban-card-item"><span>è¯„åˆ†: </span><span>8.2</span></div>
		</div>
	</a>
</div>
<style>
	.douban-card-block {
		display: flex;
		justify-content: center;
		align-items: center;
		width: 100%;
		max-height: 400px;
	}
	.douban-card {
		display: flex;
		margin: 30px 10px;
		padding: 15px;
		border-radius: 10px;
		position: relative;
		justify-content: center;
		align-items: center;
		overflow: hidden;
		color: antiquewhite;
		text-decoration: none;
	}
	.douban-card:hover {
		text-decoration: none;
	}
	.douban-card-bgimg {
		position: absolute;
		width: 115%;
		height: 115%;
		filter: blur(15px) brightness(0.6);
		background-size: 100%;
		background-position: center;
		background-repeat: no-repeat;
	}
	.douban-card-img {
		position: relative;
		height: 130px;
		width: 80px;
		background-size: 100%;
		background-position: center;
		background-repeat: no-repeat;
	}
	.douban-card-img {
		position: relative;
		height: 130px;
		width: 80px;
	}
	.douban-card-left {
		position: relative;
		display: flex;
		flex-direction: column;
		align-items: center;
	}
	.douban-card-right {
		position: relative;
		display: flex;
		flex-direction: column;
		margin-left: 12px;
		font-size: 16px;
		font-family: 'Courier New', Courier, monospace;
		line-height: 1.3;
		color: antiquewhite;
	}
	.douban-card-item {
		margin-top: 4px;
	}
</style>
<p>åœ¨ ã€Šå°ç±³åˆ›ä¸šæ€è€ƒã€‹ ä¸€ä¹¦ä¸­ï¼Œé›·å†›æ€»ç»“äº†å°ç±³æˆåŠŸçš„äº’è”ç½‘ä¸ƒå­—è¯€ï¼šä¸“æ³¨ã€æè‡´ã€å£ç¢‘ã€å¿«ã€‚å¯¹äº â€œå£ç¢‘â€ è¿™ä¸ªç§˜è¯€ï¼Œä¹¦é‡Œè¿™æ ·å†™åˆ°ï¼š</p>
<blockquote>
<p>ç”¨æˆ·å£ç¢‘æ˜¯æ‰€æœ‰äº§å“æˆåŠŸçš„å…³é”®å› ç´ ï¼Œè¿™æ˜¯ä¸è¨€è€Œå–»çš„å…¬ç†ã€‚</p>
<p>èµ„æºæ°¸è¿œæœ‰é™ï¼Œå¯¹äºåˆ›ä¸šå…¬å¸å°¤å…¶å¦‚æ­¤ã€‚åªæœ‰ä¸“æ³¨ï¼Œæ‰èƒ½é›†ä¸­æ‰€æœ‰èµ„æºåšä¸€ä»¶äº‹æƒ…ï¼Œæ‰èƒ½æŠŠè¿™ä»¶äº‹æƒ…åšåˆ°æè‡´ï¼›åªæœ‰æè‡´ï¼Œæ‰èƒ½ä»å†…å¿ƒæ·±å¤„æ‰“åŠ¨ç”¨æˆ·ï¼Œç”¨æˆ·æ‰æ„¿æ„å£å£ç›¸ä¼ ï¼Œä»è€Œå½¢æˆè‰¯å¥½çš„å£ç¢‘ä¼ æ’­æ•ˆåº”ã€‚</p>
<p>è‰¯å¥½çš„å£ç¢‘ä»ä½•è€Œæ¥ï¼Ÿæˆ‘çš„ç†è§£æ˜¯ï¼Œå¥½äº§å“ä¸ä¸€å®šèƒ½å¸¦æ¥å£ç¢‘ï¼Œä¾¿å®œçš„äº§å“ä¸ä¸€å®šèƒ½å¸¦æ¥å£ç¢‘ï¼Œåˆå¥½åˆä¾¿å®œçš„äº§å“ä¹Ÿä¸ä¸€å®šèƒ½å¸¦æ¥å£ç¢‘ï¼Œ<code>åªæœ‰è¶…è¿‡é¢„æœŸçš„äº§å“æ‰èƒ½å¸¦æ¥å£ç¢‘</code>ã€‚</p>
</blockquote>
<p>åœ¨ ã€Šå°ç±³åˆ›ä¸šæ€è€ƒã€‹ è¿™æœ¬ä¹¦ä¸­ï¼Œæ€»å…±æåˆ°äº†è¿‘ 40 æ¬¡ç”¨æˆ·é¢„æœŸï¼Œåœ¨è¿™æœ¬ä¹¦çš„ 14 ä¸ªç« èŠ‚ä¸­ï¼Œæœ‰ 5 ä¸ªç« èŠ‚æåˆ°äº†ç”¨æˆ·é¢„æœŸï¼Œä»ä¸­ä¹Ÿå¯ä»¥çœ‹å‡ºç”¨æˆ·é¢„æœŸçš„é‡è¦æ€§ã€‚åœ¨ç¬¬ 12 ç« â€”â€”ç”Ÿæ€é“¾æ¨¡å¼â€”â€”ä»‹ç»å°ç±³æ‰‹ç¯çš„æ—¶å€™ï¼Œä¹¦é‡Œè¿™æ ·å†™é“ï¼š</p>
<blockquote>
<p>ä¸ºäº†åˆºæ¿€ç”¨æˆ·çš„è¶…é¢„æœŸæ„Ÿï¼Œæˆ‘ä»¬ç©äº†ç‚¹â€œå°å¿ƒæ€â€ï¼Œåœ¨å‘å¸ƒäº§å“æ—¶ï¼Œæˆ‘ä»¬å¯¹å¤–å®£ç§°å¯ä»¥å®ç° 30 å¤©çš„è¶…é•¿å¾…æœºï¼ˆè¿™åœ¨å½“æ—¶å·²ç»æ˜¯ä¸ªä¸æ•¢æƒ³è±¡çš„æ•°å­—ï¼‰ï¼Œä½†å®é™…ä¸Šå®éªŒæ•°æ®è¦è¿œå¤§äºè¿™ä¸ªæ•°å­—ã€‚</p>
<p><strong>å¾ˆå¤šç”¨æˆ·ä½¿ç”¨ä¹‹åæ‰å‘ç°ç»­èˆªæ—¶é—´æ¯”è¯´æ˜ä¹¦é‡Œè¯´çš„è¦é•¿å¾ˆå¤šï¼Œå¤§å¤§è¶…å‡ºé¢„æœŸï¼Œç”±æ­¤è¿›ä¸€æ­¥æ‰©å¤§äº†å°ç±³æ‰‹ç¯çš„å£ç¢‘ã€‚</strong></p>
</blockquote>
<p>æˆ‘ä»¬è®¤ä¸ºï¼Œç”¨æˆ·é¢„æœŸæ¥è‡ªä¸¤ä¸ªå› ç´ ï¼š</p>
<ul>
<li>ç”¨æˆ·çš„è‡ªæˆ‘è®¤çŸ¥</li>
<li>ç«å“çš„å®é™…èƒ½åŠ›</li>
</ul>
<p>å¦‚ä½•ç†è§£å‘¢ï¼Ÿå¦‚æœå°å­©å¹³æ—¶è€ƒè¯•éƒ½æ˜¯è€ƒ 70 åˆ†å·¦å³ï¼ˆæ»¡åˆ† 100 åˆ†ï¼‰ï¼Œå¿½ç„¶æœ‰ä¸€å¤©å­©å­å‘Šè¯‰ä½ å¥¹è€ƒäº† 90 åˆ†ï¼Œé‚£ä¹ˆä½œä¸ºçˆ¶æ¯çš„æˆ‘ä»¬ä¸€å®šä¼šæ„Ÿåˆ°å¾ˆé«˜å…´ã€‚è¿‡äº†å‡ å¤©ï¼Œä½ å»å‚åŠ å®¶é•¿ä¼šï¼Œå‘ç°é‚£æ¬¡è€ƒè¯•å…¨ç­ 30 ä¸ªå­©å­æœ‰ 29 ä¸ªè€ƒäº†æ»¡åˆ†ï¼Œé‚£ä¹ˆæ­¤æ—¶æˆ‘ä»¬å¯èƒ½å°±ä¸ä¼šé‚£ä¹ˆé«˜å…´äº†ã€‚</p>
<p>æŠ€æœ¯å˜åŒ–å¾ˆå¿«ï¼Œå„ç±»äº§å“å±‚å‡ºä¸ç©·ï¼Œç”¨æˆ·çš„é¢„æœŸä¹Ÿéšç€ç”¨æˆ·è‡ªæˆ‘è®¤çŸ¥çš„æé«˜è€Œä¸æ–­å˜åŒ–ã€‚<strong>æ‰€ä»¥ç”¨æˆ·é¢„æœŸå¹¶ä¸æ˜¯ä¸€æˆä¸å˜çš„ï¼Œè€Œæ˜¯éšç€ç”¨æˆ·è‡ªæˆ‘è®¤çŸ¥çš„å˜åŒ–è€Œä¸æ–­å˜åŒ–</strong>ã€‚è¿™è¦æ±‚æˆ‘ä»¬åœ¨å¯¹å¾…ç”¨æˆ·é¢„æœŸæ—¶ï¼Œå³ä¸èƒ½åˆ»èˆŸæ±‚å‰‘ï¼Œä¹Ÿä¸èƒ½åäº•è§‚å¤©ï¼Œè€Œæ˜¯è¦ç”¨å‘å±•çš„çœ¼å…‰çœ‹å¾…ç”¨æˆ·é¢„æœŸçš„å˜åŒ–ã€‚</p>
<p>æ‰€ä»¥ï¼Œåˆ†æåˆ°æ­¤å¤„ï¼Œæˆ‘ä»¬æ‰å‘ç°äº†è¿™ä¹ˆå¤šå¹´ä»¥æ¥ï¼Œ<code>æˆ‘ä»¬åšäº§å“è¯„æµ‹çš„ç¬¬ä¸€å¤§è¯¯åŒº</code>ï¼šè¯„æµ‹çš„æœ¬è´¨åº”è¯¥å»æ¢æµ‹ç”¨æˆ·çš„é¢„æœŸï¼Œè€Œä¸æ˜¯å»å¯¹æ¯”äº§å“ä¹‹é—´çš„æŸä¸ªå…·ä½“åŠŸèƒ½çš„å·®å¼‚ã€‚é¢„æœŸæ˜¯éšç€äººçš„ä¸åŒè€Œä¸æ–­å˜åŒ–çš„ï¼Œæ˜¯åˆ†äººç¾¤çš„ï¼Œæ˜¯å› äººè€Œå¼‚çš„ï¼›ä½†æ˜¯ä¸åŒäº§å“ä¹‹é—´çš„åŠŸèƒ½å·®å¼‚æ˜¯å›ºå®šçš„ï¼Œæ˜¯ä¸å› äººè€Œå¼‚çš„ã€‚</p>
<h4 id="ux">UX</h4>
<p>UX æ˜¯å¼ºæœ‰åŠ›çš„ç²˜åˆå‰‚ï¼Œæ˜¯äº§å“å®é™…èƒ½åŠ›å’Œç”¨æˆ·é¢„æœŸä¹‹é—´çš„æ¶¦æ»‘å‰‚ã€‚å½“ç”¨æˆ·é¢„æœŸå’Œäº§å“çš„å®é™…èƒ½åŠ›ä¹‹é—´å‡ºç°äº†åå·®çš„æ—¶å€™ï¼Œé‚£ä¹ˆå°±éœ€è¦ä¾é å¼ºå¤§çš„ UX æ¥è¿›è¡Œä¸€å®šçš„è¡¥å¿ï¼Œä»¥é¿å…æ„ŸçŸ¥ä½“éªŒä¸Šçš„å·¨å¤§è½å·®ã€‚</p>
<p>åœ¨ç”µå½± ã€ŠæŠ“å¨ƒå¨ƒã€‹ä¸­ï¼Œæœ‰ä¸€ä¸ªé©¬ç»§ä¸šå¸¦ç€å¥¶å¥¶å’Œå¦ˆå¦ˆå»åƒæµ·åº•æçš„ç‰‡æ®µï¼š</p>
<blockquote>
<p>é©¬ç»§ä¸šé’±èŠ±å®Œäº†ï¼Œæ²¡é’±ä¹°èœï¼Œäºæ˜¯å°±å¸¦ç€å¥¶å¥¶å’Œå¦ˆå¦ˆå»æµ·å¾—ææ”¹å–„ä¸‹ä¼™é£Ÿï¼ˆæ’é˜Ÿå°±é¤æ—¶æµ·å¾—ææä¾›çš„å…è´¹çš„é¥®æ–™å’Œé›¶é£Ÿï¼‰ï¼Œå½“æœåŠ¡å‘˜è¯´å¯ä»¥è¿›å»ç”¨é¤çš„æ—¶å€™ï¼Œé©¬ç»§ä¸šè¿å¿™è¯´ï¼šä¸ç”¨ä¸ç”¨ï¼Œæˆ‘ä»¬è¿˜æƒ³å¤šæ’ä¸€ä¼šå‘¢â€¦â€¦</p>
</blockquote>
<div class="bili_video"><div style="position: relative; width: 100%; height: 0; padding-bottom: 75%;"><iframe src="https://player.bilibili.com/player.html?aid=1906408958&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position: absolute; width: 100%; height: 100%; left: 0; top: 0;"> </iframe></div></div>
<p>ä»è¿™ä¸ªå±‚é¢æ¥çœ‹ï¼Œæˆ‘ä»¬å‘ç° Loading åŠ¨ç”»æ˜¯ UX æœ€ä¼Ÿå¤§çš„å‘æ˜ä¹‹ä¸€ã€‚</p>
<h2 id="è¯„æµ‹åŸºæœ¬æ¨¡å‹ä¸­çš„-f">è¯„æµ‹åŸºæœ¬æ¨¡å‹ä¸­çš„ <em>f</em></h2>
<p>åœ¨è¯„æµ‹çš„åŸºæœ¬æ¨¡å‹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Perception</mtext><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mtext>Actual</mtext><mo separator="true">,</mo><mtext>Â Expected</mtext><mo separator="true">,</mo><mtext>Â UX</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{Perception} = f(\text{Actual}, \ \text{Expected}, \ \text{UX})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord text"><span class="mord">Perception</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord text"><span class="mord">Actual</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace">Â </span><span class="mord text"><span class="mord">Expected</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace">Â </span><span class="mord text"><span class="mord">UX</span></span><span class="mclose">)</span></span></span></span> ä¸­ï¼Œé™¤äº†æˆ‘ä»¬ä¸Šé¢ä»‹ç»çš„æ„ŸçŸ¥ä½“éªŒä¸‰è¦ç´ å¤–ï¼Œæ„ŸçŸ¥ä½“éªŒä¸‰è¦ç´ çš„ç»„åˆæ–¹å¼ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span></span></span></span> ä¹Ÿæ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„ã€æˆ‘ä»¬å®¹æ˜“å¿½ç•¥çš„å› ç´ ã€‚</p>
<p>åœ¨åŒä¸€ä¸ªåæ ‡ç³»ä¹‹ä¸­ï¼Œå³ä¾¿å¯¹äºæ˜¯ç›¸åŒçš„è‡ªå˜é‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span>ï¼Œå¦‚æœ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span></span></span></span> ä¸åŒï¼Œé‚£ä¹ˆå› å˜é‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y = f(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span></span> ä¹Ÿå°†ä¸åŒã€‚</p>
<p><img src="/2024/08/17/The-Basic-Model-for-the-Product-Evaluation/3.png" alt></p>
<p>å¯¹äºè¯„æµ‹çš„åŸºæœ¬æ¨¡å‹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Perception</mtext><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mtext>Actual</mtext><mo separator="true">,</mo><mtext>Â Expected</mtext><mo separator="true">,</mo><mtext>Â UX</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{Perception} = f(\text{Actual}, \ \text{Expected}, \ \text{UX})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord text"><span class="mord">Perception</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord text"><span class="mord">Actual</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace">Â </span><span class="mord text"><span class="mord">Expected</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace">Â </span><span class="mord text"><span class="mord">UX</span></span><span class="mclose">)</span></span></span></span> ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œå³ä¾¿æ„ŸçŸ¥ä½“éªŒçš„ä¸‰è¦ç´ ç›¸åŒï¼Œå¯¹ç€ä¸‰è¦ç´ çš„ä¸åŒç»„åˆæ–¹å¼å¸¦æ¥çš„æ„ŸçŸ¥ä½“éªŒä¹Ÿä¸åŒã€‚æ­£å¦‚ <a href="https://baike.baidu.com/item/%E7%94%B0%E5%BF%8C%E8%B5%9B%E9%A9%AC/1137056">ç”°å¿Œèµ›é©¬</a> çš„å…¸æ•…ä¸­æ‰€è¯´çš„é‚£æ ·ï¼š</p>
<blockquote>
<p>å­™å­æ›°ï¼šä»Šä»¥å›ä¹‹ä¸‹é©·ä¸å½¼ä¸Šé©·ï¼Œå–å›ä¸Šé©·ä¸å½¼ä¸­é©·ï¼Œå–å›ä¸­é©·ä¸å½¼ä¸‹é©·ã€‚æ—¢é©°ä¸‰è¾ˆæ¯•ï¼Œè€Œç”°å¿Œä¸€ä¸èƒœè€Œå†èƒœï¼Œå’å¾—ç‹åƒé‡‘ã€‚</p>
</blockquote>
<p>è¦ç´ å¾ˆé‡è¦ï¼Œä½†æ˜¯è¦ç´ çš„ç»„æˆæ–¹å¼å’Œæ„æˆç»“æ„æ›´ä¸ºé‡è¦ã€‚æ­£å¦‚æˆ‘åœ¨ <a href="/2023/07/09/My-practice-of-working-backwards/">æˆ‘çš„ â€œé€†å‘å·¥ä½œâ€ å®è·µ</a> ä¸­æåˆ°çš„é‚£æ ·ï¼š</p>
<blockquote>
<p>å¯¹äºå®ç°ç‰¹å®šç›®æ ‡çš„ç³»ç»Ÿè€Œè¨€ï¼Œè¦ç´ å¾ˆé‡è¦ï¼Œä½†æ˜¯è¿æ¥æ›´ä¸ºé‡è¦ã€‚ç»“æ„å†³å®šæ€§è´¨ï¼Œæ€§è´¨å†³å®šç”¨é€”ï¼Œå°±æ˜¯è¿™ä¸ªæ ·å­ã€‚åŒæ ·éƒ½æ˜¯ç”± <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span></span> åŸå­æ„æˆï¼ŒçŸ³å¢¨å’Œé’»çŸ³çš„ç»“æ„ä¸åŒå†³å®šäº†å…¶æ€§è´¨å­˜åœ¨éå¸¸å¤§çš„å·®å¼‚ã€‚</p>
<p><img src="/2023/07/09/My-practice-of-working-backwards/7.png" alt></p>
<p>å›¾ç‰‡ä¸­çš„ç»“æ„æ¨¡å‹ç”± <a href="https://molview.org/">molview</a> å·¥å…·ç”Ÿæˆã€‚</p>
</blockquote>
<p>åˆ°æ­¤ï¼Œæˆ‘ä»¬ä¹Ÿå‘ç°äº†è¿™ä¹ˆå¤šå¹´æ¥ï¼Œ<code>æˆ‘ä»¬åšäº§å“è¯„æµ‹çš„ç¬¬äºŒå¤§è¯¯åŒº</code>ï¼šäº§å“è¯„æµ‹åº”è¯¥å»æ¢æµ‹å¦‚ä½•ç»„åˆæ„ŸçŸ¥ä½“éªŒçš„ä¸‰è¦ç´ ï¼Œä»è€Œè®©äº§å“è·å¾—æœ€ä¼˜çš„æ„ŸçŸ¥ä½“éªŒï¼›è€Œä¸æ˜¯å»å¯¹æ¯”äº§å“ä¹‹é—´çš„æŸä¸ªå…·ä½“åŠŸèƒ½çš„å·®å¼‚ã€‚å¦‚ä½•å°†æŸä¸€è¦ç´ çš„é¢†å…ˆä¼˜åŠ¿å‘æŒ¥åˆ°æè‡´ã€é‡‡ç”¨ä»€ä¹ˆæ ·çš„ç»“æ„èƒ½å¤Ÿé¿å…æŸä¸€è¦ç´ çš„ä¸è¶³ï¼Œè¿™æ‰æ˜¯äº§å“è¯„æµ‹æ›´åº”è¯¥å…³æ³¨çš„äº‹æƒ…ã€‚</p>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>å›å¤´æƒ³æƒ³ï¼Œæˆ‘ä»¬å‘ç° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Perception</mtext><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mtext>Actual</mtext><mo separator="true">,</mo><mtext>Â Expected</mtext><mo separator="true">,</mo><mtext>Â UX</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{Perception} = f(\text{Actual}, \ \text{Expected}, \ \text{UX})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord text"><span class="mord">Perception</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord text"><span class="mord">Actual</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace">Â </span><span class="mord text"><span class="mord">Expected</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace">Â </span><span class="mord text"><span class="mord">UX</span></span><span class="mclose">)</span></span></span></span> è¿™ä¸ªæ¨¡å‹æºè‡ªä¸€æ¬¡è¯„æµ‹ä¸­çš„æ•°æ®ä¸ä¸€è‡´æ€§ï¼Œè¿™ä¹Ÿè®©æˆ‘æƒ³èµ·äº†ä¸€å¥è¯ï¼šåˆ›æ–°æºè‡ªå¼‚ç§æ–‡åŒ–ä¹‹é—´çš„æ€æƒ³ç¢°æ’ã€‚å½“æ•°æ®å‡ºç°ä¸ä¸€è‡´çš„æ—¶å€™ï¼Œå¯èƒ½å°±æ˜¯åˆ›æ–°å¼€å§‹çš„æ—¶å€™ã€‚</p>
]]></content>
      <categories>
        <category>æ€»ç»“</category>
      </categories>
      <tags>
        <tag>äº§å“è¯„æµ‹</tag>
        <tag>ç”¨æˆ·ä½“éªŒ</tag>
      </tags>
  </entry>
  <entry>
    <title>éŸ³é¢‘è´¨é‡è¯„ä¼°ä¸­çš„ ABX æµ‹è¯•</title>
    <url>/2024/04/04/ABX-test-in-the-Audio-Quality-Assessment/</url>
    <content><![CDATA[<p><img src="/2024/04/04/ABX-test-in-the-Audio-Quality-Assessment/1.jpeg" alt></p>
<p>åœ¨éŸ³é¢‘ç¼–è§£ç ä¸­ï¼Œç»å¸¸éœ€è¦åˆ¤æ–­ç»è¿‡ä¸åŒçš„ç¼–è§£ç ç®—æ³•ã€å‚æ•°è€Œç”Ÿæˆçš„éŸ³é¢‘åœ¨äººçš„æ„ŸçŸ¥å±‚é¢æ˜¯å¦å­˜åœ¨å·®å¼‚ã€‚è™½ç„¶ <a href="2023/08/12/the-interesting-elo-rating-system/">æˆå¯¹æ‰“åˆ†</a> ä¹Ÿå¯ä»¥ç”¨äºè¿™ç§åœºæ™¯ï¼Œä½†æ˜¯æˆå¯¹æ¯”è¾ƒçš„ç»“æœå¯èƒ½ä¼šæ¶‰åŠåˆ°å¾ˆå¤šæ— æ„è¯†çš„å½±å“å› ç´ ï¼Œä¾‹å¦‚ä¸åŒå—è¯•è€…çš„ç»éªŒã€å¿ƒæƒ…ç­‰ã€‚å¦‚æœå—è¯•è€…é‡‡ç”¨éšæœºé€‰æ‹©çš„ç­–ç•¥ï¼Œå¯¹äºæˆå¯¹æ¯”è¾ƒè€Œè¨€ï¼Œåˆ™ç¼ºä¹æœ‰æ•ˆçš„æ‰‹æ®µæ¥å¯¹å…¶è¿›è¡Œè¯†åˆ«ã€‚</p>
<span id="more"></span>
<h2 id="æˆå¯¹æ‰“åˆ†æ³•çš„ç¼ºç‚¹">æˆå¯¹æ‰“åˆ†æ³•çš„ç¼ºç‚¹</h2>
<p>æˆ‘ä»¬å¯ä»¥åœ¨æˆå¯¹æ‰“åˆ†ä¸­å¼•å…¥<strong>é”šç‚¹æ ·æœ¬</strong>æ¥è¯„ä¼°å—è¯•è€…çš„æ‰“åˆ†æ˜¯å¦ç½®ä¿¡ï¼Œä½†æ˜¯ä¸ºäº†é¿å…è¯„ä¼°è¿‡ç¨‹ä¸­çš„æ„ŸçŸ¥ç–²åŠ³å¯¹å—è¯•è€…å¸¦æ¥å¹²æ‰°ï¼Œæˆ‘ä»¬å¼•å…¥çš„<strong>é”šç‚¹æ ·æœ¬</strong>å¿…é¡»æ§åˆ¶åœ¨ä¸€å®šé‡çº§ï¼Œæ¯”å¦‚ 2 ä¸ªã€‚</p>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition note"><p class="admonition-title">é”šç‚¹æ ·æœ¬
</p><p>é”šç‚¹æ ·æœ¬æŒ‡çš„æ˜¯åœ¨ä¸€ä¸ªå¾…è¯„ä¼°çš„æ ·æœ¬åºåˆ—ä¸­ï¼Œéšæœºæ’å…¥çš„ã€æœ‰æ˜æ˜¾è´¨é‡å·®å¼‚çš„ã€æœ‰é¢„å…ˆè®¾å®šå¥½æ‰“åˆ†çš„æ ·æœ¬ã€‚</p>
</div>
<p>åœ¨è¯„ä¼°è¿‡ç¨‹ä¸­ï¼Œä¸€ç»„æ ·æœ¬ï¼ˆAï¼ŒBï¼‰è¦ä¹ˆæ˜¯æœ‰å·®å¼‚çš„ï¼Œè¦ä¹ˆæ˜¯æ²¡æœ‰å·®å¼‚çš„ï¼Œå› æ­¤ç»“æœæ˜¯ä¸€ä¸ªå…¸å‹çš„<a href="https://baike.baidu.com/item/0%E2%80%941%E5%88%86%E5%B8%83">ä¼¯åŠªåˆ©åˆ†å¸ƒ</a>ã€‚å½“é”šç‚¹æ ·æœ¬æ•°é‡ä¸º 2 æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„ä»£ç æ¥è®¡ç®—éšæœºå› ç´ ä¸‹çš„æ‰“åˆ†æ­£ç¡®çš„æ¦‚ç‡ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> scipy.stats <span class="keyword">import</span> binom</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    x = binom.pmf(k, <span class="number">2</span>, <span class="number">0.5</span>)</span><br><span class="line">    <span class="built_in">print</span>(x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 0.25 0.5 0.25</span></span><br></pre></td></tr></table></figure>
<p>å¯çŸ¥ï¼Œå³ä¾¿ä¸¤ä¸ªé”šç‚¹æ ·æœ¬çš„æ‰“åˆ†éƒ½æ˜¯æ­£ç¡®çš„ï¼Œé‚£ä¹ˆä¹Ÿå¯èƒ½æœ‰ 25% çš„æ¦‚ç‡æ˜¯å—è¯•è€…åœ¨éšæœºæ‰“åˆ†çš„æƒ…å†µä¸‹åšå‡ºçš„é€‰æ‹©ã€‚</p>
<h2 id="abx-æµ‹è¯•">ABX æµ‹è¯•</h2>
<p>å’Œ <strong>æˆå¯¹æ‰“åˆ†</strong> ç±»ä¼¼ï¼ŒABX æµ‹è¯•æ˜¯ä¸€ç§åˆ¤æ–­ä¸¤ä¸ªä¿¡å·ï¼ˆä¾‹å¦‚è§†è§‰ã€å¬è§‰ã€å—…è§‰ç­‰ä¿¡å·ï¼‰ä¹‹é—´æ˜¯å¦å­˜åœ¨æ„ŸçŸ¥å·®å¼‚çš„ä¸€ç§è¯„ä¼°æ–¹æ³•ã€‚</p>
<p>åœ¨ ABX æµ‹è¯•ä¸­ï¼Œä¼šå…ˆå°†ä¸¤ä¸ªå·²çŸ¥çš„æ ·æœ¬ï¼ˆåˆ†åˆ«ä¸ºæ ·æœ¬Aå’Œæ ·æœ¬Bï¼‰å‘ˆç°ç»™å—è¯•è€…ï¼Œç„¶åä»Aã€Bä¸­éšæœºé€‰æ‹©ä¸€ä¸ªæ ·æœ¬ä½œä¸ºæœªçŸ¥æ ·æœ¬ X å‘ˆç°ç»™å—è¯•è€…ã€‚å—è¯•è€…çš„ç›®æ ‡å°±æ˜¯æ ¹æ®è‡ªå·±çš„æ„ŸçŸ¥ä½“éªŒæ¥åˆ¤æ–­ X ç©¶ç«Ÿæ˜¯ A è¿˜æ˜¯ Bã€‚å¦‚æœåœ¨ä¸€å®šæ¬¡æ•°çš„æµ‹è¯•ä¸­ï¼Œå—è¯•è€…æ— æ³•ä»¥è¾ƒä½çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span> å€¼å¯é åœ°è¯†åˆ«å‡º Xï¼Œåˆ™ä¸èƒ½å¦å®šé›¶å‡è®¾â€”â€”å³æ²¡æœ‰è¶³å¤Ÿçš„è¯æ®è¯æ˜ A ä¸ B ä¹‹é—´å­˜åœ¨å¯æ„ŸçŸ¥çš„å·®å¼‚ã€‚</p>
<p>åœ¨ ABX æµ‹è¯•ä¸­ï¼Œæ ·æœ¬ A å’Œ æ ·æœ¬ B å‡æ˜¯åœ¨æ ·æœ¬ X ä¹‹å‰å‘ˆç°ç»™å—è¯•è€…ï¼Œæ‰€ä»¥å—è¯•è€…æ— éœ€ä¾èµ–é•¿æœŸè®°å¿†æˆ–è¿‡å»çš„ç»éªŒæ¥è¾¨åˆ«å·®å¼‚ï¼Œè¿™å¯ä»¥æ¶ˆé™¤å…¶ä»–è¯„ä¼°æ–¹å¼ä¸­å­˜åœ¨çš„æ— æ„è¯†å½±å“å› ç´ ã€‚</p>
<p>åŒæ—¶ï¼Œåœ¨ ABX æµ‹è¯•ä¸­ï¼Œé™¤äº†ä¼ ç»Ÿçš„æ­£ç¡®ç‡æŒ‡æ ‡å¤–ï¼Œè¿˜ä¼šé€šè¿‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span> å€¼æ¥è¿›è¡Œå‡è®¾æ£€éªŒï¼Œä»è€Œå¯ä»¥æœ€å¤§ç¨‹åº¦çš„é¿å…éšæœºå› ç´ å¸¦æ¥çš„è¯¯å·®çš„æ¦‚ç‡ï¼Œè¿›è€Œä½¿å¾—è¯„ä¼°çš„ç»“æœæ›´ä¸ºç½®ä¿¡ã€‚</p>
<p>ABX æµ‹è¯•æœ€æ—©æ˜¯ç”±è´å°”å®éªŒå®¤çš„ä¸¤ä½ç ”ç©¶äººå‘˜ W.a.Munson å’Œ Mark B.Gardner åœ¨ 1950 å¹´å‘è¡¨çš„ <em>Standardizing Auditory Tests</em> è¿™ç¯‡è®ºæ–‡ä¸­æå‡ºçš„éŸ³é¢‘æµ‹è¯•æ–¹æ³•<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup>ã€‚åœ¨è¿™ç¯‡è®ºæ–‡ä¸­ï¼Œä½œè€…æåˆ°ï¼šABX æµ‹è¯•å…¶å®å°±æ˜¯ä¸€ç§æˆå¯¹æ¯”è¾ƒæ–¹å¼çš„å˜ä½“ã€‚</p>
<blockquote>
<p>The procedure, which we have called the â€œABXâ€ test, is a modification of the method of paired comparisons.</p>
</blockquote>
<h2 id="abx-ç»“æœçš„ç»Ÿè®¡åˆ†æ">ABX ç»“æœçš„ç»Ÿè®¡åˆ†æ</h2>
<p>åœ¨è®ºæ–‡ <em>Statistical Analysis of ABX Results Using Signal Detection Theory</em> ä¸­ï¼Œä½œè€…æåˆ°ï¼šè™½ç„¶ ABX æµ‹è¯•ä½œä¸ºä¸€ç§ç®€å•ã€ç›´è§‚çš„è¯„ä¼°éŸ³é¢‘ä¹‹é—´æ˜¯å¦å­˜åœ¨å¯æ„ŸçŸ¥çš„å·®å¼‚çš„æµ‹è¯•æ–¹æ³•å·²ç»å­˜åœ¨äº†å‡ åå¹´ï¼Œä½†æ˜¯åœ¨ç›®å‰çš„ ABX æµ‹è¯•ä¸­ï¼Œè¯„ä¼°è€…å´å¾ˆå°‘æŠ«éœ²è¯„ä¼°ç»“æœçš„ç»Ÿè®¡åˆ†æç»“æœï¼Œè¿™å¯¼è‡´ ABX æµ‹è¯•çš„ç»“è®ºç¼ºä¹ç›¸åº”çš„ç½®ä¿¡åº¦å’Œå¯è§£é‡Šæ€§<sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup>]ã€‚</p>
<p>å› æ­¤ï¼Œåœ¨ ABX æµ‹è¯•ä¸­ï¼Œé™¤äº†ä¸€èˆ¬çš„èšåˆæŒ‡æ ‡å¤–ï¼Œè¿˜éœ€è¦å¯¹è¯„ä¼°ç»“æœè¿›è¡Œç»Ÿè®¡æ¨æ–­ï¼Œä»¥è·å¾—æ›´å¯ä¿¡çš„è¯„ä¼°ç»“æœã€‚ä¾‹å¦‚ <a href="https://abxtests.com/">ABXTEST.COM</a> æä¾›çš„ ABX æµ‹è¯•ä¸­ï¼Œå°±ä¼šåŒ…å« <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span> å€¼è®¡ç®—ç»“æœ<sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup>ã€‚</p>
<p>å¦‚å‰æ‰€è¿°ï¼ŒABX æµ‹è¯•ä¸­çš„æ‰“åˆ†ç»“æœå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p>
<table>
<thead>
<tr>
<th style="text-align:center">æ ·æœ¬ X æ¥æº</th>
<th style="text-align:center">å—è¯•è€…é€‰æ‹© A</th>
<th style="text-align:center">å—è¯•è€…é€‰æ‹© B</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">A</td>
<td style="text-align:center">æ­£ç¡®</td>
<td style="text-align:center">é”™è¯¯</td>
</tr>
<tr>
<td style="text-align:center">B</td>
<td style="text-align:center">é”™è¯¯</td>
<td style="text-align:center">æ­£ç¡®</td>
</tr>
</tbody>
</table>
<p>å› æ­¤ï¼ŒABX æµ‹è¯•çš„ç»“æœæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªä¼¯åŠªåˆ©åˆ†å¸ƒï¼šè¦ä¹ˆæ‰“åˆ†æ­£ç¡®ï¼Œè¦ä¹ˆæ‰“åˆ†é”™è¯¯ã€‚å…¶ç»“æœçš„æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼ˆ<em>PMF: probability mass function</em>ï¼‰å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo>=</mo><msubsup><mi>C</mi><mi>n</mi><mi>k</mi></msubsup><msup><mi>p</mi><mi>k</mi></msup><mo stretchy="false">(</mo><mn>1</mn><mo>âˆ’</mo><mi>p</mi><msup><mo stretchy="false">)</mo><mrow><mi>n</mi><mo>âˆ’</mo><mi>k</mi></mrow></msup></mrow><annotation encoding="application/x-tex">f(k) = C_{n}^{k}p^{k}(1-p)^{n-k}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.149108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999998em;"><span style="top:-2.4530000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.149108em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">âˆ’</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>å…¶ä¸­ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> è¡¨ç¤ºå®éªŒæ¬¡æ•°ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span> è¡¨ç¤ºæ­£ç¡®æ¬¡æ•°ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span> è¡¨ç¤ºæ¯æ¬¡å®éªŒæ­£ç¡®çš„æ¦‚ç‡ã€‚</p>
<h3 id="abx-çš„ç½®ä¿¡åŒºé—´">ABX çš„ç½®ä¿¡åŒºé—´</h3>
<p>å¦‚æœæŸæ¬¡ ABX æµ‹è¯•åŒ…å« 10 ä¸ªæµ‹è¯•æ ·æœ¬ï¼ŒæŸä¸ªå—è¯•è€…æ‰“åˆ†æ­£ç¡®çš„æ ·æœ¬ä¸ªæ•°ä¸º 8ï¼Œé‚£ä¹ˆèƒ½è¯´æ˜ A ä¸ B ä¹‹é—´å­˜åœ¨å¯æ„ŸçŸ¥çš„å·®å¼‚å—ï¼Ÿä¸€ä¸ªç”¨æˆ·å¯ä»¥ä»¥ 80%ï¼ˆ8/10ï¼‰çš„æ­£ç¡®ç‡æ¥è¯†åˆ«å‡ºæ ·æœ¬ X çš„æ¥æºï¼Œè¿™ä¹ˆé«˜çš„æ­£ç¡®ç‡éš¾é“è¿˜ä¸è¶³ä»¥è¯æ˜ A ä¸ B ä¹‹é—´å­˜åœ¨å¯æ„ŸçŸ¥çš„å·®å¼‚å—ï¼Ÿ</p>
<p>æˆ‘ä»¬å¯ä»¥ç”¨å¦‚ä¸‹çš„ä»£ç è®¡ç®— 10 æ¬¡å®éªŒæ‰€å¯¹åº”çš„ä¼¯åŠªåˆ©çš„æ¦‚ç‡åˆ†å¸ƒå›¾ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt </span><br><span class="line"><span class="keyword">import</span> scipy.stats</span><br><span class="line"></span><br><span class="line">X = []</span><br><span class="line">Y = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">11</span>):</span><br><span class="line">    Y.append(stats.binom.pmf(i, <span class="number">10</span>, <span class="number">0.5</span>))</span><br><span class="line">    X.append(i)</span><br><span class="line">plt.bar(X, Y)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2024/04/04/ABX-test-in-the-Audio-Quality-Assessment/10_binom_p_d.png" alt="å›¾1 æ¦‚ç‡åˆ†å¸ƒ"></p>
<p>ä» å›¾1 ä¸­å¯ä»¥çœ‹å‡ºï¼Œå¦‚æœå‡è®¾ï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">H_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼‰å—è¯•è€…æ˜¯æŒ‰ç…§å®Œå…¨éšæœºçš„æƒ…å†µæ¥æ‰“åˆ†ï¼Œé‚£ä¹ˆå‡ºç° 8 æ¬¡æ‰“åˆ†æ­£ç¡®çš„æ¦‚ç‡å°±æ˜¯ 0.044ï¼ˆ4.4%ï¼‰ï¼Œè¿™çœ‹èµ·æ¥ç¡®å®æ˜¯ä¸€ä¸ªæ¯”è¾ƒå°çš„æ¦‚ç‡ã€‚æ¢å¥è¯è¯´ï¼Œå¦‚æœå‡ºç°äº† 8 æ¬¡æ­£ç¡®çš„æ‰“åˆ†çš„æƒ…å†µï¼Œé‚£ä¹ˆè¯¥ç»“æœæ˜¯å—è¯•è€…æŒ‰ç…§å®Œå…¨éšæœºçš„æƒ…å†µæ¥æ‰“åˆ†çš„æ¦‚ç‡æ˜¯ 4.4%ï¼Œè¿™ä¸ªæ¦‚ç‡æ¯”å‡ºç° 7 æ¬¡æ­£ç¡®æ‰“åˆ†çš„æ¦‚ç‡ï¼ˆ11.7%ï¼‰è¦æ›´ç½®ä¿¡ã€‚</p>
<p>é‚£ä¹ˆå¯¹äºä¸åŒå®éªŒæ¬¡æ•°çš„æƒ…å†µï¼Œæˆ‘ä»¬æ˜¯å¦è¦æ±‚ 80% çš„æ‰“åˆ†æ­£ç¡®ç‡æ‰èƒ½æ‹’ç» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">H_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„ä»£ç è·å–åœ¨ç½®ä¿¡åº¦ä¸º 95% çš„æƒ…å†µä¸‹ï¼Œä¸åŒçš„å®éªŒæ¬¡æ•°è‡³å°‘éœ€è¦å‡ºç°å¤šå°‘æ¬¡æ­£ç¡®çš„æ‰“åˆ†æ‰èƒ½æ‹’ç» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">H_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> scipy.stats </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>, <span class="number">26</span>):</span><br><span class="line">    p_value = stats.binom.interval(<span class="number">0.95</span>, i, <span class="number">0.5</span>)</span><br><span class="line">    <span class="built_in">print</span>(i, p_value[<span class="number">1</span>], p_value[<span class="number">1</span>] * <span class="number">1.0</span> / i)</span><br></pre></td></tr></table></figure>
<p>å…·ä½“ç»“æœå¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th style="text-align:center">å®éªŒæ¬¡æ•°</th>
<th style="text-align:center">10</th>
<th style="text-align:center">20</th>
<th style="text-align:center">40</th>
<th style="text-align:center">80</th>
<th style="text-align:center">160</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">æœ€å°æ­£ç¡®æ¬¡æ•°</td>
<td style="text-align:center">8</td>
<td style="text-align:center">14</td>
<td style="text-align:center">26</td>
<td style="text-align:center">49</td>
<td style="text-align:center">92</td>
</tr>
<tr>
<td style="text-align:center">æœ€å°æ­£ç¡®ç‡</td>
<td style="text-align:center">80%</td>
<td style="text-align:center">70%</td>
<td style="text-align:center">65%</td>
<td style="text-align:center">61.25%</td>
<td style="text-align:center">57.5%</td>
</tr>
</tbody>
</table>
<p>å¯è§ï¼Œå½“å®éªŒæ¬¡æ•°ä¸º 40 çš„æ—¶å€™ï¼Œæˆ‘ä»¬åªéœ€è¦ 65% çš„æ‰“åˆ†æ­£ç¡®ç‡å°±å¯ä»¥è¾¾åˆ° 95% çš„ç½®ä¿¡åº¦ã€‚</p>
<h3 id="abx-çš„ç´¯ç§¯æ¦‚ç‡åˆ†å¸ƒ">ABX çš„ç´¯ç§¯æ¦‚ç‡åˆ†å¸ƒ</h3>
<p>ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å¦‚ä¸‹çš„ä»£ç è®¡ç®— 10 æ¬¡å®éªŒå¯¹åº”çš„ä¼¯åŠªåˆ©çš„ç´¯ç§¯æ¦‚ç‡åˆ†å¸ƒï¼ˆ<em>CDF: cumulative distribution function</em>ï¼‰å’Œé€†ç´¯ç§¯æ¦‚ç‡åˆ†å¸ƒï¼ˆ<em>ICDF: inverse cumulative distribution function</em>ï¼‰ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> scipy.stats</span><br><span class="line"></span><br><span class="line">X = []</span><br><span class="line">PMF = []</span><br><span class="line">CDF = [] </span><br><span class="line">ICDF = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">11</span>):</span><br><span class="line">    PMF.append(scipy.stats.binom.pmf(i, <span class="number">10</span>, <span class="number">0.5</span>))</span><br><span class="line">    CDF.append(scipy.stats.binom.cdf(i, <span class="number">10</span>, <span class="number">0.5</span>))</span><br><span class="line">    X.append(i)</span><br><span class="line"></span><br><span class="line">ICDF.append(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    ICDF.append(<span class="number">1</span> - CDF[i])</span><br></pre></td></tr></table></figure>
<p><img src="/2024/04/04/ABX-test-in-the-Audio-Quality-Assessment/CDF_ICDF.jpg" alt="å›¾2 ç´¯ç§¯æ¦‚ç‡åˆ†å¸ƒå’Œé€†ç´¯ç§¯æ¦‚ç‡åˆ†å¸ƒ"></p>
<p>ä» å›¾2 ä¸­å¯ä»¥çœ‹å‡ºï¼Œå½“å®éªŒæ¬¡æ•°ä¸º 10 æ¬¡æ—¶ï¼Œè‡³å°‘æœ‰ 8 æ¬¡æ‰“åˆ†æ­£ç¡®çš„æ¦‚ç‡ä¸º 5.5%ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœå—è¯•è€…åœ¨éšæœºæ‰“åˆ†çš„æƒ…å†µä¸‹ï¼Œå…¶è‡³å°‘æœ‰ 8 æ¬¡æ‰“åˆ†æ­£ç¡®çš„æ¦‚ç‡æ˜¯ 5.5%ï¼Œè€Œå½“æ­£ç¡®æ‰“åˆ†æ¬¡æ•°æå‡è‡³ 9 æ¬¡æ—¶ï¼Œå…¶æ¦‚ç‡åˆ™é™ä½ä¸º 1.1%ã€‚</p>
<h3 id="abx-çš„-p-å€¼">ABX çš„ p å€¼</h3>
<p>æˆ‘ä»¬å¯ä»¥å¯¹è§‚å¯Ÿåˆ°çš„æ‰“åˆ†ç»“æœæ ·æœ¬è®¡ç®—å…¶ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span> å€¼ï¼Œä»è€Œæ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨è¶³å¤Ÿçš„è§‚æµ‹æ­£ç¡®æ¥å…è®¸æˆ‘ä»¬æ‹’ç» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">H_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ã€‚</p>
<p>æ ¹æ® <em>Improving Your Statistical Inferences</em> ä¸­çš„ ç¬¬ä¸€ç« ä¸­å¯¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span> å€¼çš„ä»‹ç»<sup class="footnote-ref"><a href="#fn4" id="fnref4">[4]</a></sup>ï¼š</p>
<blockquote>
<p>åœ¨åŒºåˆ†ä¿¡å·å’Œå™ªç‚¹æ—¶ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span> å€¼æ˜¯ä½œä¸ºé˜²æ­¢è¢«éšæœºå› ç´ è¯±å¯¼çš„ç¬¬ä¸€é“é˜²çº¿ã€‚</p>
<p>å¹¶ä¸”æœ‰è¿¹è±¡è¡¨æ˜ï¼Œç¦æ­¢ä½¿ç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span> å€¼å°†ä¼šä½¿å¾—ç ”ç©¶è€…æ›´å®¹æ˜“åšå‡ºé”™è¯¯ç»“è®ºã€‚</p>
<p>ç ”ç©¶è€…æå‡ºå·®å¼‚æ€§è¯´æ˜æ—¶ï¼Œå¦‚æœå‡è®¾æ£€éªŒæ–¹æ³•ä½¿ç”¨å¾—å½“ï¼Œæ˜¯å¯ä»¥æœ‰æ•ˆæ§åˆ¶ç ”ç©¶è€…è‡ªæ¬ºæ¬ºäººçš„ã€‚</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> scipy.stats</span><br><span class="line"></span><br><span class="line">k = []</span><br><span class="line">p = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">11</span>):</span><br><span class="line">    p_value = scipy.stats.binomtest(i, <span class="number">10</span>, <span class="number">0.5</span>)</span><br><span class="line">    k.append(i)</span><br><span class="line">    p.append(p_value.pvalue)</span><br><span class="line"></span><br><span class="line">plt.bar(k, p)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2024/04/04/ABX-test-in-the-Audio-Quality-Assessment/p_value.png" alt="å›¾3 å¯¹äº 10 æ¬¡å®éªŒï¼Œä¸åŒæˆåŠŸæ¬¡æ•°å¯¹åº”çš„ p å€¼"></p>
<p>ä» å›¾3 ä¸­å¯ä»¥çœ‹å‡ºï¼Œå½“å®éªŒæ¬¡æ•°ä¸º 10 æ¬¡æ—¶ï¼Œå¦‚æœæœ‰ 8 æ¬¡æ‰“åˆ†æ­£ç¡®æ—¶ï¼Œå…¶ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span> å€¼æ˜¯ 10.9%ï¼Œè€Œæœ‰ 9 æ¬¡æ­£ç¡®æ‰“åˆ†æ—¶ï¼Œå…¶ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span> å€¼ä¸º 2.1%ã€‚å¦‚æœæˆ‘ä»¬å– <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î±</mi><mo>=</mo><mn>0.05</mn></mrow><annotation encoding="application/x-tex">\alpha = 0.05</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">Î±</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">5</span></span></span></span>ï¼Œåˆ™å½“æ­£ç¡®æ‰“åˆ†æ¬¡æ•°ä¸º 9 æ¬¡æ—¶ï¼Œæˆ‘ä»¬è®¤ä¸ºæ­¤æ—¶å­˜åœ¨è¶³å¤Ÿçš„è¯æ®æ‹’ç» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">H_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œå³è®¤ä¸º A ä¸ B ä¹‹é—´å­˜åœ¨å¯æ„ŸçŸ¥çš„å·®å¼‚ã€‚ å½“ç„¶ï¼Œä»æ¦‚ç‡çš„è§’åº¦æ¥è¯´ï¼Œå³ä¾¿æ˜¯ 9 æ¬¡æ‰“åˆ†æ­£ç¡®ä¹Ÿæ˜¯å­˜åœ¨å—è¯•è€…éšæœºæ‰“åˆ†çš„å¯èƒ½æ€§ï¼Œåªæ˜¯æˆ‘ä»¬è¯´è¿™ç§å¯èƒ½æ€§æ¯”è¾ƒå°è€Œå·²ã€‚</p>
<p>å› æ­¤ï¼Œåœ¨ ABX æµ‹è¯•æŠ¥å‘Šä¸­ï¼Œé™¤äº†èšç±»ç±»ç»Ÿè®¡ä¿¡æ¯å¤–ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æŠ«éœ²æ›´å¤šçš„ç»Ÿè®¡æ¨æ–­çš„æŒ‡æ ‡ï¼Œä¾‹å¦‚ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span> å€¼ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î±</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">Î±</span></span></span></span> å€¼ï¼Œç½®ä¿¡åŒºé—´ç­‰ï¼Œä»¥ä¾¿è®©ç»“æœæ›´å…·å¤‡å¯è§£é‡Šæ€§ã€‚</p>
<h2 id="abx-æµ‹è¯•éœ€è¦å…³æ³¨çš„äº‹é¡¹">ABX æµ‹è¯•éœ€è¦å…³æ³¨çš„äº‹é¡¹</h2>
<h3 id="æ ·æœ¬å¤§å°éœ€è¦æ§åˆ¶">æ ·æœ¬å¤§å°éœ€è¦æ§åˆ¶</h3>
<p>æ ¹æ® QSC çš„å»ºè®®ï¼šåœ¨è¿›è¡Œ ABX æµ‹è¯•æ—¶ï¼Œæ ·æœ¬çš„å¤§å°ä¸€èˆ¬å¯ä»¥ä¸º 10~25 ä¸ªï¼Œå› ä¸ºè¿‡å¤šçš„æ ·æœ¬ä¼šå¯¼è‡´å—è¯•è€…å¯èƒ½ä¼šå‡ºç°ç–²åŠ³ï¼Œè¿™ä¼šé™ä½æµ‹è¯•çš„æ•æ„Ÿæ€§ã€‚<sup class="footnote-ref"><a href="#fn5" id="fnref5">[5]</a></sup></p>
<blockquote>
<p>The very minimum number of trials you should do in a session is ten.</p>
<p>Itâ€™s not a good idea to try more than 25 trials in the same sitting with the same listener. After a while, listener fatigue sets in and it gets harder for him or her to concentrate and judge the sound quality.</p>
</blockquote>
<h3 id="abx-æ— æ³•å¾—å‡ºæ— å·®å¼‚çš„ç»“è®º">ABX æ— æ³•å¾—å‡ºæ— å·®å¼‚çš„ç»“è®º</h3>
<p>åœ¨ <em>Improving Your Statistical Inferences</em> çš„ç¬¬ä¸€ç« ä¸­æåˆ°ï¼ŒåŸºäº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span> å€¼æ¨è®ºçš„ç»“æœæ˜¯ä»¥å·²çŸ¥çš„æœ€å¤§è¯¯å·®ç‡ä¸ºåŸºç¡€ï¼Œå› æ­¤ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span> å€¼æ°¸è¿œä¸å…è®¸æˆ‘ä»¬è‚¯å®šåœ°é™ˆè¿°ä»»ä½•äº‹æƒ…ã€‚å³ä¾¿æ¦‚ç‡å†ä½ï¼Œä¹Ÿæœ‰è¢«éšæœºå› ç´ è¯±å¯¼çš„å¯èƒ½<sup class="footnote-ref"><a href="#fn4" id="fnref4:1">[4:1]</a></sup>ã€‚</p>
<blockquote>
<p>Because claims are made using a methodological procedure with known maximum error rates, <strong>a p-value never allows you to state anything with certainty</strong>.</p>
<p>Even if we set the <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î±</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">Î±</span></span></span></span> level to 0.000001, any single claim can be an error, Fisher (<a href="http://tankona.free.fr/fisher1935.pdf">1935</a>) reminds us, â€˜for the â€œone chance in a millionâ€ will undoubtedly occur, with no less and no more than its appropriate frequency, however surprised we may be that it should occur to usâ€.</p>
</blockquote>
<p>ABX åªèƒ½è¯æ˜ A å’Œ B ä¹‹é—´å­˜åœ¨å·®å¼‚ï¼›æˆ‘ä»¬ä¸èƒ½æ ¹æ® <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span> å€¼ä¸è¶³ä»¥è¯æ˜ A å’Œ B ä¹‹é—´å­˜åœ¨å·®å¼‚ï¼Œå°±å¾—å‡º Aå’Œ B ä¹‹é—´æ˜¯æ— å·®å¼‚çš„è¿™ç§è®ºè¿°<sup class="footnote-ref"><a href="#fn2" id="fnref2:1">[2:1]</a></sup>ã€‚</p>
<blockquote>
<p>For example, ABX can only tell you if there is a perceptible difference between two sounds.</p>
<p>It cannot tell you that there is no difference between the sounds.</p>
<p>Do not conclude there is no difference. ABX can only prove differences in audio files, not prove that there is no difference.</p>
</blockquote>
<h3 id="x-å¿…é¡»ç¬¦åˆå‡åŒ€åˆ†å¸ƒ">X å¿…é¡»ç¬¦åˆå‡åŒ€åˆ†å¸ƒ</h3>
<p>åœ¨ ABX æµ‹è¯•ä¸­ï¼Œæˆ‘ä»¬æ€»æ˜¯å¸Œæœ› X çš„æ¥æºæ˜¯éšæœºçš„ï¼Œè¿™æ ·æ‰èƒ½ä»æ ·æœ¬ä¸Šä¿è¯ A å’Œ B ä¹‹é—´æ˜¯æ— åå·®çš„ã€‚è¿˜æ˜¯ä»¥ 10 æ ·æœ¬çš„å®éªŒä¸ºä¾‹ï¼Œå¦‚æœ X ä¿¡å·çš„æ¥æºåˆ†å¸ƒå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<table>
<thead>
<tr>
<th style="text-align:center">X æ ·æœ¬æ•°</th>
<th style="text-align:center">æ¥è‡ª A</th>
<th style="text-align:center">æ¥è‡ª B</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">10</td>
<td style="text-align:center">9</td>
<td style="text-align:center">1</td>
</tr>
</tbody>
</table>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå‡å®šæ¥åœ¨ A çš„ 9 ä¸ªæ ·æœ¬ç”¨æˆ·æ‰“åˆ†å…¨éƒ¨æ­£ç¡®ï¼Œä½†æ˜¯æ¥è‡ª B çš„ 1 ä¸ªæ ·æœ¬ç”¨æˆ·æ‰“åˆ†é”™è¯¯ï¼Œå¦‚æœæˆ‘ä»¬å‡è®¾æ­¤æ—¶ç”¨æˆ·è¿˜æ˜¯ä¼šéšæœºç»™æ¯ä¸ªæ ·æœ¬æ‰“åˆ†ï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">H_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼‰ï¼Œé‚£ä¹ˆä¼šå‡ºç°ä»€ä¹ˆæƒ…å†µï¼Ÿ</p>
<table>
<thead>
<tr>
<th style="text-align:center">æŒ‡æ ‡</th>
<th style="text-align:center">ç»“æœ</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">å®éªŒæ¬¡æ•°</td>
<td style="text-align:center">10</td>
</tr>
<tr>
<td style="text-align:center">æ­£ç¡®æ¬¡æ•°</td>
<td style="text-align:center">9</td>
</tr>
<tr>
<td style="text-align:center">æ­£ç¡®ç™¾åˆ†æ¯”</td>
<td style="text-align:center">90%</td>
</tr>
<tr>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span> å€¼</td>
<td style="text-align:center">0.02</td>
</tr>
<tr>
<td style="text-align:center">ç½®ä¿¡æ°´å¹³</td>
<td style="text-align:center">95%</td>
</tr>
<tr>
<td style="text-align:center">å‡ºç°æ¦‚ç‡</td>
<td style="text-align:center">0.0098</td>
</tr>
</tbody>
</table>
<p>åœ¨å¦‚ä¸Šçš„ç»“æœä¸‹ï¼Œæˆ‘ä»¬èƒ½å¾—å‡º A å’Œ B ä¹‹é—´å­˜åœ¨å·®å¼‚çš„ç»“è®ºå—ï¼Ÿçœ‹èµ·æ¥è¿™ä¸ªç»“è®ºæ˜¯ä¸åˆç†çš„ã€‚ä¸ºäº†é¿å…æ ·æœ¬çš„åˆ†å¸ƒåå·®å¯¹ç»“æœçš„å½±å“ï¼Œæˆ‘ä»¬åœ¨ç»„ç»‡ ABX æµ‹è¯•æ—¶ï¼Œå¿…é¡»ä¿è¯ X çš„æ¥æºæ˜¯éšæœºæŠ½å–çš„ï¼Œæ˜¯ç¬¦åˆå‡åŒ€åˆ†å¸ƒçš„ã€‚</p>
<h3 id="å®Œæ•´æŠ«éœ²å…¨éƒ¨ç»Ÿè®¡æ•°æ®">å®Œæ•´æŠ«éœ²å…¨éƒ¨ç»Ÿè®¡æ•°æ®</h3>
<p>å¯¹äº ABX çš„ç»Ÿè®¡æ¨æ–­åˆ†æè€Œè¨€ï¼Œé‡è¦çš„æ˜¯è¦è¯æ˜ç»“æœæ˜¯å…¬æ­£çš„ï¼ˆæ€»ä½“ç»“æœå’Œæ¯ä¸ªå—è¯•è€…çš„ç»“æœï¼‰ã€‚å¯¹äºä»»ä½• <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>&lt;</mo><mn>0.05</mn></mrow><annotation encoding="application/x-tex">p&lt;0.05</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335400000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">5</span></span></span></span> çš„æ˜¾è‘—ç»“æœï¼Œå¿…é¡»æŠ¥å‘Šå®éªŒçš„ï¼š</p>
<ul>
<li><strong>æ ·æœ¬å‡è¡¡æ€§</strong></li>
<li><strong>è¯•éªŒæ€»æ¬¡æ•°</strong></li>
<li><strong>æ­£ç¡®æ¬¡æ•°</strong></li>
<li><strong>æ­£ç¡®ç™¾åˆ†æ¯”</strong></li>
<li><strong>éšæœºå˜é‡å‡ºç°çš„æ¦‚ç‡</strong></li>
<li><strong>ç½®ä¿¡æ°´å¹³</strong></li>
<li><strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span> å€¼</strong></li>
</ul>
<p>ç»Ÿè®¡å­¦ä¸Šçš„æ˜¾è‘—ç»“æœåªèƒ½è¡¨æ˜ï¼Œå—è¯•è€…åªæ˜¯åœ¨çŒœæµ‹çš„æ¦‚ç‡å¾ˆå°ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬å¿…é¡»æ—¶åˆ»æé†’è‡ªå·±ï¼Œå³ä¾¿æ¦‚ç‡å†å°ä¹Ÿå®Œå…¨æœ‰å¯èƒ½åœ¨éšæœºçŒœæµ‹ä¸‹è·å¾—ç»Ÿè®¡å­¦ä¸Šçš„æ˜¾è‘—ç»“æœã€‚å› æ­¤ï¼Œåœ¨ ABX æµ‹è¯•ä¸­ï¼Œå¦‚æœç»“æœè¾¾åˆ° 95% çš„ç½®ä¿¡æ°´å¹³ï¼Œæˆ‘ä»¬å¯ä»¥è¯´å¬ä¼—åªæ˜¯éšæœºçŒœæµ‹çš„å¯èƒ½æ€§åªæœ‰ 5%ã€‚æ­¤æ—¶ï¼Œæˆ‘ä»¬ä¼šå¾ˆæœ‰æŠŠæ¡åœ°å£°ç§° A å’Œ B ä¹‹é—´å¯èƒ½å­˜åœ¨å¯æ„ŸçŸ¥çš„å·®å¼‚ï¼Œä»…æ­¤è€Œå·²ã€‚</p>
<h2 id="åº¦çŸ¥äº†ä¸­çš„-abx-æµ‹è¯•">åº¦çŸ¥äº†ä¸­çš„ ABX æµ‹è¯•</h2>
<p>ä¸ºäº†è®©ç”¨æˆ·æ›´æ–¹ä¾¿çš„è¿›è¡Œ ABX æµ‹è¯•ï¼Œæˆ‘ä»¬æŠŠå¦‚ä¸Šæåˆ°çš„ã€ABX éœ€è¦å…³æ³¨çš„å„ç§å› ç´ ç»Ÿä¸€é›†æˆåˆ°äº†åº¦çŸ¥äº†ä¸­ã€‚å½“å‰ï¼Œåº¦çŸ¥äº† iOS æœ€æ–°ç‰ˆæœ¬ï¼ˆv2.2.0ï¼‰å·²ç»æä¾›äº† ABX æµ‹è¯•çš„åŠŸèƒ½ï¼ŒAndroid ç‰ˆæœ¬æˆ‘ä»¬ä¹Ÿåœ¨å¿«é©¬åŠ é­çš„å¼€å‘ä¸­ï¼Œå¸Œæœ›èƒ½å¤Ÿå°½å¿«ä¸å¤§å®¶è§é¢ã€‚</p>
<p><img src="/2024/04/04/ABX-test-in-the-Audio-Quality-Assessment/abx_ios.jpeg" alt="ABX æµ‹è¯•"></p>
<p>å½“ç„¶ï¼Œåœ¨æˆ‘ä»¬çš„æœ€æ–°ç‰ˆæœ¬ä¸­ï¼Œé™¤äº† ABX æµ‹è¯•ï¼Œæˆ‘ä»¬è¿˜æä¾›äº† <a href="https://www.itu.int/rec/R-REC-BS.1534">MUSHRA</a>ã€<a href="https://www.itu.int/rec/T-REC-P.800-199608-I">CCR</a>ã€<a href="https://www.itu.int/rec/R-REC-BS.1116">DCR</a>ã€<a href="https://www.itu.int/rec/R-REC-BT.500">ACR</a>ç­‰å¤šç§è¯„æµ‹æ–¹æ³•ï¼Œä»¥æ»¡è¶³ä¸åŒç”¨æˆ·ã€å¤šåœºæ™¯ä¸‹çš„éŸ³é¢‘è´¨é‡è¯„ä¼°éœ€æ±‚ã€‚</p>
<h2 id="å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</h2>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p><a href="https://pubs.aip.org/asa/jasa/article/22/5_Supplement/675/625412/Standardizing-Auditory-Tests">Standardizing Auditory Tests</a> <a href="#fnref1" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn2" class="footnote-item"><p><a href="https://www.researchgate.net/publication/267193579_Statistical_Analysis_of_ABX_Results_Using_Signal_Detection_Theory">Statistical Analysis of ABX Results Using Signal Detection Theory</a> <a href="#fnref2" class="footnote-backref">â†©ï¸</a> <a href="#fnref2:1" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn3" class="footnote-item"><p><a href="https://abxtests.com/">abxtests.com/</a> <a href="#fnref3" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn4" class="footnote-item"><p><a href="https://lakens.github.io/statistical_inferences/01-pvalue.html">Using p-values to test a hypothesis</a> <a href="#fnref4" class="footnote-backref">â†©ï¸</a> <a href="#fnref4:1" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn5" class="footnote-item"><p><a href="https://www.manualslib.com/manual/513767/Qsc-Abx-Comparator.html">QSC ABX Comparator User Manual</a> <a href="#fnref5" class="footnote-backref">â†©ï¸</a></p>
</li>
</ol>
</section>
]]></content>
      <categories>
        <category>éŸ³é¢‘æŠ€æœ¯</category>
      </categories>
      <tags>
        <tag>éŸ³é¢‘è´¨é‡è¯„ä¼°</tag>
        <tag>ABX</tag>
      </tags>
  </entry>
  <entry>
    <title>å¦‚ä½•è®¡ç®—å¤šç»„ ACR æ‰“åˆ†çš„ ELO ç§¯åˆ†</title>
    <url>/2024/03/13/How-to-calculate-the-ELO-ratings-for-multiple-sets-of-ACR-scores/</url>
    <content><![CDATA[<p><img src="/2024/03/13/How-to-calculate-the-ELO-ratings-for-multiple-sets-of-ACR-scores/1.jpeg" alt></p>
<p>åœ¨ <a href="/2023/08/12/the-interesting-elo-rating-system/">æœ‰è¶£çš„ Elo ç§¯åˆ†ç³»ç»Ÿ</a> è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº† Elo ç§¯åˆ†ç³»ç»Ÿçš„åŸºæœ¬åŸç†ï¼Œå¹¶ä»‹ç»äº†æˆ‘ä»¬å¦‚ä½•åœ¨è§†é¢‘è¯„ä¼°ç³»ç»Ÿä¸­é‡‡ç”¨ Elo ç§¯åˆ†æ¥è¯„ä¼°ä¸åŒç¼–è§£ç å™¨ä¹‹é—´çš„æ€§èƒ½ã€‚ä¸è¿‡ï¼Œä¹‹å‰æ–‡ç« ä¸­ä»‹ç»çš„æ˜¯å¯¹äº <em><strong>æˆå¯¹æ‰“åˆ†</strong></em> åœºæ™¯ä¸‹åº”ç”¨  Elo ç§¯åˆ†ï¼Œåœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»åœ¨ <em><strong>ACR æ‰“åˆ†åœºæ™¯</strong></em> ä¸‹å¦‚ä½•é‡‡ç”¨ Elo ç§¯åˆ†è¯„ä¼°ä¸åŒæ–¹æ¡ˆçš„æ€§èƒ½ã€‚</p>
<span id="more"></span>
<h2 id="èƒŒæ™¯">èƒŒæ™¯</h2>
<p>æˆ‘ä»¬æœ€è¿‘éœ€è¦è¯„ä¼°ä¸åŒç‰ˆæœ¬çš„ TTS çš„è¡¨ç°æ•ˆæœï¼Œç”±äºæˆ‘ä»¬çš„è¯„ä¼°ç³»ç»Ÿ <a href="/2023/02/13/duzhiliao/">åº¦çŸ¥äº†</a> è¿˜ä¸æ”¯æŒå¯¹çº¯éŸ³é¢‘çš„è¯„ä¼°ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦æŠŠéŸ³é¢‘è½¬æ¢ä¸ºè§†é¢‘ï¼Œç„¶ååˆ©ç”¨è§†é¢‘çš„è¯„ä¼°æ–¹æ¡ˆå¯¹éŸ³é¢‘è¿›è¡Œè¯„ä¼°ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ffmpeg -f lavfi -i color=s=1920x1080:r=15:c=<span class="string">&#x27;0x000000&#x27;</span>:d=5 \</span><br><span class="line">-i INPUT.mp3 \</span><br><span class="line">-map <span class="string">&quot;0:v&quot;</span> -map <span class="string">&quot;1:a&quot;</span> -acodec copy OUTPUT.mp4</span><br></pre></td></tr></table></figure>
<p>åœ¨ <em>åº¦çŸ¥äº†</em> ä¸­ï¼Œé‡‡ç”¨ <em>æˆå¯¹è¯„ä¼°æ³•</em> å¯¹è§†é¢‘è¿›è¡Œæ‰“åˆ†æ—¶æ²¡æœ‰å¼€æ”¾åˆ‡æ¢è§†é¢‘è¯­éŸ³çš„èƒ½åŠ›ï¼ˆåœ¨è§†é¢‘è¯„ä¼°ä¸­ï¼Œæˆ‘ä»¬è®¤ä¸ºéŸ³é¢‘æ•ˆæœå¹¶éæ ¸å¿ƒå…³æ³¨ç‚¹ï¼‰ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦é‡‡ç”¨æ¥ä¸‹æ¥è¦ä»‹ç»çš„ <em>ACR æ‰“åˆ†æ³•</em> å¯¹éŸ³é¢‘è¿›è¡Œæ‰“åˆ†ã€‚</p>
<p>äºæ˜¯ï¼Œä¹Ÿå°±æœ‰äº†æœ¬æ–‡æåˆ°çš„é—®é¢˜ï¼šå¦‚ä½•è®¡ç®—å¤šç»„ ACR æ‰“åˆ†çš„ Elo ç§¯åˆ†ï¼Ÿ</p>
<h2 id="ä»€ä¹ˆæ˜¯-acr-æ‰“åˆ†ï¼Ÿ">ä»€ä¹ˆæ˜¯ ACR æ‰“åˆ†ï¼Ÿ</h2>
<p><a href="https://wangwei1237.github.io/digital_video_concepts/docs/4_2_1_SubjectiveVideoQualityEvaluation.html">ACRï¼ˆç»å¯¹ç­‰çº§è¯„åˆ†ï¼‰æ‰“åˆ†</a> æ˜¯éŸ³ã€è§†é¢‘ä¸»è§‚è´¨é‡è¯„ä¼°æ ‡å‡†ä¸­çš„ä¸€ç§è¯„ä¼°æ–¹æ³•ã€‚åœ¨ ACR çš„æ‰“åˆ†è¿‡ç¨‹ä¸­ï¼Œä¼šé€ä¸ªå‘ˆç°æµ‹è¯•åºåˆ—ä¸­çš„æ¯ä¸€ä¸ªå¾…è¯„ä¼°æ ·æœ¬ï¼Œå¹¶é’ˆå¯¹æ¯ä¸€ä¸ªæ ·æœ¬åœ¨è´¨é‡ç­‰çº§é‡è¡¨å†…å¯¹å…¶è¿›è¡Œç‹¬ç«‹æ‰“åˆ†ã€‚ACR ä¹Ÿç§°ä¹‹ä¸ºå•åˆºæ¿€æ–¹æ³•ï¼Œå…¶ä¸­å—è¯•è€…è§‚çœ‹ã€å¬å–ä¸€ä¸ªåˆºæ¿€ï¼ˆä¾‹å¦‚ï¼Œè§†é¢‘å‰ªè¾‘ã€éŸ³é¢‘å‰ªè¾‘ï¼‰ï¼Œç„¶åå¯¹å…¶è¿›è¡Œç‹¬ç«‹è¯„çº§ã€‚</p>
<p>åœ¨ æˆ‘ä»¬çš„è¯„ä¼°ç³»ç»Ÿä¸­ï¼Œé‡‡ç”¨æ ‡å‡†çš„ ACR æ‰“åˆ†é‡çº§è¡¨ï¼š</p>
<table>
<thead>
<tr>
<th style="text-align:center">åˆ†æ•°</th>
<th style="text-align:center">ç­‰çº§</th>
<th style="text-align:center">è§£é‡Š</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">Excellent</td>
<td style="text-align:center">ä¼˜ç§€</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">Good</td>
<td style="text-align:center">è‰¯å¥½</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">Fair</td>
<td style="text-align:center">æ™®é€š</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">Poor</td>
<td style="text-align:center">è¾ƒå·®</td>
</tr>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">Bad</td>
<td style="text-align:center">å·®</td>
</tr>
</tbody>
</table>
<p>é’ˆå¯¹æ¯ä¸€ä¸ªæ ·æœ¬ï¼Œæˆ‘ä»¬ä¼šè®©è‡³å°‘ 10 åç”¨æˆ·æŒ‰ç…§å¦‚ä¸Šçš„é‡çº§è¡¨è¿›è¡Œæ‰“åˆ†ï¼Œç„¶åæ ¹æ®ç”¨æˆ·çš„æ‰“åˆ†ï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">S_{i,j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span> ä¸ªç”¨æˆ·å¯¹ç¬¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span></span></span></span> ä¸ªæ ·æœ¬çš„æ‰“åˆ†ï¼‰å¾—åˆ°æ¯ä¸ªæ ·æœ¬çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>O</mi><msub><mi>S</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">MOS_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> åˆ†ï¼ˆå¹³å‡ä¸»è§‚å¾—åˆ†ï¼‰ï¼Œæœ€åæˆ‘ä»¬ä¼šå°† 5 åˆ†åˆ¶çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>O</mi><mi>S</mi></mrow><annotation encoding="application/x-tex">MOS</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span></span></span></span> åˆ†è½¬æ¢ä¸º 100 åˆ†åˆ¶çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>O</mi><mi>S</mi></mrow><annotation encoding="application/x-tex">MOS</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span></span></span></span> åˆ†ä½œä¸ºè¯¥æ ·æœ¬çš„æœ€ç»ˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>O</mi><mi>S</mi></mrow><annotation encoding="application/x-tex">MOS</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span></span></span></span> åˆ†ã€‚</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>O</mi><msub><mi>S</mi><mi>j</mi></msub><mo>=</mo><mo fence="false">(</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>S</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub><mo>âˆ’</mo><mn>1</mn><mo fence="false">)</mo><mo>Ã—</mo><mn>25</mn></mrow><annotation encoding="application/x-tex">MOS_j = \big(\frac{1}{N} \sum_{i=1}^{N} S_{i,j} - 1 \big) \times 25
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.106005em;vertical-align:-1.277669em;"></span><span class="mord"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.20001em;vertical-align:-0.35001em;"></span><span class="mord">1</span><span class="mord"><span class="delimsizing size1">)</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord">5</span></span></span></span></span></p>
<h2 id="acr-çš„è¯„ä¼°æ–¹æ¡ˆ">ACR çš„è¯„ä¼°æ–¹æ¡ˆ</h2>
<p>æˆ‘ä»¬æœ‰ä¸¤ä¸ªä¸åŒç‰ˆæœ¬çš„ TTS æ¨¡å‹ï¼Œæˆ‘ä»¬æŠ½å–äº† 100 ä¸ªæ–‡æœ¬æ ·æœ¬åˆ©ç”¨ä¸åŒçš„æ¨¡å‹åˆ†åˆ«ç”Ÿæˆäº†å¯¹åº”çš„éŸ³é¢‘æ ·æœ¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>a</mi><mi>m</mi><mi>p</mi><mi>l</mi><msub><mi>e</mi><mi>A</mi></msub></mrow><annotation encoding="application/x-tex">sample_A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">a</span><span class="mord mathdefault">m</span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">A</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>a</mi><mi>m</mi><mi>p</mi><mi>l</mi><msub><mi>e</mi><mi>B</mi></msub></mrow><annotation encoding="application/x-tex">sample_B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">a</span><span class="mord mathdefault">m</span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œç„¶åæˆ‘ä»¬é‡‡ç”¨æ´—ç‰Œç®—æ³•å¯¹ä¸¤ä¸ªæ ·æœ¬è¿›è¡Œæ‰“ä¹±ï¼Œç„¶åæ‹›å‹Ÿç”¨æˆ·å¯¹è¿™äº›æ ·æœ¬è¿›è¡ŒéŸ³é¢‘æ•ˆæœçš„ ACR æ‰“åˆ†ã€‚</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>a</mi><mi>m</mi><mi>p</mi><mi>l</mi><mi>e</mi><mo>=</mo><mi>s</mi><mi>h</mi><mi>u</mi><mi>f</mi><mi>f</mi><mi>l</mi><mi>e</mi><mo fence="false">(</mo><mo stretchy="false">{</mo><mi>s</mi><mi>a</mi><mi>m</mi><mi>p</mi><mi>l</mi><msub><mi>e</mi><mi>A</mi></msub><mo separator="true">,</mo><mi>s</mi><mi>a</mi><mi>m</mi><mi>p</mi><mi>l</mi><msub><mi>e</mi><mi>B</mi></msub><mo stretchy="false">}</mo><mo fence="false">)</mo></mrow><annotation encoding="application/x-tex">sample = shuffle\big(\{sample_A, sample_B\}\big)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">a</span><span class="mord mathdefault">m</span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.20001em;vertical-align:-0.35001em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">h</span><span class="mord mathdefault">u</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">e</span><span class="mord"><span class="delimsizing size1">(</span></span><span class="mopen">{</span><span class="mord mathdefault">s</span><span class="mord mathdefault">a</span><span class="mord mathdefault">m</span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">A</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">a</span><span class="mord mathdefault">m</span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span><span class="mord"><span class="delimsizing size1">)</span></span></span></span></span></span></p>
<p>ç”¨æˆ·æ‰“åˆ†å®Œæ¯•ä¹‹åï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°æ··åˆä¹‹åçš„æ ·æœ¬çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>O</mi><mi>S</mi></mrow><annotation encoding="application/x-tex">MOS</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span></span></span></span> å¾—åˆ†ï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>O</mi><msub><mi>S</mi><mrow><mi>s</mi><mi>a</mi><mi>m</mi><mi>p</mi><mi>l</mi><mi>e</mi></mrow></msub></mrow><annotation encoding="application/x-tex">MOS_{sample}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight">e</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>ï¼‰ï¼Œç„¶åæˆ‘ä»¬æ ¹æ®ç”Ÿæˆæ ·æœ¬çš„ TTS çš„æ¨¡å‹çš„ä¸åŒå¾—åˆ° Aã€B ä¸¤ç»„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>O</mi><mi>S</mi></mrow><annotation encoding="application/x-tex">MOS</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span></span></span></span> æ‰“åˆ†ï¼š<a href="https://github.com/wangwei1237/wangwei1237.github.io/blob/master/2024/03/13/How-to-calculate-the-ELO-ratings-for-multiple-sets-of-ACR-scores/code/mosA"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>O</mi><msub><mi>S</mi><mi>A</mi></msub></mrow><annotation encoding="application/x-tex">MOS_A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">A</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></a>ï¼Œ<a href="https://github.com/wangwei1237/wangwei1237.github.io/blob/master/2024/03/13/How-to-calculate-the-ELO-ratings-for-multiple-sets-of-ACR-scores/code/mosB"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>O</mi><msub><mi>S</mi><mi>B</mi></msub></mrow><annotation encoding="application/x-tex">MOS_B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></a>ã€‚</p>
<h2 id="æ ¹æ®-acr-è®¡ç®—-elo-ç§¯åˆ†">æ ¹æ® ACR è®¡ç®— Elo ç§¯åˆ†</h2>
<p>å› ä¸º ELo æœ¬èº«å…·å¤‡<strong>æ”¶æ•›è¿‡ç¨‹</strong>å’Œ<strong>æ¯”èµ›é¡ºåºç›¸å…³</strong>ç­‰ç‰¹ç‚¹ï¼Œå› æ­¤æˆ‘ä»¬é‡‡ç”¨äº† <a href="https://online.stat.psu.edu/stat500/lesson/11/11.2/11.2.1">Bootstrap Sampling</a> æ–¹æ³•æ¥è®¡ç®— Elo ç§¯åˆ†ã€‚</p>
<p>ä¸ºäº†ä¿è¯æ ·æœ¬çš„éšæœºå‹ï¼Œåœ¨æ¯ä¸€æ¬¡é‡æŠ½æ ·çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¼šé¦–å…ˆä» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>O</mi><msub><mi>S</mi><mi>A</mi></msub></mrow><annotation encoding="application/x-tex">MOS_A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">A</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>O</mi><msub><mi>S</mi><mi>B</mi></msub></mrow><annotation encoding="application/x-tex">MOS_B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä¸­éšæœºæŠ½å– <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span> ä¸ªæ ·æœ¬ï¼Œç„¶åå–å…¶å¹³å‡å€¼ä½œä¸ºè¯¥æ¬¡å¯¹æŠ—çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>O</mi><mi>S</mi></mrow><annotation encoding="application/x-tex">MOS</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span></span></span></span> åˆ†æ¥è®¡ç®— Elo ç§¯åˆ†ã€‚</p>
<ul>
<li>STEP 1ï¼šä» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>O</mi><msub><mi>S</mi><mi>A</mi></msub></mrow><annotation encoding="application/x-tex">MOS_A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">A</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>O</mi><msub><mi>S</mi><mi>B</mi></msub></mrow><annotation encoding="application/x-tex">MOS_B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä¸­éšæœºæŠ½å– <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span> ä¸ªæ ·æœ¬å¾—åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>O</mi><msub><mi>S</mi><msup><mi>A</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup></msub></mrow><annotation encoding="application/x-tex">MOS_{A&#x27;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>O</mi><msub><mi>S</mi><msup><mi>B</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup></msub></mrow><annotation encoding="application/x-tex">MOS_{B&#x27;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
<li>STEP 2ï¼šè®¡ç®— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>O</mi><msub><mi>S</mi><msup><mi>A</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup></msub></mrow><annotation encoding="application/x-tex">MOS_{A&#x27;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>O</mi><msub><mi>S</mi><msup><mi>B</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup></msub></mrow><annotation encoding="application/x-tex">MOS_{B&#x27;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> çš„å¹³å‡å€¼ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>O</mi><msub><mi>S</mi><mrow><mi>A</mi><mo separator="true">,</mo><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">MOS_{A,i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>O</mi><msub><mi>S</mi><mrow><mi>B</mi><mo separator="true">,</mo><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">MOS_{B,i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></li>
<li>STEP 3ï¼šåˆ©ç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>O</mi><msub><mi>S</mi><mrow><mi>A</mi><mo separator="true">,</mo><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">MOS_{A,i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>O</mi><msub><mi>S</mi><mrow><mi>B</mi><mo separator="true">,</mo><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">MOS_{B,i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> è®¡ç®— Elo ç§¯åˆ†</li>
<li>STEP 4ï¼šé‡å¤å¦‚ä¸Šæ­¥éª¤ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span></span></span></span> æ¬¡ï¼Œå¾—åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span></span></span></span> è½®çš„ Elo ç§¯åˆ†</li>
<li>STEP 5ï¼šè®¡ç®— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span></span></span></span> ç»„ Elo ç§¯åˆ†çš„å¹³å‡å€¼ä½œä¸ºæœ€ç»ˆ Elo ç§¯åˆ†</li>
</ul>
<p>å…·ä½“çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">eloA = []</span><br><span class="line">eloB = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(num_round), desc=<span class="string">&quot;bootstrap&quot;</span>):</span><br><span class="line">    A = random.sample(mosA, batch_size)</span><br><span class="line">    B = random.sample(mosB, batch_size)</span><br><span class="line">    meanA = <span class="built_in">int</span>(np.mean(A))</span><br><span class="line">    meanB = <span class="built_in">int</span>(np.mean(B))</span><br><span class="line">    ratingA, ratingB = func_compute_elo(meanA, meanB, ratingA, ratingB)</span><br><span class="line">    eloA.append(ratingA)</span><br><span class="line">    eloB.append(ratingB)</span><br><span class="line"></span><br><span class="line">eloA = np.mean(eloA)</span><br><span class="line">eloB = np.mean(eloB)</span><br></pre></td></tr></table></figure>
<p>å®Œæ•´çš„ä»£ç å®ç°å¯ä»¥å‚è€ƒï¼š</p>
<ul>
<li><a href="https://github.com/wangwei1237/wangwei1237.github.io/blob/master/2024/03/13/How-to-calculate-the-ELO-ratings-for-multiple-sets-of-ACR-scores/code/elo.py">elo.py</a></li>
<li><a href="https://github.com/wangwei1237/wangwei1237.github.io/blob/master/2024/03/13/How-to-calculate-the-ELO-ratings-for-multiple-sets-of-ACR-scores/code/utils.py">utils.py</a></li>
<li><a href="https://github.com/wangwei1237/wangwei1237.github.io/blob/master/2024/03/13/How-to-calculate-the-ELO-ratings-for-multiple-sets-of-ACR-scores/code/elo_test_acr.py">elo_test_acr.py</a></li>
</ul>
<p>æ ¹æ®æˆ‘ä»¬çš„å®éªŒï¼Œå½“ bootstrap sampling çš„è½®æ•° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span></span></span></span> è®¾ç½®ä¸º 5000 æ—¶ï¼ŒElo çš„ç§¯åˆ†ä¼šè¶‹äºæ”¶æ•›å’Œç¨³å®šã€‚</p>
<p>ä¾‹å¦‚å¯¹äºç›¸åŒæ‰“åˆ†çš„ä¸¤ç»„æ‰“åˆ†ï¼ŒæŠ½æ · 5000 æ¬¡çš„ç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="/2024/03/13/How-to-calculate-the-ELO-ratings-for-multiple-sets-of-ACR-scores/bootstrap_5000.png" alt="æŠ½æ · 5000 æ¬¡"></p>
<p>è€ŒæŠ½æ · 1000 æ¬¡çš„ç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="/2024/03/13/How-to-calculate-the-ELO-ratings-for-multiple-sets-of-ACR-scores/bootstrap_1000.png" alt="æŠ½æ · 1000 æ¬¡"></p>
<p>å¯¹äºåŒæ ·æ‰“åˆ†çš„ä¸¤ç»„æ ·æœ¬è€Œè¨€ï¼Œå…¶æœ€ç»ˆçš„ Elo ç§¯åˆ†åº”è¯¥æ˜¯è¶‹äºä¸€è‡´çš„ï¼Œä»å¦‚ä¸Šçš„ç»“æœå¯¹æ¯”ä¹Ÿå¯ä»¥çœ‹å‡ºï¼Œå½“æŠ½æ · 5000 æ¬¡æ—¶ï¼ŒElo ç§¯åˆ†è¶‹å‘äºä¸€è‡´ï¼Œä¹Ÿæ›´ä¸ºç½®ä¿¡ã€‚</p>
]]></content>
      <categories>
        <category>ç®—æ³•ä¸æ•°å­¦</category>
      </categories>
      <tags>
        <tag>ACR</tag>
        <tag>Elo rating</tag>
      </tags>
  </entry>
  <entry>
    <title>Soraâ€”â€”AGI æ¼«æ¼«é•¿å¤œä¸­çš„æ˜Ÿå…‰</title>
    <url>/2024/02/22/Sora-the-starlight-in-the-long-night-of-AGI/</url>
    <content><![CDATA[<p><img src="/2024/02/22/Sora-the-starlight-in-the-long-night-of-AGI/1.jpg" alt></p>
<blockquote>
<p>Prompt: ä¸€ä½æ—¶å°šçš„å¥³å£«æ¼«æ­¥åœ¨ä¸œäº¬çš„è¡—é“ï¼Œè¡—é“ä¸Šå……æ»¡äº†æ¸©æš–çš„éœ“è™¹ç¯å’Œç”ŸåŠ¨çš„åŸå¸‚æ ‡å¿—ã€‚å¥¹ç©¿ç€é»‘è‰²çš®å¤¹å…‹ã€çº¢è‰²é•¿è£™å’Œé»‘è‰²é´å­ï¼Œæ‰‹é‡Œæ‹¿ç€ä¸€ä¸ªé»‘è‰²é’±åŒ…ã€‚å¥¹æˆ´ç€å¤ªé˜³é•œï¼Œæ¶‚ç€çº¢è‰²çš„å£çº¢ã€‚å¥¹èµ°è·¯è‡ªä¿¡è€Œéšæ„ã€‚è¡—é“æ½®æ¹¿ä¸”åå…‰ï¼Œå½¢æˆäº†å½©è‰²ç¯å…‰çš„é•œé¢æ•ˆæœã€‚è¡—é“ä¸Šï¼Œè®¸å¤šè¡Œäººèµ°æ¥èµ°å»ã€‚</p>
</blockquote>
<p>2024 å¹´ï¼Œ2 æœˆ 16 æ—¥ï¼Œå†œå†çš„å¤§å¹´åˆä¸ƒï¼Œå½“æˆ‘ä»¬è¿˜æ²‰æµ¸åœ¨æ˜¥èŠ‚å‡æœŸçš„å›¢èšä¸æ¬¢ä¹æ—¶ï¼Œå¤§æ´‹å½¼å²¸çš„ OpenAI çªç„¶å‘å¸ƒäº†è½°åŠ¨ç§‘æŠ€è¡—çš„æœ€æ–°ç ”ç©¶æˆæœâ€”â€”Soraã€‚åˆ©ç”¨å¦‚ä¸Šçš„ <code>æç¤ºè¯</code>ï¼ŒSora å¯ä»¥ç”Ÿæˆè¾ƒé«˜ç”»è´¨çš„ã€éå¸¸é€¼çœŸçš„ã€é•¿è¾¾ä¸€åˆ†é’Ÿçš„è§†é¢‘ã€‚å°±åƒå½“æ—¶ ChatGPT å‘å¸ƒä¸€æ ·ï¼ŒSora çš„å‘å¸ƒåˆä¸€æ¬¡å¼•çˆ†äº†æŠ€æœ¯å¤§è®¨è®ºã€‚æ­£å¦‚ Sora çš„å¼€å‘è€… Bill Peebles æ‰€è¯´çš„é‚£æ ·ï¼šSora ä»¤ä»–ä»¬éå¸¸å…´å¥‹ï¼Œä»–ä»¬å¯ä»¥é€šè¿‡æ¨¡æ‹Ÿä¸€åˆ‡æ¥ä¸æ–­åœ°è¿½æ±‚ AGIã€‚<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup></p>
<blockquote>
<p>weâ€™re pumped about pursuing AGI by simulating everything!</p>
</blockquote>
<span id="more"></span>
<h2 id="sora-çš„æµè¡Œè¶‹åŠ¿">Sora çš„æµè¡Œè¶‹åŠ¿</h2>
<ul>
<li>è‡ªä» Bill Peebles åœ¨ Twitter ä¸Šå‘å¸ƒ Sora ç”Ÿæˆçš„è§†é¢‘ä»¥æ¥ï¼Œè¯¥å¸–å­å·²ç»è¶…è¿‡ 19W çš„æµè§ˆé‡ã€‚</li>
<li>å¦‚æœåœ¨å„å¤§å¹³å°æœç´¢ Soraï¼Œæˆ‘ä»¬ä¹Ÿä¼šå‘ç°ç›¸å…³çš„æ–‡ç« ã€è§†é¢‘å¦‚é›¨åæ˜¥ç¬‹èˆ¬åœ¨æš´å¢ã€‚</li>
<li>åœ¨ Sora å‘å¸ƒçš„ 4 å¤©å†…ï¼Œä¸­ä¿¡å»ºæŠ•ã€å›½æ³°å›å®‰ã€ç”³ä¸‡å®æºã€æ‹›å•†è¯åˆ¸ç­‰ 10 å®¶åˆ¸å•†åœ¨ç ”æŠ¥ä¸­å‡è¡¨ç¤ºï¼ŒSora æ˜¯äººå·¥æ™ºèƒ½å‘å±•è¿›ç¨‹ä¸­çš„é‡Œç¨‹ç¢‘ï¼Œé¢„ç¤º AGIï¼ˆäººå·¥é€šç”¨æ™ºèƒ½ï¼‰å°†åŠ é€Ÿåˆ°æ¥ï¼Œä¼—å¤šè¡Œä¸šå°†è¿æ¥é¢ è¦†å¼å˜é©<sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup>ã€‚</li>
<li>2 æœˆ 19 æ—¥ï¼Œå¤®è§†è´¢ç»é¢‘é“çš„ã€Šå¤©ä¸‹è´¢ç»ã€‹æ ç›®ä¹Ÿå¯¹ Sora çš„çˆ†ç«è¿›è¡Œäº†æŠ¥é“<sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup>ã€‚</li>
<li>å¯¹ Sora çš„è®¨è®ºä¾ç„¶åœ¨æŒç»­ç«çƒ­ä¸­â€¦â€¦</li>
</ul>
<p>é€šè¿‡è°·æ­Œè¶‹åŠ¿æˆ‘ä»¬å‘ç°ï¼Œåœ¨ Sora åˆšå‘å¸ƒçš„ 1 ä¸ªå°æ—¶ä»¥å†…ï¼ŒSora çš„æœç´¢çƒ­åº¦å°±å¼€å§‹çªå¢ã€‚å¯¹äºå›½å†…çš„çƒ­åº¦æ›²çº¿ï¼Œæˆ‘ä»¬ä¼šå‘ç°ä¸€ä¸ªæ¯”è¾ƒæœ‰è¶£çš„åœ°æ–¹ï¼šå³ä¾¿åœ¨å‡Œæ™¨ï¼Œå³ä¾¿æ­¤æ—¶çš„æœç´¢çƒ­åº¦åœ¨ä¸‹é™ï¼Œä½†æ˜¯æœç´¢çš„çƒ­åº¦ä¾ç„¶æ²¡æœ‰ä¸‹é™è‡³ 0ã€‚å³ä¾¿åœ¨å¤œæ·±äººé™çš„æ—¶åˆ»ï¼Œä»ç„¶æœ‰å¾ˆå¤šäººåœ¨è·Ÿè¸ªæ–°çš„äº‹ç‰©ï¼Œè¿™ä¹Ÿä»ä¾§é¢åæ˜ å‡º Sora çš„å‘å¸ƒæ‰€å¸¦æ¥çš„å½±å“ã€‚</p>
<p><img src="/2024/02/22/Sora-the-starlight-in-the-long-night-of-AGI/sora_google_trend.png" alt="Sora çš„è°·æ­Œæœç´¢çƒ­åº¦è¶‹åŠ¿"></p>
<p>ä»åˆ†åŸå¸‚çš„çƒ­åº¦è¶‹åŠ¿èƒ½çœ‹åˆ°ï¼Œä¸­å›½ã€å°åº¦ã€ç¾å›½ã€æ¬§æ´²åŒºçš„ç›¸å…³åŸå¸‚çš„æœç´¢çƒ­åº¦ç›¸å¯¹è¾ƒé«˜ï¼Œå¹¶ä¸”åŒ—äº¬ã€æ­å·ã€æ·±åœ³çš„çƒ­åº¦è¿›åˆ°äº†çƒ­åº¦åŸå¸‚çš„ TOP5ï¼Œè¶³è§å›½å†…å¯¹ Sora çš„å…³æ³¨åº¦ã€‚</p>
<p><img src="/2024/02/22/Sora-the-starlight-in-the-long-night-of-AGI/sora_hot_city.png" alt="Sora çš„åˆ†åŸå¸‚æœç´¢çƒ­åº¦è¶‹åŠ¿"></p>
<p>æ ¹æ®çƒ­æœå¼•æ“æä¾›çš„å¾®åšçƒ­æœå†å²æ•°æ®ï¼Œåœ¨ Sora å‘å¸ƒçš„å½“å¤©æ—©ä¸Š 9 ç‚¹çš„æ—¶å€™ï¼Œåœ¨å¤§æ´‹å½¼å²¸å·²ç»æ²¸è…¾äº† 6 ä¸ªå°æ—¶ä¹‹åï¼ŒSora ä¹Ÿåˆæ¬¡ç™»ä¸Šäº†å¾®åšçƒ­æœæ¦œï¼Œå¹¶ä¸”ä¹‹åçš„å‡ å¤©é‡Œä¸€ç›´åœ¨æ¦œã€‚</p>
<p><img src="/2024/02/22/Sora-the-starlight-in-the-long-night-of-AGI/Sora_weibo_hot_search.png" alt="Sora ç™»ä¸Šå¾®åšçƒ­æœæ¦œ"></p>
<p>å—åˆ° Sora å‘å¸ƒçš„å½±å“ï¼ŒAdobe è‚¡ä»· 2 æœˆ 16 æ—¥æš´è·Œ 7% ä»¥ä¸Šï¼Œåˆ› 2023 å¹´ 11 æœˆ 1 æ—¥ä»¥æ¥çš„æ–°ä½ï¼Œå¸‚å€¼åœ¨çŸ­çŸ­ä¸€ä¸ªäº¤æ˜“æ—¥å†…å°±è’¸å‘äº†è¿‘ 198 äº¿ç¾å…ƒã€‚</p>
<p><img src="/2024/02/22/Sora-the-starlight-in-the-long-night-of-AGI/adobe_stock.png" alt="Abode è‚¡ä»·è¶‹åŠ¿"></p>
<h2 id="sora-çš„èƒ½åŠ›">Sora çš„èƒ½åŠ›</h2>
<p>ç›®å‰ç½‘ç»œä¸Šå·²ç»æœ‰å¾ˆå¤šäººä»äº§å“ã€æŠ€æœ¯ç­‰ä¸åŒçš„å±‚é¢å¯¹ Sora è¿›è¡Œäº†è¯¦ç»†çš„åˆ†æï¼Œè¿™äº›å†…å®¹å¯ä»¥å¾ˆæ–¹ä¾¿çš„ä»ç½‘ç»œä¸­è·å–ã€‚å³ä¾¿å¦‚æ­¤ï¼Œä¹Ÿå»ºè®®å¤§å®¶è®¤çœŸé˜…è¯» OpenAI å®˜æ–¹å‘å¸ƒçš„ Sora ä»‹ç»ï¼ˆCreating video from text<sup class="footnote-ref"><a href="#fn4" id="fnref4">[4]</a></sup>ï¼‰å’Œ Sora çš„æŠ€æœ¯æ–‡æ¡£ï¼ˆVideo generation models as world simulators<sup class="footnote-ref"><a href="#fn5" id="fnref5">[5]</a></sup>ï¼‰ã€‚</p>
<p>OpenAI å®˜æ–¹å‘å¸ƒçš„ <a href="https://openai.com/sora">Sora ä»‹ç»é¡µé¢</a> æè¿°äº† Sora å¯ä»¥æä¾›çš„èƒ½åŠ›åŠå…¶å½“å‰å­˜åœ¨çš„é—®é¢˜ï¼ŒåŒæ—¶è¿˜æä¾›äº† 48 ä¸ª ç”± Sora ç”Ÿæˆçš„è§†é¢‘ã€‚</p>
<div class="bili_video"><div style="position: relative; width: 100%; height: 0; padding-bottom: 75%;"><iframe src="https://player.bilibili.com/player.html?aid=1950695804&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position: absolute; width: 100%; height: 100%; left: 0; top: 0;"> </iframe></div></div>
<h3 id="æ›´é«˜çš„æ—¶é•¿">æ›´é«˜çš„æ—¶é•¿</h3>
<p>Sora å¯ä»¥ç”Ÿæˆé•¿è¾¾ 1 åˆ†é’Ÿçš„è§†é¢‘ï¼Œè€Œä¼ ç»Ÿçš„æ–‡ç”Ÿè§†é¢‘æ¨¡å‹ç”Ÿæˆçš„è§†é¢‘çš„å¹³å‡é•¿åº¦åˆ™åªæœ‰ 4 ç§’ï¼Œä»æ—¶é—´ä¸Šçœ‹ï¼ŒSora å·²ç»æ˜¯ä¸€ä¸ªéå¸¸å¤§çš„çªç ´ã€‚åŒæ—¶ï¼Œåœ¨é•¿è¾¾ 1 åˆ†é’Ÿçš„è§†é¢‘ä¸­ï¼ŒSora è¿˜èƒ½æŒç»­ç»´æŒè§†é¢‘ç”»è´¨å¹¶éµå¾ªç”¨æˆ·æç¤ºè¯ä¸­ç»™å‡ºçš„æŒ‡ä»¤ï¼Œè¿™ä¸€ç‚¹ä¹Ÿè®©äººæƒŠå¹ã€‚ç›®å‰çš„çŸ­è§†é¢‘æ—¶é•¿å¤§æ¦‚ä¹Ÿå°±åœ¨ 10S ~ 1 Min å·¦å³çš„æ ·å­ï¼Œè€Œå¾®çŸ­å‰§çš„æ—¶é•¿ä¹Ÿå°±åœ¨ 2Min ~ 5 Minï¼Œå› æ­¤ï¼Œä»è§†é¢‘æ—¶é•¿å’ŒæŒ‡ä»¤éµå¾ªè¿™ä¸¤ç‚¹çœ‹ï¼ŒSora å¯¹æ•´ä¸ªè§†é¢‘è¡Œä¸šå¸¦æ¥äº†éå¸¸æœ‰æƒ³è±¡åŠ›çš„ç©ºé—´ã€‚</p>
<h3 id="æ›´å¥½çš„ç‰©ç†è§„å¾‹æ¨¡æ‹Ÿèƒ½åŠ›">æ›´å¥½çš„ç‰©ç†è§„å¾‹æ¨¡æ‹Ÿèƒ½åŠ›</h3>
<p>Sora èƒ½å¤Ÿç”Ÿæˆå¤æ‚åœºæ™¯çš„è§†é¢‘ï¼Œè¿™äº›å¤æ‚åœºæ™¯å¯ä»¥å…·æœ‰å¤šä¸ªè§’è‰²ã€ç‰¹å®šç±»å‹çš„è¿åŠ¨ã€å…·å¤‡ç²¾ç¡®ç»†èŠ‚çš„ä¸»ä½“å’ŒèƒŒæ™¯ã€‚Sora ä¸ä»…äº†è§£ç”¨æˆ·åœ¨æç¤ºè¯ä¸­çš„è¦æ±‚ï¼Œè¿˜äº†è§£è¿™äº›å®ä½“åœ¨ç‰©ç†ä¸–ç•Œä¸­æ˜¯å¦‚ä½•å­˜åœ¨çš„â€”â€”ä»–ä»¬ä¹‹é—´çš„å…³ç³»æ˜¯æ€æ ·çš„ã€ä»–ä»¬ä¼šå¦‚ä½•äº’åŠ¨ã€ä»–ä»¬ä¹‹é—´çš„äº’åŠ¨ä¼šäº§ç”Ÿæ€æ ·çš„åé¦ˆâ€¦â€¦</p>
<h3 id="æ›´å¤šçš„é•œå¤´è¡¨ç°èƒ½åŠ›">æ›´å¤šçš„é•œå¤´è¡¨ç°èƒ½åŠ›</h3>
<p>Sora å¯¹è‡ªç„¶è¯­è¨€æœ‰ç€æ·±åˆ»çš„ç†è§£ï¼Œè¿™ä½¿å…¶å¯ä»¥å‡†ç¡®åœ°è§£é‡Šç”¨æˆ·è¾“å…¥çš„æç¤ºè¯ï¼Œå¹¶ç”Ÿå¯ä»¥è¡¨è¾¾ä¸°å¯Œæƒ…æ„Ÿçš„ã€é€¼çœŸçš„è§’è‰²ã€‚åœ¨ä¸€æ¬¡ç”Ÿæˆçš„è¿™ä¸ªè§†é¢‘ä¸­ï¼ŒSora å¯ä»¥åˆ›å»ºå¤šä¸ªé•œå¤´ï¼Œå¹¶å¯ä»¥åœ¨ä¸åŒçš„é•œå¤´ä¸­ä¿æŒè§’è‰²å’Œè§†è§‰é£æ ¼çš„ä¸€è‡´ã€‚è§†é¢‘æ˜¯ç”±é•œå¤´æ„æˆçš„ï¼Œé•œå¤´æ˜¯è§†é¢‘å±•ç°å…¶èƒŒåäººæ–‡ç‰¹æ€§çš„åŸºæœ¬è¯­è¨€ã€‚ç”µå½±ã€Šç–¯ç‹‚çš„èµ›è½¦ã€‹å…±æœ‰ 2400 ä¸ªé•œå¤´ï¼Œå¹³å‡é•œå¤´æ—¶é•¿ä¸º 2.5Sï¼Œã€Šè®©å­å¼¹é£ã€‹å…±æœ‰ 4000 ä¸ªé•œå¤´ï¼Œå…¶å¹³å‡é•œå¤´æ—¶é•¿ä¸º 1.92 Sã€‚ä»å¹³å‡é•œå¤´æ—¶é•¿çœ‹ï¼ŒSora ç”Ÿæˆçš„è§†é¢‘ä¸­å¯ä»¥åŒ…å«å¤šè¾¾ 30 ä¸ªé•œå¤´ï¼Œè¿™è¶³ä»¥è®©ç”Ÿæˆçš„è§†é¢‘å…·å¤‡æ›´ä¸°å¯Œçš„è¡¨ç°èƒ½åŠ›ã€‚</p>
<video poster="/2024/02/22/Sora-the-starlight-in-the-long-night-of-AGI/1.jpg" autoplay="autoplay" id="videojs1" class="video-js vjs-16-9" controls preload="auto"><source src="https://cdn.openai.com/sora/videos/tokyo-walk.mp4" type="video/mp4"></video><link href="/libs/videojs2/videojs.css" rel="stylesheet"><script src="/libs/videojs2/video.min.js"></script><script src="/libs/videojs2/zh-CN.min.js"></script><script src="/libs/videojs2/videojs.hotkeys.min.js"></script><script>player1=videojs("videojs1",{language:"zh-CN",responsive:true,plugins:{hotkeys:{alwaysCaptureHotkeys:true},},});</script><link rel="stylesheet" href="/libs/videojs2/mytoast.css"><script src="/libs/videojs2/mytoast.js"></script><script>toast_init(player1)</script><link rel="stylesheet" href="/libs/videojs2/videojs-mobile-ui.css"><script src="/libs/videojs2/videojs-mobile-ui.min.js"></script><script>player1.mobileUi();</script><script src="/libs/videojs2/videojs-remember.min.js"></script><script>videojs(document.querySelector("video")).remember({"localStorageKey": "videojs.remember.myvideo"});</script>
<p>å¦‚ä¸Šçš„è§†é¢‘å°† Sora çš„ä¼˜åŠ¿ä½“ç°çš„æ·‹æ¼“å°½è‡´ï¼Œå½“æˆ‘ç¬¬ä¸€æ¬¡è§åˆ°è¿™ä¸ªè§†é¢‘çš„æ—¶å€™ï¼Œæˆ‘ä¹Ÿè¢«è§†é¢‘çš„é€¼çœŸç¨‹åº¦æƒŠæ‰äº†ä¸‹å·´ã€‚</p>
<ul>
<li>å¯¹å…‰å½±çš„æ¨¡æ‹Ÿï¼Œå¯¹ä¸»è§’å’ŒèƒŒæ™¯äººç‰©çš„å¤„ç†éƒ½è¡¨ç°çš„éå¸¸é€¼çœŸã€‚</li>
<li>å¯¹é‡‡ç”¨â€œè·Ÿâ€é•œå¤´çš„æ–¹å¼æ¥æ‹æ‘„ä¸»è§’çš„é•œå¤´è¿åŠ¨æ–¹å¼å’Œè½¨è¿¹ä¹Ÿéå¸¸çœŸå®ã€‚</li>
<li>å½“è·¯è¾¹çš„å¹¿å‘Šç‰Œè·Ÿéšè€…é•œå¤´çš„è¿åŠ¨é€æ¸å‡ºç°ï¼Œå¹¶ä»è¿‘æ™¯æ…¢æ…¢å˜ä¸ºè¿œæ™¯çš„æ—¶å€™ï¼Œå¹¿å‘Šç‰Œä¸Šçš„å­—ä½“ä¹Ÿæ…¢æ…¢å˜å¾—æ¨¡ç³Šï¼Œå¹¶ä¸”åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­è§†é¢‘ä¸æ¯«æ²¡æœ‰å‡ºç°è·³è·ƒã€‚</li>
<li>åœ¨è§†é¢‘çš„ç¬¬ 36S å¤„ï¼Œè§†é¢‘ä»å…¨æ™¯é•œå¤´ä¸æ»‘åˆ‡æ¢åˆ°äº†ç‰¹å†™é•œå¤´ï¼Œå¢¨é•œçš„åå…‰æ•ˆæœã€è„¸éƒ¨çš®è‚¤ã€å¤´å‘çš„æ•ˆæœã€ä¸»è§’çš„è¡¨æƒ…æ›´æ˜¯ç›¸å½“é€¼çœŸã€‚</li>
</ul>
<p>æˆ‘ä»¬ä¹‹æ‰€ä»¥æ„Ÿè§‰åˆ° Sora ç”Ÿæˆçš„è§†é¢‘å¦‚æ­¤çš„é€¼çœŸï¼Œæ˜¯å› ä¸º Sora ä¸ä»…ä»…æ˜¯åœ¨æ“ä½œåƒç´ ã€å›¾å½¢ï¼Œè€Œæ˜¯åœ¨æ…¢æ…¢çš„å­¦ä¹ ç‰©ç†ä¸–ç•Œçš„è§„å¾‹ã€‚å°±åƒ ChatGTP é€šè¿‡å¤§é‡çš„æ•°æ®æ¥ç†è§£äººç±»è¯­è¨€ä½“ç³»ä¸€æ ·ï¼ŒSora æ­£åœ¨é€šè¿‡å¤§é‡çš„è§†è§‰æ•°æ®æ¥ç†è§£ç‰©ç†ä¸–ç•Œçš„æ³•åˆ™â€”â€”è§†è§‰æ•°æ®ä¸­çš„ä¿¡æ¯æ˜¯å¯¹çœŸå®ç‰©ç†ä¸–ç•Œçš„æ˜ å°„ï¼Œè¿™æ‰æ˜¯ Sora æœ€ä»¤äººæƒŠå¥‡çš„åœ°æ–¹ã€‚</p>
<p>Sora å¯ä»¥ç†è§£ç”»é¢ï¼Œç†è§£ç”»é¢ä¸Šçš„è§’è‰²å’Œå®ä½“ï¼Œå¹¶ç†è§£å®ä½“ä¹‹é—´çš„ç›¸äº’å…³ç³»å’Œç‰©ç†è§„å¾‹ã€‚ChatGPT é€šè¿‡ç†è§£äººç±»è¯­è¨€å®ç°äº† AI å’Œäººçš„äº’åŠ¨ï¼ŒSora é€šè¿‡ç†è§£ç‰©ç†ä¸–ç•Œåˆ™å¯èƒ½ä¼šå®ç° AI å’Œä¸–ç•Œçš„äº’åŠ¨ï¼Œè¿™æ˜¯æ—¢ ChatGPT ä»¥æ¥ï¼Œ AGI é“è·¯ä¸Šçš„åˆä¸€åº§é‡Œç¨‹ç¢‘ã€‚</p>
<p>æ­£å¦‚ OpenAI åœ¨ Sora æŠ€æœ¯æŠ¥å‘Šä¸­æ‰€è¯´çš„é‚£æ ·<sup class="footnote-ref"><a href="#fn5" id="fnref5:1">[5:1]</a></sup>ï¼š</p>
<blockquote>
<p>Our results suggest that scaling video generation models is a promising path towards building general purpose simulators of the physical world.</p>
</blockquote>
<p>ä¹Ÿæ­£å¦‚ OpenAI åœ¨å…¶ä½¿å‘½å’Œæ„¿æ™¯ä¸­æ‰€è¯´çš„é‚£æ ·<sup class="footnote-ref"><a href="#fn6" id="fnref6">[6]</a></sup>ï¼š</p>
<blockquote>
<p>Our mission is to ensure that artificial general intelligenceâ€”AI systems that are generally smarter than humansâ€”benefits all of humanity.</p>
</blockquote>
<h2 id="sora-çš„ä¸è¶³">Sora çš„ä¸è¶³</h2>
<p>ä»ç›®å‰ Sora ç”Ÿæˆçš„è§†é¢‘æ¥çœ‹ï¼Œå³ä¾¿ Sora å·²ç»ä»¤æˆ‘ä»¬ç›¸å½“å…´å¥‹ï¼Œä½†æ˜¯ä¹Ÿä¾ç„¶å­˜åœ¨å¾ˆå¤šä¸è¶³ã€‚æ‰€æœ‰çš„è¿™äº›ä¸è¶³ï¼ŒOpenAI åœ¨å…¶å®˜æ–¹ä»‹ç»é¡µé¢ä¹Ÿéƒ½ç»™äº†å¯¹åº”çš„ç”Ÿæˆè§†é¢‘ï¼Œå¹¶ä¸”ç»™å‡ºäº†å¯¹åº”è§†é¢‘ä¸­å­˜åœ¨çš„é—®é¢˜ã€‚</p>
<ul>
<li>å¯¹äºæŸäº›å¤æ‚çš„åœºæ™¯ï¼ŒSora å¾ˆéš¾å‡†ç¡®æ¨¡æ‹Ÿè¿™äº›å¤æ‚åœºæ™¯çš„ç‰©ç†ç‰¹æ€§ï¼Œä¹Ÿå¯èƒ½æ— æ³•ç†è§£è¿™äº›åœºæ™¯ä¸­å­˜åœ¨çš„å¯¹è±¡ä¹‹é—´çš„å› æœå…³ç³»ã€‚ä¾‹å¦‚ï¼š
<ul>
<li>ä¸€ä¸ªäººå’¬äº†ä¸€å£é¥¼å¹²ï¼Œä½†æ˜¯é¥¼å¹²å¯èƒ½æ²¡æœ‰å’¬ç—•</li>
<li>ä¸€ä¸ªäººåœ¨å¹ç”Ÿæ—¥è›‹ç³•ä¸Šçš„èœ¡çƒ›ï¼Œä½†æ˜¯èœ¡çƒ›çš„ç«ç„°å´æ²¡æœ‰ç†„ç­</li>
</ul>
</li>
<li>Sora è¿˜å¯èƒ½ä¼šæ··æ·†ç”¨æˆ·æç¤ºè¯ä¸­çš„ç©ºé—´ç»†èŠ‚ï¼ˆæ··æ·†å·¦å³ï¼‰ã€‚</li>
</ul>
<video poster="/2024/02/22/Sora-the-starlight-in-the-long-night-of-AGI/2.jpg" autoplay="autoplay" id="videojs2" class="video-js vjs-16-9" controls preload="auto"><source src="https://cdn.openai.com/sora/videos/grandma-birthday.mp4" type="video/mp4"></video><link href="/libs/videojs2/videojs.css" rel="stylesheet"><script src="/libs/videojs2/video.min.js"></script><script src="/libs/videojs2/zh-CN.min.js"></script><script src="/libs/videojs2/videojs.hotkeys.min.js"></script><script>player2=videojs("videojs2",{language:"zh-CN",responsive:true,plugins:{hotkeys:{alwaysCaptureHotkeys:true},},});</script><link rel="stylesheet" href="/libs/videojs2/mytoast.css"><script src="/libs/videojs2/mytoast.js"></script><script>toast_init(player2)</script><link rel="stylesheet" href="/libs/videojs2/videojs-mobile-ui.css"><script src="/libs/videojs2/videojs-mobile-ui.min.js"></script><script>player2.mobileUi();</script><script src="/libs/videojs2/videojs-remember.min.js"></script><script>videojs(document.querySelector("video")).remember({"localStorageKey": "videojs.remember.myvideo"});</script>
<h2 id="sora-çš„ç›¸å…³æŠ€æœ¯">Sora çš„ç›¸å…³æŠ€æœ¯</h2>
<p>åœ¨ Sora çš„æŠ€æœ¯æ–‡æ¡£ <a href="https://openai.com/research/video-generation-models-as-world-simulators">Video generation models as world simulators</a> ä¸­ï¼ŒOpenAI ä»‹ç»äº† Sora æ¨¡å‹çš„èƒ½åŠ›å’Œç”¨åˆ°çš„ç›¸å…³æŠ€æœ¯ï¼Œä½†æ˜¯å¯¹äº Sora æ¨¡å‹çš„å…·ä½“æŠ€æœ¯ç»†èŠ‚å¹¶æ²¡æœ‰è¿›è¡Œè¿‡å¤šçš„æŠ«éœ²ã€‚</p>
<ul>
<li>æŠŠ Visual Patches ä½œä¸º Visual Tokensï¼Œè¿›è€Œç»Ÿä¸€äº†æ–‡æœ¬ã€å›¾åƒã€è§†é¢‘çš„ç”Ÿæˆå¼æ¨¡å‹æ¶æ„ã€‚ä¸è¿‡ Visual Tokens å¹¶éæ˜¯ OpenAI çš„åŸåˆ›ï¼Œè€Œæ˜¯å€Ÿé‰´äº†è°·æ­Œçš„ magvit<sup class="footnote-ref"><a href="#fn7" id="fnref7">[7]</a></sup> <sup class="footnote-ref"><a href="#fn8" id="fnref8">[8]</a></sup> çš„æ€è·¯ã€‚</li>
<li>Diffusion Modelsï¼Œæ­£å¦‚æŠ€æœ¯æŠ¥å‘Šä¸­æ‰€è¿°ï¼š<em>Sora is a diffusion model, given input noisy patches (and conditioning information like text prompts), itâ€™s trained to predict the original â€œcleanâ€ patches. <strong>Importantly, Sora is a diffusion transformer.</strong></em> è€Œè¿™ä¸ªæŠ€æœ¯æœ€åˆæ˜¯ç”± Bill å’Œ è°¢èµ›å®åœ¨è®ºæ–‡ <a href="https://arxiv.org/abs/2212.09748">Scalable Diffusion Models with Transformers</a><sup class="footnote-ref"><a href="#fn9" id="fnref9">[9]</a></sup> æå‡ºçš„ã€‚è¿™ä¹Ÿå¯¼è‡´å½“ Sora åˆšå‘å¸ƒçš„çš„æ—¶å€™ï¼Œç½‘ä¸Šæœ‰è‡ªåª’ä½“è¯¯ä¼  Sora çš„ä½œè€…æ˜¯ è°¢èµ›å®çš„ä¹Œé¾™äº‹ä»¶ï¼Œä¹‹å è°¢èµ›å®ä¹Ÿåœ¨ Twitter ä¸Šå¯¹æ­¤ä½œäº†è§£é‡Šå’Œå›åº”ã€‚</li>
<li>Autoregressive Transformersï¼Œä¸ºäº†è®© DiT æ”¯æŒè‡ªå›å½’ Diffusionï¼ŒSora å€Ÿé‰´äº†è°·æ­Œåœ¨ <a href="https://arxiv.org/abs/2312.06662">Photorealistic Video Generation with Diffusion Models</a> ä¸­æåˆ°çš„ W.A.L.T æ–¹æ¡ˆã€‚</li>
</ul>
<p>æ›´å¤šçš„æŠ€æœ¯è§£è¯»å¯ä»¥å‚è€ƒçº¢åšå£«çš„ <a href="https://mp.weixin.qq.com/s/H8UYQ27nNPbW2jetseJgYQ">å»é­… Sora: OpenAI é²œè‚‰å°ç»„çš„å°è¯•ç‰›åˆ€</a>ï¼Œæ­¤å¤„ä¸å†ä¸€ä¸€ä»‹ç»ã€‚</p>
<p>å¾®è½¯ç ”ç©¶é™¢å’Œç†æµ·å¤§å­¦çš„ç ”ç©¶è€…æ ¹æ®å·²å‘è¡¨çš„æŠ€æœ¯æŠ¥å‘Šå’Œé€†å‘å·¥ç¨‹ï¼Œé¦–æ¬¡åœ¨è®ºæ–‡ <em>Sora: A Review on Background, Technology, Limitations, and Opportunities of Large Vision Models</em> ä¸­å…¨é¢å›é¡¾äº† Sora çš„èƒŒæ™¯ã€ç›¸å…³æŠ€æœ¯ã€æ–°å…´åº”ç”¨ã€å½“å‰å±€é™å’Œæœªæ¥æœºé‡<sup class="footnote-ref"><a href="#fn10" id="fnref10">[10]</a></sup>ã€‚</p>
<h2 id="sora-çš„æ€è€ƒ">Sora çš„æ€è€ƒ</h2>
<p>æ‰€ä»¥ï¼Œæ•´ä½“ä¸Šçœ‹ Sora å¹¶æ²¡æœ‰å‘æ˜æ–°çš„æŠ€æœ¯ï¼Œåªæ˜¯å¯¹åŸæœ‰æŠ€æœ¯çš„æ•´åˆè€Œå·²ã€‚ä½†æ˜¯è¿™æ°æ°æ˜¯æˆ‘ä»¬è¯¥è®¤çœŸæ€è€ƒçš„æœ€é‡è¦çš„ç‚¹ã€‚éƒ½æ˜¯åŸæœ‰çš„æŠ€æœ¯ï¼Œè¿™äº›æŠ€æœ¯è®ºæ–‡ä¹Ÿéƒ½æ˜¯å…¬å¼€çš„ï¼Œä¸ºä»€ä¹ˆåœ¨ Sora ä¹‹å‰ï¼Œå´æ²¡æœ‰å‡ºç°å¦‚æ­¤æƒŠè‰³çš„ TTV æ•ˆæœå‘¢ï¼Ÿå•çº¯çš„æŠ€æœ¯æ‹¼å‡‘å¯ä»¥æ‹¼å‡‘å‡ºç±»ä¼¼ Sora çš„çªç ´æ€§äº§å“å—ï¼ŸåŒæ ·æ˜¯ç”¨ä¹é«˜çš„é›¶ä»¶ï¼Œä¸ºä»€ä¹ˆæœ‰çš„å¤§ç‰›å°±èƒ½<a href="https://zhuanlan.zhihu.com/p/336748815">ç”¨ 84000 ç‰‡ä¹é«˜æ‹¼æˆå®ä¼Ÿçš„ç´«ç¦åŸå‘¢</a>ï¼Œè€Œæœ‰äº›äººç¦»å¼€äº†å›¾çº¸å°±ä»€ä¹ˆä¹Ÿæ‹¼ä¸å‡ºæ¥å‘¢ï¼Ÿ</p>
<h3 id="é‰´å®šçš„è·µè¡Œèƒ½åŠ›">é‰´å®šçš„è·µè¡Œèƒ½åŠ›</h3>
<p>æˆ‘æƒ³ï¼Œä¹‹æ‰€ä»¥æ˜¯ OpenAI é¦–å…ˆå‘å¸ƒäº† Soraï¼Œè¿™é‡Œé¢è‚¯å®šæ˜¯æœ‰æŸäº›ç‰¹æ®Šçš„åŸå› çš„ã€‚åœ¨æˆ‘çœ‹æ¥ <strong>æ€ç»´æ–¹å¼çš„å¤šæ ·æ€§</strong> ä»¥åŠå…¶ <strong>åšå®šçš„è·µè¡Œèƒ½åŠ›</strong> æ˜¯éå¸¸é‡è¦çš„å› ç´ ã€‚</p>
<p>ä» <em>A Survey on ChatGPT and Beyond</em><sup class="footnote-ref"><a href="#fn11" id="fnref11">[11]</a></sup> ä¸­çš„å¤§è¯­è¨€æ¨¡å‹æ—è°±ä¸­æˆ‘ä»¬ä¹Ÿèƒ½å‘ç°ï¼ŒGPT åœ¨å‘å±•ä¹‹åˆå°±æ²¡æœ‰é‡‡ç”¨å½“æ—¶è‡ªç¼–ç çš„ä¸»æµæ–¹æ¡ˆï¼Œè€Œæ˜¯é‡‡ç”¨äº†å¾ˆå°‘æœ‰äººæ¶‰è¶³çš„è‡ªå›å½’çš„åˆ†æ”¯ï¼Œè¿™å¯¹ OpenAI çš„ç§‘ç ”å·¥ä½œè€…è€Œè¨€ï¼Œéœ€è¦éå¸¸å¤§çš„å‹‡æ°”å’Œæ¯…åŠ›ã€‚æ„Ÿè°¢ OpenAI çš„å¤§èƒ†å’Œé­„åŠ›ï¼Œæˆ‘ä»¬æ‰å°½å¯èƒ½æ—©çš„æ„Ÿå—åˆ°äº† AI å¤§æ¨¡å‹çš„å¼ºå¤§æ€§èƒ½ã€‚</p>
<p><img src="https://wangwei1237.github.io/LLM_in_Action/images/LLMTree.jpeg" alt="å¤§è¯­è¨€æ¨¡å‹æ—è°±"></p>
<p>è€Œè¿™æ ·çš„å¤§èƒ†ï¼Œå¹¶éæ˜¯åŒ¹å¤«ä¹‹å‹‡ï¼Œè€Œæ˜¯é€šè¿‡ä¸æ–­å®è·µã€å®éªŒæ¥ä¸æ–­å¼ºåŒ–å¯¹æŠ€æœ¯æ–¹å‘çš„åˆ¤æ–­ã€‚åœ¨ <em>Scaling Laws for Neural Language Models</em><sup class="footnote-ref"><a href="#fn12" id="fnref12">[12]</a></sup> ä¸­ï¼Œä»–ä»¬æåˆ°ï¼š</p>
<blockquote>
<p>We study <strong>empirical scaling laws</strong> for language model performance on the cross-entropy loss. The loss scales as a power-law with model size, dataset size, and the amount of compute used for training, with some trends spanning more than seven orders of magnitude. Other architectural details such as network width or depth have minimal effects within a wide range.</p>
</blockquote>
<p>åœ¨ Sora çš„æŠ€æœ¯æ–‡æ¡£ä¸­ï¼Œæˆ‘ä»¬åˆçœ‹åˆ°ï¼š</p>
<blockquote>
<p>We <strong>explore large-scale training of generative models on video data</strong>.</p>
</blockquote>
<p>ä» GPT çš„æ¼”è¿›å†ç¨‹<sup class="footnote-ref"><a href="#fn13" id="fnref13">[13]</a></sup>æˆ‘ä»¬ä¹Ÿèƒ½æ„Ÿå—åˆ°ï¼Œä» 2018 å¹´ï½2022 å¹´ï¼Œåœ¨é•¿è¾¾ 5 å¹´å¤šçš„æ—¶é—´é‡Œï¼ŒOpenAI ä¸€æ­¥ä¸€æ­¥é€šè¿‡æ¢ç´¢å’Œå®è·µï¼Œè®©å¤§æ¨¡å‹åº”è¯¥å…·å¤‡çš„ç›¸å…³èƒ½åŠ›ä¸€ç‚¹ä¸€ç‚¹çš„æµ®å‡ºæ°´é¢ï¼Œè¿›å…¥æˆ‘ä»¬çš„è§†é‡ã€‚</p>
<p>å®è·µæ˜¯æ£€éªŒçœŸç†çš„å”¯ä¸€æ ‡å‡†ï¼Œæƒ³å°½ä¸€åˆ‡åŠæ³•è®©å®è·µè¾¹çš„å¯è¡Œï¼šæ‰©å¤§æ•°æ®è§„æ¨¡ï¼Œå¢å¼ºæ•°æ®è´¨é‡ï¼Œæ‰©å¤§æ¨¡å‹è§„æ¨¡â€¦â€¦</p>
<h3 id="å¼ºå¤§çš„å·¥ç¨‹èƒ½åŠ›">å¼ºå¤§çš„å·¥ç¨‹èƒ½åŠ›</h3>
<p>å½“ä¸è¯¥å‘ç”Ÿçš„äº‹æƒ…å‘ç”Ÿäº†ï¼Œç§‘å­¦å°±éœ€è¦ç™»åœºäº†ï¼›å½“è¯¥å‘ç”Ÿçš„äº‹æƒ…æ²¡æœ‰å‘ç”Ÿï¼Œå·¥ç¨‹å°±éœ€è¦ç™»åœºäº†ã€‚OpenAI å¼ºå¤§çš„æŠ€æœ¯æ•´åˆèƒ½åŠ›å’Œå·¥ç¨‹åŒ–èƒ½åŠ›æ˜¯ Sora å¯ä»¥æˆåŠŸçš„å¦ä¸€ä¸ªå› ç´ ã€‚</p>
<p>è™½ç„¶ Sora ç”¨åˆ°çš„å¤§éƒ¨åˆ†çš„æŠ€æœ¯éƒ½æ˜¯ç°æˆçš„æŠ€æœ¯ï¼Œä½†æ˜¯ä¸ºäº†åœ¨å·¥ç¨‹ä¸Šå°†å…¶æ•´åˆåˆ°ä¸€èµ·ä»è€Œå®ç° Sora çš„æ•ˆæœï¼Œæ•´ä¸ªå›¢é˜Ÿä½œäº†éå¸¸å¤šçš„äº‹æƒ…ï¼š</p>
<ul>
<li>æ•´åˆ DiT<sup class="footnote-ref"><a href="#fn9" id="fnref9:1">[9:1]</a></sup> å’Œ W.A.L.T<sup class="footnote-ref"><a href="#fn7" id="fnref7:1">[7:1]</a></sup>ã€‚</li>
<li>åœ¨è®­ç»ƒé˜¶æ®µï¼Œåˆ©ç”¨ GPT ç»™è§†é¢‘æ ‡æ³¨ Caption æ•°æ®ï¼Œåœ¨æ¨ç†é˜¶æ®µï¼Œåˆ©ç”¨ GPT æ‰©å†™ç”¨æˆ·è¾“å…¥çš„ Promptï¼Œè¿™ä½¿å¾— Sora å¯ä»¥ç”Ÿæˆç²¾å‡†éµå¾ªç”¨æˆ·æŒ‡ä»¤çš„é«˜è´¨é‡çš„è§†é¢‘ã€‚</li>
<li>ç”Ÿäº§äº†è¶³å¤Ÿè§„æ¨¡ã€è´¨é‡è¶³å¤Ÿå¤§çš„æ ‡æ³¨æ•°æ®ï¼Œåšè¿‡æ ‡æ³¨çš„åº”è¯¥éƒ½å¯ä»¥ç†è§£åˆ°è¿™é‡Œçš„éš¾åº¦ç©¶ç«Ÿæœ‰å¤šå¤§ã€‚</li>
<li>æå‡ºäº†é€šç”¨è§†è§‰æ•°æ®æ¨¡å‹ï¼Œä»è€Œå¯ä»¥ä¸å†åƒä¹‹å‰çš„æ–¹æ³•é‚£æ ·éœ€è¦å¯¹ä¸åŒçš„è§†è§‰æ•°æ®è¿›è¡Œç‰¹å®šçš„å¤„ç†ã€‚</li>
<li>â€¦â€¦</li>
</ul>
<p>æˆ‘ä»¬çš„å·¥ç¨‹èƒ½åŠ›äº§å‡ºäº†å¤šå°‘åƒä¸‹å›¾é‚£æ ·çš„ç³»ç»Ÿï¼Ÿ</p>
<p><img src="https://wangwei1237.github.io/2021/09/11/How-to-Read-and-Use-the-Open-Source-Projects/2.png" alt></p>
<p>åœ¨ GPT-4 çš„æŠ€æœ¯æŠ¥å‘Šä¸­<sup class="footnote-ref"><a href="#fn14" id="fnref14">[14]</a></sup>ï¼ŒOpenAI æåˆ°ä»–ä»¬å¯ä»¥åšåˆ°ï¼šåœ¨å°è§„æ¨¡çš„è®¡ç®—æˆæœ¬ä¸‹è®­ç»ƒå‡ºæ¥çš„æ¨¡å‹ï¼Œå¯ä»¥å‡†ç¡®é¢„ä¼°åˆ°åœ¨è®¡ç®—æˆæœ¬æ‰©å¤§ä¹‹åï¼Œæ¨¡å‹çš„æ€§èƒ½å°†ä¼šæ€æ ·ï¼Ÿè¿™å¯¹äºåƒ GPT4 è¿™æ ·è®­ç»ƒä¸€æ¬¡å°±è¦è€—è´¹å‡ å‘¨ç”šè‡³ä¸Šæœˆçš„å¤§æ¨¡å‹è€Œè¨€ï¼Œå…¶æ•ˆç‡æå‡çœŸçš„æ˜¯å¦‚è™æ·»ç¿¼ã€‚</p>
<blockquote>
<p>A large focus of the GPT-4 project was building a deep learning stack that scales predictably. The primary reason is that for very large training runs like GPT-4, it is not feasible to do extensive model-specific tuning. To address this, we developed infrastructure and optimization methods that have very predictable behavior across multiple scales. These improvements allowed us to reliably predict some aspects of the performance of GPT-4 from smaller models trained using 1, 000Ã— â€“ 10, 000Ã— less compute.</p>
</blockquote>
<p>æ‰€ä»¥æˆ‘ä»¬è®²ï¼Œç§‘å­¦å’ŒæŠ€æœ¯å†³å®šäº†äº§å“çš„ä¸Šé™ï¼Œå·¥ç¨‹èƒ½åŠ›å†³å®šäº†äº§å“çš„ä¸‹é™ï¼Œç§‘å­¦å’ŒæŠ€æœ¯å¯ä»¥è¯•é”™ï¼Œä½†æ˜¯å·¥ç¨‹èƒ½åŠ›åŠ¡å¿…è®²ç©¶ç²¾ç›Šæ±‚ç²¾ï¼Œå”¯æœ‰ç²¾ç›Šæ±‚ç²¾çš„å·¥ç¨‹èƒ½åŠ›æ‰èƒ½äº§ç”Ÿè¶³å¤ŸæƒŠè‰³çš„æ•ˆæœã€‚</p>
<h2 id="åè®°">åè®°</h2>
<p>éšç€ Sora çš„çˆ†ç«ï¼Œè¶Šæ¥è¶Šå¤šçš„å…¬å¸ä¹Ÿå¼€å§‹å‘å¸ƒæ–°çš„æŠ€æœ¯ï¼š</p>
<ul>
<li>2 æœˆ 22 æ—¥ï¼ŒStability AI å‘å¸ƒäº† <a href="https://stability.ai/news/stable-diffusion-3">Stable Diffusion 3</a>ï¼Œä»å…¶å®˜æ–¹å±•ç¤ºçš„æ•ˆæœçœ‹ï¼ŒSD3 åœ¨æ–‡å­—æ‹¼å†™ã€è‰²å½©åè°ƒã€å›¾ç‰‡é€¼çœŸåº¦ç­‰å„ä¸ªæ–¹é¢éƒ½è¡¨ç°æƒŠäººã€‚</li>
</ul>
<h2 id="å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</h2>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p><a href="https://twitter.com/billpeeb/status/1758194105111269697?s=20">Sora is here!</a> <a href="#fnref1" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn2" class="footnote-item"><p><a href="https://news.cctv.com/2024/02/20/ARTINzD0eOR0jQxxVZxibLQT240220.shtml">Sora çˆ†ç« 96 å°æ—¶</a> <a href="#fnref2" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn3" class="footnote-item"><p><a href="https://www.toutiao.com/article/7337293210861388303/">æ–°æ¨¡å‹ Sora çˆ†ç«ï¼ŒOpenAI ä¼°å€¼ä¸åˆ° 10 ä¸ªæœˆå¢åŠ è¿‘ä¸¤å€</a> <a href="#fnref3" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn4" class="footnote-item"><p><a href="https://openai.com/sora">Creating video from text</a> <a href="#fnref4" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn5" class="footnote-item"><p><a href="https://openai.com/research/video-generation-models-as-world-simulators">Video generation models as world simulators</a> <a href="#fnref5" class="footnote-backref">â†©ï¸</a> <a href="#fnref5:1" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn6" class="footnote-item"><p><a href="https://openai.com/about">OpenAI Vision</a> <a href="#fnref6" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn7" class="footnote-item"><p><a href="https://github.com/google-research/magvit">google-research/magvit</a> <a href="#fnref7" class="footnote-backref">â†©ï¸</a> <a href="#fnref7:1" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn8" class="footnote-item"><p><a href="https://arxiv.org/abs/2212.05199">MAGVIT: Masked Generative Video Transformer</a> <a href="#fnref8" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn9" class="footnote-item"><p><a href="https://arxiv.org/abs/2212.09748">Scalable Diffusion Models with Transformers</a> <a href="#fnref9" class="footnote-backref">â†©ï¸</a> <a href="#fnref9:1" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn10" class="footnote-item"><p><a href="https://arxiv.org/abs/2402.17177">Sora: A Review on Background, Technology, Limitations, and Opportunities of Large Vision Models</a> <a href="#fnref10" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn11" class="footnote-item"><p><a href="https://arxiv.org/abs/2304.13712">Harnessing the Power of LLMs in Practice: A Survey on ChatGPT and Beyond</a> <a href="#fnref11" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn12" class="footnote-item"><p><a href="https://arxiv.org/abs/2001.08361">Scaling Laws for Neural Language Models</a> <a href="#fnref12" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn13" class="footnote-item"><p><a href="https://wangwei1237.github.io/LLM_in_Action/llm_intro.html">GPT çš„è´¡çŒ®</a> <a href="#fnref13" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn14" class="footnote-item"><p><a href="https://arxiv.org/abs/2303.08774">GPT-4 Technical Report</a> <a href="#fnref14" class="footnote-backref">â†©ï¸</a></p>
</li>
</ol>
</section>
]]></content>
      <categories>
        <category>LLM</category>
      </categories>
      <tags>
        <tag>TTV</tag>
        <tag>CG</tag>
        <tag>AGI</tag>
        <tag>æ–‡ç”Ÿè§†é¢‘</tag>
      </tags>
  </entry>
  <entry>
    <title>å¤§è¯çº¿ä¸Šäº‹æ•…</title>
    <url>/2023/11/26/Drama-talk-about-online-accidents/</url>
    <content><![CDATA[<p><img src="/2023/11/26/Drama-talk-about-online-accidents/1_1.png" alt></p>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition note"><p class="admonition-title">è¿™å°±æ˜¯å¾®æœåŠ¡ï¼Œè¿™å°±æ˜¯çº¿ä¸Šäº‹æ•…â€”â€”17å“¥
</p><p>å¾®æœåŠ¡æ¶æ„è™½ç„¶è§£å†³äº†å•ä½“æ¶æ„ä¸‹çš„éƒ¨ç½²ã€è¿ç»´ã€æ‰©å±•ã€æ•ˆç‡ç­‰ç—›ç‚¹é—®é¢˜ï¼Œä½†æ˜¯å®ƒè®©ç³»ç»Ÿæ¶æ„å˜å¾—æ›´åŠ å¤æ‚ã€‚å¾ˆå¤šæ—¶å€™ï¼Œå¾®æœåŠ¡æ¶æ„ç”¨çš„ä¸å¥½ï¼Œå°±å¾ˆå®¹æ˜“å½¢æˆåˆ†å¸ƒå¼å•ä½“çš„æ•ˆæœï¼Œæœ€ç»ˆå¯¼è‡´å¾ˆå¤šéé¢„æœŸçš„çº¿ä¸Šé—®é¢˜ã€‚</p>
<p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå½“æˆ‘ä»¬å…´å†²å†²çš„å‘ç°äº†ä¸€ä¸ªçº¿ä¸Š BUGï¼Œæ»¡æ€€æ¿€åŠ¨çš„ä¿®å¤å¥½ï¼Œç„¶åä¸€è„¸éª„å‚²çš„ç‚¹ä¸‹å‘å¸ƒæŒ‰é’®ä¹‹åï¼Œæˆ‘ä»¬æ‰æ·±æ‚Ÿç—›å½»çš„ç†è§£äº†é‚£å¥ï¼šâ€œèƒ½è·‘å°±åˆ«åŠ¨å®ƒâ€ã€‚</p>
<p>æˆ‘çš„åŒäº‹å°†è‡ªå·±å·¥ä½œä¸­é‡åˆ°çš„ä¸€äº›çº¿ä¸Šé—®é¢˜çš„æ¡ˆä¾‹è¿›è¡Œäº†æç‚¼ã€æ€»ç»“ï¼Œç„¶åå½¢æˆäº†è¿™ç¯‡æ–‡ç« â€”â€”å…¶ä¸­å¾ˆå¤šæ¡ˆä¾‹å³æœ‰è¶£åˆç—›å¿ƒâ€”â€”å¸Œæœ›å¯¹å¤§å®¶æœ‰æ‰€å¸®åŠ©ã€‚</p>
</div>
<span id="more"></span>
<p>è¯´èµ·çº¿ä¸Šäº‹æ•…ï¼Œèµ„æ·±çš„ IT ä»ä¸šäººå‘˜ä¹Ÿéš¾å…â€œè°ˆè™è‰²å˜â€ã€‚å¯¹äºä¸€å¶æ‰èˆŸçš„å°å‹åˆåˆ›å…¬å¸ï¼Œå®ƒåƒç‹‚é£æš´é›¨ï¼Œè½»åˆ™ä½¿ä¹‹é£é›¨é£˜æ‘‡ï¼Œå¯¹äºæ³°å¦å°¼å…‹å·ç±»çš„å¤§å‹å…¬å¸ï¼Œåˆ™å¯èƒ½æ˜¯å±é™©çš„å†°å±±ï¼Œé‡åˆ™è‡´å…¶æŠ˜æˆŸæ²‰æ²™ã€‚</p>
<p>æœ¬æ–‡å°è¯•é€šè¿‡æµ…æ˜¾æ˜“æ‡‚çš„æ–¹å¼ï¼Œä»ç³»ç»Ÿè®¾è®¡çš„è§’åº¦å¯¹æŸäº›çº¿ä¸Šäº‹æ•…è¿›è¡ŒåŸå› åˆ†æå¹¶æ€»ç»“å…¶æ”¹è¿›æ–¹æ¡ˆï¼Œæ„¿â€œå“€ä¹‹é‰´ä¹‹ï¼Œä¸ä½¿åäººè€Œå¤å“€åäººä¹Ÿâ€ã€‚</p>
<ul>
<li>äº‹æ•…ä¸€ï¼šè¥¿ç“œå’ŒèŠéº»ä¸€èµ·èšŒåŸ ä½äº†â€“ç»„ä»¶ä¸Šçº¿å¯¼è‡´æœåŠ¡ä¸å¯ç”¨xåˆ†é’Ÿ</li>
<li>äº‹æ•…äºŒï¼šè¶…æ—¶è¿˜æ˜¯ä¸è¶…æ—¶ï¼Œè¿™æ˜¯ä¸ªé—®é¢˜â€“ä¸åˆç†çš„æ­¢æŸæ–¹æ¡ˆå¯¼è‡´æœåŠ¡å¤§é‡æ‹’ç»</li>
<li>äº‹æ•…ä¸‰ï¼šåˆ é™¤ä¸€æ¡æ•°æ®ï¼Œç³»ç»Ÿå´©æºƒäº†â€“ç‰µä¸€å‘è€ŒåŠ¨å…¨èº«ï¼Œä¸åˆç†çš„ç³»ç»Ÿæ¶æ„</li>
</ul>
<h2 id="äº‹æ•…ä¸€-è¥¿ç“œå’ŒèŠéº»ä¸€èµ·å®•æœºäº†">äº‹æ•…ä¸€ è¥¿ç“œå’ŒèŠéº»ä¸€èµ·å®•æœºäº†</h2>
<p><code>æ•…éšœæè¿°</code>ï¼šä¸é‡è¦çš„èŠéº»ç»„ä»¶å‘ç”Ÿé…ç½®å˜æ›´ï¼Œç”±äºçº¿ä¸Šç¨‹åºä¸å…¼å®¹ï¼Œå¯¼è‡´å…¶é‡å¯åæŒ‚æ‰ï¼Œé‡è¦çš„è¥¿ç“œç»„ä»¶ç”±äºé‡‡ç”¨åŒæ­¥é˜»å¡æ–¹å¼è°ƒç”¨äº†èŠéº»ç»„ä»¶ï¼Œè¿›è€Œæ— æ³•å†™å…¥å¡æ­»ï¼Œå¯¼è‡´å¤§é‡ç”¨æˆ·è®¿é—®æ‹’ç»</p>
<p><img src="/2023/11/26/Drama-talk-about-online-accidents/1.png" alt></p>
<p><code>ç»éªŒæ•™è®­</code>ï¼š</p>
<ul>
<li>å…³é”®ç‚¹ï¼šè¥¿ç“œé‡è¦ï¼Œç›¸å¯¹æ¥è¯´ï¼ŒèŠéº»ä¸é‡è¦ï¼ŒèŠéº»ä¸¢äº†ä¸åº”è¯¥è¥¿ç“œä¹Ÿä¸€èµ·è·Ÿç€ä¸¢æ‰ï¼Œéœ€è¦ä¿ä½è¥¿ç“œï¼ï¼</li>
<li>èŠéº»ç»„ä»¶æœªåšå¥½å‰å‘å…¼å®¹ï¼Œå¯¹äºä¸èƒ½è¯†åˆ«çš„é…ç½®ï¼Œæ²¡æœ‰ç»ˆæ­¢æ“ä½œ</li>
<li>ç»„ä»¶ä¹‹é—´çš„å¼º/å¼±è€¦åˆå…³ç³»éœ€è¦æ­£ç¡®å¤„ç†ï¼Œç³»ç»Ÿæ‰å…·å¤‡å®¹ç¾/è§£è€¦èƒ½åŠ›</li>
<li>ç”±äºç¨‹åºå¥å£®æ€§ä¸è¶³ï¼Œæ— æ³•è‡ªåŠ¨é‡å¯ï¼Œé€šè¿‡æ‰‹åŠ¨å‘å•æ“ä½œé‡å¯ï¼Œå¯¼è‡´å›æ»šç¯èŠ‚æŒç»­æ—¶é—´è¾ƒé•¿</li>
</ul>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition error"><p class="admonition-title">17å“¥ ç‚¹è¯„
</p><p>åƒé‡Œä¹‹å ¤æ¯äºèšç©´ï¼Œä¸€å¶æ‰èˆŸä¹‹é™©ä¹Ÿã€‚éœ€è¦é¢å‘æœåŠ¡æ•´ä½“è¿›è¡ŒæœåŠ¡ç­‰çº§çš„åˆ’åˆ†ï¼Œå¹¶åšå¥½æœåŠ¡é™çº§ã€å®¹ç¾ã€é™æµç­‰æªæ–½ã€‚</p>
<p>åœ¨å¾®æœåŠ¡æ¶æ„ä¸‹ï¼Œæ²¡æœ‰ä»€ä¹ˆæœåŠ¡æœ‰é«˜ä½è´µè´±ä¹‹åˆ†ï¼Œæ‰€æœ‰æœåŠ¡éƒ½æ˜¯å¹³ç­‰çš„ã€‚åœ¨æœåŠ¡æ¼”åŒ–çš„è¿›ç¨‹ä¸­ï¼Œè°èƒ½ä¿è¯æ‰€æœ‰äººéƒ½èƒ½æ„è¯†åˆ°æŸä¸ªæœåŠ¡æ˜¯å¼±ä¾èµ–ï¼Ÿè°åˆèƒ½ä¿è¯ï¼Œæ‰€æœ‰äººéƒ½åšäº†å®¹é”™çš„å…œåº•ï¼Ÿ</p>
</div>
<h2 id="äº‹æ•…äºŒ-è¶…æ—¶è¿˜æ˜¯ä¸è¶…æ—¶-è¿™æ˜¯ä¸ªé—®é¢˜">äº‹æ•…äºŒ è¶…æ—¶è¿˜æ˜¯ä¸è¶…æ—¶ï¼Œè¿™æ˜¯ä¸ªé—®é¢˜</h2>
<p><code>æ•…éšœæè¿°</code>ï¼šç½‘ç»œå¼‚å¸¸è§¦å‘äº† Redis ä¸»ä»å…¨é‡åŒæ­¥ï¼Œå¯¼è‡´ Redis è´Ÿè½½è¾ƒé«˜ï¼Œè¯»å†™æˆåŠŸç‡é™ä½ã€‚å¤„ç†è¯¥é—®é¢˜æ—¶ï¼Œå°†è¶…æ—¶æ—¶é—´é…ç½®ä¿®æ”¹ä¸º 0ï¼Œæ„å›¾å°è¯•å¿«é€Ÿè¶…æ—¶æ–­å¼€ Redis è¿æ¥ï¼Œè€Œ 0 çš„å«ä¹‰å®é™…ä¸ºä¸è¶…æ—¶ï¼Œæ“ä½œåé—®é¢˜è¿›ä¸€æ­¥æ‰©å¤§ï¼šPHP è¿›ç¨‹å¤¯ä½ï¼Œå¤§é‡è¯·æ±‚æ‹’ç»ï¼Œé—®é¢˜ç­‰çº§ä¸Šå‡ä¸ºäº‹æ•…ã€‚</p>
<p><img src="/2023/11/26/Drama-talk-about-online-accidents/2.png" alt></p>
<p><code>ç»éªŒæ•™è®­</code>ï¼š</p>
<ul>
<li>å­˜å‚¨å±‚æœªåŒºåˆ†æ ¸å¿ƒã€éæ ¸å¿ƒï¼Œå¯¼è‡´æ— æ³•å¯¹éæ ¸å¿ƒæ•°æ®è¿›è¡Œæ‘˜é™¤ï¼Œæ­¢æŸæ–¹æ¡ˆæœ¬èº«ä¸åˆç†</li>
<li>è¿æ¥å±‚çš„å¤„ç†ä¸Šï¼Œæœªå¯¹è¾¹ç•Œé…ç½®è¿›è¡Œå……åˆ†äº†è§£ï¼Œä»“ä¿ƒè¿›è¡Œè°ƒæ•´ï¼Œå¯¼è‡´æ•…éšœèŒƒå›´æ‰©å¤§</li>
<li>ç›‘æ§è§’åº¦ï¼Œåœ°åŸŸè¿é€šæ€§ç›‘æ§ï¼Œä¸»ä»åŒæ­¥ç›‘æ§æœ‰æ•ˆæ€§éœ€è¦æ£€æŸ¥</li>
</ul>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition error"><p class="admonition-title">17å“¥ ç‚¹è¯„
</p><p>åœ¨åˆ†å¸ƒå¼æ¶æ„ä¸‹ï¼ŒæœåŠ¡çš„çŠ¶æ€ä¸æ˜¯åªæœ‰ <code>æˆåŠŸ</code>ã€<code>å¤±è´¥</code> ä¸¤æ€ï¼Œè€Œæ˜¯ä¸‰æ€ï¼š<code>æˆåŠŸ</code>ã€<code>è¶…æ—¶</code>ã€<code>å¤±è´¥</code>ã€‚</p>
</div>
<h2 id="äº‹æ•…ä¸‰-åˆ é™¤ä¸€æ¡æ•°æ®-ç³»ç»Ÿå´©æºƒäº†">äº‹æ•…ä¸‰ åˆ é™¤ä¸€æ¡æ•°æ®ï¼Œç³»ç»Ÿå´©æºƒäº†</h2>
<p><code>æ•…éšœæè¿°</code>ï¼šåˆ é™¤ Redis çš„ä¸€ä¸ªå¤§ Keyï¼Œå¯¼è‡´åœ°åŸŸ Xã€Y æœºæˆ¿ Redis é˜»å¡ï¼ŒRedis ä¸å¯è¯»å†™ï¼Œåœ¨æ¨ªè·¨å¤šä¸šåŠ¡çº¿çš„ç³»ç»Ÿä¸­ï¼Œé€å±‚è§¦å‘é‡è¯•é£æš´ï¼Œæœ€ç»ˆ DB æµé‡æš´å¢è¢«å‹å®ï¼ŒåŒæ—¶å½±å“å…±ç”¨ DB çš„æ¨¡å— Bã€Cã€Dï¼Œå…¶ä¸­åŒ…å«æŸâ€œä¸€çº§æœåŠ¡ï¼ˆæ ¸å¿ƒï¼‰â€ï¼Œå¦å¤–ä¸Šæ¸¸æ¨¡å—ä¹Ÿè¢«æ‹–æ­»ï¼Œè¯·æ±‚å¤§é‡æ‹’ç»ã€‚</p>
<p><img src="/2023/11/26/Drama-talk-about-online-accidents/3.png" alt></p>
<p><code>ç»éªŒæ•™è®­</code>ï¼š</p>
<ul>
<li>ä¸åˆç†çš„é‡è¯•æ¬¡æ•°è®¾ç½®ï¼šåº•å±‚æœåŠ¡æŒ‚æ‰åï¼Œé€å±‚è§¦å‘é‡è¯•ï¼Œç–¯ç‹‚é‡è¯•</li>
<li>å…±ç”¨æ•°æ®åº“å¯ä»¥è€ƒè™‘æ‹†åˆ†ä¸éš”ç¦»ï¼Œä½¿ç”¨å¼‚æ­¥é˜Ÿåˆ—ç­‰</li>
<li>å¤§ Key åˆ é™¤å¯èƒ½å¯¼è‡´â€œå µæ°´ç®¡â€ï¼ˆredis ä¸»çº¿ç¨‹æ‰§è¡Œ delï¼‰ï¼Œ4.0 ä»¥åå¾—ç‰ˆæœ¬å¯ä»¥è€ƒè™‘ lazy free</li>
<li>åŒç†è€ƒè™‘ DB åˆ é™¤è®°å½•å¸¦æ¥çš„é”å‡çº§é£é™©</li>
</ul>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition error"><p class="admonition-title">17å“¥ ç‚¹è¯„
</p><p>ä¸çŸ¥é“å“ªä¸ªè§’è½çš„æŸå°è®¡ç®—æœºå‘ç”Ÿäº†æ•…éšœï¼Œå¯¼è‡´äº†æˆ‘ä»¬è‡ªå·±çš„ç”µè„‘æ— æ³•ä½¿ç”¨ï¼Œè¿™å°±æ˜¯åˆ†å¸ƒç³»ç»Ÿã€‚</p>
<p>å¦‚æœä½ ä¸äº†è§£æœåŠ¡çš„å…¨è²Œï¼Œé‚£ä¹ˆå°±ä¸è¦è½»æ˜“å»åŠ¨ä»»ä½•ä½ è§‰å¾—â€œå¹¶ä¸é‡è¦â€çš„ä¸œè¥¿ã€‚ä»»ä½•æ—¶å€™ï¼Œå¯¹çº¿ä¸Šéƒ½è¦ä¿æŒæ•¬ç•ï¼Œå¦‚æœä¸äº†è§£ï¼Œå°±åˆ«åŠ¨ï¼›å¦‚æœæƒ³åŠ¨ï¼Œå°±è¦å»åšå¥½å…¨é¢çš„äº†è§£ã€‚</p>
</div>
]]></content>
      <categories>
        <category>æ€»ç»“</category>
      </categories>
      <tags>
        <tag>è¿ç»´</tag>
        <tag>æ¶æ„</tag>
        <tag>çº¿ä¸Šäº‹æ•…</tag>
      </tags>
  </entry>
  <entry>
    <title>å¤§è¯­è¨€æ¨¡å‹å®è·µ</title>
    <url>/2023/11/05/LLM-in-Action/</url>
    <content><![CDATA[<p><img src="/2023/11/05/LLM-in-Action/1.png" alt></p>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition note"><p class="admonition-title">ä¹¦ç±é“¾æ¥
</p><ul>
<li><a href="https://wangwei1237.github.io/LLM_in_Action/">https://wangwei1237.github.io/LLM_in_Action/</a></li>
</ul>
</div>
<p>è¿™æ˜¯ä¸€æœ¬å…³äº <code>å¤§è¯­è¨€æ¨¡å‹</code> <strong>å®è·µ</strong>çš„ä¹¦ç±ï¼Œè€Œä¸æ˜¯ä¸€æœ¬æ·±å…¥ç ”ç©¶ <code>å¤§è¯­è¨€æ¨¡å‹</code> çš„è¿è¡ŒåŸç†å’Œåº•å±‚ç®—æ³•çš„ä¹¦ç±ã€‚å¦‚æœæ‚¨æ˜¯ä¸€ä½æƒ³æ·±å…¥å­¦ä¹ æ¡†æ¶ã€ç®—æ³•å¹¶å¯¹å…¶è¿›è¡Œä¼˜åŒ–æ”¹è¿›çš„ç ”ç©¶è€…ï¼Œæœ¬ä¹¦å¯èƒ½å¹¶ä¸é€‚åˆæ‚¨ã€‚å¦‚æœæ‚¨æƒ³å¤§æ¦‚äº†è§£ä¸€ä¸‹ç›¸å…³çš„æ¦‚å¿µï¼Œå¹¶ä»¥æ­¤æ¥æŒ‡å¯¼è‡ªå·±çš„å®è·µï¼Œæƒ³äº†è§£ç›®å‰åœ¨åº”ç”¨å¼€å‘ä¸­æœ‰å“ªäº›å·¥å…·ä»¥åŠè¿™äº›å·¥å…·çš„å…·ä½“å®è·µç”¨æ³•ï¼Œé‚£ä¹ˆè¿™æœ¬ä¹¦æ­£æ˜¯ä¸ºæ‚¨ä½ è€Œä½œã€‚</p>
<span id="more"></span>
<p>æœ¬ä¹¦çš„å®è·µå¤§éƒ¨åˆ†ä»¥æ–‡å¿ƒå¤§æ¨¡å‹ä¸ºä¸»ï¼Œæ­£å¦‚è¿™æœ¬ä¹¦çš„é¢˜ç›®ï¼Œè¿™æœ¬ä¹¦ä¼šæ›´åå‘<strong>å®è·µã€åº”ç”¨</strong>ï¼Œä½†æ˜¯æˆ‘ä»¬ä¹Ÿä¼šåœ¨æ•°æ®ä»‹ç»å¤§æ¨¡å‹ç›¸å…³çš„æ¦‚å¿µï¼Œè¿™äº›æ¦‚å¿µä¼šè®©æ‚¨å¯¹å¤§æ¨¡å‹æœ‰ä¸€ä¸ªåˆæ­¥çš„è®¤è¯†ï¼Œä»…æ­¤è€Œå·²ã€‚å¦‚æœæ‚¨æƒ³æ·±å…¥äº†è§£ç›¸å…³æ¦‚å¿µçš„åº•å±‚ç»†èŠ‚ï¼Œæˆ‘ä»¬ä¹Ÿæä¾›äº†å¯¹åº”çš„æ–‡çŒ®ï¼Œæ‚¨å¯ä»¥æ·±å…¥é˜…è¯»ç›¸å…³çš„æ–‡çŒ®ã€‚</p>
<p>è¿™æ˜¯ä¸€ä¸ªé£é€Ÿå‘å±•çš„æ—¶ä»£ï¼ŒæŠ€æœ¯ã€å·¥å…·çš„å‘å±•äº¦æ˜¯å¦‚æ­¤â€”â€”æ¯å¤©æœ‰æ–°çš„å·¥å…·äº§ç”Ÿï¼Œä¹Ÿä¼šæœ‰éƒ¨åˆ†æŠ€æœ¯è¿‡æ—¶â€”â€”å› æ­¤æˆ‘ä»¬ä»¥åœ¨çº¿ä¹¦ç±çš„æ–¹å¼æ¥æ„å»ºè¿™æœ¬ä¹¦ä»¥ä¿æŒå†…å®¹çš„ä¸æ—¶ä¿±è¿›ã€‚</p>
<p>ä½œä¸ºå¤§æ¨¡å‹é¢†åŸŸçš„éåŸè‘—å±…æ°‘ï¼Œæˆ‘ä»¬å°†è‡ªå·±åœ¨å®è·µä¸­æ¢ç´¢çš„è¿‡ç¨‹æ•´ç†åˆ°æœ¬ä¹¦ä¹‹ä¸­ï¼Œå¸Œæœ›å¸®åŠ©å’Œæˆ‘ä»¬ä¸€æ ·æ­£åœ¨å®è·µçš„å¤§æ¨¡å‹é¢†åŸŸçš„çˆ±å¥½è€…ã€‚è¿™æœ¬ä¹¦æ•´ä½“ä¼šåˆ†ä¸ºä¸‰å¤§éƒ¨åˆ†ï¼š</p>
<ul>
<li>PART 1ï¼šåŸºæœ¬æ¦‚å¿µç¯‡ï¼Œä¸»è¦ä»‹ç»å¤§æ¨¡å‹ç›¸å…³çš„åŸºæœ¬æ¦‚å¿µ</li>
<li>PART 2ï¼šç›¸å…³å·¥å…·ç¯‡ï¼Œä¸»è¦ä»‹ç»å¤§æ¨¡å‹ç›¸å…³çš„å·¥å…·ï¼ŒLangChain, Langflow, AutoGenâ€¦â€¦</li>
<li>PART 3ï¼šå…·ä½“å®è·µåï¼Œä¸»è¦ä»‹ç»åº”ç”¨å¤§æ¨¡å‹çš„å…·ä½“æ¡ˆä¾‹</li>
</ul>
<p>è¿™ä¹Ÿæ˜¯ä¸€æœ¬å¼€æ”¾çš„ä¹¦ç±ï¼Œå¦‚æœæ‚¨å¸Œæœ›ä¸ºæœ¬ä¹¦è´¡çŒ®è‡ªå·±çš„åŠ›é‡ï¼Œæ‚¨å¯ä»¥è¿›å…¥ç‚¹å‡»æœ¬ä¹¦å¯¼èˆªæ å³ä¸Šè§’çš„<i class="fa fa-github" style="color:#0681D0"></i>å›¾æ ‡è¿›å…¥æœ¬ä¹¦çš„ä»£ç ä»“åº“ï¼Œæäº¤æ‚¨çš„å†…å®¹ã€‚</p>
]]></content>
      <categories>
        <category>LLM</category>
      </categories>
      <tags>
        <tag>LangChain</tag>
        <tag>OpenAI</tag>
        <tag>Ernie</tag>
        <tag>LLM</tag>
      </tags>
  </entry>
  <entry>
    <title>LangChain ç®€ä»‹</title>
    <url>/2023/09/20/Introduction-to-LangChain/</url>
    <content><![CDATA[<p><img src="/2023/09/20/Introduction-to-LangChain/langchain.png" alt></p>
<p>æˆ‘ä»¬ä¸æƒ³èŠ±æ›´å¤šçš„åŠ›æ°”æ¥å®ç°å’ŒLLMäº¤äº’çš„æµç¨‹ï¼Œè€Œæ˜¯æ›´å…³æ³¨äºä¸šåŠ¡é€»è¾‘çš„å®ç°ï¼›æˆ‘ä»¬ä¹Ÿä¸æƒ³é‡å¤ç¼–å†™ç›¸ä¼¼çš„æµç¨‹ä»£ç ï¼Œè€Œæ˜¯å¯ä»¥å…±äº«æˆ‘ä»¬çš„æˆæœï¼Œåˆ«äººåªéœ€è¦é”®å…¥ <code>docker pull</code> å°±å¯ä»¥ä½¿ç”¨æˆ‘ä»¬çš„æˆæœâ€¦â€¦å¦‚æœä½ æœ‰è¿™æ ·çš„æƒ³æ³•ï¼Œé‚£ä¹ˆ LangChain æ­£æ˜¯ä½ çš„èœ~</p>
<span id="more"></span>
<h2 id="langchain-çš„å‘å±•">LangChain çš„å‘å±•</h2>
<p>éšç€å¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰çš„å¼•å…¥ï¼Œè‡ªç„¶è¯­è¨€å¤„ç†å·²ç»æˆä¸ºäº’è”ç½‘ä¸Šçš„çƒ­é—¨è¯é¢˜ã€‚LangChain æ˜¯ä¸€ä¸ªå¼€æº Python æ¡†æ¶ï¼Œåˆ©ç”¨ LangChainï¼Œå¼€å‘äººå‘˜èƒ½å¤Ÿéå¸¸æ–¹ä¾¿çš„å¼€å‘åŸºäºå¤§å‹è¯­è¨€æ¨¡å‹çš„åº”ç”¨ç¨‹åºï¼ˆAI åŸç”Ÿåº”ç”¨ï¼‰ï¼Œä¾‹å¦‚ï¼šèŠå¤©æœºå™¨äººï¼Œæ‘˜è¦ï¼Œç”Ÿæˆå¼é—®ç­”â€¦â€¦ã€‚</p>
<p>LangChain è™½ç„¶æ˜¯ä¸€ä¸ªéå¸¸å¹´è½»çš„æ¡†æ¶ï¼Œä½†åˆæ˜¯ä¸€ä¸ªå‘å±•é€Ÿåº¦éå¸¸å¿«çš„æ¡†æ¶ã€‚è‡ªä» 2022 å¹´ 10 æœˆ 25 åœ¨ GitHub <a href="https://github.com/langchain-ai/langchain/commit/18aeb7201">ç¬¬ä¸€æ¬¡æäº¤</a>ä»¥æ¥ï¼Œåœ¨ 11 ä¸ª æœˆçš„æ—¶é—´é‡Œï¼Œç´¯è®¡å‘å¸ƒäº† 200 å¤šæ¬¡ï¼Œç´¯è®¡æäº¤ <a href="https://github.com/langchain-ai/langchain/graphs/commit-activity">4000</a> å¤šæ¬¡ä»£ç ã€‚2023 å¹´ 3 æœˆï¼ŒChatGPT çš„ API å› å‡çº§é™ä»·å¤§å—æ¬¢è¿ï¼ŒLangChain çš„ä½¿ç”¨ä¹Ÿéšä¹‹çˆ†ç‚¸å¼å¢é•¿ã€‚</p>
<p><img src="/2023/09/20/Introduction-to-LangChain/langchain_commit_counts.jpg" alt="LangChain ä»£ç æäº¤è¶‹åŠ¿"></p>
<p>ä¹‹åï¼ŒLangChain åœ¨æ²¡æœ‰ä»»ä½•æ”¶å…¥ä¹Ÿæ²¡æœ‰ä»»ä½•æ˜æ˜¾çš„åˆ›æ”¶è®¡åˆ’çš„æƒ…å†µä¸‹ï¼Œè·å¾—äº† 1000 ä¸‡ç¾å…ƒçš„ç§å­è½®èèµ„å’Œ 2000-2500 ä¸‡ç¾å…ƒçš„ A è½®èèµ„ï¼Œä¼°å€¼è¾¾åˆ° 2 äº¿ç¾å…ƒå·¦å³ã€‚<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup></p>
<p>ä½œä¸ºä¸€ä¸ªå¹´è½»è€Œåˆæ´»åŠ›çš„æ¡†æ¶ï¼ŒLangChain æ­£åœ¨å½»åº•æ”¹å˜å·¥ä¸šå’ŒæŠ€æœ¯ï¼Œæ”¹å˜æˆ‘ä»¬ä¸æŠ€æœ¯çš„æ¯ä¸€æ¬¡äº’åŠ¨ã€‚</p>
<h2 id="langchain-çš„ç›®æ ‡">LangChain çš„ç›®æ ‡</h2>
<p>ä¸åŒçš„å¤§è¯­è¨€æ¨¡å‹éƒ½æœ‰å„è‡ªçš„ä¼˜åŠ¿ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šç”¨ A æ¨¡å‹æ¥è¿›è¡Œè‡ªç„¶è¯­è¨€ç†è§£ï¼Œç„¶åç”¨ B æ¨¡å‹è¿›è¡Œé€»è¾‘æ¨ç†å¹¶è·å–ç»“æœâ€¦â€¦æ­¤æ—¶ï¼Œå¦‚æœä½¿ç”¨å¤§è¯­è¨€æ¨¡å‹å„è‡ªæä¾›çš„ API æ¥å’Œæ¨¡å‹äº¤äº’ï¼Œé‚£ä¹ˆå°±ä¼šå­˜åœ¨éå¸¸å¤šçš„é‡å¤å·¥ä½œã€‚</p>
<p>è™½ç„¶å¤§è¯­è¨€æ¨¡å‹æœ‰å¾ˆå¤šï¼Œä½†æ˜¯å’Œå¤§è¯­è¨€æ¨¡å‹çš„äº¤äº’æµç¨‹åˆæ˜¯éå¸¸ç±»ä¼¼ï¼Œå¦‚æœæ¯æ¬¡å’Œæ¨¡å‹äº¤äº’éƒ½éœ€è¦é‡å¤å¦‚ä¸Šçš„æ­¥éª¤ï¼Œé‚£å¬èµ·æ¥ä¹Ÿæ˜¯ä¸€ä»¶éå¸¸ç¹ççš„äº‹æƒ…ã€‚å¯¹äºç›¸åŒçš„æç¤ºè¯ï¼Œæˆ‘ä»¬ä¸æƒ³æ¯æ¬¡éƒ½ <code>ctr+c</code>ã€<code>ctr+v</code>ï¼Œè¿™çœŸæ˜¯ä¸€ä»¶éå¸¸å¯æ€•çš„äº‹æƒ…ã€‚</p>
<p><img src="/2023/09/20/Introduction-to-LangChain/1.jpg" alt="å’Œæ¨¡å‹äº¤äº’çš„æµç¨‹"></p>
<p>å’Œ FFmpeg å¯¹è§†é¢‘çš„å¤„ç†ä¸€æ ·ï¼ŒFFmpeg æä¾›çš„ <code>filtergraph</code> <sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup>æœºåˆ¶å¤§å¤§å¢å¼ºäº†å…¶éŸ³è§†é¢‘çš„å¤„ç†èƒ½åŠ›ï¼Œå¥ å®šå…¶åœ¨è§†éŸ³é¢‘é¢†åŸŸçš„åœ°ä½ã€‚<code>filtergraph</code> å¯ä»¥å°†ä¸åŒçš„éŸ³è§†é¢‘å¤„ç†èƒ½åŠ›ä»¥é“¾æ¡çš„å½¢å¼ç»„åˆèµ·æ¥ï¼Œä¸ä½†ç®€åŒ–äº†éŸ³è§†é¢‘çš„å¤„ç†æµç¨‹ï¼Œæ›´è®© FFmpeg å¯ä»¥å®ç°å¤æ‚çš„éŸ³è§†é¢‘å¤„ç†ã€‚</p>
<p>åŒç†ï¼Œå’Œ LLMs çš„å•æ¬¡äº¤äº’å¹¶ä¸ä¼šå½¢æˆä»€ä¹ˆæƒŠäººçš„èƒ½é‡ï¼Œè€Œå¦‚æœå¯ä»¥ä½¿ç”¨ç±»ä¼¼ <code>filtergraph</code> çš„æœºåˆ¶ï¼Œå°†ä¸ LLMs çš„å¤šæ¬¡äº¤äº’æ•´åˆèµ·æ¥ï¼Œé‚£ä¹ˆå…¶æ‰€é‡Šæ”¾çš„èƒ½é‡å°†æ˜¯æ— ç©·çš„ã€‚</p>
<p>è€Œ LangChain å°±æ˜¯ä¸ºäº†è§£å†³å¦‚ä¸Šçš„é—®é¢˜è€Œäº§ç”Ÿçš„ã€‚LangChain å¯ä»¥æä¾›ç»™æˆ‘ä»¬çš„æœ€ä¸»è¦çš„ä»·å€¼å¦‚ä¸‹<sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup>ï¼š</p>
<ul>
<li>ç»„ä»¶åŒ–ï¼šLangChain å¯¹ä¸ LLMs äº¤äº’çš„æµç¨‹è¿›è¡Œäº†ç»Ÿä¸€çš„æŠ½è±¡ï¼ŒåŒæ—¶ä¹Ÿæä¾›äº†ä¸åŒ LLMs çš„å®ç°ã€‚è¿™æå¤§çš„æå‡äº†æˆ‘ä»¬ä½¿ç”¨ LLMs çš„æ•ˆç‡ã€‚</li>
<li>åºåˆ—åŒ–ï¼šLangChain æä¾›çš„åºåˆ—åŒ–çš„èƒ½åŠ›ï¼Œå¯ä»¥å°†<code>æç¤ºè¯</code>ã€<code>chain</code>ç­‰ä»¥æ–‡ä»¶çš„å½¢å¼è€Œä¸æ˜¯ä»¥ä»£ç çš„å½¢å¼è¿›è¡Œå­˜å‚¨ï¼Œè¿™æ ·å¯ä»¥æå¤§çš„æ–¹ä¾¿æˆ‘ä»¬å…±äº« <code>æç¤ºè¯</code>ï¼Œå¹¶å¯¹ <code>æç¤ºè¯</code> è¿›è¡Œç‰ˆæœ¬ç®¡ç†ã€‚<sup class="footnote-ref"><a href="#fn4" id="fnref4">[4]</a></sup></li>
<li>ä¸°å¯Œçš„ chains å¥—ä»¶ï¼šLangChain æä¾›äº†ä¸°å¯Œã€ç”¨äºå®Œæˆç‰¹å®šç›®çš„ã€å¼€ç®±å³ç”¨çš„ chains å¥—ä»¶ï¼Œä¾‹å¦‚ç”¨äºæ€»ç»“æ–‡æ¡£çš„ <code> StuffDocumentsChain</code> å’Œ <code>MapReduceDocumentsChain</code>ï¼Œè¿™äº›å¥—ä»¶å°†ä¼šé™ä½æˆ‘ä»¬ä½¿ç”¨ LLMs çš„é—¨æ§›ã€‚</li>
</ul>
<p>æ›´å…·ä½“çš„ï¼Œ LangChain å¯ä»¥åœ¨å¦‚ä¸‹çš„ 6 å¤§æ–¹å‘ä¸Šç»™æˆ‘ä»¬æä¾›éå¸¸å¤§çš„ä¾¿åˆ©ï¼š</p>
<ol>
<li><strong>LLMs &amp; Prompt</strong>ï¼šLangChain æä¾›äº†ç›®å‰å¸‚é¢ä¸Šå‡ ä¹æ‰€æœ‰ LLM çš„é€šç”¨æ¥å£ï¼ŒåŒæ—¶è¿˜æä¾›äº† <code>æç¤ºè¯</code> çš„ç®¡ç†å’Œä¼˜åŒ–èƒ½åŠ›ï¼ŒåŒæ—¶ä¹Ÿæä¾›äº†éå¸¸å¤šçš„ç›¸å…³é€‚ç”¨å·¥å…·ï¼Œä»¥æ–¹ä¾¿å¼€å‘äººå‘˜åˆ©ç”¨ LangChain ä¸ LLMs è¿›è¡Œäº¤äº’ã€‚</li>
<li><strong>Chains</strong>ï¼šLangChain æŠŠ <code>æç¤ºè¯</code>ã€<code>å¤§è¯­è¨€æ¨¡å‹</code>ã€<code>ç»“æœè§£æ</code> å°è£…æˆ <code>Chain</code>ï¼Œå¹¶æä¾›æ ‡å‡†çš„æ¥å£ï¼Œä»¥ä¾¿å…è®¸ä¸åŒçš„ <code>Chain</code> å½¢æˆäº¤äº’åºåˆ—ï¼Œä¸º AI åŸç”Ÿåº”ç”¨æä¾›äº†ç«¯åˆ°ç«¯çš„ <code>Chain</code>ã€‚</li>
<li><strong>Data Augemented Generation</strong><sup class="footnote-ref"><a href="#fn5" id="fnref5">[5]</a></sup>ï¼š<code>æ•°æ®å¢å¼ºç”Ÿæˆå¼</code> æ˜¯ä¸€ç§è§£å†³é¢„è®­ç»ƒè¯­æ–™æ•°æ®æ— æ³•åŠæ—¶æ›´æ–°è€Œå¸¦æ¥çš„å›ç­”å†…å®¹é™ˆæ—§çš„æ–¹å¼ã€‚LangChain æä¾›äº†æ”¯æŒ <code>æ•°æ®å¢å¼ºç”Ÿæˆå¼</code> çš„ <code>Chain</code>ï¼Œåœ¨ä½¿ç”¨æ—¶ï¼Œè¿™äº› <code>Chain</code> ä¼šé¦–å…ˆä¸å¤–éƒ¨æ•°æ®æºè¿›è¡Œäº¤äº’ä»¥è·å¾—å¯¹åº”æ•°æ®ï¼Œç„¶åå†åˆ©ç”¨è·å¾—çš„æ•°æ®ä¸ <code>LLMs</code> è¿›è¡Œäº¤äº’ã€‚å…¸å‹çš„åº”ç”¨åœºæ™¯å¦‚ï¼šåŸºäºç‰¹å®šæ•°æ®æºçš„é—®ç­”æœºå™¨äººã€‚</li>
<li><strong>Agent</strong>ï¼šå¯¹äºä¸€ä¸ªä»»åŠ¡ï¼Œ<code>ä»£ç†</code> ä¸»è¦æ¶‰åŠè®© <code>LLMs</code> æ¥å¯¹ä»»åŠ¡è¿›è¡Œæ‹†åˆ†ã€æ‰§è¡Œè¯¥è¡ŒåŠ¨ã€å¹¶è§‚å¯Ÿæ‰§è¡Œç»“æœï¼Œ<code>ä»£ç†</code> ä¼šé‡å¤æ‰§è¡Œè¿™ä¸ªè¿‡ç¨‹ï¼Œç›´åˆ°è¯¥ä»»åŠ¡å®Œæˆä¸ºæ­¢ã€‚LangChain ä¸º <code>ä»£ç†</code> æä¾›äº†æ ‡å‡†æ¥å£ï¼Œå¯ä¾›é€‰æ‹©çš„ä»£ç†ï¼Œä»¥åŠä¸€äº›ç«¯åˆ°ç«¯çš„ <code>ä»£ç†</code> çš„ç¤ºä¾‹ã€‚</li>
<li><strong>Memory</strong>ï¼š<code>å†…å­˜</code> æŒ‡çš„æ˜¯ chain æˆ– agent è°ƒç”¨ä¹‹é—´çš„çŠ¶æ€æŒä¹…åŒ–ã€‚LangChain ä¸º <code>å†…å­˜</code> æä¾›äº†æ ‡å‡†æ¥å£ï¼Œå¹¶æä¾›äº†ä¸€ç³»åˆ—çš„ <code>å†…å­˜</code> å®ç°ã€‚</li>
<li><strong>Evaluation</strong>ï¼šLangChain è¿˜æä¾›äº†éå¸¸å¤šçš„è¯„ä¼°èƒ½åŠ›ä»¥å…è®¸æˆ‘ä»¬å¯ä»¥æ›´æ–¹ä¾¿çš„å¯¹ <code>LLMs</code> è¿›è¡Œè¯„ä¼°ã€‚</li>
</ol>
<h2 id="langchain-çš„åŸºæœ¬æ¦‚å¿µ">LangChain çš„åŸºæœ¬æ¦‚å¿µ</h2>
<p>ä½¿ç”¨ LLMs å’Œä½¿ç”¨ç”µè„‘ä¸€æ ·ï¼Œéœ€è¦ä¸€äº›åŸºæœ¬çš„æ¶æ„ä½“ç³»ã€‚LangChain æŠŠæ•´ä½“æ¶æ„ä½“ç³»åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼šè¾“å…¥/è¾“å‡ºç³»ç»Ÿï¼Œå¤§è¯­è¨€æ¨¡å‹ã€‚å…¶ä¸­ï¼Œè¾“å…¥éƒ¨åˆ†ä¸º <code>Prompt</code> ç›¸å…³ç»„ä»¶ï¼Œè¾“å‡ºä¸º <code>Output Parser</code> ç›¸å…³ç»„ä»¶ã€‚å…·ä½“å¦‚ä¸‹ï¼š</p>
<p><img src="/2023/09/20/Introduction-to-LangChain/langchain_io.png" alt="LangChain I/O"></p>
<p>LangChain æä¾›äº†ä¸ LLMs äº¤äº’çš„é€šç”¨æ„ä»¶ï¼š</p>
<ul>
<li><code>Prompts</code>ï¼šæç¤ºè¯æ¨¡ç‰ˆï¼Œæç¤ºè¯åŠ¨æ€é€‰æ‹©ï¼Œæç¤ºè¯åºåˆ—åŒ–ã€‚</li>
<li><code>LLMs</code>ï¼šä¸ LLM äº¤äº’çš„é€šç”¨æ¥å£ã€‚</li>
<li><code>Output Parsers</code>ï¼šå¯¹æ¨¡å‹çš„è¾“å‡ºä¿¡æ¯è¿›è¡Œè§£æï¼Œä»¥è¾“å‡ºç¬¦åˆç‰¹å®šæ ¼å¼çš„å“åº”ã€‚</li>
</ul>
<p><img src="/2023/09/20/Introduction-to-LangChain/langchain_io_example.jpeg" alt="LangChain I/O ç¤ºä¾‹"></p>
<h3 id="prompt-templates">Prompt Templates</h3>
<p>æç¤ºè¯æ¨¡ç‰ˆä¸ºä¸åŒçš„æç¤ºè¯æä¾›é¢„å®šä¹‰æ ¼å¼ã€‚å°±å¥½åƒç›®å‰è¶…å¸‚å”®å–çš„æ´—å‡€åˆ‡å¥½ã€é…å¥½ç›¸å…³é…èœæºææ–™çš„é¢„åˆ¶èœä¸€æ ·ï¼Œæç¤ºè¯æ¨¡ç‰ˆå¯ä»¥ç®€åŒ–æˆ‘ä»¬å’Œ LLMs äº¤äº’çš„æ•ˆç‡ã€‚</p>
<p>æ¨¡ç‰ˆä¼šåŒ…å«ï¼šæŒ‡ä»¤ï¼Œå°‘é‡çš„æ ·æœ¬ç¤ºä¾‹ï¼Œç›¸å…³çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚LLMs ä¼šåˆ†ä¸º <code>å¤§è¯­è¨€æ¨¡å‹</code> å’Œ <code>èŠå¤©æ¨¡å‹</code> ä¸¤ç§ç±»å‹ï¼Œå› æ­¤ï¼ŒLangChain æä¾›äº†ä¸¤ç§ç±»å‹çš„æç¤ºè¯æ¨¡ç‰ˆï¼š<code>prompt template</code>ã€<code>chat prompt template</code>ã€‚</p>
<ul>
<li><code>prompt template</code>ï¼šæä¾›å­—ç¬¦ä¸²æ ¼å¼çš„æç¤ºè¯ã€‚</li>
<li><code>chat prompt template</code>ï¼šæç¤ºèŠå¤©æ¶ˆæ¯æ ¼å¼çš„æç¤ºè¯ã€‚</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain <span class="keyword">import</span> PromptTemplate</span><br><span class="line"></span><br><span class="line">prompt_template = PromptTemplate.from_template(</span><br><span class="line">    <span class="string">&quot;è¯·ä»¥è½»æ¾æ¬¢å¿«çš„è¯­æ°”å†™ä¸€ç¯‡æå†™ &#123;topic&#125; çš„æ–‡ç« ï¼Œå­—æ•°ä¸è¶…è¿‡ &#123;count&#125; å­—ã€‚&quot;</span></span><br><span class="line">)</span><br><span class="line">res = prompt_template.<span class="built_in">format</span>(topic=<span class="string">&quot;åŒ—äº¬çš„ç§‹å¤©&quot;</span>, count=<span class="string">&quot;100&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="comment"># è¯·ä»¥è½»æ¾æ¬¢å¿«çš„è¯­æ°”å†™ä¸€ç¯‡æå†™ åŒ—äº¬çš„ç§‹å¤© çš„æ–‡ç« ï¼Œå­—æ•°ä¸è¶…è¿‡ 100 å­—ã€‚</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.prompts <span class="keyword">import</span> ChatPromptTemplate</span><br><span class="line"></span><br><span class="line">template = ChatPromptTemplate.from_messages([</span><br><span class="line">    (<span class="string">&quot;system&quot;</span>, <span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªèƒ½åŠ›éå‡¡çš„äººå·¥æ™ºèƒ½æœºå™¨äººï¼Œä½ çš„åå­—æ˜¯ &#123;name&#125;ã€‚&quot;</span>),</span><br><span class="line">    (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;ä½ å¥½ï¼&quot;</span>),</span><br><span class="line">    (<span class="string">&quot;ai&quot;</span>, <span class="string">&quot;ä½ å¥½~&quot;</span>),</span><br><span class="line">    (<span class="string">&quot;human&quot;</span>, <span class="string">&quot;&#123;user_input&#125;&quot;</span>),</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">messages = template.format_messages(</span><br><span class="line">    name=<span class="string">&quot;å°æ˜&quot;</span>,</span><br><span class="line">    user_input=<span class="string">&quot;ä½ æ˜¯è°ï¼Ÿ&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(messages)</span><br><span class="line"><span class="comment"># [SystemMessage(content=&#x27;ä½ æ˜¯ä¸€ä¸ªèƒ½åŠ›éå‡¡çš„äººå·¥æ™ºèƒ½æœºå™¨äººï¼Œä½ çš„åå­—æ˜¯ å°æ˜ã€‚&#x27;, </span></span><br><span class="line"><span class="comment">#                additional_kwargs=&#123;&#125;), </span></span><br><span class="line"><span class="comment"># HumanMessage(content=&#x27;ä½ å¥½ï¼&#x27;, additional_kwargs=&#123;&#125;, example=False), </span></span><br><span class="line"><span class="comment"># AIMessage(content=&#x27;ä½ å¥½~&#x27;, additional_kwargs=&#123;&#125;, example=False), </span></span><br><span class="line"><span class="comment"># HumanMessage(content=&#x27;ä½ æ˜¯è°ï¼Ÿ&#x27;, additional_kwargs=&#123;&#125;, example=False)]</span></span><br></pre></td></tr></table></figure>
<h3 id="llms">LLMs</h3>
<p>LangChain æä¾›äº†ä¸¤ç§æ¨¡å‹çš„é€šç”¨æ¥å£ï¼š</p>
<ul>
<li><code>LLMs</code>ï¼šæ¨¡å‹ä»¥å­—ç¬¦ä¸²æ ¼å¼çš„æç¤ºè¯ä½œä¸ºè¾“å…¥ï¼Œå¹¶è¿”å›å­—ç¬¦ä¸²æ ¼å¼çš„ç»“æœã€‚</li>
<li><code>Chat models</code>ï¼šå…¶èƒŒåä¹Ÿæ˜¯ç”±æŸç§ LLM æ¥æ”¯æ’‘ï¼Œä½†æ˜¯ä»¥èŠå¤©æ¶ˆæ¯åˆ—è¡¨æ ¼å¼çš„æç¤ºè¯ä½œä¸ºè¾“å…¥ï¼Œå¹¶è¿”å›èŠå¤©æ¶ˆæ¯æ ¼å¼çš„ç»“æœã€‚</li>
</ul>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition note"><p class="admonition-title">LLM å’Œ èŠå¤©æ¨¡å¼çš„åŒºåˆ«
</p><p>LLM å’Œ èŠå¤©æ¨¡å¼ ä¹‹é—´çš„åŒºåˆ«è™½ç„¶å¾ˆå¾®å¦™ï¼Œä½†æ˜¯å´å®Œå…¨ä¸åŒã€‚</p>
<p>LangChain ä¸­çš„ LLM æŒ‡çš„æ˜¯çº¯æ–‡æœ¬ I/O çš„æ¨¡å‹ï¼Œå…¶åŒ…è£…çš„ API å°†å­—ç¬¦ä¸²æç¤ºä½œä¸ºè¾“å…¥ï¼Œå¹¶è¾“å‡ºå­—ç¬¦ä¸²ã€‚OpenAI çš„ GPT-3 å°±æ˜¯ LLMã€‚</p>
<p>èŠå¤©æ¨¡å‹é€šå¸¸ç”± LLM æ”¯æŒï¼Œä½†ä¸“é—¨é’ˆå¯¹å¯¹è¯è¿›è¡Œäº†è°ƒæ•´ï¼Œå…¶ API é‡‡ç”¨èŠå¤©æ¶ˆæ¯åˆ—è¡¨ä½œä¸ºè¾“å…¥ï¼Œè€Œä¸æ˜¯å•ä¸ªå­—ç¬¦ä¸²ã€‚é€šå¸¸ï¼Œè¿™äº›æ¶ˆæ¯éƒ½æ ‡æœ‰è§’è‰²ï¼ˆä¾‹å¦‚ï¼Œâ€œSystemâ€ï¼Œâ€œAIâ€ï¼Œâ€œHumanâ€ï¼‰ã€‚èŠå¤©æ¨¡å‹ä¼šè¿”å›ä¸€æ¡ AI èŠå¤©æ¶ˆæ¯ä½œä¸ºè¾“å‡ºã€‚OpenAI çš„ GPT-4ï¼ŒAnthropic çš„ Claudeï¼Œç™¾åº¦çš„ Ernie éƒ½æ˜¯èŠå¤©æ¨¡å‹ã€‚</p>
</div>
<p>åœ¨ LangChain ä¸­ï¼ŒLLM å’Œ èŠå¤©æ¨¡å¼ä¸¤è€…éƒ½å®ç°äº† <code>BaseLanguageModel</code> æ¥å£ï¼Œå› æ­¤ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œè¿™ä¸¤ç§æ¨¡å‹å¯ä»¥æ··ç”¨ã€‚ä¾‹å¦‚ï¼Œä¸¤ç§æ¨¡å‹éƒ½å®ç°äº†å¸¸è§çš„æ–¹æ³• <code>predict()</code> å’Œ <code>predict_messages()</code>ã€‚<code>predict()</code> æ¥å—å­—ç¬¦ä¸²å¹¶è¿”å›å­—ç¬¦ä¸²ï¼Œ<code>predict_messages()</code> æ¥å—æ¶ˆæ¯å¹¶è¿”å›æ¶ˆæ¯ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OpenAI</span>(<span class="params">BaseOpenAI</span>):</span></span><br><span class="line">    <span class="comment"># ...</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BaseOpenAI</span>(<span class="params">BaseLLM</span>):</span></span><br><span class="line">    <span class="comment"># ...</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BaseLLM</span>(<span class="params">BaseLanguageModel[<span class="built_in">str</span>], ABC</span>):</span></span><br><span class="line">    <span class="comment"># ...</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ErnieBotChat</span>(<span class="params">BaseChatModel</span>):</span></span><br><span class="line">    <span class="comment"># ...</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BaseChatModel</span>(<span class="params">BaseLanguageModel[BaseMessageChunk], ABC</span>):</span></span><br><span class="line">    <span class="comment"># ...</span></span><br></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°† <code>Prompt</code> å’Œ <code>LLM</code> æ•´åˆèµ·æ¥ï¼Œå®ç°å’Œå¤§è¯­è¨€æ¨¡å‹äº¤äº’ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain <span class="keyword">import</span> PromptTemplate</span><br><span class="line"><span class="keyword">from</span> langchain.llms <span class="keyword">import</span> OpenAI</span><br><span class="line"></span><br><span class="line">prompt_template = PromptTemplate.from_template(</span><br><span class="line">    <span class="string">&quot;è¯·ä»¥è½»æ¾æ¬¢å¿«çš„è¯­æ°”å†™ä¸€ç¯‡æå†™ &#123;topic&#125; çš„æ–‡ç« ï¼Œå­—æ•°ä¸è¶…è¿‡ &#123;count&#125; å­—ã€‚&quot;</span></span><br><span class="line">)</span><br><span class="line">llm = OpenAI()</span><br><span class="line"></span><br><span class="line">prompt = prompt_template.<span class="built_in">format</span>(topic=<span class="string">&quot;åŒ—äº¬çš„ç§‹å¤©&quot;</span>, count=<span class="string">&quot;100&quot;</span>)</span><br><span class="line">res = llm.predict(prompt)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç§‹å¤©æ¥åˆ°äº†åŒ—äº¬ï¼Œä¸€ç‰‡é‡‘é»„è‰²çš„æ«å¶ï¼Œæ¼«å±±éé‡ã€‚</span></span><br><span class="line"><span class="comment"># æ¹–é¢ä¸Šçš„å¾®é£ï¼Œå¹èµ·æŸ”å’Œçš„ç§‹æ„ï¼Œç©ºæ°”ä¸­å¼¥æ¼«ç€æ·¡æ·¡çš„æ«é¦™ã€‚</span></span><br><span class="line"><span class="comment"># è¿™æ—¶ï¼Œæ¯ä¸€ä¸ªè§’è½éƒ½æ´‹æº¢ç€ç§‹æ—¥çš„æ¸©é¦¨ï¼Œä»¤äººå¿ƒæ—·ç¥æ€¡ã€‚</span></span><br><span class="line"><span class="comment"># å¤è€çš„é•¿åŸä¸ŠæŠ«ç€çº¢å¶ï¼Œç†™ç†™æ”˜æ”˜çš„äººç¾¤ä¸­ï¼Œä¹Ÿå¤šäº†å‡ åˆ†çƒ­é—¹ä¸æ¬¢ç•…ï¼Œè¿™å°±æ˜¯åŒ—äº¬çš„ç§‹å¤©</span></span><br></pre></td></tr></table></figure>
<p>ç”±äºæ–‡å¿ƒèŠå¤©æ¨¡å‹å¯¹ <code>message</code> è§’è‰²å’Œæ¡æ•°æœ‰é™åˆ¶<sup class="footnote-ref"><a href="#fn6" id="fnref6">[6]</a></sup> <sup class="footnote-ref"><a href="#fn7" id="fnref7">[7]</a></sup>ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å¯¹ <code>æç¤ºè¯</code> åšä¸€äº›ä¿®æ”¹ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.chat_models <span class="keyword">import</span> ErnieBotChat</span><br><span class="line"><span class="keyword">from</span> langchain.prompts <span class="keyword">import</span> ChatPromptTemplate</span><br><span class="line"></span><br><span class="line">template = ChatPromptTemplate.from_messages([</span><br><span class="line">    (<span class="string">&quot;user&quot;</span>, <span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªèƒ½åŠ›éå‡¡çš„äººå·¥æ™ºèƒ½æœºå™¨äººï¼Œä½ çš„åå­—æ˜¯ &#123;name&#125;ã€‚&quot;</span>),</span><br><span class="line">    (<span class="string">&quot;assistant&quot;</span>, <span class="string">&quot;ä½ å¥½~&quot;</span>),</span><br><span class="line">    (<span class="string">&quot;user&quot;</span>, <span class="string">&quot;&#123;user_input&#125;&quot;</span>),</span><br><span class="line">])</span><br><span class="line">chat = ErnieBotChat()</span><br><span class="line"></span><br><span class="line">messages = template.format_messages(</span><br><span class="line">    name=<span class="string">&quot;å°æ˜&quot;</span>,</span><br><span class="line">    user_input=<span class="string">&quot;ä½ æ˜¯è°ï¼Ÿ&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">res = chat.predict_messages(messages)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="comment"># content=&#x27;æˆ‘æ˜¯ä½ çš„æ–°æœ‹å‹å°æ˜ï¼Œä¸€ä¸ªæ‹¥æœ‰å…ˆè¿›äººå·¥æ™ºèƒ½æŠ€æœ¯çš„äººå·¥æ™ºèƒ½æœºå™¨äººã€‚&#x27; </span></span><br><span class="line"><span class="comment"># additional_kwargs=&#123;&#125; example=False</span></span><br></pre></td></tr></table></figure>
<h3 id="output-parsers">Output Parsers</h3>
<p>å¤§è¯­è¨€æ¨¡å‹ä¸€èˆ¬ä¼šè¾“å‡ºæ–‡æœ¬å†…å®¹ä½œä¸ºå“åº”ï¼Œå½“ç„¶æ›´é«˜çº§çš„å¤§è¯­è¨€æ¨¡å‹ï¼ˆä¾‹å¦‚æ–‡å¿ƒå¤§æ¨¡å‹ï¼‰è¿˜å¯ä»¥è¾“å‡ºå›¾ç‰‡ã€è§†é¢‘ä½œä¸ºå“åº”ã€‚ä½†æ˜¯ï¼Œå¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬å¸Œæœ›å¯ä»¥è·å¾—æ›´ç»“æ„åŒ–çš„ä¿¡æ¯ï¼Œè€Œä¸ä»…ä»…æ˜¯å›å¤ä¸€ä¸²å­—ç¬¦ä¸²æ–‡æœ¬ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>æç¤ºè¯å·¥ç¨‹</code> æ¥æç¤º LLMs è¾“å‡ºç‰¹å®šçš„æ ¼å¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.chat_models <span class="keyword">import</span> ErnieBotChat</span><br><span class="line"><span class="keyword">from</span> langchain.prompts <span class="keyword">import</span> ChatPromptTemplate</span><br><span class="line"></span><br><span class="line">template = ChatPromptTemplate.from_messages([</span><br><span class="line">    (<span class="string">&quot;user&quot;</span>, <span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªèƒ½åŠ›éå‡¡çš„äººå·¥æ™ºèƒ½æœºå™¨äººï¼Œä½ çš„åå­—æ˜¯ &#123;name&#125;ã€‚&quot;</span>),</span><br><span class="line">    (<span class="string">&quot;assistant&quot;</span>, <span class="string">&quot;ä½ å¥½~&quot;</span>),</span><br><span class="line">    (<span class="string">&quot;user&quot;</span>, <span class="string">&quot;&#123;user_input&#125;&quot;</span>),</span><br><span class="line">])</span><br><span class="line">chat = ErnieBotChat()</span><br><span class="line"></span><br><span class="line">messages = template.format_messages(</span><br><span class="line">    name=<span class="string">&quot;å°æ˜&quot;</span>,</span><br><span class="line">    user_input=<span class="string">&quot;è¯·ç»™å‡º 10 ä¸ªè¡¨ç¤ºå¿«ä¹çš„æˆè¯­ï¼Œå¹¶è¾“å‡ºä¸º JSON æ ¼å¼&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">res = chat.predict_messages(messages)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"></span><br><span class="line"><span class="comment"># content=&#x27;```json\n[\n    &quot;ä¹ä¸å¯æ”¯&quot;,</span></span><br><span class="line"><span class="comment">#                    \n    &quot;å–œä»å¤©é™&quot;,</span></span><br><span class="line"><span class="comment">#                    \n    &quot;ç¬‘é€é¢œå¼€&quot;,</span></span><br><span class="line"><span class="comment">#                    \n    &quot;æ‰‹èˆè¶³è¹ˆ&quot;,</span></span><br><span class="line"><span class="comment">#                     ......</span></span><br><span class="line"><span class="comment">#                    \n    &quot;å¼¹å† ç›¸åº†&quot;\n]\n```&#x27; </span></span><br><span class="line"><span class="comment"># additional_kwargs=&#123;&#125; example=False</span></span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯ï¼Œä½¿ç”¨ LangChain æä¾›çš„ <code>Output Parsers</code> èƒ½åŠ›ï¼Œä¼šæ›´åŠ çš„æ–¹ä¾¿ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.chat_models <span class="keyword">import</span> ErnieBotChat</span><br><span class="line"><span class="keyword">from</span> langchain.prompts <span class="keyword">import</span> ChatPromptTemplate</span><br><span class="line"><span class="keyword">from</span> langchain.output_parsers <span class="keyword">import</span> CommaSeparatedListOutputParser</span><br><span class="line"></span><br><span class="line">template = ChatPromptTemplate.from_messages([</span><br><span class="line">    (<span class="string">&quot;user&quot;</span>, <span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªèƒ½åŠ›éå‡¡çš„äººå·¥æ™ºèƒ½æœºå™¨äººï¼Œä½ çš„åå­—æ˜¯ &#123;name&#125;ã€‚&quot;</span>),</span><br><span class="line">    (<span class="string">&quot;assistant&quot;</span>, <span class="string">&quot;ä½ å¥½~&quot;</span>),</span><br><span class="line">    (<span class="string">&quot;user&quot;</span>, <span class="string">&quot;&#123;user_input&#125;&quot;</span>),</span><br><span class="line">])</span><br><span class="line">chat = ErnieBotChat()</span><br><span class="line"></span><br><span class="line">messages = template.format_messages(</span><br><span class="line">    name=<span class="string">&quot;å°æ˜&quot;</span>,</span><br><span class="line">    user_input=<span class="string">&quot;è¯·ä»…ç»™5ä¸ªè¡¨ç¤ºå¿«ä¹çš„æˆè¯­å¹¶ä»¥ , åˆ†éš”ï¼Œé™¤äº†æˆè¯­å¤–ä¸è¦è¾“å‡ºä»»ä½•å…¶ä»–å†…å®¹&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">res = chat.predict_messages(messages)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="comment"># content=&#x27;æ¬¢å‘¼é›€è·ƒï¼Œæ‰‹èˆè¶³è¹ˆï¼Œç¬‘é€é¢œå¼€ï¼Œå¿ƒèŠ±æ€’æ”¾ï¼Œå–œç¬‘é¢œå¼€&#x27; additional_kwargs=&#123;&#125; example=False</span></span><br><span class="line"></span><br><span class="line">output_parser = CommaSeparatedListOutputParser()</span><br><span class="line">res =  output_parser.parse(res.content.replace(<span class="string">&#x27;ï¼Œ&#x27;</span>, <span class="string">&#x27;, &#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="comment"># [&#x27;æ¬¢å‘¼é›€è·ƒ&#x27;, &#x27;æ‰‹èˆè¶³è¹ˆ&#x27;, &#x27;ç¬‘é€é¢œå¼€&#x27;, &#x27;å¿ƒèŠ±æ€’æ”¾&#x27;, &#x27;å–œç¬‘é¢œå¼€&#x27;]</span></span><br></pre></td></tr></table></figure>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition warning"><p class="admonition-title">warning</p><p>ç”±äºæ–‡å¿ƒå¤§æ¨¡å‹çš„æŒ‡ä»¤éµå¾ªèƒ½åŠ›è¿˜æœ‰è¿›ä¸€æ­¥æå‡çš„ç©ºé—´ï¼Œå› æ­¤è¿™é‡Œçš„æ¼”ç¤ºå¯èƒ½éœ€è¦è¿›è¡Œä¸€äº›é¢å¤–çš„æ“ä½œï¼Œä¾‹å¦‚éœ€è¦å¯¹æ¨¡å‹è¿”å›çš„å†…å®¹è¿›è¡Œä¸€äº›ç®€å•çš„å­—ç¬¦ä¸²æ›¿æ¢ã€‚</p>
</div>
<h3 id="llmchain">LLMChain</h3>
<p>è™½ç„¶ä¸€å°ç‹¬ç«‹çš„è®¡ç®—æœºä¹Ÿèƒ½å®ç°å¾ˆå¼ºå¤§çš„åŠŸèƒ½ï¼Œä½†æ˜¯é€šè¿‡ç½‘ç»œå°†æ›´å¤šçš„è®¡ç®—æœºé“¾æ¥èµ·æ¥ï¼Œå¯èƒ½å‘æŒ¥å‡ºæ›´å¤§çš„æ€§èƒ½ã€‚åŒæ ·çš„ï¼Œå•ç‹¬ä½¿ç”¨ LLMs å·²ç»å¯ä»¥å®ç°å¼ºå¤§çš„åŠŸèƒ½ï¼Œä½†æ˜¯å¦‚æœå¯ä»¥å°†æ›´å¤šæ¬¡çš„äº¤äº’æœ‰æ•ˆçš„é“¾æ¥èµ·æ¥ï¼Œåˆ™èƒ½å‘æŒ¥ LLMs æ›´å¤§çš„èƒ½é‡ã€‚ä¸ºäº†å®ç°è¿™ä¸ªç›®æ ‡ï¼ŒLangChain æä¾›äº† <code>Chain</code> çš„æ¦‚å¿µï¼Œä»¥å®ç°å¯¹ä¸åŒç»„ä»¶çš„ä¸€ç³»åˆ—è°ƒç”¨ã€‚</p>
<p>åœ¨ LangChain ä¸­ï¼Œ<code>æç¤ºè¯</code>ã€<code>LLM</code>ã€<code>è¾“å‡ºè§£æ</code> è¿™ä¸‰è€…æ„æˆäº† <code>Chain</code>ï¼Œè€Œä¸åŒçš„ <code>Chain</code> åˆ™å¯ä»¥é€šè¿‡ä¸€å®šçš„æ–¹å¼é“¾æ¥èµ·æ¥ï¼Œä»¥å®ç°å¼ºå¤§çš„åŠŸèƒ½ã€‚å…·ä½“å¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<p><img src="/2023/09/20/Introduction-to-LangChain/chain.png" alt="LangChain ä¸­ Chain çš„æ¦‚å¿µ"></p>
<p>åˆ©ç”¨ <code>Chain</code> çš„æ¦‚å¿µï¼Œæˆ‘ä»¬å¯ä»¥å¯¹ä¹‹å‰çš„ä»£ç è¿›è¡Œé‡æ„ï¼Œ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.chat_models <span class="keyword">import</span> ErnieBotChat</span><br><span class="line"><span class="keyword">from</span> langchain.prompts <span class="keyword">import</span> ChatPromptTemplate</span><br><span class="line"><span class="keyword">from</span> langchain.output_parsers <span class="keyword">import</span> CommaSeparatedListOutputParser</span><br><span class="line"><span class="keyword">from</span> langchain.chains <span class="keyword">import</span> LLMChain</span><br><span class="line"></span><br><span class="line">template = ChatPromptTemplate.from_messages([</span><br><span class="line">    (<span class="string">&quot;user&quot;</span>, <span class="string">&quot;ä½ æ˜¯ä¸€ä¸ªèƒ½åŠ›éå‡¡çš„äººå·¥æ™ºèƒ½æœºå™¨äººï¼Œä½ çš„åå­—æ˜¯ &#123;name&#125;ã€‚&quot;</span>),</span><br><span class="line">    (<span class="string">&quot;assistant&quot;</span>, <span class="string">&quot;ä½ å¥½~&quot;</span>),</span><br><span class="line">    (<span class="string">&quot;user&quot;</span>, <span class="string">&quot;&#123;user_input&#125;&quot;</span>),</span><br><span class="line">])</span><br><span class="line">chat = ErnieBotChat()</span><br><span class="line"></span><br><span class="line">chain =  LLMChain(llm=chat, prompt=template, output_parser=CommaSeparatedListOutputParser())</span><br><span class="line"></span><br><span class="line">res =  chain.run(name=<span class="string">&quot;å°æ˜&quot;</span>, user_input=<span class="string">&quot;è¯·ä»…ç»™5ä¸ªè¡¨ç¤ºå¿«ä¹çš„æˆè¯­å¹¶ä»¥ , åˆ†éš”ï¼Œé™¤äº†æˆè¯­å¤–ä¸è¦è¾“å‡ºä»»ä½•å…¶ä»–å†…å®¹&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="comment"># [&#x27;ä»¥ä¸‹æ˜¯äº”ä¸ªè¡¨ç¤ºå¿«ä¹çš„æˆè¯­ï¼š\n\n1. å–œå‡ºæœ›å¤–\n2. ä¹ä¸å¯æ”¯\n3. å¿ƒèŠ±æ€’æ”¾\n4. æ»¡å¿ƒæ¬¢å–œ\n5. æ‰‹èˆè¶³è¹ˆ&#x27;]</span></span><br></pre></td></tr></table></figure>
<h2 id="langchain-çš„å­¦ä¹ èµ„æ–™">LangChain çš„å­¦ä¹ èµ„æ–™</h2>
<ul>
<li>LangChain å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://python.langchain.com/docs/get_started">https://python.langchain.com/docs/get_started</a></li>
<li>LangChain çš„å…¸å‹åº”ç”¨åœºæ™¯ï¼š<a href="https://python.langchain.com/docs/use_cases">https://python.langchain.com/docs/use_cases</a></li>
<li>LangChain ç›®å‰é›†æˆçš„èƒ½åŠ›ï¼š<a href="https://python.langchain.com/docs/integrations">https://python.langchain.com/docs/integrations</a></li>
<li>LangChain AI Handbookï¼š<a href="https://www.pinecone.io/learn/series/langchain/">https://www.pinecone.io/learn/series/langchain/</a></li>
<li>LangChain Dartï¼š<a href="https://langchaindart.com/#/">https://langchaindart.com/#/</a></li>
<li>ç™¾åº¦æ™ºèƒ½äº‘åƒå¸†å¤§æ¨¡å‹å¹³å°ï¼š<a href="https://cloud.baidu.com/product/wenxinworkshop">https://cloud.baidu.com/product/wenxinworkshop</a></li>
</ul>
<h2 id="å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</h2>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p><a href="https://ecosystem.lafrenchtech.com/companies/langchain">LangChain ä¼°å€¼</a> <a href="#fnref1" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn2" class="footnote-item"><p><a href="https://ffmpeg.org/ffmpeg-filters.html">FFmpeg Filters Documentation</a> <a href="#fnref2" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn3" class="footnote-item"><p><a href="https://python.langchain.com/docs/get_started/introduction">LangChain Introdction</a> <a href="#fnref3" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn4" class="footnote-item"><p><a href="https://python.langchain.com/docs/modules/model_io/prompts/prompt_templates/prompt_serialization">Prompt Serialization</a> <a href="#fnref4" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn5" class="footnote-item"><p><a href="https://www.datacamp.com/tutorial/complete-guide-data-augmentation">A Complete Guide to Data Augmentation</a> <a href="#fnref5" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn6" class="footnote-item"><p><a href="https://cloud.baidu.com/doc/WENXINWORKSHOP/s/4lilb2lpf">ERNIE-Bot-turbo</a> <a href="#fnref6" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn7" class="footnote-item"><p><a href="https://cloud.baidu.com/product/wenxinworkshop">ç™¾åº¦æ™ºèƒ½äº‘åƒå¸†å¤§æ¨¡å‹å¹³å°</a> <a href="#fnref7" class="footnote-backref">â†©ï¸</a></p>
</li>
</ol>
</section>
]]></content>
      <categories>
        <category>LLM</category>
      </categories>
      <tags>
        <tag>LangChain</tag>
        <tag>OpenAI</tag>
        <tag>Ernie</tag>
      </tags>
  </entry>
  <entry>
    <title>æœ‰è¶£çš„ Elo ç§¯åˆ†ç³»ç»Ÿ</title>
    <url>/2023/08/12/the-interesting-elo-rating-system/</url>
    <content><![CDATA[<p><img src="/2023/08/12/the-interesting-elo-rating-system/1.png" alt></p>
<p>æˆ‘ä»¬çš„ <a href="/2023/02/13/duzhiliao/">è§†é¢‘è´¨é‡è¯„ä¼°ç³»ç»Ÿ</a> å¯ä»¥é€šè¿‡ä¼—åŒ…çš„å½¢å¼ä¸ºä¸€ç»„è§†é¢‘è¿›è¡Œä¸»è§‚è´¨é‡æ‰“åˆ†ã€‚å¦‚æœæƒ³è¯„ä¼°ä¸¤ä¸ªè§†é¢‘ç¼–è§£ç å™¨çš„ç¼–ç æ•ˆæœï¼Œå¹¶ç¡®å®šå“ªä¸ªç¼–è§£ç å™¨æ›´ä¼˜ï¼Œåˆ™å¯ä»¥é‡‡ç”¨æˆ‘ä»¬çš„ç³»ç»Ÿæ¥å®Œæˆã€‚</p>
<span id="more"></span>
<h2 id="ä¼—åŒ…æˆå¯¹æ‰“åˆ†æ³•">ä¼—åŒ…æˆå¯¹æ‰“åˆ†æ³•</h2>
<p>æˆ‘ä»¬ä¼šåˆ©ç”¨ä¸åŒçš„ç¼–è§£ç å™¨å¯¹ç›¸åŒçš„è§†é¢‘æºè¿›è¡Œç¼–ç ï¼Œå¹¶å¾—åˆ°ä¸¤ä¸ªè§†é¢‘ï¼šAï¼ˆç¼–è§£ç å™¨ A çš„ç¼–ç è§†é¢‘ï¼‰ï¼ŒBï¼ˆç¼–è§£ç å™¨ B çš„ç¼–ç è§†é¢‘ï¼‰ã€‚åœ¨è¯„ä¼°çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬çš„ç³»ç»Ÿä¼šéšè—ç¼–è§£ç å™¨çš„ä¿¡æ¯ï¼Œå¹¶è¦æ±‚ä¼—åŒ…ç”¨æˆ·å¯¹ä¸¤ä¸ªè§†é¢‘çš„æ•ˆæœè¿›è¡Œè¯„ä¼°ï¼Œä»¥é€‰å–æ•ˆæœå¥½çš„è§†é¢‘ã€‚å…·ä½“çš„æ‰“åˆ†å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="/2023/08/12/the-interesting-elo-rating-system/2.png" alt></p>
<p>å…¶ä¸­å„é€‰é¡¹å¯¹åº”çš„å¾—åˆ†å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th>é€‰é¡¹</th>
<th>5åˆ†åˆ¶æ‰“åˆ†</th>
<th>ç™¾åˆ†åˆ¶æ‰“åˆ†</th>
</tr>
</thead>
<tbody>
<tr>
<td>A ç‰¹å¥½</td>
<td>1</td>
<td>0~19</td>
</tr>
<tr>
<td>A è¾ƒå¥½</td>
<td>2</td>
<td>20~39</td>
</tr>
<tr>
<td>å·®ä¸å¤š</td>
<td>3</td>
<td>40~59</td>
</tr>
<tr>
<td>B è¾ƒå¥½</td>
<td>4</td>
<td>60~79</td>
</tr>
<tr>
<td>B ç‰¹å¥½</td>
<td>5</td>
<td>80~100</td>
</tr>
</tbody>
</table>
<p>å¯¹äºæ¯ä¸€ä¸ªè§†é¢‘ï¼Œæˆ‘ä»¬éƒ½ä¼šé‚€è¯·è‡³å°‘ 10 ä¸ªä¼—åŒ…ç”¨æˆ·è¿›è¡Œæ‰“åˆ†ï¼Œæˆ‘ä»¬ä¼šè¿‡æ»¤ä¸ç½®ä¿¡çš„æ‰“åˆ†å¹¶å¯¹å‰©ä½™çš„æ‰“åˆ†è¿›è¡Œ MOS è®¡ç®—ï¼Œç„¶åå°†ç»“æœè½¬æ¢ä¸ºç™¾åˆ†åˆ¶çš„æ‰“åˆ†ï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mn>5</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[1,5]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">5</span><span class="mclose">]</span></span></span></span>-&gt;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>100</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0,100]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mclose">]</span></span></span></span>ï¼‰ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæœ‰5å¯¹è§†é¢‘ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå¾—åˆ°å¦‚ä¸‹çš„æ‰“åˆ†ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">MOS_Scores &#x3D; [61, 55, 54, 65, 15] </span><br></pre></td></tr></table></figure>
<p>æ ¹æ®å®è·µï¼Œæˆ‘ä»¬ä¸èƒ½é‡‡ç”¨å¹³å‡åˆ†çš„æ–¹å¼å¯¹ä¸¤ä¸ªç¼–è§£ç å™¨æ•ˆæœè¿›è¡Œè¯„ä¼°ï¼Œå¦åˆ™å¯èƒ½ä¼šå­˜åœ¨åå·®ã€‚ä»¥å¦‚ä¸Šçš„æ‰“åˆ†ä¸ºä¾‹ï¼Œå…¶å¹³å‡æ‰“åˆ†ä¸ºï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î¼</mi><mrow><mi>M</mi><mi>O</mi><mi>S</mi><mi mathvariant="normal">_</mi><mi>S</mi><mi>c</mi><mi>o</mi><mi>r</mi><mi>e</mi><mi>s</mi></mrow></msub><mo>=</mo><mn>50</mn></mrow><annotation encoding="application/x-tex">\mu_{MOS\_Scores}=50</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.79756em;vertical-align:-0.367em;"></span><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">M</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">O</span><span class="mord mathdefault mtight" style="margin-right:0.05764em;">S</span><span class="mord mtight" style="margin-right:0.02778em;">_</span><span class="mord mathdefault mtight" style="margin-right:0.05764em;">S</span><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.367em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">5</span><span class="mord">0</span></span></span></span>ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸èƒ½è¯´ä¸¤ä¸ªç¼–è§£ç å™¨çš„æ•ˆæœæ˜¯ä¸€è‡´çš„ã€‚å› ä¸º B å¯¹äº A è€Œè¨€ï¼Œå…¶ GSBï¼ˆGood/Same/Badï¼‰åˆ†å¸ƒä¸ºï¼š40%/40%/20%ã€‚å› æ­¤ï¼Œå¯¹äºæˆ‘ä»¬çš„è¯„ä¼°ç³»ç»Ÿè€Œè¨€ï¼Œæˆ‘ä»¬ä¸€èˆ¬ç”¨ GSB çš„åˆ†å¸ƒï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå•ä¸€çš„åˆ†æ•°æ¥ç¡®å®šå“ªä¸ªç¼–è§£ç å™¨æ›´å¥½ã€‚</p>
<h2 id="chatbot-arena">Chatbot Arena</h2>
<p>ä½†æ˜¯ï¼Œäº‹æƒ…å‘ç”Ÿäº†ä¸€äº›æœ‰è¶£çš„å˜åŒ–ã€‚</p>
<p>æœ€è¿‘åœ¨é˜…è¯»ä¸€ç¯‡å¤§è¯­è¨€æ¨¡å‹è¯„ä¼°çš„ç»¼è¿°è®ºæ–‡â€”â€”<a href="https://arxiv.org/abs/2307.03109"><em>A Survey on Evaluation of Large Language Models</em></a>ï¼Œè¯¥è®ºæ–‡ä¸­æåˆ°äº†ç”± <a href="https://lmsys.org/">LMSYS Org</a> å‘å¸ƒçš„ Chatbot Arena å¹³å°ï¼ŒChatbot Arena æ˜¯ä¸€ä¸ªåŸºäº Elo æ‰“åˆ†çš„å¤§è¯­è¨€æ¨¡å‹çš„åŸºå‡†å¹³å°ï¼ˆ<a href="https://lmsys.org/blog/2023-05-03-arena/">Chatbot Arena: Benchmarking LLMs in the Wild with Elo Ratings</a>ï¼‰ã€‚</p>
<p>Chatbot Arena å¹³å°é€šè¿‡ä¼—åŒ…çš„å½¢å¼ï¼Œé‡‡ç”¨åŒ¿åã€éšæœºçš„æ–¹å¼å¯¹ä¸åŒçš„ LLMsï¼ˆLarge Language Modelsï¼‰ è¿›è¡Œæ‰“åˆ†ï¼Œç„¶ååŸºäºå›½é™…è±¡æ£‹ç­‰ç«æŠ€æ¸¸æˆä¸­å¹¿æ³›ä½¿ç”¨çš„ Elo ç§¯åˆ†ç³»ç»Ÿå¯¹ LLMs è¿›è¡Œ Elo ç§¯åˆ†è®¡ç®—ï¼Œæœ€ç»ˆé€šè¿‡ Elo ç§¯åˆ†å¯¹ LLMs è¿›è¡Œæ’åºä»¥ç¡®å®š LLMs çš„æ’åã€‚</p>
<p>Chatbot Arena æ¯æ¬¡ä¼šéšæœºé€‰æ‹©ä¸¤ä¸ªä¸åŒçš„å¤§è¯­è¨€æ¨¡å‹å’Œç”¨æˆ·èŠå¤©ï¼Œå¹¶è®©ç”¨æˆ·åœ¨åŒ¿åçš„æƒ…å†µä¸‹åˆ¤å®šå“ªæ¬¾å¤§æ¨¡å‹äº§å“çš„è¡¨ç°æ›´å¥½ä¸€äº›ã€‚</p>
<p><img src="/2023/08/12/the-interesting-elo-rating-system/3.png" alt></p>
<p>åœ¨å¾—åˆ°ç”¨æˆ·çš„åŒ¿åæ‰“åˆ†ä¹‹åï¼ŒChatbot Arena é€šè¿‡è®¡ç®— Elo ç®—æ³•æ¥è·å¾— LLMs çš„ Elo ç§¯åˆ†ã€‚</p>
<p><img src="/2023/08/12/the-interesting-elo-rating-system/4.png" alt></p>
<p>æˆ‘ä»¬å¯ä»¥åœ¨ <a href="https://huggingface.co/spaces/lmsys/chatbot-arena-leaderboard">chatbot-arena-leaderboard é¡µé¢</a> è·å–å½“å‰ Chatbot Arena å¹³å°çš„ LLMs çš„æ¦œå•ã€‚</p>
<h2 id="elo-rating">Elo rating</h2>
<h3 id="elo-çš„å†å²">Elo çš„å†å²</h3>
<p>Elo ä¸æ˜¯ç¼©å†™ï¼Œè€Œæ˜¯æ ¹æ® Elo è¯„åˆ†ç³»ç»Ÿçš„å‘æ˜è€…ã€ç¾å›½ç‰©ç†å­¦æ•™æˆ Arpad Elo çš„å§“æ°æ¥å‘½åçš„ä¸€ä¸ªè¯„åˆ†æœºåˆ¶ã€‚Elo è¯„åˆ†æœºåˆ¶çš„ç›®çš„æ˜¯ä¸ºäº†æ›´åŠ å…¬å¹³çš„è¯„ä¼°åƒå¦‚å›½é™…è±¡æ£‹è¿™ç±»ç«æŠ€æ¯”èµ›çš„é€‰æ‰‹çš„æ°´å¹³ã€‚</p>
<p>åœ¨ Elo ä»¥å‰ï¼Œå›½é™…è±¡æ£‹é€‰æ‰‹æ’åä½“ç³»å·²ç»æœ‰<a href="https://en.wikipedia.org/wiki/Chess_rating_system">ä¸¤å¥—ç³»ç»Ÿ</a>ï¼š</p>
<ul>
<li>æ¬§æ´²çš„ Ingo ç­‰çº§ç§¯åˆ†ç³»ç»Ÿ</li>
<li>ç¾å›½è±¡æ£‹åä¼šï¼ˆUSCFï¼‰çš„ Harkness ç­‰çº§ç§¯åˆ†ç³»ç»Ÿ</li>
</ul>
<p>è™½ç„¶è¯´ Harkness ç³»ç»Ÿç›¸å¯¹å…¬å¹³ï¼Œä½†æ˜¯åœ¨æŸäº›æƒ…å†µä¸‹ä¼šäº§ç”Ÿè®¸å¤šä¸å‡†ç¡®çš„è¯„åˆ†ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒElo æ•™æˆä»£è¡¨ USCF è®¾è®¡äº†ä¸€ä¸ªæ›´å®Œå–„çš„æ–°ç³»ç»Ÿã€‚1960 å¹´ï¼ŒUSCF æ­£å¼é‡‡ç”¨ Elo è¯„çº§ç³»ç»Ÿï¼›1970 å¹´ï¼Œå›½é™…æ£‹è”æ­£å¼é‡‡ç”¨ Elo è¯„çº§ç³»ç»Ÿã€‚ç›®å‰ï¼Œè®¸å¤šå›½é™…è±¡æ£‹ç»„ç»‡å’Œç½‘ç«™ä¹Ÿä½¿ç”¨ Elo ç³»ç»Ÿæ¥å¯¹ç©å®¶è¿›è¡Œè¯„åˆ†<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup>ã€‚</p>
<h3 id="elo-çš„æ•°å­¦åŸç†">Elo çš„æ•°å­¦åŸç†</h3>
<p>æ¯ä¸ªé€‰æ‰‹çš„ Elo è¯„åˆ†ç”±ä¸€ä¸ªæ•°å­—è¡¨ç¤ºï¼Œè¯¥æ•°å­—åæ˜ äº†è¯¥é€‰æ‰‹åœ¨ä¹‹å‰è¯„åˆ†æ¸¸æˆä¸­çš„æˆç»©ã€‚æ¯åœºæ¯”èµ›ä¹‹åï¼Œé€‰æ‰‹çš„è¯„åˆ†éƒ½ä¼šæ ¹æ®æ¯”èµ›ç»“æœè¿›è¡Œè°ƒæ•´ã€‚æ ¹æ®ç»éªŒï¼Œä¸€åå¾—åˆ†æ¯”å¯¹æ‰‹é«˜ 100 åˆ†çš„é€‰æ‰‹é¢„è®¡å°†èµ¢å¾—å…«åœºæ¯”èµ›ä¸­çš„äº”åœºï¼ˆ64%ï¼‰ï¼Œä¸€ä¸ªæ‹¥æœ‰ 200 åˆ†ä¼˜åŠ¿çš„é€‰æ‰‹å¤§æ¦‚ä¼šèµ¢å¾—å››åœºæ¯”èµ›ä¸­çš„ä¸‰åœºï¼ˆ75%ï¼‰ã€‚</p>
<p>Elo åœ¨è§£é‡Šé€‰æ‰‹å¯¹æˆ˜æƒ…å†µæ—¶ï¼Œåˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†<sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup>ï¼š</p>
<ul>
<li><strong>1.æ ¹æ®æˆ˜åŠ›å·®æ¥è®¡ç®—å¯¹æˆ˜èƒœç‡æƒ…å†µï¼Œå¤šå°‘åˆ†å·®å¯¹åº”å¤šå°‘èƒœç‡ã€‚</strong></li>
<li><strong>2.é€‰æ‰‹å®Œæˆå¯¹å±€åå®é™…è·å¾—çš„ç§¯åˆ†å¢é•¿ã€‚</strong></li>
</ul>
<h4 id="elo-é¢„æœŸèƒœç‡">Elo é¢„æœŸèƒœç‡</h4>
<p>åœ¨ç«æŠ€æ¯”èµ›ä¸­ï¼Œå¼ºæ‰‹æœªå¿…æ€»æ˜¯èƒœè¿‡å¼±æ‰‹ï¼Œå³ä½¿åœ¨å…¶æœ€å¥½çš„çŠ¶æ€æ—¶ï¼Œä»ç„¶å¯èƒ½ä¼šçŠ¯é”™å¹¶è¾“æ‰æ¯”èµ›ã€‚å®é™…ä¸Šï¼Œä»»ä½•ä¸€åé€‰æ‰‹çš„æ¯”èµ›è¡¨ç°éƒ½åº”è¯¥ç¬¦åˆæ­£æ€åˆ†å¸ƒï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><msqrt><mrow><mn>2</mn><mi>Ï€</mi></mrow></msqrt><mi>Ïƒ</mi></mrow></mfrac><msup><mi>e</mi><mfrac><mrow><mo>âˆ’</mo><mo stretchy="false">(</mo><mi>x</mi><mo>âˆ’</mo><mi>Î¼</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><mrow><mn>2</mn><msup><mi>Ïƒ</mi><mn>2</mn></msup></mrow></mfrac></msup></mrow><annotation encoding="application/x-tex">f(x) = \frac{1}{\sqrt{2\pi}\sigma}e^{\frac{-(x-\mu)^2}{2\sigma^2}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.25909em;vertical-align:-0.93em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.2027799999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.90722em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">2</span><span class="mord mathdefault" style="margin-right:0.03588em;">Ï€</span></span></span><span style="top:-2.86722em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.13278em;"><span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.03588em;">Ïƒ</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.93em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.32909em;"><span style="top:-3.4534200000000004em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.250957142857143em;"><span style="top:-2.5061857142857145em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9384399999999999em;"><span style="top:-2.93844em;margin-right:0.1em;"><span class="pstrut" style="height:2.64444em;"></span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.2255000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.5020714285714285em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">x</span><span class="mbin mtight">âˆ’</span><span class="mord mathdefault mtight">Î¼</span><span class="mclose mtight"><span class="mclose mtight">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.04844em;"><span style="top:-3.04844em;margin-right:0.1em;"><span class="pstrut" style="height:2.64444em;"></span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.49381428571428565em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>å…¶ä¸­ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¼</mi></mrow><annotation encoding="application/x-tex">\mu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">Î¼</span></span></span></span> ä»£è¡¨é€‰æ‰‹å®åŠ›çš„å¹³å‡æ°´å¹³ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ïƒ</mi></mrow><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">Ïƒ</span></span></span></span> ä»£è¡¨å®åŠ›çš„ç¨³å®šæ€§ã€‚</p>
<p>å¯¹äºä¸¤ä¸ªé€‰æ‰‹è€Œè¨€ï¼š</p>
<ul>
<li>é€‰æ‰‹Aï¼Œå¹³å‡è¡¨ç° 1800 åˆ†ï¼Œä½†æ˜¯å‘æŒ¥ä¸ç¨³å®šï¼Œå…¶æ³¢åŠ¨åˆ†å€¼ä¸º 200 åˆ†å·¦</li>
<li>é€‰æ‰‹Bï¼Œå¹³å‡è¡¨ç° 2000 åˆ†ï¼Œå¹¶ä¸”å‘æŒ¥å¾ˆç¨³å®šï¼Œå…¶æ³¢åŠ¨åˆ†å€¼åœ¨ 100 å·¦å³</li>
</ul>
<p>é‚£ä¹ˆï¼Œä»–ä»¬çš„è¡¨ç°åº”ç¬¦åˆå¦‚ä¸‹çš„ä¸¤ä¸ªæ­£æ€åˆ†å¸ƒï¼š</p>
<p><img src="/2023/08/12/the-interesting-elo-rating-system/5.jpg" alt></p>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œé‚£ä¹ˆåœ¨ 1850 åˆ†å¤„ï¼ŒB èƒ½æˆ˜èƒœ A çš„æ¡ä»¶ä¸ºï¼šA å¾— 1850 æ—¶ï¼ŒB çš„è¡¨ç°åˆ†é«˜äº 1850ã€‚ä¹Ÿå°±æ˜¯ï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>B</mi><mo>:</mo><mi>w</mi><mi>i</mi><mi>n</mi></mrow></msub><mo stretchy="false">(</mo><mn>1850</mn><mo stretchy="false">)</mo><mo>=</mo><msub><mi>P</mi><mi>A</mi></msub><mo stretchy="false">(</mo><mn>1850</mn><mo stretchy="false">)</mo><mo>âˆ—</mo><msub><mi>P</mi><mi>B</mi></msub><mo stretchy="false">(</mo><mo>&gt;</mo><mn>1850</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P_{B:win}(1850) = P_{A}(1850) * P_{B}(&gt;1850)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span><span class="mrel mtight">:</span><span class="mord mathdefault mtight" style="margin-right:0.02691em;">w</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mord">8</span><span class="mord">5</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mord">8</span><span class="mord">5</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">8</span><span class="mord">5</span><span class="mord">0</span><span class="mclose">)</span></span></span></span></span></p>
<p><img src="/2023/08/12/the-interesting-elo-rating-system/6.jpg" alt></p>
<p>è€Œåƒ 1850 è¿™æ ·çš„ç‚¹æœ‰æ— æ•°ä¸ªï¼š</p>
<p><img src="/2023/08/12/the-interesting-elo-rating-system/elo_demo.gif" alt></p>
<p>æ‰€ä»¥ B èƒ½æˆ˜èƒœ A çš„æœ€ç»ˆæ¦‚ç‡ï¼Œæ˜¯è¿™æ— æ•°ä¸ªç‚¹ä¸‹ï¼ŒB æˆ˜èƒœ A çš„æ¦‚ç‡çš„å’Œï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªç§¯åˆ†è¿ç®—ï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>D</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>+</mo><msubsup><mo>âˆ«</mo><mn>0</mn><mi>D</mi></msubsup><mrow><mfrac><mn>1</mn><mrow><msqrt><mrow><mn>2</mn><mi>Ï€</mi></mrow></msqrt><mi>Ïƒ</mi></mrow></mfrac><msup><mi>e</mi><mfrac><mrow><mo>âˆ’</mo><msup><mi>x</mi><mn>2</mn></msup></mrow><mrow><mn>2</mn><msup><mi>Ïƒ</mi><mn>2</mn></msup></mrow></mfrac></msup><mi>d</mi><mi>x</mi></mrow></mrow><annotation encoding="application/x-tex">P(D) = \frac{1}{2} + \int_{0}^{D}{\frac{1}{\sqrt{2\pi}\sigma}e^{\frac{-x^2}{2\sigma^2}}dx}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.521231em;vertical-align:-0.93em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">âˆ«</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.591231em;"><span style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span><span style="top:-3.8129000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">D</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.2027799999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.90722em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">2</span><span class="mord mathdefault" style="margin-right:0.03588em;">Ï€</span></span></span><span style="top:-2.86722em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.13278em;"><span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.03588em;">Ïƒ</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.93em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.24644em;"><span style="top:-3.4534200000000004em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1328857142857145em;"><span style="top:-2.5061857142857145em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9384399999999999em;"><span style="top:-2.93844em;margin-right:0.1em;"><span class="pstrut" style="height:2.64444em;"></span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.2255000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.04844em;"><span style="top:-3.04844em;margin-right:0.1em;"><span class="pstrut" style="height:2.64444em;"></span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.49381428571428565em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span><span class="mord mathdefault">d</span><span class="mord mathdefault">x</span></span></span></span></span></span></p>
<p>å…¶ä¸­ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span></span></span></span> ä¸ºä¸¤åé€‰æ‰‹çš„åˆ†å·®ã€‚</p>
<p>åˆ©ç”¨æœ€å°äºŒä¹˜æ³•ï¼Œå¯ä»¥å¾—åˆ°ä¸ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>D</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P(D)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mclose">)</span></span></span></span> å‡½æ•°è¶‹å‘ç›¸è¿‘çš„å¦ä¸€ä¸ªå‡½æ•°ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬å®é™…åº”ç”¨æ—¶æ›´å¸¸ç”¨çš„å‡½æ•°ï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>D</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mn>1</mn><msup><mn>0</mn><mfrac><mi>D</mi><mn>400</mn></mfrac></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">P(D) = \frac{1}{1 + 10^{\frac{D}{400}}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.2537849999999997em;vertical-align:-0.932345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.1509850000000004em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.959015em;"><span style="top:-3.3485500000000004em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8720928571428572em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">0</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2255000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">D</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.932345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>å³å½“é€‰æ‰‹ A ä¸é€‰æ‰‹ B çš„åˆ†å·®ï¼ˆA-Bï¼‰ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span></span></span></span> æ—¶ï¼Œé€‰æ‰‹ A å¯¹é€‰æ‰‹ B çš„æœŸæœ›èƒœç‡ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>D</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P(D)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mclose">)</span></span></span></span>ï¼Œåˆ™ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>D</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P(D)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mclose">)</span></span></span></span> ä¸ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span></span></span></span> ä¹‹é—´çš„å˜åŒ–å…³ç³»å¦‚ä¸‹å›¾ï¼š</p>
<p><img src="/2023/08/12/the-interesting-elo-rating-system/7.png" alt></p>
<h4 id="elo-ç§¯åˆ†è¿­ä»£">Elo ç§¯åˆ†è¿­ä»£</h4>
<p>æˆ‘ä»¬å¦‚ä½•ç¡®å®šé€‰æ‰‹çš„ Elo ç§¯åˆ†åˆ°åº•æ˜¯å¤šå°‘å‘¢ï¼Ÿ</p>
<p>Elo çš„åšæ³•æ˜¯ï¼šé€šè¿‡é€‰æ‰‹ä¸ä¸åŒåˆ†æ•°é€‰æ‰‹çš„å¤§é‡æ¯”èµ›ç»“æœï¼Œå¯¹é€‰æ‰‹çš„ Elo åˆ†æ•°è¿›è¡Œä¸æ–­ä¿®æ­£ï¼Œç›´åˆ°é€‰æ‰‹çš„åˆ†æ•°æ”¶æ•›åˆ°å…¶ç›¸åº”çš„çœŸå®æ°´å¹³ã€‚</p>
<p>Elo çš„ç§¯åˆ†è¿­ä»£å…¬å¼å¦‚ä¸‹ï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi>n</mi></msub><mo>=</mo><msub><mi>R</mi><mi>o</mi></msub><mo>+</mo><mi>K</mi><mo>âˆ—</mo><mo stretchy="false">(</mo><mi>W</mi><mo>âˆ’</mo><mi>P</mi><mo stretchy="false">(</mo><mi>D</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">R_n = R_o + K * (W - P(D))
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">o</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></p>
<p>å…¶ä¸­ï¼š</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">R_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> æ˜¯é€‰æ‰‹æ¯”èµ›ç»“æŸåçš„æ–°çš„ Elo ç§¯åˆ†</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi>o</mi></msub></mrow><annotation encoding="application/x-tex">R_o</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">o</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> æ˜¯é€‰æ‰‹æ¯”èµ›å‰çš„ Elo ç§¯åˆ†</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span></span></span></span> æ˜¯ä¸€ä¸ªåŠ æˆç³»æ•°ï¼Œç”±é€‰æ‰‹å½“å‰çš„åˆ†å€¼æ°´å¹³å†³å®šï¼Œåˆ†å€¼è¶Šé«˜ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span></span></span></span> è¶Šå°</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">W</span></span></span></span> æ˜¯é€‰æ‰‹çš„å®é™…å¯¹å±€ç»“æœå¾—åˆ†ï¼Œèµ¢å¾— 1 åˆ†ï¼Œè¾“å¾— 0 åˆ†ï¼Œå¹³å±€å¾— 0.5 åˆ†</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>D</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P(D)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mclose">)</span></span></span></span> æ˜¯é€‰æ‰‹çš„é¢„æœŸèƒœç‡</li>
</ul>
<p>æ¯”èµ›ç»“æŸåï¼Œé€‰æ‰‹çš„ç§¯åˆ†å¢åŠ ä¸åˆ†å·® <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span></span></span></span> ä¹‹é—´çš„å˜åŒ–è¶‹åŠ¿å¦‚ä¸‹å›¾ï¼š</p>
<p><img src="/2023/08/12/the-interesting-elo-rating-system/8.png" alt></p>
<p>ç”±æ­¤å¯çŸ¥ï¼š</p>
<ul>
<li>å¦‚æœé€‰æ‰‹æˆ˜èƒœæ¯”è‡ªå·±ä½ 800 åˆ†çš„é€‰æ‰‹åï¼Œå› ä¸ºæ­¤æ—¶ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>D</mi><mo stretchy="false">)</mo><mo>â‰ˆ</mo><mn>100</mn><mi mathvariant="normal">%</mi></mrow><annotation encoding="application/x-tex">P(D) \approx 100\%</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰ˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.80556em;vertical-align:-0.05556em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mord">%</span></span></span></span>ï¼Œå› æ­¤ï¼Œå³ä¾¿é€‰æ‰‹è·èƒœä¹ŸåŸºæœ¬ä¸å¾—åˆ†ã€‚</li>
<li>å¦‚æœé€‰æ‰‹æˆ˜èƒœæ¯”è‡ªå·±é«˜ 800 åˆ†çš„é€‰æ‰‹åï¼Œå› ä¸ºæ­¤æ—¶ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>D</mi><mo stretchy="false">)</mo><mo>â‰ˆ</mo><mn>0</mn><mi mathvariant="normal">%</mi></mrow><annotation encoding="application/x-tex">P(D) \approx 0\%</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰ˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.80556em;vertical-align:-0.05556em;"></span><span class="mord">0</span><span class="mord">%</span></span></span></span>ï¼Œå› æ­¤ï¼Œå¦‚æœé€‰æ‰‹è·èƒœï¼Œåˆ™å¯ä»¥å¾—åˆ° 32 åˆ†ã€‚</li>
</ul>
<p>å¯¹äº Elo ç§¯åˆ†ç³»ç»Ÿè€Œè¨€ï¼Œè¯¥ç³»ç»Ÿçš„ç‰¹ç‚¹æ˜¯ï¼šé€‰æ‰‹ä¹‹é—´çš„æ°´å¹³å·®è·å†³å®šäº†ä»–ä»¬èƒ½èµ¢å¤šå°‘åˆ†æˆ–è¾“å¤šå°‘åˆ†ã€‚</p>
<p>Elo åˆ†é«˜å¾—å¤šçš„é€‰æ‰‹æœ‰æœ›è·èƒœï¼Œå› æ­¤ä»–ä»¬åœ¨ä¸å¾—åˆ†ä½å¾—å¤šçš„é€‰æ‰‹çš„æ¯”èµ›ä¸­è·èƒœä¸ä¼šå¾—åˆ°å¾ˆå¤šåˆ†æ•°ï¼ŒåŒæ—¶ï¼Œä»–ä»¬çš„å¯¹æ‰‹ä¹Ÿæ²¡æœ‰å› ä¸ºå¤±è´¥è€ŒæŸå¤±å¤§é‡çš„åˆ†æ•°ã€‚</p>
<p>åä¹‹ï¼ŒElo åˆ†è¾ƒä½çš„é€‰æ‰‹è·èƒœæ—¶ï¼Œåˆ™è¯¥é€‰æ‰‹ä¼šè·å¾—æ›´å¤šçš„ Elo åˆ†æ•°ï¼Œå…¶å¯¹æ‰‹ä¹Ÿä¼šå—åˆ°å¯¹åº”çš„æ¯”è¾ƒå¤šçš„æ‰£åˆ†ã€‚</p>
<p>è¿™çœ‹èµ·æ¥æ˜¯å¤šä¹ˆçš„åˆç†ã€‚</p>
<h2 id="elo-åœ¨è§†é¢‘è´¨é‡æ‰“åˆ†ä¸­çš„åº”ç”¨">Elo åœ¨è§†é¢‘è´¨é‡æ‰“åˆ†ä¸­çš„åº”ç”¨</h2>
<h3 id="elo-çš„ç‰¹ç‚¹">Elo çš„ç‰¹ç‚¹</h3>
<p>Elo å…·å¤‡å¦‚ä¸‹çš„ç‰¹ç‚¹<sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup>ï¼š</p>
<ul>
<li><strong>ç¦»æ•£æ€§</strong>ï¼šElo ç§¯åˆ†çš„è®¡ç®—ä¸éœ€è¦å¤ªå¤šçš„ä¿¡æ¯ï¼Œåªéœ€è¦çŸ¥é“ä¸‰ä¸ªè¦ç´ å³å¯å¯¹ç§¯åˆ†è¿›è¡Œè¿­ä»£ï¼šé€‰æ‰‹èµ›å‰ç§¯åˆ†ï¼Œå¯¹æ‰‹èµ›å‰ç§¯åˆ†ï¼Œæ¯”èµ›ç»“æœã€‚</li>
<li><strong>å…·å¤‡æ”¶æ•›è¿‡ç¨‹</strong>ï¼šElo ç§¯åˆ†åœ¨è¾¾åˆ°åˆç†ä¹‹å‰å­˜åœ¨ä¸€ä¸ªæ”¶æ•›è¿‡ç¨‹ï¼Œæ¯”å¦‚ä¸€ä¸ª 2000 åˆ†æ°´å¹³çš„ç©å®¶åœ¨ç©å°å·æ—¶ï¼Œå…¶é‡åˆ°çš„å¯¹æ‰‹å¤§æ¦‚ç‡éƒ½æ˜¯ä» 1200 åˆ†å¼€å§‹çš„ï¼Œè¿™æ—¶å€™ Elo åˆ†æ— æ³•ç²¾ç¡®çš„ååº”ä»–çš„çœŸå®å®åŠ›ã€‚ä¸ºäº†è·å–è¯¥ç©å®¶çš„çœŸå®æ°´å¹³ï¼Œéœ€è¦ä¸€ä¸ªè¿‡ç¨‹ï¼Œä¹Ÿå°±æ˜¯ Elo ç§¯åˆ†çš„æ”¶æ•›è¿‡ç¨‹ã€‚</li>
<li><strong>å¯¹æ‰€æœ‰æ¯”èµ›ä¸€è§†åŒä»</strong>ï¼šElo åˆ†åªä¼šæ ¹æ®åŒä¸€è¯„åˆ†ä½“ç³»ä¸‹çš„ç§¯åˆ†è¿›è¡Œè¿­ä»£ï¼Œç§¯åˆ†å¢é•¿æƒ…å†µå’Œèµ›äº‹é‡è¦æ€§æ— å…³ã€‚</li>
<li><strong>ä¸æ¯”èµ›é¡ºåºæœ‰ä¸€å®šå…³ç³»</strong>ï¼šæ¯”èµ›é¡ºåºå¯èƒ½ä¼šå¯¹ Elo ç§¯åˆ†çš„å˜åŒ–æœ‰ä¸€å®šå½±å“ã€‚ä½†æ˜¯ï¼Œå› ä¸ºé€‰æ‰‹çš„è¡¨ç°æ˜¯æˆæ­£å¤ªåˆ†å¸ƒï¼Œå†åŠ ä¸Š Elo ç§¯åˆ†çš„æ”¶æ•›ç‰¹æ€§ï¼Œå› æ­¤ï¼Œåœ¨ç»è¿‡å¤šè½®æ¯”èµ›ä¹‹åï¼ŒElo çš„ç§¯åˆ†æœ€ç»ˆä¼šè¶‹å‘ä¸€ä¸ªæ¯”è¾ƒåˆç†çš„åˆ†å€¼ã€‚</li>
</ul>
<h3 id="elo-å¦‚ä½•è¯„ä¼°ç¼–è§£ç å™¨çš„æ°´å¹³">Elo å¦‚ä½•è¯„ä¼°ç¼–è§£ç å™¨çš„æ°´å¹³</h3>
<p>æ­£å› ä¸º Elo æœ‰å¦‚ä¸Šçš„ç‰¹ç‚¹ï¼Œæˆ‘ä»¬è®¤ä¸ºåœ¨å¯¹æ¯”è¯„ä¼°ä¸¤ä¸ªç¼–è§£ç å™¨æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ Elo ç§¯åˆ†æ¥è¿›è¡Œç¼–è§£ç å™¨çš„æ’ä½ã€‚æ¯ä¸€ä¸ªè§†é¢‘çš„æ‰“åˆ†éƒ½å¯ä»¥è¢«è§†ä¸ºä¸€æ¬¡æ¯”èµ›ï¼Œè€Œéšç€è¯„ä¼°è§†é¢‘çš„æ•°é‡å¢åŠ ï¼Œæœ€ç»ˆçš„ Elo ç§¯åˆ†ä¹Ÿä¼šä¸æ–­æ”¶æ•›è‡³ä¸€ä¸ªåˆç†çš„æ°´å¹³ï¼Œè¿›è€Œå¯ä»¥æ¯”è¾ƒå‡†ç¡®çš„æ¥è¡¡é‡ç¼–è§£ç å™¨çš„ä¼˜åŠ£ã€‚</p>
<p>å¯¹äºç¼–è§£ç å™¨ Aã€B çš„å¦‚ä¸‹ MOS åˆ†ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">MOS_Scores &#x3D; [61, 55, 54, 65, 15] </span><br></pre></td></tr></table></figure>
<p>å¦‚æœåˆå§‹å¾—åˆ†å‡ä¸º 1500ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥å¾—åˆ°æœ€ç»ˆçš„ Elo å¾—åˆ†å¦‚ä¸‹ï¼š</p>
<ul>
<li>Aï¼š1490</li>
<li>Bï¼š1510</li>
</ul>
<p>å¯ä»¥ä½¿ç”¨ <a href="https://github.com/wangwei1237/wangwei1237.github.io_src/blob/master/source/_posts/the-interesting-elo-rating-system/elo.py">elo.py</a> è„šæœ¬ <a href="https://github.com/wangwei1237/wangwei1237.github.io_src/blob/master/source/_posts/the-interesting-elo-rating-system/MOS">å¯¹ 100 ä¸ªè¯„ä¼°è§†é¢‘çš„ MOS å¾—åˆ†</a> è¿›è¡Œ Elo ç§¯åˆ†è¿­ä»£ï¼Œå…¶ Elo ç§¯åˆ†çš„è¿­ä»£å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="/2023/08/12/the-interesting-elo-rating-system/9.png" alt></p>
<p>ä»å›¾ä¸Šå¯çŸ¥ï¼šå¯¹äº Elo è€Œè¨€ï¼Œç¡®å®éœ€è¦ä¸€å®šçš„æ”¶æ•›å‘¨æœŸã€‚å¦‚æœè¯„ä¼°è§†é¢‘æ ·æœ¬é‡ä¸å¤Ÿï¼Œæ¯”å¦‚åªæœ‰ 38 ä¸ªï¼Œé‚£ä¹ˆå¾ˆæœ‰å¯èƒ½å°±ä¼šå¾—åˆ°é”™è¯¯çš„ç»“è®ºã€‚</p>
<p>å¦å¤–ï¼Œå¯¹äºè§†é¢‘è¯„ä¼°è€Œè¨€ï¼Œæˆ‘ä»¬è®¤ä¸ºï¼Œç»™å®šä¸¤ä¸ªç¼–ç å™¨èµ‹ä»¥ç›¸åŒçš„åˆå§‹åˆ†ï¼ˆå‡å®šä¸¤ä¸ªç¼–è§£ç å™¨æ•ˆæœä¸€è‡´ï¼‰æ›´ä¸ºåˆç†ã€‚</p>
<h3 id="è§†é¢‘é¡ºåºå¯¹-elo-çš„å½±å“">è§†é¢‘é¡ºåºå¯¹ Elo çš„å½±å“</h3>
<p>å¦‚å‰æ‰€è¿°ï¼Œåˆå§‹åˆ†æ•°æœ‰å¯èƒ½ä¼šå¯¹ Elo å¸¦æ¥å½±å“ï¼Œä½†æ˜¯å› ä¸º Elo çš„æ”¶æ•›ç‰¹æ€§ï¼Œå½“è§†é¢‘æ ·æœ¬è¶³å¤Ÿå¤šçš„æ—¶å€™ï¼Œè§†é¢‘é¡ºåºä¸ä¼šå½±å“æœ€ç»ˆçš„ Elo å¾—åˆ†ã€‚</p>
<p>ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯¹è§†é¢‘é¡ºåºè¿›è¡Œäº†éšæœºæ’åºï¼Œç„¶åå†æ¥è®¡ç®— Elo å¾—åˆ†ã€‚æˆ‘ä»¬å‘ç°ï¼Œè§†é¢‘é¡ºåºå˜æ¢åï¼Œå¹¶æ²¡æœ‰å½±å“æœ€ç»ˆçš„ç»“è®ºã€‚<br>
<img src="/2023/08/12/the-interesting-elo-rating-system/10.png" alt></p>
<h2 id="å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</h2>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p><a href="https://www.chess.com/terms/elo-rating-chess">Elo Rating System</a> <a href="#fnref1" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn2" class="footnote-item"><p><a href="https://en.wikipedia.org/wiki/Elo_rating_system">Elo Rating System</a> <a href="#fnref2" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn3" class="footnote-item"><p><a href="https://zhuanlan.zhihu.com/p/28190267">é€šä¿—è®²ä¹‰ï¼šåŒ¹é…ç³»ç»Ÿæ ¸å¿ƒ â€œELOâ€ç§¯åˆ†æ­ç§˜</a> <a href="#fnref3" class="footnote-backref">â†©ï¸</a></p>
</li>
</ol>
</section>
]]></content>
      <categories>
        <category>ç®—æ³•ä¸æ•°å­¦</category>
      </categories>
      <tags>
        <tag>Elo rating</tag>
        <tag>Chatbot Arena</tag>
      </tags>
  </entry>
  <entry>
    <title>æˆ‘çš„â€œé€†å‘å·¥ä½œâ€å®è·µ</title>
    <url>/2023/07/09/My-practice-of-working-backwards/</url>
    <content><![CDATA[<p><img src="/2023/07/09/My-practice-of-working-backwards/1.png" alt></p>
<p>2023 å¹´ 4 æœˆ 1 æ—¥ï¼Œæˆ‘åœ¨ <a href="https://bj2022.livevideostack.cn/schedule">LiveVideoStack 2022 åŒ—äº¬ç«™</a> å¤§ä¼šä¸Šï¼Œä»¥ <a href="https://mp.weixin.qq.com/s/J2QGTiMOgMnZbAyI81I87Q">ã€Šç™¾åº¦è§†é¢‘è´¨é‡è¯„æµ‹çš„å®è·µä¹‹è·¯ã€‹</a> ä¸ºé¢˜ä»‹ç»äº†å›¢é˜Ÿåœ¨è§†é¢‘è´¨é‡è¯„æµ‹æ–¹å‘çš„æ€è€ƒä¸è®¤çŸ¥ã€‚å›é¦–å‘æ¥è§ç‘Ÿå¤„ï¼Œé‡‘æˆˆé“é©¬ï¼Œè‹å±±å¦‚æµ·ã€‚</p>
<p>ç«™åœ¨åéªŒç»“æœçš„è§†è§’æ¥å®¡è§†è¿™ä¸ªè¿‡ç¨‹ï¼Œå‘ç°æœ‰å¾ˆå¤šçš„åœ°æ–¹â€”â€”å°¤å…¶æ˜¯â€œé€†å‘å·¥ä½œâ€æ€è·¯å¯¹æ•´ä¸ªäº‹æƒ…çš„æ¨åŠ¨ï¼Œå€¼å¾—è¿›ä¸€æ­¥æ€è€ƒä¸æ€»ç»“ã€‚åŒæ—¶ï¼Œæœ€è¿‘å’ŒåŒäº‹åœ¨è®¨è®ºå…¶ä»–æ–¹å‘çš„å·¥ä½œæ€è·¯æ—¶ï¼Œæˆ‘å‘ç°â€œé€†å‘å·¥ä½œâ€è¿™ä¸ªè¯é¢‘ç¹çš„å‡ºç°ã€‚å†åŠ ä¸Šï¼Œè¿‘æ¥åˆåœ¨è¯»è´ä½æ–¯çš„ 24 å°â€œè‡´è‚¡ä¸œä¿¡â€ï¼Œåœ¨ 2008 å¹´çš„â€œè‡´è‚¡ä¸œä¿¡â€ä¸­æåˆ°çš„â€œé€†å‘å€’æ¨â€æ·±æ·±å¯å‘äº†æˆ‘ã€‚å› æ­¤ï¼Œæ›´æƒ³å¯¹è¿‡å»çš„è¿™ä¸€æ®µå·¥ä½œè¿›è¡Œä¸€ç•ªæ€»ç»“ã€‚</p>
<span id="more"></span>
<h2 id="è™šæ‹Ÿæ‘„åƒå¤´-é€†å‘åˆä½“éªŒ">è™šæ‹Ÿæ‘„åƒå¤´â€”â€”é€†å‘åˆä½“éªŒ</h2>
<p>æ—¶é’ˆå›æ‹¨åˆ° 2019 å¹´çš„å¤å¤©ï¼Œé‚£ä¸ªæ—¶å€™ï¼ŒæŠ–éŸ³ã€å¿«æ‰‹æä¾›çš„å¯ä»¥ä½¿ç”¨æ‰‹æœºæ‹æ‘„è§†é¢‘å¹¶å®æ—¶å¢åŠ å„ç§ç‰¹æ•ˆçš„åŠŸèƒ½è”šç„¶æˆé£ã€‚åœ¨é¹å¯°å›½é™…å¤§å¦çš„ä¸€ä¸ªä¼šè®®å®¤ä¸­ï¼Œæœ‰ä¸€ç¾¤äººæ­£åœ¨è¯‰è¯´ç€å·¥ä½œä¸­é‚£ä»¤äººâ€œçƒ¦æ¼â€çš„å¿«ä¹ï¼Œè¿™ç¾¤äººæ˜¯å½“æ—¶â€œå…¨æ°‘å°è§†é¢‘â€æµ‹è¯•å›¢é˜Ÿçš„åŒå­¦ï¼Œä»–ä»¬åˆšåˆšå®Œæˆäº†æ‹æ‘„å™¨ç‰¹æ•ˆåŠŸèƒ½å¤§æ”¹ç‰ˆçš„æµ‹è¯•ã€‚</p>
<ul>
<li>ä¸ºäº†æµ‹è¯•è¿™æ¬¡å¢åŠ çš„â€œæ‹å¤©ç©ºâ€ç‰¹æ•ˆï¼Œæˆ‘éƒ½æ™’é»‘äº†â€¦â€¦<div class="bili_video"><div style="position: relative; width: 100%; height: 0; padding-bottom: 75%;"><iframe src="https://player.bilibili.com/player.html?aid=253011891&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position: absolute; width: 100%; height: 100%; left: 0; top: 0;"> </iframe></div></div>
</li>
<li>ä¸ºäº†æµ‹è¯•å¼ å˜´ç‰¹æ•ˆï¼Œæˆ‘çš„ä¸‹å·´éƒ½è„±è‡¼äº†â€¦â€¦</li>
<li>â€¦â€¦</li>
</ul>
<p>æˆ‘æ„è¯†åˆ°æˆ‘æœ‰å¿…è¦åšç‚¹ä»€ä¹ˆæ¥æ”¹å˜è¿™ç§å±€é¢ï¼Œç„¶åé—®äº†ä¸€å¥ï¼šå¦‚ä½•æ‰èƒ½åšåˆ°ä¸€æ¬¡æ‹æ‘„ï¼Œæ¬¡æ¬¡å¯ç”¨ï¼Ÿè¿™æ ·å’±ä»¬å°±ä¸ç”¨å®³æ€•æ™’é»‘å’Œä¸‹å·´è„±è‡¼å•¦~</p>
<p>ä¸€æ—¶é—´ï¼Œå¤§å®¶éƒ½æ²‰é»˜äº†ï¼Œä¸€æ˜¯å› ä¸ºè¿™ç¡®å®æ˜¯ä¸ªå¥½ä¸»æ„ï¼ŒäºŒæ˜¯å› ä¸ºè¿™ä¸ªé—®é¢˜è¶…å‡ºäº†æˆ‘ä»¬èƒ½å›ç­”çš„èŒƒç•´ã€‚ç¡®å®ï¼Œåœ¨å½“æ—¶ï¼Œæˆ‘ä»¬åœ¨æŠ€æœ¯ä¸Šç¡®å®æ²¡æœ‰åŠæ³•åšåˆ°è¿™ä¸€ç‚¹ï¼Œå¦åˆ™æˆ‘ä»¬å°±ä¸ä¼šä¸‹å·´è„±è‡¼äº†ã€‚ç‰‡åˆ»æ²‰é»˜ä¹‹åï¼Œå¤§å®¶åˆçƒ­çƒˆçš„è®¨è®ºäº†èµ·æ¥ï¼Œæˆ‘ä»¬å¤©é©¬è¡Œç©ºçš„æƒ³äº†å¾ˆå¤šæ–¹æ¡ˆï¼Œä½†æ˜¯åœ¨è°ˆåˆ°è°å¯ä»¥æ¥è·Ÿè¿›çš„æ—¶å€™ï¼Œäº‹æƒ…åˆå¼€å§‹å˜å¾—éå¸¸å¾®å¦™ã€‚</p>
<p>è®¨è®ºä¹‹åçš„å·¥ä½œåˆæ¢å¤äº†å¾€æ—¥çš„å¿™ç¢Œï¼Œå¤§å®¶ä¼¼ä¹éƒ½å¿˜è®°äº†æœ‰è¿‡è¿™æ ·ä¸€æ¬¡è®¨è®ºï¼Œä¸è¿‡æˆ‘ä¾ç„¶å…´å¥‹ä¸å·²ã€‚ä¸ºäº†å®ç°â€œä¸€æ¬¡æ‹æ‘„ï¼Œæ¬¡æ¬¡å¯ç”¨â€çš„ç›®æ ‡ï¼Œæˆ‘å’Œå‡ ä¸ªå¿—åŒé“åˆçš„åŒäº‹å¼€å¯äº†ä¸€æ®µéš¾å¿˜çš„æ—¶å…‰ï¼Œåœ¨è¿™æ®µæ—¶å…‰é‡Œï¼Œæˆ‘ä»¬ç–¯ç‹‚æ±²å–å¤§é‡çš„å„ç±»æ–°çŸ¥è¯†ï¼š</p>
<ul>
<li>éŸ³è§†é¢‘åŸºç¡€çŸ¥è¯†ï¼Œæ•°å­—è§†é¢‘åŸºæœ¬æ¦‚å¿µ</li>
<li>Android ç›¸æœºç³»ç»ŸåŸç†</li>
<li>FFmpegï¼ŒOpenGL</li>
<li>Xposedæ¡†æ¶ï¼ŒAndroidé€†å‘ç ´è§£</li>
<li>â€¦â€¦</li>
</ul>
<p>ä»¤äººæ¬£å–œçš„æ˜¯ï¼Œåœ¨ 2019 å¹´çš„å›½åº†èŠ‚å‰ï¼Œæˆ‘ä»¬è¿˜çœŸçš„å°±å®ç°äº†â€œç”¨æŒ‡å®šè§†é¢‘æ›¿æ¢æ‘„åƒå¤´é‡‡é›†åˆ°çš„ç”»é¢â€çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºâ€œæ‘„åƒå¤´ HOOKâ€ã€‚æ˜¨æ—¥ä¹‹æ·±æ¸Šï¼Œä»Šæ—¥ä¹‹æµ…è°ˆã€‚çš„ç¡®ï¼Œå½“æˆ‘ä»¬è·¨è¶Šç§ç§å›°éš¾å®ç°ç›®æ ‡ä¹‹åï¼Œå›å¤´æƒ³æƒ³ï¼Œæ•´ä¸ªäº‹æƒ…å¥½åƒä¹Ÿæ²¡æœ‰é‚£ä¹ˆå›°éš¾ã€‚</p>
<p>æˆ‘ä»¬å°†æ ¸å¿ƒçš„æ€è·¯å…¬å¼€åˆ°äº† <a href="https://github.com/wangwei1237/CameraHook">GitHub</a>ï¼Œåœ¨ GitHub ä¸Šï¼Œæˆ‘ä»¬é‡åˆ°äº†æ–°çš„æœ‹å‹ï¼ŒåŸºäºæˆ‘ä»¬çš„æ€è·¯ï¼Œæˆ‘ä»¬çš„æ–°æœ‹å‹å®ç°äº†èƒ½åŠ›æ›´ä¸°å¯Œçš„ <a href="https://github.com/w2016561536/android_virtual_cam">è™šæ‹Ÿæ‘„åƒå¤´é¡¹ç›®</a>ã€‚åæ¥ï¼Œæˆ‘ä»¬ä¹ŸåŸºäºè¿™ä¸ªæ ¸å¿ƒæ€æƒ³ï¼Œå®ç°äº†ï¼šè´´çº¸æµ‹è¯•è‡ªåŠ¨åŒ–ï¼Œé«˜ç²¾å‡†è‚¢ä½“ã€äººè„¸è¯†åˆ«ï¼Œé«˜ç²¾å‡†ç›´æ’­å»¶è¿Ÿæµ‹è¯•â€¦â€¦ç­‰æŠ€æœ¯ï¼Œå½»åº•æ”¹å˜äº†åŸæœ‰çš„å·¥ä½œæ–¹å¼ï¼Œæå¤§æå‡äº†å·¥ä½œæ•ˆç‡ã€‚</p>
<h2 id="é€†å‘å€’æ¨">é€†å‘å€’æ¨</h2>
<p>åœ¨è™šæ‹Ÿæ‘„åƒå¤´çš„é¡¹ç›®ä¸Šæˆ‘å°åˆ°äº†ä¸€ä¸ä¸çš„ç”œå¤´ï¼Œæˆ‘æƒŠå¥‡çš„å‘ç°ï¼ŒåŸæ¥è¿˜å¯ä»¥è¿™æ ·è§£å†³é—®é¢˜ï¼Œæˆ‘å¼€å§‹é‡æ–°æ€è€ƒè¿™ç§å·¥ä½œæ–¹å¼çš„æœ‰è¶£ä¹‹å¤„ï¼š</p>
<ul>
<li>ä¸ä»¥ç°æœ‰çš„æŠ€æœ¯ä¸ºå‡ºå‘ç‚¹å»ç¡®å®šé—®é¢˜å¯ä»¥è§£å†³çš„ç¨‹åº¦<br>
<img src="/2023/07/09/My-practice-of-working-backwards/2.png" alt></li>
<li>ä»¥é—®é¢˜çš„æœ€ç»ˆè§£å†³ä¸ºç›®æ ‡é‡æ–°æ€è€ƒéœ€è¦åšä½•ç§å‡†å¤‡<br>
<img src="/2023/07/09/My-practice-of-working-backwards/3.png" alt></li>
</ul>
<p>ç›´åˆ°æœ€è¿‘ä¸€å£æ°”è¯»å®Œäº†äºšé©¬é€Š CEO <a href="https://mp.weixin.qq.com/s/ZIEBKte_CNsx_VdHH2TGPg">è´ä½æ–¯çš„24å°è‡´è‚¡ä¸œä¿¡</a> ä¹‹åï¼Œæˆ‘æ‰æ„è¯†åˆ°ï¼ŒåŸæ¥è¿™ç§æ€ç»´æ¨¡å¼å°±æ˜¯è´ä½æ–¯åœ¨ <a href="https://mp.weixin.qq.com/s/ejNdFv0g1Bg8_U8A1G6-tQ">2008 å¹´è‡´è‚¡ä¸œä¿¡</a> ä¸­æåˆ°çš„â€œé€†å‘å€’æ¨æ³•â€ã€‚</p>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition note"><p class="admonition-title">é€†å‘å€’æ¨
</p><p>ä»ç”¨æˆ·éœ€æ±‚å‡ºå‘çš„â€œé€†å‘å€’æ¨æ³•â€ï¼Œå¯ä¸åˆ©ç”¨ç°æœ‰æŠ€æœ¯å’Œèƒ½åŠ›æ¨åŠ¨å•†æœºçš„â€œæŠ€èƒ½æ­£æ¨æ³•â€å½¢æˆé²œæ˜å¯¹æ¯”ã€‚</p>
<ul>
<li>â€œæŠ€èƒ½æ­£æ¨æ³•â€çš„ç†å¿µæ˜¯ï¼šæˆ‘ä»¬éå¸¸æ“…é•¿ <code>X</code>ï¼Œåˆ©ç”¨ <code>X</code>ï¼Œæˆ‘ä»¬è¿˜èƒ½åšäº›ä»€ä¹ˆå‘¢ï¼Ÿè¿™çš„ç¡®æ˜¯ä¸€ç§å®ç”¨ä¸”æœ‰æ•ˆçš„åšæ³•ã€‚ç„¶è€Œï¼Œå¦‚æœä»…ä»…ä¾é æ“…é•¿çš„æŠ€èƒ½ï¼Œé‚£ä¹ˆå…¬å¸ä¾¿æ°¸è¿œä¸ä¼šæœ‰åŠ¨åŠ›å»å¼€å‘æ–°çš„æŠ€èƒ½ï¼Œè€Œæ—¢æœ‰çš„æŠ€èƒ½ä¹Ÿç»ˆå°†è¿‡æ—¶æ·˜æ±°ã€‚</li>
<li>ä»¥ç”¨æˆ·ä¸ºå‡ºå‘ç‚¹è¿›è¡Œå€’æ¨çš„æ–¹æ³•ï¼Œå¾€å¾€ä¼šè¦æ±‚æˆ‘ä»¬é”»ç‚¼æ–°çš„æŠ€èƒ½å¹¶åŠ¨ç”¨å¹³æ—¶ä¸å¸¸ç»ƒåˆ°çš„è‚Œè‚‰ï¼Œç»ä¸è¦å°†è¿ˆå‡ºç¬¬ä¸€æ­¥æ—¶å¯èƒ½å‡ºç°çš„ä¸é€‚ä¸å°´å°¬æ”¾åœ¨å¿ƒä¸Šã€‚</li>
</ul>
</div>
<p>åœ¨ <a href="https://book.douban.com/subject/35771946/">äºšé©¬é€Šé€†å‘å·¥ä½œæ³•</a> è¿™æœ¬ä¹¦ä¸­ï¼Œä½œè€…å†™åˆ°ï¼š</p>
<blockquote>
<p>è‡ª 2004 å¹´èµ·ï¼Œäºšé©¬é€Šæ¨å‡ºçš„æ‰€æœ‰é‡è¦äº§å“å’Œè®¡åˆ’ï¼Œå¤§éƒ½å…·æœ‰ä¸€ä¸ªå…±åŒçš„ã€éå¸¸é²œæ˜çš„äºšé©¬é€Šç‰¹è‰²ï¼šä»–ä»¬çš„è¯ç”Ÿéƒ½ç»å†è¿‡æˆ‘ä»¬æ‰€è¯´çš„â€œé€†å‘å·¥ä½œâ€æµç¨‹ã€‚</p>
<p>â€œé€†å‘å·¥ä½œâ€å¯¹å…¬å¸çš„æˆåŠŸèµ·ç€å…³é”®ä½œç”¨ã€‚â€œé€†å‘å·¥ä½œâ€æ˜¯ä¸€ç§å®¡æŸ¥æƒ³æ³•ã€åˆ›é€ æ–°äº§å“çš„ç³»ç»Ÿæ€§æ–¹æ³•ã€‚å…¶å…³é”®åŸåˆ™æ˜¯ï¼š</p>
<ul>
<li>é¦–å…ˆæ€è€ƒå®¢æˆ·ä½“éªŒ</li>
<li>ç„¶åç”±æ­¤åå¤é€†å‘å·¥ä½œ</li>
<li>ç›´åˆ°å›¢é˜Ÿå¯¹è¦å»ºé€ çš„äº§å“æ‹¥æœ‰æ¸…æ™°çš„æƒ³æ³•</li>
</ul>
</blockquote>
<p>å› æ­¤ï¼Œå½“æˆ‘ç¬¬ä¸€æ¬¡è¯»åˆ°å…³äºâ€œé€†å‘å·¥ä½œâ€çš„å†…å®¹åï¼Œè¿™å¼•èµ·äº†æˆ‘å†…å¿ƒæ·±å¤„å¼ºçƒˆçš„å…±é¸£ã€‚åŒæ—¶æˆ‘åˆåº†å¹¸ï¼Œè‡ªå·±å½“æ—¶èƒ½å¤Ÿçªç ´è‡ªæˆ‘ï¼Œå‹‡æ•¢çš„é—¯äº†ä¸‹å»ï¼Œæ¯•ç«Ÿåœ¨äº‹æƒ…æ²¡å¼€å§‹ä¹‹å‰ï¼Œè°èƒ½é¢„çŸ¥è‡ªå·±å°±èƒ½è§£å†³æ‰€æœ‰çš„é—®é¢˜å‘¢ï¼Ÿ</p>
<h2 id="åº¦çŸ¥äº†çš„æˆé•¿-é€†åº·å¨å®šå¾‹">åº¦çŸ¥äº†çš„æˆé•¿â€”â€”é€†åº·å¨å®šå¾‹</h2>
<p>å·¥ä½œä¾ç„¶åœ¨å¹³å‡¡è€Œåˆå¶å°”å……æ»¡æƒŠå–œçš„èŠ‚å¥ä¸­å‰è¡Œï¼Œ2020 å¹´ï¼ŒåŸºäºåœ¨â€œè™šæ‹Ÿæ‘„åƒå¤´â€é¡¹ç›®ä¸­è¡¥è¶³çš„éŸ³è§†é¢‘ä¸“ä¸šæŠ€èƒ½ï¼Œæˆ‘åˆå¯åŠ¨äº†æ–°çš„æ–¹å‘ï¼šè§†é¢‘è´¨é‡è¯„æµ‹ã€‚é‚£ä¸ªæ—¶å€™ï¼Œè§†é¢‘è´¨é‡è¯„æµ‹è¿˜æ²¡æœ‰å¼•èµ·å¤§å®¶è¶³å¤Ÿçš„é‡è§†ï¼Œä½†æ˜¯æˆ‘æœ¦èƒ§ä¸­è®¤ä¸ºè¯„æµ‹ç»ˆå°†ä¼šåœ¨éŸ³è§†é¢‘é¢†åŸŸå æ®ä¸€å¸­ä¹‹åœ°ã€‚é‚£ä¸ªæ—¶å€™ï¼Œ<a href="https://www.livevideostack.cn/">LiveVideoStack</a> å·²ç»åœ¨éŸ³è§†é¢‘é¢†åŸŸéå¸¸ç«ï¼Œæˆ‘æ€ä¹ˆä¹Ÿä¸ä¼šæƒ³åˆ°ï¼Œæœ‰æœä¸€æ—¥ï¼Œæˆ‘ä¹Ÿèƒ½ç«™åœ¨ LiveVideoStack å¤§ä¼šçš„è®²å°ä¸Šï¼Œå‘ä¸šç•Œæœ‹å‹ä»‹ç»æˆ‘ä»¬åœ¨è§†é¢‘è´¨é‡è¯„æµ‹å·¥ä½œä¸Šçš„è®¤çŸ¥å’Œå®è·µã€‚</p>
<p>éšç€æ—¶é—´ç»§ç»­å¾€å‰æ¨ç§»ï¼Œåœ¨ 2021 å¹´çš„æ—¶å€™ï¼Œæˆ‘ä»¬çš„è§†é¢‘è´¨é‡è¯„æµ‹å¹³å°åœ¨å†…éƒ¨ä¹Ÿå–å¾—äº†ä¸é”™çš„åº”ç”¨æ•ˆæœï¼Œå¾ˆå¤šå…¶å®ƒä¸šåŠ¡çº¿çš„åŒå­¦ä¹Ÿæ…•åè€Œæ¥ï¼Œå¸Œæœ›å¯ä»¥ä¸€èµ·åˆä½œã€‚ç„¶è€Œï¼Œéšæˆé•¿è€Œæ¥çš„ä¸åªæœ‰å†…å¿ƒçš„å…´å¥‹ï¼Œåœ¨å¹³å°ä¸æ–­æˆé•¿å£®å¤§çš„è¿‡ç¨‹ä¸­ï¼Œçƒ¦æ¼ä¹Ÿä¼šéšç€è€Œæ¥ï¼š</p>
<ul>
<li>å¦‚æœè®©è¯„æµ‹ç»“æœæ›´ç¬¦åˆçº¿ä¸Šç”¨æˆ·çš„å®é™…æ„ŸçŸ¥ï¼Ÿ</li>
<li>å¦‚ä½•æ‰èƒ½è®©è¯„æµ‹çš„ç»“æœæ›´ç½®ä¿¡ï¼Ÿ</li>
<li>å¦‚ä½•æ‰èƒ½å®ç°è§„æ¨¡åŒ–çš„è¯„æµ‹ç³»ç»Ÿï¼Ÿ</li>
<li>â€¦â€¦</li>
</ul>
<p>æ°å·§ï¼Œåœ¨è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘è¯»åˆ°äº†ä¸€æœ¬è‡³ä»Šçœ‹æ¥éƒ½è®©æˆ‘å—ç›ŠåŒªæµ…çš„ä¹¦ï¼š<a href="https://teamtopologies.com/"><em>Team Topologies: Organizing business and technology teams for fast flow</em></a>ï¼Œè¿™æœ¬ä¹¦çš„ä¸­æ–‡è¯‘æœ¬å°±æ˜¯éå¸¸æœ‰åçš„ <a href="https://item.jd.com/12880565.html">ã€Šé«˜æ•ˆèƒ½å›¢é˜Ÿæ¨¡å¼ï¼šæ”¯æŒè½¯ä»¶å¿«é€Ÿäº¤ä»˜çš„ç»„ç»‡æ¶æ„ã€‹</a>ã€‚è¿™æœ¬ä¹¦ä¸­çš„ä¸¤ä¸ªæ ¸å¿ƒè§‚ç‚¹ç»™äº†æˆ‘æ€è·¯ï¼š</p>
<ul>
<li>å›¢é˜Ÿè€Œéä¸ªäººæ˜¯ç»„ç»‡çš„åŸºæœ¬æ„ä»¶å•å…ƒï¼Œè¦æŠŠå›¢é˜Ÿæ‘†åœ¨ç¬¬ä¸€ä½ï¼Œå¹¶å°†è®¤çŸ¥è´Ÿè·ä½œä¸ºå»ºç«‹å›¢é˜Ÿè¾¹ç•Œçš„æœ‰åŠ›å·¥å…·</li>
<li>é€†åº·å¨å®šå¾‹</li>
</ul>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition note"><p class="admonition-title">åº·å¨å®šå¾‹&é€†åº·å¨å®šå¾‹
</p><ul>
<li>
<p>1968 å¹´ï¼Œæ¢…å°”Â·åº·å¨å‘è¡¨äº†ä¸€ç¯‡è®ºæ–‡ï¼šHow Do Committees Invent?ï¼Œåœ¨è¿™ç¯‡è®ºæ–‡ä¸­ï¼Œåº·å¨ç ”ç©¶äº†ç»„ç»‡ç»“æ„å’Œæœ€ç»ˆç³»ç»Ÿè®¾è®¡ä¹‹é—´çš„å…³ç³»ã€‚è¿™ä¹Ÿå°±æ˜¯åæ¥çš„<code>åº·å¨å®šå¾‹</code>ï¼š<em>è®¾è®¡ç³»ç»Ÿçš„ç»„ç»‡ç”±äºå—åˆ°çº¦æŸï¼Œè¿™äº›è®¾è®¡å¾€å¾€æ˜¯ç»„ç»‡å†…éƒ¨æ²Ÿé€šç»“æ„çš„å‰¯æœ¬</em>ã€‚</p>
</li>
<li>
<p>2015 å¹´ï¼ŒThoughtWorks çš„æŠ€æœ¯æ€»ç›‘ James Lewis çªå‘å¥‡æƒ³åœ°æå‡ºåº”ç”¨<code>é€†åº·å¨å®šå¾‹</code>ï¼š<em>ç»„ç»‡è¦æ ¹æ®ä»–ä»¬æƒ³å¾—åˆ°çš„è½¯ä»¶æ¶æ„æ¥è®¾è®¡å›¢é˜Ÿç»“æ„ï¼Œè€Œä¸æ˜¯æœŸæœ›å›¢é˜Ÿç›²ä»ä¸€ä¸ªè¢«è®¾è®¡å¥½çš„å›¢é˜Ÿç»“æ„ã€‚</em></p>
</li>
</ul>
<blockquote>
<p>å¦‚ä»Šä¸€ç›´ç«å¾—ä¸€å¡Œç³Šæ¶‚çš„â€œå¾®æœåŠ¡æ¶æ„â€å°±æ˜¯ James Lewis åœ¨ä¸€æ¬¡æ¶æ„å³°ä¼šä¸Šæå‡ºæ¥çš„ï¼Œå…·ä½“å¯å‚è§ <a href="https://wangwei1237.github.io/monolith-to-microservices/docs/What_Are_Microservices.html">â€œå¾®æœåŠ¡â€ä¸€è¯çš„å†å²</a>ã€‚</p>
</blockquote>
</div>
<p>å®é™…ä¸Šï¼Œâ€œé€†åº·å¨å®šå¾‹â€æœ¬è´¨ä¸Šæ˜¯ä¸€ç§ç‰¹æ®Šçš„â€œé€†å‘å€’æ¨æ³•â€ï¼Œæ ¹æ®åˆç†çš„è½¯ä»¶æ¶æ„æ¥è°ƒæ•´ç»„ç»‡ç»“æ„ï¼Œè€Œä¸æ˜¯è®©è½¯ä»¶æ¶æ„å—åˆ¶äºç»„ç»‡æ„æˆã€‚åœ¨ç»„ç»‡ä¸æŠ€æœ¯æ¶æ„è¿™ä¸ªç‰¹æ®Šçš„é¢†åŸŸä¸­ï¼Œâ€œé€†å‘å€’æ¨æ³•â€æœ‰äº†ä¸€ä¸ªæ›´ä¸ºé«˜å¤§ä¸Šçš„è¯´æ³•ï¼Œä»…æ­¤è€Œå·²ã€‚</p>
<p>äºæ˜¯æˆ‘å¼€å§‹é‡æ–°è¿›è¡Œæ€è·¯è°ƒæ•´ï¼š</p>
<ul>
<li>ä»¥è§†é¢‘è´¨é‡è¯„æµ‹çš„æœ€ç»ˆç›®æ ‡ï¼ˆç½®ä¿¡ã€æ•ˆç‡ï¼‰é‡æ–°è°ƒæ•´æŠ€æœ¯è·¯å¾„
<ul>
<li>ç«¯åˆ°ç«¯çš„è§†é¢‘è´¨é‡è¯„æµ‹èƒ½åŠ›ï¼Œæ‰“é€šPCã€Androidã€iOSä¸‰ç«¯èƒ½åŠ›</li>
<li>å„ç§ç®—æ³•çš„æ·±å…¥åˆ†æå’Œæ·±åº¦ä¼˜åŒ–ï¼Œå¹¶é›†æˆåˆ°ç°æœ‰çš„å¹³å°èƒ½åŠ›</li>
</ul>
</li>
<li>ä»¥æä¾›ä¸€ç«™å¼è¯„æµ‹æœåŠ¡çš„æœ€ç»ˆç›®æ ‡æ¥é‡æ–°è°ƒæ•´å›¢é˜Ÿçš„ç»“æ„
<ul>
<li>æ˜ç¡®å›¢é˜Ÿçš„è®¤çŸ¥è´Ÿè·ï¼Œä¸å†ä¸€å‘³å¼ºè°ƒè‡ªç ”ï¼Œè½¬è€Œå¯»æ±‚å…¶ä»–å›¢é˜Ÿçš„ä¼˜ç§€äººå‘˜ï¼ŒååŒå…±åˆ›ä»·å€¼</li>
<li>é‡æ°´æ­æ¡¥ï¼Œé€¢å±±å¼€è·¯ï¼Œè‡ªå»ºä¼—æµ‹å›¢é˜Ÿ</li>
</ul>
</li>
<li>â€¦â€¦</li>
</ul>
<blockquote>
<p>æ›´å¤šçš„ç»†èŠ‚ä¹Ÿå¯ä»¥å‚è€ƒå¦ä¸€ç¯‡æ–‡ç«  <a href="/2022/09/05/How-to-break-through-the-resource-limitation-and-create-the-more-value/">å¦‚ä½•çªç ´èµ„æºé™åˆ¶ï¼Œåˆ›é€ æ›´å¤§çš„ä»·å€¼ï¼Ÿ</a> ä»¥åŠ <a href="https://mp.weixin.qq.com/s/J2QGTiMOgMnZbAyI81I87Q">ã€Šç™¾åº¦è§†é¢‘è´¨é‡è¯„æµ‹çš„å®è·µä¹‹è·¯ã€‹</a>ã€‚</p>
</blockquote>
<p>åŸºäºè¿™æ ·çš„æ€è·¯ï¼Œæˆ‘ä»¬æ…¢æ…¢å»ºè®¾å¹¶ä¸æ–­ä¼˜åŒ–è§†é¢‘è´¨é‡è¯„æµ‹ç³»ç»Ÿï¼š<a href="/2023/02/13/duzhiliao/">åº¦çŸ¥äº†</a>ã€‚æ—¶è‡³ä»Šæ—¥ï¼Œåº¦çŸ¥äº†ä¾ç„¶åœ¨å„ä¸ªè§†é¢‘ä¸šåŠ¡ä¸­å‘æŒ¥ç€éå¸¸é‡è¦çš„ä½œç”¨ï¼Œæˆ‘ä»¬ä¹Ÿä¾ç„¶åœ¨è·¯ä¸Šâ€”â€”ä»Šå¤©ä¾ç„¶æ˜¯ç¬¬ä¸€å¤©ã€‚</p>
<h2 id="åŸºäºç›®æ ‡çš„å…¨å±€æœ€ä¼˜è§£">åŸºäºç›®æ ‡çš„å…¨å±€æœ€ä¼˜è§£</h2>
<p>åœ¨ Sam Newman çš„ <a href="https://samnewman.io/books/monolith-to-microservices/">Monolith To Microservices</a> ä¸€ä¹¦çš„ç¬¬ <a href="/monolith-to-microservices/docs/Global_Versus_Local_Optimization.html">5.9èŠ‚å±€éƒ¨ä¼˜åŒ–VS.å…¨å±€ä¼˜åŒ–</a> ä¸­å†™é“ï¼š</p>
<blockquote>
<p>å‡è®¾å›¢é˜Ÿå¯¹è‡ªå·±çš„æœ¬åœ°å†³ç­–è´Ÿæœ‰æ›´å¤šçš„è´£ä»»ï¼Œå›¢é˜Ÿæˆ–è®¸ä¼šæ‹¥æœ‰ä»–ä»¬æ‰€ç®¡ç†çš„å¾®æœåŠ¡çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦è€ƒè™‘åœ¨æœ¬åœ°å†³ç­–ä¸æ›´å¤šçš„å…¨å±€æŒ‡æ ‡ä¹‹é—´åšå‡ºå¹³è¡¡ã€‚</p>
<p>å¾ˆéš¾æœŸæœ›åœ¨å¾®æœåŠ¡è¿ç§»çš„æ—©æœŸæ—…ç¨‹ä¸­å°±å‘ç°è¿™ç§é—®é¢˜ï¼Œéšç€æ—¶é—´çš„æ¨ç§»ï¼Œæ¯ä¸ªå›¢é˜Ÿå°†è¶Šæ¥è¶Šä¸“æ³¨äºè‡ªå·±çš„æœ¬åœ°é—®é¢˜ï¼Œå¹¶å°†åŸºäºæœ¬åœ°é—®é¢˜æ¥ä¼˜åŒ–ä»–ä»¬è§£å†³é—®é¢˜çš„æ–¹å¼ã€‚</p>
</blockquote>
<p>2022 å¹´æ˜¥å¤©çš„æ—¶å€™ï¼Œæˆ‘ä»¬é‡åˆ°äº†è¯„æµ‹æ•ˆç‡çš„é—®é¢˜ã€‚è¿™ä¸ªæ—¶å€™ï¼Œå‚ä¸åˆ°â€œåº¦çŸ¥äº†â€é¡¹ç›®ä¸­çš„è§’è‰²ä¹Ÿè¶Šæ¥è¶Šå¤šï¼Œå¤§å®¶ä¹Ÿéƒ½å¯è¶³äº†åŠ²å„¿ï¼Œåœ¨å„è‡ªçš„å·¥ä½œèŒƒç•´å†…åšå„ç§ä¼˜åŒ–æ¥æå‡è¯„æµ‹æ•ˆç‡ã€‚è™½ç„¶ä¼šæœ‰æ”¹å–„ï¼Œä½†æ€»ä¹Ÿæ— æ³•æ»¡è¶³ä¸šåŠ¡æ–¹è¶Šæ¥è¶Šå¤šçš„è¯„æµ‹éœ€æ±‚ã€‚</p>
<p>è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬åŸºäºè¯„æµ‹ç›®æ ‡çš„å…¨å±€è§†è§’å¯¹è¯„æµ‹å…¨æµç¨‹å„ç¯èŠ‚è¿›è¡Œäº†è¯¦ç»†çš„æ¢³ç†ï¼Œå¯¹ä¸åŒçš„ç¯èŠ‚è¿›è¡Œäº†å½’å¹¶ã€åˆ å‡ï¼Œå¯¹ä¸åŒç¯èŠ‚çš„æ—¶åºè¿›è¡Œäº†å…¨å±€æœ€ä¼˜è°ƒæ•´ï¼Œæœ€ååœ¨æ¯ä¸ªç¯èŠ‚å†…éƒ¨æ“ä½œè¿›è¡Œå„ç§ä¼˜åŒ–æ‰‹æ®µã€‚åœ¨å…¨å±€å±‚é¢ï¼Œæˆ‘ä»¬å¢åŠ äº†ä»»åŠ¡è‡ªåŠ¨æ‹†åˆ†ï¼Œä»»åŠ¡è‡ªåŠ¨è°ƒåº¦æ‰§è¡Œï¼Œç»“æœè‡ªåŠ¨èšåˆç­‰èƒ½åŠ›ï¼›åœ¨ç®—å­å†…éƒ¨ï¼Œæˆ‘ä»¬è¿˜é€šè¿‡ä¼˜åŒ–ç®—å­æ¥æå‡ç®—å­çš„è®¡ç®—æ•ˆç‡â€¦â€¦</p>
<p>åœ¨ 2022 å¹´çš„å¤å§‹æ˜¥ä½™ä¹‹é™…ï¼Œâ€œåº¦çŸ¥äº†â€ä»æ•´ä½“æœåŠ¡æµç¨‹ä¸Šå˜çš„é¢è²Œå…¨æ–°äº†ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæ•´ä½“çš„è¯„æµ‹æ•ˆç‡ä¹Ÿæœ‰äº†éå¸¸å¤§çš„çªç ´ï¼Œæˆ‘ä»¬ä¹Ÿè§£å†³äº†ä¹‹å‰å­˜åœ¨çš„è¯„æµ‹æ•ˆç‡çš„é—®é¢˜ã€‚</p>
<p><img src="/2023/07/09/My-practice-of-working-backwards/4.png" alt></p>
<h4 id="ç»“æ„ä¼˜åŒ–æ˜¯æ ¸å¿ƒ">ç»“æ„ä¼˜åŒ–æ˜¯æ ¸å¿ƒ</h4>
<p>å¦‚æœä½ é—®æˆ‘ï¼Œåœ¨æ•ˆç‡æå‡çš„è¿‡ç¨‹ä¸­ï¼Œåšçš„æœ€æˆåŠŸçš„å†³ç­–æ˜¯ä»€ä¹ˆï¼Ÿæˆ‘æƒ³ï¼Œè¿™ä¸ªç­”æ¡ˆä¼šæ˜¯ï¼šåŸºäºç›®æ ‡è€Œè¿›è¡Œçš„ç³»ç»Ÿç»“æ„çš„è°ƒæ•´ã€‚</p>
<p>æˆ‘ä»¬ç°åœ¨éƒ½åœ¨è®²â€œç«¯åˆ°ç«¯â€çš„ä¼˜åŒ–ï¼Œâ€œç«¯åˆ°ç«¯â€çš„å«ä¹‰éå¸¸å¹¿æ³›ï¼š</p>
<ul>
<li>ç³»ç»Ÿçš„å±‚çº§æ¶æ„</li>
<li>ç³»ç»Ÿçš„æµç¨‹æ¶æ„</li>
<li>ç”¨æˆ·çš„å…¨æµç¨‹å£°æ˜å‘¨æœŸ</li>
<li>â€¦â€¦</li>
</ul>
<p>æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬ç¡®å®æ˜¯åœ¨åšâ€œç«¯åˆ°ç«¯â€ä¼˜åŒ–ï¼Œä½†æ˜¯å´æ˜¯åœ¨æ—¢æœ‰çš„æ¶æ„ã€æµç¨‹ä¸‹æ¥è¿›è¡Œçš„â€œç«¯åˆ°ç«¯â€ä¼˜åŒ–ï¼Œè€Œè¿™ç§å±‚é¢çš„â€œç«¯åˆ°ç«¯â€ä¼˜åŒ–ï¼Œæœ‰æ—¶å€™æ”¶æ•ˆç”šå¾®ï¼Œå°±åƒæˆ‘ä»¬åœ¨ 2022 å¹´æ˜¥å¹´é‡åˆ°çš„å›°å¢ƒé‚£æ ·ã€‚</p>
<p>â€œé€†åº·å¨æ³•åˆ™â€çš„æœ¬è´¨æ„å‘³ç€ï¼Œå¦‚æœè¦å®ç°è´¨çš„é£è·ƒï¼Œç«¯åˆ°ç«¯ä¼˜åŒ–é¦–è¦çš„ã€ä¹Ÿæœ€æ ¸å¿ƒçš„é¦–å…ˆæ˜¯ç³»ç»Ÿç»“æ„çš„è°ƒæ•´ã€‚é¦–å…ˆè¦ä»åŸºäºç›®æ ‡ï¼Œä»å…¨å±€è§†è§’å¯¹ç»“æ„è¿›è¡Œè°ƒæ•´ï¼Œç„¶ååœ¨æ·±å…¥åˆ°æ¯ä¸ªå…·ä½“ç¯èŠ‚ä¸­è¿›è¡Œå±€éƒ¨è°ƒæ•´ï¼Œæœ€ç»ˆæ‰ä¼šå®ç°â€œç«¯åˆ°ç«¯â€çš„æœ€ä¼˜è§£ã€‚</p>
<p>åœ¨ <a href="https://book.douban.com/subject/11528220/">ç³»ç»Ÿä¹‹ç¾</a> è¿™æœ¬ä¹¦ä¸­ï¼Œå¯¹ç³»ç»Ÿä½œå‡ºå¦‚ä¸‹çš„å®šä¹‰ï¼š</p>
<blockquote>
<p>ç³»ç»Ÿå¹¶ä¸ä»…ä»…æ˜¯ä¸€äº›äº‹ç‰©çš„ç®€å•é›†åˆï¼Œè€Œæ˜¯ä¸€ä¸ªç”±ä¸€ç»„ç›¸äº’è¿æ¥çš„è¦ç´ æ„æˆçš„ã€èƒ½å¤Ÿå®ç°æŸä¸ª<strong>ç›®æ ‡</strong>çš„æ•´ä½“ã€‚</p>
</blockquote>
<p>å¯¹äºå®ç°ç‰¹å®š<strong>ç›®æ ‡</strong>çš„ç³»ç»Ÿè€Œè¨€ï¼Œè¦ç´ å¾ˆé‡è¦ï¼Œä½†æ˜¯è¿æ¥æ›´ä¸ºé‡è¦ã€‚ç»“æ„å†³å®šæ€§è´¨ï¼Œæ€§è´¨å†³å®šç”¨é€”ï¼Œå°±æ˜¯è¿™ä¸ªæ ·å­ã€‚åŒæ ·éƒ½æ˜¯ç”± <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span></span> åŸå­æ„æˆï¼ŒçŸ³å¢¨å’Œé’»çŸ³çš„ç»“æ„ä¸åŒå†³å®šäº†å…¶æ€§è´¨å­˜åœ¨éå¸¸å¤§çš„å·®å¼‚ã€‚</p>
<p><img src="/2023/07/09/My-practice-of-working-backwards/7.png" alt></p>
<blockquote>
<p>å›¾ç‰‡ä¸­çš„ç»“æ„æ¨¡å‹ç”± <a href="https://molview.org/">molview</a> å·¥å…·ç”Ÿæˆã€‚</p>
</blockquote>
<p>å½“åŸºäºæ•ˆç‡ç›®æ ‡å¯¹â€œåº¦çŸ¥äº†â€ç³»ç»Ÿè¿›è¡Œäº†ç»“æ„è°ƒæ•´å’Œä¼˜åŒ–ä¹‹åï¼Œæˆ‘ä»¬æƒŠå¥‡çš„å‘ç°ï¼Œè¯„æµ‹æ•ˆç‡é—®é¢˜ä¸ä½†å°±è¿™æ ·è¿åˆƒè€Œè§£äº†ï¼Œè€Œä¸”æ•´ä¸ªç³»ç»Ÿçœ‹èµ·æ¥è¿˜æ›´åŠ ç´§å‡‘ã€‚å¿½ç„¶é—´ï¼Œæƒ³èµ·äº†å¤šå¹´ä»¥å‰å’ŒåŒäº‹é—²èŠï¼Œè°ˆåˆ°ä¸ºä»€ä¹ˆç³»ç»Ÿæ€»æ˜¯å‡ºé—®é¢˜æ—¶çš„åœºæ™¯ï¼š</p>
<blockquote>
<p>æˆ‘ä»¬çš„ç³»ç»Ÿï¼Œå…¶åŸå‹æ˜¯ä¸€ä¸ªâ€œä¸‰è§’å½¢â€ï¼Œä½†æ˜¯éšç€æ—¶é—´çš„æ¨ç§»ï¼Œç”¨æˆ·éœ€æ±‚å˜æˆäº†â€œæ°´æ¡¶â€ã€‚æ‰€ä»¥ï¼Œè¿™ä¸ªâ€œæ°´æ¡¶â€å…¶å®æ˜¯ç”¨â€œä¸‰è§’å½¢â€ä¸æ–­åœ°é€¼è¿‘çš„ç»“æœï¼Œè€Œå…¶æœ¬è´¨ä¸Šå¹¶ä¸æ˜¯â€œæ°´æ¡¶â€ã€‚æ— è®ºæˆ‘ä»¬åœ¨æ„æˆæ°´æ¡¶çš„æ¯å—â€œä¸‰è§’å½¢â€ä¸Šåšä»»ä½•çš„ä¼˜åŒ–ï¼Œæœ€ç»ˆè¿˜æ˜¯ä¼šå‡ºç°é—®é¢˜ã€‚</p>
</blockquote>
<h2 id="åŸºäºç›®æ ‡çš„æ‹†è§£ä¸æ•´åˆ">åŸºäºç›®æ ‡çš„æ‹†è§£ä¸æ•´åˆ</h2>
<p>ä¸çŸ¥ä¸è§‰ï¼Œæ—¶é’ˆæŒ‡å‘äº† 2022 å¹´çš„ç§‹å¤©ï¼ŒåŒ—äº¬çš„ç§‹å¤©æ˜¯ä¸€å¹´ä¹‹ä¸­æœ€ç¾ä¸½çš„å­£èŠ‚ã€‚è€Œæ­¤æ—¶ï¼Œåº¦çŸ¥äº†ä¹Ÿå·²ç»æˆä¸ºè§„æ¨¡æ¯”è¾ƒå¤§çš„è§†é¢‘è´¨é‡è¯„æµ‹æœåŠ¡ã€‚</p>
<p>å¿½ç„¶æœ‰ä¸€å¤©ï¼Œæˆ‘å¼€å§‹ä»¥åéªŒè§†è§’å›é¡¾è¿™æ•´ä¸ªè¿‡ç¨‹ã€‚æˆ‘å‘ç°ï¼Œæ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œå§‹ç»ˆåŸºäºç›®æ ‡çš„è‡ªé¡¶å‘ä¸‹çš„æ‹†è§£ä¸è‡ªåº•å‘ä¸Šå°†å„ç§ä¼˜åŒ–æ‰‹æ®µå†æ¬¡æ•´åˆæˆä¸ºç›®æ ‡çš„æ­£ååŒå¾ªç¯çš„æ€è·¯ï¼Œåœ¨æ•´ä¸ªåº¦çŸ¥äº†çš„æˆé•¿å†ç¨‹ä¸Šï¼Œå‘æŒ¥ç€ä¸¾è¶³è½»é‡çš„ä½œç”¨ã€‚</p>
<p><img src="/2023/07/09/My-practice-of-working-backwards/5.png" alt></p>
<p>è´ä½æ–¯åœ¨ <a href="https://mp.weixin.qq.com/s/Q-dS6YNUcdRFqYFu4zWoDQ">2007 å¹´è‡´è‚¡ä¸œä¿¡</a> ä¸­ä»‹ç» Kindle æ—¶å†™é“ï¼š</p>
<blockquote>
<p>ä»»ä½•äº‹æƒ…ï¼Œåªè¦é™ä½éš¾åº¦å’Œå‡å°‘é˜»åŠ›ï¼Œä¾¿ä¼šéåœ°å¼€èŠ±ã€‚</p>
</blockquote>
<p>åŸºäºç›®æ ‡çš„è‡ªé¡¶å‘ä¸‹çš„æ‹†è§£ï¼Œå¯ä»¥ä½¿å¾—ç›®æ ‡éš¾åº¦æœ€å°åŒ–ï¼Œåªæœ‰è¿™æ ·ä¼˜åŒ–æ‰ä¼šæˆä¸ºå¯èƒ½ï¼Œè·¯å¾„æ‰ä¼šå¾—ä»¥å®ç°ï¼Œå¦åˆ™å°±å®¹æ˜“é€ æˆæœ›è€Œå´æ­¥çš„çª˜å¢ƒï¼Œå°¤å…¶æ˜¯å½“å›¢é˜Ÿæˆå‘˜æ­£åœ¨çªç ´è‡ªå·±çš„è®¤çŸ¥è´Ÿè·çš„å‰æä¸‹ã€‚</p>
<p>æ‹†è§£æ˜¯èƒ½åŠ›ï¼Œæ•´åˆæ˜¯æ§åˆ¶åŠ›ï¼Œå½“æ‰€æœ‰äº‹æƒ…æ‹†è§£å®Œæ¯•åï¼Œæˆ‘ä»¬éœ€è¦ç¡®ä¿æ‰€æœ‰çš„ä¼˜åŒ–æœ€ç»ˆèƒ½å¤Ÿæ•´åˆåˆ°ä¸€ä¸ªå…·ä½“çš„äº§å“ä¸Šï¼Œè¿™æœ‰è¿™æ ·ï¼Œä½¿ç”¨è¿™ä¸ªäº§å“çš„é—¨æ§›æ‰ä¼šé™ä½ã€‚å½“æ•´ä¸ªè¿‡ç¨‹çš„æ­£ã€ååŒå¾ªç¯æ‰“é€šä¹‹åï¼Œè¿™ä¸ªäº‹æƒ…è‡ªç„¶è€Œç„¶ä¹Ÿå°±æˆåŠŸäº†ã€‚</p>
<p>åœ¨æ•´ä¸ªæ‹†ã€åˆçš„è¿‡ç¨‹ä¸­ï¼Œç›®æ ‡æ˜¯å…¶èƒŒåçš„æœ€æ ¸å¿ƒçš„å…³èŠ‚ç‚¹ã€‚æ—©åœ¨ 2020 å¹´çš„æ—¶å€™ï¼Œè¿˜æ²¡æœ‰æ˜ç¡® â€œè§†é¢‘è´¨é‡è¯„æµ‹äº§å“åŒ–â€ çš„ç›®æ ‡ï¼Œè™½ç„¶é‚£ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬ä¹Ÿåœ¨ä¼˜åŒ–å„ç§ç®—æ³•ï¼Œä½†æ˜¯æœ€ç»ˆä¹Ÿå°±æ˜¯ä»…ä»…ä¼˜åŒ–äº†è€Œå·²ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å§‹ç»ˆåœ¨ä¼˜åŒ–å„ç§é—®é¢˜çš„å±‚é¢è½¬åœˆï¼Œæœ€ç»ˆåˆå¾ˆéš¾å°†æ‰€åšçš„æ‰€æœ‰ä¼˜åŒ–è¿›è¡Œæ•´åˆå¹¶é˜è¿°å…¶ä»·å€¼ã€‚ç°åœ¨æƒ³æƒ³ï¼Œé‚£ä¸ªæ—¶å€™è¿˜æ˜¯å¾ˆç„¦è™‘çš„ï¼šæŠ€æœ¯ä¸Šç¡®å®æœ‰è¿›æ­¥ï¼Œä½†æ˜¯è¯´ä¸æ¸…æ¥šæŠ€æœ¯çš„ä»·å€¼ã€‚ç›´åˆ°æˆ‘ä»¬æ˜ç¡®äº†ç›®æ ‡ä¹‹åï¼Œäº‹æƒ…æ‰å˜å¾—å¥½äº†èµ·æ¥ï¼Œæ‰€æœ‰çš„ä¼˜åŒ–éƒ½å¯ä»¥ä½“ç°åˆ°â€œåº¦çŸ¥äº†â€çš„äº§å“ä¸Šäº†ã€‚</p>
<p><img src="/2023/07/09/My-practice-of-working-backwards/6.png" alt></p>
<p>ä»é—®é¢˜åˆ‡å…¥æœ‰åˆ©äºè§£å†³çœ¼ä¸‹çš„äº‹æƒ…ï¼Œè€ŒåŸºäºç›®æ ‡çš„æ€ç»´ï¼Œå¯ä»¥é¿å…è¢«çœ¼ä¸‹çš„é”™ç»¼çº·æ‰°è€Œè¿·æƒ‘ã€‚ä¸è¯†åºå±±çœŸé¢ç›®ï¼Œåªç¼˜èº«åœ¨æ­¤å±±ä¸­ï¼Œè¿™æ˜¯å¦‚æ­¤ã€‚æœ‰å¾ˆå¤šçš„æ—¶å€™ï¼Œä»æ›´é«˜ä¸€å±‚çš„ç›®æ ‡å‡ºå‘ï¼Œå½“å‰çš„é—®é¢˜å¯èƒ½å·²ç»ä¸æ˜¯é—®é¢˜äº†ã€‚</p>
<blockquote>
<p>æˆ‘ä»¬å·²ç»èµ°å¾—å¤ªè¿œï¼Œä»¥è‡³äºå¿˜è®°äº†ä¸ºä»€ä¹ˆè€Œå‡ºå‘ã€‚â€”â€”ã€Šå…ˆçŸ¥ã€‹ï¼Œçºªä¼¯ä¼¦</p>
</blockquote>
<h2 id="è¯•ç‚¹é™·é˜±">è¯•ç‚¹é™·é˜±</h2>
<p>æˆ‘ä»¬è¿‡äºè‡ªä¿¡ï¼Œæ€»è®¤ä¸ºæˆ‘ä»¬çš„ä¼˜åŒ–è‚¯å®šæ˜¯æœ€å®Œç¾çš„æ–¹æ¡ˆï¼›åŒæ—¶æˆ‘ä»¬åˆè¿‡ä»½çš„å¿§è™‘ï¼Œæ€»æ‹…å¿ƒå¦‚æœé‡‡ç”¨æ–°çš„æ–¹æ¡ˆä¼šå¯¹ç°æœ‰ä¸šåŠ¡å¸¦æ¥éé¢„æœŸçš„å½±å“ã€‚</p>
<p>æˆ‘ä»¬å³è¿½æ±‚åˆ›æ–°ï¼Œåˆå®³æ€•æ‰¿æ‹…åˆ›æ–°å¯èƒ½å¸¦æ¥çš„æŸå¤±å±€é¢ï¼ˆåˆ›æ–°æ€»è¦ä»˜å‡ºä»£ä»·ï¼‰ï¼Œåœ¨è‡ªä¿¡ä¸å®³æ€•çš„çŸ›ç›¾å¿ƒç†ä¸‹ï¼Œæˆ‘ä»¬é€‰æ‹©äº†ä¸€ç§æ¯”è¾ƒæŠ˜ä¸­çš„æ–¹æ¡ˆï¼šè¯•ç‚¹ã€‚æˆ‘ä»¬ä¼šå…ˆåœ¨ä¸€ä¸ªå°çš„ã€å¯æ§çš„èŒƒå›´å†…å¯¹ä¼˜åŒ–è¿›è¡Œè¯•ç‚¹ï¼Œå¦‚æœè¯•ç‚¹ç»“æœä¸å¥½ï¼Œé‚£ä¹ˆè¿™é¡¹ä¼˜åŒ–å°±å¯ä»¥æå‰ç»“æŸäº†ï¼›è€Œå¦‚æœè¯•ç‚¹ç»“æœå¾ˆå¥½ï¼Œé‚£æ¥ä¸‹æ¥æ€ä¹ˆåŠå‘¢â€”â€”â€œTo do or not to do,thatâ€™s a questionâ€ã€‚</p>
<p>é¢å¯¹ä¸€ä¸ªåºæ‚çš„è½¯ä»¶ç³»ç»Ÿï¼Œå¦‚æœæƒ³ä½¿ç”¨æ›´é«˜çº§çš„è¯­è¨€æ¥é‡æ„è¿™ä¸ªç³»ç»Ÿï¼Œå¹¶éªŒè¯é‡æ„çš„æ•ˆæœï¼Œæˆ‘ä»¬ä¼šé‡‡å–æ€æ ·çš„è·¯å¾„ï¼Ÿæˆ‘ä»¬å¯èƒ½ä¼šå…ˆå¯¹å¤–å›´ä¸é‡è¦çš„æ¨¡å—è¿›è¡Œé‡æ„è¯•ç‚¹ï¼Œä»¥å¢å¼ºæˆ‘ä»¬çš„ä¿¡å¿ƒã€‚æœ€ç»ˆï¼Œæˆ‘ä»¬ä¼šå‘ç°ï¼Œå¤šå¹´ä»¥åï¼Œè¿™ä¸ªç³»ç»Ÿæœ€æ ¸å¿ƒçš„ 20% çš„éƒ¨åˆ†åˆ†ï¼Œä¾ç„¶è¿˜åœ¨ä½¿ç”¨ç€æ›´å¤è€çš„è¯­è¨€ã€‚</p>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition note"><p class="admonition-title">è¯•ç‚¹é™·é˜±
</p><p>è¯•ç‚¹ä¸€ç›´åœ¨è·¯ä¸Šï¼Œä½†æœªå…¨é¢å–è€Œä»£ä¹‹æˆ–è€…å¼•å‘è´¨çš„å˜é©ï¼Œè¿™ç§ç°è±¡æˆ‘ç§°ä¹‹ä¸ºâ€”â€”è¯•ç‚¹é™·é˜±ã€‚</p>
</div>
<p>å…³äºè¯•ç‚¹é™·é˜±ï¼Œæ•´ä½“è€Œè¨€ï¼Œæˆ‘é‡åˆ°äº†å¦‚ä¸‹å‡ ç§æƒ…å†µï¼š</p>
<ul>
<li>ä»ä¸é‡è¦çš„æ¨¡å—å¯åŠ¨æ–°æŠ€æœ¯çš„è¯•ç‚¹ï¼Œå¯¼è‡´å¯¹äºç³»ç»Ÿæ€»ä½“è€Œè¨€ï¼Œæ–°æŠ€æœ¯æ²¡æœ‰ä½“ç°å…¶ä¼˜åŠ¿ã€‚</li>
<li>ä»ä¸é‡è¦çš„é¡¹ç›®å¯åŠ¨æ–°æŠ€æœ¯çš„è¯•ç‚¹ï¼Œå¯¼è‡´å¯¹äºå›¢é˜Ÿè€Œè¨€ï¼Œæ–°æŠ€æœ¯æ²¡æœ‰å‘æŒ¥å…¶ä¼˜åŠ¿ã€‚</li>
<li>åœ¨ç³»ç»Ÿå…¨æµç¨‹çš„éƒ¨åˆ†æµç¨‹å¯åŠ¨æ–°æŠ€æœ¯è¯•ç‚¹ï¼Œå¯¼è‡´å¯¹äºå…¨æµç¨‹è€Œè¨€ï¼Œæ–°çš„æŠ€æœ¯æ²¡æœ‰ä½“ç°å…¶ä¼˜åŠ¿ã€‚</li>
</ul>
<p>å¯¹äºæ•°å­—åŒ–è½¬å‹ï¼Œéº¦è‚¯é”¡çš„ç ”ç©¶å‘ç°ï¼Œå¤§é‡åˆ¶é€ ä¼ä¸šåœ¨æ•°å­—åŒ–è½¬å‹åˆæœŸçš„è¯•ç‚¹éå¸¸æˆåŠŸï¼Œä½†åœ¨å…¨é¢æ¨å¹¿å¹¶å–å¾—è´¢åŠ¡ã€è¿è¥å’Œå¯æŒç»­ç»©æ•ˆæ–¹é¢æŒç»­æ”¹å–„çš„è¿‡ç¨‹ä¸­å´å›°éš¾é‡é‡ï¼Œ74% çš„ä¼ä¸šåœ¨å¯åŠ¨æ•°å­—åŒ–é¡¹ç›®ä¸ä¹…åå°±æ³¥è¶³æ·±é™·ã€‚</p>
<p>è¿˜å¥½åœ¨â€œåº¦çŸ¥äº†â€çš„å‘å±•è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬æ²¡æœ‰è¸©åˆ°â€œè¯•ç‚¹é™·é˜±â€ã€‚è¿™å¹¶ä¸æ˜¯æˆ‘ä»¬ä¸æƒ³è¸©â€œè¯•ç‚¹é™·é˜±â€ï¼Œè€Œæ˜¯ä¼˜åŒ–çš„ç´§è¿«æ€§ä»¥åŠèµ„æºçš„é™åˆ¶å¹¶æ²¡æœ‰ç»™æˆ‘ä»¬ç•™ä¸‹â€œè¯•ç‚¹â€çš„æœºä¼šï¼Œæˆ‘ä»¬å¿…é¡»å…¨åŠ›ä»¥èµ´ï¼Œæ‰€æœ‰çš„ä¼˜åŒ–å¿…é¡»åœ¨ä¸‹æ¬¡çš„å…¨æµç¨‹è¯„æµ‹ä¸­å¾—ä»¥åº”ç”¨ï¼Œä»¥ä¿è¯æœ€ç»ˆç»“æœçš„é«˜æ•ˆå’Œç½®ä¿¡ã€‚</p>
<p>ç…å‡†ç›®æ ‡ï¼Œä¸ç•™åè·¯ï¼Œå…¨åŠ›ä»¥èµ´ï¼Œall-inï¼Œå¾€å¾€ä¼šæœ‰æ„æƒ³ä¸åˆ°çš„æ”¶è·ã€‚ä¸€æ—¦æˆ‘ä»¬æœ‰ Plan Bï¼Œåœ¨å‰è¡Œçš„è·¯ä¸Šï¼Œä¸€æ—¦æˆ‘ä»¬é‡åˆ°é£å¹è‰åŠ¨ï¼Œæˆ‘ä»¬å°±ä¼šä¸è‡ªç„¶çš„æƒ³åˆ° Plan Bè¿›è€Œé™·å…¥â€œè¯•ç‚¹é™·é˜±â€ï¼Œæˆ‘ä»¬å°±ä¼šåœ¨çº·ç¹é”™ç»¼çš„ç¯å¢ƒä¸­é”™å¤±æœºä¼šã€‚</p>
<h2 id="å…ˆéªŒä¸åéªŒ">å…ˆéªŒä¸åéªŒ</h2>
<p>æ—¶é—´åœ¨æ‚„ç„¶é—´æµé€ï¼Œå¹´ååœ¨åŒ†åŒ†ä¸­è€Œè¿‡ï¼Œä¸ç»æ„é—´ï¼Œæ—¶é’ˆå·²ç»æ‚„æ‚„æŒ‡å‘äº† 2023 å¹´ï¼Œæœºç¼˜å·§åˆï¼Œæˆ‘çš„å·¥ä½œèŒƒå›´ä¹Ÿåœ¨ä¸æ–­æ‰©å¤§ï¼Œä¹Ÿæ…¢æ…¢å­¦ä¼šäº†ä»¥åéªŒçš„è§†è§’æ¥å®¡è§†è‡ªå·±å·¥ä½œçš„æŠ€å·§ã€‚</p>
<p>æœ€è¿‘ï¼Œåœ¨åˆ·æŠ–éŸ³æ—¶ï¼ŒæƒŠå–œåœ°æ”¶åˆ°ä¸€æ¡å…³äºä»‹ç»â€œè¿ç®—æ”¾å¤§å™¨â€çš„è§†é¢‘æ¨é€ï¼šâ€‹å°†â€œè¿ç®—æ”¾å¤§å™¨â€çš„è¾“å‡ºå’Œè´Ÿè¾“å…¥ç›¸è¿æ¥æ—¶ï¼Œä¼šäº§ç”Ÿéå¸¸ç¾å¦™çš„ç‰¹æ€§æ›²çº¿ï¼Œè€Œè¿™ä¸ªæ›²çº¿ä¹Ÿå¥ å®šäº†â€œè¿ç®—æ”¾å¤§å™¨â€åœ¨ç”µå­ä¸–ç•Œä¸­çš„åœ°ä½ã€‚</p>
<div class="bili_video"><div style="position: relative; width: 100%; height: 0; padding-bottom: 75%;"><iframe src="https://player.bilibili.com/player.html?aid=314781365&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position: absolute; width: 100%; height: 100%; left: 0; top: 0;"> </iframe></div></div>
<p>å¿½ç„¶åœ¨æƒ³ï¼šå¦‚æœå°†åéªŒçš„è®¤çŸ¥è¾“å…¥åˆ°å…ˆéªŒä½œä¸ºä¸€ç§è´Ÿåé¦ˆé—­ç¯ï¼Œé‚£ä¹ˆæ‰“é€šæ­£å‘ã€åå‘åŒå¾ªç¯ä¹‹åï¼Œå·¥ä½œçš„äº‹é¡¹å²‚ä¸æ˜¯å¯ä»¥åƒâ€œè¿ç®—æ”¾å¤§å™¨â€é‚£æ ·æ›´æœ‰ä»·å€¼ï¼Ÿ</p>
<p>äºæ˜¯ï¼Œåœ¨æœ€è¿‘çš„å›¢é˜Ÿæ ¸å¿ƒå·¥ä½œä¸Šï¼Œæˆ‘å’Œç›¸å…³åŒå­¦å¯¹è¿™ç§å…ˆéªŒã€åéªŒåŒå‘é—­ç¯çš„æ–¹å¼è¿›è¡Œäº†å®è·µï¼Œæœ€ç»ˆä¹Ÿå‘ç°ç¡®å®è¿™æ˜¯ä¸€ç§éå¸¸æœ‰æ•ˆçš„æ–¹å¼ã€‚</p>
<p>åæ¥æƒ³æƒ³ï¼Œè¿™ç§å…ˆéªŒã€åéªŒå’Œâ€œé€†å‘å€’æ¨â€ä¹Ÿæœ‰ä¸€å®šçš„ç›¸ä¼¼ä¹‹å¤„ï¼Œâ€œé€†å‘å€’æ¨â€è®©æˆ‘ä»¬å¼€å¯è¡Œç¨‹ï¼Œè€ŒåéªŒä¼šè®©æˆ‘ä»¬åœ¨è¡Œç¨‹ä¸­ä¸æ–­è°ƒæ•´æ­¥ä¼å’Œæ–¹å‘ï¼Œä»¥ä½¿å¾—æˆ‘ä»¬å¯ä»¥æ›´å¥½çš„è¾¾åˆ°ç»ˆç‚¹ã€‚</p>
<p>å…ˆéªŒæ˜¯èƒ½åŠ›ï¼ŒåéªŒæ˜¯æ‰§è¡ŒåŠ›ã€‚ç«™åœ¨å½“ä¸‹çœ‹æœªæ¥ï¼Œæˆ‘ä»¬å°†å¦‚ä½•è¡ŒåŠ¨ï¼Œè¿™éœ€è¦å¼ºå¤§çš„å…ˆéªŒèƒ½åŠ›ï¼›è€Œç«™åœ¨å½“ä¸‹çœ‹è¿‡å»ï¼Œæˆ‘ä»¬åˆæœ‰å“ªäº›å¾—å¤±ï¼Œè¿™äº›å¾—å¤±æ˜¯å¦å¯ä»¥ä½œç”¨äºæœªæ¥ï¼Œä¸ºæˆ‘ä»¬å‰è¡Œåšå‡ºæŒ‡å¯¼ï¼Œè¿™éœ€è¦å¼ºå¤§çš„æ‰§è¡ŒåŠ›ã€‚</p>
<p><img src="/2023/07/09/My-practice-of-working-backwards/8.png" alt></p>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>é“ç†çºµæœ‰åƒåƒä¸‡ä¸‡ï¼Œå®è·µæ€»æ˜¯ä¸€ä»¶éå¸¸éš¾çš„äº‹æƒ…ã€‚æˆ‘ä»¬æ€»ä¹Ÿæ— æ³•é¢„çŸ¥æœªæ¥ï¼Œå› æ­¤æ›´éœ€è¦æˆ‘ä»¬è®¤å‡†ç›®æ ‡ï¼Œä»¥é€†å‘å·¥ä½œçš„æ€è·¯ï¼Œä¹˜ç€åéªŒä¹‹é£ï¼Œåœ¨è°¨æ…è€Œåˆå¿«é€Ÿã€ä¸æ–­è°ƒæ•´çš„å®è·µä¸­åˆ›é€ æœªæ¥ï¼Œåˆ›é€ ä»·å€¼ã€‚</p>
<p>å‡¡æ˜¯è¿‡å¾€ï¼Œçš†ä¸ºåºç« ã€‚ä»Šå¤©ï¼Œä»ç„¶æ˜¯ç¬¬ä¸€å¤©ã€‚</p>
]]></content>
      <categories>
        <category>æ€»ç»“</category>
      </categories>
      <tags>
        <tag>å®è·µ</tag>
        <tag>é€†å‘å€’æ¨</tag>
        <tag>é€†åº·å¨å®šå¾‹</tag>
        <tag>è¯•ç‚¹é™·é˜±</tag>
      </tags>
  </entry>
  <entry>
    <title>æˆ‘å¯¹ ChatGPT çš„æ€è€ƒ</title>
    <url>/2023/04/05/my-understanding-for-chatGPT/</url>
    <content><![CDATA[<p><img src="/2023/04/05/my-understanding-for-chatGPT/1.jpg" alt></p>
<p>ä¸ç»æ„é—´ï¼Œ2023 å¹´å·²ç»è¿‡å»äº† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mn>4</mn></mrow><annotation encoding="application/x-tex">1/4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">/</span><span class="mord">4</span></span></span></span>ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼Œå¦‚æœè¯´ç§‘æŠ€åœˆæœ€å¼•äººæ³¨ç›®çš„äº‹æƒ…ï¼Œé‚£è«è¿‡äº <a href="https://openai.com/blog/chatgpt">ChatGPT</a> çš„çˆ†ç«äº†ã€‚ä¸Šçº¿ä»…ä»…ä¸¤ä¸ªæœˆï¼ŒChatGPTçš„æ´»è·ƒç”¨æˆ·å°±çªç ´ä¸€äº¿<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup>ï¼Œå…¶ç«çˆ†ç¨‹åº¦ï¼Œå¯è§ä¸€æ–‘ã€‚</p>
<span id="more"></span>
<h2 id="chatgpt-å‘å¸ƒæ—¶é—´çº¿">ChatGPT å‘å¸ƒæ—¶é—´çº¿</h2>
<p>æ ¹æ® <em>ChatGPT â€” Release Notes</em> <sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup>ï¼ŒChatGTP çš„å…³é”®æ—¶é—´çº¿å¦‚ä¸‹ï¼š</p>
<ul>
<li>2022-11-30: ChatGPTæ­£å¼å‘å¸ƒ</li>
<li>2022-12-15: ç¬¬ä¸€æ¬¡æ›´æ–°
<ul>
<li>æå‡äº†æ€»ä½“æ€§èƒ½</li>
<li>å¢åŠ äº†ä¿å­˜å’ŒæŸ¥çœ‹å†å²å¯¹è¯è®°å½•çš„æ–°åŠŸèƒ½</li>
</ul>
</li>
<li>2023-01-09: ç¬¬äºŒæ¬¡æ›´æ–°
<ul>
<li>æ”¹å–„äº†å›ç­”çš„çœŸå®æ€§</li>
<li>å¢åŠ äº†â€œåœæ­¢ç”Ÿæˆâ€åŠŸèƒ½</li>
</ul>
</li>
<li>2023-01-30: ç¬¬ä¸‰æ¬¡æ›´æ–°
<ul>
<li>æå‡ç­”æ¡ˆçœŸå®æ€§</li>
<li>æå‡æ•°å­¦èƒ½åŠ›</li>
</ul>
</li>
<li>2023-02-13: ç¬¬å››æ¬¡æ›´æ–°
<ul>
<li>æå‡äº†å…è´¹ç‰ˆçš„æ€§èƒ½</li>
<li>æ–°å¢ â€œChatGPT Plusâ€ çš„å›½é™…è´­ä¹°èƒ½åŠ›</li>
</ul>
</li>
<li>2023-03-14: GPT-4æ­£å¼å‘å¸ƒ
<ul>
<li>å¤§å‹å¤šæ¨¡æ€æ¨¡å‹</li>
<li>ä¸ä»…èƒ½å¤Ÿé˜…è¯»æ–‡å­—ï¼Œè¿˜èƒ½è¯†åˆ«å›¾åƒï¼Œå¹¶ç”Ÿæˆæ–‡æœ¬ç»“æœ</li>
</ul>
</li>
<li>2023-03-23: æ”¯æŒplugins</li>
</ul>
<h2 id="chatgpt-çš„æµè¡Œè¶‹åŠ¿">ChatGPT çš„æµè¡Œè¶‹åŠ¿</h2>
<p>ChatGPT å‘å¸ƒåçš„ 5 å¤©å†…ï¼Œå…¶æ³¨å†Œç”¨æˆ·å°±è¾¾åˆ°äº† 100W+ï¼Œåœ¨å…¶å‘å¸ƒçš„å‰ä¸¤ä¸ªæœˆï¼Œå…¶æ³¨å†Œç”¨æˆ·æ•°å°±è¶…è¿‡äº† 1äº¿ã€‚</p>
<h3 id="similarweb-çš„æµé‡è¶‹åŠ¿å›¾">similarweb çš„æµé‡è¶‹åŠ¿å›¾</h3>
<p>æ ¹æ® <a href="https://www.similarweb.com/zh/website/chat.openai.com/#ranking">similarweb</a> çš„æ•°æ®ï¼ŒChatGPT æ¯å¤©å¤§æ¦‚æœ‰ 5000W çš„è®¿é—® PVï¼Œ3000W çš„è®¿é—® UVã€‚æ ¹æ®å½“å‰çš„å¢é•¿è¶‹åŠ¿ï¼Œé¢„è®¡åˆ° 2023 å¹´æœ€åä¸€ä¸ªå­£åº¦æœ«ï¼ŒChatGPTçš„ç”¨æˆ·é‡çº§å°†ä¼šçªç ´ 10 äº¿<sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup>ã€‚</p>
<p><img src="/2023/04/05/my-understanding-for-chatGPT/2.jpg" alt></p>
<h3 id="google-trend-è¶‹åŠ¿å›¾">Google Trend è¶‹åŠ¿å›¾</h3>
<p>ä» <a href="https://trends.google.com/trends/explore?date=2022-11-30%202023-04-14&amp;q=ChatGPT&amp;hl=en">è°·æ­Œè¶‹åŠ¿</a> çš„æ•°æ®ä¹Ÿå¯ä»¥çœ‹å‡ºï¼ŒChatGPT çš„çƒ­åº¦ä¹Ÿæ˜¯æŒç»­å¢åŠ ã€‚å¹¶ä¸”ä»åˆ†åœ°åŒºçš„çƒ­åº¦è¶‹åŠ¿ä¹Ÿèƒ½çœ‹å‡ºï¼Œå›½å†…æŠ€æœ¯åœˆå¯¹ ChatGPT çš„è®¨è®ºæ˜¯æœ€çƒ­çš„ã€‚</p>
<p><img src="/2023/04/05/my-understanding-for-chatGPT/3.jpg" alt></p>
<h2 id="chatgpt-çš„å¤§è®¨è®º">ChatGPT çš„å¤§è®¨è®º</h2>
<h3 id="ä¸Šæ¦œçƒ­æœ">ä¸Šæ¦œçƒ­æœ</h3>
<p>æ ¹æ® <a href="https://weibo.zhaoyizhe.com/superInfo.html?topic=ChatGPT">çƒ­æœå¼•æ“</a> æä¾›çš„å¾®åšçƒ­æœå†å²æ•°æ®ï¼Œæˆ‘ä»¬å‘ç°ï¼Œ2022 å¹´ 12 æœˆ 5 æ—¥ï¼ŒChatGPT ç¬¬ä¸€æ¬¡ç™»ä¸Šå¾®åšçƒ­æœæ¦œï¼Œå…¶æœ€åçš„åœ¨æ¦œæ—¶é—´ä¸º 2023 å¹´ 3 æœˆ 31 æ—¥ï¼Œç´¯è®¡åœ¨æ¦œæ—¶é•¿è¾¾åˆ°äº† 1391 åˆ†é’Ÿã€‚å¦‚æœåœ¨ <em>çƒ­æœå¼•æ“</em> ä¸Šæ£€ç´¢ ChatGPTï¼Œæˆ‘ä»¬ä¼šå‘ç°ï¼Œç›´åˆ°ç°åœ¨ï¼Œè™½ç„¶è·ç¦» ChatGPT çš„é¦–æ¬¡å‘å¸ƒè¿‡å»äº† 4 ä¸ªæœˆä¹‹ä¹…ï¼Œä½†æ˜¯å¯¹ ChatGPT çš„å„ç§è®¨è®ºä¾ç„¶éå¸¸ç«çƒ­ã€‚</p>
<p><img src="/2023/04/05/my-understanding-for-chatGPT/4.jpg" alt></p>
<h3 id="ä¸¤ä¼šçƒ­ç‚¹">ä¸¤ä¼šçƒ­ç‚¹</h3>
<p>åœ¨ 3 æœˆ 5 æ—¥çš„åå››å±Šå…¨å›½äººå¤§ä¸€æ¬¡ä¼šè®®çš„é¦–åœºâ€œéƒ¨é•¿é€šé“â€é‡‡è®¿ä¸­ï¼Œç§‘å­¦æŠ€æœ¯éƒ¨éƒ¨é•¿ç‹å¿—åˆšä¹Ÿå¯¹ ChatGPT å‘è¡¨äº†è‡ªå·±çš„çœ‹æ³•<sup class="footnote-ref"><a href="#fn4" id="fnref4">[4]</a></sup>ã€‚ 3 æœˆ 9 æ—¥ï¼Œæ–°äº¬æŠ¥ ã€Šä¸¤ä¼šä¸‰äººè°ˆã€‹æ ç›®ç»„ä¹Ÿé‚€è¯·äº†å…¨å›½æ”¿åå§”å‘˜ã€äººå·¥æ™ºèƒ½ä¸“å®¶ï¼Œå¯¹ ChatGPT ä¸ºä»£è¡¨çš„äººå·¥æ™ºèƒ½æŠ€æœ¯è¿›è¡Œäº†è®¨è®º<sup class="footnote-ref"><a href="#fn5" id="fnref5">[5]</a></sup>ã€‚</p>
<h3 id="llms-å¤§çˆ†å‘">LLMs å¤§çˆ†å‘</h3>
<p>æ ¹æ® <a href="https://baike.baidu.com/starmap/view?nodeId=e0a309bf5b0f017891c7b859">ç™¾ç§‘æ˜Ÿå›¾</a> å¯çŸ¥ï¼Œç›®å‰è°·æ­Œã€äºšé©¬é€Šã€ç™¾åº¦ã€é˜¿é‡Œç­‰å¤šä¸ªç§‘æŠ€å·¨å¤´éƒ½åŠ å…¥åˆ°äº† <em>å¯¹è¯å¼å¤§è¯­è¨€æ¨¡å‹</em> çš„ç ”å‘ä¸­ã€‚</p>
<ul>
<li>2023 å¹´ 2 æœˆ 6 æ—¥ï¼Œè°·æ­Œå®£å¸ƒå°†æ¨å‡ºä¸€æ¬¾èŠå¤©æœºå™¨äººâ€”â€”Bardï¼Œ2 æœˆ 9 æ—¥ï¼Œè°·æ­Œ Bard å‘å¸ƒä¼šè¯•æ¼”ç¿»è½¦ï¼Œå›ç­”å†…å®¹å‡ºç°é”™è¯¯ï¼Œå½“æ—¥å¸‚å€¼æš´è·Œ1000äº¿ç¾å…ƒã€‚</li>
<li>2023 å¹´ 2 æœˆ 24 æ—¥ï¼ŒMeta å®˜å®£ SOTA å¤§è¯­è¨€æ¨¡å‹ LLaMAï¼Œå¯¹éå•†ç”¨çš„ç ”ç©¶ç”¨ä¾‹å¼€æºã€‚</li>
<li>2023 å¹´ 3 æœˆ 14 æ—¥ï¼Œæ–¯å¦ç¦å‘å¸ƒäº†ä¸€ä¸ªç”± LLaMA 7B å¾®è°ƒçš„æ¨¡å‹ Alpacaï¼Œæ€§èƒ½å’Œ GPT-3.5 ä¸ç›¸ä¸Šä¸‹ã€‚</li>
<li>2023 å¹´ 3 æœˆ 16 æ—¥ï¼Œç™¾åº¦ä¸¾åŠâ€œç™¾åº¦æ–‡å¿ƒä¸€è¨€æ–°é—»å‘å¸ƒä¼šâ€ï¼Œæ­£å¼å‘å¸ƒ <em>æ–‡å¿ƒä¸€è¨€</em>ã€‚</li>
<li>2023 å¹´ 4 æœˆ 11 æ—¥ï¼Œé˜¿é‡Œåœ¨é˜¿é‡Œäº‘å³°ä¼šä¸Šï¼Œæ­£å¼å®£å¸ƒæ¨å‡ºå¤§è¯­è¨€æ¨¡å‹ <em>é€šä¹‰åƒé—®</em>ã€‚</li>
<li>2023 å¹´ 4 æœˆ 16 æ—¥ï¼Œç™¾åº¦ CTO ç‹æµ·å³°åšå®¢ <a href="http://tv.cctv.com/2023/04/16/VIDE32EopwFYhGR54OaF63KN230416.shtml">CCTV-2ã€Šä¸­å›½ç»æµå¤§è®²å ‚ã€‹</a>ï¼Œé˜é‡Š <em>æ–‡å¿ƒä¸€è¨€</em> è¿™ç±»å¤§è¯­è¨€æ¨¡å‹çš„äº§å“èƒ½åŠ›ã€æŠ€æœ¯åŸç†å’Œäº§ä¸šä»·å€¼ã€‚</li>
<li>â€¦â€¦</li>
</ul>
<h2 id="chatgtp-å¯¹æˆ‘ä»¬ç©¶ç«Ÿæœ‰æ€æ ·çš„å½±å“">ChatGTP å¯¹æˆ‘ä»¬ç©¶ç«Ÿæœ‰æ€æ ·çš„å½±å“</h2>
<p>åœ¨ <a href="https://book.douban.com/subject/30221932/">çŸ¥è¯†å¤§è¿ç§»</a> è¿™æœ¬ä¹¦ä¸­ï¼Œä½œè€…è¯•å›¾ä½¿ç”¨ â€œè¾¾å…‹æ•ˆåº”â€ æ¥è§£é‡Šï¼šä¿¡æ¯çˆ†ç‚¸æ—¶ä»£ï¼Œä¸ºä»€ä¹ˆäººå´è¶Šæ¥è¶Šæ— çŸ¥ï¼Ÿ</p>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition note"><p class="admonition-title">è¾¾å…‹æ•ˆåº”
</p><p>åº·å¥ˆå°”å¤§å­¦å¿ƒç†å­¦æ•™æˆå¤§å«Â·é‚“å®ï¼ˆDavid Dunningï¼‰å’Œä»–çš„ç ”ç©¶ç”Ÿè´¾æ–¯æ±€Â·å…‹é²æ ¼ï¼ˆJustin Krugerï¼‰é€šè¿‡ä¸€ç³»åˆ—çš„å®éªŒå‘ç°äº†ä¸€ç§ç°è±¡ï¼šæœ€ç¼ºä¹çŸ¥è¯†å’ŒæŠ€èƒ½çš„äººåè€Œæœ€æ— æ³•è®¤çŸ¥åˆ°è‡ªå·±çš„è¿™ç§æ¬ ç¼ºã€‚</p>
<p>è¿™ä¸€ç°è±¡åæ¥è¢«ç§°ä¸ºâ€œé‚“å®-å…‹é²æ ¼æ•ˆåº”ï¼ˆthe Dunning-Kruger effectï¼‰ï¼Œç®€ç§°â€œè¾¾å…‹æ•ˆåº”â€ã€‚</p>
</div>
<h3 id="chatgpt-æå‡ç”Ÿäº§æ•ˆç‡">ChatGPT æå‡ç”Ÿäº§æ•ˆç‡</h3>
<p>å¯¹äº ChatGPT è€Œè¨€ï¼Œæœ‰äº›äººæƒŠå‘¼äºå…¶å¼ºå¤§çš„èƒ½åŠ›ï¼Œå¹¶ä¸”å·²ç»å¼€å§‹ä½¿ç”¨ ChatGPT æ¥å¸®åŠ©è‡ªå·±å®Œæˆå„ç§å„æ ·çš„ä»»åŠ¡ã€‚</p>
<ul>
<li>ç ”ç©¶å‘ç°ï¼ŒåŸºäº OpenAI æ„å»ºçš„ Github Copilot å¯ä»¥å¸®åŠ©ç¨‹åºå¼€å‘äººå‘˜æå‡ 55% çš„å¼€å‘æ•ˆç‡<sup class="footnote-ref"><a href="#fn6" id="fnref6">[6]</a></sup>ã€‚</li>
<li>åœ¨çº¿å­¦ä¹ å¹³å° <a href="http://Study.com">Study.com</a> å‘ 1000 å 18 å²ä»¥ä¸Šå­¦ç”Ÿå‘èµ·çš„ä¸€é¡¹è°ƒæŸ¥æ˜¾ç¤ºï¼Œè¶…è¿‡ 89% çš„å­¦ç”Ÿæ‰¿è®¤ä½¿ç”¨ ChatGPT æ¥å®Œæˆå®¶åº­ä½œä¸š<sup class="footnote-ref"><a href="#fn7" id="fnref7">[7]</a></sup>ã€‚</li>
<li>2023 å¹´ 3 æœˆ 16 æ—¥ï¼Œå¾®è½¯å®£å¸ƒå°†æ¨å‡ºåä¸º Copilot çš„äººå·¥æ™ºèƒ½æœåŠ¡ï¼Œå¹¶å°†å…¶åµŒå…¥ Wordã€PowerPointã€Excel ç­‰ Office åŠå…¬è½¯ä»¶ã€‚</li>
<li>â€¦â€¦</li>
</ul>
<h3 id="chatgpt-çš„å®‰å…¨éšæ‚£">ChatGPT çš„å®‰å…¨éšæ‚£</h3>
<p>è€Œå¦ä¸€æ–¹é¢ï¼Œæœ‰æ›´å¤šçš„å¯¹ ChatGPT è®¤è¯†æ›´æ·±å…¥çš„ä¸ªäººã€ç»„ç»‡ä¹Ÿå¯¹ ChatGPT æ‰€å­˜åœ¨çš„æ•°æ®å®‰å…¨ã€éšç§å®‰å…¨ã€æ”¿ç­–å®‰å…¨ç­‰å„æ–¹é¢çš„å®‰å…¨è¡¨ç¤ºå‡ºæ‹…å¿§ã€‚</p>
<ul>
<li>2022 å¹´ 12 æœˆ 6 æ—¥ï¼ŒçŸ¥åå¼€å‘è€…é—®ç­”ç½‘ç«™ Stack Overflow å‘å¸ƒä¸€é¡¹ä¸´æ—¶æ”¿ç­–ï¼šç¦ç”¨ç”¨ ChatGPT ç”Ÿæˆå†…å®¹æ¥å›ç­” Stack Overflow ä¸Šçš„é—®é¢˜ã€‚</li>
<li>2023 å¹´ 1 æœˆ 31 æ—¥ï¼Œå…¨çƒæœ€å¤§é¢„å°æœ¬å‘å¸ƒå¹³å°arXivå®£å¸ƒæ–°æ”¿ç­–ï¼šä¸å…è®¸å°† ChatGPT ç­‰ç”Ÿæˆå¼ AI å·¥å…·åˆ—ä¸ºä½œè€…ã€‚</li>
<li>2023 å¹´ 3 æœˆ 28æ—¥ï¼Œ1000 å¤šåäººå·¥æ™ºèƒ½ä¸“å®¶å’Œç§‘æŠ€åäººè”åå‘å¸ƒå…¬å¼€ä¿¡å‘¼åæš‚åœå¼€å‘ AGI ç³»ç»Ÿï¼Œç½²åè€…åŒ…æ‹¬ç‰¹æ–¯æ‹‰é¦–å¸­æ‰§è¡Œå®˜ã€æ¨ç‰¹æŒé—¨äººâ€”â€”åŸƒéš†Â·é©¬æ–¯å…‹ï¼Œé©¬æ–¯å…‹è¯´ï¼šâ€œé¢†å…ˆçš„ AGI å¼€å‘äººå‘˜ä¸ä¼šæ³¨æ„è¿™ä¸ªè­¦å‘Šï¼Œä½†è‡³å°‘æœ‰äººè¯´è¿‡â€ã€‚</li>
<li>è·¯é€ç¤¾æŠ¥é“ç§°ï¼Œæ„å¤§åˆ©ä¸ªäººæ•°æ®ä¿æŠ¤å±€ï¼ˆDPAï¼‰å®£å¸ƒä» 2023 å¹´ 3 æœˆ 31 æ—¥èµ·ç¦æ­¢ä½¿ç”¨ ChatGPTï¼Œé™åˆ¶ OpenAI å¤„ç†æ„å¤§åˆ©ç”¨æˆ·ä¿¡æ¯æ•°æ®ï¼ŒåŒæ—¶å¯¹å…¶éšç§å®‰å…¨é—®é¢˜ç«‹æ¡ˆè°ƒæŸ¥ã€‚</li>
<li>â€¦â€¦</li>
</ul>
<h3 id="chatgpt-çš„ä¾‹å­">ChatGPT çš„ä¾‹å­</h3>
<p>ä¸ºäº†æµ‹è¯• ChatGPT çš„èƒ½åŠ›ï¼Œæˆ‘ç”¨éå¸¸ç®€å•çš„æ¨ç†é¢˜å¯¹ ChatGPT è¿›è¡Œäº†æµ‹è¯•ï¼Œå…¶è¡¨ç°å‡ºçš„æ•ˆæœä»¤äººéå¸¸æ¿€åŠ¨ã€‚<br>
<img src="/2023/04/05/my-understanding-for-chatGPT/ChatGPT_DEMO.gif" alt></p>
<h3 id="chatgpt-å¯¹å·¥ä½œçš„å½±å“">ChatGPT å¯¹å·¥ä½œçš„å½±å“</h3>
<p>æˆ‘ä»¬éƒ½è®¤è¯†åˆ° ChatGPT å°†ä¼šå¯¹æˆ‘ä»¬çš„å·¥ä½œå¸¦æ¥éå¸¸å¤§çš„å½±å“ï¼Œè¯šå¦‚ç›®å‰å¤§å®¶æ‰€è®¨è®ºçš„ä¸€æ ·ã€‚ç„¶è€Œï¼ŒChatGPT å¯¹å“ªäº›å·¥ä½œä¼šå¸¦æ¥å½±å“ï¼Œä¼šå¸¦æ¥å“ªäº›å…·ä½“çš„å½±å“ï¼Œå´æ²¡æœ‰äººèƒ½è¯´çš„æ¸…æ¥šã€‚</p>
<p>2023 å¹´ 3 æœˆ 17 æ—¥ï¼Œ <a href="https://openai.com/">OpenAI</a>ã€<a href="https://openresearch.com/">OpenResearch</a>ã€<a href="https://www.upenn.edu/">å®¾å¤•æ³•å°¼äºšå¤§å­¦</a> å…±åŒå‘è¡¨äº†ä¸€ç¯‡è®ºæ–‡ <a href="https://arxiv.org/abs/2303.10130"><em>GPTs are GPTs: An early look at the labor market impact potential of large language models</em></a> æ¥è¯¦ç»†çš„ç ”ç©¶ GPT è¿™ç§å¤§è¯­è¨€æ¨¡å‹å¯¹æˆ‘ä»¬çš„å·¥ä½œçš„å…·ä½“å½±å“<sup class="footnote-ref"><a href="#fn8" id="fnref8">[8]</a></sup>ã€‚</p>
<p>åœ¨ <em>GPTs are GPTs</em> è¿™ç¯‡è®ºæ–‡ä¸­ï¼š</p>
<ul>
<li>è®ºæ–‡é‡‡ç”¨äº† ç¾å›½åŠ³å·¥ç»Ÿè®¡å±€ï¼ˆBureau of Labor Statistics, BLSï¼‰çš„åŠ³åŠ¨åŠ›å¸‚åœºç»Ÿè®¡æ•°æ®å’Œç¾å›½æ±‚èŒç½‘ç«™ <a href="https://www.onetonline.org/">O*Net</a> çš„èŒä½æ‹›è˜æ•°æ®æ¥åˆ†æç±»ä¼¼ GPT çš„ LLMs å¯¹ç¾å›½ä¸åŒèŒä¸šçš„å½±å“ã€‚åœ¨è®ºæ–‡ä¸­ï¼Œä½œè€…å®šä¹‰äº† Exposure çš„æ¦‚å¿µæ¥åˆ†æ LLMs å¯¹ä¸åŒèŒä¸šçš„å½±å“ã€‚</li>
<li>è®ºæ–‡ä¸­å¼•ç”¨äº† <a href="https://arxiv.org/abs/2303.08774">GPT-4 Technical Report</a> ä¸­æä¾›çš„ GPT åœ¨å„ç§è€ƒè¯•ä¸­çš„å¾—åˆ†æƒ…å†µï¼Œä»ä¸‹å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼ŒGPT çš„è¡¨ç°è¿˜æ˜¯éå¸¸å¥½çš„ï¼Œå°¤å…¶æ˜¯åœ¨ç¾å›½ç”Ÿç‰©å¥¥æ—åŒ¹å…‹ç«èµ›ã€æ³•å­¦é™¢å…¥å­¦è€ƒè¯•ã€é«˜ä¸­æ•°å­¦è€ƒè¯•ã€å¿ƒç†å­¦ã€ç¯å¢ƒç§‘å­¦â€¦â€¦<sup class="footnote-ref"><a href="#fn9" id="fnref9">[9]</a></sup><br>
<img src="/2023/04/05/my-understanding-for-chatGPT/5.jpg" alt></li>
<li>è®ºæ–‡æŒ‡å‡ºï¼Œæ ¹æ®åˆ†æï¼Œ80% çš„èŒä¸šä¸­çš„ 10% çš„å·¥ä½œä¼šå—åˆ° LLMs çš„å½±å“ã€‚å¹¶ä¸”ï¼Œ19% çš„å·¥ä½œä¸­ï¼Œè‡³å°‘æœ‰ 50% çš„å·¥ä½œä¼šå—åˆ° LLMs çš„å½±å“ã€‚è®ºæ–‡è¿˜æŒ‡å‡ºï¼Œåœ¨ LLMs çš„å¸®åŠ©ä¸‹ï¼Œ15% çš„å·¥ä½œå¯ä»¥åœ¨åŒç­‰è´¨é‡ä¸‹æ›´å¿«çš„å®Œæˆï¼Œå¦‚æœè€ƒè™‘åˆ°åŸºäº LLMs æ„å»ºçš„å„ç§å·¥å…·ï¼Œè¿™ä¸ªæ¯”ä¾‹å¯ä»¥æå‡åˆ° 50%ã€‚<br>
<img src="/2023/04/05/my-understanding-for-chatGPT/6.jpg" alt></li>
<li>æ ¹æ®è®ºæ–‡çš„ç ”ç©¶ï¼Œå¯¹äºéœ€è¦ç§‘å­¦åˆ†æã€æ‰¹åˆ¤æ€§æ€ç»´ç­‰æŠ€èƒ½çš„å·¥ä½œï¼ŒLLMs ä¸ä¼šå¯¹å…¶å¸¦æ¥è¾ƒå¤§å½±å“ï¼Œä½†æ˜¯å¯¹äºéœ€è¦ç¼–ç¨‹ã€å†™ä½œç­‰æŠ€èƒ½çš„å·¥ä½œï¼ŒLLMs ä¼šå¯¹å…¶å¸¦æ¥éå¸¸å¤§çš„å½±å“ã€‚å¹¶ä¸”ï¼Œå‡†å…¥é—¨æ§›è¶Šé«˜ã€æ”¶å…¥è¶Šé«˜çš„èŒä¸šè¶Šæœ‰å¯èƒ½ä¼šå—åˆ° LLMs çš„å½±å“ã€‚<br>
<img src="/2023/04/05/my-understanding-for-chatGPT/7.jpg" alt></li>
</ul>
<p>ç”±æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼ŒLLMs ä½œä¸ºä¸€ç§é€šç”¨ç›®çš„æŠ€æœ¯ï¼Œå¿…ç„¶ä¼šå¯¹ç»æµã€ç¤¾ä¼šçš„å„ä¸ªæ–¹é¢å¸¦æ¥ä¸åŒå±‚é¢çš„å†²å‡»ã€‚</p>
<p>æˆ‘ä»¬å¦‚ä½•é¢å¯¹è¿™ç§å†²å‡»ï¼Ÿæ­£è§†ä»–ã€å­¦ä¹ ä»–ã€åˆ©ç”¨ä»–ï¼Ÿè¿˜æ˜¯å›é¿ä»–ã€æ‹’ç»ä»–ï¼Ÿ</p>
<p>æˆ‘ä»¬åˆå¦‚ä½•æ­£ç¡®çš„è®¤è¯† LLMs çš„èƒ½åŠ›å’Œäººçš„èƒ½åŠ›ä¹‹é—´çš„å¼‚åŒå‘¢ï¼Ÿ</p>
<p>å°±å…¶å½“å‰èƒ½åŠ›è€Œè¨€ï¼ŒLLMs æ›´å¤šæ˜¯äº§ç”Ÿå…·ä½“çš„ã€æ˜ç¡®çš„ã€é¢„æœŸä¹‹å†…çš„ç»“æœï¼Œè€Œä½œä¸ºç¤¾ä¼šåŒ–åŠ¨ç‰©çš„äººè€Œè¨€ï¼Œè¿™æ˜¯ä¸ AI å®Œå…¨ä¸åŒçš„æœ€é‡è¦çš„ä¸€ç‚¹ã€‚äººç±»åœ¨é•¿æœŸçš„è¿›åŒ–è¿‡ç¨‹ä¸­æ‰€å½¢æˆçš„å¿ƒç†ã€æ¿€æƒ…ã€æ‹¼æç­‰ï¼Œäººç±»å¯¹å‘½è¿çš„ä¸ç¡®å®šæ€§æ‰€å±•ç°çš„é£åï¼Œç›®å‰çœ‹ AI è¿˜æ˜¯å¾ˆéš¾ä»…ä»…é€šè¿‡è¯­æ–™çš„è®­ç»ƒæˆ–è€…ä¸€å®šç¨‹åº¦çš„éšæœºæ¼”åŒ–è€Œäº§ç”Ÿã€‚</p>
<ul>
<li>é…’é€¢çŸ¥å·±åƒæ¯å°‘ï¼Œäººé€¢å–œäº‹ç²¾ç¥çˆ½ï¼Œè¿™ç§ç²¾ç¥å±‚é¢æ‰€èµ‹äºˆçš„åŠ¨åŠ›ï¼ŒAI æš‚æ—¶è¿˜æ˜¯ä¸å…·å¤‡çš„ã€‚</li>
<li>åœ¨ AI çš„è¯„ä¼°ä¸‹ï¼Œæ˜¯æ— æ³•å‡ºç°åƒå·¨é¹¿ä¹‹æˆ˜ã€å®˜æ¸¡ä¹‹æˆ˜ã€èµ¤å£ä¹‹æˆ˜ç­‰å†å²æ˜Ÿç©ºä¸­çš„ç’€ç’¨ä¹‹æ˜Ÿã€‚</li>
</ul>
<p>ä½†æ˜¯ï¼Œ4 æœˆ 12 æ—¥å‘å¸ƒçš„ï¼Œç”± GPT-4 é©±åŠ¨çš„ AutoGPTï¼Œå…¶è®¤çŸ¥èƒ½åŠ›æ›´ä¸ºå¼ºå¤§ã€‚ä¸ ChatGPT çš„å•æ¬¡æé—®ã€å•æ¬¡å›ç­”æ¨¡å¼ä¸åŒï¼ŒAutoGPT ä¸»æ‰“å…¨è‡ªåŠ¨ï¼Œç»™å®šä»»åŠ¡ï¼Œä»–å°±å¯ä»¥å»ºç«‹ä¸€ä¸ªè‡ªæˆ‘â€œæ€è€ƒã€è¡ŒåŠ¨ã€è§‚å¯Ÿç»“æœã€å†³å®šä¸‹ä¸€æ­¥è¡ŒåŠ¨ã€å†æ¬¡è¡ŒåŠ¨ã€å†æ¬¡è§‚å¯Ÿç»“æœâ€çš„å¾ªç¯ã€‚</p>
<p>æ ¹æ® B ç«™ UP ä¸»å‘å¸ƒçš„è§†é¢‘å¯ä»¥å‘ç°ï¼šAutoGPT å¯ä»¥å®ç°è‡ªå·±æŸ¥è¯¢æ–‡çŒ®ã€å­¦ä¹ æ–‡çŒ®ï¼Œå¹¶æœ€ç»ˆå®Œæˆç»™å®šè®ºæ–‡é¢˜ç›®å†™ä½œçš„æ•´ä¸ªè¿‡ç¨‹ï¼Œè€Œæ•´ä¸ªè¿‡ç¨‹ä¸­å‡ºäº†æœ€å¼€å§‹éœ€è¦ç»™ AutoGPT å‘å¸ƒä»»åŠ¡å¤–ï¼Œå…¶ä»–ç¯èŠ‚åˆ™å…¨éƒ¨ç”± AutoGPT è‡ªåŠ¨å®Œæˆã€‚</p>
<div class="bili_video"><div style="position: relative; width: 100%; height: 0; padding-bottom: 75%;"><iframe src="https://player.bilibili.com/player.html?aid=782579587&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position: absolute; width: 100%; height: 100%; left: 0; top: 0;"> </iframe></div></div>
<p>ã€Šæµæµªåœ°çƒã€‹ è¿™éƒ¨ç”µå½±ä¸­çš„ MOSS åˆ™æ˜¯æ›´ä¸ºæ™ºèƒ½çš„ AI äº†ã€‚ä½œä¸ºä¸€å°æ™ºèƒ½é‡å­è®¡ç®—æœºï¼ŒMOSS è´Ÿè´£ç®¡ç†ç©ºé—´ç«™äº‹åŠ¡ï¼Œæ˜¯æµæµªåœ°çƒè®¡åˆ’ä¸ç«ç§è®¡åˆ’çš„ç›‘ç£è€…å’Œæ‰§è¡Œè€…ã€‚MOSS ä¼šåšå®šçš„æ‰§è¡Œå»¶ç»­äººç±»æ–‡æ˜çš„ä½¿å‘½ï¼Œå¹¶èƒ½åœ¨æœ€çŸ­çš„æ—¶é—´å†…åšå‡ºæœ€æ­£ç¡®çš„å†³å®šï¼Œæ˜¯è¶‹äºå®Œç¾çš„æ™ºæ…§ä½“ã€‚</p>
<p>ç”µå½±ä¸­ï¼ŒMOSS ç»è¿‡è®¡ç®—å‘ç°æ ¹æœ¬ä¸å¯èƒ½ç‚¹ç‡ƒæœ¨æ˜Ÿï¼Œåœ°çƒå³å°†å‘ç”Ÿæ— æ³•æŒ½å›çš„å˜æ•…ã€‚å› æ­¤ï¼ŒMOSS æ‰§è¡Œäº†ç«ç§è®¡åˆ’ï¼Œå¼ºåˆ¶äººç±»è¿›è¡Œä¼‘çœ ï¼Œç©ºé—´ç«™å¯åŠ¨é€ƒç¦»ç¨‹åºã€‚ä¸æ­¤å½¢æˆé²œæ˜å¯¹æ¯”çš„æ˜¯ï¼Œåˆ˜åŸ¹å¼ºåˆ™æ€’ç ¸ MOSSï¼Œç„¶ååˆ©ç”¨ç‰ºç‰²è‡ªå·±å’Œç©ºé—´ç«™çš„æ–¹å¼ï¼Œæœ€ç»ˆæˆåŠŸå¼•ç‡ƒæœ¨æ˜Ÿï¼Œæ‹¯æ•‘äº†åœ°çƒã€‚</p>
<h2 id="ç§¯ææ‹¥æŠ±-gpt">ç§¯ææ‹¥æŠ± GPT</h2>
<p>GPT ä¸åŒç‰ˆæœ¬çš„å‚æ•°é‡å’Œé¢„è®­ç»ƒæ•°æ®é‡çš„å¯¹æ¯”ï¼š</p>
<table>
<thead>
<tr>
<th>æ¨¡å‹</th>
<th>å‘å¸ƒæ—¶é—´</th>
<th>å‚æ•°é‡</th>
<th>é¢„è®­ç»ƒæ•°æ®é‡</th>
</tr>
</thead>
<tbody>
<tr>
<td>GPT</td>
<td>2018 å¹´ 6 æœˆ</td>
<td>1.17 äº¿</td>
<td>5GB</td>
</tr>
<tr>
<td>GPT-2</td>
<td>2019 å¹´ 2 æœˆ</td>
<td>15 äº¿</td>
<td>40GB</td>
</tr>
<tr>
<td>GPT-3</td>
<td>2020 å¹´ 5 æœˆ</td>
<td>1,750 äº¿</td>
<td>45TB</td>
</tr>
<tr>
<td>GPT-4</td>
<td>2023 å¹´ 3 æœˆ</td>
<td>é¢„ä¼°æ˜¯ 1 ä¸‡äº¿</td>
<td>â€“</td>
</tr>
</tbody>
</table>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition note"><p class="admonition-title">å¤§è„‘ç¥ç»å…ƒå’Œçªè§¦
</p><p>äººç±»çš„å¤§è„‘å¤§æ¦‚æœ‰ 1000 äº¿ä¸ªç¥ç»å…ƒï¼Œç¥ç»å…ƒä¸ç¥ç»å…ƒä¹‹é—´é€šè¿‡çªè§¦â€œé“¾æ¥â€åœ¨ä¸€èµ·ã€‚æ¯ä¸ªç¥ç»å…ƒå¯ä»¥é€šè¿‡çªè§¦ä¸å…¶ä»–ç¥ç»å…ƒå½¢æˆ 1000 ä¸ªé“¾æ¥ã€‚</p>
</div>
<p>ç›®å‰çœ‹ï¼ŒGPT-3 çš„å‚æ•°ä¸ªæ•°å·²ç»å’Œäººè„‘çš„ç¥ç»å…ƒä¸ªæ•°é‡çº§ä¸€è‡´ï¼Œå¹¶ä¸”ä»ç›®å‰çœ‹ï¼ŒGPT-3 ä¹Ÿå‡ºç°äº†å¾ˆå¤šçš„â€œæ¶Œç°èƒ½åŠ›â€<sup class="footnote-ref"><a href="#fn10" id="fnref10">[10]</a></sup>ã€‚éšç€å‚æ•°ä¸ªæ•°çš„ä¸æ–­å¢å¤§ï¼Œç±»ä¼¼ GPT çš„ LLMs æ˜¯å¦èƒ½å¤Ÿè¿›åŒ–å‡ºæ›´å¤šç±»äººçš„èƒ½åŠ›ä¹Ÿä¸æ˜¯ä¸€ä»¶ä¸å¯èƒ½çš„äº‹æƒ…ã€‚åœ¨æœªæ¥ç›¸å½“é•¿çš„ä¸€æ®µæ—¶é—´å†…ï¼ŒLLMs çš„å‘å±•æ˜¯å¦ä¼šè¶…å‡ºäººç±»çš„æ§åˆ¶ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ä»¶æ— æ³•é¢„çŸ¥çš„äº‹æƒ…ã€‚</p>
<p>æ­£å¦‚ 20 ä¸–çºªï¼Œäººä»¬å¾ˆæ‹…å¿ƒè¢«æœºå™¨å–è€Œä»£ä¹‹ã€‚å¦‚ä»Šï¼Œæ›´å¤šçš„äººå¼€å§‹ç„¦è™‘ï¼šæˆ‘ä»¬æ˜¯å¦ä¼šè¢« LLMs å–ä»£ï¼Ÿ</p>
<p>æ— è®ºå¦‚ä½•ï¼Œæœªæ¥å·²æ¥ï¼ŒLLMs çš„å­˜åœ¨ä¸å‘å±•ï¼Œå¯¹æ‰€æœ‰äººè€Œè¨€ï¼Œæ˜¯å¸¦æ¥ä¸ç¡®å®šæ€§ä¸ç„¦è™‘çš„æŒ‘æˆ˜ï¼Œæ›´æ˜¯å€¼å¾—å»æ·±æ€ï¼Œå¯ä»¥å»æ‹¥æŠ±ï¼Œç»™ä¸å¤©ç”Ÿä¼šä½¿ç”¨å·¥å…·çš„äººç±»ä»¥åŠ©åŠ›çš„è«å¤§æœºé‡ä¸æ³•å®ã€‚</p>
<p>ä½œä¸ºä¸€åæ™®é€šçš„å·¥ç¨‹å¸ˆï¼Œé¢å¯¹è¿™ç§â€œä¸ç¡®å®šæ€§â€ï¼Œä¸å…¶ç„¦è™‘ï¼Œä¸å¦‚ç›¸æ—¶è€ŒåŠ¨ï¼Œåˆ©ç”¨å¥½ LLMs èµ‹äºˆçš„åŠ›é‡ï¼ŒæŒ–æ˜è‡ªå·±æ— å°½çš„æ½œèƒ½ï¼Œæˆä¸ºç§‘æŠ€æµªæ½®çš„å¼„æ½®å„¿ã€‚</p>
<p>æˆ‘ä»¬è¦å¼€å§‹å­¦ç€å’Œ LLMs ä¸ºä¼ï¼Œæˆ‘ä»¬è¦å¼€å§‹å­¦ç€æ€ä¹ˆè®© LLMs å¸®åŠ©æˆ‘ä»¬å®Œæˆå„ç§ä¹‹å‰ä¸å¯èƒ½å®Œæˆçš„äº‹æƒ…ï¼Œæå‡æˆ‘ä»¬çš„æ•ˆç‡ã€‚</p>
<p>å°¤å…¶æ˜¯å¯¹äºå¹´è½»ä¸€ä»£ï¼Œæˆ–è€…å¯¹äºé‚£äº›åˆšåˆšæ­¥å…¥æœ‰éå¸¸å¤§çš„æŠ€æœ¯é—¨æ§›çš„è¡Œä¸šçš„æ–°äººæ¥è¯´ï¼ŒLLMs ä¼šèµ‹äºˆæˆ‘ä»¬æ›´å¼ºå¤§çš„æŠ€æœ¯åŸºç¡€èƒ½åŠ›ã€‚å¯¹äºæˆ‘ä»¬è€Œè¨€ï¼ŒLLMs çš„åŠ æŒï¼Œå¯ä»¥è®©æˆ‘ä»¬éå¸¸è½»æ¾çš„å…·å¤‡ä¹‹å‰éœ€è¦é•¿æ—¶é—´æ‰èƒ½ç§¯ç´¯èµ·æ¥çš„æŠ€æœ¯é—¨æ§›ï¼Œå¯ä»¥å¿«é€Ÿæ‰“å¹³æˆ‘ä»¬å’Œè¿™ä¸ªè¡Œä¸šã€é¢†åŸŸçš„ç‰›äººä¹‹é—´çš„æŠ€æœ¯å·®è·ã€‚</p>
<p>å› æ­¤ï¼Œåœ¨æˆ‘çœ‹æ¥ï¼ŒLLMs å¯¹äºå¹´è½»äººè€Œè¨€å…·æœ‰éå¸¸å¤§çš„ä¼˜åŠ¿ï¼Œæ˜¯å¹´è½»äººå¼¯é“è¶…è½¦çš„å¼ºå¤§æ³•å®ã€‚</p>
<p>æœªæ¥ï¼ŒLLMs ä¹Ÿè®¸ä¼šå…·å¤‡ç‹¬ç«‹çš„æ„è¯†å¹¶ä¸”å„é¡¹èƒ½åŠ›å®Œå…¨è¶…è¶Šäººç±»ã€‚é‚£æ—¶ï¼Œæˆ‘ä»¬è¿˜éœ€è¦è€ƒè™‘â€œæœºå™¨æ˜¯å¦ä¼šæ‘†è„±äººçš„æ§åˆ¶â€ã€â€œäººä¸ LLMs å¦‚ä½•å…±ç”Ÿâ€ç­‰ä¸€ç³»åˆ—é—®é¢˜â€¦â€¦</p>
<p>è¿‡å»å¿ƒä¸å¯å¾—ï¼Œæœªæ¥å¿ƒä¸å¯å¾—ï¼Œå”¯ä¸€éœ€è¦åšçš„å°±æ˜¯æŠ“ä½ LLMs çš„æœºä¼šï¼Œé è¿‘ä»–ã€ç ”ç©¶ä»–ã€ä½¿ç”¨ä»–ã€‚</p>
<h2 id="å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</h2>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p><a href="https://seo.ai/blog/chatgpt-user-statistics-facts">ChatGPT User Statistics &amp; Facts (100 million users reached in January 2023)</a> <a href="#fnref1" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn2" class="footnote-item"><p><a href="https://help.openai.com/en/articles/6825453-chatgpt-release-notes">ChatGPT â€” Release Notes</a> <a href="#fnref2" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn3" class="footnote-item"><p><a href="https://www.demandsage.com/chatgpt-statistics/">ChatGPT Statistics for 2023 (New Data + GPT-4 Facts)</a> <a href="#fnref3" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn4" class="footnote-item"><p><a href="https://baijiahao.baidu.com/s?id=1759507457489651193&amp;wfr=spider&amp;for=pc">å…³äº6Gã€ChatGPTï¼Œå…¨å›½ä¸¤ä¼šé¦–åœºâ€œéƒ¨é•¿é€šé“â€æœ€æ–°å›åº”</a> <a href="#fnref4" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn5" class="footnote-item"><p><a href="https://baijiahao.baidu.com/s?id=1759897401604443186&amp;wfr=spider&amp;for=pc">ä¸¤ä¼šä¸‰äººè°ˆä¸¨ChatGPTæ˜¯ä¸€åœºâ€œè™šç«â€è¿˜æ˜¯é¢ è¦†æ€§æŠ€æœ¯é©å‘½ï¼Ÿ</a> <a href="#fnref5" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn6" class="footnote-item"><p><a href="https://github.blog/2022-09-07-research-quantifying-github-copilots-impact-on-developer-productivity-and-happiness/">Research: quantifying GitHub Copilotâ€™s impact on developer productivity and happiness</a> <a href="#fnref6" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn7" class="footnote-item"><p><a href="https://study.com/resources/perceptions-of-chatgpt-in-schools">Productive Teaching Tool or Innovative Cheating?</a> <a href="#fnref7" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn8" class="footnote-item"><p><a href="https://arxiv.org/abs/2303.10130">GPTs are GPTs: An early look at the labor market impact potential of large language models</a> <a href="#fnref8" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn9" class="footnote-item"><p><a href="https://arxiv.org/abs/2303.08774">GPT-4 Technical Report</a> <a href="#fnref9" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn10" class="footnote-item"><p><a href="https://arxiv.org/abs/2206.07682">Emergent Abilities of Large Language Models</a> <a href="#fnref10" class="footnote-backref">â†©ï¸</a></p>
</li>
</ol>
</section>
]]></content>
      <categories>
        <category>LLM</category>
      </categories>
      <tags>
        <tag>OpenAI</tag>
        <tag>ChatGPT</tag>
      </tags>
  </entry>
  <entry>
    <title>FFmpegæ»¤é•œä¸­çš„å¤šçº¿ç¨‹è®¡ç®—</title>
    <url>/2023/03/01/multithreading-operation-in-ffmpeg-filters/</url>
    <content><![CDATA[<p><img src="/2023/03/01/multithreading-operation-in-ffmpeg-filters/1.png" alt></p>
<p>åœ¨å›¾åƒå¤„ç†ä¸­ï¼Œå¯ä»¥é€šè¿‡æ»¤é•œæ¥å®ç°å¤šç§å¤šæ ·çš„å›¾åƒç‰¹æ®Šæ•ˆæœã€‚åŒæ ·çš„ï¼Œåœ¨è§†é¢‘å¤„ç†ä¸­ï¼Œæ»¤é•œçš„æ¦‚å¿µä¹ŸåŸºæœ¬ç›¸ä¼¼â€”â€”æ»¤é•œæŒ‡çš„æ˜¯åœ¨ç¼–ç ä¹‹å‰é’ˆå¯¹è§£ç å™¨è§£ç å‡ºæ¥çš„åŸå§‹æ•°æ®ï¼ˆå³éŸ³è§†é¢‘å¸§ï¼‰è¿›è¡Œå¤„ç†çš„åŠ¨ä½œã€‚</p>
<span id="more"></span>
<h2 id="1-ffmpeg-æ»¤é•œçš„åŸºæœ¬æ¦‚å¿µ">1. FFmpeg æ»¤é•œçš„åŸºæœ¬æ¦‚å¿µ</h2>
<p>FFmpeg é€šè¿‡ libavfilter åº“æ¥å®ç°æ»¤é•œçš„åŠŸèƒ½ï¼Œå¹¶ä¸”åœ¨ FFmpeg ä¸­ï¼Œå¯ä»¥é€šè¿‡æ»¤é•œæ¥å¯¹è¾“å…¥è§†é¢‘è¿›è¡Œå„ç§å„æ ·çš„å¤„ç†ã€‚</p>
<p>FFmpegä¸­ï¼Œæ»¤é•œçš„å¤„ç†ä½ç½®å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="/2023/03/01/multithreading-operation-in-ffmpeg-filters/2.png" alt></p>
<p>ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬è¦å¯¹ä¸€ä¸ªè§†é¢‘ä»ä¸­é—´éƒ¨åˆ†è¿›è¡Œâ€œé•œåƒâ€æ“ä½œï¼Œåˆ™å¯ä»¥ç”¨å¦‚ä¸‹çš„â€œæ»¤é•œé“¾â€æ¥å®ç°ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">                [main]</span><br><span class="line">input --&gt; split ---------------------&gt; overlay --&gt; output</span><br><span class="line">            |                             ^</span><br><span class="line">            |[tmp]                  [flip]|</span><br><span class="line">            |                             |</span><br><span class="line">            +-----&gt; crop --&gt; vflip -------+</span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™ä¸ªâ€œæ»¤é•œé“¾â€å›¾ä¸­ï¼Œåˆ©ç”¨ <code>split</code> æ»¤é•œæŠŠè¾“å…¥æµåˆ†ç¦»æˆäº†ä¸¤è·¯æµï¼Œå…¶ä¸­ä¸€è·¯é€šè¿‡ <code>crop</code> æ»¤é•œå’Œ <code>vfilp</code> æ»¤é•œçš„åŒä¸€è·¯çº§è”åº”ç”¨ï¼Œå†åŒå¦å¤–ä¸€è·¯ä¸€èµ·é€šè¿‡ <code>overlay</code> æ»¤é•œå¤„ç†çš„æµåˆæˆå¹¶è¾“å‡ºæœ€ç»ˆå¤„ç†ä¹‹åçš„è§†é¢‘ã€‚</p>
<p>å¦‚ä¸Šæ“ä½œå¯¹åº”çš„ FFmpeg å‘½ä»¤å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ffmpeg -i INPUT -vf &quot;split [main][tmp]; [tmp] crop=iw:ih/2:0:0, vflip [flip]; [main][flip] overlay=0:H/2&quot; OUTPUT</span><br></pre></td></tr></table></figure>
<p>æ›´è¯¦ç»†çš„ FFmpeg æ»¤é•œçš„ç›¸å…³å†…å®¹å¯ä»¥å‚è€ƒ <a href="http://ffmpeg.org/ffmpeg-filters.html">FFmpeg Filters Documentation</a>ã€‚</p>
<h2 id="2-ffmpeg-æ»¤é•œå¼€å‘ç®€ä»‹">2. FFmpeg æ»¤é•œå¼€å‘ç®€ä»‹</h2>
<p>æ ¹æ® <a href="https://trac.ffmpeg.org/wiki/FilteringGuide">FFmpeg Filtering Guide</a>ï¼Œå¯ä»¥åœ¨ <a href="https://wiki.multimedia.cx/index.php/FFmpeg_filter_HOWTO">FFmpeg filter HOWTO</a> çš„å¸®åŠ©ä¸‹æ¥ç¼–å†™ FFmpeg æ»¤é•œï¼Œä¸º FFmpeg å¢åŠ æ–°çš„èƒ½åŠ›ã€‚</p>
<p>ä½†æ˜¯ï¼Œæ ¹æ®ä¸ªäººç»éªŒï¼Œåœ¨å¼€å‘æ»¤é•œæ—¶ï¼Œæˆ‘æ›´å»ºè®®æŠŠ <a href="https://github.com/FFmpeg/FFmpeg/blob/master/doc/writing_filters.txt">FFmpeg/doc/writing_filters.txt</a> ä½œä¸ºæ»¤é•œå¼€å‘æŒ‡å—ã€‚</p>
<h2 id="3-å¤šçº¿ç¨‹æ»¤é•œå¼€å‘">3. å¤šçº¿ç¨‹æ»¤é•œå¼€å‘</h2>
<p>FFmpeg æ»¤é•œä¼šæ¶‰åŠåˆ°å¤§é‡çš„è®¡ç®—ï¼Œå› æ­¤ï¼Œå¦‚æœå¯ä»¥é‡‡ç”¨å¤šçº¿ç¨‹çš„æ–¹å¼æ¥åŠ é€Ÿæ»¤é•œçš„è®¡ç®—ï¼Œå¯¹äºæœ‰æ•ˆç‡è¦æ±‚çš„åœºæ™¯è€Œè¨€å°†æ˜¯ä¸€å¤§ç¦éŸ³ã€‚</p>
<p>æ ¹æ® <a href="https://github.com/FFmpeg/FFmpeg/blob/master/doc/writing_filters.txt">FFmpeg/doc/writing_filters.txt</a> çš„è¯´æ˜ï¼Œåˆ°ç›®å‰ä¸ºæ­¢ï¼Œå¯¹äºæ»¤é•œè€Œè¨€ï¼ŒFFmpeg ä»…æ”¯æŒ <code>slice-çº§åˆ«</code>å¤šçº¿ç¨‹ï¼ˆè¿˜ä¸æ”¯æŒ<code>å¸§-çº§åˆ«</code>å¤šçº¿ç¨‹ï¼‰ã€‚</p>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition note"><p class="admonition-title">slice åŸºæœ¬æ¦‚å¿µ
</p><p><img src="/2023/03/01/multithreading-operation-in-ffmpeg-filters/3.jpeg" alt>
<br> å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œåœ¨æ»¤é•œè®¡ç®—è¿‡ç¨‹ä¸­ï¼Œè§†é¢‘å¸§è¢«åˆ†å‰²æˆè‹¥å¹²å•ç‹¬çš„ <code>slice(åˆ‡ç‰‡)</code>ï¼Œä¸åŒçš„ <code>slice</code> å¯ä»¥åŒæ—¶å¹¶è¡Œæ‰§è¡Œæ»¤é•œæ“ä½œã€‚</p>
<p>å®é™…ä¸Šï¼Œåœ¨è®¡ç®—è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥ç®€å•çš„æŠŠ <code>slice</code> ç†è§£ä¸ºç”±å¤šè¡Œæ„æˆçš„å¸§æ•°æ®ã€‚å› æ­¤ï¼Œ<code>slice-çº§åˆ«</code> çš„å¤šçº¿ç¨‹å®é™…ä¸Šå°±æ˜¯æŒ‰è¡Œå°†å›¾åƒæ‹†åˆ†ä¸ºå¤šä¸ª <code>slice</code>ï¼Œç„¶åå¤šä¸ª <code>slice</code> ä¹‹é—´å¹¶è¡Œæ‰§è¡Œæ»¤é•œè®¡ç®—ã€‚</p>
</div>
<h3 id="3-1-slice-åˆ†å‰²">3.1 slice åˆ†å‰²</h3>
<p>å¯¹äºå•çº¿ç¨‹çš„æ»¤é•œæ“ä½œï¼Œæ•´ä½“ä»£ç å®ç°å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ......</span></span><br><span class="line"><span class="keyword">for</span> (y = <span class="number">0</span>; y &lt; inlink-&gt;h; y++) &#123;</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; x &lt; inlink-&gt;w; x++) &#123;</span><br><span class="line">        dst[x] = foobar(src[x]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ......</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸ºäº†ä½¿å¦‚ä¸Šçš„ä»£ç å¯ä»¥è¿›è¡Œ <code>slice-çº§åˆ«</code> çš„å¹¶è¡Œè®¡ç®—ï¼Œéœ€è¦åšå¦‚ä¸‹çš„ä¿®æ”¹ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ......</span></span><br><span class="line"><span class="keyword">for</span> (y = slice_start; y &lt; slice_end; y++) &#123;</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">0</span>; x &lt; inlink-&gt;w; x++) &#123;</span><br><span class="line">        dst[x] = foobar(src[x]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ......</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­ï¼Œ<code>slice_start</code>ï¼Œ<code>slice_end</code> åœ¨å›è°ƒå‡½æ•° <code>avfilter_action_func</code> ä¸­æ ¹æ®çº¿ç¨‹çš„æ•°é‡æ¥å®šä¹‰ï¼Œä¸€èˆ¬è€Œè¨€ï¼Œå…¶å®šä¹‰çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> slice_start = (in-&gt;height *  jobnr     ) / nb_jobs;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> slice_end   = (in-&gt;height * (jobnr + <span class="number">1</span>)) / nb_jobs;</span><br></pre></td></tr></table></figure>
<h3 id="3-2-å®šä¹‰-threaddata">3.2 å®šä¹‰ ThreadData</h3>
<p><code>avfilter_action_func</code> çš„å®šä¹‰ä½äº <a href="https://github.com/FFmpeg/FFmpeg/blob/master/libavfilter/avfilter.h">libavfilter/avfilter.h</a> ä¸­ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * A function pointer passed to the @ref AVFilterGraph.execute callback to be</span></span><br><span class="line"><span class="comment"> * executed multiple times, possibly in parallel.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * @param ctx the filter context the job belongs to</span></span><br><span class="line"><span class="comment"> * @param arg an opaque parameter passed through from @ref</span></span><br><span class="line"><span class="comment"> *            AVFilterGraph.execute</span></span><br><span class="line"><span class="comment"> * @param jobnr the index of the job being executed</span></span><br><span class="line"><span class="comment"> * @param nb_jobs the total number of jobs</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * @return 0 on success, a negative AVERROR on error</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">int</span> <span class="params">(avfilter_action_func)</span><span class="params">(AVFilterContext *ctx, <span class="keyword">void</span> *arg, <span class="keyword">int</span> jobnr, <span class="keyword">int</span> nb_jobs)</span></span>;</span><br></pre></td></tr></table></figure>
<p>æ ¹æ®å¦‚ä¸Šçš„æ–‡æ¡£å¯çŸ¥ï¼Œä¸ºäº†ä½¿å¾— <code>avfilter_action_func</code> å¯ä»¥å¹¶è¡Œæ‰§è¡Œï¼Œéœ€è¦é€šè¿‡ <code>arg</code> å‚æ•°å°†æ»¤é•œæ‰§è¡Œéœ€è¦çš„æ•°æ®ä¼ é€’åˆ°å›è°ƒå‡½æ•°ä¸­ã€‚ä¸€èˆ¬è€Œè¨€ï¼Œå¯ä»¥é€šè¿‡å®šä¹‰ä¸€ä¸ª <code>ThreadData</code> çš„ç»“æ„æ¥æ‰“åŒ…æ»¤é•œè®¡ç®—æ‰€éœ€è¦çš„ä¿¡æ¯ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">ThreadData</span> &#123;</span></span><br><span class="line">    AVFrame *in, *out;</span><br><span class="line">    <span class="comment">// ......</span></span><br><span class="line">&#125; ThreadData;</span><br></pre></td></tr></table></figure>
<h3 id="3-3-ä¿®æ”¹-filter-frame">3.3 ä¿®æ”¹ filter_frame</h3>
<p>æœ€åï¼Œåœ¨ <code>filter_frame()</code> ä¸­ï¼Œæˆ‘ä»¬éœ€è¦è°ƒç”¨ <code>threading distributor</code> ä»¥å®ç°æ»¤é•œçš„å¹¶è¡Œæ‰§è¡Œã€‚</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">ThreadData td;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">td.in  = in;</span><br><span class="line">td.out = out;</span><br><span class="line"></span><br><span class="line">ff_filter_execute(ctx, filter_slice, &amp;td, <span class="literal">NULL</span>, FFMIN(outlink-&gt;h, ff_filter_get_nb_threads(ctx)));</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br></pre></td></tr></table></figure>
<h3 id="3-4-ä¿®æ”¹-avfilter-flags">3.4 ä¿®æ”¹ AVFilter.flags</h3>
<p>åˆ°æ­¤ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»è®©æ»¤é•œå…·å¤‡çš„å¤šçº¿ç¨‹å¹¶è¡Œæ‰§è¡Œçš„èƒ½åŠ›ï¼Œä½†æ˜¯ä¸ºäº†èƒ½å¤Ÿå®ç°å¹¶è¡Œè®¡ç®—çš„èƒ½åŠ›ï¼Œæˆ‘ä»¬è¿˜è¦ä¿®æ”¹ <code>AVFilter.flags</code>ï¼Œå¹¶ä¸ºå…¶å¢åŠ  <code>AVFILTER_FLAG_SLICE_THREADS</code> å±æ€§ã€‚</p>
<p>åœ¨ <a href="https://github.com/FFmpeg/FFmpeg/blob/master/libavfilter/avfilter.h">libavfilter/avfilter.h</a> ä¸­ï¼Œ<code>AVFILTER_FLAG_SLICE_THREADS</code> çš„å®šä¹‰å¦‚ä¸‹ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The filter supports multithreading by splitting frames </span></span><br><span class="line"><span class="comment"> * into multiple parts and processing them concurrently.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AVFILTER_FLAG_SLICE_THREADS         (1 &lt;&lt; 2)</span></span><br></pre></td></tr></table></figure>
<h2 id="4-å¤šçº¿ç¨‹æ»¤é•œ-demo">4. å¤šçº¿ç¨‹æ»¤é•œ Demo</h2>
<p>åœ¨ <a href="https://github.com/wangwei1237/wangwei1237.github.io/blob/master/2023/03/01/multithreading-operation-in-ffmpeg-filters/vf_ms.c">vf_ms.c</a> ä¸­ï¼Œæˆ‘ä»¬å®ç°äº†ä¸€ä¸ªç®€å•çš„æ»¤é•œï¼Œè¯¥æ»¤é•œä»…æä¾›äº†ä¸€ä¸ªå‚æ•°ï¼ˆ<code>ms</code>ï¼‰ç”¨æ¥æ§åˆ¶æ˜¯å¦å¯ç”¨å¤šçº¿ç¨‹ã€‚</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> ffmpeg -<span class="built_in">help</span> filter=ms</span></span><br><span class="line"></span><br><span class="line">Filter ms</span><br><span class="line">  Test for the multithreading filter.</span><br><span class="line">    slice threading supported</span><br><span class="line">    Inputs:</span><br><span class="line">       #0: default (video)</span><br><span class="line">    Outputs:</span><br><span class="line">       #0: default (video)</span><br><span class="line">ms AVOptions:</span><br><span class="line">   ms                &lt;boolean&gt;    ..FV....... Multithreading or not (default false)</span><br></pre></td></tr></table></figure>
<p>åœ¨ç›¸åŒçš„æœºå™¨ä¸Šå¯¹å¦‚ä¸Šæ»¤é•œè¿›è¡Œæµ‹è¯•ï¼Œåœ¨ä¸å¼€å¯å¤šçº¿ç¨‹çš„æƒ…å†µä¸‹ï¼Œå…¶æ€§èƒ½å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> ffmpeg -i ./test.mp4 -vf ms=ms=0 -f null -</span></span><br><span class="line"></span><br><span class="line">frame= 2455 fps= 88 q=-0.0 Lsize=N/A time=00:01:43.12 bitrate=N/A speed=3.71x</span><br></pre></td></tr></table></figure>
<p>åœ¨å¼€å¯å¤šçº¿ç¨‹æ—¶ï¼Œå…¶æ€§èƒ½å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> ffmpeg -i ./test.mp4 -vf ms=ms=1 -f null -</span></span><br><span class="line"></span><br><span class="line">frame= 2455 fps= 97 q=-0.0 Lsize=N/A time=00:01:43.12 bitrate=N/A speed=4.07x</span><br></pre></td></tr></table></figure>
<p>å½“ç„¶ï¼Œå¦‚ä¸Šçš„æµ‹è¯•ä¸æ˜¯ä¸€ä¸ªä¸¥æ ¼çš„æµ‹è¯•è¿‡ç¨‹ï¼Œå› æ­¤å¹¶ä¸èƒ½ç”¨è¯¥æµ‹è¯•æ¥è¯æ˜å¯ç”¨å¤šçº¿ç¨‹å°±ä¸€å®šèƒ½æå‡æ»¤é•œçš„æ€§èƒ½ã€‚ä½†æ˜¯ï¼Œä»å¦‚ä¸Šçš„å¯¹æ¯”å¯çŸ¥ï¼Œå¼€å¯å¤šçº¿ç¨‹è®¡ç®—æ—¶ï¼Œé’ˆå¯¹è¯¥æ»¤é•œç®—æ³•ï¼Œå…¶æ€§èƒ½å¤§æ¦‚æœ‰ 10% å·¦å³çš„æå‡ã€‚</p>
]]></content>
      <categories>
        <category>è§†é¢‘æŠ€æœ¯</category>
      </categories>
      <tags>
        <tag>FFmpeg</tag>
        <tag>å¤šçº¿ç¨‹</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€Œåº¦çŸ¥äº†ã€ä½¿ç”¨æŒ‡å—</title>
    <url>/2023/02/13/duzhiliao/</url>
    <content><![CDATA[<h2 id="ç”»è´¨è¯„æµ‹åˆ©å™¨-åº¦çŸ¥äº†">ç”»è´¨è¯„æµ‹åˆ©å™¨â€”â€”åº¦çŸ¥äº†</h2>
<p>ç»è¿‡ 2 å¹´å¤šçš„æ‰“ç£¨ï¼Œç»å†è¿‘ 5000+ ä¸»è§‚è¯„ä¼°ï¼Œ400,000+ è¯„ä¼°æ ·æœ¬ï¼Œ1000+ è¯„æµ‹äººå‘˜ï¼ˆä¸“å®¶å’Œæ™®é€šç”¨æˆ·ï¼‰ï¼Œè¶Ÿè¿‡ä¸€ä¸ªåˆä¸€ä¸ªçš„å‘ï¼Œåˆ©ç”¨æŠ€æœ¯è§£å†³å®é™…è¯„æµ‹ä¸­é‡åˆ°çš„ä¸€ä¸ªåˆä¸€ä¸ªçš„ä¸ç½®ä¿¡å› ç´ ï¼Œé«˜æ•ˆçš„è§†é¢‘ç”»è´¨è¯„ä¼°ç³»ç»Ÿã€åº¦çŸ¥äº†ã€ç»ˆäºè¿æ¥é¢ä¸–ã€‚</p>
<p>åº¦çŸ¥äº†åŸºäº ITU æ ‡å‡†ï¼Œä¾æ‰˜è‡ªç ”çš„ 10+ é¡¹ä¸“åˆ©æŠ€æœ¯ï¼Œåœ¨ä¸æ–­å®è·µçš„åŸºç¡€ä¹‹ä¸Šè€Œå½¢æˆçš„ä¸€æ¬¾æ”¯æŒå¤šç«¯ï¼ˆPCï¼ŒAndroidï¼ŒiOSï¼‰è¯„æµ‹çš„è§†é¢‘ç”»è´¨è¯„æµ‹æœåŠ¡ã€‚</p>
<span id="more"></span>
<p>æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»è‡ªç ”çš„ç”»è´¨è¯„æµ‹ç³»ç»Ÿã€åº¦çŸ¥äº†ã€çš„ä½¿ç”¨æ–¹å¼ï¼Œä»¥åŠæˆ‘ä»¬å¦‚ä½•åˆ©ç”¨åº¦çŸ¥äº†æ¥å®¢è§‚ã€ç½®ä¿¡ã€é«˜æ•ˆåœ°è¯„æµ‹è§†é¢‘ç”»è´¨ï¼Œè¿›è€Œæå‡ç”¨æˆ·ä½“éªŒã€‚</p>
<h2 id="è¯„æµ‹å…¥é—¨">è¯„æµ‹å…¥é—¨</h2>
<p>ä¸ºäº†æå‡è¯„æµ‹ç»“æœçš„ç½®ä¿¡åº¦ï¼Œæˆ‘ä»¬å‡†å¤‡äº†ä¸€äº›è¯„æµ‹æ ·ä¾‹ä¾›ç”¨æˆ·å‚è€ƒã€‚è¿™äº›æ ·ä¾‹å‡ä¸ºåœ¨ç”»è´¨ä¸Šå­˜åœ¨æ˜¾è‘—åŒºåˆ«çš„è§†é¢‘ï¼Œå°½ç®¡ä¸ªä½“æ„Ÿå—å­˜åœ¨å·®å¼‚ï¼Œä½†æ˜¯åœ¨è¿™äº›ç¤ºä¾‹è§†é¢‘ä¸Šæ˜¯å¯ä»¥è¾¾æˆå…±è¯†å’Œä¸€è‡´ç»“æœçš„ã€‚<br>
å…¶æ¬¡ï¼Œæˆ‘ä»¬ä¹Ÿå‡†å¤‡äº†ä¸€äº›æŒ‡å¯¼æ–‡æ¡£ï¼Œå¸®åŠ©ç”¨æˆ·å¿«é€Ÿå…¥é—¨ï¼Œäº†è§£ä¸€äº›è§†é¢‘ç”»è´¨ç›¸å…³çš„åŸºç¡€çŸ¥è¯†ã€‚<br>
<img src="/2023/02/13/duzhiliao/1-sample.png" alt></p>
<h2 id="ä¸€-å®‰è£…">ä¸€ã€å®‰è£…</h2>
<p>ç›®å‰ã€åº¦çŸ¥äº†ã€å·²ä¸Šæ¶å„å¤§å•†åº—åº”ç”¨å¸‚åœº</p>
<ul>
<li>å®‰å“ç«¯ï¼šåä¸ºåº”ç”¨å•†åº—ã€ç™¾åº¦æ‰‹æœºåŠ©æ‰‹ã€å°ç±³åº”ç”¨å•†åº—ã€oppoåº”ç”¨å•†åº—ã€vivoåº”ç”¨å•†åº—å¯ç›´æ¥æœç´¢ã€åº¦çŸ¥äº†ã€è¿›è¡Œå®‰è£…ã€‚</li>
<li>iosç«¯ï¼šApp storeæœç´¢ã€åº¦çŸ¥äº†ã€è¿›è¡Œå®‰è£…ã€‚</li>
</ul>
<h2 id="äºŒ-åˆ›å»ºä»»åŠ¡">äºŒã€åˆ›å»ºä»»åŠ¡</h2>
<h3 id="2-1-å¿«æ·åˆ›å»º">2.1 å¿«æ·åˆ›å»º</h3>
<p>å¯ä»¥é€šè¿‡å¦‚ä¸‹å›¾æŒ‡å¼•ä¸‰æ­¥å®ŒæˆAPPç«¯å¿«æ·åˆ›å»ºä¸€ä¸ªè¯„æµ‹ä»»åŠ¡<br>
<img src="/2023/02/13/duzhiliao/1_createTask.png" alt></p>
<!-- #### Step 1. ç‚¹å‡»é¦–é¡µä¸‹æ–¹+å·ï¼Œè¿›å…¥åˆ›å»ºä»»åŠ¡é¡µé¢
#### Step 2. å¦‚æœè¯„æµ‹ä»»åŠ¡æ— ä¿å¯†è¦æ±‚ï¼Œç‚¹å‡»ç¡®è®¤åˆ›å»ºå³å¯
#### Step 3. é€‰æ‹©æ¨¡æ¿ã€å¡«å†™æµ‹è¯•æ ·æœ¬åœ°å€ã€é€‰æ‹©å¯è§†èŒƒå›´åå®Œæˆåˆ›å»º -->
<p>ç¬¬ä¸‰æ­¥ä¸­è¦å¡«å†™çš„å†…å®¹å¦‚ä¸‹ï¼š</p>
<h4 id="1-é€‰æ‹©æ¨¡æ¿">1ï¼‰é€‰æ‹©æ¨¡æ¿</h4>
<p>ç›®å‰å¯é€‰çš„ä»»åŠ¡æ¨¡æ¿åŒ…æ‹¬ï¼šçŸ­è§†é¢‘ä¸»è§‚æŠ˜æŸå¯¹æŠ˜æŸï¼ˆå¦‚ä¸‹å›¾å·¦ï¼‰ã€å°è§†é¢‘ä¸»è§‚æŠ˜æŸå¯¹æŠ˜æŸï¼ˆå¦‚ä¸‹å›¾å³ï¼‰ã€‚å¯æ ¹æ®è¯„æµ‹æ ·æœ¬çš„è§†é¢‘ç±»å‹æŒ‰éœ€é€‰æ‹©ã€‚<br>
<img src="/2023/02/13/duzhiliao/2-template.png" alt></p>
<h4 id="2-è¯„æµ‹æ ·æœ¬åœ°å€">2ï¼‰è¯„æµ‹æ ·æœ¬åœ°å€</h4>
<p>æ­¤å¤„éœ€è¦ç»™å‡ºä¸€ä¸ªå¯è§£æçš„csvæ–‡ä»¶åœ°å€ï¼Œcsvæ–‡ä»¶å†…å®¹å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼Œç¬¬ä¸€è¡Œä¸è¿›è¡Œè§£æï¼Œå¯éšæ„å¡«å†™ï¼Œç¬¬äºŒè¡Œå¼€å§‹æ¯è¡Œä¸ºä¸€ç»„å¯¹æ¯”è§†é¢‘çš„åœ°å€ï¼Œå·¦è¾¹ä¸ºå‚è€ƒè§†é¢‘åœ°å€ï¼Œå³è¾¹ä¸ºå¯¹æ¯”è§†é¢‘åœ°å€ã€‚åœ¨è¯„æµ‹æ—¶æ¯ç»„è§†é¢‘ä¼šä»¥å·¦å³éšæœºçš„é¡ºåºå‘ˆç°ç»™ç”¨æˆ·ã€‚<br>
å‚è€ƒåœ°å€ï¼š<a href="http://bj.bcebos.com/baidu-rmb-video-cover-1/2022-9/1662380786685/480P-test.csv">http://bj.bcebos.com/baidu-rmb-video-cover-1/2022-9/1662380786685/480P-test.csv</a></p>
<!-- ![](3_csvDetail.png) -->
<table>
<thead>
<tr>
<th>url1</th>
<th>url2</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://video1.mp4">http://video1.mp4</a></td>
<td>http://video1_compared.mp4</td>
</tr>
<tr>
<td><a href="http://video2.mp4">http://video2.mp4</a></td>
<td>http://video2_compared.mp4</td>
</tr>
<tr>
<td><a href="http://video3.mp4">http://video3.mp4</a></td>
<td>http://video3_compared.mp4</td>
</tr>
</tbody>
</table>
<h4 id="3-å¯è§†èŒƒå›´">3ï¼‰å¯è§†èŒƒå›´</h4>
<p>å¦‚è¯„æµ‹ä»»åŠ¡æ— ä¿å¯†è¦æ±‚ï¼Œå¯ç›´æ¥é€‰æ‹©ã€æš‚æ— ã€‘ï¼Œç‚¹å‡»ã€ç¡®è®¤åˆ›å»ºã€‘æŒ‰é’®å®Œæˆåˆ›å»ºã€‚<br>
å¦‚æœä»»åŠ¡çš„ä¿å¯†è¦æ±‚è¾ƒé«˜ï¼Œå¯ç»§ç»­é€šè¿‡2.2åˆ›å»ºç”¨æˆ·éš”ç¦»çš„ä»»åŠ¡ã€‚</p>
<h3 id="2-2-ä»…äº§å“çº¿å†…ç”¨æˆ·å¯è§">2.2 ä»…äº§å“çº¿å†…ç”¨æˆ·å¯è§</h3>
<p>è€ƒè™‘åˆ°éƒ¨åˆ†è¯„æµ‹ä»»åŠ¡æ¶‰åŠåˆ°è§†é¢‘å†…å®¹ä¿å¯†ç­‰æƒ…å†µï¼Œæˆ‘ä»¬é€šè¿‡åˆ›å»ºäº§å“çº¿-é‚€è¯·å…¥ç»„çš„æ–¹å¼æ¥ä¿è¯æ­¤ç±»ä»»åŠ¡åªå¯¹ç»„å†…æˆå‘˜å¼€æ”¾ã€‚</p>
<h4 id="step-1-åˆ›å»ºäº§å“çº¿">Step 1. åˆ›å»ºäº§å“çº¿</h4>
<p>é€‰æ‹©åº•éƒ¨å¯¼èˆªæ ä¸­ã€æˆ‘çš„ã€‘é¡µé¢ï¼Œåˆ›å»ºäº§å“çº¿ä¸€æ ä¸­å¡«å†™æ–°ä¸šåŠ¡çº¿åç§°ï¼Œç‚¹å‡»ã€ç¡®è®¤åˆ›å»ºã€‘å°±å¯ä»¥ç”Ÿæˆæ–°çš„äº§å“çº¿å¹¶è‡ªåŠ¨åŠ å…¥åˆ°è¯¥äº§å“çº¿ä¸­ã€‚åŒæ—¶ä¼šç”Ÿæˆä¸€ä¸ª6ä½æ•°çš„é‚€è¯·ç ã€‚<br>
<img src="/2023/02/13/duzhiliao/5-createProduct.png" alt></p>
<h4 id="step-2-åˆ›å»ºåŒ…å«ç»„ç»‡çš„ä»»åŠ¡">Step 2. åˆ›å»ºåŒ…å«ç»„ç»‡çš„ä»»åŠ¡</h4>
<p>æŒ‰ç…§å¦‚ä¸‹å›¾æ‰€ç¤ºæ­¥éª¤ï¼Œåœ¨ã€é€‰æ‹©å¯è§†èŒƒå›´ã€‘ä¸€æ ä¸­é€‰æ‹©ä¸Šä¸€æ­¥åˆ›å»ºçš„äº§å“çº¿ï¼Œç‚¹å‡»ã€ç¡®è®¤åˆ›å»ºã€‘å³å¯åˆ›å»ºå‡ºåªå¯¹è¯¥äº§å“çº¿æˆå‘˜å¯è§çš„ä»»åŠ¡ã€‚<br>
<img src="/2023/02/13/duzhiliao/6-createTaskWithProduct.png" alt></p>
<h4 id="step-3-é‚€è¯·ç”¨æˆ·åŠ å…¥äº§å“çº¿">Step 3. é‚€è¯·ç”¨æˆ·åŠ å…¥äº§å“çº¿</h4>
<p>è¢«é‚€è¯·çš„ç”¨æˆ·åœ¨ã€æˆ‘çš„ã€‘é¡µé¢ã€åŠ å…¥äº§å“çº¿ã€‘ä¸€æ ä¸­ï¼Œè¾“å…¥ç»„ç»‡é‚€è¯·ç ï¼Œç‚¹å‡»ã€ç¡®è®¤åŠ å…¥ã€‘ï¼Œå³å¯åŠ å…¥åˆ°å¯¹åº”çš„äº§å“çº¿ä¸­ã€‚<br>
<img src="/2023/02/13/duzhiliao/10-joinGroup.jpg" alt></p>
<!-- ![](7-create.png) -->
<h2 id="ä¸‰-è¯„æµ‹ä»»åŠ¡">ä¸‰ã€è¯„æµ‹ä»»åŠ¡</h2>
<p>ç‚¹å‡»åº•å±‚å¯¼èˆªæ é€‰æ‹©ã€è§†é¢‘è¯„æµ‹ã€‘æˆ–ã€å›¾ç‰‡è¯„æµ‹ã€‘è¿›å…¥è¯„æµ‹åˆ—è¡¨é¡µï¼Œé€‰æ‹©ç›®æ ‡ä»»åŠ¡è¿›å…¥è¯„æµ‹ä»»åŠ¡çš„è¯´æ˜é¡µé¢ï¼Œè¯¥é¡µé¢è¯¦ç»†ä»‹ç»äº†è¯„ä¼°çš„æ³¨æ„äº‹é¡¹ã€æ‰“åˆ†çš„æ ‡å‡†ç­‰ä¿¡æ¯ã€‚ç‚¹å‡»ã€å»æµ‹è¯„ã€‘æŒ‰é’®ï¼Œè¿›å…¥è¯„æµ‹è¯¦æƒ…é¡µï¼Œé€æ¡æ‰“åˆ†ç›´è‡³æœ¬ç»„ä»»åŠ¡è¯„å®Œï¼Œå³å®Œæˆè¯„æµ‹ã€‚</p>
<!-- ![](8-startTask.png) -->
<p><img src="/2023/02/13/duzhiliao/9-startEvaluate.png" alt></p>
<h2 id="å››-ç»“æŸä»»åŠ¡åŠæŸ¥çœ‹ç»“æœ">å››ã€ç»“æŸä»»åŠ¡åŠæŸ¥çœ‹ç»“æœ</h2>
<p>åœ¨åˆ›å»ºçš„ä»»åŠ¡ä¸­å¯ä»¥å¯¹ç”¨æˆ·è¯„æµ‹ç»“æœè¿›è¡Œè®¡ç®—å’Œç»“æœæŸ¥çœ‹ï¼Œç‚¹å‡»ã€è®¡ç®—ã€‘ååå°ä¼šå¼€å§‹ç»Ÿè®¡ç”¨æˆ·çš„å¹³å‡MOSæ‰“åˆ†ï¼Œå½“æŒ‰é’®å˜æˆã€æŸ¥çœ‹ç»“æœã€‘æ—¶ï¼Œå³å¯ç‚¹å‡»æŸ¥çœ‹æ¯ä¸ªè§†é¢‘å¯¹åŠå¯¹åº”çš„MOSæ‰“åˆ†ã€‚<br>
<img src="/2023/02/13/duzhiliao/11-endTask.png" alt></p>
<p>å¯¹äºå¯¹æ¯”è§†é¢‘Bå’Œå‚è€ƒè§†é¢‘Aæ¯”è¾ƒå¾—åˆ°çš„ MOS åˆ†å’Œåˆ’åˆ†æ¡£æ¬¡å¯¹åº”å…³ç³»å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th>MOS</th>
<th>æ¡£ä½</th>
</tr>
</thead>
<tbody>
<tr>
<td>0-39</td>
<td>è´Ÿå‘</td>
</tr>
<tr>
<td>40-59</td>
<td>æŒå¹³</td>
</tr>
<tr>
<td>60-100</td>
<td>æ­£å‘</td>
</tr>
</tbody>
</table>
<h2 id="åº¦çŸ¥äº†appæ”¯æŒçš„è¯„æµ‹åœºæ™¯">åº¦çŸ¥äº†APPæ”¯æŒçš„è¯„æµ‹åœºæ™¯</h2>
<p>ä¸Šé¢ä»‹ç»äº†åœ¨åº¦çŸ¥äº†åˆ›å»ºä»»åŠ¡ã€è¯„æµ‹ã€æŸ¥çœ‹ç»“æœçš„æ•´ä¸ªæµç¨‹ï¼Œç›®å‰åº¦çŸ¥äº†å·²æ”¯æŒä¸°å¯Œçš„è¯„æµ‹åœºæ™¯å’Œå®Œå¤‡çš„è¯„æµ‹èƒ½åŠ›ï¼Œå…·ä½“èƒ½åŠ›å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th>èƒ½åŠ›é¡¹</th>
<th>åœºæ™¯è¯´æ˜</th>
<th>å¤‡æ³¨</th>
</tr>
</thead>
<tbody>
<tr>
<td>è®¾å¤‡&amp;ç»ˆç«¯</td>
<td>PCã€iOSã€Android</td>
<td></td>
</tr>
<tr>
<td>è¯„æµ‹æ ‡å‡†</td>
<td>ACRã€DCRã€CCR</td>
<td>CCR çš„è¯„ä¼°æ”¯æŒå·¦å³è§†é¢‘éšæœºæ··æ·†çš„èƒ½åŠ›</td>
</tr>
<tr>
<td>åª’ä½“ç±»å‹</td>
<td>è§†é¢‘ã€å›¾ç‰‡</td>
<td></td>
</tr>
<tr>
<td>è§†é¢‘æ ¼å¼-1</td>
<td>SDRã€HDR</td>
<td></td>
</tr>
<tr>
<td>è§†é¢‘æ ¼å¼-2</td>
<td>æ¨ªç‰ˆè§†é¢‘ã€ç«–ç‰ˆè§†é¢‘</td>
<td></td>
</tr>
<tr>
<td>ç»ˆç«¯æ˜¾ç¤º-1</td>
<td>æ¨ªç‰ˆè§†é¢‘16:9è§†çª—ã€æ¨ªç‰ˆè§†é¢‘3:2è§†çª—</td>
<td>æ¨ªç‰ˆè§†é¢‘çš„ä¸åŒè§†çª—æ”¯æŒï¼šACRï¼ŒDCRï¼ŒCCR</td>
</tr>
<tr>
<td>ç»ˆç«¯æ˜¾ç¤º-2</td>
<td>è§†é¢‘æ’­æ”¾æ¨¡å¼è¯„æµ‹ã€è§†é¢‘å•å¸§æ¨¡å¼è¯„æµ‹</td>
<td></td>
</tr>
<tr>
<td>ç»ˆç«¯æ˜¾ç¤º-3</td>
<td>åä¸ºé¸¿è’™ç³»ç»Ÿè§†é¢‘è¶…åˆ†èƒ½åŠ›ï¼šACRï¼ŒDCRï¼ŒCCR</td>
<td>CCR çš„è¯„ä¼°æ”¯æŒå·¦å³è§†é¢‘éšæœºæ··æ·†çš„èƒ½åŠ›</td>
</tr>
<tr>
<td>æ¨ªç‰ˆè§†é¢‘CCR å¯¹æ¯”æ–¹å¼</td>
<td>16:9 è§†çª—å•å±å¯¹æ¯”ã€3:2 è§†çª—å•å±å¯¹æ¯”ã€å…¨å±å·¦å³å¯¹æ¯”ã€å…¨å±å·¦å³æ»‘åŠ¨å¯¹æ¯”</td>
<td></td>
</tr>
<tr>
<td>ç«–ç‰ˆè§†é¢‘CCRå¯¹æ¯”æ–¹å¼</td>
<td>å…¨å±å·¦å³å¯¹æ¯”ã€å…¨å±æ‰‹åŠ¨åˆ‡æ¢å¯¹æ¯”</td>
<td></td>
</tr>
<tr>
<td>è¯„æµ‹æ–¹å¼</td>
<td>æ™®é€šç”¨æˆ·è¯„æµ‹ã€ä¸“å®¶å¤šç»´åº¦è¯„æµ‹</td>
<td></td>
</tr>
<tr>
<td>æ‰“åˆ†æ–¹å¼</td>
<td>5çº§æ‰“åˆ†ã€èµ„æºå¼‚å¸¸æ‰“åˆ†ã€å¤‡æ³¨ä¿¡æ¯ä¸ŠæŠ¥</td>
<td></td>
</tr>
</tbody>
</table>
<!-- çŸ­è§†é¢‘å¯¹æ¯”è¯„æµ‹ï¼š
![](4-1duanshipin.png) -->]]></content>
      <categories>
        <category>IVQA</category>
      </categories>
      <tags>
        <tag>è§†é¢‘è¯„æµ‹</tag>
        <tag>ç”»è´¨è¯„æµ‹</tag>
        <tag>åº¦çŸ¥äº†</tag>
      </tags>
  </entry>
  <entry>
    <title>å…³äºå¥èº«ï¼Œå…³äºå·¥ä½œ</title>
    <url>/2023/02/04/fitness-and-work/</url>
    <content><![CDATA[<p><img src="/2023/02/04/fitness-and-work/1.png" alt></p>
<blockquote>
<p>æ ¹æ® <a href="https://baijiahao.baidu.com/s?id=1748260598565473604">2022å¹´è½»äººæ½®æµå¥èº«æŠ¥å‘Š</a>ï¼Œæˆ‘ä»¬å‘ç°ï¼Œå¹´è½»äººå¼€å§‹ç›¸ä¿¡å¼€å§‹ç›¸ä¿¡ã€Œè¿åŠ¨å³æ­£ä¹‰ã€ï¼Œè¶Šæ¥è¶Šå¤šçš„å¹´è½»äººåŠ å…¥åˆ°å¥èº«çš„è¡Œåˆ—ä¸­ã€‚</p>
</blockquote>
<p>ä½œä¸ºä¸€é¡¹â€œåäººæ€§â€çš„è¿åŠ¨ï¼Œå‚ä¸çš„äººå¾ˆå¤šï¼Œé•¿ä¹…åšæŒçš„äººå¾ˆå°‘ã€‚æ®ç»Ÿè®¡ï¼Œå¥èº«æˆ¿ä¼šå‘˜ä¸­ï¼Œèƒ½åšæŒ 1 å¹´ä¸é—´æ–­å¥èº«çš„äººæ¯”ä¾‹ä¸º 1/150ï¼Œèƒ½åšæŒ 3 å¹´ä¸é—´æ–­å¥èº«çš„äººæ¯”ä¾‹ä¸º 1/1000ã€‚</p>
<p>ä½œä¸ºä¸€ä¸ªæƒ³å˜èƒ–çš„ç˜¦å­ï¼Œæˆ‘ä¹Ÿå¼€å¯äº†æˆ‘çš„å¥èº«ä¹‹æ—…ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæˆ‘æ…¢æ…¢çš„å‘ç°ï¼Œå¥èº«å’Œå·¥ä½œå…¶å®æœ‰äº›æ—¶å€™æ˜¯ç›¸é€šçš„ã€‚</p>
<span id="more"></span>
<h2 id="1-æ˜ç¡®å¥èº«ç›®æ ‡">1. æ˜ç¡®å¥èº«ç›®æ ‡</h2>
<p>å¥èº«è¦æœ‰ä¸€ä¸ªéå¸¸æ˜ç¡®çš„ã€å…·ä½“çš„ç›®æ ‡ï¼Œæ¯”å¦‚ï¼šå¢è‚Œã€å‡è„‚ï¼›ä¸èƒ½æ˜¯ï¼šå¢å¼ºä½“è´¨ã€æå‡æ°”è´¨ã€èˆ’ç¼“å‹åŠ›ç­‰è¿™äº›æ¯”è¾ƒæŠ½è±¡çš„æ¦‚å¿µã€‚</p>
<p>å¢è‚Œå’Œå‡è„‚çš„è¿åŠ¨æ–¹å¼å¹¶ä¸ä¸€è‡´ï¼Œè…¹è‚Œå’ŒèƒŒéƒ¨çš„è®­ç»ƒåŠ¨ä½œä¹Ÿä¸ä¸€æ ·ï¼Œå¦‚æœæ²¡æœ‰æ˜ç¡®çš„ç›®æ ‡ï¼Œå°±æ²¡åŠæ³•åˆ¶å®šåˆç†çš„è¿åŠ¨è®¡åˆ’ï¼Œä¹Ÿæ²¡åŠæ³•åœ¨è¿åŠ¨è¿‡ç¨‹ä¸­è·å¾—è¿åŠ¨çš„åé¦ˆä¿¡æ¯ï¼Œæ›´æ— æ³•æ„Ÿå—åˆ°è¿›æ­¥çš„å¿«ä¹ï¼Œæœ€ååªèƒ½æ˜¯ä¸äº†äº†ä¹‹ã€‚</p>
<p><img src="/2023/02/04/fitness-and-work/2.png" alt></p>
<p>æ¯”å¦‚å¢è‚Œå±äºä¸€ä¸ªç§‘å­¦æŠ—é˜»è®­ç»ƒçš„è¿‡ç¨‹ï¼Œå¢è‚Œéœ€è¦å¤§é‡çš„åŠ›é‡è®­ç»ƒï¼ˆå½“ç„¶ä¹Ÿéœ€è¦æ‘„å…¥æ›´å¤šå¡è·¯é‡Œå’Œè›‹ç™½è´¨ï¼‰ï¼Œä»¥æ­¤è¾¾åˆ°å¢åŠ è‚Œè‚‰é‡çš„ç›®çš„ï¼Œè®©è‡ªå·±çœ‹èµ·æ¥æ›´æœ‰åŠ›é‡æ„Ÿã€‚æ˜ç¡®å¢è‚Œçš„ç›®æ ‡åï¼Œéœ€è¦åˆ¶å®šä¸€ç³»åˆ—ç›¸å…³çš„äºŒçº§ç›®æ ‡ï¼šä½“é‡ã€ä½“è´¨ç‡ã€è‚Œè‚‰ç»´åº¦ã€æŠ—é˜»é‡é‡â€¦â€¦ï¼Œç„¶åæ ¹æ®è¿™äº›ç›®æ ‡åˆ¶å®šç›¸å…³çš„é˜»æŠ—è®­ç»ƒè®¡åˆ’ï¼Œæ¯”å¦‚ä¸‰åˆ†åŒ–ã€äº”åˆ†åŒ–ç­‰ã€‚</p>
<p>åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œå¯ä»¥éå¸¸æ–¹ä¾¿çš„æµ‹é‡è¿™äº›äºŒçº§ç›®æ ‡ï¼Œå› æ­¤èƒ½å¤Ÿå¿«é€Ÿå¾—åˆ°è¿åŠ¨åé¦ˆï¼Œå¹¶æ ¹æ®è¿™äº›åé¦ˆä¿¡æ¯æ¥åˆ¤æ–­è¿åŠ¨æ•ˆæœå’Œå¢è‚Œç›®æ ‡è¾¾æˆçš„æƒ…å†µï¼ŒåŒæ—¶è¿˜æ–¹ä¾¿æˆ‘ä»¬æ ¹æ®åé¦ˆä¿¡æ¯æ¥è°ƒæ•´è‡ªå·±çš„è¿åŠ¨è®¡åˆ’ï¼Œä»¥è¾¾åˆ°æ›´å¥½çš„æ•ˆæœã€‚</p>
<h2 id="2-æ³¨é‡ç†è®ºå­¦ä¹ ">2. æ³¨é‡ç†è®ºå­¦ä¹ </h2>
<p>å¥èº«ä¹‹å‰ï¼Œä¸€ç›´æœ‰ä¸ªæ€ç»´è¯¯åŒºï¼šé”»ç‚¼å˜›ï¼Œç»ƒå°±æ˜¯äº†ï¼Œä»€ä¹ˆå¢è‚Œï¼Œä»€ä¹ˆå‡è„‚ï¼ŒåŠ¨èµ·æ¥å°±è¡Œã€‚æ‰€ä»¥ï¼Œæœ€å¼€å§‹ï¼Œæˆ‘å°±ä¸€ç›´åœ¨è·‘æ­¥æœºä¸Šå¾…ç€ï¼Œç„¶åè·‘ç´¯äº†éšä¾¿æ‘†å¼„å‡ ä¸‹å…¶ä»–çš„å™¨æ¢°ï¼Œ1å¹´ä¸‹æ¥ï¼Œä½“é‡å°±æ˜¯æ²¡æœ‰å¢åŠ ã€‚</p>
<p>å®é™…ä¸Šï¼Œå¢è‚Œæ˜¯ä¸€é“å¤æ‚çš„æ•°å­¦é¢˜ã€‚å¯¹èº«ä½“è¿›è¡Œè‹¥å¹²è¾“å…¥ï¼Œå¾—åˆ°å¢è‚Œç›®æ ‡çš„è¾“å‡ºã€‚è¾“å…¥æ¶µç›–äº†è®­ç»ƒã€é¥®é£Ÿå’Œä¼‘æ¯ï¼Œä¼‘æ¯åŒ…æ‹¬äº†ç»„é—´ä¼‘æ¯ä¸ç¡çœ ï¼›è¾“å‡ºå°±æ˜¯ä½ æƒ³è¦è¾¾æˆçš„èº«æç›®æ ‡ã€‚å¯¹äºä¸¥æ ¼çš„è®­ç»ƒè€Œè¨€ï¼Œé”»ç‚¼ä»€ä¹ˆè‚Œç¾¤ï¼Œé‡‡ç”¨ä»€ä¹ˆåŠ¨ä½œï¼Œå¦‚ä½•å®‰æ’éœ€æ±‚ï¼Œå¦‚ä½•å®‰æ’é¥®é£Ÿç­‰éƒ½éœ€è¦è¿›è¡Œç²¾ç»†çš„è®¡ç®—ã€‚</p>
<p>å¢è‚Œåˆæ˜¯ä¸€é“å¤æ‚çš„ç‰©ç†é¢˜ï¼Œä¾‹å¦‚åšå“‘é“ƒå¼¯ä¸¾æ—¶ï¼Œå“‘é“ƒæŠŠæˆ‘ä»¬çš„è‚±äºŒå¤´è‚Œç”±ä¸­é—´å¾€ä¸¤ç«¯æ‹‰å¼€ï¼Œæ­¤æ—¶è‚Œè‚‰æ‰€æ‰¿å—çš„ â€œæœºæ¢°å¼ åŠ›â€ä¼šåˆºæ¿€èº«ä½“ï¼Œè¿›è€Œåˆæˆæ›´å¤šçš„è‚Œè›‹ç™½ã€‚</p>
<p>å› æ­¤ï¼Œä¸ºäº†è®©è¿åŠ¨æ•ˆæœæ›´é«˜æ•ˆï¼Œæˆ‘ä»¬è¿˜è¦äº†è§£å’Œå¥èº«ç›¸å…³çš„å…¶ä»–ç†è®ºï¼Œä¾‹å¦‚ï¼šè¿åŠ¨ç”Ÿç†å­¦ï¼Œè¿åŠ¨è§£å‰–å­¦ï¼Œäººä½“åŠ›å­¦ç­‰ï¼Œè¿™æ ·èƒ½å¤Ÿæœ€å¤§å¯èƒ½çš„åœ¨è¿åŠ¨è¿‡ç¨‹ä¸­åšåˆ°è¿åŠ¨ä¿æŠ¤ï¼Œå¦ä¸€æ–¹é¢æœ‰åˆ©äºæˆ‘ä»¬é€‰æ‹©æœ€é«˜æ•ˆçš„è®­ç»ƒåŠ¨ä½œã€‚</p>
<p>å¦åˆ™ï¼Œç›²ç›®åœ°å»å¥èº«ï¼Œä¸ä»…æ— æ³•è¾¾åˆ°å¥èº«ç›®æ ‡ï¼Œåè€ŒæŸä¼¤äº†è‡ªå·±çš„èº«ä½“å¥åº·ï¼Œç™½ç™½åœ°æµªè´¹äº†è‡ªå·±çš„æ—¶é—´å’Œç²¾åŠ›ã€‚</p>
<h2 id="3-å–„äºåˆä½œè®­ç»ƒ">3. å–„äºåˆä½œè®­ç»ƒ</h2>
<p>åœ¨å¥èº«è¿‡ç¨‹ä¸­ï¼Œé…åˆè®­ç»ƒæ˜¯å¯ä»¥è®©è‡ªå·±å¿«é€Ÿè¿›æ­¥çš„ä¸€ç§æœ‰æ•ˆæ–¹å¼ã€‚åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œè¶Šæ˜¯å¤§çš„è‚Œç¾¤ï¼Œä¾‹å¦‚èƒ¸éƒ¨è‚Œç¾¤ã€è…¿éƒ¨è‚Œç¾¤ï¼Œè¶Šæ˜¯éœ€è¦é…åˆè®­ç»ƒã€‚å’Œç‹¬è‡ªè®­ç»ƒç›¸æ¯”ï¼Œé…åˆè®­ç»ƒå¾€å¾€å¯ä»¥è¾¾åˆ°äº‹åŠåŠŸå€çš„æ•ˆæœï¼š</p>
<ul>
<li>å¥èº«æ­æ¡£çš„åŠ å…¥ï¼Œèƒ½å¤Ÿæ¿€èµ·æ‹¼æå¿ƒç†ï¼Œä»è€Œæ¿€å‘è‡ªå·±çš„è®­ç»ƒæ–—å¿—ã€‚</li>
<li>å¥èº«æ­æ¡£çš„è¾…åŠ©å¯ä»¥æ›´æœ‰æ•ˆçš„ä¿æŠ¤è‡ªå·±ï¼Œå°¤å…¶æ˜¯å¯¹äºå§æ¨è¿™ç§è¿åŠ¨ï¼Œæœ‰å¥èº«æ­æ¡£ï¼Œæˆ‘ä»¬ä¼šæ›´æœ‰å®‰å…¨æ„Ÿï¼Œä»è€Œå¯ä»¥æŒ‘æˆ˜æ›´å¤§çš„é‡é‡ã€‚</li>
<li>åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œå¥èº«æ­æ¡£å°±åƒç›‘æ§ä¸€æ ·ï¼Œå¯ä»¥çº æ­£æˆ‘ä»¬çš„é”™è¯¯åŠ¨ä½œï¼Œè®©æˆ‘ä»¬æ›´å¥½çš„å®Œæˆè®­ç»ƒåŠ¨ä½œã€‚</li>
</ul>
<p>åœ¨å¥èº«çš„è¿‡ç¨‹ä¸­ï¼Œå­¦ä¼šæˆä¸ºä¸€åä¼˜ç§€çš„å¥èº«æ­æ¡£å’Œå¥èº«ä¸€æ ·é‡è¦ã€‚ä¸è¦ä»¥ä¸ºè¾…åŠ©åˆ«äººè®­ç»ƒæ˜¯ä¸€ç§æµªè´¹æ—¶é—´çš„è¡Œä¸ºï¼Œæ­£æ‰€è°“ï¼šèµ äººç«ç‘°æ‰‹ç•™ä½™é¦™ã€‚ä½œä¸ºå¥èº«æ­æ¡£ï¼Œéœ€è¦äº†è§£å†ä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦ç»™äºˆè¾…åŠ©ï¼Œéœ€è¦ç»™äºˆæ€æ ·çš„è¾…åŠ©æ‰èƒ½å¸®åŠ©è®­ç»ƒè€…è·å¾—æœ€å¥½çš„æ•ˆæœã€‚åªæœ‰ä¸æ–­åœ°å¸®åŠ©åˆ«äººï¼Œå¸®åŠ©æ›´ä¼˜ç§€çš„äººï¼Œè‡ªå·±æ‰æœ‰å¯èƒ½å¾—åˆ°æ›´ä¼˜ç§€çš„äººçš„å¸®åŠ©ï¼Œè‡ªå·±çš„è¿›æ­¥ä¹Ÿæ‰ä¼šæ›´å¿«ã€‚å°é—­çš„ç‹¬è‡ªè®­ç»ƒï¼Œæ²¡æœ‰åé¦ˆï¼Œç¼ºä¹æŒ‘æˆ˜å’Œæ¿€åŠ±ï¼Œæˆé•¿ä¹Ÿä¼šæ›´æ…¢ã€‚</p>
<h2 id="4-æŒç»­è®­ç»ƒ">4. æŒç»­è®­ç»ƒ</h2>
<p>å¥èº«æ˜¯ä¸€ç§æŠ—é˜»è¿åŠ¨ï¼Œè¿™æ„æ„å‘³ç€å¥èº«ä¸æ˜¯äººä½“çš„èˆ’é€‚åŒºï¼Œå¥èº«æ›´æ˜¯ä¸€ä¸ªæŒç»­èµ°å‡ºèˆ’é€‚åŒºçš„è¿‡ç¨‹ã€‚<br>
è‡ªæˆ‘çœ‹æ¥ï¼Œå¥èº«æ˜¯æœ€å…¬å¹³çš„ä¸€ä»¶äº‹ï¼š</p>
<ul>
<li>æˆ‘ä»¬ä»˜å‡ºå¤šå°‘ï¼Œæ’’è¿‡å¤šå°‘æ±—æ°´ï¼Œæœ€ç»ˆéƒ½ä¼šä½“ç°åˆ°è‡ªå·±çš„èº«ä½“ä¸Šã€‚å³ä¾¿ä½ çš„æœ‹å‹å¯ä»¥åš20ä¸ªå¼•ä½“å‘ä¸Šï¼Œå¦‚æœä½ ä¸è¿åŠ¨èµ·æ¥ï¼Œä½ è¿˜æ˜¯ä¸å¯èƒ½å®Œæˆ20ä¸ªå¼•ä½“å‘ä¸Šã€‚</li>
<li>å¥èº«æ²¡æœ‰ä¸€åŠ³æ°¸é€¸ä¹‹è¯´ï¼Œå¥èº«ä¸ä¼šå…è®¸æˆ‘ä»¬ä»…ä¾é ä¹‹å‰çš„ç§¯ç´¯å°±èƒ½æ°¸è¿œä¿æŒä¹‹å‰çš„çŠ¶æ€ã€‚ä¸€æ—¦åœæ­¢å¥èº«ï¼Œå¥½ä¸å®¹æ˜“è®­ç»ƒå‡ºæ¥çš„è‚Œè‚‰å°±ä¼šæœ‰æ‰€é€€åŒ–ï¼Œç”šè‡³æ¶ˆå¤±ï¼Œå¤§æ¦‚3ä¸ªæœˆä¹‹åï¼ŒåŠªåŠ›è®­ç»ƒæ‰å¾—åˆ°çš„è‚Œè‚‰èº«æå°±ä¼šæ¶ˆå¤±ï¼Œæ­¤æ—¶ä¼šè·Ÿæ™®é€šäººä¸€æ ·ã€‚</li>
<li>å¯¹äºå¥èº«è€Œè¨€ï¼Œæ¯å¤©éƒ½æ˜¯æ–°çš„å¼€å§‹ï¼Œéƒ½éœ€è¦å¥‹èµ·æ‹¼æã€‚åœ¨å¤§è‰åŸä¸Šï¼Œä¸ç®¡æ˜¯ç‹®å­è¿˜æ˜¯ç¾šç¾Šï¼Œæ¯å½“å¤ªé˜³å‡èµ·çš„æ—¶å€™ï¼Œéƒ½å¿…é¡»å…¨åŠ›ä»¥èµ´å¼€å§‹å¥”è·‘ã€‚</li>
</ul>
<h2 id="5-é‡è§†roi">5. é‡è§†ROI</h2>
<p>å¥èº«ä¸æ˜¯ä¸€ç§æ—¶é—´æ¶ˆè€—çš„æ–¹å¼ï¼Œè€Œæ˜¯ä¸€ç§æŠ•èµ„ï¼Œå¯¹è‡ªæˆ‘èº«ä½“çš„æŠ•èµ„ã€‚æŠ•èµ„å°±éœ€è¦è€ƒè™‘ROIï¼Œå°±éœ€è¦å¦‚ä½•åœ¨æœ€çŸ­çš„æ—¶é—´å†…ï¼Œæ— é™çš„æ¥è¿‘ç”šè‡³è¶…è¿‡æˆ‘ä»¬çš„æ—¢å®šç›®æ ‡ã€‚</p>
<ul>
<li>æˆ‘ä»¬éœ€è¦ä¸æ–­åœ°æ€è€ƒï¼Œå¦‚ä½•æ‰èƒ½æ›´é«˜æ•ˆçš„è¾¾åˆ°å¥èº«çš„ç›®æ ‡ï¼Œéœ€è¦é‡‡ç”¨ä»€ä¹ˆåŠ¨ä½œï¼Œéœ€è¦å¦‚ä½•å®‰æ’é¥®é£Ÿï¼Œéœ€è¦ä»˜å‡ºä»€ä¹ˆ</li>
<li>æˆ‘ä»¬éœ€è¦è€ƒè™‘çš„éƒ½æ˜¯æˆ‘å¦‚ä½•èƒ½å¤Ÿåœ¨æ›´çŸ­çš„æ—¶é—´å†…å®Œæˆå¥èº«ç›®æ ‡ï¼Œè€Œä¸æ˜¯æˆ‘ä»Šå¤©è¦åšå¤šå°‘ä¸ªåŠ¨ä½œï¼Œè¿åŠ¨å¤šé•¿æ—¶é—´</li>
<li>æˆ‘ä»¬éœ€è¦åŸºäºç›®æ ‡å’Œæ”¶ç›Šæ¥é€‰æ‹©åŠ¨ä½œï¼Œæ¥åˆç†è§„åˆ’å’Œå®‰æ’è®­ç»ƒèŠ‚å¥</li>
<li>æˆ‘ä»¬æ›´å¤šçš„è¦è€ƒè™‘ä¸åŒåŠ¨ä½œçš„æ•ˆæœï¼Œè€Œä¸æ˜¯æ¯å¤©ç»ƒä¹ å¾ˆå¤šçœ‹èµ·æ¥æ¯”è¾ƒåä¸½çš„åŠ¨ä½œ</li>
</ul>
<h2 id="6-å›¢é˜Ÿé¡¹ç›®é‡è§†é…åˆ">6. å›¢é˜Ÿé¡¹ç›®é‡è§†é…åˆ</h2>
<p>2022å¹´ï¼Œå°¤é‡‘ä¸–é”¦èµ›4x100æ¥åŠ›èµ›ä¸­ï¼Œæœ‰æœ›å¤ºå† çš„ç¾å›½é˜Ÿäº¤æ¥å¤±è¯¯é—æ†¾è·å¾—ç¬¬äºŒã€‚</p>
<div class="bili_video"><div style="position: relative; width: 100%; height: 0; padding-bottom: 75%;"><iframe src="https://player.bilibili.com/player.html?aid=556318760&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position: absolute; width: 100%; height: 100%; left: 0; top: 0;"> </iframe></div></div>
<p>å›é¡¾æ•´ä¸ªæ¯”èµ›ï¼Œæˆ‘ä»¬ä¼šå‘ç°ï¼Œå› ä¸ºç¬¬ä¸‰ã€å››æ£’äº¤æ¥æ—¶å‡ºç°äº†å¤±è¯¯ä»è€Œè®©åŠ æ‹¿å¤§é˜Ÿä»¥0.07ç§’çš„ä¼˜åŠ¿å¤ºå† ã€‚</p>
<table>
<thead>
<tr>
<th></th>
<th>ç¬¬ä¸€æ£’</th>
<th style="text-align:left">ç¬¬äºŒæ£’</th>
<th style="text-align:left">ç¬¬ä¸‰æ£’</th>
<th style="text-align:left">ç¬¬å››æ£’</th>
<th style="text-align:left">æ€»æ—¶é•¿</th>
</tr>
</thead>
<tbody>
<tr>
<td>åŠ æ‹¿å¤§é˜Ÿ</td>
<td>10.45</td>
<td style="text-align:left">8.86</td>
<td style="text-align:left">9.38</td>
<td style="text-align:left">8.79</td>
<td style="text-align:left">37.48</td>
</tr>
<tr>
<td>ç¾å›½é˜Ÿ</td>
<td>10.35(-0.10)</td>
<td style="text-align:left">8.94(+0.08)</td>
<td style="text-align:left">9.31(-0.07)</td>
<td style="text-align:left">8.95(+0.16)</td>
<td style="text-align:left">37.55(+0.07)</td>
</tr>
</tbody>
</table>
<p>å› æ­¤ï¼Œå¯¹äºè¿™ç§èµ›äº‹è¿åŠ¨ï¼Œä¸åŒç¯èŠ‚ä¹‹é—´çš„é…åˆå’Œäº¤æ¥ä¹ŸåŒæ ·é‡è¦ã€‚</p>
]]></content>
      <categories>
        <category>æ€»ç»“</category>
      </categories>
      <tags>
        <tag>æ–¹æ³•è®º</tag>
        <tag>æ€è€ƒ</tag>
      </tags>
  </entry>
  <entry>
    <title>è‰²æ¸©çš„åŸºæœ¬æ¦‚å¿µ</title>
    <url>/2022/12/03/introduction-to-color-temperature/</url>
    <content><![CDATA[<p><img src="/2022/12/03/introduction-to-color-temperature/1.webp" alt></p>
<p>è‰²æ¸©ä¸ç™½å¹³è¡¡æ˜¯æ‘„å½±ä¸­ååˆ†é‡è¦çš„ä¸¤ä¸ªæŠ€å·§ï¼Œè‰²æ¸©æ˜¯å…‰çº¿åœ¨ä¸åŒèƒ½é‡ä¸‹äººä»¬çœ¼æ™´æ‰€æ„Ÿå—åˆ°çš„é¢œè‰²å˜åŒ–ã€‚è€Œç™½å¹³è¡¡çš„è°ƒæ•´åˆ™æ˜¯é€šè¿‡è°ƒæ•´è‰²æ¸©æ¥å®ç°çš„ï¼Œä¸¤è€…å­˜åœ¨ç€å¯†ä¸å¯åˆ†çš„å…³ç³»ã€‚</p>
<span id="more"></span>
<h3 id="è‰²æ¸©çš„åŸºæœ¬æ¦‚å¿µ">è‰²æ¸©çš„åŸºæœ¬æ¦‚å¿µ</h3>
<p>åœ¨ä¸åŒå…‰çº¿çš„ç…§å°„ä¸‹ï¼Œç‰©ä½“çš„è‰²å½©ä¼šäº§ç”Ÿå˜åŒ–ã€‚ä¾‹å¦‚åœ¨å¦‚ä¸‹çš„è§†é¢‘ä¸­ï¼Œç›¸åŒçš„ç‰©ä½“åœ¨ä¸åŒçš„ç¯å…‰ä¸‹å…¶åæ˜ çš„è‰²å½©ä¹Ÿä¸åŒã€‚</p>
<div class="bili_video"><div style="position: relative; width: 100%; height: 0; padding-bottom: 75%;"><iframe src="https://player.bilibili.com/player.html?aid=716433256&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position: absolute; width: 100%; height: 100%; left: 0; top: 0;"> </iframe></div></div>
<p>ä½†æ˜¯ï¼Œç”±äºäººçš„çœ¼ç›èƒ½å¤Ÿä¿®æ­£å…‰æºå˜åŒ–é€ æˆçš„è‰²åï¼Œå› æ­¤ä¸ç®¡å…‰æºå¦‚ä½•å˜åŒ–ï¼ˆæ— è®ºæ˜¯åœ¨å®¤å¤–çš„é˜³å…‰ä¸‹ï¼Œè¿˜æ˜¯åœ¨å®¤å†…çš„ç™½ç‚½ç¯å…‰ä¸‹ï¼‰ï¼Œäººçœ¼ä»ä¼šå°†ç™½è‰²çš„ç‰©ä½“è§†ä¸ºç™½è‰²ï¼Œå°†çº¢è‰²çš„ç‰©ä½“è§†ä¸ºçº¢è‰²ã€‚</p>
<p>ç„¶è€Œï¼Œç›¸æœºå´ä¼šç²¾ç¡®åœ°å°†è¿™äº›å…‰æºå˜åŒ–è€Œå¸¦æ¥çš„å…‰çš„é¢œè‰²çš„å˜åŒ–è®°å½•åœ¨ç…§ç‰‡æˆ–è€…è§†é¢‘ä¸­ã€‚äºæ˜¯ï¼Œåœ¨çº æ­£ä¹‹å‰ï¼Œç…§ç‰‡æˆ–è€…è§†é¢‘çœ‹ä¸Šå»æ˜¯åè‰²çš„ï¼Œä½†å…¶å®è¿™æ‰æ˜¯ç‰©ä½“åœ¨å½“å‰ç¯å¢ƒä¸­çš„çœŸå®è‰²å½©ã€‚</p>
<p>ä¸ºäº†åŒºåˆ«å„ç§è‰²å½©é—´çš„å˜åŒ–ï¼Œåœ¨å½©è‰²æ‘„å½±ä¸­å¼•è¿›äº†â€œè‰²æ¸©â€çš„æ¦‚å¿µã€‚æ‰€è°“â€œè‰²æ¸©â€ï¼ŒæŒ‡çš„æ˜¯ä¸€ç§ç‰©ç†ç°è±¡ï¼Œå³å°†é‡‘å±åŠ çƒ­åˆ°ä¸€å®šæ¸©åº¦åä¼šå‘å‡ºæœ‰é¢œè‰²çš„å…‰ï¼Œè¿™ç§å…‰æºçš„æ¸©åº¦è¢«ç§°ä¸ºâ€œè‰²æ¸©â€ã€‚ä¾‹å¦‚ï¼Œå½“ä¸€ä¸ªé»‘ä½“ç‰©è´¨å—çƒ­åä¾¿å¼€å§‹å‘å…‰ï¼Œå…ˆå˜æˆæš—çº¢è‰²ï¼Œéšç€æ¸©åº¦çš„å‡é«˜ä¼šé€æ¸å˜æˆé»„è‰²ï¼Œç„¶åå˜æˆç™½è‰²ï¼Œæœ€åå˜æˆè“è‰²ã€‚</p>
<p>é€šå¸¸ï¼Œäººçœ¼æ‰€è§åˆ°çš„å…‰çº¿æ˜¯ç”±ä¸ƒç§è‰²å…‰çš„å…‰è°±æ‰€ç»„æˆçš„ï¼Œå…¶ä¸­æœ‰äº›åè“ï¼Œæœ‰äº›åˆ™åçº¢ã€‚è‰²æ¸©å°±æ˜¯ä¸“é—¨ç”¨æ¥åº¦é‡å…‰çº¿çš„å…‰è°±æˆåˆ†çš„ç‰©ç†é‡ï¼Œè‰²æ¸©ç”¨ç»å¯¹æ¸©æ ‡ K(Kelvinï¼‰æ¥è¡¨ç¤ºã€‚</p>
<p>å½“å…‰æºå‘å°„çš„å…‰çš„é¢œè‰²ä¸ç»å¯¹ç‰©ä½“åœ¨æŸä¸€æ¸©åº¦ä¸‹è¾å°„å…‰çš„é¢œè‰²ç›¸åŒæ—¶ï¼Œç»å¯¹ç‰©ä½“çš„æ¸©åº¦å°±è¢«ç§°ä¸ºè¯¥å…‰æºçš„è‰²æ¸©ã€‚è‰²æ¸©è¶Šé«˜ï¼Œåˆ™å…‰è‰²è¶Šåè“ï¼›è‰²æ¸©è¶Šä½ï¼Œåˆ™å…‰è‰²è¶Šåçº¢ã€æ©™ã€é»„ã€‚</p>
<h3 id="ä¸åŒè‰²æ¸©çš„é¢œè‰²">ä¸åŒè‰²æ¸©çš„é¢œè‰²</h3>
<p>ä»¥ä¸€å¤©ä¸­ä¸åŒæ—¶åˆ»çš„å¤ªé˜³ç›´å°„å…‰ä¸ºä¾‹ï¼š</p>
<ul>
<li>æ—¥å‡ºå 30 åˆ†é’Ÿï¼Œå…‰è‰²å‘é»„ï¼Œè‰²æ¸©å€¼çº¦ä¸º 2400K</li>
<li>æ­£åˆæ—¶åˆ†ï¼Œæ—¥å…‰åç™½ï¼Œè‰²æ¸©ä¸Šå‡è‡³ 4400 ~ 5500K</li>
<li>æ—¥è½å‰ï¼Œå¤ªé˜³ç›´å°„å…‰å…‰è‰²å‘çº¢ï¼Œè‰²æ¸©åˆé™è‡³ 1900K å·¦å³</li>
</ul>
<p><img src="/2022/12/03/introduction-to-color-temperature/2.jpeg" alt></p>
<p>æ›´è¯¦ç»†çš„è‰²æ¸©å’ŒRGBä¹‹é—´çš„æ˜ å°„å…³ç³»å¯ä»¥å‚è€ƒ<a href="http://www.vendian.org/mncharity/dir3/blackbody/UnstableURLs/bbr_color.html">Blackbody color datafile</a>ã€‚</p>
<h3 id="ä¸åŒè‰²æ¸©çš„è§†è§‰æ„ŸçŸ¥">ä¸åŒè‰²æ¸©çš„è§†è§‰æ„ŸçŸ¥</h3>
<p>å…‰æºçš„è‰²æ¸©ä¸åŒï¼Œå…‰è‰²ä¸åŒï¼Œå¸¦ç»™äººçš„è§†è§‰æ„Ÿå—ä¹Ÿä¸ç›¸åŒï¼š</p>
<ul>
<li>è‰²æ¸©åœ¨ 3300K ä»¥ä¸‹ï¼Œæœ‰ä¸€ç§æ¸©æš–ã€çƒ­çƒˆã€æ´»æ³¼çš„æ„Ÿå—</li>
<li>è‰²æ¸©åœ¨ 3000ï½5000K ä¸ºä¸­é—´è‰²æ¸©ï¼Œæœ‰æ˜æœ—çˆ½å¿«çš„æ„Ÿè§‰</li>
<li>è‰²æ¸©åœ¨ 5000K æ˜¯æœ€æ¥è¿‘è‡ªç„¶å…‰çš„è‰²æ¸©ï¼Œåˆç§°ä¸ºâ€œè‡ªç„¶ç™½â€ã€‚</li>
<li>è‰²æ¸©åœ¨ 5000K ä»¥ä¸Šä¼šå¸¦ç»™äººä¸€ç§å¯’å†·ã€ä¸¥è‚ƒã€å®‰å®çš„æ„Ÿå—</li>
</ul>
<p>åŒæ—¶ï¼Œäººç±»çš„æ–‡åŒ–ä¼ ç»Ÿä¹Ÿèµ‹äºˆé¢œè‰²ä¸åŒçš„è±¡å¾æ„ä¹‰ï¼š</p>
<ul>
<li>çº¢è‰²è±¡å¾ç€çƒ­çƒˆã€å–œåº†</li>
<li>ç»¿è‰²è±¡å¾ç€å’Œå¹³ã€ç”Ÿå‘½</li>
<li>è“è‰²è±¡å¾ç€å®é™ã€å¹¿é˜”</li>
<li>é»„è‰²è±¡å¾ç€æ¸©æš–ã€æƒåŠ¿</li>
<li>ç™½è‰²è±¡å¾ç€å…‰æ˜ã€çº¯æ´</li>
<li>é»‘è‰²è±¡å¾ç€ä¸¥è‚ƒã€ç¥ç§˜</li>
<li>â€¦â€¦</li>
</ul>
<h3 id="ç™½å¹³è¡¡çš„æ¦‚å¿µ">ç™½å¹³è¡¡çš„æ¦‚å¿µ</h3>
<p>å‰é¢åœ¨ä»‹ç»è‰²æ¸©çš„æ—¶å€™ï¼Œæˆ‘ä»¬æåˆ°ï¼š</p>
<ul>
<li>äººçš„çœ¼ç›èƒ½å¤Ÿä¿®æ­£å…‰æºå˜åŒ–é€ æˆçš„è‰²åï¼Œå› æ­¤ä¸ç®¡å…‰æºå¦‚ä½•å˜åŒ–ï¼Œäººçœ¼ä»ä¼šå°†ç™½è‰²çš„ç‰©ä½“è§†ä¸ºç™½è‰²</li>
<li>ç›¸æœºçš„é•œå¤´å´æ— æ³•ä¿®æ­£å…‰æºå˜åŒ–å¸¦æ¥çš„è‰²åï¼Œå› æ­¤å…‰æºçš„å˜åŒ–ä¼šå¯¼è‡´ç›¸æœºè®°å½•çš„è‰²å½©çš„å˜åŒ–</li>
</ul>
<p>ç™½å¹³è¡¡ (White Balence) æ˜¯æ•°ç å•åç›¸æœºè¿ç”¨è‡ªèº«ç”µè·¯æ¥æ ¡æ­£ä¸åŒå…‰æºä¸‹å…‰çº¿è‰²å½©åç§»çš„ä¸€ç§åŠŸèƒ½ã€‚</p>
<p>æ­£å¸¸æ¡ä»¶ä¸‹çš„å…‰é€šå¸¸è¢«ç§°ä¸ºâ€œç™½å…‰â€ï¼Œè€Œåœ¨è¿™ç§å…‰çº¿ä¸‹çš„è‰²å½©æ˜¯äººä»¬æ‰€è®¤ä¸ºçš„â€œæ­£å¸¸â€è‰²å½©ã€‚æ‰€è°“â€œç™½å¹³è¡¡â€ï¼Œç®€å•åœ°è¯´ï¼Œå°±æ˜¯è®©ç›¸æœºåœ¨ä»»ä½•å…‰çº¿æ¡ä»¶ä¸‹éƒ½èƒ½è¯†åˆ«ä»€ä¹ˆæ˜¯ç™½è‰²ã€‚</p>
<p>äººä»¬å¸¸è¯´ç…§ç›¸æœºçš„é•œå¤´æ˜¯ç‰©é•œï¼ŒåŸå› åœ¨äºä¸è®ºåœ¨ä»€ä¹ˆæ ·çš„å…‰çº¿æ¡ä»¶ä¸‹ï¼Œå®ƒéƒ½åªèƒ½å¦‚å®åœ°è®°å½•å®ƒæ‰€çœ‹åˆ°çš„ä¸€åˆ‡ã€‚ç™½å¹³è¡¡çš„è®¾ç½®å°±æ˜¯ä¸ºäº†è®©ç›¸æœºåœ¨ä»»ä½•å…‰çº¿æ¡ä»¶ä¸‹éƒ½å¯ä»¥æ­£ç¡®åœ°è¿˜åŸè‰²å½©ï¼Œä½¿å®ƒåƒäººçœ¼é‚£æ ·èƒ½å¤Ÿè‡ªåŠ¨é€‚åº”ç¯å¢ƒçš„å…‰çº¿ã€‚é€šå¸¸ç›¸æœºçš„ç™½å¹³è¡¡æ¨¡å¼å¤§ä½“åˆ†ä¸ºæ‰‹åŠ¨ç™½å¹³è¡¡ã€è‡ªåŠ¨ç™½å¹³è¡¡ä¸¤ç§æ¨¡å¼ï¼Œè¿˜è®¾æœ‰é—ªå…‰ç¯ã€é˜´å½±ã€æ—¥å…‰ã€è§å…‰ã€ç™½ç‚½ç¯ç­‰é¢„è®¾ç™½å¹³è¡¡æ¨¡å¼ã€‚</p>
<p>æ— è®ºå“ªç§ç™½å¹³è¡¡æ¨¡å¼ï¼Œå…¶æœ¬è´¨éƒ½æ˜¯å¯¹è‰²æ¸©çš„æ§åˆ¶ã€‚ç›®å‰ï¼Œå¾ˆå¤šçš„å…‰æºï¼ˆå½±è§†ç¯ã€é—ªå…‰ç¯ï¼‰éƒ½æ˜¯æœ‰å›ºå®šè‰²æ¸©çš„ï¼Œå¹¶ä¸”åœ¨å…¶äº§å“è§„æ ¼ä¸­ä¹Ÿä¼šæ˜ç¡®æ ‡å®šå…¶å‘å…‰çš„è‰²æ¸©å€¼ã€‚å¯¹äºè¿™ç§åœºæ™¯ï¼Œæ‹æ‘„çš„æ—¶å€™ï¼Œç›´æ¥è°ƒæ•´ç›¸æœºçš„ç™½å¹³è¡¡ä¸ºå¯¹åº”çš„å…‰æºè‰²æ¸©å€¼å³å¯ã€‚</p>
<p>å¦‚å‰æ‰€è¿°ï¼Œ5000K æ˜¯æœ€æ¥è¿‘è‡ªç„¶å…‰çš„è‰²æ¸©ï¼Œå¦‚æœæˆ‘ä»¬æ‹æ‘„çš„ç¯å¢ƒè‰²æ¸©å€¼ä¸º 4000Kï¼Œæ­¤æ—¶ç¯å¢ƒä¸­çš„ç‰©ä½“æ˜¯åæš–è‰²çš„ã€‚æƒ³è¦è¿˜åŸç‰©ä½“æœ¬èº«çš„è‰²å½©ï¼Œé‚£ä¹ˆå°±éœ€è¦æŠŠç›¸æœºçš„ç™½å¹³è¡¡è®¾ç½®ä¸º 4000Kï¼Œè¿™æ ·å°±å¯ä»¥è¿˜åŸç‰©ä½“æœ¬èº«çš„è‰²å½©äº†ã€‚</p>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition warning"><p class="admonition-title">æ³¨æ„è‰²æ¸©å’Œç™½å¹³è¡¡çš„åŒºåˆ«
</p><p>è™½ç„¶å¯ä»¥ä½¿ç”¨è‰²æ¸©æ¥è°ƒæ•´ç›¸æœºçš„ç™½å¹³è¡¡ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼šç›¸æœºç™½å¹³è¡¡è‰²æ¸©å’Œç‰©ç†è‰²æ¸©å¹¶ä¸æ˜¯åŒä¸€ä¸ªæ¦‚å¿µã€‚</p>
<ul>
<li>ç›¸æœºçš„è‰²æ¸©å€¼è°ƒä½ï¼Œç›¸æœºå°±ä¼šè®¤ä¸ºæ­¤æ—¶çš„ç¯å¢ƒåçº¢ï¼Œæ‰€ä»¥å°±è¦å¾€ç”»é¢ä¸­åŠ å…¥å†·è‰²è°ƒï¼Œæ­¤æ—¶ç”»é¢ä¼šå˜çš„æ›´å†·ã€‚</li>
<li>ç›¸æœºçš„è‰²æ¸©å€¼è°ƒé«˜ï¼Œç›¸æœºå°±ä¼šè®¤ä¸ºæ­¤æ—¶çš„ç¯å¢ƒåè“ï¼Œæ‰€ä»¥å°±è¦å¾€ç”»é¢ä¸­åŠ å…¥æš–è‰²è°ƒï¼Œæ­¤æ—¶ç”»é¢ä¼šå˜å¾—æ›´æš–ã€‚</li>
</ul>
</div>
<p>æ‰€ä»¥ï¼Œå¦‚æœæƒ³è¦æ‹æ‘„æš–è‰²è°ƒçš„ç”»é¢ï¼Œæˆ–è€…é‡‡ç”¨è‰²æ¸©è¾ƒä½çš„å…‰æºï¼Œæˆ–è€…å¯ä»¥é€šè¿‡è°ƒé«˜ç›¸æœºçš„ç™½å¹³è¡¡è‰²æ¸©å€¼ã€‚</p>
<p><img src="/2022/12/03/introduction-to-color-temperature/3.jpg" alt></p>
<p>å…³äºè‰²æ¸©åœ¨ä¸åŒåœºæ™¯ä¸‹çš„è¿ç”¨ï¼Œå¯ä»¥å‚è€ƒå¦‚ä¸‹çš„è§†é¢‘ã€‚</p>
<div class="bili_video"><div style="position: relative; width: 100%; height: 0; padding-bottom: 75%;"><iframe src="https://player.bilibili.com/player.html?aid=248829829&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position: absolute; width: 100%; height: 100%; left: 0; top: 0;"> </iframe></div></div>
<h3 id="é€šè¿‡åå¤„ç†ä¿®æ”¹è‰²æ¸©">é€šè¿‡åå¤„ç†ä¿®æ”¹è‰²æ¸©</h3>
<p>å½“ç„¶ï¼Œç°åœ¨å¾ˆå¤šè½¯ä»¶å¯ä»¥å¯¹ç…§ç‰‡æˆ–è€…è§†é¢‘çš„è‰²æ¸©è¿›è¡Œåå¤„ç†ã€‚ä½†æ˜¯å¯ä»¥åå¤„ç†è°ƒæ•´è‰²æ¸©ï¼Œå¹¶ä¸æ„å‘³ç€ï¼Œå‰æœŸçš„ç¯å…‰ä»¥åŠç›¸æœºçš„ç™½å¹³è¡¡è®¾ç½®æ˜¯ä¸é‡è¦çš„ã€‚å¦‚æœå‰æœŸç¯å…‰ä¹±ä¸ƒå…«ç³Ÿï¼Œé‚£ä¹ˆåç»­æ€ä¹ˆè°ƒæ•´éƒ½æ˜¾å¾—æ— èƒ½ä¸ºåŠ›ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå¯¹äºå©šçº±æ‘„å½±è€Œè¨€ï¼Œåœ¨æ‹æ‘„æ—¶ï¼Œå¯ä»¥å¯¹äººç‰©çš„è„¸éƒ¨åŠ ä¸Šæš–è‰²è¡¥å…‰ç¯ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœåæœŸå¯¹äººç‰©çš„è„¸éƒ¨è¿›è¡Œç™½å¹³è¡¡è°ƒæ•´ï¼Œé‚£å¤©ç©ºå°±ä¼šå› ä¸ºè‰²æ¸©çš„åæœŸè°ƒæ•´è€Œå˜æˆæ·±è“è‰²ã€‚ç±»ä¼¼çš„ï¼Œå¦‚æœæ‹æ‘„æ—¶ç»™äººç‰©è„¸éƒ¨è¡¥å†·è‰²å…‰ï¼Œé‚£ä¹ˆå½“æŒ‰ç…§è„¸éƒ¨è°ƒæ•´ç™½å¹³è¡¡ä¹‹åï¼Œç¯å¢ƒå°±ä¼šå˜æˆæš–è‰²ã€‚é™¤éåæœŸæŠŠç”¨ä¸åŒè‰²æ¸©ç…§å°„çš„éƒ¨åˆ†å•ç‹¬åˆ›å»ºå›¾å±‚å•ç‹¬è°ƒæ•´è‰²æ¸©ï¼Œå¦åˆ™æ— è®ºåæœŸæ€ä¹ˆè°ƒæ•´ï¼Œéƒ½ä¸ä¼šå¾—åˆ°ä»¤äººæ»¡æ„çš„ç»“æœã€‚</p>
<p>åå¤„ç†è°ƒæ•´è‰²æ¸©ä¸»è¦æ˜¯é€šè¿‡è‰²æ¸©æ¥è°ƒæ•´RGBå„é€šé“çš„é¢œè‰²å€¼æ¥å®ç°ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">kelvin_table = &#123;</span><br><span class="line">    <span class="number">1000</span>: (<span class="number">255</span>, <span class="number">56</span>, <span class="number">0</span>),</span><br><span class="line">    <span class="number">1100</span>: (<span class="number">255</span>, <span class="number">71</span>, <span class="number">0</span>),</span><br><span class="line">    ...</span><br><span class="line">    <span class="number">12000</span>: (<span class="number">195</span>, <span class="number">209</span>, <span class="number">255</span>),</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">image   = Image.<span class="built_in">open</span>(image_file)</span><br><span class="line">r, g, b = kelvin_table[color_temperature]</span><br><span class="line">color_matrix = (r / <span class="number">255.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>, </span><br><span class="line">                <span class="number">0.0</span>, g / <span class="number">255.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>, </span><br><span class="line">                <span class="number">0.0</span>, <span class="number">0.0</span>, b / <span class="number">255.0</span>, <span class="number">0.0</span>)</span><br><span class="line">new_image = image.convert(<span class="string">&#x27;RGB&#x27;</span>, color_matrix)</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­ï¼Œä»£ç ä¸­çš„ <code>kelvin_table</code> å¯ä»¥ä» <a href="http://www.vendian.org/mncharity/dir3/blackbody/UnstableURLs/bbr_color.html">Blackbody color datafile</a> è·å–ã€‚</p>
<p>åˆ©ç”¨è¿™ç§æ–¹å¼å¯¹å›¾ç‰‡çš„è‰²æ¸©è¿›è¡Œè°ƒæ•´ï¼ˆ1000K~12000Kï¼‰ï¼Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹çš„æ•ˆæœï¼š</p>
<p><img src="/2022/12/03/introduction-to-color-temperature/4.jpg" alt></p>
<h3 id="è‰²æ¸©å¯¹è§†è§‰ä¿¡æ¯çš„å½±å“">è‰²æ¸©å¯¹è§†è§‰ä¿¡æ¯çš„å½±å“</h3>
<p>é€šè¿‡ä¸‹å›¾çš„è‰²æ¸©è°ƒæ•´å¯ä»¥çœ‹åˆ°ï¼Œè‰²æ¸©çš„è°ƒæ•´ä¼šç®€ä»‹çš„å½±å“å›¾åƒçš„è‰²è°ƒã€é¥±å’Œåº¦ã€äº®åº¦ã€è‰²å½©åº¦ç­‰ä¿¡æ¯ï¼Œä»è€Œå½±å“è§†è§‰æ•ˆæœã€‚</p>
<p><img src="/2022/12/03/introduction-to-color-temperature/5.jpg" alt></p>
]]></content>
      <categories>
        <category>è§†é¢‘æŠ€æœ¯</category>
      </categories>
      <tags>
        <tag>è‰²æ¸©</tag>
        <tag>ç™½å¹³è¡¡</tag>
      </tags>
  </entry>
  <entry>
    <title>å¦‚ä½•çªç ´èµ„æºé™åˆ¶ï¼Œåˆ›é€ æ›´å¤§çš„ä»·å€¼ï¼Ÿ</title>
    <url>/2022/09/05/How-to-break-through-the-resource-limitation-and-create-the-more-value/</url>
    <content><![CDATA[<p><img src="/2022/09/05/How-to-break-through-the-resource-limitation-and-create-the-more-value/1.webp" alt></p>
<p>åœ¨ <a href="https://item.jd.com/13067829.html">åå·®â€”â€”äººç±»å†³ç­–ä¸­çš„é™·é˜±</a> ä¸€ä¹¦çš„ <em>è°¨å°æ…å¾®çš„é€‰æ‹©ï¼Œå¤§èƒ†æ— ç•çš„é¢„æµ‹</em> è¿™ä¸€ç« èŠ‚ä¸­è¯´é“ï¼š</p>
<blockquote>
<p>å¦‚æœä¸€ä¸ªé¡¹ç›®çš„å€¡å¯¼è€…å¤„äºæ¥è¿‘ç»„ç»‡å±‚çº§æœ€é¡¶ç«¯çš„ä½ç½®ï¼Œé‚£ä¹ˆä»–çš„å»ºè®®ã€é¢„æµ‹å’Œå‡è®¾å°±ä¸ä¼šå—åˆ°å¤ªå¤šçš„å®¡æŸ¥ã€‚</p>
<p>ç›¸åï¼Œç”±æ›´åŸºå±‚çš„å‘˜å·¥æå‡ºçš„å°è§„æ¨¡é¡¹ç›®ç¼ºå¿…é¡»å…‹æœé‡é‡éšœç¢ï¼Œåœ¨å¾—åˆ°æ‰¹å‡†ä¹‹å‰è¦ç»å—å¤šå±‚å®¡æŸ¥ã€‚</p>
</blockquote>
<p>å¦‚æœä½ æ‰€åœ¨çš„é¡¹ç›®ç”±å¤„äºæ¥è¿‘ç»„ç»‡å±‚çº§æœ€é¡¶ç«¯ä½ç½®çš„äººå‘èµ·ï¼Œé‚£ä¹ˆæ­å–œä½ è¿›å…¥äº†ä¸€ä¸ªæ˜æ˜Ÿé¡¹ç›®ï¼Œä½ æ‰€è·å¾—çš„æ”¶ç›Šä¹Ÿä¼šå› ä¸ºæ˜æ˜Ÿé¡¹ç›®çš„å¿«é€Ÿå‘å±•è€Œä¸ä¼—ä¸åŒã€‚</p>
<p>è°ä¸æƒ³åšæ˜æ˜Ÿé¡¹ç›®å‘¢ï¼Ÿ</p>
<p>ä½†æ˜¯ï¼Œæ˜æ˜Ÿé¡¹ç›®çš„æ•°é‡æ€»å½’æ˜¯æœ‰é™çš„ï¼Œå…¶æ‰€èƒ½æ‰¿è½½çš„å›¢é˜Ÿæˆå‘˜çš„æ•°é‡ä¹Ÿæ˜¯æœ‰é™çš„ã€‚å½“æˆ‘ä»¬å¤„åœ¨ä¸€ä¸ªæ™®é€šé¡¹ç›®çš„æ—¶å€™ï¼Œæˆ‘ä»¬åˆå¦‚ä½•æ‰èƒ½çªç ´èµ„æºçš„é™åˆ¶ï¼Œåˆ›é€ å‡ºæ›´å¤§çš„ä»·å€¼ï¼Ÿ</p>
<span id="more"></span>
<h2 id="çµé•œä¹‹è·¯">çµé•œä¹‹è·¯</h2>
<p>2020å¹´åˆï¼Œåœ¨æˆ‘ç¿»è¯‘å®Œ <a href="https://wangwei1237.github.io/digital_video_concepts/">Digital Video Concepts, Methods, and Metrics</a> è¿™æœ¬ä¹¦çš„æ—¶å€™ï¼Œä»ä¹¦ä¸­çš„ <em>è§†é¢‘è´¨é‡æŒ‡æ ‡</em> è¿™ä¸€ç« èŠ‚å‘ç°äº†å½“å‰è§†é¢‘è¯„æµ‹å­˜åœ¨çš„é—®é¢˜ï¼Œä¹Ÿå—…åˆ°äº†æœºä¼šã€‚ä»é‚£ä¸ªæ—¶å€™èµ·ï¼Œå°±æƒ³ç€æŠŠè§†é¢‘è¯„æµ‹è¿™ä¸ªæ–¹å‘ç³»ç»Ÿåœ°åšèµ·æ¥ã€‚</p>
<ul>
<li>2020å¹´ Q1ï¼Œæˆ‘ä»¬æŒ‰ç…§ ITU çš„æ ‡å‡†å»ºè®¾äº†è¯„æµ‹çš„æ ‡å‡†å’Œä½“ç³»ï¼Œå½“æ—¶ç”šè‡³è¿˜æ²¡æœ‰æˆå‹çš„å·¥å…·å¯ä»¥ä½¿ç”¨ã€‚</li>
<li>2020å¹´ Q2ï¼Œæˆ‘ä»¬å®Œæˆäº† WEB ç‰ˆæœ¬çš„å·¥ç¨‹å¼€å‘å¹¶åœ¨ 2020å¹´ Q3 çš„æ—¶å€™åœ¨ç›´æ’­ä¸šåŠ¡è½åœ°ä½¿ç”¨ã€‚</li>
<li>2020å¹´ Q4ï¼Œæˆ‘ä»¬å’Œ ACG åˆä½œï¼Œåˆ©ç”¨ WebAssembly æŠ€æœ¯å®ç°äº†åœ¨ Chromeæµè§ˆå™¨æ’­æ”¾ H265 è§†é¢‘çš„èƒ½åŠ›ã€‚åŒæ—¶æˆ‘ä»¬è¿˜åœ¨å®¢è§‚ç®—æ³•ä¸Šè¿›è¡Œäº†å„ç§æ¢ç´¢å’Œé›†æˆã€‚</li>
<li>2021å¹´ Q1ï¼Œæˆ‘ä»¬å’Œç ”å‘ã€UE åˆä½œï¼Œå®ç°äº† Android ç‰ˆæœ¬ï¼Œç›´åˆ°é‚£ä¸ªæ—¶å€™æˆ‘ä»¬æ‰ç»™é¡¹ç›®èµ·äº†â€œçµé•œâ€è¿™ä¸ªåå­—ã€‚</li>
<li>2022å¹´ Q1ï¼Œæˆ‘ä»¬ç»§ç»­å’Œç ”å‘ã€UE åˆä½œï¼Œå®ç°äº† iOS ç‰ˆæœ¬ï¼Œå®ç°äº† PC+Android+iOS çš„å¤šç«¯è¯„ä¼°èƒ½åŠ›ã€‚</li>
<li>2022å¹´ Q2ï¼Œæˆ‘ä»¬å’Œ PMO åˆä½œï¼Œå»ºè®¾äº†çµé•œä¸“å±çš„ä¼—æµ‹å›¢é˜Ÿï¼Œçµé•œæˆä¸ºå…¬å¸çº§åˆ«çš„è§†é¢‘è¯„æµ‹å¹³å°ã€‚</li>
<li>2022å¹´ Q3ï¼Œâ€œçµé•œMagicâ€ iOSç‰ˆæœ¬ä¸Šæ¶è‹¹æœ AppStoreï¼Œå®ç°äº§å“åŒ–çš„ç¬¬ä¸€æ­¥ã€‚</li>
<li>2023å¹´ Q1ï¼Œâ€œçµé•œâ€å‡çº§ä¸ºâ€œåº¦çŸ¥äº†â€ï¼Œä¸Šæ¶å„ Android å¸‚åœºæ¸ é“ï¼Œå®ç°åŒç«¯å‘å¸ƒã€‚</li>
<li>2023å¹´ Q1ï¼Œæˆ‘ä»¬åœ¨ LiveVideoStack 2022 åŒ—äº¬ç«™å¤§ä¼šä¸Šï¼Œåˆ†äº«äº†æˆ‘ä»¬çš„æ•´ä¸ªå®è·µè¿‡ç¨‹å¹¶å—åˆ°ä¸šç•Œæœ‹å‹çš„å¥½è¯„ã€‚</li>
<li>â€¦â€¦</li>
</ul>
<p>å›é¦–è¿‡å»ï¼Œçµé•œè¿™ä¸ªé¡¹ç›®å°±åƒç§ä¸‹çš„ç§å­ä¸€æ ·ï¼Œæ…¢æ…¢ç”Ÿæ ¹ï¼Œå‘èŠ½ï¼Œå¼€èŠ±ï¼Œç»“æœã€‚æƒ³å½“åˆï¼Œæˆ‘ä»¬è¿™ä¸ªè™šæ‹Ÿå›¢é˜Ÿåªæœ‰ 2 ä¸ªäººï¼Œåˆ°ç°åœ¨æˆ‘ä»¬è¿™ä¸ªè™šæ‹Ÿå›¢é˜Ÿæœ‰ 10 ä½™äººä»¥åŠä¸Šç™¾äººçš„ä¼—æµ‹ç”¨æˆ·ã€‚çµé•œï¼Œå°±è¿™æ ·åœ¨æ²¡æœ‰äººå…³æ³¨çš„æ—¶å€™ï¼Œæ…¢æ…¢æˆé•¿ï¼Œå¹¶åœ¨æŸä¸ªæ—¶åˆ»çªç„¶çˆ†å‘äº†èµ·æ¥ã€‚</p>
<h2 id="å°äº‹ç€æ‰‹-å¿—å­˜é«˜è¿œ">å°äº‹ç€æ‰‹ï¼Œå¿—å­˜é«˜è¿œ</h2>
<p>åœ¨ <a href="https://www.infoq.cn/article/tFuwP4gZLNUVU5lpvSBl">InfoQçš„è¶…çº§è¿éº¦æ ç›®</a> ä¸­ï¼ŒTGO é²²é¹ä¼šçš„è‘£äº‹ä¼šæˆå‘˜äºæ¸¸è¯´ï¼š</p>
<blockquote>
<p>ä¸è¦æ€»æƒ³ç€åšé«˜å¤§ä¸Šçš„äº‹ï¼Œæœ‰å¾ˆå¤šå¹³å¹³å¸¸å¸¸çš„å·¥ä½œæŠŠå®ƒå®Œæˆå¥½å°±å·²ç»å¾ˆå¥½äº†ã€‚</p>
</blockquote>
<p>å›é¡¾çµé•œçš„æ•´ä¸ªè¿‡ç¨‹ï¼Œç¡®å®å¦‚æ­¤ã€‚è§†é¢‘è´¨é‡è¯„æµ‹è¿™ä¸ªäº‹æƒ…ï¼Œè¯´å‡ºæ¥ï¼Œå¤§å®¶å¯èƒ½éƒ½ä¼šè®¤ä¸ºè¿™æ˜¯ä¸€ä»¶éå¸¸å°çš„ã€æ²¡ä»€ä¹ˆæŠ€æœ¯å«é‡çš„ã€è°ä¹Ÿçœ‹ä¸ä¸Šçš„é¡¹ç›®ã€‚</p>
<p>æˆ‘ä»¬æœ€å¼€å§‹ç»™åˆ«äººä»‹ç»çš„æ—¶å€™ï¼Œåˆ«äººçš„åé¦ˆç¡®å®å¦‚æ­¤ï¼šè¿™æœ‰ä»€ä¹ˆæŠ€æœ¯å«é‡å‘¢ï¼Œä¸å°±æ˜¯äººæ¥æ‰“æ‰“åˆ†å˜›ï¼Ÿç­‰æˆ‘ä»¬ä»‹ç»å®Œä¹‹åï¼Œå¤§å®¶æ‰æç„¶å¤§æ‚Ÿï¼ŒåŸæ¥ä½ ä»¬åšçš„æ˜¯è§†é¢‘ç”»è´¨æå‡çš„â€œåº¦é‡è¡¡â€å‘€ï¼åŸæ¥ä½ ä»¬æŠŠä¸€äº›çœ‹èµ·æ¥éå¸¸ç®€å•çš„äº‹æƒ…å…¨éƒ¨é›†æˆã€æ•´åˆåˆ°ä¸€ä¸ªäº§å“ä¸­äº†å‘€ï¼åœ¨ <a href="https://github.com/wangwei1237/wangwei1237.github.io/issues/325">å¦‚ä½•æ­£ç¡®çš„è¯„æµ‹è§†é¢‘ç”»è´¨</a> çš„è¯„è®ºåŒºä¸­ï¼Œç”¨æˆ·ç•™è¨€è¯´ï¼š</p>
<blockquote>
<p>åšä¸»ä½ å¥½ï¼Œä»å…¬ä¼—å·è¿½äº†è¿‡æ¥ï¼Œå†™çš„éå¸¸èµï¼å¦‚ä¸‹å†…å®¹ï¼Œæƒ³è·Ÿä½ æ¢è®¨ä¸€ä¸‹ï¼šâ€¦â€¦</p>
</blockquote>
<p>æ˜¯çš„ï¼Œè™½ç„¶æœ€å¼€å§‹çš„æ—¶å€™çµé•œçœ‹èµ·æ¥æ˜¯ä¸€ä»¶æ¯”è¾ƒå°çš„äº‹æƒ…ï¼Œä½†æ˜¯æˆ‘ä»¬åœ¨å†³å®šåšçš„æ—¶å€™å°±æ˜¯å†²ç€è§†é¢‘ç”»è´¨æå‡çš„â€œåº¦é‡è¡¡â€è¿™ä¸ªç›®æ ‡æ¥è§„åˆ’çš„ã€‚æˆ‘ä»¬åœ¨ä»å°äº‹ç€æ‰‹çš„åŒæ—¶ï¼Œå¿…é¡»è¦å¿—å­˜é«˜è¿œï¼Œå¦åˆ™æˆ‘ä»¬æ‰€åšçš„äº‹æƒ…æ°¸è¿œéƒ½æ˜¯ä¸€äº›æ— æ³•è¿è´¯èµ·æ¥çš„å°äº‹æƒ…ã€‚</p>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬è®¨è®ºçš„æ—¶å€™ä¹Ÿå‘ç°ï¼šå…¶å®ï¼Œè§†é¢‘è¯„æµ‹å¹¶ä¸æ˜¯ä¸€ä»¶ç®€å•çš„äº‹æƒ…ï¼Œåªæ˜¯æ•´ä¸ªå›¢é˜Ÿé€šè¿‡åŠªåŠ›æŠŠè¿™ä»¶å¤æ‚çš„äº‹æƒ…å˜å¾—ç®€å•äº†ã€‚</p>
<p>ç¥è¯æœ‰ä¸¤ç§ï¼šä¸€æ˜¯å®Œæˆåˆ«äººè®¤ä¸ºä¸å¯èƒ½å®Œæˆçš„äº‹æƒ…ï¼ŒäºŒæ˜¯æŠŠåˆ«äººè®¤ä¸ºç®€å•çš„äº‹æƒ…åšåˆ°æè‡´ã€‚</p>
<h2 id="ä¹äºåˆä½œ-ä»·å€¼å…±äº«">ä¹äºåˆä½œï¼Œä»·å€¼å…±äº«</h2>
<p>åœ¨åˆ›ä¸šåˆ›æ–°çš„å¸‚åœºç¯å¢ƒä¸‹ï¼Œå•æ‰“ç‹¬æ–—çš„åˆ›ä¸šé£é™©æé«˜ï¼Œä¸”æˆåŠŸç‡æä½ã€‚åœ¨çµé•œé¡¹ç›®çš„æ•´ä¸ªæ¨è¿›è¿‡ç¨‹ä¸­ï¼Œæˆ‘æ·±æ·±åœ°è®¤è¯†åˆ°ï¼š<strong>ä¸è¦æ€»æƒ³ç€è‡ªå·±èƒ½è§£å†³æ‰€æœ‰äº‹æƒ…ï¼Œåªæœ‰åˆä½œï¼Œæ‰èƒ½èµ°å¾—æ›´å¿«ï¼Œèµ¢å¾—èƒœåˆ©</strong>ã€‚</p>
<p>å½“çµé•œä» WEB ç‰ˆæœ¬å‡çº§åˆ° å®¢æˆ·ç«¯ APP ç‰ˆæœ¬çš„æ—¶å€™ï¼Œæˆ‘å‘ç°ï¼šå›¢é˜Ÿä¸­æ²¡æœ‰äººå¯ä»¥å¼€å‘ iOS/Androidï¼Œæ²¡æœ‰äººå¯ä»¥è®¾è®¡å®¢æˆ·ç«¯çš„ UIã€‚å½“çµé•œéœ€è¦åˆ†æè§†è§‰å› å­ï¼Œè¿›è€Œå»ºæ¨¡çš„æ—¶å€™ï¼Œæˆ‘å‘ç°ï¼šæˆ‘ä»¬æ ¹æœ¬ä¸æ‡‚è‰²è°ƒã€é¥±å’Œåº¦ç­‰è§†è§‰ä¿¡æ¯çš„å«ä¹‰ï¼Œæˆ‘ä»¬ä¹Ÿä¸æ‡‚æœºå™¨å­¦ä¹ ã€‚å½“çµé•œéœ€è¦ç»„å»ºä¼—æµ‹å›¢é˜Ÿä»¥æå‡æ•ˆç‡çš„æ—¶å€™ï¼Œæˆ‘å‘ç°ï¼šå›¢é˜Ÿä¸­æ²¡æœ‰äººå¯ä»¥æœ‰æ•ˆåœ°è¿è¥æˆ‘ä»¬çš„ä¼—æµ‹ç”¨æˆ·â€¦â€¦æˆ‘ä»¬é‡åˆ°äº†ä¸€ç³»åˆ—å›°éš¾ï¼Œé¡¹ç›®æ˜¯å¦å°±æ­¤æ‰“ä½ï¼Ÿ</p>
<p>å·¥ç¨‹å¸ˆå¾€å¾€éƒ½ä¼šé«˜ä¼°è‡ªå·±çš„èƒ½åŠ›ï¼Œå¾ˆéš¾æ‰¿è®¤è‡ªå·±çš„å¹³å‡¡ï¼Œæ€»æ˜¯ä¼šè®¤ä¸ºæˆ‘ä»¬ä¹Ÿèƒ½ç å‡ºä¸€ä¸ªæ“ä½œç³»ç»Ÿã€‚å› æ­¤ï¼Œæ¯å½“é‡åˆ°é—®é¢˜çš„æ—¶å€™ï¼Œä¸ºäº†è¯æ˜è‡ªå·±çš„å®åŠ›ï¼Œæ€»æ˜¯ä¼šäº²è‡ªæ¥è§£å†³é—®é¢˜ã€‚å³ä¾¿æ˜¯æœªçŸ¥çš„é¢†åŸŸï¼Œä¹Ÿèƒ½ä¾é è¶…å¼ºçš„å­¦ä¹ èƒ½åŠ›ï¼Œå¿«é€Ÿå­¦ä¹ å¹¶è§£å†³é—®é¢˜ã€‚è¿™ä¹Ÿè®¸æ˜¯ä¸€ä¸ªåŠæ³•ã€‚</p>
<p>ä½†åè¿‡æ¥æƒ³ï¼Œä¸ºä»€ä¹ˆè‡ªå·±çš„å›¢é˜Ÿæˆå‘˜éœ€è¦ä¼šè¿™ä¹ˆå¤šçš„æŠ€èƒ½å‘¢ï¼Ÿä¸ºä»€ä¹ˆä»€ä¹ˆäº‹æƒ…éƒ½è¦è‡ªå·±æå®šï¼Œéƒ½è¦è‡ªç ”å‘¢ï¼Ÿè¿™æ¬¡ï¼Œæˆ‘èµ°äº†å¦ä¸€æ¡è·¯ï¼šå’Œä¸“ä¸šçš„å›¢é˜Ÿè¿›è¡Œåˆä½œï¼Œè®©ä¸“ä¸šçš„äººåšä¸“ä¸šçš„äº‹æƒ…ã€‚</p>
<p>ä»åéªŒç»“æœæ¥çœ‹ï¼Œä¸ä¸“ä¸šçš„å›¢é˜Ÿåˆä½œæ˜¯çµé•œå¿«é€Ÿå‘å±•çš„æœ‰æ•ˆæ³•å®ä¹‹ä¸€ã€‚å¦‚æœæ²¡æœ‰ä¸“ä¸šå›¢é˜Ÿçš„åŠ æŒï¼Œæˆ‘æƒ³ï¼Œæˆ‘ä»¬æˆ–è€…åœ¨æ‹›è˜çš„è·¯ä¸Šï¼Œæˆ–è€…åœ¨æŒ‘ç¯å¤œå­¦ç›¸å…³æŠ€èƒ½çš„è·¯ä¸Šï¼Œåˆæˆ–è€…åœ¨åŸ‹å¤´ä¸åœåœ°è§£å†³ä¸€ä¸ªåˆä¸€ä¸ªçš„ BUGâ€¦â€¦</p>
<h4 id="èµ„æºç½®æ¢">èµ„æºç½®æ¢</h4>
<p>æƒ³è¦å¯»æ‰¾ä¸“ä¸šçš„å›¢é˜Ÿåˆä½œï¼Œé¦–å…ˆè¦é—®ï¼Œåˆ«äººå‡­ä»€ä¹ˆå’Œæˆ‘ä»¬åˆä½œå‘¢ï¼Ÿå¯¹äºæ˜æ˜Ÿé¡¹ç›®è€Œè¨€ï¼Œå› ä¸ºæ˜¯è‡ªé¡¶å‘ä¸‹çš„æ¨¡å¼ï¼Œå› æ­¤åˆä½œä¼šéå¸¸åœ°é¡ºåˆ©ã€‚ä½†æ˜¯ï¼Œå¯¹äºçµé•œè€Œè¨€ï¼Œåˆ«äººå‡­ä»€ä¹ˆè¦ä¸æˆ‘ä»¬åˆä½œå‘¢ï¼Ÿ</p>
<p>åˆä½œçš„æœ¬è´¨æ˜¯äº¤æ˜“ã€æ˜¯èµ„æºç½®æ¢ï¼Œä½ æœ‰ä»€ä¹ˆèµ„æºï¼Œæˆ‘æœ‰ä»€ä¹ˆèµ„æºï¼Œå¤§å®¶äº¤æ¢ä¸€ä¸‹ï¼Œè®²ç©¶çš„æ˜¯å…¬å¹³ã€‚åˆä½œçš„ç›®çš„æ˜¯åˆ›é€ ä»·å€¼ï¼Œè€Œä¸æ˜¯å…±æ‹…é£é™©ï¼Œè¿™æ˜¯æˆ‘åœ¨çµé•œé¡¹ç›®ä¸­è¡ŒåŠ¨çš„æŒ‡å¯¼åŸåˆ™ã€‚</p>
<p>èµ„æºç½®æ¢çš„ç›®çš„æ˜¯åˆä½œåŒæ–¹åˆ©ç”¨èµ„æºç½®æ¢æ¥å®ç°åŒæ–¹çš„å…±èµ¢ï¼Œåœ¨åˆä½œçš„æ—¶å€™ï¼Œä¸è¦æ€»æ˜¯å¥¢æ±‚å¯¹æ–¹çš„ä»˜å‡ºï¼Œæ›´å¤šåœ°è¦æƒ³æ¸…æ¥šï¼šæˆ‘ä»¬æœ‰ä»€ä¹ˆèµ„æºï¼Œæˆ‘ä»¬éœ€è¦ä»€ä¹ˆèµ„æºï¼Œå“ªä¸ªå›¢é˜Ÿæœ‰è¿™æ ·çš„èµ„æºï¼Œæˆ‘ä»¬èƒ½ä¸ºå¯¹æ–¹ä»˜å‡ºçš„èµ„æºåˆ›é€ ä»€ä¹ˆæ ·çš„ä»·å€¼ï¼Ÿ</p>
<p>æ²¡æœ‰çµé•œï¼Œä¸šåŠ¡æ–¹å®Œæˆä¸€æ¬¡è§†é¢‘ç”»è´¨è¯„æµ‹éœ€è¦èŠ±è´¹ 2 å‘¨çš„æ—¶é—´ï¼Œè€Œå¦‚æœä½¿ç”¨çµé•œï¼Œåˆ™è¿™ä¸ªæ—¶é—´ä¼šç¼©çŸ­åˆ° 1 å¤©ï¼Œè¿™æ˜¯çµé•œèƒ½å¤Ÿæä¾›çš„èµ„æºå’Œä»·å€¼ã€‚ç„¶è€Œï¼Œè¿™ä¸ªæ˜¯ WEB ç‰ˆæœ¬çš„çµé•œï¼Œå¦‚æœæƒ³è®©å®éªŒç»“æœæ›´å‡†ç¡®ï¼Œå°±éœ€è¦ iOS/Android ç‰ˆæœ¬çš„çµé•œï¼Œè¿™æ˜¯çµé•œéœ€è¦çš„èµ„æºã€‚å› æ­¤ï¼Œæˆ‘ä»¬å’Œä¸šåŠ¡æ–¹ä»¥è¿™ç§èµ„æºç½®æ¢çš„æ–¹å¼å®ç°äº†çµé•œå’Œä¸šåŠ¡æ–¹çš„å…±èµ¢ã€‚çµé•œå¸®åŠ©ä¸šåŠ¡æå‡äº†è§†é¢‘è¯„æµ‹çš„æ•ˆç‡å’Œç½®ä¿¡åº¦ï¼Œè€Œä¸šåŠ¡æ–¹çš„èµ„æºä¹Ÿè®©çµé•œæ›´å¼ºå¤§ã€‚åŒæ—¶ï¼Œåˆä½œçš„æœ€ç»ˆç»“æœä¹Ÿè®©çµé•œçš„ç«äº‰å£å’å˜å¾—æ›´é«˜ï¼Œè¿™ä¹Ÿå°±æ˜¯æ‰€è°“çš„ 1 + 1 = 10ã€‚</p>
<h4 id="ä»·å€¼å…±äº«">ä»·å€¼å…±äº«</h4>
<p>åˆä½œä¸­å¾€å¾€ä¼šå‡ºç°ï¼šå…±æ‚£éš¾æ˜“ï¼ŒåŒå¯Œè´µéš¾çš„ç°è±¡ã€‚ä»åˆä½œäº§ç”Ÿçš„ä»·å€¼ä¸Šçœ‹ï¼Œæˆ‘ä»¬æ€»ä¼šè®¤ä¸ºè‡ªå·±çš„è´¡çŒ®æ¯”å¯¹æ–¹é«˜ã€‚ä¸æ˜¯å—ï¼Ÿåœ¨æ±‡æŠ¥çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šè¯´ï¼šæˆ‘ä»¬ä¹‹æ‰€ä»¥å–å¾—è¾‰ç…Œæˆå°±ï¼Œä¸»è¦æ˜¯åˆä½œæ–¹çš„å¤§åŠ›æ”¯æŒï¼Ÿè¿™ä¼šå¯¼è‡´ä¸€ç§æ¯”è¾ƒå¥‡æ€ªçš„ç°è±¡ï¼šä¸€ä¸ªé¡¹ç›®ï¼Œæ±‡æŠ¥è¯„å¥–çš„æ—¶å€™æœ‰ 100 ä¸ªäººï¼Œä½†æ˜¯çœŸæ­£å‡ºé—®é¢˜äº†ï¼Œè§£å†³é—®é¢˜çš„æ—¶å€™å¯èƒ½åªæœ‰ 10 ä¸ªäººã€‚</p>
<p>ã€Šå¤§æŸ“åŠã€‹ä¸­çš„é™ˆå¯¿äº­å¯¹å¢å®¶é©¹è¯´ï¼šæ²¡æœ‰å½“åˆè¿™ä¸€æ¡¶æ°´ï¼Œæ´»ä¸äº†æˆ‘è¿™æ¡å¤§é²¤é±¼ã€‚</p>
<p>åœ¨åˆä½œä¸­ï¼Œå¯¹æ–¹çš„ä½œç”¨è¦é«˜äºè‡ªå·±ï¼Œè¦å®šæœŸçš„å’Œåˆä½œæ–¹åšå¥½ä»·å€¼å…±äº«ï¼Œè¿™æ˜¯æŒ‡å¯¼æˆ‘åœ¨æ¨è¿›çµé•œä¸­çš„åˆä¸€ä¸ªåŸåˆ™ã€‚æˆ‘å®šæœŸçš„å’Œæ‰€æœ‰çš„åˆä½œæ–¹å…±äº«çµé•œå½“å‰æ‰€å–å¾—çš„æ”¶ç›Šå’Œä»·å€¼ï¼Œå¹¶å®šæœŸå‘æ‰€æœ‰åˆä½œæ–¹æ±‡æŠ¥çµé•œæ¥ä¸‹æ¥è¦åšä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆè¦åšï¼Œè¿™ä¹ˆåšè¿˜èƒ½è®©æˆ‘ä»¬å¾—åˆ°ä»€ä¹ˆï¼Ÿè¦è®©æ‰€æœ‰çš„åˆä½œæ–¹éšæ—¶äº†è§£ï¼Œå¤§å®¶ä»˜å‡ºçš„èµ„æºæ‰€å–å¾—å’Œåˆ›é€ çš„ä»·å€¼ã€‚</p>
<h2 id="å–„äºæ•´åˆ">å–„äºæ•´åˆ</h2>
<p>æŠ€æœ¯äººå‘˜æ€»è§‰å¾—å†™ä»£ç ã€è®¾è®¡æ¶æ„æ‰æ˜¯æŠ€æœ¯ï¼Œé€šè¿‡çµé•œæˆ‘å‘ç°ï¼Œæ•´åˆä¹Ÿæ˜¯ä¸€ç§æŠ€æœ¯ï¼Œæ•´åˆæœ¬èº«ä¹Ÿéœ€è¦éå¸¸é«˜çš„æŠ€æœ¯èƒ½åŠ›ã€‚åœ¨ CPU å¤§å°çš„èŠ¯ç‰‡ä¸Šé›†æˆ 1 ä¸ªæ™¶ä½“ç®¡å¾ˆç®€å•ï¼Œä½†æ˜¯è¦é›†æˆå‡ åƒä¸‡çš„æ™¶ä½“ç®¡å°±éœ€è¦æ›´é«˜è¶…çš„æŠ€æœ¯äº†ã€‚</p>
<p>å¯¹äºå·¥å…·è€Œè¨€ï¼Œæ•´åˆç‡è¶Šé«˜ï¼Œå·¥å…·çš„æ ‡å‡†åŒ–è¶Šå¥½ã€æŠ€æœ¯è¦æ±‚è¶Šé«˜ã€äººæ€§åŒ–ä¹Ÿè¶Šå¥½ã€‚é«˜åº¦æ•´åˆçš„å·¥å…·å…·å¤‡éå¸¸é‡è¦çš„3ä¸ªç‰¹å¾ï¼šæ ‡å‡†åŒ–ã€ç§‘æŠ€åŒ–ã€äººæ€§åŒ–ã€‚</p>
<p>é€šè¿‡ä¸æ–­åœ°åŠªåŠ›ï¼Œæˆ‘ä»¬å°†è§†é¢‘è¯„æµ‹æ ‡å‡†ã€è§†é¢‘è¯„æµ‹çš„å‡ åç§åœºæ™¯ã€è§†é¢‘åˆ†æç®—æ³•ã€è§†é¢‘å¤„ç†çš„ä¸Šä¸‹æ¸¸é“¾è·¯ç­‰å…¨éƒ¨æ•´åˆåˆ°çµé•œä¸­ï¼Œçµé•œä¹Ÿåœ¨è§†é¢‘è¯„æµ‹ä¸­å‘æŒ¥ç€è¶Šæ¥è¶Šé‡è¦çš„ç»¼åˆæ•ˆåº”ã€‚é€šè¿‡æ•´åˆï¼Œæˆ‘ä»¬è®©çµé•œå˜å¾—ç®€å•ã€æ˜“ç”¨ï¼Œä»ç›®å‰çš„æƒ…å†µçœ‹ï¼Œæˆ‘ä»¬å¯ä»¥è®©ç”¨æˆ· 0 é—¨æ§›ä½¿ç”¨çµé•œè¿›è¡Œç”»è´¨è¯„æµ‹ã€‚</p>
<p>çµé•œä¸ä½†å¯¹è§†é¢‘è¯„æµ‹æŠ€æœ¯è¿›è¡Œæ•´åˆï¼Œè¿˜å¯¹è§†é¢‘æ•°æ®ã€è¯„æµ‹ç”¨æˆ·è¿›è¡Œæ•´åˆï¼Œæœ€ç»ˆä»¥æœåŠ¡çš„å½¢æ€æ¥å‘ˆç°ã€‚è§†é¢‘è¯„æµ‹ï¼Œçµé•œè¶³ä»¥ã€‚</p>
<p>ä¾èµ–æ™ºèƒ½æ‰‹æœºçš„æ•´åˆèƒ½åŠ›ï¼Œæˆ‘ä»¬ä¸ä½†å¯ä»¥æ‰“ç”µè¯ã€å‘çŸ­ä¿¡ï¼Œè¿˜å¯ä»¥æ‹è§†é¢‘ã€ç©æ¸¸æˆã€çœ‹æ–°é—»â€¦â€¦</p>
<h2 id="æœåŠ¡ç²¾ç¥">æœåŠ¡ç²¾ç¥</h2>
<p>åœ¨å…¬å¸æ—¶é—´é•¿äº†ï¼Œæˆ‘ä»¬æ…¢æ…¢åœ°ä¼šä¹ æƒ¯äºå…¬å¸çš„ç»„ç»‡æ¶æ„æ‰€å¸¦æ¥çš„å›¢é˜Ÿä¹‹é—´çš„å…³è”ï¼šPM æå‡ºéœ€æ±‚ï¼ŒRD å®ç°éœ€æ±‚ï¼ŒQA æŠŠæ§è´¨é‡â€¦â€¦</p>
<p>æ¯ä¸€ä¸ªå›¢é˜Ÿéƒ½ä¼šæœ‰å¯¹åº”çš„è§’è‰²æ¥æ‰¿æ‹…å¯¹åº”çš„å·¥ä½œã€‚ä¹…è€Œä¹…ä¹‹ï¼Œæˆ‘ä»¬å°±å½¢æˆäº†ä¸€ç§æ— å½¢çš„å‚²æ…¢ã€‚æˆ‘ä»¬ä¼šæ‰¹åˆ¤ PM çš„éœ€æ±‚ä¸åˆç†ï¼Œæˆ‘ä»¬ä¼šæ‰¹åˆ¤ RD çš„ä»£ç è´¨é‡å¤ªå·®ï¼Œæˆ‘ä»¬ä¼šæ‰¹åˆ¤ QA ä»€ä¹ˆä¹Ÿæµ‹ä¸å‡ºæ¥ï¼Œè¿™ä¸æ˜¯ä¸€ç§æ­£å¸¸çš„çŠ¶æ€ã€‚æˆ‘ä»¬ä¸ä¼šä»¥ä¸€ç§æœåŠ¡çš„å§¿æ€å»å’Œ PEER åˆä½œï¼Œå› ä¸ºæˆ‘ä»¬çŸ¥é“ï¼Œæˆ‘ä»¬æ˜¯å®˜æ–¹æŒ‡å®šçš„å”¯ä¸€çš„éœ€æ±‚æ‰¿æ¥æ–¹ã€‚ä¸æ˜¯å—ï¼Ÿ</p>
<p>å°±åœ¨å‰å‡ å¤©ï¼Œä¸€ä¸ªåŒå­¦é—®æˆ‘ï¼š</p>
<blockquote>
<p>17å“¥ï¼Œæˆ‘ä»¬ä¸ºä»€ä¹ˆä»€ä¹ˆæ ·çš„éœ€æ±‚éƒ½æ¥å‘¢ï¼Ÿ</p>
</blockquote>
<p>æˆ‘è¯´ï¼šè™½ç„¶æˆ‘ä»¬è§„æ¨¡å¾ˆå°ï¼Œä½†æ˜¯æˆ‘æƒ³æŒ‰ç…§ TOB çš„æ¨¡å¼æ¥è¿è¥ï¼Œä»»ä½•éœ€æ±‚ï¼Œæˆ‘ä»¬éƒ½éœ€è¦æ¥ã€‚æˆ‘ä»¬è¦é€šè¿‡æŠ€æœ¯æ‰‹æ®µçš„ä¼˜åŒ–è®©æˆ‘ä»¬å¯ä»¥æ‰¿è½½è¿™äº›éœ€æ±‚ï¼Œè€Œä¸æ˜¯é€šè¿‡åˆ¶åº¦æ–¹å¼æ¥æ‹’ç»æ‰è¿™äº›éœ€æ±‚ã€‚æ‰€æœ‰ä¼ä¸šçš„ä¸è¾è¾›è‹¦ä¸å°±æ˜¯ä¸ºäº†è·å–æ›´å¤šçš„ç”¨æˆ·å’Œéœ€æ±‚å—ï¼Ÿæœ‰å“ªä¸ªé¤å…ä¼šå°†å‰æ¥ç”¨é¤çš„äººæ‹’ä¹‹é—¨å¤–å‘¢ï¼Ÿ</p>
<p>åœ¨ã€Šç”¨æˆ·çœŸæ­£éœ€è¦ä»€ä¹ˆã€‹ä¸­ä»‹ç»äº†ç”¨æˆ·ç§Ÿèµèµ«å…¹å…¬å¸çš„æ±½è½¦å‘ç”Ÿäº†è½¦ç¥¸çš„ä¾‹å­ï¼Œå®¢æœäººå‘˜è¯´ï¼š</p>
<blockquote>
<p>æˆ‘å¸Œæœ›æ‚¨èƒ½ç¡®è®¤ä¸€ä¸‹ï¼Œæ‚¨ç¡®å®šæ²¡äº‹å—ï¼Ÿ</p>
<p>è½¦æ¯äº†ï¼Œèµ«å…¹å…¬å¸éšæ—¶éƒ½å¯ä»¥å†ä¹°ä¸€è¾†ï¼Œä½†æ˜¯ï¼Œæˆ‘ä»¬å¿…é¡»ç¡®ä¿æ‚¨æ²¡äº‹ã€‚</p>
</blockquote>
<p>å½“çµé•œæä¾›çš„æœåŠ¡å‡ºç°å¼‚å¸¸å½±å“åˆ°å¤§å®¶çš„ä½¿ç”¨æ—¶ï¼Œæˆ‘ä»¬å¿…é¡»ç«™åœ¨ç”¨æˆ·çš„è§’åº¦å»æ€è€ƒï¼šå› ä¸ºæˆ‘ä»¬çš„é—®é¢˜ç»™ç”¨æˆ·å¸¦æ¥çš„é—®é¢˜ã€æŸå¤±ä»¥åŠæƒ…ç»ªä¸Šçš„æ³¢åŠ¨ã€‚è€Œä¸æ˜¯ä¸€å¥ç®€å•çš„è¯æœ¯ï¼šæ”¶åˆ°ï¼Œè·Ÿè¿›ä¸­ï¼Œæœ‰ç»“è®ºåŒæ­¥ã€‚</p>
<p>åœ¨æˆ‘çœ‹æ¥ï¼Œçµé•œæ˜¯æˆ‘ä»¬æä¾›è§†é¢‘è¯„æµ‹æœåŠ¡çš„ä¸€ä¸ªå·¥å…·ï¼Œæˆ‘ä»¬ä¸ä½†è¦å»å¼€å‘å·¥å…·ï¼Œè¿˜è¦æ€è€ƒå¦‚ä½•æ‰èƒ½åœ¨æœ‰é™çš„èµ„æºå†…è¾¾æˆæœ€å¥½çš„ç»“æœã€‚æœåŠ¡ç²¾ç¥çš„æ€ç»´ï¼Œæ¿€åŠ±ç€æˆ‘ä»¬ä¸æ–­ä¾èµ–æŠ€æœ¯èƒ½åŠ›æä¾›æ›´å¥½çš„è¯„æµ‹æœåŠ¡ã€‚åªæœ‰èƒ½ä¸ºæ›´å¤šçš„äººæä¾›æœåŠ¡ï¼Œæ‰å¯ä»¥åˆ›é€ æ›´å¤šçš„ä»·å€¼ã€‚</p>
<p>å®é™…ä¸Šï¼Œæˆ‘ä»¬åœ¨æä¾›æ›´å¤šçš„æœåŠ¡çš„åŒæ—¶ï¼Œä¹Ÿå‘ç°äº†æ›´å¤šä¹‹å‰æ²¡æœ‰å‘ç°çš„é—®é¢˜ï¼Œä¾‹å¦‚ <a href="https://wangwei1237.github.io/2022/06/19/Does-1Kbit-equal-1024bit/">1k bit = 1024 bitï¼Ÿ</a>ã€‚åœ¨æä¾›æ›´å¤šæœåŠ¡çš„åŒæ—¶ï¼Œå®¢æˆ·ä¹Ÿåœ¨å¸®åŠ©çµé•œä¸æ–­åœ°å®Œå–„å’Œæˆé•¿ã€‚</p>
<h2 id="å†²åœ¨ä¸€çº¿">å†²åœ¨ä¸€çº¿</h2>
<p>æå®¢é‚¦ç§‘æŠ€æ€»è£æ± å»ºå¼ºåœ¨ <a href="https://mp.weixin.qq.com/s/T2A6sjefoopnnsxUsFAFqA">è¦å†²åœ¨ç¬¬ä¸€çº¿ï¼Œè€Œä¸æ˜¯è„±ç¦»ä¸€çº¿</a> ä¸­è¯´ï¼š</p>
<blockquote>
<p>æ˜¯ä½ å¸¦ç€å¤§å®¶å‘å‰èµ°ï¼Œä¸æ˜¯åŠ¨åŠ¨å˜´ã€è·¯éƒ½è®©åˆ«äººèµ°ã€‚è¿™ä¹ˆå°çš„å›¢é˜Ÿï¼Œä½ è‡ªå·±ä¹Ÿå¾—å¹²æ´»å•Šã€‚</p>
<p>åˆ›ä¸šä¹Ÿæ˜¯ä¸€æ ·ï¼Œä¸è¦ä»¥ä¸ºè‡ªå·±æ˜¯ CEO äº†ï¼Œå®šä¸€ä¸‹æˆ˜ç•¥ã€æ‰¾æ‰¾äººã€æ‰¾æ‰¾é’±å°±å®Œäº‹äº†ã€‚å†™æ–‡ç« ã€å½•è§†é¢‘ã€è®¾è®¡äº§å“å•¥ä¸å¾—è‡ªå·±å¹²å•Šã€‚</p>
</blockquote>
<p>æˆ‘ä¸€ç›´è®¤ä¸ºï¼šåªæœ‰æ·±å…¥ä¸€çº¿ï¼Œä¸ä¸€çº¿æ‰“æˆä¸€ç‰‡ï¼Œæ‰èƒ½å‘ç°é¡¹ç›®ä¸­å­˜åœ¨çš„çœŸæ­£é—®é¢˜ï¼Œæ‰èƒ½åˆ¶å®šæ­£ç¡®çš„æŠ€æœ¯è§„åˆ’ã€‚</p>
<p>ä¸ºäº†æµ‹è¯•â€œå¼ å˜´â€œç‰¹æ•ˆï¼Œå¼ å˜´å¼ åˆ°å˜´æŠ½ç­‹ï¼Œæ‰€ä»¥æˆ‘å‘èµ·äº†æ‘„åƒå¤´Mockçš„é¡¹ç›®ï¼›2020 å¹´ï¼Œæˆ‘åœ¨å¤®è§†å‚ä¸äº†ç™¾åº¦ä¸–ç•Œå¤§ä¼šé‡ä¿ï¼Œæˆ‘å‘ç°äº†å½±å“é¡¹ç›®è¿­ä»£å‘¨æœŸçš„è¯¸å¤šå› ç´ ï¼Œæ‰€ä»¥æˆ‘å‘èµ·äº†ç›´æ’­æµ‹è¯•ä¸­å°çš„é¡¹ç›®ï¼›ä¸ºäº†è§£å†³è§†é¢‘è¯„æµ‹æ•ˆç‡å’Œç½®ä¿¡åº¦çš„é—®é¢˜ï¼Œæˆ‘å‘èµ·äº†çµé•œé¡¹ç›®ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼Œçµé•œæä¾›çš„æ‰€æœ‰èƒ½åŠ›éƒ½æ˜¯åœ¨è§†é¢‘è¯„æµ‹ç¬¬ä¸€çº¿çš„æ‘¸çˆ¬æ»šæ‰“ä¸­é”»é€ å‡ºæ¥çš„ã€‚</p>
<p>çŒ›å°†å¿…å‘äºå’ä¼ï¼Œè„±ç¦»ä¸€çº¿ï¼Œå°±ä¼šå‡ºç°æŸç»æµå­¦å®¶çš„é­”å¹»è¨€è®ºï¼šâ€œç°åœ¨è°å®¶è¿˜æ²¡æœ‰50ä¸‡å‘¢ï¼Ÿä¸­å›½äººæ²¡é‚£ä¹ˆç©·â€¦â€¦ä¸­å›½äººç°çŠ¶å¹³å‡å®¶åº­èµ„äº§300ä¸‡ã€‚â€ã€‚</p>
<h2 id="æ¥å—è´¨ç–‘">æ¥å—è´¨ç–‘</h2>
<p>å½“å¹´æˆ‘è´Ÿè´£å†…å®¹ç”Ÿæ€æµé‡åˆ†æé¡¹ç›®çš„æ—¶å€™ï¼Œä¸€ä¸ªåŒå­¦ç§ä¸‹æ‰¾æˆ‘æŠ±æ€¨é“ï¼š</p>
<blockquote>
<p>17å“¥ï¼Œæˆ‘ä»¬åšçš„è¿™äº›å·¥ä½œ PGM æ ¹æœ¬å°±ä¸€ç‚¹éƒ½ä¸é‡è§†å‘€ã€‚ä½ çœ‹ï¼Œæˆ‘å‘äº†ä¸€å°åˆ†æé‚®ä»¶ï¼ŒPGM åˆ°ç°åœ¨äº†éƒ½ä¸å›ã€‚</p>
</blockquote>
<p>æˆ‘è¯´ï¼šè¿™æ˜¯éå¸¸æ­£å¸¸çš„äº‹æƒ…å‘€ã€‚å‡­ä»€ä¹ˆæˆ‘ä»¬åˆ†æä¸€ä¸ªé—®é¢˜ï¼Œåˆ«äººå°±å¿…é¡»è¦æœ‰å›åº”å‘¢ï¼Ÿè¿™ä¸ªé—®é¢˜æ˜¯ä»€ä¹ˆï¼Œåˆ†æçš„é€»è¾‘æ˜¯å¦æœ‰æ¼æ´ï¼Œæœ‰æ²¡æœ‰åç»­çš„è·Ÿè¿›å»ºè®®ï¼Œèƒ½ç»™äº§å“çš„å‘å±•å¸¦æ¥ä»€ä¹ˆï¼ŒPGM ç°åœ¨æƒ³çš„æ˜¯ä»€ä¹ˆï¼Ÿâ€¦â€¦å¦‚æœå¦‚ä¸Šçš„é—®é¢˜éƒ½å‘ˆç°å¾—éå¸¸æ¸…æ™°äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦æŒç»­åœ°è¾“å‡ºç±»ä¼¼çš„åˆ†æé‚®ä»¶å’ŒæŠ¥å‘Šï¼Œä»¥å¼•èµ· PGM çš„é‡è§†ã€‚</p>
<p>å‰äº›æ—¥å­ï¼Œæˆ‘æœ‰å¹¸å‚åŠ äº†å’Œå¾®å¸§çš„æŠ€æœ¯äº¤æµï¼Œå¾®å¸§è¯´å½“æ—¶ä»–ä»¬çš„ç¼–ç å™¨æ˜¯ä¸–ç•Œç¬¬ä¸€ï¼Œä½†æ˜¯æ²¡æœ‰äººä¿¡ã€‚ç„¶åï¼Œä»–ä»¬å¼€å§‹å‚åŠ  MSU å¤§èµ›ï¼Œç»“æœè¡¨æ˜ä»–ä»¬ç¡®å®æ˜¯ä¸–ç•Œç¬¬ä¸€ï¼Œç„¶åå¤§å®¶éƒ½å¼€å§‹è®¤å¯ä»–ä»¬äº†ã€‚</p>
<p>å¯¹äºåˆšæ¥è§¦åˆ°æˆ‘ä»¬çš„æ‰€æœ‰äººè€Œè¨€ï¼Œå¯¹æˆ‘ä»¬å¿ƒå­˜è´¨ç–‘æ˜¯éå¸¸æ­£å¸¸çš„ä¸€ä»¶äº‹æƒ…ã€‚å¤§å®¶è¦åˆä½œå…±èµ¢ï¼Œå°±å¿…ç„¶è¦çŸ¥æ ¹çŸ¥åº•ï¼Œå°±å¿…ç„¶è¦è€ƒè™‘åˆ°ä½¿ç”¨ä½ çš„èƒ½åŠ›æ‰€å¸¦æ¥çš„é£é™©ï¼Œå°±å¿…ç„¶ä¼šæœ‰æ‰€è´¨ç–‘ã€‚æˆ‘ä»¬è¦æ ¹æ®å¤§å®¶çš„è´¨ç–‘ï¼Œæ‰¾åˆ°è¡Œä¹‹æœ‰æ•ˆçš„æ–¹å¼æ¥æ¶ˆé™¤å¤§å®¶çš„ç–‘è™‘ï¼Œè€Œä¸æ˜¯ä¸€å‘³åœ°å¯¹æŠ—ã€‚</p>
<p>çµé•œçš„ä¸šåŠ¡è½åœ°å®è·µè¿‡ç¨‹ä¸­ï¼Œä¹Ÿä¼šå—åˆ°å„ç§å„æ ·çš„è´¨ç–‘ï¼Œæˆ‘ä»¬ä¼šä¸åœåœ°ç»„ç»‡å‘å¤§å®¶åˆ†äº«çµé•œçš„æŠ€æœ¯æ–¹æ¡ˆï¼Œä¸åœåœ°å°†çµé•œçš„èƒ½åŠ›æ–‡æ¡£åŒ–ï¼Œä¸åœåœ°ä»‹ç»ä¸ºä»€ä¹ˆçµé•œçš„æ•ˆç‡ä¼šæ›´é«˜ã€çµé•œçš„ç»“æœä¼šæ›´ç½®ä¿¡â€¦â€¦æˆ‘ä»¬ä¹Ÿå¼€å§‹åœ¨å„ä¸ªæ¸ é“ï¼ˆå…¨çƒé¡¶çº§éŸ³è§†é¢‘ç¤¾åŒº LiveVideoStackï¼Œç™¾åº¦Geekè¯´ï¼Œæœ¯è¯´â€¦â€¦ï¼‰å‘è¡¨æ–‡ç« ï¼Œä»‹ç»æˆ‘ä»¬çš„å·¥ä½œã€‚æ‰€ä»¥æˆ‘å‘ç°ï¼Œæœ‰å¾ˆå¤šçš„æ—¶å€™ï¼Œæˆ‘çš„å·¥ä½œä¼šä»è®¾è®¡æ¶æ„ã€ç¼–ç å˜æˆå†™æ–‡ç« ã€å†™PPTã€å†™æ–‡æ¡£â€¦â€¦</p>
<p>è´¨ç–‘æ˜¯ä¸€ä»¶å¥½äº‹ï¼Œæˆ‘ä»¬è¦ä¹äºæ¥å—å¤§å®¶çš„è´¨ç–‘ï¼Œæˆ‘ä»¬æ‰€è¦åšçš„æ˜¯å°½ä¸€åˆ‡åŠªåŠ›æ¶ˆé™¤å¤–ç•Œå¯¹æˆ‘ä»¬çš„è´¨ç–‘ã€‚</p>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>ä»å°äº‹åšèµ·ï¼Œå¿—å­˜é«˜è¿œï¼Œç¡®å®šå¥½ç›®æ ‡ï¼Œç›˜ç‚¹å¥½èµ„æºï¼Œä»¥æœåŠ¡ç²¾ç¥ï¼Œå’Œä¸“ä¸šçš„å›¢é˜Ÿåˆä½œå…±èµ¢ã€‚å¿ƒæœ‰çŒ›è™ï¼Œç»†å—…è”·è–‡ï¼ŒæŠŠå°äº‹æƒ…ä¸æ–­åšå¤§ï¼ŒæŠŠå¹³å‡¡çš„é¡¹ç›®åšå‡ºä¸å¹³å‡¡çš„ä»·å€¼ï¼Œæ˜Ÿæ˜Ÿä¹‹ç«ï¼Œå¯ä»¥ç‡åŸã€‚</p>
]]></content>
      <categories>
        <category>æ–‡åŒ–</category>
      </categories>
      <tags>
        <tag>å»¶å±•</tag>
        <tag>æ•´åˆ</tag>
        <tag>åˆä½œ</tag>
      </tags>
  </entry>
  <entry>
    <title>è§†é¢‘ä¸­ä¸ºä»€ä¹ˆéœ€è¦è¿™ä¹ˆå¤šçš„é¢œè‰²ç©ºé—´ï¼Ÿ</title>
    <url>/2022/08/14/Why-so-much-color-space-in-video/</url>
    <content><![CDATA[<p><img src="/2022/08/14/Why-so-much-color-space-in-video/1.jpeg" alt></p>
<p>åœ¨è§†é¢‘å¤„ç†ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šç”¨åˆ°ä¸åŒçš„è‰²å½©ç©ºé—´ï¼š<code>éçº¿æ€§RGB</code>ï¼Œ<code>çº¿æ€§ RGB</code>ï¼Œ<code>YUV</code>ï¼Œ<code>XYZ</code>â€¦â€¦ä¸ºä»€ä¹ˆéœ€è¦è¿™ä¹ˆå¤šçš„è‰²å½©ç©ºé—´å‘¢ï¼Ÿä¸ºä»€ä¹ˆåœ¨ FFmpeg ä¸­ä¼šæœ‰ <code>color_space</code>ï¼Œ<code>color_transfer</code>ï¼Œ<code>color_primaries</code> ç­‰ä¸€ç³»åˆ—çš„é¢œè‰²å±æ€§å‘¢ï¼Ÿè¿™äº›æœ¯è¯­ä¹‹é—´ç©¶ç«Ÿéšè—ç€ä»€ä¹ˆç§˜å¯†ï¼Ÿ</p>
<span id="more"></span>
<h2 id="è§†é¢‘é‡‡é›†">è§†é¢‘é‡‡é›†</h2>
<p><img src="/2022/08/14/Why-so-much-color-space-in-video/2.png" alt></p>
<p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œåœ¨ç›¸æœºç³»ç»Ÿä¸­ï¼Œå¤–éƒ¨ä¸–ç•Œçš„å…‰ä¿¡æ¯ï¼ˆå…‰å­ï¼Œphotonsï¼‰é€šè¿‡é€é•œæˆ–å…¶ä»–å…‰å­¦å™¨ä»¶èšç„¦ä¹‹åè¾¾åˆ°ç›¸æœºçš„å›¾åƒä¼ æ„Ÿå™¨ï¼ˆ<a href="https://en.wikipedia.org/wiki/Charge-coupled_device">CCD</a> æˆ–è€… <a href="https://en.wikipedia.org/wiki/Active-pixel_sensor">CMOS</a>ï¼‰ã€‚<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup></p>
<ul>
<li>å›¾åƒä¼ æ„Ÿå™¨å¯ä»¥å°†ä¸€ä¸ªå…¥å°„å…‰å­ï¼ˆphotonï¼‰è½¬æ¢ä¸ºå¯¹åº”çš„ä¸€ä¸ªç”µå­ï¼ˆelectronï¼‰ã€‚</li>
<li>åœ¨æ›å…‰æ—¶é—´å†…ï¼Œå›¾åƒä¼ æ„Ÿå™¨å¯¹è½¬æ¢çš„ç”µå­è¿›è¡Œç”µè·ç§¯ç´¯ã€‚</li>
<li>ç„¶åï¼Œå›¾åƒä¼ æ„Ÿå™¨ä¼šå°†ç§¯ç´¯çš„ç”µè·ä¿¡å·è½¬æ¢æˆå¯¹åº”çš„ç”µå‹ä¿¡å·ã€‚</li>
<li>æœ€åï¼Œåˆ©ç”¨ <a href="https://en.wikipedia.org/wiki/Analog-to-digital_converter">ADC</a> æŠŠç”µä¿¡å·è½¬æ¢æˆæ•°å­—ä¿¡å·ï¼Œè€Œè½¬æ¢åçš„æ•°å­—ä¿¡å·åˆ™ä¸ºæŸä¸ªèŒƒå›´å†…çš„æ•´æ•°å€¼ã€‚</li>
</ul>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition note"><p class="admonition-title">ADC æ•°å­—ä¿¡å·çš„å–å€¼èŒƒå›´
</p><p>ADC è½¬æ¢ä¹‹åçš„æ•°å­—ä¿¡å·çš„å–å€¼èŒƒå›´å—é™äº ADC è®¾å¤‡ã€‚å¯¹äº 8-bits çš„ ADC è€Œè¨€ï¼Œæ•°å­—ä¿¡å·çš„å–å€¼èŒƒå›´ä¸º [0, 2^8-1]ï¼Œå› æ­¤ï¼Œå¯¹äºæ¯ä¸€ä¸ªåƒç´ è€Œè¨€ï¼Œä¼šç”¨ [0, 255] ä¹‹é—´çš„æ•´æ•°æ¥è¿›è¡Œç¼–ç ã€‚</p>
</div>
<p><img src="/2022/08/14/Why-so-much-color-space-in-video/3.jpeg" alt></p>
<p>ADC è½¬æ¢çš„æ•°å­—ä¿¡å·çš„æ•°å€¼æ˜¯ä¸€ä¸ªçº¿æ€§ç¼–ç çš„è¿‡ç¨‹ï¼Œè¿™æ„å‘³ç€å¦‚æœå°†å›¾åƒä¼ æ„Ÿå™¨ä¸Šçš„å…‰é‡å¢åŠ  1 å€ï¼Œåˆ™ ADC è½¬æ¢ä¹‹åå¯¹åº”çš„æ•°å€¼ä¹Ÿä¼šå¢åŠ  1 å€ã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„ç‰¹æ€§ï¼šæ— è®ºæ˜¯å¢åŠ ç‰©ç†ä¸–ç•Œçš„å…‰é‡ï¼Œè¿˜æ˜¯å¢åŠ  ADC è½¬æ¢ä¹‹åçš„æ•°å€¼ï¼Œå¯¹å›¾ç‰‡è€Œè¨€ï¼Œéƒ½ä¼šå¸¦æ¥ç›¸åŒçš„æ•ˆæœã€‚çº¿æ€§ç¼–ç æ„å‘³ç€æˆ‘ä»¬æ‰€å¤„ç†çš„æ•°æ®å’Œå…‰å‘å°„çš„å¼ºåº¦æˆæ­£æ¯”å…³ç³»ã€‚<sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup></p>
<p>ç”±æ•°ç ç›¸æœºä¸­çš„ CMOS ä¼ æ„Ÿå™¨äº§ç”Ÿå¹¶å†™å…¥åŸå§‹æ–‡ä»¶ï¼ˆRaw Fileï¼‰çš„æ•°æ®æ˜¯çº¿æ€§çš„ã€‚ä¸æ™®é€šç…§ç‰‡ç›¸æ¯”ï¼Œçº¿æ€§æ•°æ®é€šå¸¸çœ‹èµ·æ¥éå¸¸æš—ä¸”å¯¹æ¯”åº¦è¾ƒä½ã€‚<sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup></p>
<p><img src="/2022/08/14/Why-so-much-color-space-in-video/4.jpg" alt></p>
<p>åœ¨ iPhone æ‰‹æœºä¸­ï¼Œå¯ä»¥é€šè¿‡è®¾ç½®ç›¸æœºæ¥æ‹æ‘„ <a href="https://support.apple.com/zh-cn/HT211965">Apple ProRAW</a> æ ¼å¼çš„ç…§ç‰‡ã€‚</p>
<h2 id="è§†é¢‘ä¼½é©¬æ ¡æ­£">è§†é¢‘ä¼½é©¬æ ¡æ­£</h2>
<p>å®é™…ä¸Šï¼Œç ”ç©¶è¡¨æ˜ï¼Œäººç±»è§†è§‰ç³»ç»Ÿæ˜¯ä»¥å¯¹æ•°å‡½æ•°çš„æ–¹å¼æ¥æ„ŸçŸ¥å…‰äº®åº¦ã€‚è¿™æ„å‘³ç€ï¼Œäººçœ¼ä¼šæé«˜æš—éƒ¨çš„æ•æ„Ÿåº¦ï¼Œé™ä½é«˜å…‰éƒ¨åˆ†çš„æ•æ„Ÿåº¦ã€‚<sup class="footnote-ref"><a href="#fn4" id="fnref4">[4]</a></sup></p>
<p><img src="/2022/08/14/Why-so-much-color-space-in-video/5.png" alt></p>
<p>ä»æ•°å­¦è§’åº¦çœ‹ï¼Œæ„ŸçŸ¥å…‰å¼ºåº¦å’Œæµ‹é‡å…‰å¼ºåº¦ä¹‹é—´å­˜åœ¨ä¸€ä¸ªè¿‘ä¼¼çš„å¹³æ–¹å…³ç³»ï¼Œå…·ä½“å¦‚ä¸‹å¼æ‰€ç¤ºã€‚</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>è¿‘ä¼¼æ„ŸçŸ¥äº®åº¦</mtext><mo>=</mo><msqrt><mtext>æµ‹é‡äº®åº¦</mtext></msqrt></mrow><annotation encoding="application/x-tex">\text{è¿‘ä¼¼æ„ŸçŸ¥äº®åº¦} = \sqrt{\text{æµ‹é‡äº®åº¦}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord text"><span class="mord cjk_fallback">è¿‘ä¼¼æ„ŸçŸ¥äº®åº¦</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.06445999999999996em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9755400000000001em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord text"><span class="mord cjk_fallback">æµ‹é‡äº®åº¦</span></span></span></span><span style="top:-2.93554em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.06445999999999996em;"><span></span></span></span></span></span></span></span></span></span></p>
<p>ç”±äºäººç±»è§†è§‰æ„ŸçŸ¥ç³»ç»Ÿä¸æ˜¯ä»¥çº¿æ€§æ–¹å¼å·¥ä½œçš„ï¼Œå› æ­¤å¿…é¡»ä½¿ç”¨éçº¿æ€§æ›²çº¿æ¥å¯¹ ADC ç”Ÿæˆçš„çš„çº¿æ€§æ•°æ®è¿›è¡Œå˜æ¢ï¼Œä»è€Œä½¿å¾—æ‹æ‘„çš„å›¾åƒè‰²è°ƒä¸æˆ‘ä»¬çš„è§†è§‰ç³»ç»Ÿçš„å·¥ä½œæ–¹å¼ç›¸åŒ¹é…ã€‚è¿™ä¸ªè¿‡ç¨‹ä¹Ÿå°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„ <a href="https://en.wikipedia.org/wiki/Gamma_correction">ä¼½é©¬æ ¡æ­£</a>ã€‚</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>V</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub><mo>=</mo><msubsup><mi>V</mi><mrow><mi>i</mi><mi>n</mi></mrow><mi>Î³</mi></msubsup></mrow><annotation encoding="application/x-tex">V_{out}=V_{in}^{\gamma}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.059164em;vertical-align:-0.276864em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7822999999999999em;"><span style="top:-2.4231360000000004em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span></span></span></span><span style="top:-3.180908em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05556em;">Î³</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.276864em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>å› æ­¤ï¼Œåœ¨ä»çº¿æ€§ RGB ç©ºé—´è½¬æ¢åˆ°éçº¿æ€§ RGB ç©ºé—´æ—¶ï¼Œéœ€è¦ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î³</mi></mrow><annotation encoding="application/x-tex">\gamma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05556em;">Î³</span></span></span></span> ä½œä¸ºè½¬æ¢å‚æ•°ã€‚ç›¸æœºä¸­çš„ ISP æ¨¡å—è´Ÿè´£å¯¹å›¾åƒä¼ æ„Ÿå™¨çš„çº¿æ€§ RGB è¿›è¡Œä¼½é©¬æ ¡æ­£è¿›è€Œäº§ç”Ÿå¯¹åº”çš„ç¬¦åˆäººçœ¼æ„ŸçŸ¥çš„éçº¿æ€§ RGB æ•°æ®ã€‚</p>
<p><img src="/2022/08/14/Why-so-much-color-space-in-video/6.png" alt></p>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition note"><p class="admonition-title">RGB çš„è®¾å¤‡ä¾èµ–æ€§
</p><p>ä¸åŒæ˜¾ç¤ºè®¾å¤‡æ”¯æŒçš„è‰²åŸŸç©ºé—´ä¸åŒï¼Œå› æ­¤å¯¹äºä¸åŒçš„æ˜¾ç¤ºè®¾å¤‡è€Œè¨€ï¼Œä¼½é©¬æ ¡æ­£ä¹‹åçš„ RGB æ•°å€¼ä¹Ÿä¸åŒã€‚ä»è¿™ä¸ªè§’åº¦è®²ï¼ŒRGB æ˜¯è®¾å¤‡ä¾èµ–å‹çš„è‰²å½©ç©ºé—´ã€‚</p>
</div>
<h2 id="è§†é¢‘å‹ç¼©">è§†é¢‘å‹ç¼©</h2>
<p>æ ¹æ®å¦‚ä¸Šçš„ä¿¡æ¯ï¼Œæˆ‘ä»¬çŸ¥é“ï¼šç›¸æœºç³»ç»Ÿç»è¿‡ ISP å¤„ç†ä¹‹åï¼Œæœ€ç»ˆä¼šå¾—åˆ°éçº¿æ€§çš„ RGB ä¿¡æ¯ã€‚å¯¹äºè§†é¢‘è€Œè¨€ï¼Œå¦‚æœä»¥ RGB å­˜å‚¨æ¯å¸§çš„ä¿¡æ¯ï¼Œåˆ™éœ€è¦æ¶ˆè€—å¤§é‡çš„å­˜å‚¨ç©ºé—´ã€‚</p>
<p>äººç±»è§†è§‰ç³»ç»Ÿå¯¹é¢œè‰²ä¿¡æ¯çš„æ•æ„Ÿåº¦è¦å¼±äºäº®åº¦ä¿¡æ¯ï¼Œåˆ©ç”¨è¿™ä¸€ç‰¹ç‚¹ï¼Œé€šå¸¸ç›¸æœºä¼šå°†æ•è·çš„ RGB ä¿¡æ¯è½¬æ¢ä¸º <a href="https://en.wikipedia.org/wiki/YUV">YUV</a> æ ¼å¼ï¼Œç„¶åå¯¹ YUV æ ¼å¼è¿›è¡Œè‰²åº¦ä¿¡æ¯é‡‡æ ·ï¼ˆä¾‹å¦‚ï¼ŒYUV420ï¼‰ä»¥ä¾¿å‹ç¼©å›¾åƒç©ºé—´ã€‚</p>
<p>RGB-&gt;YUVï¼Œä¸åŒæ ‡å‡†æœ‰ä¸åŒè¦æ±‚ï¼Œä¸€èˆ¬å¸¸ç”¨çš„æ ‡å‡†æœ‰ï¼š</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Rec._601">BT. 601(SD: Standard-Definition)</a></li>
<li><a href="https://en.wikipedia.org/wiki/Rec._709">BT. 709(HD: High-Definition)</a></li>
<li><a href="https://en.wikipedia.org/wiki/Rec._2020">BT. 2020(UHD: Ultra-High-Definition)</a></li>
</ul>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition note"><p class="admonition-title">æ³¨æ„
</p><p>æ ‡å‡†ä¸­ï¼Œä¸ä½†ä¼šè§„å®š RGB-&gt;YUV çš„è½¬æ¢ç³»æ•°ï¼ŒåŒæ—¶è¿˜ä¼šè§„å®šä»çº¿æ€§ RGB åˆ°éçº¿æ€§ RGB è½¬æ¢çš„ gamma ç³»æ•°ã€‚</p>
</div>
<p>å°† RGBé¢œè‰²æ¨¡å‹ï¼Œè½¬æ¢æˆ YUV æ¨¡å‹åï¼Œæ¥ä¸‹æ¥ä¼šé‡‡ç”¨æŸç§è§†é¢‘ç¼–è§£ç ç®—æ³•ï¼ˆä¾‹å¦‚ï¼ŒH265, VP9ï¼‰å¯¹è·å–çš„æ•°æ®è¿›è¡Œè§†é¢‘ç¼–ç ï¼Œæœ€ç»ˆå¾—åˆ°è§†é¢‘æ–‡ä»¶ï¼ˆæ­¤å¤„å¿½ç•¥äº†éŸ³é¢‘çš„é‡‡é›†ç¼–ç ä»¥åŠåˆæµçš„æ“ä½œï¼‰ã€‚</p>
<p><img src="/2022/08/14/Why-so-much-color-space-in-video/7.png" alt></p>
<h2 id="è§†é¢‘è½¬ç ">è§†é¢‘è½¬ç </h2>
<p>å‡ºäºå„ç§åŸå› ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>ç»ˆç«¯ç”¨æˆ·çš„å¸¦å®½å—é™</li>
<li>ç»ˆç«¯ç”¨æˆ·æ”¯æŒçš„è§†é¢‘ç¼–è§£ç ç®—æ³•å’Œç›¸æœºå‹ç¼©è§†é¢‘çš„ç¼–è§£ç ç®—æ³•ä¸ä¸€è‡´</li>
<li>â€¦â€¦</li>
</ul>
<p>ä¸€èˆ¬ä¸ä¼šç›´æ¥æŠŠç›¸æœºäº§å‡ºçš„è§†é¢‘æ–‡ä»¶åˆ†å‘ç»™ç”¨æˆ·å»æ¶ˆè´¹ã€‚åª’ä½“æœåŠ¡å•†ä¼šå¯¹ç›¸æœºç”Ÿæˆçš„è§†é¢‘æ–‡ä»¶è¿›è¡Œè½¬ç ï¼Œç„¶åé€‰æ‹©åˆé€‚çš„è½¬ç åçš„è§†é¢‘åˆ†å‘ç»™ç»ˆç«¯æ¶ˆè´¹ç”¨æˆ·ã€‚<sup class="footnote-ref"><a href="#fn5" id="fnref5">[5]</a></sup></p>
<p>åœ¨è§†é¢‘è½¬ç é˜¶æ®µï¼Œå¦‚æœæˆ‘ä»¬å¸Œæœ›å¯¹åŸè§†é¢‘è¿›è¡Œè‰²åŸŸçš„å˜æ¢ï¼Œä¾‹å¦‚ä» BT. 601 è½¬ç ä¸º BT. 709ï¼Œåˆ™éœ€è¦åœ¨ä¸åŒè‰²åŸŸçš„ RGB æ•°å€¼ä¹‹é—´è¿›è¡Œè½¬æ¢ã€‚<sup class="footnote-ref"><a href="#fn6" id="fnref6">[6]</a></sup></p>
<p>åœ¨ä¸åŒçš„è‰²åŸŸç©ºé—´è¿›è¡Œ RGB æ•°æ®çš„è½¬æ¢ï¼Œè¿™ä¹Ÿå°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„ <a href="https://en.wikipedia.org/wiki/Color_management">è‰²å½©ç®¡ç†</a>ã€‚è‰²å½©ç®¡ç†ä¼šå¯¹å›¾åƒè¿›è¡Œè‰²å½©ç®¡ç†ä»¥é€‚é…å½“å‰ç¯å¢ƒä¸‹çš„é¢œè‰²æ•ˆæœï¼Œä»è€Œä¿è¯åŒä¸€å¼ å›¾ç‰‡åœ¨ä¸åŒè¾“å…¥ã€è¾“å‡ºä¸Šéƒ½å‘ˆç°å‡ºæœ€å¥½çš„é¢œè‰²ã€‚<sup class="footnote-ref"><a href="#fn7" id="fnref7">[7]</a></sup></p>
<p>è‰²å½©è½¬æ¢éœ€è¦åœ¨æŸä¸ªçº¿æ€§ç©ºé—´ä¸‹è¿›è¡Œæ“ä½œï¼Œå¹¶ä¸”æ“ä½œè¿‡ç¨‹éœ€è¦ä¿æŒè®¾å¤‡çš„ç‹¬ç«‹æ€§ã€‚å› æ­¤ï¼Œä¸åŒçš„ RGB è‰²åŸŸç©ºé—´æ˜¯ä¸èƒ½ç›´æ¥è¿›è¡Œè½¬æ¢çš„ï¼Œéœ€è¦ä¸€ä¸ªè®¾å¤‡æ— å…³ã€çº¿æ€§çš„é¢œè‰²æ¨¡å‹ä½œä¸ºä¸­è½¬æ‰èƒ½å®ç°å…¶è½¬æ¢ã€‚</p>
<p>è€Œ <a href="https://en.wikipedia.org/wiki/CIE_1931_color_space">XYZ(CIE 1931 XYZ color space)</a> å…·å¤‡è®¾å¤‡æ— å…³ã€çº¿æ€§æ“ä½œçš„ç‰¹æ€§ã€‚</p>
<p>åœ¨ FFmpeg ä¸­ï¼Œä¸»è¦ä½¿ç”¨ <a href="https://github.com/FFmpeg/FFmpeg/blob/master/libavfilter/vf_colorspace.c">colorspace æ»¤é•œ</a> æ¥å®Œæˆä¸åŒè‰²åŸŸç©ºé—´çš„è½¬æ¢ã€‚<sup class="footnote-ref"><a href="#fn6" id="fnref6:1">[6:1]</a></sup>æ ¹æ® colorspace çš„å®ç°å¯çŸ¥ï¼Œåœ¨ FFmpeg ä¸­ï¼ŒBT. 601-&gt;BT. 709 çš„è½¬æ¢è¿‡ç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="/2022/08/14/Why-so-much-color-space-in-video/15.png" alt></p>
<p>åœ¨å¦‚ä¸Šçš„å˜æ¢ä¸­ï¼Œæ¶‰åŠåˆ° 3 ä¸ªé¢œè‰²ç©ºé—´çš„è½¬æ¢ï¼Œåˆ†åˆ«æ˜¯ï¼š</p>
<ol>
<li>YUV å’Œ RGB ä¹‹é—´çš„è½¬æ¢</li>
<li>çº¿æ€§ RGB å’Œéçº¿æ€§ RGB ä¹‹é—´çš„è½¬æ¢</li>
<li>çº¿æ€§ RGB å’Œ XYZ ä¹‹é—´çš„è½¬æ¢</li>
</ol>
<p>åœ¨ FFmpeg ä¸­ï¼Œæ‰€æœ‰çš„è¿™äº›è½¬æ¢å‚æ•°éƒ½ä¿å­˜åœ¨ <a href="https://ffmpeg.org/doxygen/trunk/structAVFrame.html">AVFrame</a> ç»“æ„ä¸­<sup class="footnote-ref"><a href="#fn8" id="fnref8">[8]</a></sup>ï¼š</p>
<ul>
<li>AVFrame-&gt;<a href="https://ffmpeg.org/doxygen/trunk/structAVFrame.html#a9262c231f1f64869439b4fe587fe1710">colorspace</a> ä¸­ä¿å­˜äº† YUV/RGB çš„è½¬æ¢çŸ©é˜µ</li>
<li>AVFrame-&gt;<a href="https://ffmpeg.org/doxygen/trunk/structAVFrame.html#ab09abb126e3922bc1d010cf044087939">color_trc</a> ä¸­ä¿å­˜äº†çº¿æ€§ RGB å’Œéçº¿æ€§ RGB ä¹‹é—´çš„è½¬æ¢å‡½æ•°ï¼ˆtransformation characteristicsï¼‰ã€‚</li>
<li>AVFrame-&gt;<a href="color_primaries">color_primaries</a> ä¸­ä¿å­˜äº† RGB/XYZ çš„è½¬æ¢çŸ©é˜µ</li>
</ul>
<p>å¦‚æœç”¨ <code>ffprobe</code> å‘½ä»¤è§£æè§†é¢‘æ–‡ä»¶ï¼Œåˆ™ï¼š</p>
<ul>
<li>color_space å­—æ®µå¯¹åº” YUV/RGB çš„è½¬æ¢çŸ©é˜µ</li>
<li>color_transfer å­—æ®µå¯¹åº”çº¿æ€§ RGB å’Œéçº¿æ€§ RGB ä¹‹é—´çš„è½¬æ¢å‡½æ•°</li>
<li>color_primaries å­—æ®µå¯¹åº” RGB/XYZ çš„è½¬æ¢çŸ©é˜µ</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ ffprobe -select_streams v:0 -show_entries stream&#x3D;color_space,color_transfer,color_primaries test.mp4</span><br><span class="line"></span><br><span class="line">[STREAM]</span><br><span class="line">color_space&#x3D;bt2020nc</span><br><span class="line">color_transfer&#x3D;arib-std-b67</span><br><span class="line">color_primaries&#x3D;bt2020</span><br><span class="line">[&#x2F;STREAM]</span><br></pre></td></tr></table></figure>
<p>åœ¨å¦‚ä¸Šçš„ä¾‹å­ä¸­ï¼Œ<a href="https://ffmpeg.org/doxygen/trunk/pixfmt_8h.html#ad4791ea14975f098b649db7fcd731ce6">arib-std-b67</a> ä¹Ÿå°±æ˜¯æˆ‘ä»¬æ‰€ç†Ÿæ‚‰çš„ HLGã€‚</p>
<p>åœ¨ <code>MediaInfo</code> ä¸­ï¼Œ</p>
<ul>
<li>Matrix coefficients å­—æ®µå¯¹åº” YUV/RGB çš„è½¬æ¢çŸ©é˜µ</li>
<li>Transfer characteristic å­—æ®µå¯¹åº”çº¿æ€§ RGB å’Œéçº¿æ€§ RGB ä¹‹é—´çš„è½¬æ¢å‡½æ•°</li>
<li>Color primaries å­—æ®µå¯¹åº” RGB/XYZ çš„è½¬æ¢çŸ©é˜µ</li>
</ul>
<p>é™¤äº†å¦‚ä¸Šçš„å‚æ•°å¤–ï¼ŒAVFrame-&gt;<a href="https://ffmpeg.org/doxygen/trunk/pixfmt_8h.html#a3da0bf691418bc22c4bcbe6583ad589a">range</a> è¿˜ç”¨æ¥å­˜å‚¨è§†é¢‘ä¸­å¯¹åº”åƒç´ çš„æ¯ä¸ªåˆ†é‡çš„å–å€¼èŒƒå›´ã€‚åœ¨ <a href="https://github.com/FFmpeg/FFmpeg/blob/a78f136f3fa039fd7ad664fd6e6e976f1448c68b/libavfilter/vf_setparams.c">vf_setparams.c</a> ä¸­ä¹Ÿä½œäº†ç›¸å…³çš„å®šä¹‰è¯´æ˜ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;&quot;limited&quot;, NULL, 0, AV_OPT_TYPE_CONST, &#123;.i64&#x3D;AVCOL_RANGE_MPEG&#125;,  0, 0, FLAGS, &quot;range&quot;&#125;,</span><br><span class="line">&#123;&quot;tv&quot;,      NULL, 0, AV_OPT_TYPE_CONST, &#123;.i64&#x3D;AVCOL_RANGE_MPEG&#125;,  0, 0, FLAGS, &quot;range&quot;&#125;,</span><br><span class="line">&#123;&quot;mpeg&quot;,    NULL, 0, AV_OPT_TYPE_CONST, &#123;.i64&#x3D;AVCOL_RANGE_MPEG&#125;,  0, 0, FLAGS, &quot;range&quot;&#125;,</span><br><span class="line">&#123;&quot;full&quot;,    NULL, 0, AV_OPT_TYPE_CONST, &#123;.i64&#x3D;AVCOL_RANGE_JPEG&#125;,  0, 0, FLAGS, &quot;range&quot;&#125;,</span><br><span class="line">&#123;&quot;pc&quot;,      NULL, 0, AV_OPT_TYPE_CONST, &#123;.i64&#x3D;AVCOL_RANGE_JPEG&#125;,  0, 0, FLAGS, &quot;range&quot;&#125;,</span><br><span class="line">&#123;&quot;jpeg&quot;,    NULL, 0, AV_OPT_TYPE_CONST, &#123;.i64&#x3D;AVCOL_RANGE_JPEG&#125;,  0, 0, FLAGS, &quot;range&quot;&#125;,</span><br></pre></td></tr></table></figure>
<h2 id="è§†é¢‘è§£ç -æ’­æ”¾">è§†é¢‘è§£ç &amp;æ’­æ”¾</h2>
<p>è½¬ç ä¹‹åçš„è§†é¢‘ï¼Œå¯ä»¥é€šè¿‡å„ç§æ¸ é“åˆ†å‘åˆ°ç»ˆç«¯ç”¨æˆ·è¿›è¡Œæ¶ˆè´¹ã€‚å¯¹äºå¤§éƒ¨åˆ†æ˜¾ç¤ºè®¾å¤‡ï¼Œä¾‹å¦‚CRTæ˜¾ç¤ºå™¨ã€LCDã€OLEDï¼Œå±å¹•ä¸Šçš„æ¯ä¸ªåƒç´ éƒ½æ˜¯é€šè¿‡é©±åŠ¨ä¸‰ä¸ªéå¸¸é è¿‘ä½†ä»ç„¶åˆ†å¼€çš„å°å‹ RGB å…‰æºè€Œæ„å»ºçš„ã€‚<sup class="footnote-ref"><a href="#fn9" id="fnref9">[9]</a></sup> å› æ­¤ï¼Œæ˜¾ç¤ºå±ï¼ˆç›‘è§†å™¨ï¼Œç”µè§†æœºï¼Œå±å¹•ç­‰ç­‰ï¼‰ä»…ä½¿ç”¨ RGB æ¨¡å‹ï¼Œå¹¶ä»¥ä¸åŒçš„æ–¹å¼æ¥ç»„ç»‡ï¼Œå¹¶æ˜¾ç¤ºæœ€ç»ˆçš„å›¾åƒã€‚<sup class="footnote-ref"><a href="#fn10" id="fnref10">[10]</a></sup></p>
<p><img src="/2022/08/14/Why-so-much-color-space-in-video/8.jpeg" alt></p>
<p>å¦‚å‰æ‰€è¿°ï¼Œä¸åŒçš„æ˜¾ç¤ºè®¾å¤‡é‡‡ç”¨çš„ RGB çš„è‰²åŸŸå¹¶ä¸ä¸€å®šç›¸åŒï¼Œå› æ­¤ï¼ŒRGB æ˜¯ä¸€ç§è®¾å¤‡ä¾èµ–å‹çš„é¢œè‰²æ¨¡å‹ã€‚<sup class="footnote-ref"><a href="#fn11" id="fnref11">[11]</a></sup>åœ¨ Mac ç”µè„‘ä¸Šï¼Œå¯ä»¥é€šè¿‡æ˜¾ç¤ºå™¨é…ç½®æ¥é€‰æ‹©æ˜¾ç¤ºå™¨æ”¯æŒä¸åŒçš„ RGB è‰²åŸŸã€‚</p>
<p><img src="/2022/08/14/Why-so-much-color-space-in-video/10.jpg" alt></p>
<h4 id="æ˜¾ç¤ºè®¾å¤‡å’Œç›¸æœºçš„è‰²åŸŸä¸€è‡´">æ˜¾ç¤ºè®¾å¤‡å’Œç›¸æœºçš„è‰²åŸŸä¸€è‡´</h4>
<p>å¦‚æœç¼–ç è§†é¢‘å’Œæ’­æ”¾è§†é¢‘çš„æ˜¾ç¤ºå™¨é‡‡ç”¨çš„ RGB è‰²åŸŸæ˜¯ä¸€è‡´çš„ï¼Œæ¯”å¦‚éƒ½æ˜¯ sRGBï¼Œæ­¤æ—¶çš„æ’­æ”¾è¿‡ç¨‹ç›¸å¯¹æ¯”è¾ƒç®€å•ã€‚è§†é¢‘è§£ç ä¹‹åï¼Œå¾—åˆ° YUV æ•°æ®ï¼Œç„¶åæ ¹æ®æ ‡å‡†å°† YUV æ•°æ®è½¬æ¢æˆéçº¿æ€§çš„ sRGB æ•°æ®ï¼Œç„¶åæ˜¾ç¤ºå™¨æ ¹æ® sRGB æ•°æ®æ˜¾ç¤ºå›¾åƒå³å¯ã€‚</p>
<p><img src="/2022/08/14/Why-so-much-color-space-in-video/11.png" alt></p>
<h4 id="æ˜¾ç¤ºè®¾å¤‡å’Œç›¸æœºçš„è‰²åŸŸä¸ä¸€è‡´">æ˜¾ç¤ºè®¾å¤‡å’Œç›¸æœºçš„è‰²åŸŸä¸ä¸€è‡´</h4>
<p>å½“æ˜¾ç¤ºè®¾å¤‡æ”¯æŒçš„è‰²åŸŸä» sRGB å˜ä¸º Rec. 2020 æ—¶ï¼Œå¦‚æœç›´æ¥æ˜¾ç¤º sRGB è‰²åŸŸä¸‹çš„æ•°æ®ï¼Œåˆ™ä¼šå¯¼è‡´æ¯”è¾ƒä¸¥é‡çš„é¢œè‰²å¤±çœŸã€‚</p>
<p><img src="/2022/08/14/Why-so-much-color-space-in-video/12.png" alt></p>
<p>å’Œè½¬ç é˜¶æ®µçš„è‰²åŸŸè½¬æ¢ç±»ä¼¼ï¼Œæ­¤æ—¶ï¼Œä¹Ÿéœ€è¦åœ¨ä¸åŒçš„è‰²åŸŸç©ºé—´è¿›è¡Œ RGB æ•°æ®çš„è½¬æ¢ï¼ˆ<a href="https://en.wikipedia.org/wiki/Color_management">è‰²å½©ç®¡ç†</a>ï¼‰ä»¥ä¿è¯ç›¸åŒçš„è§†é¢‘åœ¨ä¸åŒè¾“å…¥ã€è¾“å‡ºã€æ˜¾ç¤ºè®¾å¤‡ä¸Šéƒ½å‘ˆç°å‡ºæœ€å¥½çš„é¢œè‰²ã€‚</p>
<p>å¯¹äºæ˜¾ç¤ºè®¾å¤‡è€Œè¨€ï¼ŒsRGB-&gt;RGB(Rec. 2020)çš„è½¬æ¢è¿‡ç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="/2022/08/14/Why-so-much-color-space-in-video/13.png" alt></p>
<p>å› æ­¤ï¼Œå¯¹äºæ‹æ‘„è®¾å¤‡å’Œæ˜¾ç¤ºè®¾å¤‡çš„è‰²åŸŸä¸åŒæ—¶ï¼Œè§†é¢‘çš„æ’­æ”¾å¢åŠ äº†é¢œè‰²ç®¡ç†çš„è¿‡ç¨‹ã€‚<br>
<img src="/2022/08/14/Why-so-much-color-space-in-video/14.png" alt></p>
<h2 id="è§†é¢‘è§‚çœ‹">è§†é¢‘è§‚çœ‹</h2>
<p>è™½ç„¶è§†é¢‘ä¿¡æ¯çš„é‡‡é›†å’Œæœ€ç»ˆç»ˆç«¯æ’­æ”¾é‡‡ç”¨çš„éƒ½æ˜¯ RGB çš„é¢œè‰²æ¨¡å‹ï¼Œä½†æ˜¯å¯¹äººçœ¼è€Œè¨€ï¼ŒRGB å…¶å®å¹¶ä¸ç›´è§‚ï¼Œæ¯”å¦‚æˆ‘ä»¬å¾ˆéš¾é©¬ä¸Šååº”å‡º<code>å¤©é’è‰²</code>çš„ RGB è‰²å€¼ï¼Ÿ</p>
<p>ä¸ºäº†èƒ½å¤Ÿæ›´ç›´è§‚çš„è¡¨ç¤ºé¢œè‰²ï¼Œåˆå¼•å…¥äº† <a href="https://en.wikipedia.org/wiki/HSL_and_HSV">HSL</a> è‰²å½©æ¨¡å‹ã€‚HSL æ¯” RGB æ›´åŠ ç›´è§‚ï¼Œæ¯”å¦‚ï¼šæƒ³ä»é»„è‰²è¿‡åº¦åˆ°çº¢è‰²ï¼Œåªéœ€è¦è°ƒæ•´è‰²ç›¸å³å¯ï¼Œé¥±å’Œåº¦å’Œäº®åº¦ä¿æŒä¸å˜ã€‚å› æ­¤ï¼ŒHSL ä¸€èˆ¬æ›´é€‚åˆäººçš„è‰²å½©æ„ŸçŸ¥ï¼Œè€Œ RGB æ›´é€‚åˆæ˜¾ç¤ºé¢†åŸŸã€‚</p>
<p>ä¸ºäº†è®©ä½œå“å¯ä»¥å‘ˆç°å‡ºæœŸæœ›çš„æ•ˆæœï¼Œæå‡ç”¨æˆ·çš„è§†è§‰ä½“éªŒï¼Œåœ¨æ‘„å½±åæœŸï¼Œä½¿ç”¨ HSL å¯¹ä½œå“è¿›è¡Œè°ƒæ•´æ˜¯æœ€æ–¹ä¾¿çš„ä¸€ç§æ–¹å¼ã€‚åˆ©ç”¨ HSL å¯¹ä½œå“è¿›è¡Œè°ƒæ•´ï¼Œç®€å•å‡ æ­¥å°±å¯ä»¥è®©ç°æš—çš„ã€Œé©¬è·¯éšæ‹ã€ç§’å˜ã€Œè¡—å¤´å¤§ç‰‡ã€ã€‚<sup class="footnote-ref"><a href="#fn12" id="fnref12">[12]</a></sup></p>
<p><img src="/2022/08/14/Why-so-much-color-space-in-video/16.webp" alt></p>
<p>FFmpeg çš„ <code>signalstats</code> æ»¤é•œå¯ä»¥åˆ†æè·å–è§†é¢‘çš„è‰²è°ƒã€é¥±å’Œåº¦ã€äº®åº¦ä¿¡æ¯ã€‚ä½†æ˜¯è¯¥æ»¤é•œè·å–çš„è‰²è°ƒã€é¥±å’Œåº¦å’Œ <a href="https://www.rapidtables.com/convert/color/rgb-to-hsl.html">HSL ä¸­çš„è®¡ç®—</a> æ˜¯ä¸ä¸€è‡´çš„ã€‚</p>
<p><code>signalstats</code> è®¡ç®—è‰²è°ƒã€é¥±å’Œåº¦çš„ç®—æ³•å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mi>u</mi><mi>e</mi><mo>=</mo><mfrac><mn>180</mn><mi>Ï€</mi></mfrac><mo>âˆ—</mo><mi>a</mi><mi>r</mi><mi>c</mi><mi>t</mi><mi>a</mi><mi>n</mi><mfrac><mrow><mi>U</mi><mo>âˆ’</mo><mn>128</mn></mrow><mrow><mi>V</mi><mo>âˆ’</mo><mn>128</mn></mrow></mfrac><mo>+</mo><mn>180</mn><mo separator="true">,</mo><mi>a</mi><mi>r</mi><mi>c</mi><mi>t</mi><mi>a</mi><mi>n</mi><mfrac><mi>y</mi><mi>x</mi></mfrac><mo>âˆˆ</mo><mo stretchy="false">[</mo><mo>âˆ’</mo><mi>Ï€</mi><mo separator="true">,</mo><mi>Ï€</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">Hue=\frac{180}{\pi} * arctan{\frac{U-128}{V-128}} + 180, arctan{\frac{y}{x}} \in [-\pi, \pi]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mord mathdefault">u</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">Ï€</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mord">8</span><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.1296600000000003em;vertical-align:-0.7693300000000001em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">c</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mord">2</span><span class="mord">8</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mord">2</span><span class="mord">8</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693300000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.7935599999999998em;vertical-align:-0.686em;"></span><span class="mord">1</span><span class="mord">8</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">c</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1075599999999999em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">âˆ’</span><span class="mord mathdefault" style="margin-right:0.03588em;">Ï€</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">Ï€</span><span class="mclose">]</span></span></span></span></span></p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>a</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo>=</mo><msqrt><mrow><mo stretchy="false">(</mo><mi>U</mi><mo>âˆ’</mo><mn>128</mn><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>+</mo><mo stretchy="false">(</mo><mi>V</mi><mo>âˆ’</mo><mn>128</mn><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow></msqrt></mrow><annotation encoding="application/x-tex">Saturation=\sqrt{(U-128)^2 + (V-128)^2}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">u</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault">o</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.24em;vertical-align:-0.25612499999999994em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.983875em;"><span class="svg-align" style="top:-3.2em;"><span class="pstrut" style="height:3.2em;"></span><span class="mord" style="padding-left:1em;"><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mord">2</span><span class="mord">8</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mord">2</span><span class="mord">8</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-2.9438750000000002em;"><span class="pstrut" style="height:3.2em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.28em;"><svg width="400em" height="1.28em" viewbox="0 0 400000 1296" preserveaspectratio="xMinYMin slice"><path d="M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.25612499999999994em;"><span></span></span></span></span></span></span></span></span></span></p>
<p>å¦‚æœéœ€è¦å¾—åˆ°è§†é¢‘çš„æ ‡å‡† HSL ä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨ä½œè€…å¼€å‘çš„ <a href="https://github.com/wangwei1237/wangwei1237.github.io/blob/master/2022/08/14/Why-so-much-color-space-in-video/vf_hsl.c">vf_hsl æ»¤é•œ</a>ã€‚</p>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>è™½ç„¶é¢œè‰²è¿˜æ˜¯é‚£ä¸ªé¢œè‰²ï¼Œä½†æ˜¯ä¸åŒçš„é¢œè‰²ç©ºé—´çš„é€‚ç”¨èŒƒå›´å¹¶ä¸ç›¸åŒï¼š</p>
<ul>
<li>RGBï¼šé¢å‘é‡‡é›†å’Œæ˜¾ç¤ºè®¾å¤‡</li>
<li>YUVï¼šé¢å‘å­˜å‚¨</li>
<li>HSLï¼šé¢å‘äººç±»è§†è§‰æ„ŸçŸ¥</li>
<li>XYZï¼šRGBä¹‹é—´çš„è½¬æ¢æ¡¥æ¢</li>
</ul>
<p>ä»è§†é¢‘é‡‡é›†åˆ°è§†é¢‘æ¶ˆè´¹çš„æ•´ä¸ªè¿‡ç¨‹ï¼Œæ¶‰åŠåˆ°ä¸åŒçš„è®¾å¤‡å’Œæ ‡å‡†ï¼Œè€Œä¸åŒçš„è®¾å¤‡å’Œæ ‡å‡†æ‰€æ”¯æŒçš„è‰²åŸŸç©ºé—´åˆä¸ç›¸åŒã€‚æ­£æ˜¯é€šè¿‡ä¸åŒçš„é¢œè‰²æ¨¡å‹è½¬æ¢å’Œä¸åŒçš„è‰²åŸŸè½¬æ¢ï¼Œæ‰å¾—ä»¥è®©æˆ‘ä»¬å®ç°ï¼šåœ¨ä¸åŒè¾“å…¥ã€è¾“å‡ºã€æ˜¾ç¤ºè®¾å¤‡ä¸Šéƒ½å‘ˆç°å‡ºæœ€å¥½çš„é¢œè‰²ï¼Œæ‰å¾—ä»¥è®©æˆ‘ä»¬å®ç°ä»¥è¿‘ä¼¼ç›¸åŒçš„è§‚çœ‹ä½“éªŒæ¥æ¶ˆè´¹è§†é¢‘ã€‚</p>
<h2 id="å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</h2>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p><a href="https://zhuanlan.zhihu.com/p/158502818">CMOS Image SensoråŸç†ç®€è¿°</a> <a href="#fnref1" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn2" class="footnote-item"><p><a href="https://discuss.pixls.us/t/what-does-linear-rgb-mean/16584">What does linear RGB mean ?</a> <a href="#fnref2" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn3" class="footnote-item"><p><a href="https://www.astropix.com/html/astrophotography/how.html">How Digital Cameras Work</a> <a href="#fnref3" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn4" class="footnote-item"><p><a href="https://www.pathwaylighting.com/products/downloads/brochure/technical_materials_1466797044_Linear+vs+Logarithmic+Dimming+White+Paper.pdf">Linear vs. Logarithmic Dimmingâ€”A White Paper</a> <a href="#fnref4" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn5" class="footnote-item"><p><a href="https://medium.com/videocoin/what-is-video-transcoding-and-why-do-you-do-it-348a2610cefc">What is Video Transcoding and Why Do You Do It?</a> <a href="#fnref5" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn6" class="footnote-item"><p><a href="https://medium.com/invideo-io/talking-about-colorspaces-and-ffmpeg-f6d0b037cc2f">Talking About Colorspaces and FFmpeg</a> <a href="#fnref6" class="footnote-backref">â†©ï¸</a> <a href="#fnref6:1" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn7" class="footnote-item"><p><a href="https://blog.csdn.net/weixin_43194305/article/details/107944264">ã€é¢œè‰²ç§‘å­¦ã€‘RGBå’ŒXYZé¢œè‰²ç©ºé—´çš„è½¬æ¢</a> <a href="#fnref7" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn8" class="footnote-item"><p><a href="https://trac.ffmpeg.org/wiki/colorspace">Colorspace support in FFmpeg</a> <a href="#fnref8" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn9" class="footnote-item"><p><a href="https://en.wikipedia.org/wiki/RGB_color_model">RGB color model</a> <a href="#fnref9" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn10" class="footnote-item"><p><a href="https://wangwei1237.github.io/2020/02/28/Introduction-to-digital-video-technology/">æ•°å­—è§†é¢‘å¯¼è®º</a> <a href="#fnref10" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn11" class="footnote-item"><p><a href="https://www.spiedigitallibrary.org/ebooks/PM/Computational-Color-Technology/eISBN-9780819481085/10.1117/3.660835">Computational Color Technology</a> <a href="#fnref11" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn12" class="footnote-item"><p><a href="https://zhuanlan.zhihu.com/p/142767122">ç”¨HSLè°ƒè‰²=ç®€å•ã€å¿«é€Ÿã€è¶…å‡ºç‰‡ï¼</a> <a href="#fnref12" class="footnote-backref">â†©ï¸</a></p>
</li>
</ol>
</section>
]]></content>
      <categories>
        <category>è§†é¢‘æŠ€æœ¯</category>
      </categories>
      <tags>
        <tag>RGB</tag>
        <tag>XYZ</tag>
        <tag>linear RGB</tag>
        <tag>HSL</tag>
        <tag>FFmpeg colorspace</tag>
      </tags>
  </entry>
  <entry>
    <title>1k bit = 1024 bitï¼Ÿ</title>
    <url>/2022/06/19/Does-1Kbit-equal-1024bit/</url>
    <content><![CDATA[<p><img src="/2022/06/19/Does-1Kbit-equal-1024bit/1.jpg" alt></p>
<h2 id="å¼•è¨€">å¼•è¨€</h2>
<p>æˆ‘ä»¬çš„å¹³å°æœ‰ä¸€ä¸ªç®—å­ç”¨äºè®¡ç®—ç»™å®šè§†é¢‘çš„éŸ³è§†é¢‘æµçš„ç ç‡ï¼Œè¯¥ç®—å­åº•å±‚é€šè¿‡è°ƒç”¨ <code>ffprobe</code> æ¥è®¡ç®—éŸ³è§†é¢‘çš„ç ç‡ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ffprobe -select_streams v:0 -show_entries stream=bit_rate \</span><br><span class="line">-of default=nokey=0:noprint_wrappers=1 <span class="string">&#x27;video_file&#x27;</span></span><br></pre></td></tr></table></figure>
<p>æ­¤æ—¶ï¼Œå¾—åˆ°çš„ bit_rate çš„å•ä½æ˜¯ b/sï¼Œä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬æŠŠè¯¥ç ç‡è½¬æ¢ä¸ºäº† Mb/sï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">bit_rate = bit_rate / <span class="number">1024</span> / <span class="number">1024</span>;</span><br></pre></td></tr></table></figure>
<p>å¿½ç„¶æœ‰ä¸€å¤©ï¼Œæˆ‘ä»¬çš„ç”¨æˆ·åé¦ˆï¼Œå¹³å°è¿”å›çš„ç ç‡ç»“æœå’Œ <code>ffprobe</code> çš„ç»“æœä¸ä¸€è‡´ã€‚å…·ä½“è¡¨ç°å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Stream #0:0(und): Video: hevc (Main) (hvc1), 3492 kb&#x2F;s, ...</span><br><span class="line">    ...</span><br><span class="line">bit_rate&#x3D;3492451 &#x3D;&#x3D;&gt; 3.33 Mb&#x2F;s</span><br></pre></td></tr></table></figure>
<p>å¹³å°è¿”å› 3.33 Mb/s x 1024 = 3410 kb/sï¼Œè€Œ <code>ffprobe</code> è¿”å›çš„åˆ™ä¸º 3492 kb/sã€‚</p>
<span id="more"></span>
<h2 id="é—®é¢˜è¿½æŸ¥">é—®é¢˜è¿½æŸ¥</h2>
<p>éƒ½æ˜¯ <code>ffprobe</code> è¿”å›çš„æ•°æ®ï¼Œä¸ºä»€ä¹ˆå•ä½è½¬æ¢ä¹‹åç»“æœä¸ä¸€è‡´å‘¢äº†ï¼Ÿå¸¦ç€è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘å’¨è¯¢äº†éŸ³è§†é¢‘å¤„ç†çš„åŒäº‹ï¼ŒåŒäº‹ç­”å¤è¯´ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">åœ¨ FFmpeg ä¸­ï¼Œkb å°±æ˜¯ 1000 bit çš„æ„æ€ï¼Œb è½¬æ¢åˆ° kb æ˜¯ &#x2F;1000 è€Œä¸æ˜¯ &#x2F;1024ã€‚</span><br></pre></td></tr></table></figure>
<p>ä» <a href="https://github.com/FFmpeg/FFmpeg/blob/master/libavcodec/avcodec.c">libavcodec/avcodec.c</a> ä¸­çš„ avcodec_string() æ‰€å®šä¹‰çš„ç ç‡ä¿¡æ¯æ‰“å°æ“ä½œçš„ä»£ç å¯ä»¥çŸ¥é“ï¼Œåœ¨ FFmpeg ä¸­ï¼Œ1kb çš„ç¡®ä¸º 1000 bitã€‚</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">bitrate = get_bit_rate(enc);</span><br><span class="line"><span class="keyword">if</span> (bitrate != <span class="number">0</span>) &#123;</span><br><span class="line">    av_bprintf(&amp;bprint, <span class="string">&quot;, %&quot;</span>PRId64<span class="string">&quot; kb/s&quot;</span>, bitrate / <span class="number">1000</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (enc-&gt;rc_max_rate &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    av_bprintf(&amp;bprint, <span class="string">&quot;, max. %&quot;</span>PRId64<span class="string">&quot; kb/s&quot;</span>, enc-&gt;rc_max_rate / <span class="number">1000</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å°è±¡ä¸­ï¼Œåœ¨å­¦æ ¡çš„æ—¶å€™è€å¸ˆå°±å‘Šè¯‰æˆ‘ä»¬ï¼š</p>
<blockquote>
<p>1024B = 1KBï¼Œ1024KB = 1MBï¼Œ1024MB = 1GBï¼Œâ€¦â€¦</p>
</blockquote>
<p>ç¿»é˜…2017 å¹´å‡ºç‰ˆçš„ <a href="https://item.jd.com/10046467986315.html">ã€Šè®¡ç®—æœºæ–‡åŒ–åŸºç¡€ã€‹</a> çš„ <strong>1.2.2 è®¡ç®—æœºä¸­çš„å•ä½</strong> ç« èŠ‚ä¸­å†™åˆ°ï¼š</p>
<blockquote>
<p>å­—èŠ‚ï¼ˆByteï¼Œç¼©å†™ä¸º Bï¼‰æ˜¯è®¡ç®—æœºå­˜å‚¨ä¿¡æ¯çš„æœ€åŸºæœ¬å•ä½ã€‚1 ä¸ªå­—èŠ‚ç”¨ 8 ä½äºŒè¿›åˆ¶æ•°è¡¨ç¤ºã€‚</p>
<p>å­˜å‚¨ç©ºé—´å®¹é‡çš„å•ä½é™¤äº†ç”¨å­—èŠ‚è¡¨ç¤ºä»¥å¤–ï¼Œè¿˜ä»å°åˆ°å¤§ä¾æ¬¡å¯ä»¥ç”¨åƒå­—èŠ‚ï¼ˆKBï¼‰ã€å…†å­—èŠ‚ï¼ˆMBï¼‰ã€å‰å­—èŠ‚ï¼ˆGBï¼‰ã€å¤ªå­—èŠ‚ï¼ˆTBï¼‰ç­‰è¡¨ç¤ºã€‚å®ƒä»¬ä¹‹é—´æ¯ä¸€çº§åˆ«çš„æ¢ç®—å…³ç³»ä¸º 1024 å€ï¼Œä¹Ÿå°±æ˜¯è¯´ 1KB ç›¸å½“äº 1024Bï¼Œå…¶ä»–å•ä½ä»¥æ­¤ç±»æ¨ã€‚</p>
</blockquote>
<p>ä¸ºä»€ä¹ˆåˆ°äº† FFmpeg è¿™é‡Œï¼Œ1 kb å°±ç­‰äº 1000 b äº†å‘¢ï¼Ÿ</p>
<p>æˆ‘å‘èµ·äº†ä¸€ä¸ªå…³äº <strong>1kb = (?)b</strong> çš„é—®å·ï¼Œåœ¨å›æ”¶çš„ 105 ä»½é—®å·ä¸­ï¼Œç­”æ¡ˆçš„åˆ†å¸ƒå¦‚ä¸‹ï¼š</p>
<p><img src="/2022/06/19/Does-1Kbit-equal-1024bit/6.png" alt></p>
<h2 id="kb-and-kib">kb and Kib</h2>
<p>ç»´åŸºç™¾ç§‘å¯¹ç ç‡çš„è§£é‡Šå¦‚ä¸‹ï¼š</p>
<blockquote>
<p>The bit rate is expressed in the unit bit per second (symbol: bit/s), often in conjunction with an SI prefix such as kilo (1 kbit/s = 1,000 bit/s), mega (1 Mbit/s = 1,000 kbit/s), giga (1 Gbit/s = 1,000 Mbit/s) or tera (1 Tbit/s = 1,000 Gbit/s).</p>
<p>When quantifying large or small bit rates, SI (International System of Units) prefixes (also known as metric prefixes or decimal prefixes).</p>
<p>Binary prefixes are sometimes used for bit rates. The International Standard (IEC 80000-13) specifies different abbreviations for binary and decimal (SI) prefixes (e.g. 1 KiB/s = 1024 B/s = 8192 bit/s, and 1 MiB/s = 1024 KiB/s).</p>
</blockquote>
<p>åœ¨ SI ä¸­ï¼ŒåŸºäº 10 è¿›åˆ¶å®šä¹‰äº†å„<a href="https://en.wikipedia.org/wiki/Metric_prefix">ç¼©å†™å­—æ¯</a>çš„å«ä¹‰ï¼š</p>
<ul>
<li>kï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><msup><mn>0</mn><mn>3</mn></msup></mrow><annotation encoding="application/x-tex">10^3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span></span></li>
<li>Mï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><msup><mn>0</mn><mn>6</mn></msup></mrow><annotation encoding="application/x-tex">10^6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span></span></span></span></li>
<li>Gï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><msup><mn>0</mn><mn>9</mn></msup></mrow><annotation encoding="application/x-tex">10^9</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span></span></span></span></span></span></span></span></li>
<li>Tï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><msup><mn>0</mn><mn>12</mn></msup></mrow><annotation encoding="application/x-tex">10^{12}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></li>
<li>Pï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><msup><mn>0</mn><mn>15</mn></msup></mrow><annotation encoding="application/x-tex">10^{15}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">5</span></span></span></span></span></span></span></span></span></span></span></span></li>
</ul>
<p>åœ¨äºŒè¿›åˆ¶é¢†åŸŸä¸­ï¼Œä½¿ç”¨â€œkâ€ï¼ˆkilo-ï¼‰ã€â€œMâ€ï¼ˆmega-ï¼‰ã€â€œGâ€ï¼ˆgiga-ï¼‰ç­‰ç¼©å†™ç¬¦å·ä¼šå¼•èµ·ä¸¥é‡çš„æ··æ·†ï¼Œå› æ­¤åœ¨ 1999 å¹´ 1 æœˆï¼Œå›½é™…ç”µå·¥å§”å‘˜ä¼šï¼ˆIECï¼‰åœ¨ <a href="https://webstore.iec.ch/publication/12253">IEC 60027-2:1972/AMD2:1999</a> çš„ç¬¬ 3.8.3 èŠ‚ä¸­å¼•å…¥äº†â€œkibi-â€ã€â€œmebi-â€ã€â€œgibi-â€ç­‰è¯å¤´ä»¥åŠç¼©å†™ç¬¦å·â€œKiâ€ã€â€œMiâ€ã€â€œGiâ€ç­‰æ¥æ˜ç¡®è¯´æ˜äºŒè¿›åˆ¶è®¡æ•°ã€‚</p>
<p><img src="/2022/06/19/Does-1Kbit-equal-1024bit/3.jpg" alt></p>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition attention"><p class="admonition-title">IEC 80000-13:2008
</p><p><a href="https://webstore.iec.ch/publication/7479">IEC 80000-13:2008</a> å–æ¶ˆå¹¶æ›¿æ¢äº† IEC 60027-2 ä¸­çš„ç¬¬ 3.8 å’Œ 3.9 èŠ‚ä¸­çš„å†…å®¹ã€‚</p>
<p><img src="/2022/06/19/Does-1Kbit-equal-1024bit/4.png" alt></p>
</div>
<p>å› æ­¤ï¼š</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi>G</mi><mi>b</mi><mo>=</mo><mn>1</mn><msup><mn>0</mn><mn>3</mn></msup><mi>M</mi><mi>b</mi><mo>=</mo><mn>1</mn><msup><mn>0</mn><mn>6</mn></msup><mi>k</mi><mi>b</mi><mo>=</mo><mn>1</mn><msup><mn>0</mn><mn>9</mn></msup><mi>b</mi></mrow><annotation encoding="application/x-tex">1Gb = 10^{3}Mb = 10^{6}kb = 10^{9}b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord mathdefault">G</span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">9</span></span></span></span></span></span></span></span></span><span class="mord mathdefault">b</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi>G</mi><mi>i</mi><mi>b</mi><mo>=</mo><msup><mn>2</mn><mn>10</mn></msup><mi>M</mi><mi>i</mi><mi>b</mi><mo>=</mo><msup><mn>2</mn><mn>20</mn></msup><mi>K</mi><mi>i</mi><mi>b</mi><mo>=</mo><msup><mn>2</mn><mn>30</mn></msup><mi>b</mi></mrow><annotation encoding="application/x-tex">1Gib = 2^{10}Mib = 2^{20}Kib = 2^{30}b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord mathdefault">G</span><span class="mord mathdefault">i</span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault">i</span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="mord mathdefault">i</span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mord mathdefault">b</span></span></span></span></li>
</ul>
<p>æ‰€ä»¥ï¼Œåœ¨ FFmpeg ä¸­ï¼Œå½“ç ç‡éœ€è¦è½¬æ¢ä¸º kb/s å•ä½æ—¶ï¼Œé‡‡ç”¨äº† <strong>(b/s) / 1000</strong> çš„æ“ä½œã€‚</p>
<h2 id="å¿…é¡»å…³æ³¨kibåˆ¶å¸¦æ¥çš„å·®åˆ«">å¿…é¡»å…³æ³¨Kibåˆ¶å¸¦æ¥çš„å·®åˆ«</h2>
<p>åœ¨ Linux æˆ–è€… Mac ä¸­ï¼Œå·²ç»é‡‡ç”¨äº† IEC å¼•å…¥äº† KiBã€MiB ç­‰å•ä½ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥æŸ¥çœ‹ä¸‹ <code>du</code> å‘½ä»¤çš„å¸®åŠ©æ–‡æ¡£ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ man du</span><br><span class="line">  ...</span><br><span class="line">  -h      â€œHuman-readableâ€ output.  Use unit suffixes: Byte, Kilobyte, Megabyte, Gigabyte, Terabyte and Petabyte based on powers of 1024.</span><br><span class="line">  --si    â€œHuman-readableâ€ output.  Use unit suffixes: Byte, Kilobyte, Megabyte, Gigabyte, Terabyte and Petabyte based on powers of 1000.</span><br><span class="line">  ...</span><br></pre></td></tr></table></figure>
<p>å¦‚æœæˆ‘ä»¬æŸ¥çœ‹ Mac ç³»ç»Ÿä¸­çš„æ–‡ä»¶ç®€ä»‹çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¹Ÿä¼šå‘ç° Mac æ˜¯é‡‡ç”¨äº† SI æ¥è¡¨ç¤ºå•ä½è½¬æ¢çš„ã€‚<br>
<img src="/2022/06/19/Does-1Kbit-equal-1024bit/2.jpg" alt></p>
<p>æˆ‘ä»¬ç”¨ <code>du</code> å‘½ä»¤çš„ä¸åŒé€‰é¡¹æ¥æŸ¥çœ‹åŒä¸€ä¸ªæ–‡ä»¶çš„å¤§å°çš„æ—¶å€™ä¹Ÿä¼šå‘ç°å…¶ä¸­çš„å·®å¼‚ï¼š<br>
<img src="/2022/06/19/Does-1Kbit-equal-1024bit/5.jpg" alt></p>
<p>å› æ­¤ï¼Œåç»­åœ¨ä½¿ç”¨ç›¸å…³å‘½ä»¤çš„æ—¶å€™ï¼ŒåŠ¡å¿…éœ€è¦æŸ¥çœ‹å¯¹åº”çš„æ–‡æ¡£ï¼Œä»¥ç¡®è®¤è¯¥å‘½ä»¤çš„è¾“å‡ºæ˜¯åŸºäº SI è¿˜æ˜¯åŸºäº IECã€‚</p>
<h2 id="ç»“è¯­">ç»“è¯­</h2>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi>k</mi><mi>b</mi><mo mathvariant="normal">â‰ </mo><mn>1024</mn><mi>b</mi></mrow><annotation encoding="application/x-tex">1kb \ne 1024b
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel">î€ </span></span><span class="fix"></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">2</span><span class="mord">4</span><span class="mord mathdefault">b</span></span></span></span></span></p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi>K</mi><mi>i</mi><mi>b</mi><mo>=</mo><mn>1024</mn><mi>b</mi></mrow><annotation encoding="application/x-tex">1Kib = 1024b
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="mord mathdefault">i</span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">2</span><span class="mord">4</span><span class="mord mathdefault">b</span></span></span></span></span></p>
<p>æ˜¯æ—¶å€™æ›´æ–°æˆ‘ä»¬çš„çŸ¥è¯†åº“äº†~</p>
]]></content>
      <categories>
        <category>è½¯ä»¶ç†è®º</category>
      </categories>
      <tags>
        <tag>IEC(å›½é™…ç”µå·¥å§”å‘˜ä¼š)</tag>
        <tag>SI(å›½é™…å•ä½åˆ¶)</tag>
        <tag>KiB</tag>
        <tag>kB</tag>
      </tags>
  </entry>
  <entry>
    <title>ç”¨ Excel åˆ†ææ•°æ®çš„å°æŠ€å·§</title>
    <url>/2022/05/18/Tips-for-Analyzing-data-with-excel/</url>
    <content><![CDATA[<p><img src="/2022/05/18/Tips-for-Analyzing-data-with-excel/1.jpeg" alt></p>
<p>å› ä¸ºå·¥ä½œåŸå› ï¼Œæœ€è¿‘ç»å¸¸è¦åˆ†æä¸€äº›æ•°æ®ï¼Œè¿™äº›æ•°æ®çš„æ ¼å¼ä¸è§„èŒƒï¼Œå¹¶ä¸”æ•°æ®é‡çº§ä¸å¤§â€”â€”å¤§æ¦‚åœ¨ 1W å·¦å³ã€‚</p>
<p>ä¸€å¼€å§‹ï¼Œæˆ‘æ˜¯ä¸å±‘äºä½¿ç”¨ Excel æ¥å¤„ç†çš„ï¼Œæ€»æƒ³ç€å†™ä¸ªç¨‹åºæ¥å®Œæˆå¤„ç†ã€‚åæ¥ï¼Œæˆ‘å‘ç°ï¼Œæˆ‘çš„æƒ³æ³•æ˜¯å¤šä¹ˆçš„æ„šè ¢ï¼Œå› ä¸ºæˆ‘å‘ç°ï¼ŒExcel ç®€ç›´æ˜¯å¤ªå¼ºå¤§äº†ï¼Œå®Œå…¨æ»¡è¶³äº†æˆ‘çš„å„ç§éœ€è¦ã€‚è¿˜å¥½æˆ‘åŠæ—¶çº æ­£äº†è‡ªå·±æ„šè ¢çš„æƒ³æ³•ï¼Œå¦åˆ™æˆ‘ç°åœ¨è¿˜åœ¨å¿™ä¸ªä¸åœçš„è°ƒè¯•è‡ªå·±çš„é‚£äº›ä»£ç ã€‚</p>
<p>æœ¬æ–‡æŠŠè‡ªå·±ä½¿ç”¨ Excel è¿›è¡Œæ•°æ®åˆ†æè¿‡ç¨‹ä¸­å­¦ä¹ åˆ°çš„å°æŠ€å·§è¿›è¡Œäº†æ¢³ç†æ€»ç»“ã€‚</p>
<span id="more"></span>
<h2 id="æ•°æ®è¯´æ˜">æ•°æ®è¯´æ˜</h2>
<p>åœ¨æˆ‘çš„åˆ†æä¸­ï¼Œæ•°æ®æ ¼å¼å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<table>
<thead>
<tr>
<th>ID</th>
<th>score1</th>
<th>score2</th>
<th>â€¦â€¦</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>2.32</td>
<td>3.56</td>
<td>6.78</td>
</tr>
<tr>
<td>2</td>
<td>3.22</td>
<td>6.56</td>
<td>8.23</td>
</tr>
<tr>
<td>3</td>
<td>6.98</td>
<td>8.12</td>
<td>3.78</td>
</tr>
<tr>
<td>4</td>
<td>4.56</td>
<td>7.35</td>
<td>6.53</td>
</tr>
<tr>
<td>5</td>
<td>5.78</td>
<td>2.34</td>
<td>9.12</td>
</tr>
<tr>
<td>â€¦</td>
<td>â€¦</td>
<td>â€¦</td>
<td>â€¦</td>
</tr>
</tbody>
</table>
<p>å…¶ä¸­ï¼ŒID ä»£è¡¨æˆ‘çš„åˆ†æå¯¹è±¡ä¸­çš„æŸä¸ªæ ·æœ¬ï¼Œæ¯ä¸ªæ ·æœ¬éƒ½ä¼šè¯·æ±‚ä¸åŒçš„æœåŠ¡å¯¹å…¶è¿›è¡Œæ‰“åˆ†ï¼Œå› è€Œä¼šå¾—åˆ°å¦‚ä¸‹å›¾æ‰€ç¤ºçš„è¡¨æ ¼æ–‡ä»¶ã€‚</p>
<p><img src="/2022/05/18/Tips-for-Analyzing-data-with-excel/2.jpg" alt></p>
<p>åœ¨ä¸Šå›¾çš„ Excel ä¸­ï¼Œæ¯ä¸ª Sheet çš„æ•°æ®ä¸ºä¸åŒæœåŠ¡è¿”å›çš„æ‰“åˆ†æ•°æ®ã€‚</p>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition warning"><p class="admonition-title">æ³¨æ„
</p><p>ä¸åŒæœåŠ¡è¿”å›çš„æ‰“åˆ†ä¸­ï¼Œå¯èƒ½ä¼šå­˜åœ¨æ ·æœ¬çš„ä¸¢å¤±ã€‚ä¾‹å¦‚ Sheet2 ä¸­å°±ç¼ºå°‘ ID=10 çš„æ•°æ®æ‰“åˆ†ã€‚</p>
<p>åœ¨åˆ†æä¸­ï¼Œè¿™ç§æ•°æ®ç¼ºå¤±æ˜¯å®Œå…¨éšæœºçš„ã€‚</p>
</div>
<h2 id="vlookup">VLOOKUP</h2>
<p>ä¸ºäº†åˆ†ææ–¹ä¾¿ï¼Œéœ€è¦æŠŠ Sheet1 å’Œ Sheet2 çš„æ•°æ®æŒ‰ç…§ ID è¿›è¡Œèšåˆã€‚è¿™ä¸ªæ—¶å€™ï¼Œä½¿ç”¨ VLOOKUP å°±å¯ä»¥éå¸¸æ–¹ä¾¿çš„å®Œæˆè¿™ä¸ªå·¥ä½œã€‚</p>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition note"><p class="admonition-title"><a href="https://support.microsoft.com/en-us/office/vlookup-function-0bbc8083-26fe-4963-8ab8-93a18ad188a1">VLOOKUP</a> 
</p><p>Use VLOOKUP when you need to find things in a table or a range by row. For example, look up a price of an automotive part by the part number, or find an employee name based on their employee ID.</p>
<p>=VLOOKUP(What you want to look up, where you want to look for it, the column number in the range containing the value to return, return an Approximate or Exact match â€“ indicated as 1/TRUE, or 0/FALSE).</p>
</div>
<p>å› æ­¤ï¼Œæˆ‘ä»¬ç”¨å¦‚ä¸‹çš„ä»£ç å°±å¯ä»¥å®ç°æŒ‰ç…§ ID åˆå¹¶ä¸¤ä¸ª Sheet çš„æ•°æ®ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x3D;VLOOKUP(A1,Sheet2!A:B,2,0)</span><br></pre></td></tr></table></figure>
<p><img src="/2022/05/18/Tips-for-Analyzing-data-with-excel/3.jpg" alt></p>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition warning"><p class="admonition-title"><a href="https://www.microsoft.com/en-us/microsoft-365/blog/2011/08/17/making-sense-of-dollar-signs-in-excel/">æ³¨æ„å•å…ƒæ ¼çš„å¼•ç”¨æ–¹å¼</a>
</p><ul>
<li>ç›¸å¯¹å¼•ç”¨ï¼Œå¦‚ï¼šA1ï¼ŒB1ï¼Œå…¬å¼å¤åˆ¶åˆ°å¦ä¸€ä¸ªä½ç½®æ—¶è¡Œå’Œåˆ—éƒ½è¦å˜</li>
<li>ç»å¯¹å¼•ç”¨ï¼Œå¦‚ï¼š$A$1ï¼Œ$B$1ï¼Œå…¬å¼å¤åˆ¶åˆ°å¦ä¸€ä¸ªä½ç½®æ—¶è¡Œå’Œåˆ—éƒ½ä¸å˜</li>
<li>æ··åˆå¼•ç”¨ï¼Œå¦‚ï¼š$A1ï¼Œ$B1ï¼Œ$A1æ­¤æ—¶å…¬å¼å¤åˆ¶åˆ°å¦ä¸€ä¸ªä½ç½®æ—¶è¡Œè¦å˜ï¼Œåˆ—ä¸å˜</li>
</ul>
</div>
<h2 id="æ•°æ®é€è§†è¡¨">æ•°æ®é€è§†è¡¨</h2>
<p>å¦‚æœå¸Œæœ›åˆ†æ score1 çš„ä¸åŒåŒºé—´ï¼ˆä¾‹å¦‚[1, 10],[11, 20]ï¼‰ä¸‹ï¼Œscore2 åˆ†æ•°å„æ•´æ•°åŒºé—´çš„ä¸ªæ•°ï¼Œä¹Ÿå³ï¼š</p>
<ul>
<li>scroe1 å±äº [1, 10]</li>
<li>score2 å±äº [1,2], [2,3], [3,4], â€¦çš„æ ·æœ¬ä¸ªæ•°</li>
</ul>
<p>æ­¤æ—¶ä½¿ç”¨æ•°æ®é€è§†è¡¨å°±éå¸¸æ–¹ä¾¿äº†ã€‚</p>
<ul>
<li>é¦–å…ˆï¼Œæˆ‘ä»¬é€‰ä¸­éœ€è¦è¿›è¡Œæ•°æ®åˆ†æçš„æ•°æ®ã€‚<br>
<img src="/2022/05/18/Tips-for-Analyzing-data-with-excel/4.jpg" alt></li>
<li>ç„¶åï¼ŒæŒ‰ç…§å¦‚ä¸‹å›¾è§†é¢‘æ‰€ç¤ºçš„æ–¹å¼è¿›è¡Œæ•°æ®åˆ†æã€‚<div class="bili_video"><div style="position: relative; width: 100%; height: 0; padding-bottom: 75%;"><iframe src="https://player.bilibili.com/player.html?aid=939365062&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position: absolute; width: 100%; height: 100%; left: 0; top: 0;"> </iframe></div></div>
</li>
</ul>
<h2 id="excel-å®">Excel å®</h2>
<h4 id="ä»å­˜åœ¨è¶…é“¾æ¥çš„å•å…ƒæ ¼ä¸­æå–è¶…é“¾æ¥">ä»å­˜åœ¨è¶…é“¾æ¥çš„å•å…ƒæ ¼ä¸­æå–è¶…é“¾æ¥</h4>
<p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä» <strong>å·¥å…·-&gt;å®-&gt;Visual Basicç¼–è¾‘å™¨</strong> æ‰“å¼€Visual Basic ç¼–è¾‘å™¨ï¼Œç„¶åé€‰æ‹©æ’å…¥<strong>æ¨¡å—</strong>é€‰é¡¹ï¼Œåœ¨ç¼–è¾‘å™¨ä¸­è¾“å…¥å¦‚ä¸‹çš„ä»£ç ã€‚</p>
<p><img src="/2022/05/18/Tips-for-Analyzing-data-with-excel/5.jpg" alt></p>
<figure class="highlight vb"><table><tr><td class="code"><pre><span class="line"><span class="keyword">Function</span> GetAdrs(Rng)</span><br><span class="line">    Application.Volatile <span class="literal">True</span></span><br><span class="line">    <span class="keyword">With</span> Rng.Hyperlinks(<span class="number">1</span>)</span><br><span class="line">        GetAdrs = IIf(.Address = <span class="string">&quot;&quot;</span>, .SubAddress, .Address)</span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br></pre></td></tr></table></figure>
<p>ç„¶åæŒ‰ç…§å¦‚ä¸‹å›¾æ‰€ç¤ºåƒä½¿ç”¨æ™®é€š Excel å‡½æ•°ä¸€æ ·ä½¿ç”¨ <code>GetAdrs</code> å°±å¯ä»¥äº†ã€‚<br>
<img src="/2022/05/18/Tips-for-Analyzing-data-with-excel/6.jpg" alt></p>
<h2 id="å­—ç¬¦ä¸²æ“ä½œ">å­—ç¬¦ä¸²æ“ä½œ</h2>
<p>å½“éœ€è¦å¤„ç†ç±»ä¼¼è§†é¢‘åˆ†è¾¨ç‡ä¿¡æ¯çš„æ•°æ®<code>720x1280</code>æ—¶ï¼ŒExcel ä¸­çš„å­—ç¬¦ä¸²ç›¸å…³å‡½æ•°å°±æ´¾ä¸Šå¤§ç”¨é€”äº†ã€‚ä¾‹å¦‚ï¼Œå¯¹äºå¦‚ä¸‹è¡¨æ‰€ç¤ºçš„è§†é¢‘æ•°æ®ä¿¡æ¯ä¸­ï¼Œå¦‚ä½•ä»resolutionåˆ—æå–è§†é¢‘å¯¹åº”å®½é«˜ä¿¡æ¯ï¼Ÿ</p>
<table>
<thead>
<tr>
<th>ID</th>
<th>URL</th>
<th>resolution</th>
<th>â€¦â€¦</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>url</td>
<td>720*1280</td>
<td>â€¦â€¦</td>
</tr>
<tr>
<td>2</td>
<td>url</td>
<td>1080*1920</td>
<td>â€¦â€¦</td>
</tr>
</tbody>
</table>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition note"><p class="admonition-title"><a href="https://support.microsoft.com/en-us/office/left-leftb-functions-9203d2d2-7960-479b-84c6-1ea52b99640c">left</a>, <a href="https://support.microsoft.com/en-us/office/right-rightb-functions-240267ee-9afa-4639-a02b-f19e1786cf2f">right</a>, <a href="https://support.microsoft.com/en-us/office/len-lenb-functions-29236f94-cedc-429d-affd-b5e33d2c67cb">len</a>, <a href="https://support.microsoft.com/en-us/office/find-findb-functions-c7912941-af2a-4bdf-a553-d0d89b0a0628">find</a>
</p><ul>
<li><strong>LEFT</strong> returns the first character or characters in a text string, based on the number of characters you specify.</li>
<li><strong>RIGHT</strong> returns the last character or characters in a text string, based on the number of characters you specify.</li>
<li><strong>LEN</strong> returns the number of characters in a text string.</li>
<li><strong>FIND</strong> locate one text string within a second text string, and return the number of the starting position of the first text string from the first character of the second text string.</li>
</ul>
</div>
<p>å¯¹äº <code>720*1280</code> è€Œè¨€ï¼Œ<code>*</code>å·¦è¾¹çš„å­—ç¬¦æ„æˆäº†è§†é¢‘çš„å®½åº¦ä¿¡æ¯ï¼Œè€Œ <code>*</code> å³è¾¹çš„å­—ç¬¦æ„æˆäº†é«˜åº¦ä¿¡æ¯ã€‚</p>
<ul>
<li>å®½åº¦ä¿¡æ¯ï¼šleft(str, position(*) - 1) â†’ <code>=LEFT(str, FIND(&quot;*&quot;, str)-1)</code></li>
<li>é«˜åº¦ä¿¡æ¯ï¼šright(str, length(str) - position(*)) â†’ <code>=RIGHT(str, LEN(str)-FIND(&quot;*&quot;,str))</code></li>
</ul>
<p><img src="/2022/05/18/Tips-for-Analyzing-data-with-excel/7.jpg" alt></p>
<p>åœ¨è§†é¢‘ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬ç§°è§†é¢‘çš„åˆ†è¾¨ç‡ä¸º720Pï¼Œ1080Pâ€¦â€¦ï¼Œå…¶å®ä¹Ÿå°±æ˜¯å®½é«˜ä¿¡æ¯ä¸­çš„æœ€å°å€¼ã€‚å› æ­¤ï¼Œåœ¨å¾—åˆ°å®½é«˜ä¿¡æ¯åï¼Œæˆ‘ä»¬è¿˜å¸Œæœ›å¾—åˆ°è¿™ä¸ªè§†é¢‘æ˜¯720Pè¿˜æ˜¯1080Pã€‚</p>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition note"><p class="admonition-title"><a href="https://support.microsoft.com/en-us/office/min-function-61635d12-920f-4ce2-a70f-96f202dcc152">min</a>ï¼Œ<a href="https://support.microsoft.com/en-us/office/value-function-257d0108-07dc-437d-ae1c-bc2d3953d8c2">value</a>
</p><ul>
<li><strong>MIN</strong> Returns the smallest number in a set of values.</li>
<li><strong>VALUE</strong> Converts a text string that represents a number to a number.</li>
</ul>
</div>
<p>ä½†æ˜¯ï¼Œå®é™…ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>min</code> å¾—å‡ºçš„ç»“æœå´æ˜¯ 0ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚<br>
<img src="/2022/05/18/Tips-for-Analyzing-data-with-excel/8.jpg" alt></p>
<p>è‡³äºåŸå› ï¼Œåœ¨ <a href="https://support.microsoft.com/en-us/office/min-function-61635d12-920f-4ce2-a70f-96f202dcc152">min</a> çš„ <code>Remarks</code> éƒ¨åˆ†è§£é‡Šçš„éå¸¸æ¸…æ¥šï¼š</p>
<ul>
<li>If an argument is an array or reference, only numbers in that array or reference are used. Empty cells, logical values, or <strong>text</strong> in the array or reference are ignored.</li>
<li>If the arguments contain no numbers, MIN returns 0.</li>
</ul>
<p>å› ä¸ºæˆ‘ä»¬ä¹‹å‰é€šè¿‡ <code>left</code>ã€<code>right</code> å¾—åˆ°çš„æ•°æ®æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œå› æ­¤åœ¨ <code>min</code> å‡½æ•°ä¸­ï¼Œè¿™äº›æ•°æ®å‡è¢«è¿‡æ»¤ï¼Œè€Œå½“ <code>min</code> å‡½æ•°å‚æ•°ä¸­ä¸å­˜åœ¨æ•°å­—å‚æ•°æ—¶ï¼Œå®ƒå°±è¿”å› 0ã€‚</p>
<p>æ­¤æ—¶å°±éœ€è¦ç”¨åˆ° <code>value</code> å‡½æ•°å°†å­—ç¬¦ä¸²è½¬æˆæ•°å­—ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š<br>
<img src="/2022/05/18/Tips-for-Analyzing-data-with-excel/9.jpg" alt></p>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>å†™åˆ°è¿™é‡Œï¼Œå›å¤´æƒ³æƒ³ï¼Œè§‰å¾—è‡ªå·±çœŸæ˜¯å¹¸è¿ï¼Œå¹¸è¿äºè‡ªå·±åŠæ—¶åˆ¶æ­¢äº†é‚£æŒ‰è€ä¸ä½çš„æƒ³å±•ç¤ºä¸€ä¸‹æŠ€æœ¯çš„æ„šè ¢çš„æƒ³æ³•ï¼Œå¦åˆ™æˆ‘ç°åœ¨è¿˜åœ¨ç„¦å¤´çƒ‚é¢çš„è°ƒè¯•è‡ªå·±çš„é‚£ä¸€å †ä»£ç ã€‚å½“ç„¶ï¼ŒExcel è¿˜æœ‰æ›´å¤šçš„ã€å…¶ä»–çš„å¼ºå¤§çš„èƒ½åŠ›ï¼Œç­‰é‡åˆ°äº†å†ç»§ç»­è¡¥å……å§~</p>
]]></content>
      <categories>
        <category>æ•°æ®åˆ†æ</category>
      </categories>
      <tags>
        <tag>Excel</tag>
        <tag>VLOOKUP</tag>
        <tag>æ•°æ®é€è§†è¡¨</tag>
      </tags>
  </entry>
  <entry>
    <title>å¦‚ä½•æ­£ç¡®çš„è¯„æµ‹è§†é¢‘ç”»è´¨</title>
    <url>/2022/05/09/How-to-Assess-the-Video-Quality-Correctly/</url>
    <content><![CDATA[<p><img src="/2022/05/09/How-to-Assess-the-Video-Quality-Correctly/1.png" alt></p>
<p>ä½œä¸ºè§†é¢‘ä¸šåŠ¡ï¼Œç»å¸¸éœ€è¦ï¼š</p>
<ul>
<li>å¯¹æ¯”ä¸åŒçš„è§†é¢‘ï¼Œä»è€Œç¡®å®šå“ªä¸ªè§†é¢‘çš„ç”»è´¨æ›´å¥½ï¼Œä»¥ä¾¿å¯ä»¥ä¸ºç”¨æˆ·å¸¦æ¥æ›´å¥½çš„ä½“éªŒã€‚</li>
<li>å¯¹æ¯”ä¸åŒç¼–ç å‚æ•°ç”Ÿæˆçš„è§†é¢‘ï¼Œä»¥ä¾¿ç¡®å®šåœ¨å“ªäº›é…ç½®ä¸‹äº§ç”Ÿçš„è§†é¢‘èƒ½å¸¦æ¥æœ€å¥½çš„ä½“éªŒã€‚</li>
<li>å¯¹æ¯”ä¸åŒäº§å“çš„è§†é¢‘ç”»è´¨ï¼Œä»¥ä¾¿åšåˆ°çŸ¥å½¼çŸ¥å·±ï¼Œå¹¶åœ¨å¯¹æ¯”ä¹‹ä¸­å¸¦æ¥è¾ƒå¥½çš„ç”¨æˆ·ä½“éªŒã€‚</li>
</ul>
<span id="more"></span>
<p>æ€»ä¹‹ï¼Œéœ€è¦å›ç­”ä¸€ä¸ªé—®é¢˜ï¼šç©¶ç«Ÿå“ªä¸ªæ˜¯ç”»è´¨æœ€å¥½çš„è§†é¢‘ï¼Ÿæœ¬æ–‡å°†ä»å½±å“ç”»è´¨çš„å› ç´ ã€ä¸ºä»€ä¹ˆè¦ä¸æ–­æå‡è§†é¢‘ç”»è´¨ã€ç”»è´¨è¯„æµ‹çš„é‡è¦æ€§ã€å¦‚ä½•æ­£ç¡®çš„è¯„æµ‹è§†é¢‘ç”»è´¨ã€è‡ªç ”çš„ç”»è´¨è¯„æµ‹ç³»ç»Ÿâ€”â€”çµé•œæ¥ä»‹ç»æˆ‘ä»¬å¦‚ä½•åˆ©ç”¨çµé•œæ¥å®¢è§‚ã€ç½®ä¿¡ã€é«˜æ•ˆçš„è¯„æµ‹è§†é¢‘ç”»è´¨ï¼Œè¿›è€Œæå‡ç”¨æˆ·ä½“éªŒã€‚</p>
<h2 id="å½±å“ç”»è´¨çš„å› ç´ æ˜¯ä»€ä¹ˆï¼Ÿ">å½±å“ç”»è´¨çš„å› ç´ æ˜¯ä»€ä¹ˆï¼Ÿ</h2>
<p>å½“æˆ‘ä»¬æåŠâ€œè§†é¢‘â€æ—¶ï¼Œä¸€èˆ¬æŒ‡å¾—å‡æ˜¯â€œæ•°å­—è§†é¢‘â€ã€‚è§†è§‰ä¿¡å·ç»è¿‡è®°å½•ã€å‹ç¼©<br>
ã€å­˜å‚¨æ‰èƒ½äº§ç”Ÿæˆ‘ä»¬æ‰€è¯´çš„â€œè§†é¢‘â€<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup>ã€‚åŒæ—¶ï¼Œç”±äº HVS(HVS, human visual systemï¼Œäººç±»è§†è§‰ç³»ç»Ÿ) çš„ç‰¹ç‚¹ï¼Œåœ¨è§†é¢‘è®°å½•ã€å‹ç¼©ã€å­˜å‚¨çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è§†è§‰è´¨é‡æŸå¤±å’Œè§†é¢‘æ•°æ®å‹ç¼©ä¹‹é—´åšå‡ºæƒè¡¡ï¼Œè€Œä¸å½±å“è§†è§‰è´¨é‡<sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup>ã€‚</p>
<p>ä¸€èˆ¬è€Œè¨€ï¼Œå½±å“è§†é¢‘ç”»è´¨çš„å› ç´ ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<ul>
<li>åˆ†è¾¨ç‡ï¼šå›¾åƒä¸­çš„åƒç´ æ•°é‡ï¼Œåœ¨ç‰¹å®šå°ºå¯¸ä¸‹ï¼Œåˆ†è¾¨ç‡è¶Šé«˜ï¼Œåƒç´ è¶Šå¤šï¼Œæ˜¾ç¤ºçš„ç»†èŠ‚åˆ™æ›´ç²¾ç»†ã€‚<sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup></li>
<li>å¸§ç‡ï¼šä¸€ç§’å†…æ˜¾ç¤ºçš„å›¾åƒæ•°é‡ï¼Œç”µå½±çš„å¸§ç‡ä¸€èˆ¬æ˜¯ 24fpsï¼Œæ ‡å‡†ç”µè§†çš„å¸§ç‡é€šå¸¸æ˜¯ 30fpsã€‚<sup class="footnote-ref"><a href="#fn3" id="fnref3:1">[3:1]</a></sup></li>
<li>äº®åº¦ï¼šå¯ä»¥æ˜¾ç¤ºçš„å›¾åƒç…§æ˜å¼ºåº¦çš„èŒƒå›´ï¼Œäººçœ¼èƒ½æ„ŸçŸ¥åˆ°çš„äº®åº¦èŒƒå›´åœ¨ 10W å°¼ç‰¹å·¦å³ã€‚</li>
<li>ä½æ·±ï¼šæ¯ä¸ªåƒç´ å¯ä»¥æ˜¾ç¤ºçš„é¢œè‰²æ•°é‡ï¼Œä½æ·±åº¦è¶Šå¤§ï¼Œå¯æ˜¾ç¤ºçš„é¢œè‰²è¶Šå¤šï¼Œä»è€Œæ¸å˜æ›´å¹³æ»‘ã€æ›´è‡ªç„¶ã€‚<sup class="footnote-ref"><a href="#fn4" id="fnref4">[4]</a></sup></li>
<li>è‰²åŸŸï¼šè‰²åŸŸæ˜¯æŸä¸ªç‰¹å®šçš„è‰²å½©çš„å­é›†ï¼Œç”¨ä»¥è¡¨ç¤ºå¯ä»¥æ˜¾ç¤ºçš„æ‰€æœ‰é¢œè‰²çš„èŒƒå›´ã€‚è‰²åŸŸä¸€èˆ¬ä½¿ç”¨ CIE 1931 è‰²åº¦å›¾ä¸Šçš„é¢ç§¯æ¥è¡¨ç¤ºï¼ŒCIE 1931 æ›²çº¿çš„è¾¹ç¼˜ä»£è¡¨å¯è§å…‰å…‰è°±é¢œè‰²çš„èŒƒå›´ã€‚<sup class="footnote-ref"><a href="#fn4" id="fnref4:1">[4:1]</a></sup></li>
<li>ç ç‡ï¼šç¼–ç æ¯ç§’è§†é¢‘éœ€è¦çš„ bit æ•°é‡ç§°ä¹‹ä¸ºç ç‡ï¼ˆbitrateï¼‰ã€‚åœ¨ä¸€å®šæ¡ä»¶ä¸‹ï¼Œç ç‡ä¼šå½±å“è§†é¢‘çš„è´¨é‡ï¼Œç ç‡è¶Šä½ï¼Œå‹ç¼©ç‡è¶Šå¤§ï¼Œç”»è´¨ç›¸å¯¹è¶Šå·®ã€‚å½“ç„¶ï¼Œå¹¶éç ç‡è¶Šé«˜ç”»è´¨è¶Šå¥½ï¼Œåœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œæ›´é«˜çš„ç ç‡å¸¦æ¥çš„å¾€å¾€å´åªæ˜¯å¸¦å®½çš„æµªè´¹ã€‚<sup class="footnote-ref"><a href="#fn5" id="fnref5">[5]</a></sup></li>
</ul>
<h2 id="ä¸ºä»€ä¹ˆè¦æå‡ç”»è´¨ï¼Ÿ">ä¸ºä»€ä¹ˆè¦æå‡ç”»è´¨ï¼Ÿ</h2>
<p>æˆ‘ä»¬ç»å¸¸è®¤ä¸ºï¼šæ”¹å–„å½±å“è§†é¢‘ç”»è´¨çš„è¯¸å¤šå› ç´ ï¼Œæå‡è§†é¢‘çš„ç”»è´¨ï¼Œå°±ä¼šæå‡ç”¨æˆ·ä½“éªŒï¼Œè¿›è€Œä¼šæå‡äº§å“çš„ç›¸å…³ç”¨æˆ·æŒ‡æ ‡ã€‚å› æ­¤ï¼Œæœ¬ç€ä»¥ç»ˆä¸ºå§‹çš„åŸåˆ™ï¼Œæˆ‘ä»¬è¦ä¸æ–­æå‡è§†é¢‘ç”»è´¨ã€‚</p>
<p>ç„¶è€Œï¼Œäº‹å®ç¡®å®å¦‚æ­¤å—ï¼Ÿæˆ‘ä»¬æ˜¯å¦æƒ³è¿‡å¦‚ä¸‹çš„é—®é¢˜ï¼š</p>
<ul>
<li>ç”¨æˆ·è§†é¢‘è§‚çœ‹æ—¶é•¿çš„å¢åŠ æˆ–é™ä½æ˜¯è§†é¢‘ç”»è´¨çš„æ³¢åŠ¨å¯¼è‡´çš„å—ï¼Ÿ</li>
<li>ç”¨æˆ·åœ¨è§‚çœ‹è§†é¢‘æ—¶ï¼Œæ˜¯è§†é¢‘å†…å®¹çš„å½±å“åŠ›æ›´å¤§è¿˜æ˜¯è§†é¢‘ç”»è´¨çš„å½±å“åŠ›æ›´å¤§ï¼Ÿ</li>
<li>ä¸ºä»€ä¹ˆã€Šè¥¿æ¸¸è®°ã€‹çš„ç”»è´¨æ¯”è¾ƒç²—ç³™ï¼Œå´èƒ½å¾ªç¯æ’­æ”¾ 30 å¤šå¹´ï¼Œå¹¶åˆ›é€ å‡ºä¸‡äººç©ºå··çš„å¥‡è¿¹ï¼Ÿ</li>
<li>å½“æå‡äº†åˆ†è¾¨ç‡ã€å¸§ç‡ç­‰å› ç´ åï¼Œç”»è´¨å˜å¥½äº†ï¼Œä½†æ˜¯è¿™åŒæ—¶ä¹Ÿæ„å‘³ç€éœ€è¦æ¶ˆè€—çš„å¸¦å®½ã€ç®—åŠ›ã€ç”µé‡ç­‰å¿…ç„¶ä¼šå¢åŠ ã€‚åœ¨æ‰‹æœºè€—ç”µé‡ä¸ç”»è´¨ã€æ’­æ”¾æµç•…åº¦ä¸ç”»è´¨ä¹‹é—´ï¼Œç”¨æˆ·ä¼šé€‰æ‹©ç”»è´¨ä¼˜å…ˆå—ï¼Ÿ</li>
<li>æå‡è§†é¢‘çš„åˆ†è¾¨ç‡å’Œå¸§ç‡è¿˜æ„å‘³ç€å¸¦å®½æˆæœ¬çš„å¢åŠ ï¼Œä¾‹å¦‚ 4K è§†é¢‘æ¯” 1080P è§†é¢‘çš„å¸¦å®½æˆæœ¬è¦é«˜ 3~4 å€ã€‚é‚£ä¹ˆï¼Œå¯¹äºæµåª’ä½“æœåŠ¡å•†è€Œè¨€ï¼Œå¦‚æœå¯¹å¦‚ä¸Šçš„å‡ ä¸ªé—®é¢˜è¿˜å­˜ç–‘çš„è¯ï¼Œä¸ºä»€ä¹ˆè¦æå‡ç”»è´¨å‘¢ï¼Ÿ</li>
</ul>
<p>2020å¹´ï¼Œåçº³å…„å¼Ÿä¸çš®å…‹æ–¯ç­‰å…¬å¸çš„åŒç›²æµ‹å®éªŒå‘ç°ï¼Œå¤šæ•°æ¶ˆè´¹è€…å…¶å®å¹¶æ— æ³•åˆ†è¾¨ 8K ä¸ 4K çš„åŒºåˆ«ã€‚<sup class="footnote-ref"><a href="#fn6" id="fnref6">[6]</a></sup></p>
<p>çœ‹èµ·æ¥ï¼Œç”»è´¨æå‡çš„å¿…è¦æ€§å¹¶ä¸å¼ºçƒˆã€‚æ—¢ç„¶å¦‚æ­¤ï¼Œä¸ºä»€ä¹ˆè¿˜è¦æå‡è§†é¢‘ç”»è´¨å‘¢ï¼Ÿä¸ºä»€ä¹ˆæ•´ä¸ªè§†é¢‘è¡Œä¸šéƒ½åœ¨ä¸ºäº†è§†é¢‘ç”»è´¨çš„æå‡è€Œä¸æ–­åŠªåŠ›å‘¢ï¼Ÿ</p>
<ol>
<li>æ˜¾ç¤ºè®¾å¤‡çš„åˆ†è¾¨ç‡ä¸æ–­å‡çº§ã€‚ä¾‹å¦‚ï¼Œ<a href="https://consumer.huawei.com/cn/phones/mate40-pro/specs/">HUAWEI Mate 40 Pro</a> çš„å±å¹•åˆ†è¾¨ç‡å°±è¾¾åˆ°äº† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>K</mi><mo stretchy="false">(</mo><mn>2772</mn><mo>Ã—</mo><mn>1344</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">2K(2772 \times 1344)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="mopen">(</span><span class="mord">2</span><span class="mord">7</span><span class="mord">7</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">3</span><span class="mord">4</span><span class="mord">4</span><span class="mclose">)</span></span></span></span> æ ‡å‡†ã€‚å¯¹äºç”µè§†è€Œè¨€ï¼Œ8K ç”µè§†ç›®å‰ä¹Ÿæˆä¸ºäº†è¶‹åŠ¿ã€‚å¦‚æœè§†é¢‘æœ¬èº«çš„åˆ†è¾¨ç‡ä¾ç„¶åœç•™åœ¨ 480P æ—¶ä»£ï¼Œé‚£ä¹ˆåœ¨é«˜åˆ†è¾¨ç‡çš„å±å¹•ä¸Šè§‚çœ‹æ—¶ï¼Œå°±ä¼šå‡ºç°æ¯”è¾ƒæ˜æ˜¾çš„é©¬èµ›å…‹æ•ˆåº”ã€‚</li>
<li>è§†é¢‘é‡‡é›†è®¾å¤‡ä¸æ–­å‡çº§ã€‚ä¾‹å¦‚ï¼Œ<a href="https://www.apple.com.cn/iphone-13-pro/specs/">iPhone 13 Pro</a> å¯ä»¥æ”¯æŒ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn><mi>K</mi><mtext>ï¼Œ</mtext><mn>60</mn><mtext>Â </mtext><mi>f</mi><mi>p</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">4Kï¼Œ60\ fps</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord">4</span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord">6</span><span class="mord">0</span><span class="mspace">Â </span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">p</span><span class="mord mathdefault">s</span></span></span></span> çš„è§†é¢‘æ‹æ‘„ï¼Œå³ä¾¿æ˜¯ Android çš„åƒå…ƒæœºæ¡£ä½ <a href="https://www.vivo.com/vivo/param/y53s">VIVO Y53S</a>ï¼Œè§†é¢‘çš„æœ€ä½æ‹æ‘„åˆ†è¾¨ç‡ä¹Ÿè¾¾åˆ°äº† 720Pã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœè§†é¢‘æ¶ˆè´¹ç«¯çš„åˆ†è¾¨ç‡è¿˜åœç•™åœ¨è¾ƒä½åˆ†è¾¨ç‡ï¼ˆä¾‹å¦‚ 480Pï¼‰ï¼Œé‚£å°±ä¼šå¸¦æ¥æ‹æ‘„é¢„è§ˆå’Œå›æ”¾è§‚çœ‹ä½“éªŒä¸¥é‡ä¸ä¸€è‡´çš„é—®é¢˜ã€‚</li>
<li>è§†é¢‘ç¼–è§£ç ç®—æ³•ä¸æ–­å‡çº§<sup class="footnote-ref"><a href="#fn7" id="fnref7">[7]</a></sup>ã€‚æœ‰å¤šå¤§çš„ç¡¬ä»¶èµ„æºï¼Œå°±ä¼šäº§ç”Ÿå¤šå¤æ‚çš„è½¯ä»¶äº§å“ã€‚ä¸æ–­è¿›åŒ–çš„ç¼–è§£ç ç®—æ³•ä¸ºæ›´é«˜ç”»è´¨çš„åº”ç”¨æä¾›äº†åº•å±‚æ”¯æ’‘ã€‚å½“å…·å¤‡äº†åˆ¶é€ é£æœºçš„æŠ€æœ¯æ—¶ï¼Œå°±ä¸ä¼šæ»¡è¶³ä¸åªåˆ¶é€ è‡ªè¡Œè½¦ã€‚</li>
<li>ä¸æ–­ä¸°å¯Œçš„æ¶ˆè´¹çº§åº”ç”¨å’Œç©æ³•éœ€è¦æ›´é«˜çš„ç”»è´¨ã€‚æ ¹æ®å›½å®¶å¹¿ç”µæ€»å±€å‘å¸ƒçš„<a href="http://www.nrta.gov.cn/module/download/downfile.jsp?classid=0&amp;filename=cf359da741ac4bdba25f4b77b9cfc160.pdf">ã€Š5G é«˜æ–°è§†é¢‘â€”â€”VR è§†é¢‘æŠ€æœ¯ç™½çš®ä¹¦(2020) ã€‹</a> ï¼Œç”¨äº VR è§†é¢‘èŠ‚ç›®åˆ¶ä½œä¸äº¤æ¢ä¸­çš„è§†é¢‘ï¼Œå»ºè®®ç›®å‰æœ€ä½ä½¿ç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>7680</mn><mo>Ã—</mo><mn>3840</mn></mrow><annotation encoding="application/x-tex">7680\times3840</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">7</span><span class="mord">6</span><span class="mord">8</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span><span class="mord">8</span><span class="mord">4</span><span class="mord">0</span></span></span></span> åƒç´ æ•°ã€‚å°¤å…¶æ˜¯åœ¨å…ƒå®‡å®™ä¹‹ä¸­ï¼Œè¦æ„ŸçŸ¥åˆ°è‰²å£°é¦™å‘³è§¦æ³•ï¼Œå¤ªå·®çš„ç”»è´¨æ˜¯æ— æ³•è¾¾åˆ°è¦æ±‚çš„ã€‚</li>
<li>ä¸æ–­å¢åŠ çš„ç«å¯¹äº§å“ã€‚æ­¤æ—¶ï¼Œè§†é¢‘ç”»è´¨çš„åŸºçº¿æ°´å¹³å–å†³äºå¤„åœ¨è¯¥è¡Œä¸šä¸­çš„ç«å¯¹äº§å“ã€‚å¹¶ä¸”ï¼Œè§†é¢‘ç”»è´¨å·²ç»æˆä¸ºä¸€ç§å¯¹å¤–å®£ä¼ çš„æœ‰æ•ˆæ‰‹æ®µï¼Œä¾‹å¦‚ B ç«™çš„ 4K/120å¸§ è§†é¢‘ï¼Œè¥¿ç“œçš„ 4K é«˜æ¸…ä¿®å¤æŠ€æœ¯â€¦â€¦è¿™æ— å½¢ä¹‹ä¸­å°±ä¼šå½¢æˆä¸€ç§ç”¨æˆ·å¯¹è§†é¢‘ç”»è´¨çš„é¢„æœŸï¼Œå½“äº§å“çš„ç”»è´¨å¦‚æœä½äºè¿™ç§é¢„æœŸçš„æ—¶å€™ï¼Œç”¨æˆ·ä½“éªŒå°±ä¼šé™ä½ã€‚å½“ç„¶ï¼Œæ›´é«˜çš„ç”»è´¨ä¾èµ–æ›´é«˜æ€§èƒ½çš„è®¾å¤‡å’Œæ›´é«˜çš„å¸¦å®½ã€‚ä½†æ˜¯æˆ‘ä»¬éœ€è¦æ˜ç™½ï¼šåŒæ ·èƒ½å¾— 100 åˆ†ï¼Œèƒ½åŠ›åªèƒ½åˆ° 100 åˆ† å’Œ å·é¢åªæœ‰ 100 åˆ†ä¹‹é—´çš„å·®è·æ˜¯éå¸¸å¤§çš„ã€‚</li>
</ol>
<h2 id="ä¸ºä»€ä¹ˆè¯„æµ‹è§†é¢‘ç”»è´¨å¦‚æ­¤é‡è¦ï¼Ÿ">ä¸ºä»€ä¹ˆè¯„æµ‹è§†é¢‘ç”»è´¨å¦‚æ­¤é‡è¦ï¼Ÿ</h2>
<p>å¦‚å‰æ‰€è¿°ï¼Œä¼—å¤šåŸå› æ¨åŠ¨è§†é¢‘ç”»è´¨ä¸æ–­æå‡ã€‚ç„¶è€Œï¼Œæ²¡æœ‰åº¦é‡å°±æ— æ³•æ”¹è¿›ï¼Œæ²¡æœ‰åº¦é‡ä¹Ÿå°±æ— æ³•è¯„æµ‹ç”»è´¨æ˜¯å¦æœ‰æå‡ã€æå‡çš„ç¨‹åº¦å¦‚ä½•ã€‚å¦å¤–ï¼Œåœ¨å·¥ä½œä¸­ï¼Œéœ€è¦é€šè¿‡è¯„ä¼°è§†é¢‘ç”»è´¨æ¥ç¡®å®šæµåª’ä½“ç³»ç»Ÿçš„æ•´ä½“è¦æ±‚ã€å¯¹æ¯”ç«å“æä¾›çš„æœåŠ¡ã€ç¡®å®šç«¯åˆ°ç«¯çš„è§†é¢‘è´¨é‡ç­‰ã€‚</p>
<p>è§†é¢‘ç”»è´¨è¯„ä¼°å¦‚åŒåº¦é‡è¡¡ä¸€èˆ¬ï¼Œæ„æˆè§†é¢‘ç”»è´¨æå‡ä»¥åŠç¼–è§£ç å™¨æ”¹è¿›çš„åŸºçŸ³ã€‚</p>
<h4 id="ä¸»è§‚è¯„ä¼°">ä¸»è§‚è¯„ä¼°</h4>
<p>è¯„æµ‹è§†é¢‘ç”»è´¨çš„æ˜¾è€Œæ˜“è§çš„æ–¹å¼å°±æ˜¯å¾æ±‚ç”¨æˆ·çš„æ„è§ï¼Œè¿™ä¹Ÿå°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„ï¼šä¸»è§‚è¯„ä¼°ã€‚ä½†æ˜¯ï¼Œä¸»è§‚è¯„ä¼°å…·å¤‡å¦‚ä¸‹çš„é—®é¢˜ï¼š</p>
<ul>
<li>ä¸»è§‚è¯„ä¼°æ˜¯ä¸€ä¸ªç¹ççš„ã€éè‡ªåŠ¨åŒ–çš„è¿‡ç¨‹ï¼Œä¸å¯èƒ½åˆ©ç”¨ä¸»è§‚è¯„ä¼°æ¥è¯„æµ‹æ¯ä¸ªè§†é¢‘ã€‚</li>
<li>ä¸åŒçš„ä¸ªä½“å¯¹ç›¸åŒçš„è§†é¢‘ç”»è´¨æ„ŸçŸ¥ä¸åŒï¼Œå› æ­¤ä¸»è§‚è¯„ä¼°çš„ç»“æœä¼šéšè¯„ä¼°è€…çš„ä¸åŒè€Œå‡ºç°æ³¢åŠ¨ã€‚</li>
</ul>
<h4 id="å®¢è§‚è¯„ä¼°">å®¢è§‚è¯„ä¼°</h4>
<p>å³ä¾¿å¦‚æ­¤ï¼Œä¸»è§‚è¯„ä¼°ä»ç„¶æ˜¯ä¸€ç§æœ‰ä»·å€¼çš„æ–¹æ³•ï¼Œå¹¶ä¸”å¯ä»¥ä¸ºå®¢è§‚è§†é¢‘ç”»è´¨è¯„ä¼°ç®—æ³•æä¾›æ•°æ®æ”¯æ’‘ï¼Œä¾‹å¦‚ <a href="https://github.com/Netflix/vmaf">VMAF</a> å°±æ˜¯åˆ©ç”¨ç®—æ³•æŒ‡æ ‡å¯¹ä¸»è§‚è¯„ä¼°å»ºæ¨¡çš„ç»“æœã€‚åˆ©ç”¨ç®—æ³•æ¥è¯„ä¼°è§†é¢‘çš„ç”»è´¨æˆ‘ä»¬ç§°ä¹‹ä¸ºï¼šå®¢è§‚è¯„ä¼°ã€‚</p>
<h4 id="ä¸»-å®¢è¯„ä¼°ä¹‹é—´çš„å…³ç³»">ä¸»ã€å®¢è¯„ä¼°ä¹‹é—´çš„å…³ç³»</h4>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨è§†é¢‘ç”»è´¨è¯„ä¼°é¢†åŸŸï¼Œè™½ç„¶ç®—æ³•å¯ä»¥å¿«é€Ÿã€é«˜æ•ˆã€è‡ªåŠ¨çš„è¯„æµ‹è§†é¢‘ç”»è´¨ï¼Œä½†æ˜¯ç®—æ³•ä¹Ÿä»…ä»…æ˜¯å¯¹ä¸»è§‚è¯„ä¼°ç»“æœçš„æ‹Ÿåˆã€é¢„æµ‹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®¢è§‚è¯„ä¼°ç®—æ³•å¿…é¡»ä¸ä¸»è§‚è¯„ä¼°ä¹‹é—´ä¿æŒæ„ŸçŸ¥ä¸Šçš„ä¸€è‡´æ€§ã€‚</p>
<p>æ­£å› ä¸ºå¦‚æ­¤ï¼Œåœ¨å®é™…å·¥ä½œä¸­ï¼Œå®¢è§‚ç®—æ³•ä¸€èˆ¬ç”¨ä»¥è¡¡é‡å¤§ç›˜æ•°æ®ï¼Œè€Œå¯¹äºè§†é¢‘ç¼–è§£ç å™¨çš„è°ƒæ•´ã€ç¼–è§£ç å‚æ•°çš„ä¼˜åŒ–ç­‰æ•ˆæœè¯„ä¼°ï¼Œè¿˜æ˜¯ä¼šä»¥ä¸»è§‚è¯„ä¼°ä¸ºä¸»ã€‚<a href="http://www.compression.ru/video/codec_comparison/index_en.html">MSU Video Codecs Comparisons</a> å¤§èµ›ä¸­ï¼Œä¸»è§‚æ‰“åˆ†çš„ç»“æœä¹Ÿæ˜¯ä¸€é¡¹é‡è¦çš„æŒ‡æ ‡ï¼Œä¾‹å¦‚ <a href="http://www.compression.ru/video/codec_comparison/hevc_2019/#subjective_report">HEVC/AV1 2019</a> çš„æ¯”èµ›ç»“æœã€‚ä½œä¸ºå·¥ç¨‹å¸ˆï¼Œæˆ‘ä»¬æ€»æƒ³ç€ç”¨ç®—æ³•ã€æ¨¡å‹æ¥è§£å†³ä¸€åˆ‡é—®é¢˜ï¼Œç„¶è€Œï¼Œæˆ‘ä»¬å¿…é¡»è¦æ„è¯†åˆ°ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„é—®é¢˜éƒ½å¯ä»¥ç”¨ç®—æ³•ã€æ¨¡å‹æ¥è§£å†³çš„ã€‚è¿˜è®°å¾—ã€Šè°åŠ¨äº†æˆ‘çš„å¥¶é…ªã€‹ä¸­çš„â€œå“¼å“¼â€å—ï¼Ÿ</p>
<p>è§†é¢‘ç”»è´¨ä¸»ã€å®¢è§‚è¯„ä¼°ç®—æ³•è¿™é‡Œä¸å†è¿‡å¤šä»‹ç»ï¼Œæ›´è¯¦ç»†çš„ä¿¡æ¯å¯ä»¥å‚è€ƒ<a href="https://wangwei1237.github.io/digital_video_concepts/docs/4_0_VideoQualityMetrics.html">ã€Šæ•°å­—è§†é¢‘æ¦‚å¿µï¼Œæ–¹æ³•å’Œæµ‹é‡æŒ‡æ ‡ã€‹çš„ è§†é¢‘è´¨é‡æŒ‡æ ‡</a> è¿™ä¸€ç« ã€‚</p>
<h2 id="å½±å“è¯„æµ‹ç½®ä¿¡åº¦çš„å› ç´ æœ‰å“ªäº›ï¼Ÿ">å½±å“è¯„æµ‹ç½®ä¿¡åº¦çš„å› ç´ æœ‰å“ªäº›ï¼Ÿ</h2>
<p>ä¸»è§‚è¯„ä¼°æ˜¯ç”»è´¨æå‡çš„åŸºçŸ³ï¼Œå¦‚ä½•æ‰èƒ½ä¿è¯ä¸»è§‚è¯„ä¼°ç»“æœçš„å®¢è§‚æ€§ã€ç½®ä¿¡åº¦æ˜¯è§†é¢‘ç”»è´¨è¯„æµ‹çš„æ ¸å¿ƒé—®é¢˜ã€‚</p>
<p>ä¸ºäº†ä¿è¯ä¸»è§‚è¯„ä¼°çš„ç½®ä¿¡åº¦ï¼ŒITU-T ç¬¬ 9 ç ”ç©¶ç»„ï¼ˆSG9, study group 9ï¼‰æå‡ºäº†è‹¥å¹²å»ºè®®ä½œä¸ºä¸»è§‚è¯„ä¼°æ–¹æ³•ï¼Œä¾‹å¦‚ <a href="https://www.itu.int/rec/R-REC-BT.500/en">ITU-R BT.500</a>ã€‚æ›´è¯¦ç»†çš„æ ‡å‡†å’Œè§„èŒƒå¯ä»¥å‚è€ƒ <a href="https://wangwei1237.github.io/shares/vqs.pdf">è§†é¢‘è´¨é‡ä¸»è§‚è¯„ä¼°æ–¹æ³•å’Œè§„èŒƒ</a>ï¼Œæ­¤å¤„ä¸å†ä¸€ä¸€åˆ—ä¸¾ã€‚</p>
<p>åœ¨å·¥ä½œä¸­ï¼Œæˆ‘ä»¬å‘ç°ï¼šä¸æŒ‰ç…§æ ‡å‡†å’Œè§„èŒƒæ‰§è¡Œï¼Œä¸»è§‚è¯„ä¼°çš„ç»“æœè‚¯å®šæ˜¯ä¸ç½®ä¿¡çš„ã€‚ä½†æ˜¯ï¼Œæœ‰äº†æ ‡å‡†å’Œè§„èŒƒï¼ŒæŒ‰ç…§æ ‡å‡†å’Œè§„èŒƒæ¥æ‰§è¡Œä¸»è§‚ç”»è´¨è¯„æµ‹ï¼Œä¸»è§‚è¯„ä¼°çš„ç»“æœå°±ç½®ä¿¡äº†å—ï¼Ÿ</p>
<p>åœ¨å·¥ä½œä¸­ï¼Œæˆ‘ä»¬å‘ç°ï¼Œå¹¶éå¦‚æ­¤ã€‚æ ‡å‡†æä¾›äº†å»ºè®®ï¼Œä½†æ˜¯å…·ä½“æ‰§è¡Œå´å—é™äºå„ç§å› ç´ ï¼Œè¿™äº›å—é™çš„å› ç´ ä¼šå½±å“æœ€ç»ˆçš„ç»“æœç½®ä¿¡åº¦ã€‚</p>
<p>ä¸€ä¸ªçœ‹èµ·æ¥éå¸¸ç®€å•çš„äº‹æƒ…ï¼ˆä¸å°±æ˜¯æ‰¾äººæ¥æ‰“ä¸ªåˆ†å—ï¼‰ï¼Œå®é™…ä¸Šå´å¹¶ä¸ç®€å•ã€‚</p>
<h4 id="è¯„æµ‹æ ·æœ¬çš„é—®é¢˜">è¯„æµ‹æ ·æœ¬çš„é—®é¢˜</h4>
<p>è§†é¢‘æ ·æœ¬æœ¬èº«å¯¹è§†é¢‘ç”»è´¨ä¸»è§‚è¯„ä¼°çš„ç»“æœä¼šäº§ç”Ÿéå¸¸å¤§çš„å½±å“ï¼Œå®é™…è¯„æµ‹è¿‡ç¨‹ä¸­ï¼Œé‡åˆ°çš„æ ·æœ¬ç›¸å…³çš„é—®é¢˜ä¸»è¦æœ‰å¦‚ä¸‹å‡ ç§ï¼š</p>
<ol>
<li>è¯„æµ‹è§†é¢‘æ—¶é—´è¾ƒé•¿ï¼Œåœºæ™¯å˜åŒ–è¾ƒå¤§ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œç”¨æˆ·å¯èƒ½æ²¡æœ‰è€å¿ƒçœ‹å®Œæ•´ä¸ªè§†é¢‘ï¼Œæˆ–è€…è·³è·ƒæ€§çš„è§‚çœ‹è§†é¢‘ï¼Œå¯¼è‡´åœ¨è¯„æµ‹è¿‡ç¨‹ä¸­å¿½ç•¥éƒ¨åˆ†ä¿¡æ¯è€Œè€Œå¯¼è‡´æœ€ç»ˆç»“æœç½®ä¿¡åº¦è¾ƒå·®ã€‚</li>
<li>è¯„æµ‹çš„è§†é¢‘ä¸­å­˜åœ¨äº§å“ logoã€‚è§†é¢‘ä¸­çš„ logo ä¼šå¯¹ç”¨æˆ·çš„ä¸»è§‚è¯„æµ‹å¸¦æ¥é¢å¤–çš„ä¿¡æ¯å¹²æ‰°ï¼Œè¿›è€Œå¹²æ‰°åˆ°æœ€ç»ˆçš„è¯„æµ‹ç»“æœã€‚å®é™…è¯„æµ‹è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿè§‚å¯Ÿåˆ°è§†é¢‘ä¸­çš„ logo ç¡®å®ä¼šå½±å“ç”¨æˆ·çš„ä¸»è§‚æ‰“åˆ†ã€‚<br>
<img src="/2022/05/09/How-to-Assess-the-Video-Quality-Correctly/16517338315179.jpg" alt></li>
<li>è¯„æµ‹è§†é¢‘çš„åœºæ™¯è¦†ç›–ç‡è¾ƒä½ï¼Œæˆ–è€…åªè¦†ç›–äº†éƒ¨åˆ†äº§å“åœºæ™¯ã€‚ä¾‹å¦‚åªé€‰å–äº†é£æ™¯ã€äººç‰©ç­‰åœºæ™¯çš„è§†é¢‘ï¼Œè€Œç¼ºå¤±äº†è¿åŠ¨ç±»ï¼ŒçŸ¥è¯†ç±»ç­‰åœºæ™¯çš„è§†é¢‘ã€‚</li>
</ol>
<h4 id="è¯„æµ‹å·¥å…·çš„é—®é¢˜">è¯„æµ‹å·¥å…·çš„é—®é¢˜</h4>
<ol>
<li>è§†é¢‘ç¼©æ”¾å¸¦æ¥çš„è¯¯å·®ã€‚ä¸ºäº†èƒ½å¤ŸåŒæ—¶å¯¹æ¯”ä¸¤ä¸ªè§†é¢‘ï¼Œä¸€èˆ¬è€Œè¨€ï¼Œè¯„æµ‹å·¥å…·ä¼šåŒæ—¶æ’­æ”¾å¾…è¯„ä¼°çš„ä¸¤ä¸ªè§†é¢‘æ¥è®©ç”¨æˆ·ä¸»è§‚æ‰“åˆ†ã€‚ä½†æ˜¯ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå½“è§†é¢‘åˆ†è¾¨ç‡æ¯”è¾ƒå¤§æ—¶ï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1080</mn><mo>Ã—</mo><mn>1920</mn></mrow><annotation encoding="application/x-tex">1080 \times 1920</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">8</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">9</span><span class="mord">2</span><span class="mord">0</span></span></span></span>ï¼‰ï¼Œè¿™ç§æ–¹å¼å°±ä¼šå¯¼è‡´è§†é¢‘æ˜¾ç¤ºåŒºåŸŸçš„ç¼©æ”¾ï¼Œè¿›è€Œå¯¼è‡´è§†é¢‘ä¸­ç”»è´¨è¾ƒå·®çš„åœ°æ–¹å› ä¸ºè§†é¢‘æ˜¾ç¤ºåŒºåŸŸçš„ç¼©æ”¾è€Œéšè—ã€‚<br>
<img src="/2022/05/09/How-to-Assess-the-Video-Quality-Correctly/16517351583684.jpg" alt></li>
<li>è§†é¢‘é‡å å¸¦æ¥çš„è¯¯å·®ã€‚ä¸ºäº†è§£å†³ä¸Šä¸€ä¸ªé—®é¢˜ï¼Œè¯„ä¼°å·¥å…·ä¼šå¢åŠ å¦‚ä¸‹å›¾æ‰€ç¤ºçš„é‡å æ ·å¼æ¥é¿å…ç¼©æ”¾å¸¦æ¥çš„è¯¯å·®é—®é¢˜ï¼ŒåŒæ—¶ä¹Ÿå¸Œæœ›é‡å æ–¹å¼èƒ½å¤Ÿæ›´ç›´æ¥çš„å¯¹æ¯”å‡ºè§†é¢‘é—´çš„å·®å¼‚ã€‚<br>
<img src="/2022/05/09/How-to-Assess-the-Video-Quality-Correctly/16517375976060.jpg" alt><br>
ä½†æ˜¯ï¼Œåœ¨å®é™…è¯„ä¼°ä¸­ï¼Œæˆ‘ä»¬å‘ç°è¿™ç§çœ‹èµ·æ¥æ¯”è¾ƒå¥½çš„æ–¹å¼å› ä¸ºå­˜åœ¨è§†é¢‘ç”»é¢çš„é˜¶æ®µï¼Œä¹Ÿä¼šå¯¼è‡´ä¸»è§‚è¯„ä¼°ç»“æœçš„ä¸ç½®ä¿¡ã€‚ç”¨æˆ·åœ¨è¯„ä¼°è¿‡ç¨‹ä¸­ï¼Œéœ€è¦ä¸åœçš„æ‹–åŠ¨ç”»é¢çš„åˆ†å‰²çº¿ï¼Œæ¥è§‚å¯Ÿè§†é¢‘ä¸åŒåŒºåŸŸçš„ç”»è´¨å·®å¼‚ã€‚å¹¶ä¸”å¯¹äº ROI ç¼–ç çš„è§†é¢‘è€Œè¨€ï¼Œç”¨ä¸€ä¸ªè§†é¢‘çš„åŒºåŸŸ A å’Œå¦ä¸€ä¸ªè§†é¢‘çš„åŒºåŸŸ B åšå¯¹æ¯”ï¼Œæœ¬èº«å°±éå¸¸ä¸åˆç†ã€‚</li>
<li>è§†é¢‘è¿åŠ¨å¸¦æ¥çš„è¯¯å·®ã€‚å’Œå›¾ç‰‡ä¸åŒï¼Œè§†é¢‘æ˜¯ä¸€ä¸ªåœ¨æ—¶é—´ä¸Šè¿ç»­å˜åŒ–çš„å¸§åºåˆ—ã€‚è€Œè¿™ç§è§†é¢‘æœ¬èº«çš„è¿åŠ¨å’Œå˜åŒ–ä¼šåœ¨ä¸€å®šç¨‹åº¦ä¸Šéšè—è§†é¢‘ä¸­æŸäº›å¸§çš„æŸäº›åŒºåŸŸçš„ç”»è´¨é—®é¢˜ã€‚è¿™ä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„ HVS çš„è¿åŠ¨æ©è”½æ•ˆåº”ã€‚ä¸ºäº†é¿å…è¿™ç§è¯¯å·®ï¼Œå°¤å…¶æ˜¯å¯¹äºç¼–è§£ç ç®—æ³•çš„ç ”å‘äººå‘˜ï¼Œå¾€å¾€å¸Œæœ›èƒ½å¤Ÿå¯¹è§†é¢‘è¿›è¡Œé€å¸§å¯¹æ¯”ï¼Œä»¥å‘ç°æ½œåœ¨çš„éšè—é£é™©ã€‚è™½ç„¶è¯¸å¦‚ QuickTimeã€VLCç­‰æ’­æ”¾å™¨æä¾›äº†å•å¸§æ’­æ”¾èƒ½åŠ›ï¼Œä½†æ˜¯è¯„æµ‹å·¥å…·å´è¾ƒå°‘æä¾›å•å¸§å¯¹æ¯”çš„èƒ½åŠ›ã€‚</li>
<li>å¿½ç•¥æ’­æ”¾è®¾å¤‡çš„å·®å¼‚å¸¦æ¥çš„è¯¯å·®ã€‚å·¥ä½œä¸­ï¼Œæˆ‘ä»¬ä¸æ­¢ä¸€æ¬¡çš„å‘ç°ç”¨ PC çš„è¯„ä¼°å·¥å…·æ¥è¯„ä¼°ç§»åŠ¨è®¾å¤‡çš„æ’­æ”¾æ•ˆæœçš„åœºæ™¯ã€‚åˆ©ç”¨æ ‡å‡†å’Œè§„èŒƒæŒ‡å¯¼ä¸‹çš„å·¥å…·å¾—åˆ°äº†ä¸€ä¸ªç»“æœï¼Œå´å¿½è§†äº†ä¸åŒè®¾å¤‡ä¸‹æ˜¾ç¤ºæ•ˆæœçš„å·®å¼‚ï¼Œæœ€ç»ˆå¯¼è‡´è¿™ä¸ªæœ¬æ¥åº”è¯¥ç½®ä¿¡çš„ç»“æœå˜å¾—éå¸¸ä¸ç½®ä¿¡ã€‚å°¤å…¶æ˜¯å¯¹äº HDR<sup class="footnote-ref"><a href="#fn8" id="fnref8">[8]</a></sup> è§†é¢‘è€Œè¨€ï¼Œè®¾å¤‡çš„å·®å¼‚æ€§ä¼šä½“ç°çš„æ›´åŠ æ˜æ˜¾ã€‚</li>
</ol>
<h4 id="è¯„æµ‹è€…çš„è®¤çŸ¥å·®å¼‚">è¯„æµ‹è€…çš„è®¤çŸ¥å·®å¼‚</h4>
<ul>
<li>è¯„æµ‹è€…çš„æƒ¯æ€§è®¤çŸ¥å¸¦æ¥çš„è¯¯å·®ã€‚å¯¹äºå›ºå®šé¡ºåºå‡ºç°çš„å¯¹æ¯”è¯„ä¼°ï¼Œæˆ‘ä»¬å‘ç°è¯„æµ‹è€…æ€»æ˜¯ä¼šæ ¹æ®å‰é¢å‡ å¯¹æ ·æœ¬çš„ç»“æœæ¥å¯¹åé¢çš„ç»“æœè¿›è¡Œé¢„æµ‹ï¼Œç„¶åæŒ‰ç…§é¢„æµ‹çš„ç»“æœæ¥æ‰“åˆ†ï¼Œè€Œä¸æ˜¯å®Œå…¨æŒ‰ç…§è‡ªå·±ä¸ªä¸»è§‚æ„ŸçŸ¥æ¥æ‰“åˆ†ã€‚è¿™ç§é¢„æµ‹çš„æƒ¯æ€§è®¤çŸ¥ä¼šç»™è¯„ä¼°å¸¦æ¥éå¸¸å¤§çš„å¹²æ‰°å’Œè¯¯å·®ã€‚</li>
<li>è¯„æµ‹è€…çš„å…³æ³¨ç„¦ç‚¹ä¸åŒå¸¦æ¥çš„è¯¯å·®ã€‚ä¸åŒçš„è¯„æµ‹è€…å¯¹åŒä¸€ç”»é¢çš„å…³æ³¨ç‚¹ä¸åŒè€Œå¸¦æ¥çš„è¯„ä¼°ç»“æœæ³¢åŠ¨è¾ƒå¤§çš„é—®é¢˜åœ¨å®é™…è¯„ä¼°å·¥ä½œä¸­ç»å¸¸å‡ºç°ã€‚ä¾‹å¦‚ï¼Œç”¨æˆ·ä»èƒŒæ™¯ã€å‰æ™¯ã€äº®åº¦ã€ç¾å¦†ç­‰ä¸åŒè§’åº¦æ¥è¯„ä¼°æ—¶ï¼Œç»™å‡ºçš„æ‰“åˆ†ä¹Ÿä¸ç›¸åŒã€‚</li>
</ul>
<h2 id="ç”»è´¨è¯„æµ‹åˆ©å™¨-çµé•œ">ç”»è´¨è¯„æµ‹åˆ©å™¨â€”â€”çµé•œ</h2>
<p>å†æ—¶ 2 å¹´å¤šï¼Œç»å†è¿‘ 500+ ä¸»è§‚è¯„ä¼°ï¼Œ1000+ è¯„ä¼°æ ·æœ¬ï¼Œ1000+ è¯„æµ‹äººå‘˜ï¼ˆä¸“å®¶å’Œæ™®é€šç”¨æˆ·ï¼‰ï¼Œè¶Ÿè¿‡ä¸€ä¸ªåˆä¸€ä¸ªçš„å‘ï¼Œåˆ©ç”¨æŠ€æœ¯è§£å†³å®é™…è¯„æµ‹ä¸­é‡åˆ°çš„ä¸€ä¸ªåˆä¸€ä¸ªçš„ä¸ç½®ä¿¡å› ç´ ï¼Œé€æ­¥å»ºæˆäº†ç›®å‰è¾ƒä¸ºç½®ä¿¡çš„è§†é¢‘ç”»è´¨è¯„ä¼°ç³»ç»Ÿâ€”â€”çµé•œã€‚</p>
<p>çµé•œåŸºäº ITU æ ‡å‡†ï¼Œä¾æ‰˜è‡ªç ”çš„ 10+ é¡¹ä¸“åˆ©æŠ€æœ¯ï¼Œåœ¨ä¸æ–­å®è·µçš„åŸºç¡€ä¹‹ä¸Šè€Œå½¢æˆçš„ä¸€æ¬¾æ”¯æŒå¤šç«¯ï¼ˆPCï¼ŒAndroidï¼ŒiOSï¼‰è¯„æµ‹çš„è§†é¢‘ç”»è´¨è¯„æµ‹æœåŠ¡ã€‚</p>
<p><img src="/2022/05/09/How-to-Assess-the-Video-Quality-Correctly/16517546841705.png" alt></p>
<p>åŒæ—¶çµé•œè¿˜æä¾›è§†é¢‘ç”»è´¨è¯„ä¼°çš„ä¸€ç«™å¼æœåŠ¡ï¼Œæ¶µç›–äº†ï¼šä»è§†é¢‘ç”Ÿäº§è‡³è§†é¢‘æ¶ˆè´¹çš„å…¨é“¾è·¯ç”»è´¨è¯„ä¼°ï¼Œç”»è´¨ã€æˆæœ¬ç­‰å…¨æ–¹ä½çš„è¯„æµ‹ä»¥åŠè§£æã€‚</p>
<p><img src="/2022/05/09/How-to-Assess-the-Video-Quality-Correctly/16520635610845.jpg" alt></p>
<p>åœ¨è¯„æµ‹æ–¹å¼ä¸Šï¼Œçµé•œæ”¯æŒPCã€Androidã€iOSè®¾å¤‡ä¸Šçš„æ¨ªå±ã€ç«–å±è§†é¢‘çš„ä»¥ä¸‹ 4 ç§è¯„æµ‹æ–¹å¼ï¼š</p>
<ol>
<li>
<p>å•å±è¯„æµ‹<br>
<img src="/2022/05/09/How-to-Assess-the-Video-Quality-Correctly/16517999977033.jpg" alt></p>
</li>
<li>
<p>åŒå±é‡å è¯„æµ‹ï¼ˆåŒæ—¶æ”¯æŒ DCR å’Œ CCR ä¸¤ç§è¯„ä¼°æ¨¡å¼ï¼Œå¹¶ä¸”ä¸ºäº†ä¿è¯ç½®ä¿¡åº¦ï¼Œé‡‡ç”¨è§†é¢‘åŒåŒºåŸŸå¯¹æ¯”çš„æ–¹å¼è¿›è¡ŒåŒå±é‡å å¯¹æ¯”ï¼Œå¯ä»¥æ»‘åŠ¨è§†é¢‘åŒºåŸŸæ¥é€‰æ‹©ä¸åŒåŒºåŸŸçš„è§†é¢‘è¿›è¡Œå¯¹æ¯”ï¼‰<br>
<img src="/2022/05/09/How-to-Assess-the-Video-Quality-Correctly/16518006317482.jpg" alt></p>
</li>
<li>
<p>ä¸“å®¶è¯„æµ‹<br>
<img src="/2022/05/09/How-to-Assess-the-Video-Quality-Correctly/16518012927012.jpg" alt></p>
</li>
<li>
<p>åŒå±è¯„æµ‹<br>
<img src="/2022/05/09/How-to-Assess-the-Video-Quality-Correctly/16518013761932.jpg" alt></p>
</li>
</ol>
<p>é™¤æ­¤ä¹‹å¤–ï¼Œçµé•œè¿˜æä¾›äº†ï¼š</p>
<ul>
<li>æ‘„åƒå¤´ Mock èƒ½åŠ›ï¼Œå®ç°ç”¨æŒ‡å®šè§†é¢‘æ›¿æ¢æ‘„åƒå¤´çš„é‡‡é›†æ•°æ®</li>
<li>ç”»è´¨å®¢è§‚è¯„ä¼°èƒ½åŠ›ï¼Œä¾‹å¦‚ VMAFï¼ŒPSNRï¼ŒSSIMç­‰ï¼Œå¯¹äº PSNRï¼Œçµé•œè¿˜æä¾›äº†ç©ºé—´å¯è§†åŒ–èƒ½åŠ›ï¼Œä»¥ä¾¿è¿›è¡Œæ›´å®¢è§‚çš„è¯„æµ‹<br>
<img src="/2022/05/09/How-to-Assess-the-Video-Quality-Correctly/o1.gif" alt></li>
<li>è§†é¢‘å±æ€§è®¡ç®—èƒ½åŠ›ï¼Œä¾‹å¦‚ SITIï¼Œç ç‡ï¼Œå¸§ç‡ï¼Œåˆ†è¾¨ç‡ç­‰</li>
<li>è§†é¢‘å¤„ç†&amp;æ£€æµ‹èƒ½åŠ›ï¼Œä¾‹å¦‚ é™æ€å¸§æ£€æµ‹ï¼Œå•è‰²å¸§æ£€æµ‹ï¼ŒéŸ³ç”»åŒæ­¥æ£€æµ‹ï¼Œå¼‚å¸¸è§†é¢‘æ„é€ ç­‰</li>
</ul>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¿˜å°†ç»§ç»­å®Œå–„çµé•œçš„èƒ½åŠ›ï¼š</p>
<ul>
<li>å•å¸§å¯¹æ¯”è¯„æµ‹èƒ½åŠ›</li>
<li>HDR è¯„æµ‹ä½“ç³»</li>
<li>8Kï¼Œ120å¸§ çš„é«˜åˆ†è¾¨ç‡ã€é«˜å¸§ç‡è¯„æµ‹ä½“ç³»</li>
<li>ç¾é¢œã€ç¾å¦†ç­‰è¯„æµ‹ä½“ç³»</li>
<li>â€¦â€¦</li>
</ul>
<p>æ‰€æœ‰çš„åŠªåŠ›ï¼Œåªä¸ºè®©çµé•œæ›´ç½®ä¿¡ã€æ›´ä¸“ä¸šã€æ›´é«˜æ•ˆï¼Œåªä¸ºè®©çµé•œæˆä¸ºè§†é¢‘è¯„æµ‹çš„é¦–é€‰å·¥å…·ã€‚ä¸ºä½ ï¼Œåƒåƒä¸‡ä¸‡éã€‚</p>
<h3 id="çµé•œ-çµé•œ-å¿«å‘Šè¯‰æˆ‘-å“ªä¸ªæ˜¯ç”»è´¨æœ€å¥½çš„è§†é¢‘ï¼Ÿ"><code>çµé•œï¼Œçµé•œï¼Œå¿«å‘Šè¯‰æˆ‘ï¼Œå“ªä¸ªæ˜¯ç”»è´¨æœ€å¥½çš„è§†é¢‘ï¼Ÿ</code></h3>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p><a href="https://wangwei1237.github.io/digital_video_concepts/docs/1_1_TheKeyConcepts.html">https://wangwei1237.github.io/digital_video_concepts/docs/1_1_TheKeyConcepts.html</a>. <a href="#fnref1" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn2" class="footnote-item"><p><a href="https://wangwei1237.github.io/digital_video_concepts/docs/2_2_0_TheHumanVisualSystem.html">https://wangwei1237.github.io/digital_video_concepts/docs/2_2_0_TheHumanVisualSystem.html</a>. <a href="#fnref2" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn3" class="footnote-item"><p><a href="https://wangwei1237.github.io/2020/02/28/Introduction-to-digital-video-technology/">https://wangwei1237.github.io/2020/02/28/Introduction-to-digital-video-technology/</a>. <a href="#fnref3" class="footnote-backref">â†©ï¸</a> <a href="#fnref3:1" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn4" class="footnote-item"><p><a href="https://wangwei1237.github.io/shares/hdr-field-guide-final-web.pdf">https://wangwei1237.github.io/shares/hdr-field-guide-final-web.pdf</a>. <a href="#fnref4" class="footnote-backref">â†©ï¸</a> <a href="#fnref4:1" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn5" class="footnote-item"><p><a href="https://filmora.wondershare.com/video-editing-tips/what-is-video-bitrate.html">https://filmora.wondershare.com/video-editing-tips/what-is-video-bitrate.html</a>. <a href="#fnref5" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn6" class="footnote-item"><p><a href="https://www.techhive.com/article/578376/8k-vs-4k-tvs-most-consumers-cannot-tell-the-difference.html">https://www.techhive.com/article/578376/8k-vs-4k-tvs-most-consumers-cannot-tell-the-difference.html</a>. <a href="#fnref6" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn7" class="footnote-item"><p><a href="https://wangwei1237.github.io/2021/07/27/The-History-of-the-Video-Codec-Improvement/">https://wangwei1237.github.io/2021/07/27/The-History-of-the-Video-Codec-Improvement/</a>. <a href="#fnref7" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn8" class="footnote-item"><p><a href="https://wangwei1237.github.io/2021/01/26/HDR-introduction/">https://wangwei1237.github.io/2021/01/26/HDR-introduction/</a>. <a href="#fnref8" class="footnote-backref">â†©ï¸</a></p>
</li>
</ol>
</section>
]]></content>
      <categories>
        <category>IVQA</category>
      </categories>
      <tags>
        <tag>è§†é¢‘è¯„æµ‹</tag>
        <tag>ç”»è´¨è¯„æµ‹</tag>
      </tags>
  </entry>
  <entry>
    <title>è§†é¢‘ç¼–ç ä¸­çš„ç ç‡æ§åˆ¶æ¨¡å¼</title>
    <url>/2022/03/11/Understanding-Rate-Control-Modes/</url>
    <content><![CDATA[<p><img src="/2022/03/11/Understanding-Rate-Control-Modes/1.png" alt></p>
<p>æ•°å­—è§†é¢‘åœ¨å¤„ç†ã€å­˜å‚¨å’Œä¼ è¾“ä¸Šéœ€è¦å¤§é‡æ•°æ®ï¼Œå…¸å‹çš„ 30FPS çš„é«˜æ¸…è§†é¢‘ï¼ˆ1920x1080ï¼‰ï¼Œå¦‚æœæ¯ä¸ªåƒç´ éœ€è¦ 8bit æ¥è¡¨ç¤ºçš„è¯ï¼Œé‚£ä¹ˆæ¯ç§’éœ€è¦å¤§çº¦ 15äº¿ bitã€‚è€Œè§†é¢‘ç¼–ç æŠ€æœ¯çš„ç›®æ ‡å°±æ˜¯è·å–ç ç‡å’Œè§†è§‰è´¨é‡ä¹‹é—´çš„æƒè¡¡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1920 x 1080 x 8 x 3 x 30 &#x3D; 1,492,992,000</span><br></pre></td></tr></table></figure>
<p>åœ¨è§†é¢‘ç¼–ç æŠ€æœ¯ä¸­ï¼Œç ç‡æ§åˆ¶ï¼ˆRate Controlï¼‰æ˜¯ä¸€ä»¶éå¸¸é‡è¦çš„äº‹æƒ…ã€‚åœ¨ç¼–ç è§†é¢‘å¸§æ—¶ï¼Œç ç‡æ§åˆ¶å†³å®šäº†ç¼–ç å™¨ä¸ºè¯¥è§†é¢‘å¸§åˆ†é…çš„ bit æ•°ã€‚</p>
<p>æœ¬æ–‡å°†åŸºäº FFmpeg ä¸­çš„ X264ã€X265 ç¼–ç å™¨æ¥ä»‹ç»å¸¸ç”¨çš„ç ç‡æ§åˆ¶æ¨¡å¼ã€‚</p>
<span id="more"></span>
<h2 id="cqp-constant-quantization-parameter">CQP(Constant Quantization Parameter)</h2>
<p><a href="https://www.vcodex.com/h264avc-4x4-transform-and-quantization/"><strong>QP(Quantization Parameter)</strong></a> ç”¨äºæ§åˆ¶æ¯å¸§è§†é¢‘ä¸­æ¯ä¸€ä¸ªå®å—çš„å‹ç¼©é‡ã€‚å®é™…ä¸Šï¼ŒQP åæ˜ äº†ç©ºé—´ç»†èŠ‚å‹ç¼©æƒ…å†µã€‚QP è¶Šå°ï¼Œå°±ä¼šä¿ç•™è¶Šå¤šçš„ç»†èŠ‚ä¿¡æ¯ï¼Œè§†é¢‘è´¨é‡ä¹Ÿä¼šè¶Šé«˜ï¼ŒåŒæ—¶ç ç‡è¶Šå¤§ã€‚QP è¶Šå¤§ï¼Œç»†èŠ‚ä¿¡æ¯ä¸¢å¤±çš„è¶Šå¤šï¼Œç ç‡ä¹Ÿä¼šéšä¹‹é™ä½ï¼Œä½†å›¾åƒå¤±çœŸä¹Ÿä¼šè¶Šä¸¥é‡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒQP å’Œç ç‡æˆåæ¯”ï¼ŒQP è¶Šå¤§ï¼Œç ç‡è¶Šä½ï¼›QP è¶Šå°ï¼Œç ç‡è¶Šé«˜ã€‚</p>
<p>åœ¨ H.264/H.265 ä¸­ï¼ŒQP çš„å–å€¼èŒƒå›´ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>51</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0, 51]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">5</span><span class="mord">1</span><span class="mclose">]</span></span></span></span>ã€‚åˆ©ç”¨ FFmpegï¼Œæˆ‘ä»¬å¯ä»¥éå¸¸æ–¹ä¾¿çš„ä¸ºæ•´ä¸ªç¼–ç ï¼ˆè½¬ç ï¼‰è¿‡ç¨‹è®¾ç½®ä¸€ä¸ªå›ºå®šçš„ QPã€‚</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ffmpeg -i &lt;input&gt; -c:v libx264 -qp 23 &lt;output&gt;</span><br><span class="line">ffmpeg -i &lt;input&gt; -c:v libx265 -x265-params qp=23 &lt;output&gt;</span><br></pre></td></tr></table></figure>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition attention"><p class="admonition-title">è°¨æ…ä½¿ç”¨ CQP
</p><p>é™¤éæˆ‘ä»¬çŸ¥é“è‡ªå·±åœ¨åšä»€ä¹ˆï¼Œå¦åˆ™æ°¸è¿œä¸è¦ä½¿ç”¨ CQP æ¥è¿›è¡Œç ç‡æ§åˆ¶ã€‚ä¸ºæ•´ä¸ªç¼–ç è¿‡ç¨‹è®¾ç½®ä¸€ä¸ªå›ºå®šçš„ QP æ„å‘³ç€ï¼šæœ€ç»ˆçš„è§†é¢‘ç ç‡ä¼šå› ä¸ºåœºæ™¯çš„å¤æ‚æ€§è€Œå‘ç”Ÿå·¨å¤§å˜åŒ–ã€‚å¦‚æœè®¾ç½®çš„ QP è¶³å¤Ÿä½ï¼Œé‚£ä¹ˆç¼–ç çš„è§†é¢‘è´¨é‡ä¼šéå¸¸å¥½ï¼Œä½†ä¸ CRF ç›¸æ¯”ï¼Œè¿™æ— ç–‘ä¼šäº§ç”Ÿç ç‡çš„æµªè´¹ã€‚</p>
<p>CQP æ¯”è¾ƒé€‚åˆç”¨äºè§†é¢‘ç¼–ç å™¨çš„ç ”ç©¶ï¼Œæ¯”å¦‚åœ¨ RD æ›²çº¿ä¸­ï¼Œæˆ‘ä»¬ä¼šé‡‡ç”¨ä¸åŒçš„ QP æ¥äº§ç”Ÿå¯¹åº”çš„ç¼–ç è§†é¢‘ï¼Œè¿›è€Œå¯¹ç¼–ç å™¨è¿›è¡Œå¯¹æ¯”ã€‚</p>
</div>
<h4 id="qp-ä¸-ç‡å¤±çœŸæ›²çº¿">QP ä¸ ç‡å¤±çœŸæ›²çº¿</h4>
<p>åœ¨è¯„ä¼°ä¸åŒç¼–ç å™¨æ—¶ï¼Œæˆ‘ä»¬ä¼šç”¨åˆ°ç‡å¤±çœŸï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>D</mi></mrow><annotation encoding="application/x-tex">RD</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span></span></span></span>ï¼‰æ›²çº¿ã€‚ä¸€èˆ¬è€Œè¨€ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>D</mi></mrow><annotation encoding="application/x-tex">RD</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span></span></span></span> æ›²çº¿éƒ½æ˜¯ä»¥ç ç‡(<em>Kbps</em>)åšä¸ºæ¨ªåæ ‡ï¼Œä»¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>S</mi><mi>N</mi><mi>R</mi><mo stretchy="false">(</mo><mi>d</mi><mi>B</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">PSNR(dB)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mclose">)</span></span></span></span> ä½œä¸ºçºµåæ ‡åšå‡ºæ¥ä¸€æ¡æ›²çº¿ã€‚å¯¹äº <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>D</mi></mrow><annotation encoding="application/x-tex">RD</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span></span></span></span> æ›²çº¿ä¸Šçš„ç‚¹ï¼Œæˆ‘ä»¬ä¸€èˆ¬é‡‡ç”¨çš„æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mi>P</mi><mo>=</mo><mn>28</mn><mo separator="true">,</mo><mn>32</mn><mo separator="true">,</mo><mn>36</mn><mo separator="true">,</mo><mn>40</mn></mrow><annotation encoding="application/x-tex">QP=28, 32, 36, 40</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">Q</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">2</span><span class="mord">8</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">3</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">3</span><span class="mord">6</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">4</span><span class="mord">0</span></span></span></span> è¿™å››ä¸ª QP ä¸‹çš„ç¼–ç ç ç‡å’Œç¼–ç è´¨é‡ã€‚</p>
<h2 id="abr-average-bitrate">ABR(Average Bitrate)</h2>
<p>ABR åˆç§°ä¸ºç›®æ ‡ç ç‡ï¼ˆtarget bitrateï¼‰ã€‚ABR ä¼šä¸ºç¼–ç å™¨è®¾ç½®ä¸€ä¸ªç›®æ ‡ç ç‡ï¼Œç„¶åè®©ç¼–ç å™¨æ¥è®¡ç®—å¦‚ä½•æ‰èƒ½è¾¾åˆ°æˆ‘ä»¬è®¾å®šçš„ç›®æ ‡ç ç‡ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å¦‚ä¸‹çš„å‘½ä»¤å°†ç›®æ ‡ç ç‡è®¾å®šä¸º 1Mbsã€‚</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ffmpeg -i &lt;input&gt; -c:v libx264 -b:v 1M &lt;output&gt;</span><br><span class="line">ffmpeg -i &lt;input&gt; -c:v libx265 -b:v 1M &lt;output&gt;</span><br></pre></td></tr></table></figure>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition attention"><p class="admonition-title">é¿å…ä½¿ç”¨ ABR
</p><p>ä¸€ä½ x264 çš„ä¸»è¦å¼€å‘äººå‘˜è¯´ï¼šæ°¸è¿œä¸è¦ä½¿ç”¨ ABR æ¥æ§åˆ¶è§†é¢‘çš„ç ç‡ã€‚ä¸ºä»€ä¹ˆè¿™ä¹ˆè¯´å‘¢ï¼Ÿè¿™ä¸»è¦æ˜¯å› ä¸ºï¼Œç¼–ç å™¨æ— æ³•ç¡®åˆ‡çš„çŸ¥é“æ¥ä¸‹æ¥éœ€è¦ç¼–ç çš„è§†é¢‘å¸§çš„æƒ…å†µï¼Œå› æ­¤ç¼–ç å™¨ä¸å¾—ä¸é€šè¿‡çŒœæµ‹æ¥ç¡®å®šå¦‚ä½•æ‰èƒ½è¾¾åˆ°æˆ‘ä»¬è®¾å®šçš„ç›®æ ‡ç ç‡ã€‚è¿™ä¹Ÿæ„å‘³ç€ï¼ŒABR åœ¨æ§åˆ¶ç ç‡æ—¶ï¼Œç ç‡çš„æ³¢åŠ¨èŒƒå›´ç›¸å¯¹è¾ƒå¤§ï¼Œå°¤å…¶æ˜¯åœ¨è§†é¢‘çš„å¼€å¤´æˆ–è€…è¾¾åˆ°ç›®æ ‡ç ç‡çš„åœ°æ–¹ã€‚å°¤å…¶æ˜¯å¯¹äº HAS(HTTP Adaptive Streaming) æµåª’ä½“è€Œè¨€ï¼ŒABR ä¼šå¯¼è‡´åˆ†ç‰‡å†…çš„è§†é¢‘è´¨é‡äº§ç”Ÿè¾ƒå¤§çš„å˜åŒ–ã€‚</p>
</div>
<p>ABR å¹¶ä¸æ˜¯ä¸€ç§å›ºå®šç ç‡æ§åˆ¶æ¨¡å¼ã€‚å°½ç®¡ ABR ä¹Ÿæ˜¯ä¸€ç§ VBR æ¨¡å¼ï¼Œä½†æ˜¯ å› ä¸º ABR å¹¶æ— æ³•å¯é çš„æä¾›è‰¯å¥½çš„ç¼–ç è´¨é‡ï¼Œå› æ­¤ï¼ŒABR ä¹Ÿå¹¶ä¸æ¯” CBR å¥½å¤šå°‘ã€‚</p>
<h2 id="cbr-constant-bitrate">CBR(Constant Bitrate)</h2>
<p>å¦‚æœæˆ‘ä»¬éœ€è¦å¼ºåˆ¶ç¼–ç å™¨æ€»æ˜¯ä½¿ç”¨æŸä¸ªå›ºå®šçš„ç ç‡æ¥ç¼–ç è§†é¢‘ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ CBRã€‚å¯¹äº x264ï¼Œå¯ä»¥é€šè¿‡ nal-hrd æ¥è®¾ç½® CBR å’Œ VBR æ¨¡å¼ã€‚</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ffmpeg -i &lt;input&gt; -c:v libx264 -x264-params &quot;nal-hrd=cbr:force-cfr=1&quot; \</span><br><span class="line">-b:v 1M -minrate 1M -maxrate 1M -bufsize 2M &lt;output&gt;</span><br></pre></td></tr></table></figure>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition note"><p class="admonition-title">nal-hrd
</p><p><a href="http://www.chaneru.com/Roku/HLS/X264_Settings.htm#nal-hrd">nal-hrd</a></p>
<p>Default: None</p>
<p>Signal HRD information. Required for Blu-ray streams, television broadcast and a few other specialist areas. Acceptable values are:</p>
<ul>
<li>none: Specify no HRD information</li>
<li>vbr: Specify HRD information</li>
<li>cbr: Specify HRD information and pack the bitstream to the bitrate specified by bitrate. Requires bitrate mode ratecontrol.</li>
</ul>
<p>Recommendation: none, unless you need to signal this information.</p>
</div>
<h2 id="crf-constant-rate-factor">CRF(Constant Rate Factor)</h2>
<p>CRF æ˜¯ x264 å’Œ x265 ç¼–ç å™¨çš„é»˜è®¤è´¨é‡/ç ç‡æ§åˆ¶è®¾ç½®ã€‚CRF çš„å–å€¼èŒƒå›´ä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>51</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0,51]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">5</span><span class="mord">1</span><span class="mclose">]</span></span></span></span>ï¼Œæ•°å€¼è¶Šä½ï¼Œè´¨é‡è¶Šå¥½ï¼Œæ–‡ä»¶è¶Šå¤§ã€‚å¯¹äºä¸åŒçš„ç¼–ç å™¨ï¼ŒCRFçš„é»˜è®¤å€¼å¦‚ä¸‹ï¼š</p>
<ul>
<li>x264ï¼š23</li>
<li>x265ï¼š28</li>
</ul>
<p>å½“CRF å–å€¼ä¸º 18(x264)ã€24(x265) æ—¶ï¼Œå…¶ç¼–ç è´¨é‡åœ¨è§†è§‰ä¸Šè¢«è®¤ä¸ºæ˜¯æ— æ„ŸçŸ¥çš„ï¼Œæ›´å°çš„å–å€¼å¾€å¾€æ„å‘³ç€ç ç‡çš„æµªè´¹ã€‚</p>
<p>CRF çš„å€¼æ¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>Â±</mo><mn>6</mn></mrow><annotation encoding="application/x-tex">\pm 6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">Â±</span><span class="mord">6</span></span></span></span>ï¼Œå¯¹åº”çš„ç¼–ç æ–‡ä»¶çš„å¤§å°å°±ä¼šå¢åŠ 1å€æˆ–å‡åŠã€‚</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ffmpeg -i &lt;input&gt; -c:v libx264 -crf 23 &lt;output&gt;</span><br><span class="line">ffmpeg -i &lt;input&gt; -c:v libx265 -crf 28 &lt;output&gt;</span><br></pre></td></tr></table></figure>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition note"><p class="admonition-title">CRF & 2-Pass
</p><p>å…·æœ‰ç›¸åŒç ç‡çš„ 2-Pass å’Œ CRF ç¼–ç åœ¨è´¨é‡ä¸Šåº”è¯¥ç›¸åŒã€‚äºŒè€…çš„ä¸»è¦åŒºåˆ«åœ¨äºï¼š</p>
<ul>
<li>ä½¿ç”¨ 2-Pass ç¼–ç æ—¶ï¼Œå¯ä»¥æ§åˆ¶æ–‡ä»¶å¤§å°</li>
<li>ä½¿ç”¨ CRF æ—¶ï¼Œåªéœ€æŒ‡å®šæ‰€éœ€çš„è§†é¢‘è´¨é‡</li>
</ul>
</div>
<h2 id="2-pass-abr-2-pass-average-bitrate">2-Pass ABR(2-Pass Average Bitrate)</h2>
<p>å½“é‡‡ç”¨ 2-Pass ç¼–ç çš„æ—¶å€™ï¼Œå¯¹äºè§†é¢‘æµä¸­çš„æ‰€æœ‰æ•°æ®ï¼Œç¼–ç å™¨ä¼šå¯¹å…¶å¤„ç†ä¸¤æ¬¡ã€‚åœ¨ç¬¬ä¸€éå¤„ç†çš„æ—¶å€™ï¼Œç¼–ç å™¨ä¼šæ”¶é›†è§†é¢‘çš„ç›¸å…³ä¿¡æ¯ï¼Œåœ¨ç¬¬äºŒæ¬¡å¤„ç†æ—¶ï¼Œç¼–ç å™¨åˆ©ç”¨ç¬¬ä¸€æ¬¡å¤„ç†æ”¶é›†åˆ°çš„ä¿¡æ¯æ¥ä¼˜åŒ–ç¼–ç è¿‡ç¨‹ã€‚</p>
<p>åœ¨ CBR æ¨¡å¼ä¸‹ï¼Œ2-Pass ç¼–ç æ¯” 1-Pass ç¼–ç çš„æ•ˆç‡æ›´é«˜ã€‚2-Pass ç¼–ç æ¯” 1-Pass ç¼–ç çš„è´¨é‡è¦é«˜ï¼Œä½†æ˜¯ç¼–ç æ—¶é—´ä¹Ÿä¼šéšä¹‹å¢åŠ ã€‚ä½¿ç”¨ 2-Pass ç¼–ç æ—¶ï¼Œå¯¹äºåœºæ™¯å˜åŒ–ä¸å¤§çš„ç”»é¢ï¼ˆå¦‚é™æ€ç”»é¢ï¼‰ï¼Œåˆ†é…çš„ç ç‡ä¼šä½ä¸€äº›ï¼›è€Œåœºæ™¯å˜åŒ–å¤§çš„ç”»é¢ï¼ˆå¦‚èµ›è½¦ã€è¿åŠ¨ç­‰ï¼‰ï¼Œåˆ†é…çš„ç ç‡ä¼šé«˜ä¸€äº›ã€‚å› æ­¤ï¼Œ 2-Pass ç¼–ç å¯ä»¥è®©æ•´éƒ¨å½±ç‰‡çš„æ¸…æ™°åº¦æ¯”è¾ƒå‡åŒ€ã€‚</p>
<p>x264 ç¼–ç å™¨çš„ 2-Pass ç¼–ç å‘½ä»¤å¦‚ä¸‹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ffmpeg -i &lt;input&gt; -c:v libx264 -b:v 1M -pass 1 -f null /dev/null</span><br><span class="line">ffmpeg -i &lt;input&gt; -c:v libx264 -b:v 1M -pass 2 &lt;output&gt;.mp4</span><br></pre></td></tr></table></figure>
<p>x265 ç¼–ç å™¨çš„ 2-Pass ç¼–ç å‘½ä»¤å¦‚ä¸‹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ffmpeg -i &lt;input&gt; -c:v libx265 -b:v 1M -x265-params pass=1 -f null /dev/null</span><br><span class="line">ffmpeg -i &lt;input&gt; -c:v libx265 -b:v 1M -x265-params pass=2 &lt;output&gt;.mp4</span><br></pre></td></tr></table></figure>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition error"><p class="admonition-title">ç›´æ’­åœºæ™¯
</p><p>2-Pass ç¼–ç ä¸å¯ç”¨äºç›´æ’­åœºæ™¯ã€‚</p>
</div>
<h2 id="å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</h2>
<ul>
<li><a href="https://slhck.info/video/2017/03/01/rate-control.html">Understanding Rate Control Modes (x264, x265, vpx)</a></li>
<li><a href="https://slhck.info/video/2017/02/24/crf-guide.html">CRF Guide (Constant Rate Factor in x264, x265 and libvpx)</a></li>
</ul>
]]></content>
      <categories>
        <category>è§†é¢‘æŠ€æœ¯</category>
      </categories>
      <tags>
        <tag>CQP</tag>
        <tag>CBR</tag>
        <tag>ABR</tag>
        <tag>CRF</tag>
      </tags>
  </entry>
  <entry>
    <title>äº§å“çš„ç”¨æˆ·ä½“éªŒæ¨¡å‹</title>
    <url>/2021/12/17/the-QoE-model-for-production/</url>
    <content><![CDATA[<p><img src="/2021/12/17/the-QoE-model-for-production/1.png" alt></p>
<p>æˆ‘ä»¬å¤©å¤©åœ¨è¯´â€œç”¨æˆ·ä½“éªŒâ€ï¼Œä½†æ˜¯ï¼Œç”¨æˆ·ä½“éªŒç©¶ç«Ÿæ˜¯ä¸ªå•¥å‘¢ï¼Ÿæ˜¯åŠŸèƒ½ï¼Œæ˜¯ä»·å€¼ï¼Œæ˜¯è®¤çŸ¥ï¼Œè¿˜æ˜¯æ„Ÿè§‰ï¼Ÿæ€ä¹ˆæ¥è¡¡é‡â€œç”¨æˆ·ä½“éªŒâ€å‘¢ï¼Ÿè™½ç„¶ï¼Œæœ‰å¾ˆå¤šä¸“ä¸šçš„ä¹¦ç±æ¥è§£é‡Šâ€œç”¨æˆ·ä½“éªŒâ€ï¼Œä½†æ˜¯æˆ‘è¿˜æ˜¯æƒ³ä»å¦å¤–ä¸€ä¸ªè§’åº¦æ¥é˜è¿°ä¸€ä¸‹è‡ªå·±å¯¹â€œç”¨æˆ·ä½“éªŒâ€è¿™ä¸€æ¦‚å¿µçš„ç†è§£ã€‚</p>
<span id="more"></span>
<h2 id="ä»€ä¹ˆæ˜¯ç”¨æˆ·ä½“éªŒ">ä»€ä¹ˆæ˜¯ç”¨æˆ·ä½“éªŒ</h2>
<p>ç™¾åº¦ç™¾ç§‘å¯¹äº <a href="https://baike.baidu.com/item/%E7%94%A8%E6%88%B7%E4%BD%93%E9%AA%8C/1994">ç”¨æˆ·ä½“éªŒ</a> çš„å®šä¹‰å¦‚ä¸‹ï¼š</p>
<blockquote>
<p>ç”¨æˆ·ä½“éªŒï¼ˆUser Experienceï¼Œç®€ç§°UE/UXï¼‰æ˜¯ç”¨æˆ·åœ¨ä½¿ç”¨äº§å“è¿‡ç¨‹ä¸­å»ºç«‹èµ·æ¥çš„ä¸€ç§çº¯ä¸»è§‚æ„Ÿå—ã€‚</p>
<p>ISO 9241-210 æ ‡å‡†å°†ç”¨æˆ·ä½“éªŒå®šä¹‰ä¸º: â€œäººä»¬å¯¹äºé’ˆå¯¹ä½¿ç”¨æˆ–æœŸæœ›ä½¿ç”¨çš„äº§å“ã€ç³»ç»Ÿæˆ–è€…æœåŠ¡çš„è®¤çŸ¥å°è±¡å’Œå›åº”â€ã€‚</p>
<p>é€šä¿—æ¥è®²å°±æ˜¯â€œè¿™ä¸ªä¸œè¥¿å¥½ä¸å¥½ç”¨ï¼Œç”¨èµ·æ¥æ–¹ä¸æ–¹ä¾¿â€ã€‚å› æ­¤ï¼Œç”¨æˆ·ä½“éªŒæ˜¯ä¸»è§‚çš„ï¼Œä¸”å…¶æ³¨é‡å®é™…åº”ç”¨æ—¶çš„äº§ç”Ÿçš„æ•ˆæœã€‚</p>
<p>ISO å®šä¹‰çš„è¡¥å……è¯´æ˜æœ‰ç€å¦‚ä¸‹è§£é‡Šï¼šç”¨æˆ·ä½“éªŒï¼Œå³ç”¨æˆ·åœ¨ä½¿ç”¨ä¸€ä¸ªäº§å“æˆ–ç³»ç»Ÿä¹‹å‰ã€ä½¿ç”¨æœŸé—´å’Œä½¿ç”¨ä¹‹åçš„å…¨éƒ¨æ„Ÿå—ï¼ŒåŒ…æ‹¬æƒ…æ„Ÿã€ä¿¡ä»°ã€å–œå¥½ã€è®¤çŸ¥å°è±¡ã€ç”Ÿç†å’Œå¿ƒç†ååº”ã€è¡Œä¸ºå’Œæˆå°±ç­‰å„ä¸ªæ–¹é¢ã€‚</p>
</blockquote>
<p>Luke Millerï¼ˆå¢å…‹Â·ç±³å‹’ï¼‰åœ¨å…¶è‘—ä½œã€Šç”¨æˆ·ä½“éªŒæ–¹æ³•è®ºã€‹ä¸­è®²é“ï¼š</p>
<div class="douban-card-block">
	<a class="douban-card" href="https://book.douban.com/subject/26753288">
		<div class="douban-card-bgimg" style="background-image: url('https://images.weserv.nl/?url=https://img9.doubanio.com/view/subject/s/public/s28539365.jpg');"></div>
		<div class="douban-card-left">
			<div class="douban-card-img" style="background-image: url('https://images.weserv.nl/?url=https://img9.doubanio.com/view/subject/s/public/s28539365.jpg');"></div>
		</div>
		<div class="douban-card-right" style="line-height: 1.7;">
			<div class="douban-card-item"><span>ä¹¦å: </span><strong>ç”¨æˆ·ä½“éªŒæ–¹æ³•è®º</strong></div>
			<div class="douban-card-item"><span>ä½œè€…: </span><span>[ç¾]å¢å…‹Â·ç±³å‹’</span></div>
			<div class="douban-card-item"><span>å‡ºç‰ˆå¹´ä»½: </span><span>2016-1-1</span></div>
			<div class="douban-card-item"><span>è¯„åˆ†: </span><span>5.9</span></div>
		</div>
	</a>
</div>
<style>
	.douban-card-block {
		display: flex;
		justify-content: center;
		align-items: center;
		width: 100%;
		max-height: 400px;
	}
	.douban-card {
		display: flex;
		margin: 30px 10px;
		padding: 15px;
		border-radius: 10px;
		position: relative;
		justify-content: center;
		align-items: center;
		overflow: hidden;
		color: antiquewhite;
		text-decoration: none;
	}
	.douban-card:hover {
		text-decoration: none;
	}
	.douban-card-bgimg {
		position: absolute;
		width: 115%;
		height: 115%;
		filter: blur(15px) brightness(0.6);
		background-size: 100%;
		background-position: center;
		background-repeat: no-repeat;
	}
	.douban-card-img {
		position: relative;
		height: 130px;
		width: 80px;
		background-size: 100%;
		background-position: center;
		background-repeat: no-repeat;
	}
	.douban-card-img {
		position: relative;
		height: 130px;
		width: 80px;
	}
	.douban-card-left {
		position: relative;
		display: flex;
		flex-direction: column;
		align-items: center;
	}
	.douban-card-right {
		position: relative;
		display: flex;
		flex-direction: column;
		margin-left: 12px;
		font-size: 16px;
		font-family: 'Courier New', Courier, monospace;
		line-height: 1.3;
		color: antiquewhite;
	}
	.douban-card-item {
		margin-top: 4px;
	}
</style>
<blockquote>
<p>ç”¨æˆ·ä½“éªŒçš„æ ¸å¿ƒä½¿å‘½æ˜¯è®©ç”¨æˆ·è·å¾—<strong>è¶…é¢„æœŸ</strong>çš„æ•°å­—ä½“éªŒï¼Œç”¨æˆ·ä¸ä»…èƒ½é€šè¿‡è¿™äº›ä½“éªŒå¢é•¿æ‰å¹²ï¼ŒåŒæ—¶ä¹Ÿä¼šä¹åœ¨å…¶ä¸­ã€‚</p>
<p>ç”¨æˆ·ä½“éªŒæ—¢æ˜¯ä¸€ä¸ªåè¯ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªåŠ¨è¯ï¼Œå®ƒæ—¢æ˜¯ä¸€ä¸ªäº§å“æ‰€å…·æœ‰çš„ç»ˆææˆæœä½“éªŒï¼Œåˆæ˜¯åˆ›é€ è¿™äº›ä½“éªŒçš„ä¸€å¥—æ–¹æ³•ã€‚è¿™äº›æ–¹æ³•åŒ…æ‹¬ç”¨æˆ·ç ”ç©¶æŠ€å·§ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>å¦‚ä½•è¿›è¡Œç”¨æˆ·è®¿è°ˆå’Œè°ƒç ”ï¼Ÿ</li>
<li>å¦‚ä½•åˆ›è®¾èƒ½ä»£è¡¨ç”¨æˆ·çš„å½¢è±¡äººç‰©ï¼Ÿ</li>
<li>å¦‚ä½•å¯¹ç«äº‰äº§å“ä¼˜åŠ¿è¿›è¡Œåˆ†æï¼Ÿ</li>
</ul>
</blockquote>
<p>Nir Eyalï¼ˆå°¼å°”Â·åŸƒäºšå°”ï¼‰å’ŒRyan Hooverï¼ˆç‘å®‰Â·èƒ¡ä½›ï¼‰çš„ã€Šä¸Šç˜¾ã€‹ä¸­æå‡ºçš„è®©ç”¨æˆ·å¯¹äº§å“ä¸Šç˜¾çš„ä¸Šç˜¾æ¨¡å‹ä¸­ï¼Œç¬¬ä¸€æ­¥å°±æ˜¯â€”â€”è§¦å‘ï¼Œè®©ç”¨æˆ·å–œæ¬¢ä¸Šäº§å“ã€‚è€Œè¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œå°±éœ€è¦åœ¨ç”¨æˆ·ä½¿ç”¨äº§å“æ—¶ï¼Œè¶…å‡ºç”¨æˆ·çš„ä½¿ç”¨é¢„æœŸï¼Œå¦åˆ™ï¼Œç”¨æˆ·æœ‰ä»€ä¹ˆåŠ¨åŠ›å¼€å§‹é‡‡å–â€œè¡ŒåŠ¨â€å‘¢ï¼Ÿ</p>
<div class="douban-card-block">
	<a class="douban-card" href="https://book.douban.com/subject/27030507">
		<div class="douban-card-bgimg" style="background-image: url('https://images.weserv.nl/?url=https://img3.doubanio.com/view/subject/s/public/s29436163.jpg');"></div>
		<div class="douban-card-left">
			<div class="douban-card-img" style="background-image: url('https://images.weserv.nl/?url=https://img3.doubanio.com/view/subject/s/public/s29436163.jpg');"></div>
		</div>
		<div class="douban-card-right" style="line-height: 1.7;">
			<div class="douban-card-item"><span>ä¹¦å: </span><strong>ä¸Šç˜¾</strong></div>
			<div class="douban-card-item"><span>ä½œè€…: </span><span>[ç¾]å°¼å°”Â·åŸƒäºšå°”</span></div>
			<div class="douban-card-item"><span>å‡ºç‰ˆå¹´ä»½: </span><span>2017-5</span></div>
			<div class="douban-card-item"><span>è¯„åˆ†: </span><span>7.4</span></div>
		</div>
	</a>
</div>
<style>
	.douban-card-block {
		display: flex;
		justify-content: center;
		align-items: center;
		width: 100%;
		max-height: 400px;
	}
	.douban-card {
		display: flex;
		margin: 30px 10px;
		padding: 15px;
		border-radius: 10px;
		position: relative;
		justify-content: center;
		align-items: center;
		overflow: hidden;
		color: antiquewhite;
		text-decoration: none;
	}
	.douban-card:hover {
		text-decoration: none;
	}
	.douban-card-bgimg {
		position: absolute;
		width: 115%;
		height: 115%;
		filter: blur(15px) brightness(0.6);
		background-size: 100%;
		background-position: center;
		background-repeat: no-repeat;
	}
	.douban-card-img {
		position: relative;
		height: 130px;
		width: 80px;
		background-size: 100%;
		background-position: center;
		background-repeat: no-repeat;
	}
	.douban-card-img {
		position: relative;
		height: 130px;
		width: 80px;
	}
	.douban-card-left {
		position: relative;
		display: flex;
		flex-direction: column;
		align-items: center;
	}
	.douban-card-right {
		position: relative;
		display: flex;
		flex-direction: column;
		margin-left: 12px;
		font-size: 16px;
		font-family: 'Courier New', Courier, monospace;
		line-height: 1.3;
		color: antiquewhite;
	}
	.douban-card-item {
		margin-top: 4px;
	}
</style>
<p>å› æ­¤ï¼Œç”¨æˆ·ä½“éªŒçš„æœ¬è´¨å°±æ˜¯ï¼šè®©ç”¨æˆ·è·å¾—è¶…å‡ºé¢„æœŸçš„äº§å“ä½“éªŒã€‚åªæœ‰è¶…å‡ºç”¨æˆ·é¢„æœŸçš„ä½“éªŒï¼Œæ‰è°ˆå¾—ä¸Šç”¨æˆ·ä½“éªŒã€‚</p>
<h2 id="ç”¨æˆ·ä½“éªŒæ¨¡å‹">ç”¨æˆ·ä½“éªŒæ¨¡å‹</h2>
<p>é€šè¿‡å¦‚ä¸Šçš„ä»‹ç»ï¼Œæˆ‘ä»¬å¯ä»¥å°†ç”¨æˆ·ä½“éªŒæ‹†åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼šäº§å“æä¾›çš„èƒ½åŠ›ï¼Œç”¨æˆ·çš„é¢„æœŸã€‚é‚£ä¹ˆç”¨æˆ·ä½“éªŒè´¨é‡ï¼ˆ<em>QoE</em>ï¼‰å°±å¯ä»¥ç”¨å¦‚ä¸‹çš„æ¨¡å‹æ¥è¡¨è¿°ï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mi>o</mi><mi>E</mi><mo>=</mo><mtext>äº§å“èƒ½åŠ›</mtext><mo>âˆ’</mo><mtext>ç”¨æˆ·é¢„æœŸ</mtext></mrow><annotation encoding="application/x-tex">QoE = \text{äº§å“èƒ½åŠ›} - \text{ç”¨æˆ·é¢„æœŸ}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">Q</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord text"><span class="mord cjk_fallback">äº§å“èƒ½åŠ›</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord text"><span class="mord cjk_fallback">ç”¨æˆ·é¢„æœŸ</span></span></span></span></span></span></p>
<p>åªæœ‰è¶…å‡ºç”¨æˆ·é¢„æœŸçš„äº§å“æ‰èƒ½è®©ç”¨æˆ·ä¸Šç˜¾ï¼Œå’Œç”¨æˆ·é¢„æœŸä¸€è‡´çš„äº§å“åªèƒ½æ˜¯åŸºæœ¬æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ï¼Œä½äºç”¨æˆ·é¢„æœŸçš„äº§å“åˆ™ä¼šè¢«ç”¨æˆ·æŠ›å¼ƒã€‚</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>Q</mi><mi>o</mi><mi>E</mi><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.3599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>ç”¨æˆ·ä¸Šç˜¾</mtext><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>ifÂ Â </mtext><mi>Q</mi><mi>o</mi><mi>E</mi><mtext>Â </mtext><mo>&gt;</mo><mi mathvariant="normal">Î”</mi><mo separator="true">;</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>åŸºæœ¬æ»¡è¶³</mtext><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>ifÂ Â </mtext><mi mathvariant="normal">âˆ£</mi><mtext>Â </mtext><mi>Q</mi><mi>o</mi><mi>E</mi><mtext>Â </mtext><mi mathvariant="normal">âˆ£</mi><mo>&lt;</mo><mi>Îµ</mi><mo separator="true">;</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>ç”¨æˆ·ç¦»å»</mtext><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>ifÂ Â Â </mtext><mi>Q</mi><mi>o</mi><mi>E</mi><mtext>Â </mtext><mo>&lt;</mo><mo>âˆ’</mo><mi mathvariant="normal">Î”</mi></mrow></mstyle></mtd></mtr></mtable></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>s</mi><mi mathvariant="normal">.</mi><mi>t</mi><mi mathvariant="normal">.</mi><mtext>Â Â </mtext><mn>0</mn><mo>&lt;</mo><mi>Îµ</mi><mo>â‰ª</mo><mi mathvariant="normal">Î”</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
&amp;QoE = \begin{cases}
\text{ç”¨æˆ·ä¸Šç˜¾}, &amp;\text{if } \ QoE\  &gt; \Delta;\\
\text{åŸºæœ¬æ»¡è¶³}, &amp;\text{if } \ |\ QoE\ | &lt; \varepsilon;\\
\text{ç”¨æˆ·ç¦»å»}, &amp;\text{if } \ \ QoE\  &lt;  -\Delta
\end{cases}\\
&amp;\\
&amp; s.t. \ \ 0 &lt; \varepsilon \ll \Delta
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:7.62em;vertical-align:-3.5599999999999996em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.0600000000000005em;"><span style="top:-6.0600000000000005em;"><span class="pstrut" style="height:4.41em;"></span><span class="mord"></span></span><span style="top:-3.0100000000000007em;"><span class="pstrut" style="height:4.41em;"></span><span class="mord"></span></span><span style="top:-1.5100000000000007em;"><span class="pstrut" style="height:4.41em;"></span><span class="mord"></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:3.5599999999999996em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.0600000000000005em;"><span style="top:-6.0600000000000005em;"><span class="pstrut" style="height:4.41em;"></span><span class="mord"><span class="mord"></span><span class="mord mathdefault">Q</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.35002em;"><span style="top:-2.19999em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>â©</span></span></span><span style="top:-2.19499em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>âª</span></span></span><span style="top:-2.20499em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>âª</span></span></span><span style="top:-3.15001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>â¨</span></span></span><span style="top:-4.2950099999999996em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>âª</span></span></span><span style="top:-4.30501em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>âª</span></span></span><span style="top:-4.60002em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>â§</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.8500199999999998em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.41em;"><span style="top:-4.41em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord cjk_fallback">ç”¨æˆ·ä¸Šç˜¾</span></span><span class="mpunct">,</span></span></span><span style="top:-2.97em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord cjk_fallback">åŸºæœ¬æ»¡è¶³</span></span><span class="mpunct">,</span></span></span><span style="top:-1.5300000000000002em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord cjk_fallback">ç”¨æˆ·ç¦»å»</span></span><span class="mpunct">,</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.9099999999999997em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.41em;"><span style="top:-4.41em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">ifÂ </span></span><span class="mspace">Â </span><span class="mord mathdefault">Q</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace">Â </span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">Î”</span><span class="mpunct">;</span></span></span><span style="top:-2.97em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">ifÂ </span></span><span class="mspace">Â </span><span class="mord">âˆ£</span><span class="mspace">Â </span><span class="mord mathdefault">Q</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mspace">Â </span><span class="mord">âˆ£</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault">Îµ</span><span class="mpunct">;</span></span></span><span style="top:-1.5300000000000002em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">ifÂ </span></span><span class="mspace">Â </span><span class="mspace">Â </span><span class="mord mathdefault">Q</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace">Â </span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">âˆ’</span><span class="mord">Î”</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.9099999999999997em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.0100000000000007em;"><span class="pstrut" style="height:4.41em;"></span><span class="mord"><span class="mord"></span></span></span><span style="top:-1.5100000000000007em;"><span class="pstrut" style="height:4.41em;"></span><span class="mord"><span class="mord"></span><span class="mord mathdefault">s</span><span class="mord">.</span><span class="mord mathdefault">t</span><span class="mord">.</span><span class="mspace">Â </span><span class="mspace">Â </span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault">Îµ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰ª</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">Î”</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:3.5599999999999996em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>å¦‚ä¸Šçš„æ¨¡å‹å¯ä»¥ç”¨ä¸‹å›¾æ¥è¡¨ç¤ºï¼š</p>
<p><img src="/2021/12/17/the-QoE-model-for-production/2.png" alt></p>
<h2 id="å¿…é¡»è®¤è¯†åˆ°ç”¨æˆ·é¢„æœŸçš„é‡è¦æ€§">å¿…é¡»è®¤è¯†åˆ°ç”¨æˆ·é¢„æœŸçš„é‡è¦æ€§</h2>
<h4 id="æ¸…æ™¨çš„å¥¶æ˜”">æ¸…æ™¨çš„å¥¶æ˜”</h4>
<p>åœ¨å…‹è±é¡¿Â·å…‹é‡Œæ–¯å¦æ£®çš„è‘—ä½œ<a href="https://book.douban.com/subject/30203403/">ã€Šä¸è¿æ°”ç«äº‰Â·å…³äºåˆ›æ–°ä¸ç”¨æˆ·é€‰æ‹©ã€‹</a>ä¸€ä¹¦ä¸­ï¼Œä»‹ç»äº†ä¸€ä¸ª<strong>å¥¶æ˜”çª˜å¢ƒ</strong>çš„æ¡ˆä¾‹ã€‚</p>
<!--![](3.jpeg)-->
<div class="douban-card-block">
	<a class="douban-card" href="https://book.douban.com/subject/30203403">
		<div class="douban-card-bgimg" style="background-image: url('https://images.weserv.nl/?url=https://img9.doubanio.com/view/subject/s/public/s29762696.jpg');"></div>
		<div class="douban-card-left">
			<div class="douban-card-img" style="background-image: url('https://images.weserv.nl/?url=https://img9.doubanio.com/view/subject/s/public/s29762696.jpg');"></div>
		</div>
		<div class="douban-card-right" style="line-height: 1.7;">
			<div class="douban-card-item"><span>ä¹¦å: </span><strong>ä¸è¿æ°”ç«äº‰</strong></div>
			<div class="douban-card-item"><span>ä½œè€…: </span><span>[ç¾]å…‹è±é¡¿Â·å…‹é‡Œæ–¯å¦æ£®</span></div>
			<div class="douban-card-item"><span>å‡ºç‰ˆå¹´ä»½: </span><span>2018-5-20</span></div>
			<div class="douban-card-item"><span>è¯„åˆ†: </span><span>7.9</span></div>
		</div>
	</a>
</div>
<style>
	.douban-card-block {
		display: flex;
		justify-content: center;
		align-items: center;
		width: 100%;
		max-height: 400px;
	}
	.douban-card {
		display: flex;
		margin: 30px 10px;
		padding: 15px;
		border-radius: 10px;
		position: relative;
		justify-content: center;
		align-items: center;
		overflow: hidden;
		color: antiquewhite;
		text-decoration: none;
	}
	.douban-card:hover {
		text-decoration: none;
	}
	.douban-card-bgimg {
		position: absolute;
		width: 115%;
		height: 115%;
		filter: blur(15px) brightness(0.6);
		background-size: 100%;
		background-position: center;
		background-repeat: no-repeat;
	}
	.douban-card-img {
		position: relative;
		height: 130px;
		width: 80px;
		background-size: 100%;
		background-position: center;
		background-repeat: no-repeat;
	}
	.douban-card-img {
		position: relative;
		height: 130px;
		width: 80px;
	}
	.douban-card-left {
		position: relative;
		display: flex;
		flex-direction: column;
		align-items: center;
	}
	.douban-card-right {
		position: relative;
		display: flex;
		flex-direction: column;
		margin-left: 12px;
		font-size: 16px;
		font-family: 'Courier New', Courier, monospace;
		line-height: 1.3;
		color: antiquewhite;
	}
	.douban-card-item {
		margin-top: 4px;
	}
</style>
<p>ä¸€å®¶è´©å–å¥¶æ˜”çš„è¿é”å…¬å¸èŠ±äº†æ•°æœˆçš„æ—¶é—´æ¥ç ”ç©¶ï¼šå¦‚ä½•è´©å–æ›´å¤šçš„å¥¶æ˜”ï¼Ÿä»–ä»¬æŠŠç¬¦åˆå¥¶æ˜”æ¶ˆè´¹è€…ç‰¹å¾çš„å…¸å‹é¡¾å®¢è¯·æ¥ï¼Œå¹¶åšæ·±å…¥çš„é—®é¢˜è°ƒç ”ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>ä»ä¸€ä¸ªæ¶ˆè´¹è€…çš„è§’åº¦çœ‹ï¼Œæˆ‘ä»¬å¦‚ä½•æ”¹è¿›æ‰èƒ½ä¿ƒä½¿å¤§å®¶è´­ä¹°æ›´å¤šçš„å¥¶æ˜”ï¼Ÿ</li>
<li>ä½ å¸Œæœ›å¥¶æ˜”çš„ä»·æ ¼æ›´ä½ä¸€ç‚¹å—ï¼Ÿæˆ–è€…æ›´æœ‰åš¼åŠ²ä¸€ç‚¹ï¼Ÿæˆ–è€…å£å‘³å†é‡ä¸€ç‚¹ï¼Ÿ</li>
<li>â€¦â€¦</li>
</ul>
<p>è¿™å®¶å¥¶æ˜”åº—æ ¹æ®æ¶ˆè´¹è€…çš„åé¦ˆåšäº†è®¸å¤šåˆ›æ–°ï¼Œå¹¶ä¸”ä¸ºäº†æ»¡è¶³ç”¨æˆ·æå‡ºçš„éœ€æ±‚ï¼Œä»–ä»¬ä¹Ÿè¿›è¡Œäº†å¾ˆå¤šåˆ›æ–°ã€‚ç„¶è€Œï¼Œæ•°æœˆä¹‹åï¼Œä»–ä»¬å‘ç°ï¼š<strong>ä»€ä¹ˆéƒ½æ²¡æœ‰å‘ç”Ÿï¼Œé”€é‡ä¾æ—§å¦‚å‰</strong>ã€‚</p>
<p>ç„¶åï¼Œè¿™å®¶å¥¶æ˜”åº—çš„è¥é”€å›¢é˜Ÿé€‰äº†ä¸€å¤©ï¼Œåœ¨é¤å…é‡Œç«™äº† 18 ä¸ªå°æ—¶æ¥è§‚å¯Ÿä»–ä»¬çš„é¡¾å®¢ï¼Œè§‚å¯Ÿé¡¾å®¢ï¼š</p>
<ul>
<li>åœ¨ä»€ä¹ˆæ—¶é—´è´­ä¹°å¥¶æ˜”ï¼Ÿ</li>
<li>ç©¿ä»€ä¹ˆé¢œè‰²çš„è¡£æœï¼Ÿ</li>
<li>æ˜¯å¦ç‹¬è‡ªè´­ä¹°ï¼Ÿ</li>
<li>é™¤äº†å¥¶æ˜”å¤–ä»–ä»¬æ˜¯å¦æœ‰è´­ä¹°å…¶ä»–çš„é£Ÿå“ï¼Ÿ</li>
<li>ä»–ä»¬æ˜¯å¦‚ä½•å–å®Œè´­ä¹°çš„å¥¶æ˜”çš„ï¼Ÿåœ¨é¤å…å–å®Œï¼Ÿè¿˜æ˜¯è¾¹èµ°è¾¹å–ï¼Ÿè¿˜æ˜¯å¼€è½¦å¸¦èµ°ï¼Ÿ</li>
</ul>
<p>æœ€ç»ˆï¼Œä»–ä»¬å‘ç°å¥¶æ˜”çš„å”®å‡ºæ—¶é—´é›†ä¸­åœ¨ä¸¤ä¸ªæ—¶é—´æ®µï¼šä¸Šåˆ 9 ç‚¹ä¹‹å‰ï¼Œæ™šä¸Šä¸‹ç­ä¹‹åã€‚</p>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition note"><p class="admonition-title">ä¸Šåˆ9ç‚¹ä¹‹å‰
</p><p>å¯¹äºä¸Šåˆ 9 ç‚¹ä¹‹å‰å–å‡ºçš„å¥¶æ˜”ï¼Œè¥é”€å›¢é˜Ÿç»è¿‡åˆ†æå‘ç°è¿™ä¸ªæ—¶é—´æ®µçš„æ¶ˆè´¹è€…å¾€å¾€æ˜¯ç‹¬è‡ªä¸€äººï¼Œåªä¹°ä¸€æ¯å¥¶æ˜”ï¼Œç„¶åæŠŠå¥¶æ˜”å¸¦åˆ°è½¦é‡Œï¼Œå¼€è½¦å¸¦èµ°ã€‚ç»è¿‡è¥é”€äººå‘˜çš„æ·±å…¥åˆ†æä¸æ•´åˆï¼Œä»–ä»¬å‘ç°ï¼šè¿™ä¸€æ‰¹æ¶ˆè´¹è€…ä¹‹é—´çš„å…±åŒç‚¹å’Œä»–ä»¬çš„ä¸ªäººçŠ¶æ€æ²¡æœ‰ä»€ä¹ˆå¿…ç„¶çš„å…³ç³»ï¼Œä»–ä»¬çš„å…±åŒç‚¹åœ¨äºä»–ä»¬éœ€è¦åœ¨å¼€è½¦ä¸Šç­çš„æ¼«é•¿è·¯é€”ä¸­å¢ç‚¹ä¹è¶£ï¼Œä»–ä»¬ç»è¿‡æ¼«é•¿çš„é€‰æ‹©ï¼Œæœ€ç»ˆå‘ç°å¥¶æ˜”æ˜¯å®Œæˆè¿™é¡¹ä»»åŠ¡çš„ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚</p>
</div>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition note"><p class="admonition-title">æ™šä¸Šä¸‹ç­ä¹‹å
</p><p>å¯¹äºæ™šä¸Šä¸‹ç­ä¹‹åçš„æ¶ˆè´¹è€…æƒ…å†µå®Œå…¨ä¸åŒã€‚ç»è¿‡ä¸€å‘¨çš„æ—¶é—´ï¼Œçˆ¶æ¯ä¼šåœ¨å¾ˆå¤šäº‹æƒ…ä¸Šå¯¹å­©å­è¯´â€œä¸â€ï¼Œä½œä¸ºçˆ¶æ¯ï¼Œä¹Ÿå¸Œæœ›èƒ½æ‰¾ä¸€ä¸ªæœºä¼šå¢è¿›ä¸€ä¸‹å’Œå­©å­ä¹‹é—´çš„æ„Ÿæƒ…ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå½“çˆ¶æ¯å’Œå­©å­åœ¨æ’é˜Ÿç‚¹é¤çš„æ—¶å€™ï¼Œå­©å­çªç„¶é—®èƒ½ä¸èƒ½æ¥ä¸€æ¯å¥¶æ˜”çš„æ—¶å€™ï¼Œä¸å­©å­å¢è¿›æ„Ÿæƒ…çš„æ—¶æœºå°±åˆ°äº†ã€‚</p>
</div>
<h4 id="ç”¨æˆ·é¢„æœŸçš„é‡è¦æ€§">ç”¨æˆ·é¢„æœŸçš„é‡è¦æ€§</h4>
<p>å› æ­¤ï¼Œé€šè¿‡è¿™ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬éœ€è¦æ¸…é†’çš„è®¤è¯†åˆ°ï¼Œæ— è®ºä½•æ—¶ï¼Œåœ¨ç”¨æˆ·æ‰“å¼€æ‰‹æœºï¼Œé€‰æ‹©ç‚¹å¼€æŸä¸ª APP çš„æ—¶å€™ï¼Œè‚¯å®šæ˜¯ä¼šå­˜åœ¨æŸç§é¢„æœŸçš„ã€‚å¦‚æœå¿½ç•¥æˆ–è€…ä¸æ¸…æ¥šè¿™èƒŒåçš„é¢„æœŸï¼Œå³ä¾¿æˆ‘ä»¬éå¸¸è®¤çœŸçš„è¿›è¡Œå„ç§ç”¨æˆ·è°ƒç ”å’Œé—®å·ï¼Œå¹¶ä¸”ä¹Ÿæ ¹æ®ç”¨æˆ·åé¦ˆè¿›è¡Œäº†å¾ˆå¤šçš„åˆ›æ–°ï¼Œç»“æœä¹Ÿä¼šåƒè¿™å®¶å¥¶æ˜”ç‚¹ä¸€æ ·ï¼š<strong>ä»€ä¹ˆéƒ½æ²¡æœ‰å‘ç”Ÿï¼Œé”€é‡ä¾æ—§å¦‚å‰</strong>ã€‚</p>
<p>å¦å¤–ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦æ€è€ƒï¼šç”¨æˆ·åé¦ˆã€ç”¨æˆ·é—®å·ã€ç”¨æˆ·è°ƒç ”ç­‰æ‰‹æ®µå¯ä»¥å‘ç°éšè—åœ¨ç”¨æˆ·èƒŒåçš„ç”¨æˆ·é¢„æœŸå—ï¼Ÿå¹¶ä¸”å¾ˆå¤šçš„æ—¶å€™ï¼Œæˆ‘ä»¬æ‰€è®¾è®¡çš„é—®å·å¾€å¾€å¸¦æœ‰ä¸€äº›å€¾å‘æ€§ï¼Œè¿™ä¼šå¯¼è‡´æˆ‘ä»¬æ²¡åŠæ³•ä»ç”¨æˆ·åé¦ˆä¸­å‘ç°ç”¨æˆ·çš„é¢„æœŸã€‚</p>
<p><img src="/2021/12/17/the-QoE-model-for-production/4.png" alt></p>
<h4 id="ç”¨æˆ·é¢„æœŸçš„ä¸€äººåƒé¢">ç”¨æˆ·é¢„æœŸçš„ä¸€äººåƒé¢</h4>
<p>æˆ‘ä»¬æ¥ç€çœ‹å¥¶æ˜”åº—çš„è¿™ä¸ªæ¡ˆä¾‹ï¼Œæˆ‘ä»¬ä¼šå‘ç°ï¼Œå¯¹ä¸åŒæ ·çš„æ¶ˆè´¹è€…ï¼ŒåŒæ ·çš„äº§å“ï¼Œåœ¨ä¸åŒçš„åœºæ™¯ä¸‹ï¼Œæ¶ˆè´¹è€…ä¼šæœ‰ä¸åŒçš„é¢„æœŸï¼š</p>
<ul>
<li>å¯¹äºä¸Šåˆ 9 ç‚¹çš„åœºæ™¯ï¼šå¸Œæœ›å¥¶æ˜”æ›´ç¨ ä¸€ç‚¹ï¼Œæ›´å¤§ä¸€ç‚¹ï¼Œå› ä¸ºå¸Œæœ›èŠ±æ›´å¤šçš„æ—¶é—´å–å®Œã€‚</li>
<li>å¯¹äºæ™šä¸Šä¸‹ç­ä¹‹åçš„åœºæ™¯ï¼šå¸Œæœ›å¥¶æ˜”æ›´å°ä¸€ç‚¹ï¼Œæ›´å¥åº·ä¸€ç‚¹ï¼Œä¸€æ¥å¯ä»¥æ›´å¿«åƒå®Œï¼ŒäºŒæ¥ä¸è‡³äºè®©çˆ¶æ¯å¤ªè¿‡è‡ªè´£ã€‚</li>
</ul>
<p>æˆ‘ä¾ç„¶æ˜¯æˆ‘ï¼Œè™½ç„¶æ—©ä¸Šä¸Šç­æ—¶å¾ˆé«˜å…´å¥¶æ˜”èƒ½å¤§ç‚¹ã€ç¨ ç‚¹ï¼Œä½†æ˜¯æ™šä¸Šè¿˜è¿™æ ·æˆ‘å°±å¾ˆç”Ÿæ°”äº†ã€‚ç”¨æˆ·çš„é¢„æœŸæ˜¯éšåœºæ™¯è€Œå‘ç”Ÿå˜åŒ–çš„ï¼Œå¿…é¡»åŠªåŠ›ææ¸…æ¥šç”¨æˆ·å¯¹äº§å“çš„ä½¿ç”¨æ¡ä»¶ï¼Œä»¥åŠåœ¨è¿™äº›ç‰¹å®šçš„æ¡ä»¶ä¸‹ç”¨æˆ·è¦è¾¾åˆ°çš„ç›®æ ‡ç©¶ç«Ÿæ˜¯ä»€ä¹ˆï¼Œåªæœ‰è¿™æ ·æ‰èƒ½æ‘¸æ¸…ç”¨æˆ·çš„é¢„æœŸï¼Œæ‰æœ‰å¯èƒ½åŸºäºç”¨æˆ·çš„é¢„æœŸæ¥è®¾è®¡äº§å“ï¼Œç»™ç”¨æˆ·å¸¦æ¥â€œå“‡å¡â€çš„ä½“éªŒã€‚</p>
<p>æˆ‘ç»å¸¸ä½¿ç”¨æ‰“è½¦è½¯ä»¶æ‰“è½¦ï¼Œæ¯å½“å¤©æ°”ä¸å¥½çš„æ—¶å€™ï¼Œæˆ‘æ€»æ˜¯éå¸¸æ‹…å¿ƒæ‰“ä¸åˆ°è½¦ï¼Œæ­¤æ—¶å¯¹äºæ‰“è½¦è½¯ä»¶è€Œè¨€ï¼Œèƒ½å¤Ÿå¸®åŠ©æˆ‘æ‰“ä¸Šè½¦å°±æ˜¯æˆ‘çš„é¢„æœŸã€‚è‡³äºç­‰å€™æ—¶é—´ï¼Œå¹¶æ²¡æœ‰å¤ªå¤§çš„é¢„æœŸäº†ï¼Œ20åˆ†é’Ÿå¯ä»¥ï¼Œ30åˆ†é’Ÿå¯ä»¥ï¼Œ40åˆ†é’Ÿä¹Ÿå¯ä»¥ï¼Œåªè¦æ˜¯èƒ½æ‰“ä¸Šè½¦å°±å¯ä»¥ã€‚ä½†æ˜¯ï¼Œå¦‚æœåœ¨å¤©æ°”éå¸¸å¥½çš„éç”¨è½¦é«˜å³°æ—¶æœŸï¼Œæˆ‘çš„é¢„æœŸå°±ä¼šå˜æˆå¿«é€Ÿå“åº”äº†ï¼Œå¦‚æœ5åˆ†é’Ÿè¿˜æ²¡æœ‰æ‰“ä¸Šè½¦ï¼Œæˆ‘å°±ä¼šè®¤ä¸ºè¿™ä¸ªæ‰“è½¦è½¯ä»¶ä¸å¥½ã€‚</p>
<h4 id="ç”¨æˆ·é¢„æœŸçš„åƒäººåƒé¢">ç”¨æˆ·é¢„æœŸçš„åƒäººåƒé¢</h4>
<p>â€œç‰©ä»¥ç±»èšï¼Œäººä»¥ç¾¤åˆ†â€ï¼Œäººç¾¤æœ‰ä¸åŒç‰¹ç‚¹ï¼Œè¿™äº›ä¸åŒçš„ç‰¹ç‚¹å¯¼è‡´ä¸åŒäººå¯¹åŒä¸€äº‹ç‰©çš„ç†è§£å¹¶ä¸ç›¸åŒï¼Œè¿›è€Œå¯¼è‡´å¯¹åŒä¸€äº‹ç‰©çš„é¢„æœŸä¹Ÿä¸ç›¸åŒã€‚â€œä¸€åƒä¸ªè§‚ä¼—çœ¼ä¸­æœ‰ä¸€åƒä¸ªå“ˆå§†é›·ç‰¹â€è¯´çš„ä¹Ÿæ˜¯è¿™ä¸ªé“ç†ï¼Œå› æ­¤ï¼Œå¯¹äºåŒä¸€äº§å“è€Œè¨€ï¼Œä¸åŒç”¨æˆ·çš„é¢„æœŸæ˜¯å„ä¸ç›¸åŒçš„ã€‚</p>
<p>å› æ­¤ï¼Œåœ¨æå‡ç”¨æˆ·ä½“éªŒçš„æ—¶å€™ï¼Œæˆ‘ä»¬å¿…é¡»è¦æ·±åˆ»çš„è®¤è¯†åˆ°è¿™ä¸€ç‚¹ï¼Œç„¶åå»äº†è§£ï¼š</p>
<ul>
<li>æˆ‘ä»¬çš„ç”¨æˆ·æ˜¯æ€æ ·çš„ç”¨æˆ·ï¼Ÿ</li>
<li>æˆ‘ä»¬çš„ç”¨æˆ·ä»–ä»¬çš„ä½¿ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆï¼Ÿ</li>
<li>æˆ‘ä»¬çš„ç”¨æˆ·æ˜¯æ€æ ·ç†è§£æˆ‘ä»¬çš„ï¼Ÿ</li>
<li>â€¦â€¦</li>
</ul>
<h2 id="è·å–ç”¨æˆ·é¢„æœŸçš„æ–¹æ³•æœ‰å“ªäº›">è·å–ç”¨æˆ·é¢„æœŸçš„æ–¹æ³•æœ‰å“ªäº›</h2>
<p>ç›®å‰ï¼Œå¯ä»¥è·å–åˆ°ç”¨æˆ·é¢„æœŸçš„åŸºæœ¬æ–¹æ³•æœ‰å¦‚ä¸‹çš„å‡ ç§ï¼š</p>
<ul>
<li>é—®å·è°ƒç ”</li>
<li>ç”¨æˆ·åé¦ˆåˆ†æ</li>
<li>äº§å“A/Bå®éªŒåˆ†æ</li>
<li>ç”¨æˆ·ä½¿ç”¨äº§å“æ—¶çš„è¡Œä¸ºåˆ†æ</li>
<li>ç«å“åˆ†æ</li>
</ul>
<p>ç›®å‰ï¼Œå¦‚ä¸Šçš„æ¯ç§æ–¹æ³•ï¼Œå¸‚é¢ä¸Šéƒ½æœ‰å¾ˆå¤šä¹¦ç±å’Œå†…å®¹æ¥ä»‹ç»ï¼Œåœ¨æ­¤å°±ä¸ä¸€ä¸€å±•å¼€é˜è¿°äº†ã€‚</p>
<p>åœ¨æœ¬æ–‡ä»‹ç»çš„ç”¨æˆ·ä½“éªŒæ¨¡å‹ï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mi>o</mi><mi>E</mi><mo>=</mo><mtext>äº§å“èƒ½åŠ›</mtext><mo>âˆ’</mo><mtext>ç”¨æˆ·é¢„æœŸ</mtext></mrow><annotation encoding="application/x-tex">QoE=\text{äº§å“èƒ½åŠ›}-\text{ç”¨æˆ·é¢„æœŸ}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">Q</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord text"><span class="mord cjk_fallback">äº§å“èƒ½åŠ›</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord text"><span class="mord cjk_fallback">ç”¨æˆ·é¢„æœŸ</span></span></span></span></span>ï¼Œç”¨æˆ·é¢„æœŸæ‰®æ¼”ç€è‡³å…³é‡è¦çš„ä½œç”¨ï¼Œåœ¨å¼€å±•ç”¨æˆ·ä½“éªŒæå‡çš„è¿‡ç¨‹ä¸­ï¼Œå¿…é¡»å¯¹è¿™ä¸ªå› ç´ å¼•èµ·é«˜åº¦çš„é‡è§†ã€‚</p>
]]></content>
      <categories>
        <category>æ€»ç»“</category>
      </categories>
      <tags>
        <tag>ç”¨æˆ·ä½“éªŒ</tag>
        <tag>QoE</tag>
        <tag>ç«å“åˆ†æ</tag>
        <tag>ç”¨æˆ·åé¦ˆ</tag>
      </tags>
  </entry>
  <entry>
    <title>ä¸€äº›æœ‰è¶£ä½†åˆå€¼å¾—æ€è€ƒçš„äº‹æƒ…</title>
    <url>/2021/12/11/Something-Interesting-But-Worth-Thinking-About/</url>
    <content><![CDATA[<p><img src="/2021/12/11/Something-Interesting-But-Worth-Thinking-About/1.jpeg" alt></p>
<h2 id="å¼•å­">å¼•å­</h2>
<blockquote>
<p>Any fool can write code that a computer can understand. Good programmers write code that humans can understand.<br>
<em><strong><div align="left">-- Martin Fowler</div></strong></em></p>
</blockquote>
<p>ä½œä¸ºç¨‹åºå‘˜ï¼Œæˆ‘çŒœï¼Œå½“çœ‹å®Œè¿™å¥è¯åï¼Œä½ è‚¯å®šä¼šè§‰å¾—è¿™å¥è¯æ˜¯å¯¹çš„ï¼Œä½†æ˜¯ä¸è§å¾—ä¼šç”±è¡·çš„ä¿¡æœè¿™å¥è¯ã€‚æˆ‘è¿˜çŒœï¼Œä½ ä¸€å®šåœ¨æƒ³ï¼Œ<strong>Martin Fowler</strong> ç©¶ç«Ÿæ˜¯è°å‘€ï¼Ÿ</p>
<span id="more"></span>
<p>æˆ‘ä»¬å†æ¥çœ‹ä¸‹é¢çš„è¿™å¥è¯ï¼š</p>
<blockquote>
<p>Stay Hungry, Stay Foolish.<br>
<em><strong><div align="left">-- Steve Jobs</div></strong></em></p>
</blockquote>
<p>æˆ‘çŒœï¼Œä½œä¸ºç¨‹åºå‘˜ï¼Œæˆ‘ä»¬ä¼šç”±è¡·çš„ä¿¡æœè¿™å¥è¯å§ï¼Ÿæˆ‘ä¹ŸçŒœï¼Œè‡³å°‘ä»Šå¤©ï¼Œæˆ‘ä»¬è¿˜éƒ½çŸ¥é“ <strong>Steve Jobs</strong> æ˜¯è°å§ï¼Ÿ</p>
<h2 id="å‡ ç»„æœ‰æ„æ€çš„é—®é¢˜">å‡ ç»„æœ‰æ„æ€çš„é—®é¢˜</h2>
<h4 id="ç¬¬ä¸€ç»„">ç¬¬ä¸€ç»„</h4>
<ul>
<li>å¾®è½¯çš„åˆ›å§‹äººæœ‰è°ï¼Ÿ</li>
<li>è‹¹æœçš„åˆ›å§‹äººæœ‰è°ï¼Ÿ</li>
<li>Facebook çš„åˆ›å§‹äººæœ‰è°ï¼Ÿ</li>
<li>è°·æ­Œçš„åˆ›å§‹äººæœ‰è°ï¼Ÿ</li>
<li>ç‚’è‚¡æ¯”è¾ƒå‰å®³çš„äººæœ‰è°ï¼Ÿ</li>
<li>äºšé©¬é€Šçš„åˆ›å§‹äººæœ‰è°ï¼Ÿ</li>
<li>ç‰¹æ–¯æ‹‰çš„åˆ›å§‹äººæœ‰è°ï¼Ÿ</li>
<li>â€¦â€¦</li>
</ul>
<h4 id="ç¬¬äºŒç»„">ç¬¬äºŒç»„</h4>
<ul>
<li>C è¯­è¨€çš„å‘æ˜è€…æ˜¯è°ï¼Ÿ</li>
<li>UNIX çš„å‘æ˜è€…æ˜¯è°ï¼Ÿ</li>
<li>åˆ†å¸ƒå¼ç³»ç»Ÿä¸­è‘—åçš„ Paxos ç®—æ³•çš„å‘æ˜è€…æ˜¯è°ï¼Ÿ</li>
<li>æ•æ·è½¯ä»¶å¼€å‘å®£è¨€çš„åˆ›ä½œè€…æœ‰è°ï¼Ÿ</li>
<li>é«˜å†…èšã€ä½è€¦åˆæ˜¯è°æå‡ºæ¥çš„ï¼Ÿ</li>
<li>å¾®æœåŠ¡æ¶æ„çš„æå‡ºè€…æ˜¯è°ï¼Ÿ</li>
<li>â€¦â€¦</li>
</ul>
<h4 id="ç¬¬ä¸‰ç»„">ç¬¬ä¸‰ç»„</h4>
<ul>
<li>ã€Šäººæœˆç¥è¯ã€‹çš„ä½œè€…æ˜¯è°ï¼Ÿ</li>
<li>ã€Šé‡æ„ã€‹çš„ä½œè€…æ˜¯è°ï¼Ÿ</li>
<li>ã€Šè®¾è®¡æ¨¡å¼ï¼šå¯å¤ç”¨é¢å‘å¯¹è±¡è½¯ä»¶çš„åŸºç¡€ã€‹çš„ä½œè€…æ˜¯è°ï¼Ÿ</li>
<li>ã€Šç®—æ³•å¯¼è®ºã€‹çš„ä½œè€…æ˜¯è°ï¼Ÿ</li>
<li>ã€Šä»£ç æ•´æ´ä¹‹é“ã€‹çš„ä½œè€…æ˜¯è°ï¼Ÿ</li>
<li>ã€Šä¿®æ”¹ä»£ç çš„è‰ºæœ¯ã€‹çš„ä½œè€…æ˜¯è°ï¼Ÿ</li>
</ul>
<p>å¦‚ä¸Šçš„å‡ ç»„é—®é¢˜ï¼Œåœ¨ä¸åˆ©ç”¨æœç´¢å¼•æ“å¸®åŠ©çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬èƒ½è¯´å‡ºå‡ ä¸ªå‘¢ï¼Ÿå¦‚æœæ‚¨æœ‰æ—¶é—´ï¼Œä¸å¦¨èŠ± 1-2 åˆ†é’Ÿçš„æ—¶é—´ä¸€èµ·å‚ä¸åˆ°è¿™ä»¶æœ‰æ„æ€çš„äº‹æƒ…ä¸Šæ¥ï¼Œç‚¹ä¸€ç‚¹ï¼Œå®Œæˆå¦‚ä¸‹çš„ 15 ä¸ªé—®é¢˜ã€‚</p>
<div><iframe height="500" width="100%" src="https://wj.qq.com/s2/9442849/3f79/" frameborder="0" allowfullscreen></iframe></div>
<h4 id="é—®å·çš„ç»“æœ">é—®å·çš„ç»“æœ</h4>
<p>å¾…è¡¥å……</p>
<h2 id="å‘ç°äº†ä»€ä¹ˆï¼Ÿ">å‘ç°äº†ä»€ä¹ˆï¼Ÿ</h2>
<p>æ˜¯ä¸æ˜¯ä¸€ä»¶æœ‰æ„æ€çš„äº‹æƒ…å‘¢ï¼Ÿ</p>
<p>ä½œä¸ºç¨‹åºå‘˜ï¼Œä½œä¸ºè¿™ä¸ªåœˆå­é‡Œçš„äººï¼Œæˆ‘ä»¬å¤©å¤©å˜´ä¸Šè®¨è®ºè¿™æ•æ·å¼€å‘ã€è®¾è®¡æ¨¡å¼ã€å¾®æœåŠ¡ï¼Œæˆ‘ä»¬å¤©å¤©åœ¨å’Œå„ç§ç¼–ç¨‹è¯­è¨€æ‰“äº¤é“ï¼Œæˆ‘ä»¬å¤©å¤©åœ¨é˜…è¯»å„ç§ç»å…¸çš„æŠ€æœ¯ä¹¦ç±â€¦â€¦ä½†æ˜¯ï¼Œæˆ‘ä»¬å´è¯´ä¸å‡ºè¿™äº›ç»å…¸å·¨è‘—çš„ä½œè€…ï¼Œè¯´ä¸å‡ºæŸç§è½¯ä»¶å¼€å‘æ¨¡å¼çš„æå‡ºè€…ï¼Œè¯´ä¸å‡ºè‡ªå·±æ¯å¤©ä½¿ç”¨çš„ç¼–ç¨‹è¯­è¨€çš„å‘æ˜è€…â€¦â€¦</p>
]]></content>
      <categories>
        <category>æ–‡åŒ–</category>
      </categories>
      <tags>
        <tag>æ€è€ƒ</tag>
      </tags>
  </entry>
  <entry>
    <title>æ–°ä¸šåŠ¡çš„å¼€å‘å°±ä¸éœ€è¦é‡è§†å†…éƒ¨è´¨é‡å—ï¼Ÿ</title>
    <url>/2021/12/04/Should-the-new-business-production-development-focus-on-internal-quality/</url>
    <content><![CDATA[<p><img src="/2021/12/04/Should-the-new-business-production-development-focus-on-internal-quality/0.jpeg" alt></p>
<p>ä¸€ç›´ä»¥æ¥ï¼Œæˆ‘éƒ½åœ¨æ€è€ƒå¦‚ä¸‹çš„é—®é¢˜ï¼š</p>
<ul>
<li>æ–°å¯åŠ¨çš„ä¸šåŠ¡æ˜¯å¦å€¼å¾—èŠ±è´¹æ—¶é—´æ¥å¼€å±•å•å…ƒæµ‹è¯•ã€æ¥å£è‡ªåŠ¨åŒ–æµ‹ç­‰è´¨é‡ä¿è¯æ‰‹æ®µï¼Ÿ</li>
<li>æ–°å¯åŠ¨çš„ä¸šåŠ¡æ˜¯å¦å€¼å¾—èŠ±è´¹æ—¶é—´æ¥è·µè¡ŒæŒç»­é›†æˆç­‰è½¯ä»¶å¼€å‘æ¨¡å¼ï¼Ÿ</li>
<li>æ–°å¯åŠ¨çš„ä¸šåŠ¡æ˜¯å¦å€¼å¾—èŠ±è´¹æ—¶é—´æ¥è®¾è®¡æ¶æ„ã€ç¼–å†™æ¥å£æ–‡æ¡£â€¦â€¦?</li>
<li>â€¦â€¦</li>
</ul>
<span id="more"></span>
<h2 id="ä¸€ç›´ä»¥æ¥çš„ç–‘é—®å’Œè¿·æƒ‘">ä¸€ç›´ä»¥æ¥çš„ç–‘é—®å’Œè¿·æƒ‘</h2>
<p>ä¸€ç›´ä»¥æ¥ï¼Œéƒ½æ²¡æœ‰æƒ³çš„éå¸¸æ¸…æ¥šã€‚éšç€ç»å†çš„è¶Šå¤šï¼Œè§‚å¯Ÿçš„è¶Šå¤šï¼Œå¯¹è¿™äº›é—®é¢˜çš„è¿·æƒ‘ä¹Ÿéšä¹‹å¢åŠ ï¼š</p>
<ul>
<li>å¦‚æœè¯´ï¼Œè‡ªåŠ¨åŒ–æ˜¯æå‡æ•ˆç‡çš„å¿…è¦æ‰‹æ®µï¼Œé‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆæ–°ä¸šåŠ¡éƒ½ä¸æ„¿æ„é‡‡ç”¨å¯¹åº”çš„è‡ªåŠ¨åŒ–æ‰‹æ®µå‘¢ï¼Ÿ</li>
<li>å¦‚æœè¯´ï¼ŒæŒç»­é›†æˆçœŸçš„èƒ½å¤Ÿæå‡è½¯ä»¶ä»·å€¼çš„äº¤ä»˜æ•ˆç‡ï¼Œé‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆæ–°ä¸šåŠ¡éƒ½ä¸æ„¿æ„é‡‡ç”¨è¿™ç§å®è·µæ¨¡å¼ï¼Ÿ</li>
<li>æˆ‘æ€»æ˜¯å¬åˆ°ï¼Œæ–°ä¸šåŠ¡è¦å¿«é€ŸéªŒè¯ä¸šåŠ¡é€»è¾‘ï¼Œä»£ç éƒ½æ²¡æœ‰æ—¶é—´å†™ï¼Œå“ªè¿˜æœ‰æ—¶é—´ç¼–å†™ï¼š
<ul>
<li>æ¶æ„è®¾è®¡æ–‡æ¡£</li>
<li>æ¥å£æ–‡æ¡£</li>
<li>å•å…ƒæµ‹è¯•ç”¨ä¾‹</li>
<li>è‡ªåŠ¨åŒ–ç”¨ä¾‹</li>
<li>â€¦â€¦<br>
éš¾é“å¦‚ä¸Šçš„è¿™äº›æ‰‹æ®µä¼šé™ä½ä»·å€¼äº¤ä»˜çš„æ•ˆç‡ï¼Ÿå¦‚æœä¸æ˜¯è¿™æ ·ï¼Œé‚£ä¸ºä»€ä¹ˆæˆ‘æ€»èƒ½å¬åˆ°è¿™ç§è¨€è®ºå‘¢ï¼Ÿ</li>
</ul>
</li>
</ul>
<p>ç›´åˆ°æœ€è¿‘è¯»äº† Martin Fowler çš„æ–‡ç«  <em><a href="https://martinfowler.com/articles/is-quality-worth-cost.html">Is High Quality Software Worth the Cost?</a></em> ï¼ˆ<a href="https://mp.weixin.qq.com/s/mGq5SsMp2yuSA_p5meWRCg">é«˜è´¨é‡çš„è½¯ä»¶æ˜¯å¦å€¼å¾—ä»˜å‡ºä»£ä»·ï¼Ÿ</a>ï¼‰ï¼Œæ‰æƒ³æ˜ç™½äº†å¦‚ä¸Šçš„é—®é¢˜å’Œè¿·æƒ‘çš„æ ¹æºã€‚</p>
<h2 id="é«˜è´¨é‡çš„è½¯ä»¶æ˜¯å¦å€¼å¾—ä»˜å‡ºä»£ä»·ï¼Ÿ">é«˜è´¨é‡çš„è½¯ä»¶æ˜¯å¦å€¼å¾—ä»˜å‡ºä»£ä»·ï¼Ÿ</h2>
<h4 id="å†…éƒ¨è´¨é‡å’Œå¤–éƒ¨è´¨é‡">å†…éƒ¨è´¨é‡å’Œå¤–éƒ¨è´¨é‡</h4>
<p>åœ¨ <em><a href="https://martinfowler.com/articles/is-quality-worth-cost.html">Is High Quality Software Worth the Cost?</a></em> ä¸€æ–‡ä¸­ï¼ŒMartin Fowler å°†è½¯ä»¶è´¨é‡åˆ†ä¸º <strong>å¤–éƒ¨è´¨é‡</strong> å’Œ <strong>å†…éƒ¨è´¨é‡</strong>ã€‚</p>
<blockquote>
<p>I thus divide software quality attributes into <strong>external</strong> (such as the UI and defects) and <strong>internal</strong> (architecture).</p>
<p>The distinction is that users and customers can see what makes a software product have high <strong>external quality</strong>, but cannot tell the difference between higher or lower <strong>internal quality</strong>.</p>
</blockquote>
<p>ç„¶åï¼ŒMartin Fowler æåˆ°ï¼šæ—¢ç„¶ç”¨æˆ·æ— æ³•åŒºåˆ† <strong>å†…éƒ¨è´¨é‡</strong> çš„å¥½åï¼Œä¸ºä»€ä¹ˆè¦ä¸ºæ²¡æœ‰æ•ˆæœçš„ä¸œè¥¿ä»˜å‡ºæ›´å¤šå‘¢ï¼Ÿ</p>
<blockquote>
<p>Another way I put this is that it makes sense to trade cost for <strong>external quality</strong> but it makes no sense to trade cost for <strong>internal quality</strong>.</p>
<p>A user can judge whether they want to pay more to get a better user interface, since they can assess whether the user interface is sufficiently nicer to be worth the extra money.</p>
<p>But a user canâ€™t see the internal modular structure of the software, let alone judge that itâ€™s better.</p>
<p><strong>Why pay more for something that has no effect?</strong></p>
<p>Since thatâ€™s the case - why should any software developer put their time and effort into improving the internal quality of their work?</p>
</blockquote>
<p>å› æ­¤ï¼Œå¯¹äºæ–°ä¸šåŠ¡è€Œè¨€ï¼Œç”¨æˆ·æ— æ³•æ„ŸçŸ¥åˆ°ï¼šæ¥å£æ–‡æ¡£ã€å•å…ƒæµ‹è¯•ç”¨ä¾‹ã€æ¥å£æµ‹è¯•ç”¨ä¾‹ã€æŒç»­é›†æˆçš„é…å¥—å»ºè®¾ç­‰æœ‰åˆ©äº <strong>å†…éƒ¨è´¨é‡</strong> çš„æªæ–½ï¼Œæœ‰è¿™äº›æ—¶é—´è¿˜ä¸å¦‚å¤šå†™ç‚¹ä»£ç ï¼Œå¤šå®ç°ä¸€äº›ç”¨æˆ·å¯ä»¥æ„ŸçŸ¥åˆ°çš„åŠŸèƒ½ã€‚</p>
<p>è¿™å¬èµ·æ¥æ˜¯å¤šä¹ˆçš„åˆä¹é€»è¾‘ï¼Œæ¨ç†çš„è¿‡ç¨‹åˆæ˜¯å¤šä¹ˆçš„é¡ºç†æˆç« ã€æ— æ‡ˆå¯å‡»ã€‚</p>
<h4 id="å†…éƒ¨è´¨é‡çš„é‡è¦æ€§">å†…éƒ¨è´¨é‡çš„é‡è¦æ€§</h4>
<p>ç„¶åï¼ŒMartin Fowler åˆ©ç”¨ <strong>è½¯ä»¶ç´¯ç§¯åŠŸèƒ½</strong> å’Œ <strong>å¯¹åº”çš„å¼€å‘æˆæœ¬</strong> ä¹‹é—´çš„å…³ç³»æ¨¡å‹é˜è¿°äº† <strong>å†…éƒ¨è´¨é‡</strong> çš„é‡è¦æ€§ã€‚</p>
<blockquote>
<p><img src="/2021/12/04/Should-the-new-business-production-development-focus-on-internal-quality/1.jpg" alt></p>
<p>The fundamental role of <strong>internal quality</strong> is that <strong>it lowers the cost of future change</strong>.</p>
<p>But there is some extra effort required to write good software, which does impose some cost in the short term.</p>
</blockquote>
<p>Martin Fowler é‡‡ç”¨äº†è®¿è°ˆçš„æ–¹å¼æ¥è¯„ä¼°ä¸¤æ¡æ›²çº¿çš„äº¤ç‚¹åœ¨æ•´ä¸ªè½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­å‡ºç°çš„æ—¶é—´ï¼Œå¹¶æƒŠå¥‡çš„å‘ç°è¯¥äº¤ç‚¹åœ¨æ•°å‘¨ä»¥åå°±ä¼šå‡ºç°ã€‚</p>
<p>å®é™…ä¸Šï¼Œå¯¹äºæ–°ä¸šåŠ¡è€Œè¨€ï¼Œæˆ‘ä»¬åœ¨æ¢ç´¢çš„åˆæœŸå°±æ˜¯å‘ç€ä¸€ä¸ªå¯èƒ½ä¼šæˆåŠŸçš„æ–¹å‘ä¸Šæ¥æ¢ç´¢ã€‚å› æ­¤ï¼Œæ•´ä¸ªæ¢ç´¢çš„è¿‡ç¨‹ä¼šç»å†æ•°æœˆã€ç”šè‡³ 1~2 å¹´çš„æ—¶é—´ã€‚è€Œæ ¹æ® Martin Fowler çš„ <strong>è½¯ä»¶ç´¯è®¡åŠŸèƒ½</strong> æ¨¡å‹ï¼Œå¦‚æœä¸é‡è§† <strong>å†…éƒ¨è´¨é‡</strong>ï¼Œæ•°å‘¨ä¹‹åï¼Œç³Ÿç³•çš„ <strong>å†…éƒ¨è´¨é‡</strong> å°±ä¼šä¸¥é‡å½±å“è½¯ä»¶çš„äº¤ä»˜æ•ˆç‡ã€‚å› æ­¤ï¼Œåªæœ‰åœ¨ä¸€å¼€å§‹å°±é‡è§†è½¯ä»¶çš„ <strong>å†…éƒ¨è´¨é‡</strong>ï¼Œæ‰èƒ½çœŸæ­£æœ‰æ•ˆçš„æå‡æ–°ä¸šåŠ¡çš„ä»·å€¼æ¢ç´¢æ•ˆç‡ã€‚</p>
<blockquote>
<p>The way I assess where lines cross is by canvassing the opinion of skilled developers that I know.</p>
<p>And the answer surprises a lot of folks.</p>
<p>Developers find <strong>poor quality code significantly slows them down within a few weeks</strong>.</p>
<p>So thereâ€™s not much runway where the trade-off between internal quality and cost applies.</p>
<p><strong>Even small software</strong> efforts benefit from attention to good software practices, certainly something I can attest from my experience.</p>
</blockquote>
<h4 id="æˆæœ¬å’Œå†…éƒ¨è´¨é‡çš„å…³ç³»">æˆæœ¬å’Œå†…éƒ¨è´¨é‡çš„å…³ç³»</h4>
<p>åœ¨æ–‡ç« çš„æœ€åï¼ŒMartin Fowler ä¹Ÿæåˆ°ï¼š<strong>æˆæœ¬</strong> å’Œ <strong>å†…éƒ¨è´¨é‡</strong> æ˜¯ä¸€ç§ä¸å¯»å¸¸ä¸”è¿åç›´è§‰çš„å…³ç³»ï¼Œå› æ­¤é€šå¸¸éš¾ä»¥ç†è§£äºŒè€…ä¹‹é—´çš„å…³ç³»ï¼Œä½†æ˜¯ç†è§£ä»–ä»¬ä¹‹é—´çš„å…³ç³»å¯¹äºä»¥æœ€é«˜æ•ˆç‡å¼€å‘è½¯ä»¶è‡³å…³é‡è¦ã€‚</p>
<blockquote>
<p>When thinking about internal quality, I stress that we should only approach it as an economic argument.</p>
<p>High internal quality reduces the cost of future features, meaning that putting the time into writing good code actually reduces cost.</p>
<p>Because the relationship between cost and internal quality is an unusual and counter-intuitive relationship, itâ€™s usually hard to absorb. But understanding it is critical to developing software at maximum efficiency.</p>
</blockquote>
<h2 id="é†é†çŒé¡¶">é†é†çŒé¡¶</h2>
<p>ç›´åˆ°ç°åœ¨ï¼Œç›´åˆ°è¯»äº† Martin Fowler çš„è¿™ç¯‡æ–‡ç« ï¼Œç›´åˆ°å°†è½¯ä»¶è´¨é‡åŒºåˆ†ä¸º <strong>å†…éƒ¨è´¨é‡</strong> å’Œ <strong>å¤–éƒ¨è´¨é‡</strong>ï¼Œç›´åˆ°äº†è§£åˆ° <strong>æˆæœ¬</strong> å’Œ <strong>å†…éƒ¨è´¨é‡</strong> ä¹‹é—´çš„è¿™ç§ä¸å¯»å¸¸ã€ä½†åˆè¿åç›´è§‰ã€è®²ä¸æ¸…é“ä¸æ˜ã€å‰ªä¸æ–­ç†è¿˜ä¹±çš„å…³ç³»ï¼Œæˆ‘æ‰æ˜ç™½ï¼Œæˆ‘ä¸ºä»€ä¹ˆä¼šæœ‰æœ¬æ–‡å¼€å¤´æ‰€åˆ—çš„ç§ç§è¿·æƒ‘å’Œä¸è§£ï¼Œæˆ‘æ‰æ‰¾åˆ°äº†ä¸€ç›´è¿½å¯»çš„ç­”æ¡ˆã€‚</p>
<h4 id="è¶Šæ˜¯æ–°ä¸šåŠ¡-è¶Šè¦åŠæ—©é‡è§†å†…éƒ¨è´¨é‡">è¶Šæ˜¯æ–°ä¸šåŠ¡ï¼Œè¶Šè¦åŠæ—©é‡è§†å†…éƒ¨è´¨é‡</h4>
<p>æœ€å¼€å§‹çš„æ—¶å€™ï¼Œæˆ‘ä¹Ÿè®¤ä¸ºåœ¨æ–°ä¸šåŠ¡çš„æ—©æœŸï¼Œæ²¡æœ‰å¿…è¦è¿‡æ—©çš„å»ºè®¾å•å…ƒæµ‹è¯•ã€è‡ªåŠ¨åŒ–æµ‹è¯•ã€æ¥å£æ–‡æ¡£ç­‰å·¥ä½œã€‚å¯¹è¿™ä¸ªäº‹æƒ…çš„è®¤çŸ¥æ”¹å˜å§‹äº 2014 å¹´å¼€å§‹å‚ä¸çš„ <strong>å®å®çŸ¥é“</strong> è¿™æ¬¾äº§å“çš„ç ”å‘å·¥ä½œã€‚</p>
<p>å½“æ—¶ï¼Œæˆ‘è´Ÿè´£è¿™æ¬¾äº§å“çš„æœåŠ¡ç«¯æµ‹è¯•å·¥ä½œã€‚åœ¨ 1.0 ç‰ˆæœ¬çš„æµ‹è¯•è¿‡ç¨‹ä¸­ï¼Œæ²¡æœ‰æ¥å£æ–‡æ¡£ã€æ²¡æœ‰å•å…ƒæµ‹è¯•ç”¨ä¾‹ã€æ²¡æœ‰æ¥å£æµ‹è¯•ç”¨ä¾‹â€¦â€¦æ•´ä¸ªæµ‹è¯•è¿‡ç¨‹å°±æ˜¯åˆ©ç”¨ <code>curl</code> å‘½ä»¤å‘èµ·è¯·æ±‚ï¼Œç„¶åæ‰‹åŠ¨é€ä¸€æ ¡éªŒè¿”å›ç»“æœä¸­çš„æ¯ä¸€ä¸ªå­—æ®µï¼Œæ ¡éªŒå­—æ®µçš„ç±»å‹ã€å­—æ®µçš„ç»“æœã€æ•°æ®åº“ä¸­çš„æ•°æ®â€¦â€¦</p>
<p>å½“ 1.0 ç‰ˆæœ¬ä¸Šçº¿çš„æ—¶å€™ï¼Œæˆ‘å°±åœ¨æƒ³ï¼Œä¸èƒ½å†è¿™ä¹ˆæäº†ï¼Œæ•ˆç‡å¤ªä½äº†ã€‚æ°å·§é‚£ä¸ªæ—¶å€™ï¼Œç ”å‘åŒå­¦æ­£åœ¨æ¨åŠ¨æ¥å£å®šä¹‰çš„æ–‡æ¡£åŒ–ï¼šä½¿ç”¨ <code>json</code> å®šä¹‰æ¥å£ï¼Œç„¶åæœåŠ¡ç«¯ã€iOS ç«¯ã€Android ç«¯åˆ©ç”¨è¯¥æ¥å£å®šä¹‰è‡ªåŠ¨ç”Ÿæˆå„è‡ªéœ€è¦çš„å¯¹è±¡å®ä½“ã€‚</p>
<p>åœ¨æ–°æ¥å£è®¾è®¡ä¹‹åˆï¼Œå›¢é˜Ÿå†…æ‰€æœ‰è§’è‰²éƒ½ä¼šå‚ä¸è¿›æ¥ä¸€èµ·åˆ¶å®šå¯¹åº”æ¥å£çš„ <code>json</code> æ ¼å¼çš„æ¥å£å®šä¹‰ï¼Œç„¶åç”±æœåŠ¡ç«¯ RD å­˜å‚¨åœ¨ä»£ç åº“ä¹‹ä¸­ã€‚å€ŸåŠ©äºè¿™ç§æœ‰åˆ©çš„å½¢å¼ï¼Œæˆ‘å¼€å§‹å’Œ RD è®¨è®ºï¼šåœ¨ RD ç¼–å†™ä»£ç æ—¶ï¼Œæµ‹è¯•äººå‘˜åŒæ­¥ç¼–å†™è‡ªåŠ¨åŒ–æ¥å£æµ‹è¯•ç”¨ä¾‹çš„å¯è¡Œæ€§ã€‚</p>
<p>æœ€ç»ˆï¼Œæˆ‘å’Œ RD ä¸€æ‹å³å’Œï¼Œåœ¨éšå³å¼€å§‹çš„ä¸‹ä¸€æ¬¡è¿­ä»£å¼€å‘ä¸­ï¼ŒRD åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä¹Ÿåœ¨æ ¹æ®æ¥å£å®šä¹‰æ–‡æ¡£æ¥ç¼–å†™è¯¥æ¥å£çš„è‡ªåŠ¨åŒ–æµ‹è¯•ç”¨ä¾‹ã€‚æˆ‘æŠŠä¹‹å‰æ‰‹å·¥æ ¡éªŒçš„æ‰€æœ‰æ ¡éªŒç‚¹å…¨éƒ¨ç”¨ä»£ç çš„æ–¹å¼æ¥å®ç°ã€‚åŒæ—¶ï¼Œä¸ºäº†å…¼é¡¾åˆ°æ¶æ„å±‚é¢çš„é£é™©ï¼Œæˆ‘å’Œ RD çº¦å®šï¼šæ¯å¤©ä¸‹åˆ5ç‚¹ï¼ŒRD éœ€è¦å°†å½“å‰çš„ä»£ç å…¥åº“ï¼Œç„¶åæˆ‘å°±å¯ä»¥æ‹‰å–åˆ° RD çš„ä»£ç ï¼Œå¹¶æ‰§è¡Œ <strong>ä»£ç èµ°è¯»</strong>ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥æ ¹æ®ç›®å‰çš„ä»£ç æ¥åŠæ—¶ä¿®æ­£è‡ªåŠ¨åŒ–æµ‹è¯•çš„æ ¡éªŒç‚¹ã€‚</p>
<p>æˆ‘æ¯å¤©éƒ½ä¼šèŠ±è´¹ä¸€äº›æ—¶é—´æ¥ç¼–å†™è‡ªåŠ¨åŒ–æµ‹è¯•ç”¨ä¾‹ï¼Œèµ°è¯»ä»£ç ï¼Œä¿®æ­£è‡ªåŠ¨åŒ–æµ‹è¯•ç”¨ä¾‹ã€‚å°±è¿™æ ·ï¼Œä¸æ–­çš„æŠŠåŸæœ¬åœ¨ Excel ä¸­çš„æ‰‹å·¥æµ‹è¯•ç”¨ä¾‹åˆ‡æ¢åˆ°äº†è‡ªåŠ¨åŒ–æµ‹è¯•ç”¨ä¾‹ã€‚å½“ç„¶ï¼Œåœ¨æµ‹è¯•ç”¨ä¾‹è®¾è®¡ä¸Šï¼Œæ¯” 1.0 ç‰ˆæœ¬çš„æµ‹è¯•è®¾è®¡èŠ±è´¹äº†æ›´å¤šçš„æ—¶é—´ã€‚ä½†æ˜¯ï¼Œå½“ RD ææµ‹çš„æ—¶å€™ï¼Œå¯¹äºæµ‹è¯•æ‰§è¡Œçš„æ—¶é—´ï¼Œåˆ™æ¯”ä¹‹å‰å¤§å¤§ç¼©çŸ­ï¼Œæˆ‘åªèŠ±äº† 10 åˆ†é’Ÿå·¦å³çš„æ—¶é—´å°±å®Œæˆäº†æµ‹è¯•ã€‚åˆ°åæ¥ï¼ŒRD åœ¨å¼€å‘è¿‡ç¨‹ä¸­ä¹Ÿç”¨ä¸Šäº†æˆ‘ç¼–å†™çš„è‡ªåŠ¨åŒ–æµ‹è¯•ç”¨ä¾‹ï¼ŒRD åœ¨å¼€å‘ä¸­è°ƒè¯•ã€å®šä½ã€ä¿®å¤é—®é¢˜çš„æ•ˆç‡ä¹Ÿå¤§ä¸ºæå‡ã€‚åæ¥ï¼ŒæœåŠ¡ç«¯çš„æ¶æ„åšäº†ä¸€äº›è°ƒæ•´ï¼Œä¾‹å¦‚ï¼šæ•°æ®åº“è¿ç§»ã€ç¼“å­˜æœºåˆ¶ã€å¼‚æ­¥æäº¤æœºåˆ¶â€¦â€¦åœ¨è‡ªåŠ¨åŒ–æµ‹è¯•ç”¨ä¾‹çš„å¸®åŠ©ä¸‹ï¼Œæˆ‘å‘ç°ï¼Œå¯¹äºæˆ‘ä»¬è€Œè¨€ï¼Œè¿™ç§å˜æ›´å˜å¾—éå¸¸å¯æ§ã€‚</p>
<p><strong>æ—¶è‡³ä»Šæ—¥ï¼Œæ¯å½“å›æƒ³èµ·æ¥ï¼Œæˆ‘éƒ½è®¤ä¸ºï¼Œåœ¨é¡¹ç›®çš„åˆæœŸå°±é‡‡ç”¨äº†ä»£ç åŒ–çš„æ¥å£å®šä¹‰æ–‡æ¡£ã€å®Œå–„çš„è‡ªåŠ¨åŒ–æµ‹è¯•ç”¨ä¾‹ç­‰æœ‰åˆ©äºæå‡ <em>å†…éƒ¨è´¨é‡</em> çš„æªæ–½ï¼Œæ‰ä¿è¯äº†ä¹‹åçš„äº¤ä»˜æ•ˆç‡ï¼Œæ‰ä½¿å¾—ä½œä¸ºåæ¥è€…çš„ <em>å®å®çŸ¥é“</em> åœ¨ä¹‹åçš„ç«äº‰ä¸­åŠæ—¶æŠ“ä½å¸‚åœºæœºä¼šã€è·å–å¸‚åœºå…ˆæœºï¼Œåœ¨ä¼—å¤šæ¯å©´ç±»äº§å“ä¸­è„±é¢–è€Œå‡ºã€‚</strong></p>
<h4 id="å¿½ç•¥å†…éƒ¨è´¨é‡-æ¬²é€Ÿåˆ™ä¸è¾¾">å¿½ç•¥å†…éƒ¨è´¨é‡ï¼Œæ¬²é€Ÿåˆ™ä¸è¾¾</h4>
<p>æœºç¼˜å·§åˆï¼Œæˆ‘æœ‰å¹¸èƒ½å¤Ÿè§‚å¯Ÿåˆ°æ›´å¤šçš„æ–°ä¸šåŠ¡çš„äº¤ä»˜è¿‡ç¨‹ã€‚å¯¹äºæ–°ä¸šåŠ¡è€Œè¨€ï¼Œå”¯å¿«ä¸ç ´ã€‚ç„¶è€Œï¼Œå¯¹äºæ–°ä¸šåŠ¡ï¼Œæˆ‘å‘ç°æ€»ä¼šå‡ºç° Martin Fowler æ‰€è¯´çš„é‚£ç§æƒ…å†µï¼š</p>
<ul>
<li>å›¢é˜Ÿæ™®éä¼šæ‹’ç»ä¸ºé‚£äº›æ²¡æœ‰æ•ˆæœçš„ <strong>å†…éƒ¨è´¨é‡</strong> ä»˜å‡ºæ›´å¤šçš„èµ„æºå’Œæˆæœ¬</li>
<li>å›¢é˜Ÿæ¯å¤©éƒ½ç–²äºå®ç°ç”¨æˆ·å¯æ„ŸçŸ¥åˆ°çš„åŠŸèƒ½ï¼Œæ¯å¤©éƒ½å›´ç»•ç€ <strong>å¤–éƒ¨è´¨é‡</strong> è€Œå¿™ç¢Œ</li>
</ul>
<p>æˆ‘æ€»èƒ½å¬åˆ°è¿™äº›å›¢é˜Ÿçš„å†³ç­–è€…è¯´ï¼šç°åœ¨ä¸šåŠ¡å¤„äºé€»è¾‘éªŒè¯æœŸï¼Œè¦ä¿è¯åŠŸèƒ½çš„å¿«é€Ÿä¸Šçº¿ï¼Œå…¶ä»–çš„äº‹æƒ…ï¼ˆæ¶æ„è®¾è®¡ã€æ¥å£æ–‡æ¡£ã€è‡ªåŠ¨åŒ–æµ‹è¯•â€¦â€¦ï¼‰éƒ½å…ˆæ”¾ä¸€ä¸‹ï¼Œä¼˜å…ˆä¿è¯åŠŸèƒ½ä¸Šçº¿ã€‚</p>
<p>æ®æˆ‘å¤šå¹´çš„è§‚å¯Ÿï¼Œæˆ‘å‘ç°ï¼Œå‡¡æ˜¯æœ‰è¿™ç§æ€æƒ³çš„ä¸šåŠ¡ï¼Œæ€»ä¼šåœ¨æœ€è¯¥å¿«é€Ÿå¥”è·‘çš„æ—¶åˆ»å—åˆ° <strong>å†…éƒ¨è´¨é‡</strong> çš„æŸç¼šã€‚æ®‹ç¼ºçš„æ¶æ„è®¾è®¡ï¼Œä¸¢å¤±çš„æ¥å£æ–‡æ¡£ï¼Œæ— æ³•å¿«é€ŸéªŒè¯è½¯ä»¶æ˜¯å¦æ­£å¸¸çš„è‡ªåŠ¨åŒ–æµ‹è¯•èƒ½åŠ›â€¦â€¦æ‰€æœ‰çš„è¿™äº›å› ç´ å¯¼è‡´åŠŸèƒ½è¿­ä»£çš„æ•ˆç‡æ€¥å‰§ä¸‹é™ï¼ŒåŒæ—¶å¸¦æ¥çš„è¿˜æœ‰äº§å“è´¨é‡çš„æŒç»­èµ°ä½ã€‚</p>
<p>å›¢é˜Ÿç€æ€¥å°†æŸä¸ªæ–°ç‰¹æ€§å‘å¸ƒåˆ°çº¿ä¸Šï¼Œç„¶è€Œï¼Œæ•°å°æ—¶ä¹‹åçº¿ä¸Šå¼€å§‹å‡ºç°äº†å¼‚å¸¸ï¼š</p>
<ul>
<li>å›¢é˜Ÿä¸å¾—ä¸å›æ»šè¿™æ¬¡æ–°ç‰¹æ€§çš„å‘å¸ƒï¼Œå¹¶èŠ±è´¹å¾ˆå¤§çš„ä»£ä»·æ¥å®šä½&amp;ä¿®å¤é—®é¢˜ï¼Œç„¶åå†æ¬¡å°†æ–°ç‰¹æ€§æ¨é€ç»™ç”¨æˆ·ã€‚</li>
<li>æ›´ä¸¥é‡çš„æ˜¯ï¼ŒåŠŸèƒ½å›æ»šã€é—®é¢˜å®šä½&amp;ä¿®å¤ã€åŠŸèƒ½å†å‘å¸ƒå ç”¨äº†å…¶ä»–æ–°ç‰¹æ€§çš„ç ”å‘æ—¶é—´ï¼Œæ‰“ä¹±äº†å›¢é˜Ÿçš„ç ”å‘èŠ‚å¥ï¼Œè¿›è€Œä¸¥é‡å½±å“äº†äº¤ä»˜çš„æ•ˆç‡ï¼Œå¢åŠ äº†äº¤ä»˜çš„æˆæœ¬ã€‚</li>
<li>æœ€åï¼Œä¸ºäº†ä½“ç°å¯¹è¯¥é—®é¢˜çš„é‡è§†ï¼Œæ¯å½“è¿™ä¸ªæ—¶å€™ï¼Œå›¢é˜Ÿä¼šæ”¾ä¸‹æ‰‹é‡Œçš„æ–°ç‰¹æ€§ï¼Œâ€œéƒ‘é‡å…¶äº‹â€çš„å¯¹é—®é¢˜çš„æ¥é¾™å»è„‰è¿›è¡Œå¤ç›˜ï¼Œä»¥é¿å…ç±»ä¼¼çš„äº‹æƒ…å†æ¬¡å‘ç”Ÿã€‚ç„¶è€Œï¼Œæˆ‘è§‚å¯Ÿåˆ°ï¼Œæ¯æ¬¡çš„ç»“æœæ€»æ˜¯ï¼šå¹´å¹´å²å²èŠ±ç›¸ä¼¼ï¼Œå²å²å¹´å¹´äººä¸åŒã€‚</li>
<li>ç›´åˆ°å›¢é˜Ÿå†…éƒ¨æ‰€æœ‰çš„äººéƒ½æ— æ³•å†å¿å—ç±»ä¼¼çš„äº‹æƒ…äº†ï¼Œæ— æ³•å†å¿å—é‚£çœ‹ä¹Ÿçœ‹ä¸æ‡‚ã€æ”¹ä¹Ÿæ²¡æ³•æ”¹ã€éœ€è¦çŒœæ¥çŒœå»çš„ä»£ç äº†ï¼Œä¸€ç§æœ‰è¶£çš„ç°è±¡éšä¹‹å‡ºç°ï¼šé‡æ„ï¼Œå¤§è§„æ¨¡çš„é‡æ„ã€‚ç„¶è€Œï¼Œå› ä¸ºæ–°ä¸šåŠ¡ç¼ºä¹å¯¹åº”çš„å¿«é€ŸéªŒè¯çš„æœ‰æ•ˆæ‰‹æ®µï¼Œå› æ­¤ï¼Œæ­¤æ—¶çš„é‡æ„éœ€è¦èŠ±è´¹é«˜æ˜‚çš„æˆæœ¬ã€‚è€Œé‡æ„æœ¬èº«åˆæ˜¯ä¸€ç§æ²¡æœ‰ <strong>ä»·å€¼å¢å€¼</strong> çš„è¡Œä¸ºï¼Œå½“å›¢é˜ŸèŠ±è´¹å·¨å¤§çš„æˆæœ¬å®Œæˆé‡æ„çš„æ—¶å€™ï¼Œæœ‰å¯èƒ½å·²ç»é”™è¿‡å¸‚åœºçš„æœºä¼šã€‚</li>
</ul>
<p>æ–°ä¸šåŠ¡æ€»æƒ³ç€å¿«é€Ÿèµ·è·‘ï¼Œè€Œå¿½ç•¥äº†æ£€æŸ¥è‡ªå·±çš„è£…å¤‡ï¼Œå€’å‡ºé‹é‡Œçš„æ²™å­ï¼Œç³»ç´§é‹å¸¦â€¦â€¦æ–°ä¸šåŠ¡æ€»è®¤ä¸ºè¿™äº›äº‹æƒ…ä¼šå ç”¨è·‘æ­¥çš„æ—¶é—´ï¼Œåˆ°åæ¥æ‰å‘ç°ï¼Œä¸ä¹…ä¹‹åï¼Œè¿™äº›äº‹æƒ…å°±ä¼šé™ä½è·‘æ­¥çš„é€Ÿåº¦ï¼Œå¯¼è‡´æˆ‘ä»¬ä¸å¾—ä¸åœ¨ä¹‹åçš„æŸä¸ªæ—¶é—´ç‚¹åœä¸‹è„šæ­¥å»å¤„ç†è¿™äº›äº‹æƒ…ã€‚åœ¨è¿™ä¸ªæ—¶å€™ï¼Œå°±è¿™æ ·çœ¼çççš„çœ‹ç€åˆ«äººä»¥ä¸æ–­å¢åŠ çš„åŠ é€Ÿåº¦æ¥å¥”è·‘ã€‚æ¬²é€Ÿåˆ™ä¸è¾¾ï¼Œéä¸æƒ³ï¼Œå®ä¸èƒ½ã€‚</p>
<h4 id="å¿½ç•¥å†…éƒ¨è´¨é‡å¸¦æ¥çš„ç ´çª—æ•ˆåº”">å¿½ç•¥å†…éƒ¨è´¨é‡å¸¦æ¥çš„ç ´çª—æ•ˆåº”</h4>
<blockquote>
<p><strong>ç ´çª—åŸç†</strong></p>
<p>ä¸€æ‰‡ç ´æŸçš„çª—æˆ·ï¼Œåªè¦ä¸€æ®µæ—¶é—´ä¸å»ä¿®ç†ï¼Œå»ºç­‘ä¸­çš„å±…æ°‘å°±ä¼šæ½œç§»é»˜åŒ–åœ°äº§ç”Ÿä¸€ç§è¢«é—å¼ƒçš„æ„Ÿè§‰â€”â€”å½“æƒè€…ä¸å…³å¿ƒè¿™å¹¢å»ºç­‘çš„æ„Ÿè§‰ã€‚</p>
<p>ç„¶åï¼Œå…¶ä»–çš„çª—æˆ·ä¹Ÿå¼€å§‹æŸåï¼Œå±…æ°‘å¼€å§‹ä¹±ä¸¢åºŸç‰©ï¼Œå¢™ä¸Šå¼€å§‹å‡ºç°æ¶‚é¸¦ï¼Œå»ºç­‘å¼€å§‹å‡ºç°ä¸¥é‡çš„ç»“æ„æ€§æŸåã€‚</p>
<p>åœ¨çœ‹ä¸Šå»å¾ˆçŸ­çš„æ—¶é—´å†…ï¼Œå»ºç­‘çš„æŸåç¨‹åº¦å°±è¶³ä»¥æ‰“æ¶ˆä¸šä¸»ä»¬æƒ³ä¿®å¥½å®ƒçš„æœŸæœ›ï¼Œè¢«é—å¼ƒçš„æ„Ÿè§‰ç»ˆå˜æˆäº†ç°å®ã€‚</p>
</blockquote>
<p>åœ¨é¡¹ç›®å¯åŠ¨çš„åˆæœŸï¼Œé—ç•™åœ¨é¡¹ç›®ä¸­çš„é‚£äº›è¢«å¿½è§†çš„ <strong>å†…éƒ¨è´¨é‡</strong> é—®é¢˜ï¼Œå°±ä¼šåƒç ´çª—æ•ˆåº”ä¸€æ ·åœ¨åç»­çš„å¼€å‘ä¸­ä¸æ–­è”“å»¶ã€æ‰©æ•£ã€‚å¦‚æœä½å¤´çœ‹ä¸€ä¸‹é”®ç›˜å°±ä¼šå‘ç°ï¼Œæˆ‘ä»¬æ€»ä¼šä½¿ç”¨ï¼š<code>ctrl + c</code> å’Œ <code>ctrl +v</code>ï¼Œæ¯ä¸€æ¬¡è¿™æ ·çš„æ“ä½œï¼Œéƒ½æœ‰å¯èƒ½æ”¾å¤§é‚£äº›ä¹‹å‰è¢«å¿½è§†çš„ <strong>å†…éƒ¨è´¨é‡</strong> è€Œå¸¦æ¥çš„é—®é¢˜ã€‚</p>
<ul>
<li>åŸæ¥çš„ä»£ç å°±æ˜¯è¿™æ ·å†™çš„ï¼Œä¹‹å‰ä¹Ÿéƒ½æ²¡æœ‰é—®é¢˜ï¼Œä¸ºä»€ä¹ˆç°åœ¨ä¼šå‡ºé—®é¢˜å‘¢ï¼Ÿ</li>
<li>æˆ‘å°±æ˜¯å¤åˆ¶äº†åŸæ¥çš„ä»£ç è€Œå·²ï¼Ÿ</li>
<li>â€¦â€¦</li>
</ul>
<p>æ°¸è¿œä¸è¦æŒ‡æœ›ä¸€ä¸ªä¸€å¼€å§‹å°±å¿½è§† <strong>å†…éƒ¨è´¨é‡</strong> çš„é¡¹ç›®ï¼Œèƒ½å¤Ÿåœ¨é¡¹ç›®çš„åæœŸä¼šæœ‰è¾ƒå¥½çš„è´¨é‡å’Œè¿­ä»£æ•ˆç‡ï¼Œæˆ‘ä»æœªè§è¿‡è¿™æ ·çš„å¥‡è¿¹å‘ç”Ÿã€‚</p>
<h4 id="å¿½ç•¥å†…éƒ¨è´¨é‡-è¿œä¸æ­¢æˆæœ¬çš„å¢åŠ é‚£æ ·ç®€å•">å¿½ç•¥å†…éƒ¨è´¨é‡ï¼Œè¿œä¸æ­¢æˆæœ¬çš„å¢åŠ é‚£æ ·ç®€å•</h4>
<p>æˆ‘ä»¬å¤„åœ¨ä¸€ä¸ªâ€œæ•°å­—åŒ–ç”Ÿæ´»â€çš„æ—¶ä»£ï¼Œè½¯ä»¶å¯¹æˆ‘ä»¬æ—¥å¸¸ç”Ÿæ´»çš„å½±å“ä»æœªåƒç°åœ¨ä¸€æ ·å¦‚æ­¤å·¨å¤§ã€‚ä¾èµ–å¼ºå¤§çš„è½¯ä»¶å’Œç½‘ç»œï¼Œæ–°å‘ç”Ÿçš„äº‹æƒ…åœ¨æ•°åˆ†é’Ÿå†…å°±ä¼šè§¦è¾¾ä¸–ç•Œå„åœ°ã€‚æˆ‘ä»¬æ—¥å¸¸ç”Ÿæ´»çš„å„ä¸ªæ–¹é¢è¶Šæ¥è¶Šç¦»ä¸å¼€å„ç±»è½¯ä»¶å’Œç½‘ç»œçš„æ”¯æŒï¼Œæˆ‘ä»¬ç½‘ä¸Šè´­ç‰©ã€åœ¨çº¿æ”¯ä»˜ã€åˆ©ç”¨ç½‘ç»œæŸ¥è¯¢ä¿¡æ¯ã€å’Œå®¶äººäº’åŠ¨â€¦â€¦</p>
<p>å› æ­¤ï¼Œè½¯ä»¶å¸¦æ¥çš„é—®é¢˜å¯¹æˆ‘ä»¬ç”Ÿæ´»çš„å½±å“æ¯”ä»¥å¾€ä»»ä½•ä¸€ä¸ªæ—¶æœŸéƒ½è¦ä¸¥é‡ã€‚2021 å¹´ 8 æœˆ 30 æ—¥ï¼Œç‰¹æ–¯æ‹‰æ±½è½¦äº’è”ç½‘ç½‘ç»œå‡ºç°å®•æœºï¼Œå¯¼è‡´ Model3 è½¦ä¸»æ— æ³•å¼€å¯è½¦è¾†ã€‚å³ä¾¿æ˜¯è½¯ä»¶å¶å°”çš„å¼‚å¸¸æœ‰å¯èƒ½ä¼šå½±å“åˆ°æˆ‘ä»¬çš„å¿ƒæƒ…ç”šè‡³æ˜¯ç”Ÿæ´»çŠ¶æ€ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯¹è½¯ä»¶çš„å¯é æ€§çš„ç†è§£è¦æ¯”ä¹‹å‰æ›´è¿›ä¸€æ­¥ï¼Œè½¯ä»¶ N ä¸ª 9 çš„å¯é æ€§éš¾é“ä¸ä¼šäº§ç”Ÿå½±å“ç”¨æˆ·å¿ƒæƒ…ç”šè‡³æ˜¯ç”Ÿæ´»çŠ¶æ€çš„äº‹æƒ…äº†ï¼Ÿ</p>
<p>åœ¨æœ€å¼€å§‹å°±å¿½è§†äº† <strong>å†…éƒ¨è´¨é‡</strong> è€Œå¸¦æ¥çš„é—®é¢˜ï¼Œè¿œä¸åª Martin Fowler æ–‡ä¸­æ‰€è¯´çš„ä¼šå¢åŠ æœªæ¥çš„å˜é©æˆæœ¬é‚£æ ·ç®€å•ï¼Œä»–ä»¬è¿˜ä¼šå¯¹æˆ‘ä»¬çš„æ—¥å¸¸ç”Ÿæ´»å¸¦æ¥çƒ¦æ¼ã€‚</p>
<h2 id="èµ·æ­¥æ—¶å°±å…³æ³¨å†…éƒ¨è´¨é‡å§">èµ·æ­¥æ—¶å°±å…³æ³¨å†…éƒ¨è´¨é‡å§</h2>
<p>ä¸è¦å†è‡ªæ¬ºæ¬ºäººäº†ï¼Œä¸è¦åœ¨ä¸šåŠ¡çš„ä¸€å¼€å§‹å°±å»åš <strong>å†…éƒ¨è´¨é‡</strong> ä¸ <strong>æ•ˆç‡</strong> çš„æƒè¡¡ï¼Œè¿™æ ·ä¼šè®©æˆ‘ä»¬åœ¨ä¹‹åçš„ç ”å‘ä¸­æ ¹æœ¬æ²¡æœ‰æ—¶é—´å»æƒè¡¡ã€‚</p>
<p>åœ¨æ–°ä¸šåŠ¡çš„åˆæœŸï¼Œå°±åº”è¯¥èŠ±è´¹ä¸€å®šçš„æ—¶é—´æ¥å»ºè®¾é‚£äº›å¯ä»¥æé«˜è½¯ä»¶ <strong>å†…éƒ¨è´¨é‡</strong> çš„äº‹æƒ…ã€‚å¦åˆ™ï¼Œå½“æˆ‘ä»¬åœ¨å…¨åŠ›ä»¥èµ´å»åŠ é€Ÿå¥”è·‘çš„æ—¶å€™ï¼Œå°±éœ€è¦åœä¸‹è„šæ­¥æ¥å¤„ç†å› ä¸ºè¿™äº› <strong>å†…éƒ¨è´¨é‡</strong> è€Œå¸¦æ¥çš„é—®é¢˜ã€‚</p>
<p>åšé¥­æ—¶ï¼Œæˆ‘ä»¬è¦ä¸æ—¶çš„æ¸…ç†ç¶å°å’Œè®¾å¤‡ã€‚å› ä¸ºåšé¥­æ—¶å¿…ç„¶ä¼šå¼„è„ç¶å°å’Œè®¾å¤‡ï¼Œå¦‚æœä¸å¿«é€Ÿæ¸…æ´çš„è¯ï¼Œæ±¡å¢å°±ä¼šå˜å¹²ï¼Œä¼šå˜çš„æ›´éš¾å»é™¤ï¼Œè€Œæ‰€æœ‰çš„è„ä¸œè¥¿éƒ½ä¼šå¦¨ç¢ä¸‹ä¸€é“èœçš„çƒ¹é¥ªã€‚</p>
<h2 id="å…¶ä»–æ¡ˆä¾‹">å…¶ä»–æ¡ˆä¾‹</h2>
<p>åœ¨ <a href="https://mp.weixin.qq.com/s/VAxY0IRwvq0uzs_lJWhNiQ">é«˜æ‰‹çš„æˆ˜ç•¥</a> è¿™ç¯‡æ–‡ç« ä¸­ï¼Œä¹Ÿæåˆ°äº†å¾ˆå¤šä¸åŒè¡Œä¸šçš„æ¡ˆä¾‹ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨æ¥å‚è€ƒã€‚</p>
]]></content>
      <categories>
        <category>æ–‡åŒ–</category>
      </categories>
      <tags>
        <tag>æ–¹æ³•è®º</tag>
        <tag>è½¯ä»¶å¼€å‘</tag>
        <tag>è´¨é‡ä¸æˆæœ¬</tag>
      </tags>
  </entry>
  <entry>
    <title>ä¸ºä»€ä¹ˆ OpenCV è®¡ç®—çš„è§†é¢‘ FPS æ˜¯é”™çš„</title>
    <url>/2021/11/26/Why-OpenCV-Get-the-Wrong-FPS/</url>
    <content><![CDATA[<p><img src="/2021/11/26/Why-OpenCV-Get-the-Wrong-FPS/1.jpeg" alt></p>
<p>æˆ‘ä»¬æœ‰ä¸€ä¸ªå¹³å°æ¥å‘¨æœŸæ€§çš„å¯¹çº¿ä¸Šçš„ç›´æ’­æµæ•°æ®è¿›è¡ŒæŸäº›æ£€æµ‹ï¼Œä¾‹å¦‚é»‘/ç™½å±æ£€æµ‹ã€é™æ€ç”»é¢æ£€æµ‹â€¦â€¦åœ¨æ£€æµ‹ä¸­ï¼Œæˆ‘ä»¬ä¼šæ ¹æ®æå–åˆ°çš„ç›´æ’­æµçš„å¸§ç‡æ¥é¢„ä¼°è¦è®¡ç®—çš„å¸§æ•°é‡ï¼Œä¾‹å¦‚å¦‚æœè¦æ£€æµ‹ 5s çš„ç›´æ’­æµï¼Œè€Œè¯¥ç›´æ’­æµçš„å¸§ç‡ä¸º 20 fpsï¼Œéœ€è¦è®¡ç®—çš„å¸§æ•°é‡åˆ™ä¸º 100ã€‚å¿½ç„¶æœ‰ä¸€å¤©ï¼Œæˆ‘ä»¬å‘ç°ï¼Œå¹³å°å¼€å§‹å¤§é¢ç§¯çš„è¶…æ—¶ï¼Œä¹‹å‰åªéœ€è¦ 2s å°±èƒ½å®Œæˆçš„è®¡ç®—ï¼Œç°åœ¨å´éœ€è¦ 30+ åˆ†é’Ÿã€‚æŸ¥äº†ä¹‹åï¼Œæˆ‘ä»¬å‘ç°ï¼Œä¹‹æ‰€ä»¥è®¡ç®—è¶…æ—¶æ˜¯å› ä¸º OpenCV è®¡ç®—çš„å¸§ç‡ä¸º 2000ï¼Œä»è€Œå¯¼è‡´éœ€è¦è®¡ç®—çš„å¸§æ•°é‡ä»ä¹‹å‰çš„ 100 å˜ä¸ºäº† 10000ï¼Œè¿›è€Œå¼•èµ·äº†è®¡ç®—è¶…æ—¶ã€‚</p>
<span id="more"></span>
<h2 id="opencv-å¦‚ä½•è®¡ç®—å¸§ç‡">OpenCV å¦‚ä½•è®¡ç®—å¸§ç‡</h2>
<p>è¿™ä¸ªé—®é¢˜çš„å…·ä½“æè¿°å¯ä»¥å‚è§ <a href="https://github.com/opencv/opencv/issues/21006">OpenCV Issues 21006</a>ã€‚è¯¥é—®é¢˜çš„æ¨¡æ‹Ÿç›´æ’­æµç‰‡æ®µ test.ts å¯ä»¥ç‚¹å‡»<a href="https://pan.baidu.com/s/1RY0Zk5C_DOEwTXYe2SLFEg">é“¾æ¥</a>ä¸‹è½½ï¼Œä¸‹è½½æå–ç ä¸º x87mã€‚</p>
<p>å¦‚æœç”¨å¦‚ä¸‹çš„ä»£ç è·å– test.ts çš„ fpsï¼Œ</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> FPS = cap.<span class="built_in">get</span>(cv::CAP_PROP_FPS);</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;fps: &quot;</span> &lt;&lt; FPS &lt;&lt; std::endl;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥å¾—åˆ°ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> fps: 2000</span></span><br></pre></td></tr></table></figure>
<p>ç”¨ ffprobe å¯¹è§†é¢‘è¿›è¡Œåˆ†æï¼Œ</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> ffprobe -select_streams v -show_streams test.ts</span></span><br></pre></td></tr></table></figure>
<p>å¯ä»¥å¾—åˆ°ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">codec_name=h264</span><br><span class="line">r_frame_rate=30/1</span><br><span class="line">avg_frame_rate=0/0</span><br><span class="line">â€¦â€¦</span><br></pre></td></tr></table></figure>
<p>ä» <a href="https://github.com/opencv/opencv/blob/4.x/modules/videoio/src/cap_ffmpeg_impl.hpp">opencv/modules/videoio/src/cap_ffmpeg_impl.hpp</a> ä¸­ï¼Œæˆ‘ä»¬å‘ç° fps ç”± <code>CvCapture_FFMPEG::get_fps()</code> è®¡ç®—è€Œæ¥ï¼Œå…¶è®¡ç®—é€»è¾‘å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">double fps &#x3D; r2d(ic-&gt;streams[video_stream]-&gt;avg_frame_rate);</span><br><span class="line">if (fps &lt; eps_zero) &#123;</span><br><span class="line">    fps &#x3D; 1.0 &#x2F; r2d(ic-&gt;streams[video_stream]-&gt;codec-&gt;time_base);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ä¸ºä»€ä¹ˆ-opencv-å¾—åˆ°çš„å¸§ç‡æ˜¯é”™çš„">ä¸ºä»€ä¹ˆ OpenCV å¾—åˆ°çš„å¸§ç‡æ˜¯é”™çš„</h2>
<p>åˆ©ç”¨ <a href="https://github.com/wangwei1237/wangwei1237.github.io_src/blob/master/source/_posts/Why-OpenCV-Get-the-Wrong-FPS/test_time_base.cpp">test_time_base.cpp</a>ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">time_base: 1&#x2F;2000</span><br><span class="line">framerate: 0&#x2F;0</span><br><span class="line">avg_framerate: 0&#x2F;0</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">r2d(ic-&gt;streams[video_stream]-&gt;avg_frame_rate) &#x3D; 0</span><br></pre></td></tr></table></figure>
<p>æ‰€ä»¥ OpenCV é‡‡ç”¨äº† <a name="opencv-framerate"></a></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1.0 &#x2F; r2d(ic-&gt;streams[video_stream]-&gt;codec-&gt;time_base) </span><br></pre></td></tr></table></figure>
<p>æ¥è®¡ç®—è¯¥è§†é¢‘çš„ fpsã€‚è€Œæ­¤å¤„çš„ <strong>time_base = 1/2000</strong>ï¼Œå› æ­¤ï¼Œæœ€ç»ˆå¾—åˆ°çš„ fps æ˜¯ 2000ã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œ<strong>AVStream-&gt;codec-&gt;time_base</strong> çš„å€¼å¯¼è‡´äº† OpenCV å¾—åˆ°ä¸€ä¸ªçœ‹èµ·æ¥æ˜¯é”™è¯¯çš„ fpsã€‚é‚£ä¹ˆï¼Œ<strong>AVStream-&gt;codec-&gt;time_base</strong> ä¸ºä»€ä¹ˆæ˜¯è¿™ä¸ªæ•°å‘¢ï¼ŸFFmpeg æ˜¯æ€ä¹ˆè®¡ç®—è¿™ä¸ªå­—æ®µçš„å‘¢ï¼Ÿ</p>
<h2 id="ffmpeg-å¦‚ä½•è®¡ç®—-avcodeccontext-time-base">FFmpeg å¦‚ä½•è®¡ç®— AVCodecContext.time_base</h2>
<p><strong>AVStream-&gt;codec-&gt;time_base</strong> æ˜¯ <strong>AVCodecContext</strong> ä¸­å®šä¹‰çš„ <strong>time_base</strong> å­—æ®µï¼Œæ ¹æ® <a href="https://github.com/FFmpeg/FFmpeg/blob/master/libavcodec/avcodec.h">libavcodec/avcodec.h</a> ä¸­çš„å®šä¹‰ï¼Œè¯¥å­—æ®µçš„è§£é‡Šå¦‚ä¸‹ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * This is the fundamental unit of time (in seconds) in terms</span></span><br><span class="line"><span class="comment">  * of which frame timestamps are represented. For fixed-fps content,</span></span><br><span class="line"><span class="comment">  * timebase should be 1/framerate and timestamp increments should be</span></span><br><span class="line"><span class="comment">  * identically 1.</span></span><br><span class="line"><span class="comment">  * This often, but not always is the inverse of the frame rate or field rate</span></span><br><span class="line"><span class="comment">  * for video. 1/time_base is not the average frame rate if the frame rate is not</span></span><br><span class="line"><span class="comment">  * constant.</span></span><br><span class="line"><span class="comment">  *</span></span><br><span class="line"><span class="comment">  * Like containers, elementary streams also can store timestamps, 1/time_base</span></span><br><span class="line"><span class="comment">  * is the unit in which these timestamps are specified.</span></span><br><span class="line"><span class="comment">  * As example of such codec time base see ISO/IEC 14496-2:2001(E)</span></span><br><span class="line"><span class="comment">  * vop_time_increment_resolution and fixed_vop_rate</span></span><br><span class="line"><span class="comment">  * (fixed_vop_rate == 0 implies that it is different from the framerate)</span></span><br><span class="line"><span class="comment">  *</span></span><br><span class="line"><span class="comment">  * - encoding: MUST be set by user.</span></span><br><span class="line"><span class="comment">  * - decoding: the use of this field for decoding is deprecated.</span></span><br><span class="line"><span class="comment">  *             Use framerate instead.</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">AVRational time_base;</span><br></pre></td></tr></table></figure>
<p>ä»ä¸­å¯ä»¥çœ‹å‡ºï¼Œå¯¹äºè§£ç è€Œè¨€ï¼Œ<strong>time_base</strong> å·²ç»è¢«åºŸå¼ƒï¼Œéœ€è¦ä½¿ç”¨ <strong>framerate</strong> æ¥æ›¿æ¢ <strong>time_base</strong>ã€‚å¹¶ä¸”ï¼Œå¯¹äºå›ºå®šå¸§ç‡è€Œè¨€ï¼Œ<strong>time_base = 1/framerate</strong>ï¼Œä½†æ˜¯ï¼Œå¹¶éæ€»æ˜¯å¦‚æ­¤ã€‚</p>
<p>åˆ©ç”¨ <a href="https://github.com/shi-yan/H264Naked">H264Naked</a> å¯¹ test.ts å¯¹åº”çš„ H264 ç æµè¿›è¡Œåˆ†æï¼Œæˆ‘ä»¬å¾—åˆ° <a name="sps">SPS.Vui</a> ä¿¡æ¯ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">timing_info_present_flag :1</span><br><span class="line">num_units_in_tick :1</span><br><span class="line">time_scale :2000</span><br><span class="line">fixed_frame_rate_flag :0</span><br></pre></td></tr></table></figure>
<p>ä»ä¸­å¯ä»¥çœ‹åˆ°ï¼Œtest.ts æ˜¯éå›ºå®šå¸§ç‡è§†é¢‘ã€‚ä» <a href="https://github.com/wangwei1237/wangwei1237.github.io_src/blob/master/source/_posts/Why-OpenCV-Get-the-Wrong-FPS/test_time_base.cpp">test_time_base.cpp</a> çš„ç»“æœçœ‹ï¼Œtest.ts è§†é¢‘ä¸­ï¼Œ<strong>framerate = 0/0</strong>ï¼Œè€Œ <strong>time_base = 1/2000</strong>ã€‚</p>
<p>éš¾é“ï¼Œå¯¹äºéå›ºå®šå¸§ç‡è§†é¢‘è€Œè¨€ï¼Œ<strong>time_base</strong> å’Œ <strong>framerate</strong> ä¹‹é—´æ²¡æœ‰å…³è”ï¼Ÿå¦‚æœå­˜åœ¨å…³è”ï¼Œé‚£åˆæ˜¯æ€æ ·çš„è¿ç®—æ‰èƒ½äº§ç”Ÿè¿™ç§ç»“æœï¼Ÿè¿™ä¸ª <strong>time_base</strong> ç©¶ç«Ÿæ˜¯æ€ä¹ˆè®¡ç®—çš„å‘¢ï¼Ÿç©¶ç«Ÿå’Œ <strong>framerate</strong> æœ‰æ²¡æœ‰å…³ç³»å‘¢ï¼Ÿä¸€è¿ä¸²çš„é—®é¢˜éšä¹‹è€Œæ¥â€¦â€¦</p>
<p>æºç é¢å‰ï¼Œäº†æ— ç§˜å¯†ã€‚æ¥ä¸‹æ¥ï¼Œå¸¦ç€è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æ¥ä¸€èµ·åˆ†æä¸€ä¸‹ FFmpeg ç©¶ç«Ÿæ˜¯å¦‚ä½•å¤„ç† <strong>time_base</strong> çš„ã€‚</p>
<h2 id="avformat-find-stream-info">avformat_find_stream_info</h2>
<p>åœ¨ FFmpeg ä¸­ï¼Œ<code>avformat_find_stream_info()</code> ä¼šå¯¹ <strong>ic-&gt;streams[video_stream]-&gt;codec</strong> è¿›è¡Œåˆå§‹åŒ–ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä» <code>avformat_find_stream_info()</code> å¼€å§‹åˆ†æã€‚</p>
<p>ä» <a href="https://github.com/FFmpeg/FFmpeg/blob/master/libavformat/avformat.h">libavformat/avformat.h</a> ä¸­ï¼Œå¯ä»¥å¾—çŸ¥<code>avformat_open_input()</code>ä¼šæ‰“å¼€è§†é¢‘æµï¼Œä»ä¸­è¯»å–ç›¸å…³çš„ä¿¡æ¯ï¼Œç„¶åå­˜å‚¨åœ¨<code>AVFormatContext</code>ä¸­ï¼Œä½†æ˜¯æœ‰æ—¶å€™ï¼Œæ­¤å¤„è·å–çš„ä¿¡æ¯å¹¶ä¸å®Œæ•´ï¼Œå› æ­¤éœ€è¦è°ƒç”¨<code>avformat_find_stream_info()</code>æ¥è·å–æ›´å¤šçš„ä¿¡æ¯ã€‚</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">* @section lavf_decoding_open Opening a media file</span><br><span class="line">* The minimum information required to open a file is its URL, which</span><br><span class="line">* is passed to avformat_open_input(), as in the following code:</span><br><span class="line">* @code</span><br><span class="line">* <span class="keyword">const</span> <span class="keyword">char</span>    *url = <span class="string">&quot;file:in.mp3&quot;</span>;</span><br><span class="line">* AVFormatContext *s = <span class="literal">NULL</span>;</span><br><span class="line">* <span class="keyword">int</span> ret = avformat_open_input(&amp;s, url, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">* <span class="keyword">if</span> (ret &lt; <span class="number">0</span>)</span><br><span class="line">*     <span class="built_in">abort</span>();</span><br><span class="line">* @endcode</span><br><span class="line">* The above code attempts to allocate an AVFormatContext, open the</span><br><span class="line">* specified file (autodetecting the format) and read the header, exporting the</span><br><span class="line">* information stored there into s. Some formats <span class="keyword">do</span> <span class="keyword">not</span> have a header <span class="keyword">or</span> <span class="keyword">do</span> <span class="keyword">not</span></span><br><span class="line">* store enough information there, so it is recommended that you call the</span><br><span class="line">* avformat_find_stream_info() function which tries to read <span class="keyword">and</span> decode a few</span><br><span class="line">* frames to find missing information.</span><br></pre></td></tr></table></figure>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š<code>avformat_find_stream_info()</code> ä¼šå°è¯•é€šè¿‡è§£ç éƒ¨åˆ†è§†é¢‘å¸§æ¥è·å–éœ€è¦çš„ä¿¡æ¯ã€‚</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Read packets of a media file to get stream information. This</span></span><br><span class="line"><span class="comment"> * is useful for file formats with no headers such as MPEG. This</span></span><br><span class="line"><span class="comment"> * function also computes the real framerate in case of MPEG-2 repeat</span></span><br><span class="line"><span class="comment"> * frame mode.</span></span><br><span class="line"><span class="comment"> * The logical file position is not changed by this function;</span></span><br><span class="line"><span class="comment"> * examined packets may be buffered for later processing.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * @param ic media file handle</span></span><br><span class="line"><span class="comment"> * @param options  If non-NULL, an ic.nb_streams long array of pointers to</span></span><br><span class="line"><span class="comment"> *                 dictionaries, where i-th member contains options for</span></span><br><span class="line"><span class="comment"> *                 codec corresponding to i-th stream.</span></span><br><span class="line"><span class="comment"> *                 On return each dictionary will be filled with options that were not found.</span></span><br><span class="line"><span class="comment"> * @return &gt;=0 if OK, AVERROR_xxx on error</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * @note this function isn&#x27;t guaranteed to open all the codecs, so</span></span><br><span class="line"><span class="comment"> *       options being non-empty at return is a perfectly normal behavior.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * @todo Let the user decide somehow what information is needed so that</span></span><br><span class="line"><span class="comment"> *       we do not waste time getting stuff the user does not need.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">avformat_find_stream_info</span><span class="params">(AVFormatContext *ic, AVDictionary **options)</span></span>;</span><br></pre></td></tr></table></figure>
<p><code>avformat_find_stream_info()</code> çš„æ•´ä½“é€»è¾‘å¤§è‡´å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå…¶ä¸­ç‰¹åˆ«éœ€è¦å…³æ³¨å›¾ä¸­æ‰€ç¤ºçš„ 7 ä¸ªæ­¥éª¤ï¼š<br>
<img src="/2021/11/26/Why-OpenCV-Get-the-Wrong-FPS/2.png" alt></p>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition note"><p class="admonition-title">avformat_find_stream_info() çš„é‡è¦æ­¥éª¤è¯´æ˜
</p><ul>
<li><a name="step1"><strong>STEP 1</strong></a>. è®¾ç½®çº¿ç¨‹æ•°ï¼Œé¿å… H264 å¤šçº¿ç¨‹è§£ç æ—¶æ²¡æœ‰æŠŠ <strong>SPS/PPS</strong> ä¿¡æ¯æå–åˆ° <strong>extradata</strong>ã€‚</li>
<li><strong>STEP 2</strong>. è®¾ç½® <code>AVStream *st</code>ï¼Œ<strong>st</strong> ä¼šåœ¨åç»­çš„å‡½æ•°è°ƒç”¨ä¸­ä¸€ç›´é€åˆ° <code>try_decode_frame()</code>ã€‚</li>
<li><a name="step4"><strong>STEP 4</strong></a>. è®¾ç½® <code>AVCodecContext *avctx</code> ä¸ºé€ä¼ çš„ <strong>st-&gt;internal-&gt;avctx</strong>ï¼Œåœ¨åç»­çš„è§£ç å‡½æ•°è°ƒç”¨ä¸­ï¼Œä¸€ç›´é€ä¼ çš„å°±æ˜¯è¿™ä¸ª <strong>avctx</strong>ï¼Œå› æ­¤ï¼Œä»è¿™é‡Œå¼€å§‹çš„æ‰§è¡Œæµç¨‹ï¼ŒFFmpeg ä½¿ç”¨çš„å…¨éƒ¨éƒ½æ˜¯ <strong>st-&gt;internal-&gt;avctx</strong>ï¼Œè€Œä¸æ˜¯ <strong>st-&gt;codec</strong>ï¼Œè¿™é‡Œè¦ç‰¹åˆ«çš„æ³¨æ„ã€‚æ­¤å¤„åŒæ—¶ä¼šè®¾ç½®è§£ç çš„çº¿ç¨‹æ•°ï¼Œå…¶ç›®çš„å’Œ <a href="#step1">STEP 1</a>æ˜¯ä¸€è‡´çš„ã€‚</li>
<li><a name="step5"><strong>STEP 5</strong></a>. å› ä¸ºä¹‹å‰è®¾ç½®äº†è§£ç çº¿ç¨‹æ•°ä¸º 1ï¼Œå› æ­¤æ­¤å¤„ä¼šè°ƒç”¨
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">ret = avctx-&gt;codec-&gt;decode(avctx, frame, &amp;got_frame, pkt)</span><br></pre></td></tr></table></figure>
æ¥è§£ç å¹¶è®¡ç®— <strong>avctx-&gt;framerate</strong>ã€‚
æ³¨æ„ï¼Œæ­¤å¤„çš„ <strong>avctx</strong> å®é™…ä¸Šæ˜¯é€ä¼ è€Œæ¥çš„ <strong>st-&gt;internal-&gt;avctx</strong>ã€‚è®¡ç®— <strong>framerate</strong> çš„é€»è¾‘ä¼šåœ¨ <a href="#framerate">å¦‚ä½•è®¡ç®— framerate</a> ä»‹ç»ã€‚</li>
<li><a name="step6"><strong>STEP 6</strong></a>. æ ¹æ®è§£ç å™¨å¾—åˆ°çš„ <strong>framerate</strong> ä¿¡æ¯æ¥è®¡ç®— <strong>avctx-&gt;time_base</strong>ï¼Œæ³¨æ„æ­¤å¤„å®é™…ä¸Šæ˜¯ <strong>st-&gt;internal-&gt;avctx-&gt;time_base</strong>ã€‚
æ ¹æ® <a href="#framerate">ä¸‹æ–‡ framerate çš„è®¡ç®—</a> å¯çŸ¥ï¼Œæ­¤å¤„ <strong>framerate</strong> = {1000, 1}ã€‚
æ ¹æ® <a href="#ticks_per_frame">AVCodecContext.ticks_per_frame çš„ä»‹ç»</a> å¯çŸ¥ï¼Œ<strong>ticks_per_frame</strong> = 2ã€‚
å› æ­¤ï¼Œæ­¤å¤„ <strong>avctx-&gt;time_base</strong> = {1, 2000}ï¼š
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">avctx-&gt;time_base = av_inv_q(av_mul_q({1000, 1}, {2, 1})) = {1, 2000}</span><br></pre></td></tr></table></figure></li>
<li><a name="step7"><strong>STEP 7</strong></a>. è¿™ä¸€æ­¥å¯è°“æ˜¯â€œç’å¤©è¿‡æµ·ï¼Œæ˜ä¿®æ ˆé“æš—åº¦é™ˆä»“â€ï¼Œè¿™ä¸€æ­¥ä¸ºäº†è§£å†³ API çš„å‰å‘å…¼å®¹ï¼Œåšäº†ä¸€ä¸ªæ›¿æ¢ï¼ŒæŠŠ <strong>st-&gt;internal-&gt;avctx-&gt;time_base</strong> èµ‹å€¼ç»™äº† <strong>st-&gt;codec-&gt;time_base</strong>ï¼Œè€ŒæŠŠ <strong>st-&gt;avg_frame_rate</strong> èµ‹å€¼ç»™äº† <strong>st-&gt;codec-&gt;framerate</strong>ã€‚å› æ­¤ï¼š
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">st-&gt;codec-&gt;time_base = {1, 2000}</span><br><span class="line">st-&gt;codec-&gt;framerate = {0, 0}</span><br></pre></td></tr></table></figure>
<strong>st-&gt;codec-&gt;time_base</strong> çš„è®¡ç®—å’Œ <strong>st-&gt;codec-&gt;framerate</strong> ä¹‹é—´æ²¡æœ‰ä»»ä½•å…³ç³»ï¼Œè€Œæ˜¯å’Œ <strong>st-&gt;internal-&gt;avctx-&gt;framerate</strong> æœ‰å…³ã€‚æœ¬è´¨è€Œè¨€ï¼Œå’Œ <strong>sps.time_scale</strong>ï¼Œ<strong>sps.num_units_in_tick</strong> æœ‰å…³ã€‚
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">st-&gt;internal-&gt;avctx-&gt;time_base.num = sps-&gt;num_units_in_tick * </span><br><span class="line">    st-&gt;internal-&gt;avctx-&gt;ticks_per_frame</span><br><span class="line"></span><br><span class="line">st-&gt;internal-&gt;avctx-&gt;time_base.den = sps-&gt;time_scale * </span><br><span class="line">    st-&gt;internal-&gt;avctx-&gt;ticks_per_frame;</span><br><span class="line"></span><br><span class="line">st-&gt;internal-&gt;avctx-&gt;time_base = {sps-&gt;num_units_in_tick, sps-&gt;time_scale}</span><br></pre></td></tr></table></figure></li>
</ul>
</div>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition attention"><p class="admonition-title">internal->avctx->time_base & internal->framerate
</p><ul>
<li>æ‰€ä»¥å®é™…ä¸Šï¼Œ<strong>internal-&gt;avctx-&gt;time_base</strong> ä¸ºï¼š
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">avctx-&gt;time_base = sps-&gt;num_units_in_tick / sps-&gt;time_scale</span><br></pre></td></tr></table></figure></li>
<li>è€Œï¼Œ<strong>internal-&gt;avctx-&gt;framerate</strong> åˆ™æ˜¯ï¼š
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">avctx-&gt;framerate = sps-&gt;time_scale / (sps-&gt;num_units_in_tick * avctx-&gt;ticks_per_frame)</span><br></pre></td></tr></table></figure>
å› æ­¤ï¼Œå¯¹äº H264 ç æµè€Œè¨€ï¼Œ<strong>time_base = 1 / (2 * framerate)</strong>ï¼Œè€Œä¸æ˜¯ <strong>1 / framerate</strong>ã€‚</li>
</ul>
<p>è¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆ <a href="https://github.com/FFmpeg/FFmpeg/blob/master/libavcodec/avcodec.h">libavcodec/avcodec.h</a> ä¸­è¯´ï¼š</p>
<p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">* This often, but <span class="keyword">not</span> always is the inverse of the frame rate <span class="keyword">or</span> field rate</span><br><span class="line">* <span class="keyword">for</span> video.</span><br></pre></td></tr></table></figure></p>
<p>ä»å¦‚ä¸Šçš„åˆ†æå¯ä»¥çŸ¥é“ï¼š
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">avctx-&gt;framerate = <span class="number">1</span> / (avctx-&gt;time_base * avctx-&gt;ticks_per_frame)</span><br></pre></td></tr></table></figure>
å› æ­¤ï¼Œå½“ <strong>st-&gt;avg_frame_rate = 0</strong> æ—¶ï¼Œ<a href="#opencv-framerate">OpenCV è®¡ç®— fps çš„é€»è¾‘</a> æ˜¯é”™è¯¯çš„ã€‚</p>
<p>åœ¨ H265 ä¸­ï¼Œ<strong>ticks_per_frame = 1</strong>ï¼Œå› æ­¤å¯¹äº H265 çš„ç¼–ç ï¼ŒOpenCV æ˜¯æ²¡æœ‰è¿™ä¸ªé—®é¢˜çš„ã€‚å¯ä»¥ä½¿ç”¨ <a href="https://www.dektec.com/products/applications/Zond/">Zond 265</a> å·¥å…·æ¥åˆ†æä¸€ä¸ª H265 çš„è§†é¢‘ç æµï¼Œç„¶åå¯¹ç…§ OpenCV ä»¥åŠ FFmpeg çš„ç»“æœæ¥éªŒè¯ã€‚</p>
</div>
<p>åŒæ—¶ï¼Œæ­£æ˜¯å¦‚ä¸Šæ‰€ç¤ºçš„ <em><a href="#step7">STEP 7</a></em> ä¸­çš„ç§»èŠ±æ¥æœ¨å¯¼è‡´äº† <a href="https://github.com/wangwei1237/wangwei1237.github.io_src/blob/master/source/_posts/Why-OpenCV-Get-the-Wrong-FPS/test_time_base.cpp">test_time_base.cpp</a> çš„ç»“æœï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">st-&gt;codec-&gt;framerate: 0&#x2F;0</span><br><span class="line">st-&gt;codec-&gt;time_base: 1&#x2F;2000</span><br></pre></td></tr></table></figure>
<h2 id="ff-h264-decoder">ff_h264_decoder</h2>
<p><a href="https://github.com/FFmpeg/FFmpeg/blob/master/libavcodec/decode.c">libavcodec/decode.c</a> ä¸­çš„ <code>decode_simple_internal()</code> ä¸­ä¼šè°ƒç”¨å¯¹åº”çš„è§£ç å™¨æ¥è¿›è¡Œè§£ç ï¼ˆ<a href="#step5">STPE 5</a>ï¼‰ã€‚è€Œæ­£å¦‚å‰æ‰€ç¤ºï¼Œtest.ts ä¸º H264 ç¼–ç çš„è§†é¢‘æµï¼Œå› æ­¤ï¼Œæ­¤å¤„ä¼šè°ƒç”¨ H264 è§£ç å™¨æ¥è¿›è¡Œè§£ç ã€‚åœ¨ FFmpeg ä¸­ï¼ŒH264 è§£ç å™¨ä½äº <a href="https://github.com/FFmpeg/FFmpeg/blob/master/libavcodec/h264dec.c">libavcodec/h264dec.c</a> ä¸­å®šä¹‰çš„ <code>const AVCodec ff_h264_decoder</code>ã€‚</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> AVCodec ff_h264_decoder = &#123;</span><br><span class="line">    .name                  = <span class="string">&quot;h264&quot;</span>,</span><br><span class="line">    .type                  = AVMEDIA_TYPE_VIDEO,</span><br><span class="line">    .id                    = AV_CODEC_ID_H264,</span><br><span class="line">    .priv_data_size        = <span class="keyword">sizeof</span>(H264Context),</span><br><span class="line">    .init                  = h264_decode_init,</span><br><span class="line">    .close                 = h264_decode_end,</span><br><span class="line">    .decode                = h264_decode_frame,</span><br><span class="line">    ......</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>åœ¨ä¸Šæ–‡å›¾ä¸­çš„ <a href="#step5">STPE 5</a> ä¸­ï¼Œ</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">ret = avctx-&gt;codec-&gt;decode(avctx, frame, &amp;got_frame, pkt);</span><br></pre></td></tr></table></figure>
<p>å®é™…è°ƒç”¨çš„å°±æ˜¯</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ff_h264_decoder-&gt;h264_decode_frame(avctx, frame, &amp;got_frame, pkt);</span><br></pre></td></tr></table></figure>
<p>è€Œæ­¤å¤„çš„ <strong>avctx</strong> ä¹Ÿå°±æ˜¯ <code>try_decode_frame()</code> ä¸­çš„é€ä¼ ä¸‹æ¥çš„ <strong>st-&gt;internal-&gt;avctx</strong>ï¼Œå³ä¸Šæ–‡å›¾ä¸­çš„ <a href="#step4">STEP 4</a>ã€‚</p>
<h2 id="h264-decode-frame">h264_decode_frame</h2>
<p><code>h264_decode_frame()</code> çš„æ•´ä½“é€»è¾‘å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="/2021/11/26/Why-OpenCV-Get-the-Wrong-FPS/3.png" alt></p>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition note"><p class="admonition-title"><a name="ticks_per_frame">AVCodecContext.ticks_per_frame</a>
</p><p>åé¢ä¼šç”¨åˆ° <strong>ticks_per_frame</strong> æ¥è®¡ç®— <strong>framerate</strong>ã€‚åœ¨ <a href="#step6">STEP 6</a> ä¸­è®¡ç®— <strong>time_base</strong> çš„æ—¶å€™ä¹Ÿç”¨åˆ°äº†è¯¥å€¼ã€‚å› æ­¤ï¼Œæœ‰å¿…è¦åšä¸€ä¸‹ç‰¹æ®Šè¯´æ˜ã€‚
åœ¨ H264 è§£ç å™¨ä¸­ï¼Œ<strong>ticks_per_frame=2</strong>ï¼Œå…¶å…·ä½“çš„å–å€¼å¯ä»¥ä»å¦‚ä¸‹å‡ å¤„å¾—çŸ¥ï¼š</p>
<ul>
<li><a href="https://github.com/FFmpeg/FFmpeg/blob/master/libavcodec/avcodec.h">libavcodec/avcodec.h</a> ä¸­çš„å­—æ®µè¯´æ˜ï¼š
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * For some codecs, the time base is closer to the field rate than the frame rate.</span></span><br><span class="line"><span class="comment"> * Most notably, H.264 and MPEG-2 specify time_base as half of frame duration</span></span><br><span class="line"><span class="comment"> * if no telecine is used ...</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Set to time_base ticks per frame. Default 1, e.g., H.264/MPEG-2 set it to 2.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">int</span> ticks_per_frame;</span><br></pre></td></tr></table></figure></li>
<li><a href="https://github.com/FFmpeg/FFmpeg/blob/master/libavcodec/h264dec.c">libavcodec/h264dec.c</a> ä¸­çš„ <code>h264_decode_init()</code>ï¼š
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">avctx-&gt;ticks_per_frame = <span class="number">2</span>;</span><br></pre></td></tr></table></figure></li>
</ul>
</div>
<h2 id="å¦‚ä½•è®¡ç®—-framerate">å¦‚ä½•è®¡ç®— framerate</h2>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition note"><p class="admonition-title">å¦‚ä½•è®¡ç®— st->internal->avctx->framerate
</p><ul>
<li>STEP 1. æ ¹æ®æ•´ä½“çš„è®¡ç®—æµç¨‹å¯çŸ¥ï¼Œæ­¤å¤„çš„ <strong>h</strong> å®é™…ä¸Šå°±æ˜¯ <code>avformat_find_stream_info()</code> ä¸­çš„ <strong>st-&gt;internal-&gt;avctx-&gt;priv_data</strong>ã€‚<strong>h</strong> ä¼šä¸€ç›´é€ä¼ åˆ°ä¹‹åçš„æ‰€æœ‰æµç¨‹ï¼Œè¿™ä¸ªåŠ¡å¿…è¦æ³¨æ„ã€‚</li>
<li>STEP 2. æ­¤å¤„ä¼šé¦–å…ˆè·å–åˆ° <strong>sps</strong> çš„ç›¸å…³ä¿¡æ¯ï¼Œä»¥å¤‡åç»­çš„è®¡ç®—ä½¿ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥å†æ¬¡çœ‹ä¸€ä¸‹ <a href="#sps">test.ts sps</a> çš„ç›¸å…³ä¿¡æ¯ã€‚
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">timing_info_present_flag :1</span><br><span class="line">num_units_in_tick :1</span><br><span class="line">time_scale :2000</span><br><span class="line">fixed_frame_rate_flag :0</span><br></pre></td></tr></table></figure></li>
<li>STEP 3. æ ¹æ® <strong>sps</strong> çš„ç›¸å…³ä¿¡æ¯è®¡ç®— <strong>framerate</strong>ï¼Œåœ¨ä¸Šæ–‡çš„ <a href="#step6">STEP 6</a> ä¸­è®¡ç®— <strong>time_base</strong> ç”¨åˆ°çš„ <strong>framerate</strong> å°±æ˜¯åœ¨æ­¤å¤„è®¡ç®—çš„ã€‚å› ä¸º <strong>timing_info_present_flag = 1</strong>ï¼Œå› æ­¤ä¼šæ‰§è¡Œè®¡ç®— <a name="framerate"><code>framerate</code></a> çš„é€»è¾‘ï¼š
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">avctx-&gt;framerate.den = sps-&gt;num_units_in_tick * h-&gt;avctx-&gt;ticks_per_frame = <span class="number">1</span> * <span class="number">2</span> = <span class="number">2</span></span><br><span class="line">avctx-&gt;framerate.num = sps-&gt;time_scale = <span class="number">2000</span></span><br><span class="line">avctx-&gt;framerate = (AVRational){<span class="number">1000</span>, <span class="number">1</span>}</span><br></pre></td></tr></table></figure>
å› æ­¤ï¼Œ
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">st-&gt;internal-&gt;avctx-&gt;framerate = {<span class="number">1000</span>, <span class="number">1</span>}</span><br></pre></td></tr></table></figure></li>
</ul>
</div>
<h2 id="ç»“è®º">ç»“è®º</h2>
<p>é€šè¿‡å¦‚ä¸Šçš„åˆ†ææˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼š</p>
<ul>
<li>FFmpeg åœ¨è®¡ç®— <code>AVCodecContex</code> ä¸­çš„ <strong>framerate</strong> å’Œ <strong>time_base</strong> çš„æ—¶å€™ï¼Œä¼šç”¨åˆ°ï¼š
<ul>
<li><strong>sps.time_scale</strong></li>
<li><strong>sps.num_units_in_tick</strong></li>
<li><strong>AVCodecContex.ticks_per_frame</strong></li>
</ul>
</li>
<li>åœ¨ FFmpeg ä¸­ï¼Œ<strong>framerate</strong> å’Œ <strong>time_base</strong> çš„å…³ç³»ä¸ºï¼š
<ul>
<li><strong>framerate = 1 / (time_base * ticks_per_frame)</strong></li>
<li><strong>time_base = 1 / (framerate * ticks_per_frame)</strong></li>
</ul>
</li>
<li>å¯¹äºé H.264/MPEG-2ï¼Œ<strong>ticks_per_frame=1</strong>ï¼Œå› æ­¤ <strong>framerate</strong> å’Œ <strong>time_base</strong> æ˜¯äº’ä¸ºå€’æ•°çš„å…³ç³»ã€‚è€Œå¯¹äº H.264/MPEG-2 è€Œè¨€ï¼Œ<strong>ticks_per_frame=2</strong>ï¼Œå› æ­¤ï¼Œæ­¤æ—¶ï¼ŒäºŒè€…å¹¶éæ˜¯äº’ä¸ºå€’æ•°çš„å…³ç³»ã€‚å› æ­¤ï¼ŒFFmpeg ä¸­æ‰è¯´ï¼Œ<strong>framerate</strong> å’Œ <strong>time_base</strong> é€šå¸¸æ˜¯äº’ä¸ºå€’æ•°çš„å…³ç³»ï¼Œä½†å¹¶éæ€»æ˜¯å¦‚æ­¤ã€‚</li>
<li>åœ¨ OpenCV ä¸­ï¼Œå¯¹äº H.264/MPEG-2 è§†é¢‘è€Œè¨€ï¼Œå½“ <strong>AVStream.avg_frame_rate=0</strong> æ—¶ï¼Œå…¶è®¡ç®— fps çš„é€»è¾‘å­˜åœ¨ BUGã€‚</li>
<li>å› ä¸ºåœ¨è§£ç æ—¶ï¼Œ<strong>AVCodecContex.time_base</strong> å·²ç»åºŸå¼ƒï¼ŒåŒæ—¶ <strong>AVStream.avctx</strong> ä¹Ÿå·²ç»åºŸå¼ƒï¼Œè€Œ <code>avformat_find_stream_info()</code> ä¸­ä¸ºäº†å…¼å®¹è€çš„ APIï¼Œå› æ­¤ä¼šåˆ©ç”¨ <strong>AVStream.internal.avctx</strong> å’Œå…¶ä»–çš„ä¿¡æ¯æ¥è®¾ç½® <strong>AVStream.avctx</strong>ã€‚è€Œ <strong>AVStream.avctx.time_base</strong> å–è‡ª <strong>AVStream.internal.avctx</strong>ï¼Œ<strong>AVStream.avctx.framerate</strong> åˆ™å–è‡ª <strong>AVStream.framerate</strong>ã€‚</li>
</ul>
]]></content>
      <categories>
        <category>è§†é¢‘æŠ€æœ¯</category>
      </categories>
      <tags>
        <tag>FFmpeg</tag>
        <tag>OpenCV</tag>
        <tag>å¸§ç‡</tag>
      </tags>
  </entry>
  <entry>
    <title>LVS 2021 ä¼šè®®ç›¸å…³å†…å®¹æ•´ç†å’Œåˆ†æ</title>
    <url>/2021/11/11/Analysis-For-LVS-2021/</url>
    <content><![CDATA[<p><img src="/2021/11/11/Analysis-For-LVS-2021/LVS_2021.jpeg" alt></p>
<span id="more"></span>


	<div class="row">
    <embed src="LVS_2021.pdf" width="100%" height="550" type="application/pdf">
	</div>



]]></content>
      <categories>
        <category>è§†é¢‘æŠ€æœ¯</category>
      </categories>
      <tags>
        <tag>LVS 2021</tag>
        <tag>LiveVideoStack</tag>
      </tags>
  </entry>
  <entry>
    <title>Chromeæµè§ˆå™¨ä¸­çš„è§†é¢‘è§£ç ç¡¬ä»¶åŠ é€Ÿ</title>
    <url>/2021/10/22/Analysis-For-Hardware-Acceleration-Decoding-Of-Video-In-Chromium/</url>
    <content><![CDATA[<p><img src="/2021/10/22/Analysis-For-Hardware-Acceleration-Decoding-Of-Video-In-Chromium/1.png" alt></p>
<p>ä» <a href="https://en.wikipedia.org/wiki/Google_Chrome_version_history">Google Chrome version history</a> å¯ä»¥çŸ¥é“ï¼Œ2011 å¹´ 3 æœˆ å‘å¸ƒçš„ 10.0.648 ç‰ˆæœ¬çš„ Chrome æµè§ˆå™¨å°±å·²ç»æ”¯æŒè§†é¢‘çš„ç¡¬ä»¶åŠ é€Ÿèƒ½åŠ›ã€‚ä» <a href="https://www.reddit.com/r/linux/comments/l112mr/hardware_video_acceleration_now_available_in/">chromium/chrome 88 å¼€å§‹ï¼Œè§†é¢‘çš„ç¡¬ä»¶åŠ é€Ÿå·²ç»æˆä¸ºé»˜è®¤é…ç½®</a>ã€‚</p>
<p>å³ä¾¿å¦‚æ­¤ï¼Œå› ä¸ºè§†é¢‘çš„ç¡¬ä»¶è§£ç éœ€è¦ GPU çš„ç‰¹æ®Šæ”¯æŒï¼Œè€Œç›®å‰çš„è§†é¢‘ç¼–è§£ç æ ‡å‡†åˆæ¯”è¾ƒä¸°å¯Œï¼Œæˆ‘ä»¬å¦‚ä½•åˆ¤æ–­ Chrome åœ¨è§£ç è§†é¢‘çš„æ—¶å€™æ˜¯å¦å¯ç”¨äº†ç¡¬ä»¶åŠ é€Ÿå‘¢ï¼Ÿ</p>
<span id="more"></span>
<h2 id="1-chrome-gpu">1. chrome://gpu</h2>
<p>é¦–å…ˆï¼Œåˆ©ç”¨ <code>chrome://gpu</code> æ¥è·å–ç›¸å…³çš„ GPU ä¿¡æ¯ï¼Œè¿™é‡Œè·å–çš„ä¿¡æ¯éå¸¸ä¸°å¯Œï¼Œæˆ‘ä»¬å¯ä»¥ä»è¿™äº›ä¿¡æ¯ä¸­æ¥åˆ¤æ–­ Chrome æ˜¯å¦æ”¯æŒç‰¹å®šåœºæ™¯çš„ GPU åŠ é€Ÿã€‚</p>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition note"><p class="admonition-title">åœ¨è¿™éƒ¨åˆ†ä¿¡æ¯ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ç‰¹åˆ«å…³æ³¨å¦‚ä¸‹å‡ éƒ¨åˆ†çš„ä¿¡æ¯ï¼š
</p><ul>
<li>Graphics Feature Status</li>
<li>Driver Information</li>
<li>Display(s) Information</li>
<li>Video Acceleration Information</li>
</ul>
</div>
<h4 id="graphics-feature-status">Graphics Feature Status</h4>
<p><strong>Graphics Feature Status</strong> åæ˜ äº† GPU å¯¹ Chrome ä¸­çš„ä¸åŒçš„èƒ½åŠ›çš„æ”¯æŒï¼Œå¯¹äºæˆ‘çš„ MacBook Pro (13-inch, 2017) ä¸Šçš„ Chrome 94 è€Œè¨€ï¼Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹çš„ç»“æœï¼š</p>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition note"><p class="admonition-title">Graphics Feature Status
</p><ul>
<li>Canvas: Hardware accelerated</li>
<li>Compositing: Hardware accelerated</li>
<li>Metal: Disabled</li>
<li>Multiple Raster Threads: Enabled</li>
<li>Out-of-process Rasterization: Hardware accelerated</li>
<li>OpenGL: Enabled</li>
<li>Rasterization: Hardware accelerated</li>
<li>Skia Renderer: Enabled</li>
<li>Video Decode: Hardware accelerated</li>
<li>WebGL: Hardware accelerated</li>
<li>WebGL2: Hardware accelerated</li>
</ul>
</div>
<p>ä»ä¸­å¯ä»¥çœ‹å‡ºï¼Œå¯¹äº <strong>è§†é¢‘è§£ç </strong> è€Œè¨€ï¼ŒChrome å¯ç”¨äº† GPU çš„ç¡¬ä»¶åŠ é€Ÿã€‚å½“ç„¶æˆ‘ä»¬è¿˜èƒ½ä»å¦‚ä¸Šçš„ä¿¡æ¯ä¸­è·å–æ›´å¤šå†…å®¹ï¼Œä¾‹å¦‚ WebGL æ˜¯å¦æœ‰ GPU æ”¯æŒï¼ŒGPU çš„ç¡¬ä»¶åŠ é€Ÿæ˜¯é‡‡ç”¨çš„ <a href="https://www.opengl.org/">OpenGL</a> è¿˜æ˜¯ <a href="https://developer.apple.com/cn/metal/">Metal</a>ï¼Œâ€¦â€¦</p>
<h4 id="video-acceleration-information">Video Acceleration Information</h4>
<p><strong>Video Acceleration Information</strong> æ˜¾ç¤ºäº† Chrome æ”¯æŒçš„ç¡¬ä»¶ç¼–è§£ç çš„ç¼–è§£ç å™¨ç±»å‹ä»¥åŠç›¸å…³ç¼–è§£ç å™¨çš„ profileã€‚ä»ä¸­æˆ‘ä»¬å¯ä»¥åˆ¤æ–­ï¼Œå¯¹äºæŸç§ç¼–è§£ç å™¨è€Œè¨€ï¼ŒChrome æ˜¯å¦æ”¯æŒç¡¬ç¼–è§£ç ã€‚è¯¥ä¿¡æ¯å¤§è‡´å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Decoding(VideoDecoder)</td>
<td></td>
</tr>
<tr>
<td>Decode h264 baseline</td>
<td>16x16 to 4096x4096 pixels</td>
</tr>
<tr>
<td>â€¦â€¦</td>
<td>â€¦â€¦</td>
</tr>
<tr>
<td>Encoding</td>
<td></td>
</tr>
<tr>
<td>Encode h264 baseline</td>
<td>0x0 to 4096x2160 pixels, and/or 30.000 fps</td>
</tr>
<tr>
<td>â€¦â€¦</td>
<td>â€¦â€¦</td>
</tr>
</tbody>
</table>
<h2 id="2-chrome-flags">2. chrome://flags</h2>
<p>æ ¹æ® <code>chrome://gpu</code> æä¾›çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥åˆ¤æ–­æˆ‘ä»¬æ‰€ä½¿ç”¨çš„ Chrome åœ¨è§†é¢‘ç¼–è§£ç æ—¶çš„ç¡¬ä»¶æ”¯æŒèƒ½åŠ›ã€‚ä½†æ˜¯ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå…·å¤‡ç¡¬ä»¶ç¼–è§£ç èƒ½åŠ›ï¼Œä¸ä»£è¡¨ Chrome å°±å¯ä»¥ç¡¬ä»¶ç¼–è§£ç ã€‚å¦‚æœæ²¡æœ‰å¼€å¯è¿™äº›èƒ½åŠ›ï¼Œè‡ªç„¶æ˜¯æ— æ³•åˆ©ç”¨ Chrome æä¾›çš„è¿™äº›èƒ½åŠ›çš„ã€‚</p>
<p>å› æ­¤ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥éœ€è¦åˆ¤æ–­ï¼ŒChrome æ˜¯å¦å¼€å¯äº†ç¡¬ä»¶ç¼–è§£ç åŠ é€Ÿçš„èƒ½åŠ›ï¼Œæ­¤æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>chrome://flags</code> æ¥è·å–æˆ‘ä»¬éœ€è¦çš„ä¿¡æ¯ã€‚</p>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition note"><p class="admonition-title">chrome://flags
</p><p><a href="https://beebom.com/chrome-flags-guide-to-enhance-web-browsing/"><strong>chrome://flags</strong> æ˜¯ä¸€ç»„å®éªŒæ€§åŠŸèƒ½å’Œè®¾ç½®</a>ï¼Œå®ƒä»¬éšè—åœ¨ Chrome ä¸­ï¼Œä¾›å¼€å‘äººå‘˜ä½¿ç”¨ã€‚è¿™äº›å®éªŒæ€§åŠŸèƒ½åŒ…æ‹¬ Google æ­£åœ¨å¼€å‘ã€ä½†å°šæœªä¸ºæ™®é€šç”¨æˆ·å¯ç”¨çš„åŠŸèƒ½ã€‚<strong>chrome://flags</strong> å¯ä»¥æå‡æˆ‘ä»¬çš„æµè§ˆä½“éªŒï¼Œè¿˜å¯ä»¥è®©æˆ‘ä»¬ä½¿ç”¨é‚£äº›æ–°çš„ã€å¼€å‘ä¸­çš„åŠŸèƒ½ã€‚</p>
</div>
<p>åœ¨ <strong>chrome://flags</strong> ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°å¦‚ä¸‹çš„ä¿¡æ¯ï¼š</p>
<p><img src="/2021/10/22/Analysis-For-Hardware-Acceleration-Decoding-Of-Video-In-Chromium/2.png" alt></p>
<p>ä»å›¾ä¸­çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œå¯¹äºå½“å‰çš„ Chrome æµè§ˆå™¨è€Œè¨€ï¼ŒChrome å¼€å¯äº†è§†é¢‘çš„ç¼–è§£ç ç¡¬ä»¶åŠ é€Ÿèƒ½åŠ›ã€‚</p>
<h2 id="3-chrome-media-internals">3. chrome://media-internals</h2>
<p>å¦‚ä¸Šæ‰€è¿°ï¼Œå¯¹äºæ’­æ”¾çš„è§†é¢‘ï¼Œæ ¹æ®è§†é¢‘å±æ€§ä»¥åŠ <code>chrome://gpu</code> å’Œ <code>chrome://flags</code> æä¾›çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥å¤§è‡´åˆ¤æ–­å‡ºåœ¨æ’­æ”¾è¯¥è§†é¢‘æ—¶ï¼ŒChrome æ˜¯å¦ä½¿ç”¨äº†ç¡¬ä»¶è§£ç ã€‚</p>
<p>ä½†æ˜¯ï¼Œæˆ‘ä»¬è¦æ—¶åˆ»æé†’è‡ªå·±ï¼Œç›®å‰ä¸ºæ­¢æˆ‘ä»¬çš„åˆ¤æ–­è¿˜ä»…ä»…æ˜¯ä¸€ç§çŒœæµ‹è€Œè¨€ï¼Œè¦æƒ³ç¡®åˆ‡çš„åˆ¤æ–­ Chrome æ˜¯å¦ä½¿ç”¨äº†ç¡¬ä»¶è§£ç ï¼Œå°±éœ€è¦è·å– Chrome æ’­æ”¾è§†é¢‘æ—¶ä½¿ç”¨çš„è§£ç å™¨ã€‚æ­¤æ—¶ï¼Œå°±è¯¥ç”¨åˆ° <code>chrome://media-internals</code> å·¥å…·å•¦ã€‚</p>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition note"><p class="admonition-title">chrome://media-internals 
</p><p><a href="https://www.chromium.org/audio-video/media-internals"><strong>chrome://media-internals</strong></a> æ˜¯ä¸€ä¸ªç ”ç©¶ Chrome éŸ³é¢‘/è§†é¢‘å†…éƒ¨å †æ ˆç»“æ„çš„å·¥å…·ã€‚ç›®å‰ï¼Œ<strong>chrome://media-internals</strong> å¯ä»¥æ˜¾ç¤ºå¦‚ä¸‹ä¿¡æ¯ï¼š</p>
<ul>
<li>ä»åª’ä½“å †æ ˆä¸­æŒ–æ˜æœ‰å…³æ­£åœ¨ä½¿ç”¨çš„åª’ä½“æ’­æ”¾å™¨çš„æ‰€æœ‰å†…å®¹ï¼ŒåŒ…æ‹¬å·²ç¼“å†²æ•°æ®ã€è§†é¢‘å±æ€§ã€äº‹ä»¶ä¹‹é—´çš„æµ‹é‡æ—¶é—´å’Œäº‹ä»¶æ—¥å¿—ã€‚</li>
<li>å½“å‰éŸ³é¢‘æµçš„çŠ¶æ€å’ŒéŸ³é‡ï¼Œè¿™äº›ä¿¡æ¯ä¸ä¼šä¸ç‰¹å®šçš„ tab å…³è”ã€‚</li>
<li>ç¼“å­˜æ´»åŠ¨ä¿¡æ¯ï¼ŒåŒ…æ‹¬å¯¹åª’ä½“ç¼“å­˜çš„è¯»å–å’Œå†™å…¥ã€‚</li>
</ul>
</div>
<p>æˆ‘ä»¬å¯ä»¥ç”¨ Chrome æµè§ˆå™¨æ’­æ”¾ <a href="https://www.bilibili.com/video/BV1jh411n7d7?spm_id_from=333.6.0.0">B ç«™è§†é¢‘ä¸Šçš„è§†é¢‘</a>ï¼Œç„¶åä½¿ç”¨ <strong>chrome://media-internals</strong> å·¥å…·è¿›è¡Œåˆ†æï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="/2021/10/22/Analysis-For-Hardware-Acceleration-Decoding-Of-Video-In-Chromium/3.png" alt></p>
<p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œåª’ä½“æ’­æ”¾å™¨çš„æ‰€æœ‰ä¿¡æ¯éƒ½ä¼šä»¥åˆ—è¡¨çš„å½¢å¼å±•ç°ï¼ŒåŒæ—¶åˆ—è¡¨ä¸­çš„æ¯ä¸€é¡¹éƒ½ä¼šå±•ç°è¯¥é¡¹å¯¹åº”çš„æ’­æ”¾çŠ¶æ€ã€‚å› ä¸ºè§†é¢‘æ­£åœ¨æ’­æ”¾ä¸­ï¼Œå› æ­¤æˆ‘ä»¬é€‰æ‹©çŠ¶æ€ä¸º <code>kPlay</code> çš„é¡¹ç›®æ¥æŸ¥çœ‹å¯¹åº”çš„åª’ä½“æ’­æ”¾å™¨çš„ä¿¡æ¯ã€‚<strong>Player Properties</strong> ä¿¡æ¯å±•ç¤ºäº†åª’ä½“æ’­æ”¾å™¨çš„è¯¦ç»†å±æ€§ï¼Œä¾‹å¦‚ï¼š</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>â€¦â€¦</td>
<td>â€¦â€¦</td>
</tr>
<tr>
<td>kVideoDecoderName</td>
<td>VDAVideoDecoder</td>
</tr>
<tr>
<td>kVideoTracks</td>
<td>[{â€œalpha modeâ€:â€œis_opaqueâ€,â€œcodecâ€:â€œh264â€,â€œcoded sizeâ€:â€œ1920x1080â€,â€œcolor spaceâ€:&quot;{primaries:BT709, transfer:BT709, matrix:BT709, range:LIMITED}&quot;,â€œencryption schemeâ€:â€œUnencryptedâ€,â€œhas extra dataâ€:false,â€œhdr metadataâ€:â€œunsetâ€,â€œnatural sizeâ€:â€œ1920x1080â€,â€œorientationâ€:â€œ0Â°â€,â€œprofileâ€:â€œh264 highâ€,â€œvisible rectâ€:â€œ0,0 1920x1080â€}]</td>
</tr>
</tbody>
</table>
<p>æ ¹æ® <a href="https://chromium.googlesource.com/chromium/src/+/39e7de240b63c0103078624d09130c4a990920d2/media/gpu/ipc/service/vda_video_decoder.h">VDAVideoDecoder</a> çš„æºç å¯ä»¥çŸ¥é“ï¼ŒVDAVideoDecoder è§£ç å™¨æ˜¯é€šè¿‡ MojoVideoDecoder è€Œè¿è¡Œäº GPUï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç¡®å®šï¼Œè¯¥ h264 ç¼–ç çš„è§†é¢‘åœ¨æ’­æ”¾æ—¶ä½¿ç”¨çš„æ˜¯ç¡¬ä»¶è§£ç ã€‚</p>
<p>ä½¿ç”¨ Chrome æ’­æ”¾ä¸€ä¸ª 8K è§†é¢‘ï¼Œç„¶åä½¿ç”¨ <strong>chrome://media-internals</strong> å·¥å…·è¿›è¡Œåˆ†æï¼Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯ï¼š</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>â€¦â€¦</td>
<td>â€¦â€¦</td>
</tr>
<tr>
<td>kVideoDecoderName</td>
<td>Dav1dVideoDecoder</td>
</tr>
<tr>
<td>kVideoTracks</td>
<td>[{â€œalpha modeâ€:â€œis_opaqueâ€,â€œcodecâ€:â€œav1â€,â€œcoded sizeâ€:â€œ7680x4320â€,â€œcolor spaceâ€:&quot;{primaries:BT709, transfer:BT709, matrix:BT709, range:LIMITED}&quot;,â€œencryption schemeâ€:â€œUnencryptedâ€,â€œhas extra dataâ€:false,â€œhdr metadataâ€:â€œunsetâ€,â€œnatural sizeâ€:â€œ7680x4320â€,â€œorientationâ€:â€œ0Â°â€,â€œprofileâ€:â€œav1 profile mainâ€,â€œvisible rectâ€:â€œ0,0 7680x4320â€}]</td>
</tr>
</tbody>
</table>
<p><a href="https://www.videolan.org/projects/dav1d.html">dav1d è§£ç å™¨</a> æ˜¯ä¸€ä¸ªè·¨å¹³å°çš„å¼€æº AV1 è§£ç å™¨ï¼Œå› æ­¤ï¼Œå¯¹äºè¯¥ 8K è§†é¢‘è€Œè¨€ï¼ŒChrome åœ¨æ’­æ”¾æ—¶ä½¿ç”¨çš„æ˜¯ CPU è§£ç ã€‚</p>
]]></content>
      <categories>
        <category>è§†é¢‘æŠ€æœ¯</category>
      </categories>
      <tags>
        <tag>ç¡¬ä»¶åŠ é€Ÿ</tag>
        <tag>GPU</tag>
        <tag>Chrome Video Decode</tag>
      </tags>
  </entry>
  <entry>
    <title>åœ¨è§£å†³é—®é¢˜ä¹‹å‰é¦–å…ˆè¦æ­£ç¡®çš„å®šä¹‰é—®é¢˜</title>
    <url>/2021/09/16/Define-The-Problem-Rightly-Before-Solve-It/</url>
    <content><![CDATA[<p>å¤šå¹´ä»¥å‰ï¼Œæˆ‘é˜…è¯»äº†ä¸€æœ¬è‡³ä»Šéƒ½è®©æˆ‘å—ç›ŠåŒªæµ…çš„ä¹¦ï¼šã€Šä½ çš„ç¯äº®ç€å—ï¼Ÿã€‹ã€‚å·¥ä½œä¸­ï¼Œæˆ‘æ€»ä¼šæŒ‰ç…§ä¹¦ä¸­çš„å†…å®¹æ¥è®­ç»ƒè‡ªå·±è§£å†³å·¥ä½œä¸­é‡åˆ°çš„é—®é¢˜ã€‚ä½œä¸ºä¸€åæµ‹è¯•å¼€å‘å·¥ç¨‹å¸ˆï¼Œåœ¨å®šä½ BUG æ—¶ï¼Œæˆ‘ä¹Ÿä¼šç”¨åˆ°è¯¥ä¹¦ä¸­ä»‹ç»çš„é—®é¢˜è§£å†³æ€ç»´æ¨¡å¼ã€‚</p>
<div class="douban-card-block">
	<a class="douban-card" href="https://book.douban.com/subject/1135754">
		<div class="douban-card-bgimg" style="background-image: url('https://images.weserv.nl/?url=https://img9.doubanio.com/view/subject/s/public/s1104704.jpg');"></div>
		<div class="douban-card-left">
			<div class="douban-card-img" style="background-image: url('https://images.weserv.nl/?url=https://img9.doubanio.com/view/subject/s/public/s1104704.jpg');"></div>
		</div>
		<div class="douban-card-right" style="line-height: 1.7;">
			<div class="douban-card-item"><span>ä¹¦å: </span><strong>ä½ çš„ç¯äº®ç€å—?</strong></div>
			<div class="douban-card-item"><span>ä½œè€…: </span><span>å”çº³å¾·ãƒ»é«˜æ–¯</span></div>
			<div class="douban-card-item"><span>å‡ºç‰ˆå¹´ä»½: </span><span>2003-1</span></div>
			<div class="douban-card-item"><span>è¯„åˆ†: </span><span>8.0</span></div>
		</div>
	</a>
</div>
<style>
	.douban-card-block {
		display: flex;
		justify-content: center;
		align-items: center;
		width: 100%;
		max-height: 400px;
	}
	.douban-card {
		display: flex;
		margin: 30px 10px;
		padding: 15px;
		border-radius: 10px;
		position: relative;
		justify-content: center;
		align-items: center;
		overflow: hidden;
		color: antiquewhite;
		text-decoration: none;
	}
	.douban-card:hover {
		text-decoration: none;
	}
	.douban-card-bgimg {
		position: absolute;
		width: 115%;
		height: 115%;
		filter: blur(15px) brightness(0.6);
		background-size: 100%;
		background-position: center;
		background-repeat: no-repeat;
	}
	.douban-card-img {
		position: relative;
		height: 130px;
		width: 80px;
		background-size: 100%;
		background-position: center;
		background-repeat: no-repeat;
	}
	.douban-card-img {
		position: relative;
		height: 130px;
		width: 80px;
	}
	.douban-card-left {
		position: relative;
		display: flex;
		flex-direction: column;
		align-items: center;
	}
	.douban-card-right {
		position: relative;
		display: flex;
		flex-direction: column;
		margin-left: 12px;
		font-size: 16px;
		font-family: 'Courier New', Courier, monospace;
		line-height: 1.3;
		color: antiquewhite;
	}
	.douban-card-item {
		margin-top: 4px;
	}
</style>
<p>åœ¨è¿™æœ¬ä¹¦çš„ç¬¬ä¸€ç« ã€Œè¿™æ˜¯è°çš„é—®é¢˜ã€ä¸­æåˆ°ï¼š</p>
<blockquote>
<p>åˆå‡ºèŒ…åºçš„é—®é¢˜è§£å†³è€…æ€»æ˜¯åœ¨è¿˜æ²¡æœ‰å®šä¹‰å¥½é—®é¢˜çš„æ—¶å€™å°±ä»“ä¿ƒçš„ç»™å‡ºè§£å†³æ–¹æ¡ˆã€‚è¿«äºå¤–ç•Œç¯å¢ƒçš„å‹åŠ›ï¼Œç»éªŒä¸°å¯Œçš„é—®é¢˜è§£å†³è€…æœ‰æ—¶ä¹Ÿè€ä¸ä½æ€§å­ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå°½ç®¡ä»–ä»¬èƒ½æ‰¾åˆ°å¾ˆå¤šæ–¹æ³•æ¥è§£å†³é—®é¢˜ï¼Œä½†æ˜¯ä¸ä¸€å®šå¯¹ç—‡ã€‚</p>
</blockquote>
<p>æˆ‘ä»¬ä¸€ç›´åœ¨å­œå­œä¸å€¦çš„è¿½æ±‚è§£å†³é—®é¢˜çš„æ–¹æ³•ã€ç­–ç•¥ã€å¦™æ‹›ï¼Œå´ä»æ¥æ²¡æœ‰ä»”ç»†æƒ³è¿‡ï¼Œé—®é¢˜ç©¶ç«Ÿæ˜¯ä»€ä¹ˆï¼Ÿ</p>
<span id="more"></span>
<h2 id="ç¼˜èµ·">ç¼˜èµ·</h2>
<p>å·¥ä½œä¸­ï¼Œç»å¸¸ä¼šè‡ªå·±å®šä½æˆ–è€…å¸®åŠ©åŒäº‹å®šä½å„ç§å„æ ·çš„ BUGã€‚æœ‰æ—¶å€™ï¼ŒBUG ä¼šæ¯”è¾ƒç®€å•ï¼Œè€Œæœ‰æ—¶å€™é‡åˆ°çš„ BUG åˆ™ç›¸å¯¹å¤æ‚ã€‚åœ¨å¸®åŠ©åŒäº‹å®šä½ BUG çš„æ—¶å€™ï¼Œç»å¸¸ä¼šé‡åˆ°åŒäº‹æè¿°çš„é—®é¢˜å’Œæœ€åå®é™…å®šä½ä¹‹åçš„é—®é¢˜å¹¶ä¸ä¸€è‡´çš„æƒ…å†µã€‚</p>
<p>åœ¨é—®é¢˜å®šä½ä¸­ï¼Œæˆ‘ä»¬è¦ï¼šå¤§èƒ†å‡è®¾ï¼Œå°å¿ƒæ±‚è¯ã€‚ä½†æ˜¯ï¼Œæˆ‘å‘ç°ï¼Œå¥½å¤šäººåªåšåˆ°äº†å¤§èƒ†å‡è®¾ï¼Œåœ¨å®šä½ BUG æ—¶ï¼Œå¤§èƒ†å‡è®¾äº†ä¸€ä¸ªé—®é¢˜ï¼Œç„¶ååœ¨å®šä½è¿‡ç¨‹ä¸­å°±æŠŠè¿™ä¸ªå¤§èƒ†å‡è®¾çš„é—®é¢˜å½“æˆäº†çœŸæ­£çš„é—®é¢˜ï¼Œç»“æœå°±æ˜¯åœ¨å®šä½ BUG çš„é“è·¯ä¸Šè¶Šèµ°è¶Šè¿·ç³Šâ€¦â€¦</p>
<p>æ¯æ¬¡è¯´åˆ°è¿™ä¸ªçš„æ—¶å€™ï¼Œå¤§å®¶æ™®éåé¦ˆï¼šé“ç†æ˜¯è¿™ä¸ªé“ç†ï¼Œç†è®ºæˆ‘ä»¬ä¹Ÿéƒ½æ‡‚å‘€ï¼Œä½†æ˜¯å°±æ˜¯åšä¸åˆ°å‘€ï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿ</p>
<p>â€œé‰´äºå¾€äº‹ï¼Œæœ‰èµ„äºæ²»é“â€ã€‚</p>
<p>ä¸ºäº†èƒ½å¤Ÿè®©å¤§å®¶æœ‰æ¯”è¾ƒçœŸå®çš„ä½“éªŒï¼Œæˆ‘å‡†å¤‡å°†è‡ªå·±å·¥ä½œä¸­é‡åˆ°çš„ç±»ä¼¼çš„é—®é¢˜è¿›è¡Œæ¢³ç†ã€‚åœ¨æ¢³ç†çš„è¿‡ç¨‹ä¸­ï¼Œç”±äºå„ç§åŸå› ï¼Œæˆ‘æ— æ³•å°†åŸå§‹é—®é¢˜æ¶‰åŠåˆ°çš„å†…å®¹åŸæ ·å‘ˆç°ï¼Œæˆ‘éœ€è¦å¯¹åŸå§‹çš„é—®é¢˜è¿›è¡Œä¸€å®šçš„æŠ½è±¡ã€‚ä½†æ˜¯ï¼Œå¯¹é—®é¢˜æŠ½è±¡å¹¶ä¸ä¼šå¯¹é—®é¢˜çš„åŸè²Œå’Œæœ¬è´¨è¿›è¡Œä¿®æ”¹ï¼Œå¹¶åŠ›æ±‚åšåˆ°å°½é‡ä¿è¯é—®é¢˜çš„åŸæ ·å‘ˆç°ã€‚</p>
<h2 id="1-ä¸ºä»€ä¹ˆå®¹å™¨ä¸èƒ½æš´éœ²æœåŠ¡çš„uriå‘¢ï¼Ÿ">1. ä¸ºä»€ä¹ˆå®¹å™¨ä¸èƒ½æš´éœ²æœåŠ¡çš„URIå‘¢ï¼Ÿ</h2>
<h4 id="é—®é¢˜èƒŒæ™¯">é—®é¢˜èƒŒæ™¯</h4>
<p>æˆ‘ä»¬çš„ CI/CD æœåŠ¡ç±»ä¼¼ <a href="https://docs.github.com/en/actions">GitHub Actions</a>ï¼Œå½“ç„¶å’Œ GitHub Actions çš„å·®å¼‚éå¸¸å¤§ï¼ˆä¾‹å¦‚æ•´ä¸ªä»»åŠ¡çš„ç¼–æ’æœºåˆ¶ã€å®¹å™¨çš„åº•å±‚æœºåˆ¶ã€å®¹å™¨çš„æ‰˜ç®¡æœºåˆ¶â€¦â€¦ï¼‰ï¼Œä½†æ˜¯ä½¿ç”¨èµ·æ¥æ˜¯ç±»ä¼¼çš„ã€‚</p>
<p><img src="/2021/09/16/Define-The-Problem-Rightly-Before-Solve-It/actions-workflow.svg" alt></p>
<p>æ¯å½“æœ‰å¯¹åº”çš„äº‹ä»¶å‘ç”Ÿæ—¶ï¼ˆä¾‹å¦‚ä»£ç æäº¤ã€ä»£ç åˆå¹¶ç­‰ï¼‰ï¼Œå°±ä¼šè§¦å‘ä¸€äº›åˆ—çš„è‡ªåŠ¨åŒ–ä»»åŠ¡ï¼Œä¾‹å¦‚ä»£ç ç¼–è¯‘ã€ä»£ç æ‰«æã€è¿è¡Œå•å…ƒæµ‹è¯•â€¦â€¦ã€‚åœ¨æ‰§è¡Œè¿™äº›è‡ªåŠ¨åŒ–ä»»åŠ¡çš„æ—¶å€™ï¼Œä¼šé¦–å…ˆåˆ†é…ä¸€ä¸ªå®¹å™¨ï¼ˆç±»ä¼¼ <a href="https://docs.github.com/en/actions/using-github-hosted-runners/about-github-hosted-runners">GitHub-hosted runners</a>ï¼‰ï¼Œç„¶ååœ¨è¯¥å®¹å™¨ä¸­æ‰§è¡Œåœ¨å¹³å°ä¸Šé…ç½®å¥½çš„ä»»åŠ¡ã€‚</p>
<p><img src="/2021/09/16/Define-The-Problem-Rightly-Before-Solve-It/workflow.gif" alt></p>
<p>æœ‰ä¸€å¤©ï¼Œæˆ‘ä»¬å›¢é˜Ÿéœ€è¦ä¸€ä¸ªåŠŸèƒ½ï¼š<strong>å¼€æ”¾å®¹å™¨ä¸­éƒ¨ç½²çš„ HTTP æœåŠ¡ï¼Œä»¥ä¾¿å…¶ä»–çš„å®¹å™¨å¯ä»¥é€šè¿‡ URL æ¥è®¿é—®è¿™ä¸ª HTTP æœåŠ¡ï¼Œå› ä¸ºè¿™æ ·çš„è¯å°±å¯ä»¥é¿å…è¿™ä¸ª HTTP æœåŠ¡çš„å¤šæ¬¡éƒ¨ç½²ï¼ˆéƒ¨ç½²ä¸€æ¬¡ï¼Œç„¶åä¾›å…¶ä»–çš„å¤šä¸ªä»»åŠ¡æ¥ä½¿ç”¨ï¼‰ï¼Œä»è€Œæå‡æ•ˆç‡ã€‚</strong></p>
<p>æˆ‘å®‰æ’äº†ä¸€ä¸ªåŒäº‹æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚åŒäº‹å‘Šè¯‰æˆ‘è¯´ï¼Œ<strong>ä»å¹³å°çš„é…ç½®ä¸Šçœ‹ï¼Œæ˜¯æœ‰æš´éœ²å®¹å™¨PORTçš„åŠŸèƒ½çš„ï¼Œä½†æ˜¯è¿™ä¸ªåŠŸèƒ½ç›®å‰æ²¡æœ‰å®ç°ï¼Œæ‰€ä»¥éœ€è¦æ¨åŠ¨å¹³å°æ–¹å®ç°è¿™ä¸ªåŠŸèƒ½ã€‚</strong></p>
<h4 id="é—®é¢˜çš„å˜åŒ–">é—®é¢˜çš„å˜åŒ–</h4>
<p>ä¸çŸ¥é“å¤§å®¶å‘ç°æ²¡æœ‰ï¼Œåˆ°ç›®å‰ä¸ºæ­¢ï¼Œè¿™ä¸ªæ¡ˆä¾‹ä¸­çš„é—®é¢˜å·²ç»å‘ç”Ÿäº†å˜åŒ–ã€‚é—®é¢˜ä»<code>åœ¨å…¶ä»–å®¹å™¨ä¸­è®¿é—®å¦å¤–å®¹å™¨ä¸­çš„ HTTP æœåŠ¡</code> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>â€…â€Š</mtext><mo>âŸ¹</mo><mtext>â€…â€Š</mtext></mrow><annotation encoding="application/x-tex">\implies</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.549em;vertical-align:-0.024em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âŸ¹</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span></span></span> <code>CI/CD å¹³å°æ–¹éœ€è¦æä¾›æš´éœ²å®¹å™¨ PORT çš„èƒ½åŠ›</code>ã€‚</p>
<p>è¿™ä¸ªé—®é¢˜çš„è½¬åŒ–çœ‹èµ·æ¥æ˜¯å¤šä¹ˆçš„è‡ªç„¶è€Œåˆæ­£å¸¸ã€‚æ¥ä¸‹æ¥ï¼Œä¸ºäº†å®ç°æˆ‘ä»¬çš„ç›®æ ‡ï¼Œæˆ‘ä»¬å’Œå¹³å°æ–¹ç»„ç»‡äº†ä¸€ä¸ªæŠ€æœ¯è®¨è®ºä¼šï¼Œä¸“é—¨è®¨è®ºå¹³å°æ–¹ä½•æ—¶å¯ä»¥å®ç°<strong>æš´éœ²å®¹å™¨ PORT</strong>çš„åŠŸèƒ½ã€‚</p>
<p>ç»è¿‡å’Œå¹³å°æ–¹çš„è®¨è®ºï¼Œå› ä¸ºæ¶‰åŠåˆ°ç«¯å£åˆ†é…ã€ç«¯å£å†²çªç­‰ç«¯å£ç®¡ç†é—®é¢˜ï¼Œ<strong>æš´éœ²å®¹å™¨ PORT</strong>è¿™ä¸ªåŠŸèƒ½çŸ­æ—¶é—´å†…æ— æ³•å®ç°ã€‚</p>
<p>è®¨è®ºä¹‹åï¼Œæˆ‘ä»¬å‘ç°ï¼Œæˆ‘ä»¬éœ€è¦çš„åŠŸèƒ½çœ‹èµ·æ¥æ˜¯æ— æ³•å®ç°äº†ã€‚ä¸æ˜¯å—ï¼Ÿ</p>
<h4 id="å›å½’æœ€åŸå§‹çš„é—®é¢˜">å›å½’æœ€åŸå§‹çš„é—®é¢˜</h4>
<p>åœ¨æŠ€æœ¯è®¨è®ºçš„æœ€åï¼Œæˆ‘è¯·æ•™äº†å¹³å°æ–¹æŠ€æœ¯åŒå­¦æˆ‘ä»¬é‚£ä¸ªæœ€åŸå§‹çš„é—®é¢˜ï¼šå¦‚æœæˆ‘ä»¬æƒ³è¦åœ¨å…¶ä»–å®¹å™¨ä¸­è®¿é—®å¦å¤–å®¹å™¨ä¸­çš„ HTTP æœåŠ¡ï¼Œæœ‰ä»€ä¹ˆå¯è¡Œçš„æ–¹æ¡ˆå—ï¼Ÿ</p>
<p>ç›´åˆ°è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬æ‰çŸ¥é“ï¼ŒåŸæ¥æˆ‘ä»¬å®¹å™¨ä¸­ä½¿ç”¨çš„ PORT å®é™…ä¸Šå°±æ˜¯ç‰©ç†æœºä¸Šçš„ PORTã€‚æˆ‘ä»¬å¯ä»¥ç›´æ¥æ—¶å€™ç”¨æ‰€åˆ†é…çš„å®¹å™¨çš„ IP å’Œå®¹å™¨ä¸­å¯åŠ¨çš„ HTTP æœåŠ¡çš„ç«¯å£æ¥ç›´æ¥è®¿é—®è¿™ä¸ªå®¹å™¨å†…çš„æœåŠ¡ã€‚</p>
<p>è¿™æ—¶ï¼Œæˆ‘çš„åŒäº‹è¯´ï¼Œä¹‹å‰ç”¨ <code>ifconfig</code> å‘½ä»¤æ‹¿åˆ°çš„ IP å’Œå®¹å™¨ä¸­å¯åŠ¨çš„ HTTP æœåŠ¡çš„ PORT æµ‹è¯•è¿‡ï¼Œæ˜¯æ²¡åŠæ³•è®¿é—®å®¹å™¨å†…çš„æœåŠ¡çš„ã€‚</p>
<p>åˆ°è¿™é‡Œï¼Œæˆ‘æƒ³æˆ‘å¤§æ¦‚çŸ¥é“é—®é¢˜ç©¶ç«Ÿå‡ºåœ¨å“ªé‡Œäº†ã€‚<code>ifconfig</code> è·å–çš„æ˜¯å®¿ä¸»æœºçš„ç½‘å¡ IP åœ°å€ï¼Œè€Œå¯¹äºæœåŠ¡å™¨è€Œè¨€ï¼Œä¸€èˆ¬ä¼šæœ‰å¤šä¸ªç½‘å¡ï¼Œå› æ­¤è¯¥å‘½ä»¤ä¼šå¾—åˆ°å¤šä¸ª IP åœ°å€ã€‚è€Œå¯¹äºå®¹å™¨çš„ IP åœ°å€ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ç‰¹å®šçš„æŒ‡ä»¤æ‰èƒ½å¤Ÿæ‹¿åˆ°æ­£ç¡®çš„å®¹å™¨ IPã€‚</p>
<p>æœ€åï¼Œæˆ‘ä»¬æŒ‰ç…§å¹³å°æ–¹çš„æŠ€æœ¯åŒå­¦æä¾›çš„æ–¹æ³•å®Œç¾çš„å®ç°äº†æˆ‘ä»¬æ‰€è¦çš„åŠŸèƒ½ã€‚</p>
<h4 id="ä»è¿™ä¸ªæ¡ˆä¾‹ä¸­-å‘ç°äº†ä»€ä¹ˆï¼Ÿ">ä»è¿™ä¸ªæ¡ˆä¾‹ä¸­ï¼Œå‘ç°äº†ä»€ä¹ˆï¼Ÿ</h4>
<ul>
<li><code>é”™æŠŠå‡è®¾å½“è¯æ®</code>ã€‚åœ¨å®šä½ BUGï¼Œå°¤å…¶æ˜¯ä¸€äº›æ¯”è¾ƒå¤æ‚çš„ BUGï¼Œå¾€å¾€éœ€è¦æå‡ºå„ç§å‡è®¾ï¼Œå¹¶é€šè¿‡é€»è¾‘æ¨ç†ã€å¯»æ‰¾æ•°æ®è¯æ®å¯¹å…¶è¿›è¡Œæ£€éªŒï¼Œç„¶åå†æ ¹æ®æ£€éªŒçš„ç»“æœæå‡ºæ–°çš„å‡è®¾ï¼Œå†å¯¹è¿™äº›æ–°å‡è®¾é€ä¸€éªŒè¯ï¼Œä¸æ–­è¿­ä»£è¿™ä¸ªè¿‡ç¨‹ä»¥é€æ­¥é è¿‘ BUG çš„çœŸç›¸ã€‚ä½†æ˜¯ï¼Œæå‡ºå‡è®¾æ—¶ï¼Œå¯èƒ½å·²ç»å¿˜äº†é‚£ä»…ä»…æ˜¯ä¸ªå‡è®¾è€Œå·²ï¼Œä¾¿åœ¨è¿™ä¸ªå‡è®¾çš„åŸºç¡€ä¸Šå±•å¼€åˆ†æï¼Œæœ€åå¾—åˆ°ä¸€ä¸ªæ‰€è°“çš„â€œç»“è®ºâ€ã€‚æˆ‘çš„åŒäº‹ä¸€å¼€å§‹åˆ©ç”¨ <code>ifconfig</code> è·å–åˆ°çš„ IP æ— æ³•è®¿é—®åˆ°å®¹å™¨å†…éƒ¨çš„ HTTP æœåŠ¡å°±å¾—åˆ°äº†é”™è¯¯çš„ç»“è®ºï¼Œè€Œè¿™ä¸ªç»“è®ºå®é™…ä¸Šæ˜¯æºè‡ªä½¿ç”¨äº†é”™è¯¯å‘½ä»¤çš„ä¸€ä¸ªå‡è®¾è€Œå·²ã€‚</li>
<li><code>ç»™ä¸“ä¸šçš„äººæä¾›è§£å†³æ–¹æ¡ˆ</code>ã€‚åœ¨ä¸€ä¸ªé”™è¯¯çš„å‡è®¾ä¸Šï¼Œæˆ‘ä»¬ç»™å¹³å°æ–¹æå‡ºäº†ä¸€ä¸ªè§£å†³æ–¹æ¡ˆã€‚å¾ˆå¤šæ—¶å€™ï¼Œè¿™ç§è§£å†³æ–¹æ¡ˆå¯èƒ½ä¼šå®ç°ï¼Œä½†æ˜¯æ›´å¤šçš„æ—¶å€™ï¼Œè¿™ç§è§£å†³æ–¹æ¡ˆå¤§æ¦‚ç‡æ²¡æ³•å®ç°ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬å¿½ç•¥äº†ï¼Œè§£å†³æ–¹æ¡ˆä¸æ˜¯é—®é¢˜ï¼Œåªæ˜¯æˆ‘ä»¬ä»¥ä¸ºæ˜¯ä¸ªé—®é¢˜è€Œå·²ã€‚è¿™åœ¨å¹³å°æ–¹å¸®åŠ©æˆ‘ä»¬è§£å†³çœŸæ­£çš„é—®é¢˜æ—¶ä¼šå¸¦æ¥å¾ˆå¤§çš„å¹²æ‰°ã€‚æˆ‘ä»¬ä¸åº”è¯¥<strong>ç»™ä¸“ä¸šçš„äººæä¾›è§£å†³æ–¹æ¡ˆ</strong>ï¼Œè€Œåº”è¯¥<strong>ç»™å‡ºåŸå§‹é—®é¢˜æè¿°ï¼Œå‘ä¸“ä¸šäººå£«å¯»æ±‚è§£å†³æ–¹æ¡ˆ</strong>ã€‚</li>
</ul>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition warning"><p class="admonition-title">æˆ‘ä»¬ç»å¸¸çŠ¯çš„é”™è¯¯
</p><ul>
<li>é”™æŠŠå‡è®¾å½“è¯æ®</li>
<li>ç»™ä¸“ä¸šçš„äººæä¾›è§£å†³æ–¹æ¡ˆ</li>
</ul>
</div>
<h2 id="2-nginx-ä¸ºä»€ä¹ˆä¼šè‡ªåŠ¨æŠ¢å æŸä¸ªè¢«é‡Šæ”¾çš„ç«¯å£ï¼Ÿ">2. Nginx ä¸ºä»€ä¹ˆä¼šè‡ªåŠ¨æŠ¢å æŸä¸ªè¢«é‡Šæ”¾çš„ç«¯å£ï¼Ÿ</h2>
<h4 id="é—®é¢˜èƒŒæ™¯">é—®é¢˜èƒŒæ™¯</h4>
<p>æˆ‘ä¸ªäººå¯¹ Nginx æ¯”è¾ƒäº†è§£ï¼Œåœ¨å·¥ä½œä¸­ä¹Ÿè§£å†³äº†å¾ˆå¤šä¸šåŠ¡ä¸­é‡åˆ°çš„ Nginx çš„çº¿ä¸Šé—®é¢˜ã€‚</p>
<p>æœ‰ä¸€å¤©ï¼Œä¸€ä¸ªåŒäº‹å…´è‡´å†²å†²çš„æ¥æ‰¾æˆ‘ï¼Œè¯´ï¼š</p>
<blockquote>
<p>17å“¥ï¼Œæˆ‘å‘ç°äº†ä¸€ä¸ª Nginx çš„ç‰¹æ®ŠåŠŸèƒ½â€”â€”Nginx ä¼šè‡ªåŠ¨æŠ¢å æŸä¸ªè¢«é‡Šæ”¾çš„ç«¯å£ã€‚</p>
</blockquote>
<p>æˆ‘ä¹‹å‰é˜…è¯» Nginx æºç çš„æ—¶å€™ï¼Œæœªæ›¾å‘ç° Nginx æœ‰è¿™ä¸ªç‰¹æ®ŠåŠŸèƒ½ï¼Œä¹Ÿæœªæ›¾è®°å¾— Nginx çš„å®˜æ–¹æ–‡æ¡£æœ‰è¿™ä¸ªç‰¹æ®ŠåŠŸèƒ½æè¿°ï¼Œå¹¶ä¸”æˆ‘ä¸è®¤ä¸ºç±»ä¼¼ Nginx è¿™ç±»çš„è½¯ä»¶ï¼Œåº”è¯¥å…·å¤‡è¿™æ ·çš„èƒ½åŠ›ã€‚æ‰€ä»¥æˆ‘å¯¹åŒäº‹çš„è¿™ä¸ª<em>æœ‰è¶£çš„å‘ç°</em>æå‡ºäº†è´¨ç–‘ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼ŒåŒäº‹å…´é«˜é‡‡çƒˆçš„ç»™æˆ‘æ¼”ç¤ºäº†è¿™ä¸ªæœ‰è¶£çš„ç‰¹æ€§ã€‚åŸå§‹çš„æ¼”ç¤ºå½“æ—¶æ²¡æœ‰å½•åˆ¶ï¼Œæ‰€ä»¥ï¼Œæˆ‘åœ¨è‡ªå·±çš„ç”µè„‘ä¸Šå¯¹å½“æ—¶çš„æ¼”ç¤ºè¿›è¡Œäº†è¿˜åŸï¼Œå…·ä½“å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p>
<div class="bili_video"><div style="position: relative; width: 100%; height: 0; padding-bottom: 75%;"><iframe src="https://player.bilibili.com/player.html?aid=933211839&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position: absolute; width: 100%; height: 100%; left: 0; top: 0;"> </iframe></div></div>
<blockquote>
<p><strong>è¯´æ˜1</strong>ï¼šæ•´ä¸ªçš„æ¼”ç¤ºè¿‡ç¨‹ä» å¯åŠ¨ Nginx å¼€å§‹ã€‚<br>
<strong>è¯´æ˜2</strong>ï¼šå½“æ—¶æ¼”ç¤ºçš„æ—¶å€™ï¼Œå¹¶æ²¡æœ‰ä½¿ç”¨ <code>watch</code> å‘½ä»¤ï¼Œä»…ä»…ä½¿ç”¨äº† <code>lsof</code> å‘½ä»¤ã€‚ä¸ºäº†é¿å…è¿‡å¤šçš„æ‰‹å·¥æ“ä½œï¼Œæˆ‘åœ¨è¿™é‡Œä½¿ç”¨äº† <code>watch</code> å‘½ä»¤ã€‚</p>
</blockquote>
<h4 id="è¿™ä¸ªæœ‰è¶£çš„æ¼”ç¤ºæœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ">è¿™ä¸ªæœ‰è¶£çš„æ¼”ç¤ºæœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ</h4>
<p>çœ‹å®ŒåŒäº‹çš„æ¼”ç¤ºï¼Œç¡®å®å‘ç”Ÿäº† <strong>Nginxè‡ªåŠ¨æŠ¢å è¢«é‡Šæ”¾çš„9003ç«¯å£</strong>çš„äº‹æƒ…ï¼Œçœ‹ç€æ¼”ç¤ºï¼Œæˆ‘é™·å…¥äº†æ·±æ€ã€‚ç„¶åï¼Œæˆ‘å¤šæ¬¡æ‰§è¡Œäº† <code>lsof</code> å‘½ä»¤ï¼Œæ¥è§‚å¯Ÿç«¯å£çš„å ç”¨ä¿¡æ¯ã€‚</p>
<p>æˆ‘å‘ç°äº†ä¸€ä¸ªå¥‡æ€ªçš„ç°è±¡ï¼Œè¿™ä¸ªç°è±¡å¤§å®¶è§‚å¯Ÿæ¼”ç¤ºå›¾ä¸­çš„å·¦ä¸Šè§’çš„ <code>watch</code> å‘½ä»¤çš„ç»“æœä¹Ÿèƒ½å‘ç°ï¼š9003 ç«¯å£çš„ Nginx çš„ PIDï¼ˆè¿›ç¨‹å·ï¼‰åœ¨ä¸æ–­çš„å‘ç”Ÿå˜åŒ–ã€‚è¿™è¯´æ˜ Nginx è¿›ç¨‹åœ¨ä¸æ–­çš„é‡å¯ã€‚ç„¶åï¼Œæˆ‘æŸ¥çœ‹äº† Nginx çš„æ—¥å¿—ï¼Œå‘ç°äº†å¦‚ä¸‹çš„ä¿¡æ¯ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">2021/09/20 10:41:34 [notice] 4943#0: signal 23 (SIGIO) received</span><br><span class="line">2021/09/20 10:41:34 [notice] 5315#0: exiting</span><br><span class="line">2021/09/20 10:41:34 [notice] 4943#0: signal 23 (SIGIO) received</span><br><span class="line">2021/09/20 10:41:34 [notice] 5313#0: gracefully shutting down</span><br><span class="line">2021/09/20 10:41:34 [notice] 5313#0: exiting</span><br><span class="line">2021/09/20 10:41:34 [notice] 4943#0: signal 20 (SIGCHLD) received from 5315</span><br><span class="line">2021/09/20 10:41:34 [notice] 4943#0: cache loader process 5315 exited with code 0</span><br><span class="line">2021/09/20 10:41:34 [notice] 4943#0: cache manager process 5314 exited with code 0</span><br><span class="line">2021/09/20 10:41:34 [notice] 4943#0: signal 20 (SIGCHLD) received</span><br><span class="line">2021/09/20 10:41:34 [notice] 4943#0: signal 23 (SIGIO) received</span><br><span class="line">2021/09/20 10:41:34 [notice] 4943#0: signal 23 (SIGIO) received from 5321</span><br><span class="line">2021/09/20 10:41:34 [notice] 5313#0: exit</span><br><span class="line">2021/09/20 10:41:34 [notice] 4943#0: signal 23 (SIGIO) received from 5313</span><br><span class="line">2021/09/20 10:41:34 [notice] 4943#0: signal 23 (SIGIO) received from 5313</span><br><span class="line">2021/09/20 10:41:34 [notice] 4943#0: signal 20 (SIGCHLD) received from 5313</span><br><span class="line">2021/09/20 10:41:34 [notice] 4943#0: worker process 5313 exited with code 0</span><br><span class="line">2021/09/20 10:41:34 [notice] 4943#0: signal 23 (SIGIO) received</span><br><span class="line">2021/09/20 10:41:34 [notice] 4943#0: signal 23 (SIGIO) received</span><br><span class="line">2021/09/20 10:41:34 [notice] 4943#0: signal 23 (SIGIO) received</span><br><span class="line">2021/09/20 10:41:34 [notice] 4943#0: signal 23 (SIGIO) received</span><br></pre></td></tr></table></figure>
<p>ç›´åˆ°è¿™ä¸ªæ—¶å€™æˆ‘ä»¬æ‰å‘ç°ï¼ŒåŸæ¥åŒäº‹è¯´çš„æœ‰è¶£çš„ç‰¹æ€§æ˜¯ Nginx ä¸æ–­çš„ reload è¿›ç¨‹å¯¼è‡´çš„ã€‚åœ¨ Nginx reload æ—¶ï¼Œä¼šåŠ è½½æœ€æ–°çš„é…ç½®ï¼Œç„¶åæŒ‰ç…§æœ€æ–°çš„é…ç½®å¯åŠ¨æ–°çš„ worker è¿›ç¨‹å¹¶å¤„ç†æ–°çš„è¯·æ±‚ã€‚äºæ˜¯ï¼Œå°±å‘ç”Ÿäº†åŒäº‹æ‰€è¯´çš„ Nginx çš„æœ‰è¶£çš„ç‰¹æ€§ã€‚</p>
<h4 id="å›å½’é—®é¢˜çš„æœ¬è´¨">å›å½’é—®é¢˜çš„æœ¬è´¨</h4>
<p>äºæ˜¯ï¼Œç»è¿‡æ’æŸ¥ï¼Œæˆ‘ä»¬æŠŠä¸€ä¸ªå‡è®¾è½¬å˜æˆäº†å‡è®¾èƒŒåçš„é—®é¢˜ï¼š<code>Nginx ä¸ºä»€ä¹ˆä¼šè‡ªåŠ¨æŠ¢å è¢«é‡Šæ”¾çš„ç«¯å£ï¼Ÿ</code> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>â€…â€Š</mtext><mo>âŸ¹</mo><mtext>â€…â€Š</mtext></mrow><annotation encoding="application/x-tex">\implies</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.549em;vertical-align:-0.024em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âŸ¹</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span></span></span> <code>Nginx ä¸ºä»€ä¹ˆä¼šä¸åœçš„ reloadï¼Ÿ</code>ã€‚</p>
<p>å› ä¸ºæ‰¾ä¸åˆ°ç¼–è¯‘è¿™ä¸ª Nginx çš„æºä»£ç äº†ï¼Œæ‰€ä»¥æ²¡åŠæ³•ç¡®å®šæ˜¯å¦æ˜¯åœ¨æºç å±‚é¢è¿›è¡Œäº†ä¿®æ”¹ã€‚</p>
<p>ä¸ºäº†æŸ¥æ¸…è¿™ä¸ªé—®é¢˜ï¼š</p>
<ul>
<li>æˆ‘é¦–å…ˆæŸ¥çœ‹äº† crontab ä»»åŠ¡ï¼Œå‘ç°æœºå™¨ä¸Šå¹¶æ²¡æœ‰é…ç½®ç±»ä¼¼çš„å®šæ—¶ä»»åŠ¡ã€‚</li>
<li>ç„¶åï¼Œæˆ‘æŸ¥çœ‹äº† Nginx åŠ è½½çš„æ‰€æœ‰ lua æ’ä»¶ä»£ç ï¼ŒåŒæ ·ä¹Ÿæ²¡æœ‰å‘ç°æœ‰ç±»ä¼¼çš„ä»£ç ã€‚</li>
<li>ç„¶ååœ¨ Nginx ä¿¡å·å¤„ç†çš„ç›¸å…³ä»£ç å—è¿›è¡Œçš„ GDB å•æ­¥è°ƒè¯•ï¼ŒåŒæ ·æ²¡æœ‰å‘ç°ç±»ä¼¼ä»£ç ã€‚</li>
</ul>
<p>æŸ¥äº† 1 å¤©å¤šä¹Ÿæ²¡æŸ¥åˆ°ä¸ºä»€ä¹ˆè¿™ä¸ª Nginx ä¼šä¸åœçš„ reloadã€‚å› ä¸ºè¿˜æœ‰å…¶ä»–äº‹æƒ…ï¼Œè¿™ä¸ªé—®é¢˜ä¹Ÿå°±æç½®äº†èµ·æ¥ã€‚</p>
<p>åæ¥ï¼Œè¿‡äº†å¾ˆé•¿æ—¶é—´ï¼ŒåŒäº‹å‘Šè¯‰æˆ‘è¯´ï¼Œåœ¨æœºå™¨çš„æŸä¸ªç›®å½•ä¸‹ï¼Œå‘ç°äº†ä¸€ä¸ªæ¯éš” 1 ç§’å°± reload é‚£ä¸ª Nginx çš„è„šæœ¬ã€‚ç›´åˆ°è¿™ä¸ªæ—¶å€™ï¼Œæ•´ä¸ªäº‹æƒ…æ‰å˜å¾—éå¸¸æ¸…æ™°ã€‚</p>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>åº­é™¢æ·±æ·±æ·±å‡ è®¸ï¼Œæ¥¼é«˜ä¸è§ç« å°è·¯ã€‚å·¥ä½œä¸­ï¼Œåœ¨æˆ‘ä»¬è§£å†³é—®é¢˜çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¹¶ä¸æ˜¯ç®€å•çš„æ‰§è¡Œè¿™ä¸ªé—®é¢˜çš„è§£å†³è®¡åˆ’ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ä¸æ–­çš„å¯¹è‡ªå·±çš„è§£å†³è®¡åˆ’å®æ–½è‡ªæˆ‘ç›‘æ§ï¼Œä¸æ–­çš„ç›‘æ§ï¼šè‡ªå·±çš„æ‰§è¡Œæ˜¯å¦æ­£ç¡®ï¼Œè§£å†³æ–¹æ¡ˆæ˜¯å¦æ­£ç¡®ï¼Œå½“å‰çš„é—®é¢˜æ˜¯å¦å‘ç”Ÿäº†é»˜é»˜çš„å˜åŒ–â€¦â€¦æˆ‘ä»¬è¿˜è¦æ—¶ä¸æ—¶çš„å›å¤´çœ‹çœ‹ï¼Œä»è€Œç¡®è®¤æˆ‘ä»¬æ²¡æœ‰èµ°é”™~</p>
<h2 id="æ¡ˆä¾‹å¾é›†">æ¡ˆä¾‹å¾é›†</h2>
<p>å¦‚æœæ‚¨ä¹Ÿæœ‰ç±»ä¼¼çš„æ¡ˆä¾‹ï¼Œå¯ä»¥ç»™æœ¬æ–‡æäº¤ <a href="https://github.com/wangwei1237/wangwei1237.github.io/issues/314">ISSUE è¯„è®º</a>ï¼Œä¹Ÿå¯ä»¥åœ¨ <a href="https://github.com/wangwei1237/wangwei1237.github.io/discussions/317">è®¨è®ºåŒº</a> ç•™ä¸‹æ‚¨çš„æ¡ˆä¾‹ï¼Œè¿˜å¯ä»¥åœ¨ä¸‹æ–¹çš„è¯„è®ºå¤„ç•™ä¸‹æ‚¨çš„æ¡ˆä¾‹ï¼Œæˆ‘ä¹Ÿä¼šå°†è¿™äº›æ¡ˆä¾‹å¢åŠ åˆ°æ–‡ç« ä¹‹ä¸­ã€‚</p>
]]></content>
      <categories>
        <category>æ–‡åŒ–</category>
      </categories>
      <tags>
        <tag>æ–¹æ³•è®º</tag>
        <tag>é—®é¢˜å®šä½</tag>
      </tags>
  </entry>
  <entry>
    <title>å¦‚ä½•é˜…è¯»å¹¶ä½¿ç”¨å¼€æºé¡¹ç›®</title>
    <url>/2021/09/11/How-to-Read-and-Use-the-Open-Source-Projects/</url>
    <content><![CDATA[<p>æˆ‘ä¼šç»å¸¸æµè§ˆå¹¶å€Ÿé‰´å¾ˆå¤šå¼€æºé¡¹ç›®çš„ä»£ç æ¥å®Œæˆè‡ªå·±çš„å·¥ä½œï¼Œæœ‰å¾ˆå¤šæ—¶å€™è¿™ç§æ–¹æ³•è®©æˆ‘çš„å·¥ä½œæ•ˆç‡éå¸¸é«˜ã€‚é˜…è¯»å¹¶å€Ÿé‰´å¼€æºé¡¹ç›®çš„æˆæœï¼Œè®©æˆ‘å¾—ä»¥ç«™åœ¨å·¨äººçš„è‚©è†€ä¸Šï¼Œä½¿å¾—æˆ‘å¯ä»¥æ›´é«˜æ•ˆçš„å·¥ä½œã€‚</p>
<p>ä¸çŸ¥é“ä½ ä¹Ÿæ˜¯å¦å’Œæˆ‘ä¸€æ ·ï¼Ÿå¦‚æœä½ ä¹Ÿå’Œæˆ‘ä¸€æ ·ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ˜¯å¦æ€è€ƒè¿‡ï¼Ÿæˆ‘ä»¬åœ¨å¼•ç”¨åˆ«äººçš„ä»£ç å®Œæˆè‡ªå·±çš„é¡¹ç›®æ—¶ï¼Œæˆ‘ä»¬çš„é¡¹ç›®æ˜¯å¦å˜æˆäº†ä¸€ä¸ªå¦‚ä¸‹å›¾æ‰€ç¤ºçš„å››ä¸åƒå‘¢ï¼Ÿ</p>
<p><img src="/2021/09/11/How-to-Read-and-Use-the-Open-Source-Projects/1.gif" alt></p>
<span id="more"></span>
<h2 id="ç¼˜èµ·">ç¼˜èµ·</h2>
<p>å¾ˆä¹…ä¹‹å‰å°±æƒ³å†™ä¸€ç¯‡ç±»ä¼¼çš„æ–‡ç« ï¼Œä½†æ˜¯ä¸€ç›´æ²¡æœ‰å†™ã€‚å‰å‡ å¤©ï¼Œåœ¨é¡¹ç›®ä¸­é‡åˆ°äº†ç±»ä¼¼çš„é—®é¢˜ï¼Œæˆ‘æ‰å†³å®šè¦èŠ±æ—¶é—´æ¥å†™ä¸€å†™ã€‚</p>
<p>ä¹‹å‰é˜…è¯»è¿‡å¾ˆå¤šå¼€æºé¡¹ç›®çš„ä»£ç ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>Nginx</li>
<li>Redis</li>
<li>FFmpeg</li>
<li>VMAF</li>
<li>â€¦â€¦</li>
</ul>
<p>ä»è¿™äº›é¡¹ç›®ä¸­å­¦åˆ°äº†å¾ˆå¤šï¼Œä¹Ÿæˆé•¿äº†å¾ˆå¤šï¼Œè¿˜æ›¾ç»åˆ©ç”¨è¿™äº›é¡¹ç›®æ¥å®Œæˆè¿‡è‡ªå·±çš„å·¥ä½œã€‚è‡ªè®¤ä¸ºè‡ªå·±å¯¹äºé˜…è¯»å¼€æºé¡¹ç›®ä»£ç å¹¶åˆ©ç”¨å¼€æºé¡¹ç›®å¸®åŠ©è‡ªå·±å®Œæˆå·¥ä½œä¸Šè¿˜ç®—æ˜¯æœ‰ä¸€äº›ç»éªŒã€‚å› æ­¤ï¼Œæ­£å¥½å€Ÿè¿™ç¯‡æ–‡ç« å°†è‡ªå·±è¿‡å»åœ¨é˜…è¯»å¹¶ä½¿ç”¨å¼€æºé¡¹ç›®ä¸Šçš„ä¸€äº›æ€è€ƒå’Œç»éªŒæ•´ç†äº†å‡ºæ¥ã€‚</p>
<h2 id="ä¸€ä¸ª-cmake-çš„æ¡ˆä¾‹">ä¸€ä¸ª CMake çš„æ¡ˆä¾‹</h2>
<p>æˆ‘æœ‰ä¸€ä¸ªåªæœ‰å‡ ä¸ªäººçš„å°ç»„ï¼Œæˆ‘ä»¬è¿™ä¸ªå°ç»„çš„ä¸»è¦å·¥ä½œå°±æ˜¯æ¢ç´¢å¹¶å¼€å‘å’Œè§†é¢‘è´¨é‡è¯„ä¼°ã€è§†é¢‘æ£€æµ‹ã€è§†é¢‘ç›¸å…³æµ‹è¯•ç­‰æ–¹é¢çš„å¹³å°å’Œå·¥å…·ã€‚</p>
<p>å¯¹äºè§†é¢‘æ£€æµ‹è€Œè¨€ï¼Œæˆ‘ä»¬å¼€å‘äº†ä¸€ä¸ªé¡¹ç›®ï¼Œå¯ä»¥æš‚ä¸”ç§°ä¹‹ä¸º MTã€‚æ•´ä¸ªé¡¹ç›®ç”¨ C++ è¯­è¨€æ¥å¼€å‘ï¼Œå¹¶ä¸”ä½¿ç”¨ CMake æ¥ä½œä¸ºç¼–è¯‘å·¥å…·ã€‚å› ä¸ºéœ€è¦å¯¹è§†é¢‘è¿›è¡Œè§£ç å¤„ç†ï¼Œå› æ­¤è¯¥é¡¹ç›®ä¼šä¾èµ– FFmpegã€‚ä¸€å¼€å§‹ï¼Œæˆ‘ä»¬å‘ç°ï¼Œåœ¨ CMake ä¸­ï¼Œ<a href="https://github.com/Microsoft/vcpkg/issues/1379">FFmpeg å¹¶ä¸æ”¯æŒä½¿ç”¨ find_package æ¥æŸ¥æ‰¾ FFMPeg çš„ä¾</a>ã€‚ä¸ºäº†ç®€å•æœŸé—´ï¼Œæˆ‘ä»¬å°±ç”¨äº†æš´åŠ›ä¸€ç‚¹çš„æ–¹å¼æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬åœ¨ CMakeLists ä¸­å†™ä¸‹äº†å¦‚ä¸‹çš„ä»£ç ï¼š</p>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line">......</span><br><span class="line"><span class="keyword">include_directories</span>(<span class="string">&quot;$&#123;ffmpeg_include_path&#125;&quot;</span>)</span><br><span class="line"><span class="keyword">link_directories</span>(<span class="string">&quot;$&#123;ffmpeg_lib_path&#125;&quot;</span>)</span><br><span class="line"><span class="keyword">target_link_libraries</span>( MT</span><br><span class="line">    PRIVATE</span><br><span class="line">        libavutil.so</span><br><span class="line">        libavcodec.so</span><br><span class="line">        libavformat.so</span><br><span class="line">        ......</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>è¿™æ®µä»£ç ç¡®å®å†™çš„æœ‰äº›ç³Ÿç³•ï¼ˆä½ ä¹Ÿå¯ä»¥è¯•ç€è¯´ä¸€ä¸‹è¿™æ®µä»£ç ç©¶ç«Ÿæœ‰å“ªäº›é—®é¢˜ï¼‰ï¼Œä½†æ˜¯ä»–çœ‹èµ·æ¥ç¡®å®å¯ä»¥å·¥ä½œäº†ã€‚åæ¥ï¼Œæˆ‘å‘ç°äº† <a href="https://github.com/snikulov/cmake-modules/blob/master/FindFFmpeg.cmake">FindFFmpeg.cmake</a> è¿™ä¸ªå¼€æºçš„åº“å¯ä»¥æ›´ä¼˜é›…çš„å®ç°åœ¨ CMake ä¸­æŸ¥æ‰¾ FFmpeg çš„ä¾èµ–ï¼Œäºæ˜¯æˆ‘è®©ä¸€ä¸ªåŒäº‹æ¥å‡çº§ä¹‹å‰é‚£æ®µæœ‰äº›ç³Ÿç³•çš„ä»£ç ã€‚</p>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line">......</span><br><span class="line"><span class="keyword">include</span>(cmake/FindFFmpeg.cmake)</span><br><span class="line"></span><br><span class="line"><span class="keyword">IF</span> (APPLE)</span><br><span class="line"><span class="keyword">target_link_libraries</span>( MT</span><br><span class="line">    PRIVATE</span><br><span class="line">        libavutil.dylib </span><br><span class="line">        libavcodec.dylib </span><br><span class="line">        libavformat.dylib </span><br><span class="line">        ......</span><br><span class="line">)</span><br><span class="line"><span class="keyword">ELSEIF</span> (UNIX)</span><br><span class="line"><span class="keyword">target_link_libraries</span>( MT</span><br><span class="line">    PRIVATE</span><br><span class="line">        libavutil.so</span><br><span class="line">        libavcodec.so</span><br><span class="line">        libavformat.so</span><br><span class="line">        ......</span><br><span class="line">)</span><br><span class="line"><span class="keyword">ENDIF</span> ()</span><br></pre></td></tr></table></figure>
<p>å¥½å§ï¼Œçœ‹èµ·æ¥é—®é¢˜æ˜¯è§£å†³äº†ã€‚ä½†æ˜¯ï¼Œæˆ‘æ€»è§‰å¾—è¿™æ®µä»£ç çœ‹ä¸Šå»æœ‰ç‚¹åˆ«æ‰­ï¼Œè¿™å®Œå…¨æœ‰æ‚–äº CMake çš„åˆè¡·å‘€ï¼šæ ¹æ®ä¸åŒçš„ç³»ç»Ÿé“¾æ¥ä¸åŒåŠ¨æ€åº“çš„é€»è¾‘ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆæ˜¾ç¤ºçš„å†™å‡ºæ¥ï¼Ÿè¿™æ®µä»£ç çœ‹èµ·æ¥å°±ä¸‹ä¸‹é¢è¿™ä¸ªå›¾ä¸€æ ·ï¼š</p>
<p><img src="/2021/09/11/How-to-Read-and-Use-the-Open-Source-Projects/2.png" alt></p>
<h4 id="æˆ‘æ˜¯æ€ä¹ˆåšçš„">æˆ‘æ˜¯æ€ä¹ˆåšçš„</h4>
<p>çœ‹åˆ°æäº¤çš„ä»£ç åï¼Œæˆ‘æ‰“å›äº†åŒäº‹çš„ä»£ç æäº¤ã€‚æ²¡æœ‰ä»”ç»†çš„é˜…è¯» FindFFmpeg.cmake çš„ä»£ç ï¼ˆè™½ç„¶è¿™æ®µä»£ç å¹¶ä¸å¤šï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨çŸ­æ—¶é—´å†…çœ‹æ‡‚ï¼Œä½†æ˜¯æˆ‘å¹¶æ²¡æœ‰è¿™ä¹ˆåšï¼‰ï¼Œæˆ‘ä»¬é¦–å…ˆé˜…è¯»äº† FindFFmpeg.cmake çš„æ–‡æ¡£ï¼ˆå…¶å®å°±æ˜¯ä»£ç å¼€å§‹çš„æ³¨é‡Šéƒ¨åˆ†ï¼‰ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="comment"># - Try to find the required ffmpeg components(default: AVFORMAT, AVUTIL, AVCODEC)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Once done this will define</span></span><br><span class="line"><span class="comment">#  FFMPEG_FOUND         - System has the all required components.</span></span><br><span class="line"><span class="comment">#  FFMPEG_INCLUDE_DIRS  - Include directory necessary for using the required components headers.</span></span><br><span class="line"><span class="comment">#  FFMPEG_LIBRARIES     - Link these to use the required ffmpeg components.</span></span><br><span class="line"><span class="comment">#  FFMPEG_DEFINITIONS   - Compiler switches required for using the required ffmpeg components.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># For each of the components it will additionally set.</span></span><br><span class="line"><span class="comment">#   - AVCODEC</span></span><br><span class="line"><span class="comment">#   - AVDEVICE</span></span><br><span class="line"><span class="comment">#   ......</span></span><br><span class="line"><span class="comment"># the following variables will be defined</span></span><br><span class="line"><span class="comment">#  &lt;component&gt;_FOUND        - System has &lt;component&gt;</span></span><br><span class="line"><span class="comment">#  ......</span></span><br></pre></td></tr></table></figure>
<p>å› æ­¤ï¼Œé˜…è¯»å®Œæ–‡æ¡£åï¼Œæˆ‘ä»¬çŸ¥é“åªéœ€è¦ä½¿ç”¨ <code>$&#123;AVCODEC&#125;</code> ç­‰å°±å¯ä»¥ã€‚äºæ˜¯ï¼ŒåŒäº‹åˆç¬¬äºŒæ¬¡æäº¤äº†å‡çº§çš„ä»£ç ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line">......</span><br><span class="line"><span class="keyword">include</span>(cmake/FindFFmpeg.cmake)</span><br><span class="line"><span class="keyword">include_directories</span>(<span class="string">&quot;$&#123;FFMPEG_INCLUDE_DIRS&#125;&quot;</span>)</span><br><span class="line"><span class="keyword">target_link_libraries</span>( MT</span><br><span class="line">    PRIVATE</span><br><span class="line">        <span class="variable">$&#123;FFMPEG_LIBRARIES&#125;</span></span><br></pre></td></tr></table></figure>
<p><img src="/2021/09/11/How-to-Read-and-Use-the-Open-Source-Projects/3.png" alt></p>
<p>å› æ­¤ï¼Œæ— è®ºåœ¨é˜…è¯»åˆ«äººçš„ä»£ç ï¼Œè¿˜æ˜¯åœ¨ä½¿ç”¨åˆ«äººçš„ä»£ç ä¹‹å‰ï¼Œé¦–å…ˆé˜…è¯»ä»£ç çš„æ–‡æ¡£æˆ–è€…æ³¨é‡Šæ˜¯ä¸€ä»¶éå¸¸æœ‰å¿…è¦çš„äº‹æƒ…ï¼Œè¿™æ˜¯æˆ‘ä»¬äº†è§£ä»£ç çš„æœ€å¿«é€Ÿæœ‰æ•ˆçš„æ‰‹æ®µï¼ˆå¦‚æœæœ‰æ¯”è¾ƒè§„èŒƒçš„æ³¨é‡Šçš„è¯ï¼Œä¸€èˆ¬å¯¹äºæ¯”è¾ƒå¥½çš„å¼€æºé¡¹ç›®ï¼Œæ³¨é‡Šæ˜¯æ¯”è¾ƒè§„èŒƒçš„ï¼‰ã€‚</p>
<h2 id="å¦‚ä½•ä½¿ç”¨å¼€æºé¡¹ç›®">å¦‚ä½•ä½¿ç”¨å¼€æºé¡¹ç›®</h2>
<h4 id="1-é˜…è¯»é¡¹ç›®çš„-readme">1. é˜…è¯»é¡¹ç›®çš„ README</h4>
<p>ä¸€èˆ¬è€Œè¨€ï¼Œ README ä¸­ä¼šå¯¹æ•´ä¸ªé¡¹ç›®è¿›è¡Œç®€è¦çš„ä»‹ç»ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>è¿™ä¸ªé¡¹ç›®æ˜¯ä»€ä¹ˆï¼Ÿ</li>
<li>ä¸ºä»€ä¹ˆè¦åšè¿™ä¸ªé¡¹ç›®ï¼Ÿ</li>
<li>è¿™ä¸ªé¡¹ç›®çš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿ</li>
<li>è¿™ä¸ªé¡¹ç›®éƒ½æä¾›äº†ä»€ä¹ˆèƒ½åŠ›ï¼Ÿ</li>
<li>å¦‚ä½•ä½¿ç”¨è¿™ä¸ªé¡¹ç›®æä¾›çš„èƒ½åŠ›ï¼Ÿ</li>
<li>â€¦â€¦</li>
</ul>
<p>ä»¥ VMAF ä¸ºä¾‹ï¼Œé˜…è¯» <a href="https://github.com/netflix/vmaf#readme">VMAF çš„ README</a> å’Œ <a href="https://github.com/Netflix/vmaf/blob/master/libvmaf/README.md">libvmaf çš„ README</a> èƒ½å¤Ÿè®©æˆ‘ä»¬å¯¹é¡¹ç›®çš„èƒŒæ™¯ã€ç›®æ ‡æœ‰ä¸€ä¸ªå¤§è‡´äº†è§£ï¼Œå¹¶ä¸”èƒ½å¤Ÿäº†è§£åˆ°è¿™ä¸ªé¡¹ç›®çš„ï¼š</p>
<ul>
<li>åŒ…å«äº†ä»€ä¹ˆèƒ½åŠ›ï¼Ÿ</li>
<li>è®¾è®¡é€»è¾‘æ˜¯ä»€ä¹ˆï¼Ÿ</li>
<li>å¯ä»¥è§£å†³é‚£äº›é—®é¢˜ï¼Ÿ</li>
<li>é‚£äº›é—®é¢˜è§£å†³ä¸äº†ï¼Ÿ</li>
<li>å¦‚ä½•ä½¿ç”¨è¯¥é¡¹ç›®ï¼Ÿ</li>
<li>å¯ä»¥ä»é‚£äº›åœ°æ–¹è·å–åˆ°æ›´è¯¦ç»†çš„ä¿¡æ¯ï¼Ÿ</li>
<li>â€¦â€¦</li>
</ul>
<p>ç›¸æ¯”è¾ƒä¸€ä¸Šæ¥å°±é˜…è¯»é¡¹ç›®çš„æºç è€Œè¨€ï¼Œé˜…è¯» README æ˜¯äº†è§£è¿™ä¸ªé¡¹ç›®å¹¶å‡†å¤‡ä½¿ç”¨è¯¥é¡¹ç›®çš„æœ€å¿«é€Ÿæœ‰æ•ˆçš„æ–¹æ³•ã€‚å¦‚æœå…·å¤‡å¯ä»¥é€šè¿‡é˜…è¯»æºç æå–åˆ°é¡¹ç›®æ–‡æ¡£çš„èƒ½åŠ›çš„è¯ï¼Œç›´æ¥é˜…è¯»æºç ä¹Ÿå¯ä»¥ï¼Œä½†æ˜¯æˆ‘è®¤ä¸ºå’Œé˜…è¯» README ç›¸æ¯”ï¼Œé˜…è¯»æºç çš„æ•ˆç‡è¿˜æ˜¯å·®ä¸€ç‚¹çš„ã€‚</p>
<h4 id="2-æ·±å…¥é˜…è¯»éœ€è¦ç”¨åˆ°çš„èƒ½åŠ›">2. æ·±å…¥é˜…è¯»éœ€è¦ç”¨åˆ°çš„èƒ½åŠ›</h4>
<p>åœ¨ <a href="/2021/01/19/FFMpeg-decode-process-and-lose-frame-in-that-process/">FFmpeg è§£ç  API ä»¥åŠåœ¨è§£ç è¿‡ç¨‹ä¸­å­˜åœ¨çš„ä¸¢å¸§é—®é¢˜</a> ä¸­ï¼Œæˆ‘æåˆ°è¿‡æˆ‘æ˜¯å¦‚ä½•åˆ©ç”¨ FFmpeg API ä¸­çš„ä»£ç æ³¨é‡Šæ¥å®šä½å¹¶è§£å†³æˆ‘ä»¬å°ç»„å¼€å‘çš„å·¥å…·ä¸­å­˜åœ¨çš„ BUGã€‚å®é™…ä¸Šï¼Œå¦‚æœåŒäº‹å½“æ—¶èƒ½å¤Ÿè®¤çœŸçš„é˜…è¯» <a href="https://github.com/FFmpeg/FFmpeg/blob/release/3.1/libavcodec/avcodec.h">FFmpeg avcodec</a> çš„æ–‡æ¡£ï¼ˆä»£ç æ³¨é‡Šï¼‰ï¼Œé‚£ä¹ˆå°±ä¸ä¼šæœ‰è¿™ç¯‡æ–‡ç« ä¸­çš„ BUG äº†ã€‚</p>
<p>å› æ­¤ï¼Œåœ¨é˜…è¯»å®Œ README ä¹‹åï¼Œå¦‚æœè¦åœ¨è‡ªå·±çš„é¡¹ç›®ä¸­ä½¿ç”¨å¼€æºé¡¹ç›®çš„æŸä¸ªå…·ä½“èƒ½åŠ›æˆ– APIï¼Œé‚£ä¹ˆé¦–å…ˆéœ€è¦é’ˆå¯¹éœ€è¦ä½¿ç”¨çš„éƒ¨åˆ†æ›´è¯¦ç»†çš„é˜…è¯»ï¼š</p>
<ol>
<li>
<p>å¼€å‘è€…æŒ‡å—ä¸­å¯¹åº”çš„å†…å®¹</p>
<ul>
<li>Developer Guidesï¼šéœ€è¦é¦–å…ˆé˜…è¯» Developer Guides ä¸­å¯¹åº”çš„ç›¸å…³èµ„æ–™ï¼Œä¾‹å¦‚ <a href="https://developer.android.com/guide/index.html">Android Developer Guides</a>ï¼Œ<a href="https://plugins.jetbrains.com/docs/intellij/getting-started.html">IntelliJ Platform SDK</a>â€¦â€¦è¿˜æœ‰å¾ˆå¤šéå¼€æºé¡¹ç›®ä¹Ÿä¼šæœ‰ Developer Guidesï¼Œå¯¹äºè¿™ç§é¡¹ç›®ï¼ŒDeveloper Guides æ— ç–‘æ˜¯æœ€å¥½çš„ã€å¿…é¡»é¦–å…ˆé˜…è¯»çš„èµ„æ–™ï¼Œæ¯”è¾ƒå…¸å‹çš„å°±æ˜¯<a href="https://developer.apple.com/library/archive/navigation/">Apple Developer Guides</a>ï¼Œæˆ‘å½“æ—¶äº†è§£ iOS æ¶ˆæ¯æ¨é€ç›¸å…³çš„æŠ€æœ¯å°±æ˜¯é¦–å…ˆé˜…è¯»çš„ <a href="https://developer.apple.com/library/archive/documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/index.html#//apple_ref/doc/uid/TP40008194">Local and Remote Notification Programming Guide</a>ï¼Œè‡ªæˆ‘è®¤ä¸ºæ¯”æŸ¥é˜…äº’è”ç½‘ä¸Šå…¶ä»–äººæ€»ç»“çš„æ–‡æ¡£è¦é«˜æ•ˆå¾ˆå¤šã€‚</li>
<li>Documentï¼šé™¤äº† Developer Guides ä¹‹å¤–ï¼Œé¡¹ç›®æä¾›çš„ documentation ä¹Ÿæ˜¯éœ€è¦é¦–å…ˆé˜…è¯»çš„å†…å®¹ï¼Œä¾‹å¦‚ <a href="http://nginx.org/en/docs/">nginx document</a>ï¼Œ<a href="https://ffmpeg.org/documentation.html">FFmpeg document</a>ï¼Œâ€¦â€¦æˆ‘æ¯”è¾ƒå–œæ¬¢ä½¿ç”¨ <a href="https://kapeli.com/dash">Dash</a> è¿™æ¬¾ MacOS ä¸Šçš„è¿™æ¬¾ API document å·¥å…·ï¼ŒçœŸçš„éå¸¸æ–¹ä¾¿ã€‚æ¯å½“ä½¿ç”¨ä¸€ä¸ªæ–°çš„ API æˆ–è€…ä½¿ç”¨ä¸€ä¸ªè‡ªå·±æ‹¿ä¸å‡†çš„ API çš„æ—¶å€™ï¼ŒDash æ€»æ˜¯æˆ‘æœ€å¥½çš„å¸®æ‰‹ã€‚<br>
<img src="/2021/09/11/How-to-Read-and-Use-the-Open-Source-Projects/5.png" alt></li>
</ul>
</li>
<li>
<p>API å¯¹åº”çš„ä»£ç æ³¨é‡Š<br>
å¾ˆå¤šçš„é¡¹ç›®ï¼Œå°¤å…¶æ˜¯ä¼˜ç§€çš„é¡¹ç›®ä¼šæœ‰éå¸¸ä¼˜ç§€çš„ä»£ç æ³¨é‡Šï¼ˆå¾ˆå¤šæ–‡æ¡£ä¹Ÿå¯èƒ½æ˜¯ä»ä»£ç æ³¨é‡Šä¸­è‡ªåŠ¨ç”Ÿæˆçš„ï¼‰ã€‚å› æ­¤ï¼Œåœ¨åŠ¨æ‰‹å†™ä»£ç ä¹‹å‰ï¼Œæœ€å¥½è¿˜æ˜¯å†è®¤çœŸé˜…è¯»ä»¥ä¸‹é¡¹ç›®ä»£ç ä¸­çš„æ³¨é‡Šï¼Œè¿™å¯¹äºæˆ‘ä»¬ç†è§£æ‰€å¼•ç”¨çš„é¡¹ç›®ä¼šæœ‰å¾ˆå¤§å¥½å¤„ã€‚</p>
<p>åœ¨æˆ‘çš„å·¥ä½œä¸­ï¼Œæˆ‘ç»å¸¸ä¼šä»å¼€æºä»£ç çš„æ³¨é‡Šä¸­è·å–çµæ„Ÿï¼Œè¿›è€Œæ‰¾åˆ°è§£å†³æˆ‘æ‰€é‡åˆ°çš„é—®é¢˜çš„æ€è·¯ï¼š</p>
<ul>
<li>åœ¨ <a href="/2021/09/09/Draw-Circle-Frame-Number-for-Each-Secnod-Using-FFmpeg/">ç”¨ FFmpeg æŠŠä»¥ç§’ä¸ºå‘¨æœŸçš„å¸§åºå·ä¿¡æ¯å†™å…¥åˆ°è§†é¢‘</a> ä¸€æ–‡ä¸­ï¼Œæˆ‘é€šè¿‡é˜…è¯» <a href="https://github.com/FFmpeg/FFmpeg/blob/master/libavfilter/avfilter.h">AVFilter</a> çš„æ³¨é‡Šæ‰¾åˆ°äº†å®ç°â€œæŠŠå½“å‰å¸§æ˜¯æ¯ç§’ä¸­çš„ç¬¬å‡ å¸§çš„ä¿¡æ¯å¢åŠ åˆ°è§†é¢‘ä¸­â€çš„æ€è·¯ã€‚</li>
<li>åœ¨ è§£å†³ <a href="https://github.com/wangwei1237/CameraHook">Android æ‘„åƒå¤´æ•°æ® Hook é—®é¢˜</a> æ—¶ï¼Œæˆ‘ä»é˜…è¯» <a href="https://android.googlesource.com/platform/frameworks/base/+/refs/heads/master/graphics/java/android/graphics/SurfaceTexture.java">android.graphics.SurfaceTexture</a> çš„æºç æ³¨é‡Šä¸­æ‰¾åˆ°äº†è§£å†³æ–¹æ¡ˆã€‚</li>
<li>â€¦â€¦</li>
</ul>
</li>
<li>
<p>é˜…è¯»é¡¹ç›®ä¸­ç»™å‡ºçš„ç¤ºä¾‹ä»£ç <br>
å¾ˆå¤šé¡¹ç›®ä¼šç›´æ¥ä»¥æºä»£ç çš„å½¢å¼ç»™å‡ºç¤ºä¾‹ä»£ç ï¼Œè¿™äº›ä»£ç ä¼šæ”¾åœ¨å¦‚ä¸‹çš„ç›®å½•ä¸­ï¼š</p>
<ul>
<li>test ç›®å½•</li>
<li>example ç›®å½•</li>
<li>â€¦â€¦</li>
</ul>
<p>åœ¨åŠ¨æ‰‹å†™ä»£ç ä¹‹å‰ï¼ŒçœŸçš„å»ºè®®å¤§å®¶åœ¨è¿™äº›ç›®å½•ä¸‹å°è¯•æ‰¾åˆ°é¡¹ç›®ç»™å‡ºçš„ä½¿ç”¨æ¡ˆä¾‹ã€‚åœ¨æˆ‘çš„é¡¹ç›®ä¸­ï¼Œæ¯æ¬¡éœ€è¦ç”¨åˆ° FFmpeg æ¥å¸®æˆ‘å®Œæˆå·¥ä½œæ—¶ï¼Œæˆ‘æ€»æ˜¯ä¼šç¬¬ä¸€æ—¶é—´å» <code>ffmpeg</code>ï¼Œ<code>ffprobe</code>ï¼Œ<code>ffplay</code> è¿™ä¸‰ä¸ªå·¥å…·çš„å®ç°ä¸­æ‰¾åˆ°çµæ„Ÿã€‚</p>
</li>
</ol>
<h4 id="3-æ…ç”¨æœç´¢å¼•æ“">3. æ…ç”¨æœç´¢å¼•æ“</h4>
<p>çœŸçš„ï¼Œé™¤éä¸‡ä¸å¾—å·²ï¼Œé™¤éæ˜¯æˆ‘ä»¬åœ¨æ‰§è¡Œäº†å¦‚ä¸Šçš„æ­¥éª¤ä¹‹åè¿˜æ²¡æœ‰æ‰¾åˆ°è§£å†³æ–¹æ¡ˆæ—¶ï¼Œæˆ‘ä»¬æ‰éœ€è¦è¿ç”¨æœç´¢å¼•æ“æ¥å¸®æˆ‘ä»¬æ‰¾å‡ºå¦‚ä½•ä½¿ç”¨æŸä¸ªé¡¹ç›®ä¸­çš„ç‰¹å®šèƒ½åŠ›çš„æ–¹æ³•ã€‚æˆ‘éå¸¸ä¸å»ºè®®ä¸€å¼€å§‹å°±è¿ç”¨æœç´¢å¼•æ“ï¼Œå½“ç„¶è¿™åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹å¯èƒ½ä¼šè§£å†³æˆ‘ä»¬çš„é—®é¢˜ï¼Œä½†æ˜¯æˆ‘ä»¬ä¼šå› ä¸ºä½¿ç”¨æœç´¢å¼•æ“è€Œé”™è¿‡è·å¾—æ›´å¤šçŸ¥è¯†ã€é”™è¿‡æ›´å…¨é¢çš„äº†è§£æˆ‘ä»¬å°†è¦ä½¿ç”¨çš„å¯¹è±¡çš„æœºä¼šã€‚</p>
<p>å¹¶ä¸”ï¼Œæˆ‘ä»¬ä»æœç´¢å¼•æ“è·å¾—çš„æ–¹æ¡ˆæœ‰æ—¶å€™å¯èƒ½ä¼šå­˜åœ¨é—®é¢˜ï¼Œæˆ‘åœ¨ <a href="/2021/01/19/FFMpeg-decode-process-and-lose-frame-in-that-process/">FFmpeg è§£ç  API ä»¥åŠåœ¨è§£ç è¿‡ç¨‹ä¸­å­˜åœ¨çš„ä¸¢å¸§é—®é¢˜</a> ä¸­æåˆ°çš„è§£ç ä¸¢å¸§é—®é¢˜å°±æ˜¯é€šè¿‡æœç´¢å¼•æ“è€Œå¾—åˆ°çš„æ–¹æ¡ˆã€‚å°¤å…¶æ˜¯å½“æˆ‘ä»¬è¿˜å¤„äºæŸæ–¹é¢çš„æ–°æ‰‹çš„æ—¶å€™ï¼Œè¿™ç§æƒ…å†µå‡ºç°çš„å¯èƒ½ä¼šæ›´å¤§ã€‚</p>
<h2 id="å–„ç”¨åˆ«äººçš„ä»£ç ">å–„ç”¨åˆ«äººçš„ä»£ç </h2>
<p>å–„ç”¨åˆ«äººçš„é¡¹ç›®è®©æˆ‘ä»¬å¯ä»¥ç«™åœ¨å·¨äººçš„è‚©è†€ä¸Šå·¥ä½œï¼Œæœ€é‡è¦çš„æ˜¯æˆ‘ä»¬éœ€è¦äº†è§£ã€ç†Ÿæ‚‰æˆ‘ä»¬æ‰€ç”¨çš„ä»£ç ã€‚å¦åˆ™ï¼Œæˆ‘ä»¬ä¸ä½†æ²¡æœ‰åˆ©ç”¨è¿™ä¸ªé¡¹ç›®çš„ä¼˜åŠ¿ï¼Œåè€Œè®©è‡ªå·±çš„é¡¹ç›®å˜æˆäº†æé¾™ã€‚</p>
<p><img src="/2021/09/11/How-to-Read-and-Use-the-Open-Source-Projects/4.jpeg" alt></p>
<h2 id="åè®°">åè®°</h2>
<p>é’ˆå¯¹æ–‡ç« ä¸­æåˆ°çš„ <code>FindFFmpeg.cmake</code> æ’ä»¶ï¼Œåæ¥ï¼Œå½“æˆ‘ä»¬å°†è¯¥æ’ä»¶åº”ç”¨åˆ°è‡ªå·±ç¼–è¯‘çš„ <code>FFmpeg</code> ä¹‹åï¼Œæˆ‘ä»¬å‘ç°è¿™ä¸ªæ’ä»¶æ— æ³•æ­£å¸¸å·¥ä½œã€‚ç›´åˆ°è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘å’Œæˆ‘çš„åŒäº‹æ‰å¼€å§‹ä»”ç»†é˜…è¯»è¿™ä¸ªæ’ä»¶çš„ä»£ç ï¼Œæœ€åå‘ç°å¹¶ä¸”ä¿®å¤äº†å­˜åœ¨çš„ <a href="https://github.com/snikulov/cmake-modules/pull/2">BUG</a>ã€‚æˆ‘ä»¬å‘ç°ï¼Œå…¶å®ï¼Œå’Œå¼€æºè½¯ä»¶ä¸€èµ·æˆé•¿çœŸçš„éå¸¸å¿«ä¹ã€‚æˆ‘ä»¬è¦å–„ç”¨åˆ«äººçš„ä»£ç ï¼ŒåŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿè¦ä¸€èµ·ä¸ºå·¨äººçš„æˆé•¿ä»˜å‡ºåº”æœ‰çš„åŠªåŠ›ã€‚</p>
]]></content>
      <categories>
        <category>æ–‡åŒ–</category>
      </categories>
      <tags>
        <tag>ä»£ç é˜…è¯»</tag>
      </tags>
  </entry>
  <entry>
    <title>ç”¨ FFmpeg æŠŠä»¥ç§’ä¸ºå‘¨æœŸçš„å¸§åºå·ä¿¡æ¯å†™å…¥åˆ°è§†é¢‘</title>
    <url>/2021/09/09/Draw-Circle-Frame-Number-for-Each-Secnod-Using-FFmpeg/</url>
    <content><![CDATA[<p>åˆ©ç”¨ FFmpeg çš„ <a href="https://ffmpeg.org/ffmpeg-filters.html#drawtext-1"><strong>drawtext</strong></a> æ»¤é•œï¼Œæˆ‘ä»¬å¯ä»¥æŠŠç‰¹å®šçš„æ–‡æœ¬ä¿¡æ¯ç»˜åˆ¶äºè§†é¢‘ä¹‹ä¸Šã€‚FFmpeg çš„ <strong>drawtext</strong> æ»¤é•œå¯ä»¥ç»˜åˆ¶çš„æ–‡æœ¬ä¿¡æ¯å¯ä»¥å‚è§æ–‡æ¡£ <a href="https://ffmpeg.org/ffmpeg-filters.html#Text-expansion">Text expansion</a> ä¸­çš„æè¿°ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè§†é¢‘çš„å¸§å·ä¿¡æ¯æç»˜åœ¨è§†é¢‘ä¸Šï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> ffmpeg -i test.mp4 -vf drawtext=text=%&#123;n&#125;:x=50:y=50 -y output.mp4</span></span><br></pre></td></tr></table></figure>
<p>æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬æƒ³ç»˜åˆ¶ä¸€äº›ç‰¹æ®Šçš„å†…å®¹ï¼Œæ¯”å¦‚ï¼š<strong>å½“å‰å¸§æ˜¯æ¯ç§’ä¸­çš„ç¬¬å‡ å¸§</strong>ï¼Ÿè¿™æ˜¯ä¸€ä»¶æœ‰è¶£çš„äº‹æƒ…ï¼Œä½†æ˜¯ <strong>drawtext</strong> å´æ²¡åŠæ³•æ”¯æŒè¿™ç§å†…å®¹çš„ç»˜åˆ¶ã€‚åœ¨å¤§å¤šæ•°åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬å‡ ä¹ç”¨æˆ·åˆ°è¿™ç§ç‰¹æ®Šçš„åŠŸèƒ½ï¼Œä½†æ˜¯ï¼Œå¦‚æœé‡åˆ°äº†ï¼Œæˆ‘ä»¬å¦‚ä½•è§£å†³å‘¢ï¼Ÿ</p>
<span id="more"></span>
<h2 id="ä¸å¯¹å†™å…¥ä¿¡æ¯åšä»»ä½•æ”¹å˜">ä¸å¯¹å†™å…¥ä¿¡æ¯åšä»»ä½•æ”¹å˜</h2>
<p>å®é™…ä¸Šï¼Œä¸è¿›è¡Œä»»ä½•æ”¹å˜ä¹Ÿå¯ä»¥å®ç°ç›®çš„ï¼Œåªæ˜¯æˆ‘ä»¬éœ€è¦å¯¹ç°æœ‰çš„å·¥å…·è¿›è¡Œä¸€å®šç¨‹åº¦çš„æ•´åˆã€‚ä¸€èˆ¬è€Œè¨€ï¼Œå†™å…¥ç‰¹æ®Šä¿¡æ¯åˆ°è§†é¢‘ä¸­å»åï¼Œæˆ‘ä»¬ä¼šåœ¨åç»­çš„å¤„ç†ä¸­æå–è¯¥ä¿¡æ¯ï¼Œç„¶åè¿›è¡Œå¾ˆå¤šé€»è¾‘åˆ¤æ–­ã€‚</p>
<p>å†™å…¥ä¿¡æ¯ä¸åšæ”¹å˜ï¼Œé‚£ä¹ˆå°±éœ€è¦åœ¨æå–ä¿¡æ¯æˆ–è€…æ›´é åçš„æ­¥éª¤è¿›è¡Œæ”¹å˜ã€‚å®é™…ä¸Šæˆ‘ä»¬å¯ä»¥åœ¨æœ€åä½¿ç”¨åˆ°è¯¥ä¿¡æ¯çš„æ­¥éª¤ä¸­è¿›è¡Œåˆ¤æ–­å°±å¯ä»¥äº†ï¼Œå…·ä½“å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="/2021/09/09/Draw-Circle-Frame-Number-for-Each-Secnod-Using-FFmpeg/1.png" alt></p>
<h2 id="ä¿®æ”¹-drawtext-æ»¤é•œ">ä¿®æ”¹ drawtext æ»¤é•œ</h2>
<p>å¯ä»¥ä½¿ç”¨å¸‚é¢ä¸Šçš„è§†é¢‘ç¼–è¾‘è½¯ä»¶æŠŠ<strong>å½“å‰å¸§æ˜¯æ¯ç§’ä¸­çš„ç¬¬å‡ å¸§</strong>çš„ä¿¡æ¯å¢åŠ åˆ°è§†é¢‘ä¸­ï¼Œä½†æ˜¯è¿™ç§æ‰‹å·¥æ“ä½œçš„æ–¹å¼è¿˜æ˜¯å­˜åœ¨ä¸€å®šçš„å¤æ‚åº¦ã€‚</p>
<p>æ—¢ç„¶ drawtext æ»¤é•œå·²ç»æä¾›å†™å…¥å¸§å·ä¿¡æ¯çš„èƒ½åŠ›äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ˜¯å¦å¯ä»¥åœ¨ drawtext æ»¤é•œçš„åŸºç¡€ä¸Šæ¥å®ç°æˆ‘ä»¬çš„ç›®æ ‡å‘¢ï¼Ÿ</p>
<p>å¸¦ç€é—®é¢˜ï¼Œé˜…è¯»äº† drawtext æ»¤é•œçš„æºç ï¼Œå‘ç°è¿˜çœŸå¯ä»¥å®ç°ã€‚</p>
<p>drawtext æ»¤é•œä½¿ç”¨å¦‚ä¸‹çš„ä»£ç è·å–å½“å‰å¸§çš„å¸§åºå·ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">s-&gt;var_values[VAR_N] = inlink-&gt;frame_count_out + s-&gt;start_number;</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­ï¼Œ <code>inlink</code> ä¸º <code>AVFilterLink</code> ç±»å‹çš„å˜é‡ï¼Œè€Œ <code>AVFilterLink</code> æœ¬èº«å°±æä¾›äº† <code>frame_rate</code> ä¿¡æ¯ã€‚</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">AVFilterLink</span> &#123;</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * Frame rate of the stream on the link, or 1/0 if unknown or variable;</span></span><br><span class="line"><span class="comment">    * if left to 0/0, will be automatically copied from the first input</span></span><br><span class="line"><span class="comment">    * of the source filter if it exists.</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * Sources should set it to the best estimation of the real frame rate.</span></span><br><span class="line"><span class="comment">    * If the source frame rate is unknown or variable, set this to 1/0.</span></span><br><span class="line"><span class="comment">    * Filters should update it if necessary depending on their function.</span></span><br><span class="line"><span class="comment">    * Sinks can use it to set a default output frame rate.</span></span><br><span class="line"><span class="comment">    * It is similar to the r_frame_rate field in AVStream.</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    AVRational frame_rate;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥å‘ç°ï¼Œå¯¹ drawtext æ»¤é•œç¨åŠ æ”¹é€ ï¼Œå°±å¯ä»¥å®ç°ç›®æ ‡ï¼Œå…·ä½“æ€è·¯å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">AVRational frame_rate = inlink-&gt;frame_rate;</span><br><span class="line"><span class="keyword">int</span> fps = frame_rate.num / frame_rate.den;</span><br><span class="line">s-&gt;var_values[VAR_N] = (inlink-&gt;frame_count_out + s-&gt;start_number) % fps;</span><br></pre></td></tr></table></figure>
<p>ä¸ºäº†å¢åŠ  drawtext çš„å…¼å®¹æ€§ï¼Œå¯ä»¥ä¸ºè¯¥æ»¤é•œå¢åŠ ä¸€ä¸ªå‚æ•°æ¥ï¼Œä»¥æ§åˆ¶å½“<code>text=%&#123;n&#125;</code>çš„æ—¶å€™ï¼Œæ»¤é•œç»˜åˆ¶çš„å¸§å·ç©¶ç«Ÿæ˜¯è¿ç»­çš„å¸§å·è¿˜æ˜¯å¸§å·å¯¹å¸§ç‡çš„æ¨¡ã€‚</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">AVRational frame_rate = inlink-&gt;frame_rate;</span><br><span class="line"><span class="keyword">if</span> (s-&gt;c &amp;&amp; frame_rate.den &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">int</span> fps = frame_rate.num / frame_rate.den;</span><br><span class="line">    s-&gt;var_values[VAR_N] = (inlink-&gt;frame_count_out + s-&gt;start_number) % fps;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    s-&gt;var_values[VAR_N] = inlink-&gt;frame_count_out + s-&gt;start_number;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¯¦ç»†çš„ä¿®æ”¹ä»£ç å¯ä»¥å‚è§ <a href="https://github.com/wangwei1237/wangwei1237.github.io/blob/master/2021/09/09/Draw-Circle-Frame-Number-for-Each-Secnod-Using-FFmpeg/vf_drawtext.patch">vf_drawtext.patch</a>ã€‚</p>
<h2 id="ä¿®æ”¹-drawtext-ä¹‹åçš„æ•ˆæœ">ä¿®æ”¹ drawtext ä¹‹åçš„æ•ˆæœ</h2>
<p>æ­¤æ—¶ï¼Œæˆ‘ä»¬åˆ©ç”¨ä¿®æ”¹åçš„ drawtext æ»¤é•œæ¥ç”Ÿæˆæˆ‘ä»¬éœ€è¦è§†é¢‘ï¼Œå…·ä½“æ“ä½œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> ffmpeg -i test.mp4 -vf drawtext=text=%&#123;n&#125;:x=50:y=50:c=1 -y output.mp4</span></span><br></pre></td></tr></table></figure>
<p>ç”Ÿæˆçš„è§†é¢‘å…·ä½“å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="bili_video"><div style="position: relative; width: 100%; height: 0; padding-bottom: 75%;"><iframe src="https://player.bilibili.com/player.html?aid=975468511&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position: absolute; width: 100%; height: 100%; left: 0; top: 0;"> </iframe></div></div>
]]></content>
      <categories>
        <category>è§†é¢‘æŠ€æœ¯</category>
      </categories>
      <tags>
        <tag>FFmpeg</tag>
      </tags>
  </entry>
  <entry>
    <title>è§†é¢‘å‹ç¼©æ ‡å‡†å‘å±•ç®€å²</title>
    <url>/2021/07/27/The-History-of-the-Video-Codec-Improvement/</url>
    <content><![CDATA[<p>å¤šå¹´ä»¥æ¥ï¼Œäººä»¬è®¾è®¡å‡ºè®¸å¤šä¸åŒçš„ç®—æ³•æ¥å‹ç¼©è§†é¢‘ã€‚è§†é¢‘å‹ç¼©è™½ç„¶å¬èµ·æ¥æ˜¯ä¸€ä¸ªå¾ˆç°ä»£çš„è¯ï¼Œä½†å…¶å®å®ƒä»æ¨¡æ‹Ÿè§†é¢‘å¼€å§‹ï¼Œå·²ç»æœ‰å¾ˆé•¿çš„å†å²äº†ã€‚åœ¨æœ¬ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä¼šå‘å¤§å®¶ä¸€ä¸€ä»‹ç»è§†é¢‘å‹ç¼©å²ä¸Šçš„é‡Œç¨‹ç¢‘äº‹ä»¶ï¼Œæ­£æ˜¯è¿™äº›äº‹ä»¶çš„å‘ç”Ÿæ‰æœ‰äº†ä»Šå¤©çš„è§†é¢‘å‹ç¼©ã€‚ä»è¿‡å»åˆ°ç°åœ¨ï¼Œå„ç±»è§†é¢‘å‹ç¼©æ–¹æ³•ç”±æœ€åˆçš„æ¦‚å¿µæœ€ç»ˆæ¼”åŒ–æˆç°ä»Šçš„æ ‡å‡†ã€‚å¾ˆå¤šå‹ç¼©æ ‡å‡†ä»Šå¤©è¿˜åœ¨ä½¿ç”¨ï¼Œäººä»¬ä¹Ÿä¸€ç›´åœ¨ç»§ç»­å¼€å‘å’Œå®Œå–„æ–°çš„æ ‡å‡†ã€‚<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup></p>
<p>æœ¬æ–‡ä»…ä»…æ˜¯å¯¹æ–‡çŒ®<sup class="footnote-ref"><a href="#fn1" id="fnref1:1">[1:1]</a></sup>çš„è¿›ä¸€æ­¥æ•´ç†ï¼Œç”¨æ—¶é—´è½´çš„å½¢å¼æŠŠè§†é¢‘å‹ç¼©ç®—æ³•çš„æ¼”è¿›å†ç¨‹æ›´å¥½çš„è¡¨ç°å‡ºæ¥ã€‚</p>
<style>
    .cd-timeline.svelte-1aijmz5 .svelte-1aijmz5,.cd-timeline.svelte-1aijmz5 .svelte-1aijmz5::after,.cd-timeline.svelte-1aijmz5 .svelte-1aijmz5::before{-webkit-box-sizing:border-box;box-sizing:border-box}.cd-timeline.svelte-1aijmz5{font-size:1.6rem;font-family:"Droid Serif", serif;color:#7f8c97;background-color:#e9f0f5}.cd-timeline.svelte-1aijmz5 a{color:#acb7c0;text-decoration:none}.cd-timeline.svelte-1aijmz5 img{max-width:100%}.cd-timeline.svelte-1aijmz5 h1,h2{font-family:"Open Sans", sans-serif;font-weight:bold}.cd-timeline.svelte-1aijmz5{overflow:hidden;margin:2em auto}.cd-timeline__container.svelte-1aijmz5{position:relative;width:90%;max-width:1170px;margin:0 auto;padding:2em 0}.cd-timeline__container.svelte-1aijmz5::before{content:'';position:absolute;top:0;left:18px;height:100%;width:4px;background:#d7e4ed}@media only screen and (min-width: 1170px){.cd-timeline.svelte-1aijmz5{margin-top:3em;margin-bottom:3em}.cd-timeline__container.svelte-1aijmz5::before{left:50%;margin-left:-2px}}.cd-timeline__block.svelte-1aijmz5{position:relative;margin:2em 0}.cd-timeline__block.svelte-1aijmz5:after{content:"";display:table;clear:both}.cd-timeline__block.svelte-1aijmz5:first-child{margin-top:0}.cd-timeline__block.svelte-1aijmz5:last-child{margin-bottom:0}@media only screen and (min-width: 1170px){.cd-timeline__block.svelte-1aijmz5{margin:4em 0}}.cd-timeline__img.svelte-1aijmz5{position:absolute;top:0;left:0;width:40px;height:40px;border-radius:50%;-webkit-box-shadow:0 0 0 4px white, inset 0 2px 0 rgba(0, 0, 0, 0.08), 0 3px 0 4px rgba(0, 0, 0, 0.05);box-shadow:0 0 0 4px white, inset 0 2px 0 rgba(0, 0, 0, 0.08), 0 3px 0 4px rgba(0, 0, 0, 0.05)}.cd-timeline__img.svelte-1aijmz5{background:#75ce66}@media only screen and (min-width: 1170px){.cd-timeline__img.svelte-1aijmz5{width:50px;height:50px;left:50%;margin-left:-25px;-webkit-transform:translateZ(0);transform:translateZ(0)}}@-webkit-keyframes svelte-1aijmz5-cd-bounce-1{0%{opacity:0;-webkit-transform:scale(0.5);transform:scale(0.5)}60%{opacity:1;-webkit-transform:scale(1.2);transform:scale(1.2)}100%{-webkit-transform:scale(1);transform:scale(1)}}@keyframes svelte-1aijmz5-cd-bounce-1{0%{opacity:0;-webkit-transform:scale(0.5);transform:scale(0.5)}60%{opacity:1;-webkit-transform:scale(1.2);transform:scale(1.2)}100%{-webkit-transform:scale(1);transform:scale(1)}}.cd-timeline__content.svelte-1aijmz5{position:relative;margin-left:60px;background:white;border-radius:0.25em;padding:1em;-webkit-box-shadow:0 3px 0 #d7e4ed;box-shadow:0 3px 0 #d7e4ed}.cd-timeline__content.svelte-1aijmz5:after{content:"";display:table;clear:both}.cd-timeline__content.svelte-1aijmz5::before{content:'';position:absolute;top:16px;right:100%;height:0;width:0;border:7px solid transparent;border-right:7px solid white}.cd-timeline__content.svelte-1aijmz5 h2.svelte-1aijmz5{color:#303e49}.cd-timeline__content.svelte-1aijmz5 p,.cd-timeline__date.svelte-1aijmz5{font-size:1.3rem}.cd-timeline__content.svelte-1aijmz5 p{margin:1em 0;line-height:1.6}.cd-timeline__date.svelte-1aijmz5{display:inline-block}.cd-timeline__date.svelte-1aijmz5{float:left;padding:.8em 0;opacity:.7}@media only screen and (min-width: 768px){.cd-timeline__content.svelte-1aijmz5 h2.svelte-1aijmz5{font-size:2rem}.cd-timeline__content.svelte-1aijmz5 p{font-size:1.6rem}.cd-timeline__date.svelte-1aijmz5{font-size:1.4rem}}@media only screen and (min-width: 1170px){.cd-timeline__content.svelte-1aijmz5{margin-left:0;padding:1.6em;width:45%;-webkit-transform:translateZ(0);transform:translateZ(0)}.cd-timeline__content.svelte-1aijmz5::before{top:24px;left:100%;border-color:transparent;border-left-color:white}.cd-timeline__date.svelte-1aijmz5{position:absolute;width:100%;left:122%;top:6px;font-size:1.6rem}.cd-timeline__block.svelte-1aijmz5:nth-child(even) .cd-timeline__content.svelte-1aijmz5{float:right}.cd-timeline__block.svelte-1aijmz5:nth-child(even) .cd-timeline__content.svelte-1aijmz5::before{top:24px;left:auto;right:100%;border-color:transparent;border-right-color:white}.cd-timeline__block.svelte-1aijmz5:nth-child(even) .cd-timeline__date.svelte-1aijmz5{left:auto;right:122%;text-align:right}}@-webkit-keyframes svelte-1aijmz5-cd-bounce-2{0%{opacity:0;-webkit-transform:translateX(-100px);transform:translateX(-100px)}60%{opacity:1;-webkit-transform:translateX(20px);transform:translateX(20px)}100%{-webkit-transform:translateX(0);transform:translateX(0)}}@keyframes svelte-1aijmz5-cd-bounce-2{0%{opacity:0;-webkit-transform:translateX(-100px);transform:translateX(-100px)}60%{opacity:1;-webkit-transform:translateX(20px);transform:translateX(20px)}100%{-webkit-transform:translateX(0);transform:translateX(0)}}@-webkit-keyframes svelte-1aijmz5-cd-bounce-2-inverse{0%{opacity:0;-webkit-transform:translateX(100px);transform:translateX(100px)}60%{opacity:1;-webkit-transform:translateX(-20px);transform:translateX(-20px)}100%{-webkit-transform:translateX(0);transform:translateX(0)}}@keyframes svelte-1aijmz5-cd-bounce-2-inverse{0%{opacity:0;-webkit-transform:translateX(100px);transform:translateX(100px)}60%{opacity:1;-webkit-transform:translateX(-20px);transform:translateX(-20px)}100%{-webkit-transform:translateX(0);transform:translateX(0)}}
    </style>
<section class="cd-timeline js-cd-timeline svelte-1aijmz5">
    <div class="cd-timeline__container svelte-1aijmz5">
        <div class="cd-timeline__block js-cd-block svelte-1aijmz5">
            <div class="cd-timeline__img cd-timeline__img--movie js-cd-img svelte-1aijmz5">
            </div>
            <div class="cd-timeline__content js-cd-content svelte-1aijmz5">
                <h2 class="svelte-1aijmz5">å¸§é—´å‹ç¼©é¦–æ¬¡å‡ºç°</h2>
                <p>è‹±å›½çš„ R.D. Kell æå‡ºå°†å¸§é—´å‹ç¼©ç”¨äºæ¨¡æ‹Ÿè§†é¢‘ï¼Œè¿™ä¸€æ¦‚å¿µéšåä¾¿å»¶ç»­ä¸‹æ¥å¹¶åº”ç”¨åœ¨ä»Šå¤©çš„æ•°å­—è§†é¢‘ä¸Šã€‚</p>

                <span class="cd-timeline__date svelte-1aijmz5">1929</span>
            </div>
        </div><div class="cd-timeline__block js-cd-block svelte-1aijmz5">
            <div class="cd-timeline__img cd-timeline__img--movie js-cd-img svelte-1aijmz5">
            </div>
            <div class="cd-timeline__content js-cd-content svelte-1aijmz5">
                <h2 class="svelte-1aijmz5">å·®åˆ†è„‰å†²ç¼–ç è°ƒåˆ¶</h2>
                <span id="more"></span>
<p>è´å°”å®éªŒå®¤çš„ B.M. Oliver å’Œ C.W. Harrison æå‡ºå¯ä»¥åœ¨è§†é¢‘ç¼–ç ä¸­ä½¿ç”¨å·®åˆ†è„‰å†²ç¼–ç è°ƒåˆ¶ï¼ˆDPCMï¼‰ã€‚åœ¨æ­¤ä¹‹å‰ï¼ŒDPCM ä¸€ç›´è¢«ç”¨äºéŸ³é¢‘ï¼ˆä»Šå¤©ä¾ç„¶å¦‚æ­¤ï¼‰ã€‚</p>

                <span class="cd-timeline__date svelte-1aijmz5">1952</span>
            </div>
        </div><div class="cd-timeline__block js-cd-block svelte-1aijmz5">
            <div class="cd-timeline__img cd-timeline__img--movie js-cd-img svelte-1aijmz5">
            </div>
            <div class="cd-timeline__content js-cd-content svelte-1aijmz5">
                <h2 class="svelte-1aijmz5">ä½¿ç”¨æ—¶é—´å‹ç¼©çš„å¸§é—´é¢„æµ‹ç¼–ç </h2>
                <p>æ—¥æœ¬å¹¿æ’­å…¬å¸ï¼ˆNHKï¼‰çš„ç ”ç©¶äººå‘˜ Y. Takiã€M. Hatori å’Œ S. Tanaka æå‡ºä½¿ç”¨æ—¶é—´å‹ç¼©çš„é¢„æµ‹æ€§å¸§é—´è§†é¢‘ç¼–ç çš„æ¦‚å¿µã€‚</p>

                <span class="cd-timeline__date svelte-1aijmz5">1959</span>
            </div>
        </div><div class="cd-timeline__block js-cd-block svelte-1aijmz5">
            <div class="cd-timeline__img cd-timeline__img--movie js-cd-img svelte-1aijmz5">
            </div>
            <div class="cd-timeline__content js-cd-content svelte-1aijmz5">
                <h2 class="svelte-1aijmz5">è¡Œç¨‹é•¿åº¦ç¼–ç </h2>
                <p>ä¼¦æ•¦å¤§å­¦çš„ç ”ç©¶äººå‘˜ A.H. Robinson å’Œ C. Cherry æå‡ºè¡Œç¨‹ç¼–ç è¿™ä¸€æ¦‚å¿µï¼Œæœ€åˆç”¨äºé™ä½æ¨¡æ‹Ÿç”µè§†ä¿¡å·çš„ä¼ è¾“å¸¦å®½ã€‚ä»Šå¤©ï¼Œè¡Œç¨‹é•¿åº¦ç¼–ç ä»åœ¨æ•°å­—è§†é¢‘ä¸­ä½¿ç”¨ã€‚</p>

                <span class="cd-timeline__date svelte-1aijmz5">1967</span>
            </div>
        </div><div class="cd-timeline__block js-cd-block svelte-1aijmz5">
            <div class="cd-timeline__img cd-timeline__img--movie js-cd-img svelte-1aijmz5">
            </div>
            <div class="cd-timeline__content js-cd-content svelte-1aijmz5">
                <h2 class="svelte-1aijmz5">CCDï¼ˆç”µè·è€¦åˆå…ƒä»¶ï¼‰é—®ä¸–</h2>
                <p>ç¾å›½è´å°”å®éªŒå®¤çš„ Willard S. Boyle å’Œ GeorgeE. Smith å‘æ˜ä¸–ç•Œä¸Šç¬¬ä¸€ä¸ªåŠå¯¼ä½“å›¾åƒä¼ æ„Ÿå™¨ CCDã€‚</p>

                <span class="cd-timeline__date svelte-1aijmz5">1969</span>
            </div>
        </div><div class="cd-timeline__block js-cd-block svelte-1aijmz5">
            <div class="cd-timeline__img cd-timeline__img--movie js-cd-img svelte-1aijmz5">
            </div>
            <div class="cd-timeline__content js-cd-content svelte-1aijmz5">
                <h2 class="svelte-1aijmz5">æ•°å­—è§†é¢‘é¦–æ¬¡å‹ç¼©</h2>
                <p>å ªè¨æ–¯å·ç«‹å¤§å­¦çš„ Nasir Ahmed æå‡ºä½¿ç”¨ DCT ç¼–ç å‹ç¼©å›¾åƒã€‚DCT å°†å›¾åƒåˆ†æˆç”±ä¸åŒé¢‘ç‡ç»„æˆçš„å°å—ï¼Œåœ¨é‡åŒ–è¿‡ç¨‹ä¸­ï¼Œèˆå¼ƒé«˜é¢‘åˆ†é‡ï¼Œå‰©ä¸‹çš„ä½é¢‘åˆ†é‡è¢«ä¿å­˜ä¸‹æ¥å¹¶ç”¨äºåé¢çš„å›¾åƒé‡å»ºã€‚</p>

                <span class="cd-timeline__date svelte-1aijmz5">1972</span>
            </div>
        </div><div class="cd-timeline__block js-cd-block svelte-1aijmz5">
            <div class="cd-timeline__img cd-timeline__img--movie js-cd-img svelte-1aijmz5">
            </div>
            <div class="cd-timeline__content js-cd-content svelte-1aijmz5">
                <h2 class="svelte-1aijmz5">DCTæˆä¸ºä¸€ç§å›¾åƒå‹ç¼©ç®—æ³•</h2>
                <p>Nasir Ahmed ä¸å¾·å…‹è¨æ–¯å¤§å­¦çš„ T. Natarajan å’Œ K.R. Rao åˆä½œï¼Œå®ç°äº†DCTå›¾åƒå‹ç¼©ç®—æ³•ã€‚</p>

                <span class="cd-timeline__date svelte-1aijmz5">1973</span>
            </div>
        </div><div class="cd-timeline__block js-cd-block svelte-1aijmz5">
            <div class="cd-timeline__img cd-timeline__img--movie js-cd-img svelte-1aijmz5">
            </div>
            <div class="cd-timeline__content js-cd-content svelte-1aijmz5">
                <h2 class="svelte-1aijmz5">æ··åˆç¼–ç çš„å‘å±•è¿‡ç¨‹</h2>
                <p>å—åŠ å·å¤§å­¦çš„ Ali Habibi å°†é¢„æµ‹ç¼–ç å’Œ DCT ç¼–ç ç»„åˆåœ¨ä¸€èµ·ä½¿ç”¨ã€‚Habibiçš„ç®—æ³•åªèƒ½åº”ç”¨äºå¸§å†…å›¾åƒï¼Œæ— æ³•é¢„æµ‹å¸§é—´å›¾åƒã€‚</p>

                <span class="cd-timeline__date svelte-1aijmz5">1974</span>
            </div>
        </div><div class="cd-timeline__block js-cd-block svelte-1aijmz5">
            <div class="cd-timeline__img cd-timeline__img--movie js-cd-img svelte-1aijmz5">
            </div>
            <div class="cd-timeline__content js-cd-content svelte-1aijmz5">
                <h2 class="svelte-1aijmz5">æ··åˆç¼–ç çš„è¿›ä¸€æ­¥å‘å±•</h2>
                <p>John A. Roesse å’Œ Guner S. Robinson è¿›ä¸€æ­¥å‘å±•äº† Habibi çš„ç®—æ³•ï¼Œä½¿å®ƒå¯ä»¥åº”ç”¨äºå¸§é—´ã€‚ä¸ºæ­¤ï¼Œä»–ä»¬å°è¯•äº†å„ç§æ–¹æ³•ï¼Œæœ€ç»ˆå‘ç° Ahmed çš„ DCT æŠ€æœ¯å’Œé¢„æµ‹ç¼–ç ç»“åˆèµ·æ¥ä½¿ç”¨æ˜¯æœ€é«˜æ•ˆçš„ã€‚</p>

                <span class="cd-timeline__date svelte-1aijmz5">1975</span>
            </div>
        </div><div class="cd-timeline__block js-cd-block svelte-1aijmz5">
            <div class="cd-timeline__img cd-timeline__img--movie js-cd-img svelte-1aijmz5">
            </div>
            <div class="cd-timeline__content js-cd-content svelte-1aijmz5">
                <h2 class="svelte-1aijmz5">æ›´å¿«çš„DCTç®—æ³•</h2>
                <p>é™ˆæ–‡é›„ã€ C.H. Smith å’ŒS.C. Fralickä¸€èµ·ä¼˜åŒ–äº† DCT ç®—æ³•ï¼Œä»–ä»¬åˆ›ç«‹äº† Compression Labs å…¬å¸ï¼Œå°† DCT å•†ä¸šåŒ–ã€‚</p>

                <span class="cd-timeline__date svelte-1aijmz5">1977</span>
            </div>
        </div><div class="cd-timeline__block js-cd-block svelte-1aijmz5">
            <div class="cd-timeline__img cd-timeline__img--movie js-cd-img svelte-1aijmz5">
            </div>
            <div class="cd-timeline__content js-cd-content svelte-1aijmz5">
                <h2 class="svelte-1aijmz5">é¦–ä¸ªæ•°å­—è§†é¢‘å‹ç¼©æ ‡å‡† H.120 é—®ä¸–</h2>
                <p>å‰æœŸçš„æ‰€æœ‰ç ”ç©¶æœ€ç»ˆå–å¾—ç¬¬ä¸€ä¸ªè§†é¢‘å‹ç¼©æ ‡å‡† H.120 çš„é—®ä¸–ã€‚H.120 ä¸»è¦ç”¨äºè§†é¢‘ä¼šè®®ï¼Œè¿™æ˜¯ä¸€æ¬¡ä¼Ÿå¤§çš„æˆå°±ï¼Œä½†ç”±äº H.120 å¤šæ–¹é¢çš„ä½æ•ˆï¼Œè®¸å¤šå…¬å¸ä¸å¾—ä¸è¯•éªŒå„ç§æ–¹æ³•æ¥å®Œå–„è¿™ä¸ªæ ‡å‡†ã€‚</p>

                <span class="cd-timeline__date svelte-1aijmz5">1984</span>
            </div>
        </div><div class="cd-timeline__block js-cd-block svelte-1aijmz5">
            <div class="cd-timeline__img cd-timeline__img--movie js-cd-img svelte-1aijmz5">
            </div>
            <div class="cd-timeline__content js-cd-content svelte-1aijmz5">
                <h2 class="svelte-1aijmz5">H.261 è·å¾—æ‰¹å‡†</h2>
                <p>H.261 å¾ˆå¯èƒ½æ˜¯ä½ è§è¿‡æˆ–è€…ä½¿ç”¨è¿‡çš„ä¸€ç³»åˆ—ç¼–è§£ç å™¨ä¸­çš„ç¬¬ä¸€ä¸ªã€‚å®ƒæ˜¯ç¬¬ä¸€ä¸ªæœ‰æ•ˆä½¿ç”¨å¸§å†…å’Œå¸§é—´å‹ç¼©æŠ€æœ¯çš„æ•°å­—è§†é¢‘å‹ç¼©æ ‡å‡†ã€‚H.261 ä¹Ÿæ˜¯ç¬¬ä¸€ä¸ªåœ¨å•†ä¸šä¸ŠæˆåŠŸçš„æ•°å­—è§†é¢‘ç¼–ç æ ‡å‡†ã€‚å®ƒè¢«ç”¨äºå…¨ä¸–ç•Œçš„è§†é¢‘ä¼šè®®ï¼Œå¹¶å¼•å…¥æ··åˆçš„åŸºäºå—çš„è§†é¢‘ç¼–ç ï¼Œè¯¥ç¼–ç ä»Šå¤©ä»åœ¨è®¸å¤šè§†é¢‘æ ‡å‡†ï¼ˆMPEG-1 ç¬¬ 2 éƒ¨åˆ†ã€H.262/MPEG-2 ç¬¬ 2 éƒ¨åˆ†ã€H.263 MPEG-4 ç¬¬ 2 éƒ¨åˆ†ã€H.264/MPEG-4 ç¬¬ 10 éƒ¨åˆ†å’Œ HEVCï¼‰ä¸­ä½¿ç”¨ã€‚åˆ›å»º H.261 æ ‡å‡†çš„æ–¹æ³•ä»Šå¤©ä¾ç„¶è¢«å¹¿æ³›ä½¿ç”¨ã€‚</p>
<p>è™½ç„¶è¿™ä¸ªæ ‡å‡†åœ¨å›½é™…ä¸Šå¾ˆå—æ¬¢è¿ï¼Œä½†å®ƒåœ¨åˆšå‘å¸ƒæ—¶å¹¶ä¸å®Œæ•´ã€‚è¯¥æ ‡å‡†åˆ†åˆ«åœ¨ 1990 å¹´å’Œ 1993 å¹´è¿›è¡Œäº†ä¿®è®¢ã€‚H.261 ä¸åŒ…æ‹¬å¤„ç†ç¼–ç çš„ç»†èŠ‚ï¼Œä»…ç”¨äºè§£ç è§†é¢‘ã€‚</p>

                <span class="cd-timeline__date svelte-1aijmz5">1988</span>
            </div>
        </div><div class="cd-timeline__block js-cd-block svelte-1aijmz5">
            <div class="cd-timeline__img cd-timeline__img--movie js-cd-img svelte-1aijmz5">
            </div>
            <div class="cd-timeline__content js-cd-content svelte-1aijmz5">
                <h2 class="svelte-1aijmz5">Motion JPEGï¼ˆMJPEGï¼‰è¢«å‘æ˜</h2>
                <p>Motion JPEG è¢«åˆ›å»ºå‡ºæ¥ç”¨äºè®¡ç®—æœºä¸Šçš„å¤šåª’ä½“åº”ç”¨ã€‚è¿™ç§è§†é¢‘å‹ç¼©æŠ€æœ¯å°†è§†é¢‘æ¯ä¸€å¸§éƒ½åˆ†åˆ«å‹ç¼©æˆJPEGå›¾åƒã€‚</p>

                <span class="cd-timeline__date svelte-1aijmz5">1992</span>
            </div>
        </div><div class="cd-timeline__block js-cd-block svelte-1aijmz5">
            <div class="cd-timeline__img cd-timeline__img--movie js-cd-img svelte-1aijmz5">
            </div>
            <div class="cd-timeline__content js-cd-content svelte-1aijmz5">
                <h2 class="svelte-1aijmz5">å‡ºç°äº†ä½¿ç”¨ MPEG-1 çš„VCD</h2>
                <p>MPEGè¡¨ç¤ºMoving Pictures Experts Groupï¼ˆåŠ¨æ€å›¾åƒä¸“å®¶ç»„ï¼‰ï¼Œå®ƒæ˜¯ISOï¼ˆInternational Standardization Organizationï¼Œå›½é™…æ ‡å‡†åŒ–ç»„ç»‡ï¼‰ä¸IECï¼ˆInternational Electrotechnical Commissionï¼Œå›½é™…ç”µå·¥å§”å‘˜ä¼šï¼‰è”åˆæˆç«‹çš„ä¸“é—¨é’ˆå¯¹åª’ä½“ç¼–ç åˆ¶å®šå›½é™…æ ‡å‡†çš„ç»„ç»‡ã€‚1988å¹´å·¦å³ï¼Œä»–ä»¬å¼€å§‹åˆä½œåˆ¶å®šä»Šå¤©ä¸ºäººæ‰€çŸ¥çš„è§†é¢‘ç¼–ç æ ‡å‡†â€”â€”MPEG-1ã€‚ä¸ H.261 ç±»ä¼¼ï¼ŒMPEG-1è™½ç„¶æä¾›äº†ç¤ºä¾‹å®ç°ï¼Œä½†æ²¡æœ‰åŒ…å«å¦‚ä½•ç¼–ç è§†é¢‘çš„æ ‡å‡†ã€‚å› æ­¤ï¼ŒMPEG-1 ä¼šæ ¹æ®ç¼–ç æ–¹å¼å±•ç°å‡ºæˆªç„¶ä¸åŒçš„æ€§èƒ½ã€‚</p>

                <span class="cd-timeline__date svelte-1aijmz5">1993</span>
            </div>
        </div><div class="cd-timeline__block js-cd-block svelte-1aijmz5">
            <div class="cd-timeline__img cd-timeline__img--movie js-cd-img svelte-1aijmz5">
            </div>
            <div class="cd-timeline__content js-cd-content svelte-1aijmz5">
                <h2 class="svelte-1aijmz5">å‡ºç°äº†ä½¿ç”¨ H.262 å’Œ MPEG-2 çš„ç”µè§†å¹¿æ’­å’Œ DVD</h2>
                <p>MPEG-2 å’Œ H.262 æ˜¯åŒä¸€ä¸ªè§†é¢‘æ ‡å‡†çš„ä¸åŒåç§°ï¼Œå®ƒç”±è®¸å¤šå…¬å¸å…±åŒå¼€å‘è€Œæˆã€‚</p>

                <span class="cd-timeline__date svelte-1aijmz5">1994</span>
            </div>
        </div><div class="cd-timeline__block js-cd-block svelte-1aijmz5">
            <div class="cd-timeline__img cd-timeline__img--movie js-cd-img svelte-1aijmz5">
            </div>
            <div class="cd-timeline__content js-cd-content svelte-1aijmz5">
                <h2 class="svelte-1aijmz5">å¼€å§‹ä½¿ç”¨ DV å­˜å‚¨æ•°å­—è§†é¢‘</h2>
                <p>ç¬¬ä¸€ä¸ª DV è§„èŒƒè¢«ç§°ä¸ºBlue Bookï¼Œå…¶ä¸­å®šä¹‰äº†å½•åƒå¸¦ã€å½•åˆ¶è°ƒåˆ¶æ–¹æ³•ã€ç£åŒ–å’ŒåŸºæœ¬ç³»ç»Ÿæ•°æ®ç­‰å…±åŒç‰¹å¾ã€‚DV ä½¿ç”¨ DCT é€å¸§å‹ç¼©è§†é¢‘ã€‚åŒMPEG-2ä¸€æ ·ï¼Œå®ƒä½¿ç”¨è‰²åº¦äºŒæ¬¡é‡‡æ ·è¿›è¡Œè¿›ä¸€æ­¥å‹ç¼©ã€‚DV æ˜¯ç”±ç´¢å°¼å’Œæ¾ä¸‹ä¸ºä¸“ä¸šç”¨æˆ·å’Œå¹¿æ’­ç”¨æˆ·è®¾è®¡çš„ã€‚ç°åœ¨æœ‰äº†å­˜å‚¨å¡å’Œå›ºæ€é©±åŠ¨å™¨ï¼Œè¿™ç§å­˜å‚¨æ–¹æ³•æ—©å·²è¿‡æ—¶äº†ã€‚</p>

                <span class="cd-timeline__date svelte-1aijmz5">1995</span>
            </div>
        </div><div class="cd-timeline__block js-cd-block svelte-1aijmz5">
            <div class="cd-timeline__img cd-timeline__img--movie js-cd-img svelte-1aijmz5">
            </div>
            <div class="cd-timeline__content js-cd-content svelte-1aijmz5">
                <h2 class="svelte-1aijmz5">å‡ºç°ä½¿ç”¨ MPEG-4 part 2 çš„äº’è”ç½‘è§†é¢‘</h2>
                <p>MPEG-4 ç¬¬äºŒéƒ¨åˆ†ï¼ˆä¹Ÿç§°ä¸º MPEG-4 Visualï¼‰æ˜¯ä¸€ç§ä¸H.263å…¼å®¹çš„æ ‡å‡†ï¼Œå¸¸ç”¨äºç›‘æ§æ‘„åƒä»¥åŠé«˜æ¸…ç”µè§†å¹¿æ’­å’Œ DVDã€‚å®ƒä½¿ç”¨äº†æ¯”MPEG-2æ›´é«˜æ•ˆçš„ç®—æ³•ï¼Œä¸”å‹ç¼©é€Ÿåº¦æ›´å¿«ã€‚ä¸è¿‡ï¼Œå› ä¸ºå®ƒæ— æ³•å¤„ç†AVCï¼ˆAdvanced Video Codingï¼Œé«˜çº§è§†é¢‘ç¼–ç ï¼‰æ ¼å¼ï¼Œåé¢æ‰æœ‰äº†MPEG-4 AVCã€‚</p>

                <span class="cd-timeline__date svelte-1aijmz5">1999</span>
            </div>
        </div><div class="cd-timeline__block js-cd-block svelte-1aijmz5">
            <div class="cd-timeline__img cd-timeline__img--movie js-cd-img svelte-1aijmz5">
            </div>
            <div class="cd-timeline__content js-cd-content svelte-1aijmz5">
                <h2 class="svelte-1aijmz5">H264 è·å¾—æ‰¹å‡†</h2>
                <p>MPEG-4 ç¬¬äºŒéƒ¨åˆ†ï¼ˆä¹Ÿç§°ä¸º MPEG-4 Visualï¼‰æ˜¯ä¸€ç§ä¸H.263å…¼å®¹çš„æ ‡å‡†ï¼Œå¸¸ç”¨äºç›‘æ§æ‘„åƒä»¥åŠé«˜æ¸…ç”µè§†å¹¿æ’­å’Œ DVDã€‚å®ƒä½¿ç”¨äº†æ¯”MPEG-2æ›´é«˜æ•ˆçš„ç®—æ³•ï¼Œä¸”å‹ç¼©é€Ÿåº¦æ›´å¿«ã€‚ä¸è¿‡ï¼Œå› ä¸ºå®ƒæ— æ³•å¤„ç†AVCï¼ˆAdvanced Video Codingï¼Œé«˜çº§è§†é¢‘ç¼–ç ï¼‰æ ¼å¼ï¼Œåé¢æ‰æœ‰äº†MPEG-4 AVCã€‚</p>

                <span class="cd-timeline__date svelte-1aijmz5">2003</span>
            </div>
        </div><div class="cd-timeline__block js-cd-block svelte-1aijmz5">
            <div class="cd-timeline__img cd-timeline__img--movie js-cd-img svelte-1aijmz5">
            </div>
            <div class="cd-timeline__content js-cd-content svelte-1aijmz5">
                <h2 class="svelte-1aijmz5">H.265/HEVC è·å¾—æ‰¹å‡†</h2>
                <p>H.265/HEVCï¼ˆHigh Efficency Video Codingï¼Œé«˜æ•ˆç‡è§†é¢‘ç¼–ç ï¼‰ä¸ä»…å¯ä»¥åšåˆ°H.264æ‰€èƒ½åšçš„ä¸€åˆ‡ï¼Œè€Œä¸”è¡¨ç°æ›´ä½³ã€‚å®ƒå°†æ–‡ä»¶å¤§å°å‡å°‘äº† 50%ï¼Œå¹¶æ”¯æŒéå¸¸é«˜è´¨é‡çš„è§†é¢‘åˆ†è¾¨ç‡â€”â€”é«˜è¾¾ 8Kï¼ˆæœ€å¤§åˆ†è¾¨ç‡ä¸º 8192x4320ï¼‰ã€‚è™½ç„¶ä½ é€šå¸¸æ— éœ€ç”¨åˆ° 8K æˆ–æ— æ³•é€šè¿‡ä»Šå¤©çš„è®¾å¤‡å’Œç½‘ç»œè·å–åˆ°å®ƒï¼Œä½†H.265å¯¹äºARã€VRå’Œ 360Â° ç­‰æ²‰æµ¸å¼ä½“éªŒéå¸¸æœ‰ç”¨ã€‚é«˜æ˜‚çš„æˆæœ¬æ˜¯å®ƒæ²¡æœ‰å¾—åˆ°å¹¿æ³›åº”ç”¨çš„ä¸»è¦åŸå› ã€‚é™¤äº†Netflix å’Œ Amazon Prime Video ç­‰å¤§å…¬å¸å¯ä»¥è´Ÿæ‹…è¿™ç¬”è´¹ç”¨å¤–ï¼Œå…¶ä»–è®¸å¤šå…¬å¸ä»ç„¶é€‰æ‹©ä½¿ç”¨ H.264ã€‚</p>

                <span class="cd-timeline__date svelte-1aijmz5">2013</span>
            </div>
        </div><div class="cd-timeline__block js-cd-block svelte-1aijmz5">
            <div class="cd-timeline__img cd-timeline__img--movie js-cd-img svelte-1aijmz5">
            </div>
            <div class="cd-timeline__content js-cd-content svelte-1aijmz5">
                <h2 class="svelte-1aijmz5">VP9</h2>
                <p>VP9ç”±è°·æ­Œå¼€å‘ï¼Œå®ƒæ˜¯H.265çš„ç«äº‰å¯¹æ‰‹ã€‚å’ŒH.265ä¸åŒï¼Œå®ƒæ˜¯å…è´¹çš„ã€‚</p>

                <span class="cd-timeline__date svelte-1aijmz5">2013</span>
            </div>
        </div><div class="cd-timeline__block js-cd-block svelte-1aijmz5">
            <div class="cd-timeline__img cd-timeline__img--movie js-cd-img svelte-1aijmz5">
            </div>
            <div class="cd-timeline__content js-cd-content svelte-1aijmz5">
                <h2 class="svelte-1aijmz5">AV1</h2>
                <p>è°·æ­Œã€äºšé©¬é€Šã€æ€ç§‘ã€è‹±ç‰¹å°”ã€å¾®è½¯ã€Mozilla å’Œ Netflix å†³å®šä¸€èµ·åˆ›å»ºä¸€ä¸ªæ–°çš„è§†é¢‘æ ¼å¼æ ‡å‡†â€”â€”AV1ã€‚å®ƒæ˜¯ VP9 ä¹‹åçš„ä¸‹ä¸€ä»£è§†é¢‘æ ‡å‡†ï¼Œå¼€æºä¸”å…è´¹ã€‚è¿™ç§æ ¼å¼ä¸“ä¸ºå®æ—¶åº”ç”¨ï¼ˆå¦‚ WebRTCï¼‰è®¾è®¡ä¸”æ”¯æŒæ›´é«˜åˆ†è¾¨ç‡ï¼Œç›®çš„æ˜¯èƒ½å¤Ÿå¤„ç† 8K è§†é¢‘ã€‚</p>

                <span class="cd-timeline__date svelte-1aijmz5">2018</span>
            </div>
        </div><div class="cd-timeline__block js-cd-block svelte-1aijmz5">
            <div class="cd-timeline__img cd-timeline__img--movie js-cd-img svelte-1aijmz5">
            </div>
            <div class="cd-timeline__content js-cd-content svelte-1aijmz5">
                <h2 class="svelte-1aijmz5">H266/VVC</h2>
                <p>H.266/VVCï¼ˆVersatile Video Codingï¼Œå¤šç»´åº¦è§†é¢‘ç¼–ç ï¼‰ä¸»è¦é¢å‘ 4K å’Œ8Kè§†é¢‘æœåŠ¡ã€‚å®ƒäº 2020 å¹´ 7 æœˆå‘å¸ƒï¼Œæ˜¯ç›®å‰ä¸ºæ­¢æœ€æ–°å‘å¸ƒçš„è§†é¢‘å‹ç¼©æ ‡å‡†ã€‚H.266è¿›ä¸€æ­¥ä¼˜åŒ–äº†å‹ç¼©ï¼ˆä½†æ²¡æœ‰å…¶ä»–åˆ›æ–°ï¼‰ï¼Œå¤§çº¦å¯èŠ‚çœ50%çš„è§†é¢‘ç ç‡ï¼ŒåŒæ—¶ç¡®ä¿è§†é¢‘æ¸…æ™°åº¦ä¸å˜ã€‚å®ƒä½¿ç”¨åŸºäºå—çš„æ··åˆè§†é¢‘ç¼–ç æ–¹æ³•ï¼Œå…¶æ€æƒ³æ˜¯æ‰¾åˆ°ä¼˜åŒ–å’Œæ”¹è¿›ç°æœ‰ç®—æ³•å’Œå‹ç¼©æŠ€æœ¯çš„æ–¹æ³•ã€‚H.266ç¼–ç é€Ÿåº¦ä»ç„¶å¾ˆæ…¢ï¼Œä½†è¯¥æ ‡å‡†åœ¨è¾ƒä½ç ç‡ä¸‹æä¾›äº†è‰¯å¥½çš„è´¨é‡æ”¹è¿›ã€‚</p>

                <span class="cd-timeline__date svelte-1aijmz5">2020</span>
            </div>
        </div>
    </div>
</section>
<h2 id="å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</h2>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p><a href="https://mp.weixin.qq.com/s/TKemCfbfnOBiw72FEnDPcg">è§†é¢‘å‹ç¼©æ ‡å‡†ç®€å²ï¼šä»1929åˆ°2020</a> <a href="#fnref1" class="footnote-backref">â†©ï¸</a> <a href="#fnref1:1" class="footnote-backref">â†©ï¸</a></p>
</li>
</ol>
</section>
]]></content>
      <categories>
        <category>è§†é¢‘æŠ€æœ¯</category>
      </categories>
      <tags>
        <tag>ç¼–è§£ç å™¨</tag>
        <tag>å‹ç¼©æ ‡å‡†</tag>
      </tags>
  </entry>
  <entry>
    <title>GraphQL å®è·µ</title>
    <url>/2021/07/17/The-First-Python-Project-For-GraphQL/</url>
    <content><![CDATA[<p><img src="/2021/07/17/The-First-Python-Project-For-GraphQL/1.png" alt></p>
<blockquote>
<p>çº¸ä¸Šå¾—æ¥ç»ˆè§‰æµ…ï¼Œç»çŸ¥æ­¤äº‹è¦èº¬è¡Œã€‚</p>
</blockquote>
<p>åœ¨ <a href="/2021/06/15/Preliminary-Exploration-of-the-GraphQL/">GraphQL åˆæ¢</a>ä¸€æ–‡ä¸­ï¼Œå¯¹ GraphQL è¿›è¡Œäº†åˆæ­¥çš„ä»‹ç»å’Œåˆ†æã€‚åœ¨å¯¹ GraphQL æœ‰äº†ä¸€å®šè®¤è¯†ä¹‹åï¼Œæ€»æƒ³ç€èƒ½åœ¨å®è·µä¸­çœŸæ­£çš„ä½“éªŒä¸€ä¸‹ GraphQLã€‚å®è·µæ˜¯æ£€éªŒçœŸç†çš„å”¯ä¸€æ ‡å‡†å˜›ï¼Œä¸å…¶è½»ä¿¡ä¸ç½‘ç»œä¸Šçš„å„ç§å¯¹æ¯”åˆ†æï¼Œå€’ä¸å¦‚çœŸæ­£çš„å»ä½“éªŒä¸€ä¸‹ã€‚</p>
<p>æ°å¥½è¿‘æœŸæœ‰ä¸€ä¸ªå°å‹çš„é¡¹ç›®éœ€è¦ä¼˜åŒ–ï¼Œäºæ˜¯å°±åœ¨è¯¥å°å‹é¡¹ç›®åŸºç¡€ä¸Šå®è·µäº† GraphQLã€‚ä¹‹å‰ï¼Œè¯¥é¡¹ç›®æ˜¯åŸºäº django æ¡†æ¶å¼€å‘çš„ REST APIï¼Œæ­¤æ¬¡å®è·µï¼Œé‡‡ç”¨ <a href="https://github.com/graphql-python/graphene-django">Graphene-Django</a> ä¸ºè¯¥é¡¹ç›®å¢åŠ äº†å¯¹åº”çš„ GraphQL APIã€‚</p>
<span id="more"></span>
<h2 id="é¡¹ç›®çš„ç®€åŒ–æ¨¡å‹">é¡¹ç›®çš„ç®€åŒ–æ¨¡å‹</h2>
<p>è¿™ä¸ªå°é¡¹ç›®çš„æ ¸å¿ƒå…¶å®å°±æ˜¯ä¸ºå„ç§è§†é¢‘ç‰©æ–™æä¾›ä¸€ä¸ªå­˜å‚¨å’Œæ£€ç´¢çš„å¾®æœåŠ¡ï¼Œè¯¥å¾®æœåŠ¡å…·æœ‰ä»¥ä¸‹çš„åŠŸèƒ½ï¼š</p>
<ul>
<li>å­˜å‚¨è§†é¢‘ä»¥åŠè§†é¢‘çš„å…ƒæ•°æ®</li>
<li>æ ¹æ®ä¸åŒçš„æ¡ä»¶æ£€ç´¢æ»¡è¶³æ¡ä»¶çš„è§†é¢‘</li>
</ul>
<p>åœ¨è¯¥å¾®æœåŠ¡ä¸­çš„æ¯æ¡è§†é¢‘ï¼š</p>
<ul>
<li>éƒ½åŒ…å«è§†é¢‘æ ‡ç­¾ï¼ˆVideoTagï¼‰ä¿¡æ¯</li>
<li>åˆ©ç”¨è¯¥è§†é¢‘äº§ç”Ÿå…¶ä»–æ ¼å¼çš„è§†é¢‘ï¼ˆæˆ‘ä»¬ç§°ä¹‹ä¸ºæ´¾ç”Ÿè§†é¢‘ï¼‰</li>
</ul>
<p>è¯¥é¡¹ç›®ç”¨åˆ°çš„æ•°æ®å­˜å‚¨å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br>
<img src="/2021/07/17/The-First-Python-Project-For-GraphQL/2.png" alt></p>
<ul>
<li><em>Video</em> è¡¨ä¸­å­˜å‚¨äº†è§†é¢‘çš„ç›¸å…³ä¿¡æ¯</li>
<li><em>DerivedVideo</em> è¡¨ä¸­å­˜å‚¨äº†æ´¾ç”Ÿè§†é¢‘çš„ç›¸å…³ä¿¡æ¯ï¼Œç”¨ä»¥è®°å½•æ ¹æ® parentId è§†é¢‘æ´¾ç”Ÿå‡ºçš„è§†é¢‘çš„ vid ä¿¡æ¯</li>
<li><em>VideoTag</em> è¡¨ä¸­å­˜å‚¨äº†è§†é¢‘çš„æ ‡ç­¾ä¿¡æ¯</li>
</ul>
<p>è¯¥å¾®æœåŠ¡çš„æ•´ä½“æ¶æ„å¦‚ä¸‹æ‰€ç¤ºï¼š<br>
<img src="/2021/07/17/The-First-Python-Project-For-GraphQL/3.png" alt></p>
<h2 id="graphql-çš„è¿ç§»æ€è·¯">GraphQL çš„è¿ç§»æ€è·¯</h2>
<p>å°†ç°æœ‰çš„ REST API è¿ç§»åˆ° GraphQL API æœ‰ä¸‰ç§æ€è·¯ï¼š</p>
<ul>
<li>å®Œå…¨æŒ‰ç…§ GraphQL å®ç°ç°æœ‰å¾®æœåŠ¡æä¾›çš„æ‰€æœ‰èƒ½åŠ›</li>
<li>åˆ©ç”¨ GraphQL å¯¹å½“å‰ç³»ç»Ÿçš„ç°æœ‰ä»£ç è¿›è¡Œæ•´åˆ<br>
<img src="/2021/07/17/The-First-Python-Project-For-GraphQL/4.png" alt></li>
<li>åˆ©ç”¨ GraphQL å¯¹å½“å‰ç³»ç»Ÿçš„ REST API è¿›è¡Œå°è£…<br>
<img src="/2021/07/17/The-First-Python-Project-For-GraphQL/5.png" alt></li>
</ul>
<p>è€ƒè™‘åˆ°å­¦ä¹ æˆæœ¬ï¼Œæ”¹é€ æˆæœ¬ï¼ŒæœåŠ¡æ€§èƒ½ç­‰é—®é¢˜ï¼Œæœ€ç»ˆæˆ‘ä»¬å†³å®šé‡‡ç”¨ç¬¬ 2 ç§æ–¹æ³•å¯¹å½“å‰çš„å¾®æœåŠ¡è¿›è¡Œ GraphQL å‡çº§ã€‚</p>
<h2 id="graphql-è¿ç§»è¿‡ç¨‹ä¸­çš„æ„Ÿæƒ³">GraphQL è¿ç§»è¿‡ç¨‹ä¸­çš„æ„Ÿæƒ³</h2>
<h4 id="graphql-æ”¹é€ ç¡®å®å…·æœ‰ä¸€å®šçš„æˆæœ¬">GraphQL æ”¹é€ ç¡®å®å…·æœ‰ä¸€å®šçš„æˆæœ¬</h4>
<p>åˆ©ç”¨æ–°æŠ€æœ¯æ”¹é€ è€çš„ç³»ç»Ÿå¿…é¡»è¦è€ƒè™‘çš„å› ç´ ä¹‹ä¸€å°±æ˜¯æˆæœ¬ï¼Œè¿™é‡Œé¢æ¶‰åŠåˆ°ï¼š</p>
<ul>
<li>æ–°æŠ€æœ¯çš„å­¦ä¹ æˆæœ¬</li>
<li>å¼€å‘çš„æˆæœ¬</li>
<li>å‡ºç°é—®é¢˜åçš„å®šä½æˆæœ¬</li>
<li>â€¦â€¦</li>
</ul>
<p>æˆ‘åœ¨ GraphQL è¿ç§»è¿‡ç¨‹æ‰€èŠ±è´¹çš„æˆæœ¬ä¸Šï¼Œé‡ç‚¹è¿˜æ˜¯å­¦ä¹ æˆæœ¬ï¼Œä¸»è¦æ¶‰åŠï¼š</p>
<ul>
<li>ç†è®ºå­¦ä¹ </li>
<li>æ¡†æ¶å­¦ä¹ ï¼š<a href="https://docs.graphene-python.org/en/stable/">Graphene</a> æ¡†æ¶ä»¥åŠ <a href="https://docs.graphene-python.org/projects/django/en/latest/">Graphene-Django</a> æ¡†æ¶</li>
</ul>
<p>å¹¶ä¸”ï¼Œæ•´ä¸ªå­¦ä¹ æ‰€èŠ±è´¹çš„æ—¶é—´æ¯”çœŸæ­£å¼€å‘çš„æ—¶é—´è¦é«˜å¾ˆå¤šï¼ŒçœŸæ­£ç”¨äº GraphQL API å¼€å‘æ‰€èŠ±è´¹çš„æ—¶é—´å¹¶ä¸å¤šã€‚</p>
<p>åœ¨æ•´ä¸ªçš„å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæ„Ÿè§‰ GraphQL API æ¯”èµ· REST API è€Œè¨€è¿˜æ˜¯ä¼šå¢åŠ å°‘è®¸çš„æˆæœ¬çš„ï¼Œå°¤å…¶æ˜¯å„ç§ type çš„å®šä¹‰ï¼Œç¡®å®ä¼šå¢åŠ ä¸€ç‚¹ç¼–ç çš„æˆæœ¬ã€‚å¦å¤–ï¼Œç”±äº GraphQL ç±»å‹ç³»ç»Ÿçš„é™åˆ¶ï¼ŒGraphQL API çš„å¼€å‘å†ä¹Ÿä¸èƒ½åƒ REST API é‚£æ ·éšå¿ƒæ‰€æ¬²äº†ã€‚GraphQL ç¡®å®éœ€è¦ä»æ¥å£æŠ½è±¡å¼€å§‹è®¾è®¡ï¼Œç„¶ååˆ°æ¥å£å®ç°ã€‚</p>
<p>ç»¼ä¸Šï¼ŒGraphQL API çš„å¼€å‘ç¡®å®è¦ç¨å¾®çš„å¤šèŠ±è´¹ä¸€ç‚¹æ—¶é—´ã€‚ä½†æ˜¯è¿™é¢å¤–çš„æ—¶é—´ä¼šå¸¦æ¥é¢å¤–çš„å¾ˆå¤šå¥½å¤„ï¼Œæ¯”å¦‚å’Œä»£ç åŒæ­¥çš„æ¥å£æ–‡æ¡£ã€‚</p>
<h4 id="graphql-çš„ä»£ç æ›´ç®€ç»ƒ">GraphQL çš„ä»£ç æ›´ç®€ç»ƒ</h4>
<p>ä¸ªäººæ„Ÿè§‰ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼ŒGraphQL çš„ç±»å‹ç³»ç»Ÿä½¿å¾—å…¶æ›´å…·è¡¨è¾¾æ€§ï¼Œè¿™å¯ä»¥è®© GraphQL API çœ‹èµ·æ¥æ›´ç®€ç»ƒã€‚</p>
<p>å¦‚ä¸‹æ‰€ç¤ºçš„ GraphQL Schema ä¸­ï¼Œ<code>videoList</code> å­—æ®µçš„ç±»å‹ä¸º <code>VideoList</code>ï¼Œè€Œ <code>VideoList</code> ç±»å‹åˆ™åŒ…å«ä¸€ä¸ªç±»å‹ä¸º <code>[Video]</code> çš„å­—æ®µã€‚å› æ­¤å¯¹äº <code>videoList</code> å­—æ®µè€Œè¨€ï¼Œåªéœ€è¦å¤„ç† <code>total</code> å’Œ <code>hasMore</code> å­—æ®µå³å¯ã€‚ä»è¿™ä¸ªå±‚é¢ä¸Šè®²ï¼Œæ•´ä¸ªçš„ä»£ç ä¼šæ›´åŠ ç®€æ´ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">type</span> Query &#123;</span><br><span class="line">  video(vid: ID!): Video</span><br><span class="line">  videoList(first: Int!, </span><br><span class="line">            after: Int, </span><br><span class="line">            codec: VideoCodec, </span><br><span class="line">            <span class="built_in">format</span>: VideoDemux, </span><br><span class="line">            resolution: VideoResolution, </span><br><span class="line">            vid: Int): VideoList</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">type</span> VideoList &#123;</span><br><span class="line">  videos: [Video!]</span><br><span class="line">  total: Int!</span><br><span class="line">  hasMore: Boolean!</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å°¤å…¶æ˜¯åœ¨å½“ <code>video</code> å’Œ <code>videoList.videos</code> æ‰€éœ€çš„æ•°æ®ä¸ä¸€è‡´æ—¶ï¼ŒGraphQL <em>æŒ‰éœ€è¯·æ±‚</em>çš„ç‰¹æ€§ä½¿å¾—æœåŠ¡ç«¯æ— éœ€é¢å¤–çš„æ”¹åŠ¨ï¼Œå³å¯å®ç°ä¸åŒçš„è¯·æ±‚æ–¹è¯·æ±‚ä¸åŒæ•°æ®ã€‚è€Œåœ¨ REST API çš„è€ç³»ç»Ÿä¸­ï¼Œå¯ä»¥éšå¤„çœ‹åˆ°ä¸ºäº†å…¼å®¹ä¸åŒè¯·æ±‚æ–¹çš„å„ç§è¡¥ä¸ä»£ç ã€‚</p>
<h4 id="graphql-æ›´åŠ é¢å‘æœåŠ¡ä½¿ç”¨è€…">GraphQL æ›´åŠ é¢å‘æœåŠ¡ä½¿ç”¨è€…</h4>
<p>GraphQL API å®Œæˆä¹‹åï¼Œæˆ‘ä»¬æ‰¾äº†å‡ åè¯¥æœåŠ¡çš„ä½¿ç”¨è€…æ¥äº²è‡ªä½“éªŒ GraphQL APIã€‚å¾—ç›Šäº GraphQL æä¾›çš„å¦‚ä¸‹å›¾æ‰€ç¤ºçš„æ¥å£æ–‡æ¡£ï¼Œå¤§å®¶æ™®éåé¦ˆä½¿ç”¨ GraphQL API æ¯”ä½¿ç”¨ REST API æ›´é¡ºç•…ï¼Œæ›´æ”¾å¿ƒï¼Œæ›´é«˜æ•ˆã€‚ä½¿ç”¨ GraphQL API åï¼Œå†ä¹Ÿä¸ç”¨åˆ°å¤„æ‰¾ API çš„æ–‡æ¡£äº†ã€‚</p>
<p><img src="/2021/07/17/The-First-Python-Project-For-GraphQL/6.gif" width="200px"></p>
<p>å¯¹äº <code>videoList</code>ï¼Œå¯ä»¥æ ¹æ®è§†é¢‘æ‰€ç”¨çš„ç¼–è§£ç å™¨ï¼ˆ<code>codec</code> å‚æ•°ï¼‰æ¥è¿›è¡Œç­›é€‰ã€‚å¯¹äºä¸‹æ¸¸æ¶ˆè´¹è€…è€Œè¨€ï¼Œå¦‚æœä½¿ç”¨ REST APIï¼Œåˆ™éœ€è¦é€šè¿‡å„ç§æ ¼å¼çš„æ¥å£æ–‡æ¡£æ‰èƒ½ç¡®å®šè¯¥å‚æ•°çš„å€¼ï¼›è€Œä½¿ç”¨ GraphQL APIï¼Œåˆ™ç›´æ¥é€šè¿‡å¦‚ä¸Šå›¾æ‰€ç¤ºçš„æ–‡æ¡£å³å¯æ˜ç¡®çš„äº†è§£åˆ°è¯¥å‚æ•°çš„å–å€¼èŒƒå›´ã€‚</p>
<p>å°¤å…¶æ˜¯å½“æ¥å£æ–‡æ¡£å’Œæ¥å£çš„å®ç°ä¸ä¸€è‡´çš„æ—¶å€™ï¼ŒREST API çš„æ–‡æ¡£å¯¹äºä½¿ç”¨è€…è€Œè¨€ï¼Œç®€ç›´å°±æ˜¯ä¸€åœºå™©æ¢¦ã€‚è€Œ GraphQL API çš„æ–‡æ¡£æ˜¯æ ¹æ® GraphQL Schema è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œå› æ­¤ï¼ŒGraphQL å¤©ç„¶å°±å…·æœ‰æ–‡æ¡£å’Œä»£ç åŒæ­¥çš„ä¼˜åŠ¿ã€‚</p>
<p>å°¤å…¶æ˜¯åœ¨å¾®æœåŠ¡å¤§è¡Œå…¶é“çš„ç°åœ¨ï¼Œç›¸è¾ƒäº REST API è€Œè¨€ï¼Œæˆ‘è®¤ä¸º GraphQL API çš„æ•ˆç‡æ›´é«˜ã€‚è¿™é‡Œçš„æ•ˆç‡é›†ä¸­ä½“ç°åœ¨<em>æ²Ÿé€šæ•ˆç‡</em>å’Œ<em>åä½œæ•ˆç‡</em>ã€‚åœ¨ Sam Newman çš„ <em>Monolith to Microservices</em> çš„<a href="/monolith-to-microservices/docs/Breaking_Changes.html">ç ´åæ€§çš„æœåŠ¡å˜æ›´</a>ä¸­è®²çš„é‚£æ ·ï¼š</p>
<blockquote>
<p>å¾®æœåŠ¡ä½œä¸ºæ›´å¤§çš„ç³»ç»Ÿçš„ä¸€éƒ¨åˆ†è€Œå­˜åœ¨ã€‚æ¯ä¸ªå¾®æœåŠ¡è¦ä¹ˆä½¿ç”¨å…¶ä»–å¾®æœåŠ¡æä¾›çš„åŠŸèƒ½ï¼Œè¦ä¹ˆå‘å…¶ä»–å¾®æœåŠ¡æä¾›è‡ªå·±çš„åŠŸèƒ½ï¼Œè¦ä¹ˆäºŒè€…å…¼è€Œæœ‰ä¹‹ã€‚å¯¹äºå¾®æœåŠ¡æ¶æ„è€Œè¨€ï¼Œæˆ‘ä»¬æ­£åœ¨åŠªåŠ›å®ç°å…¶ç‹¬ç«‹å¯éƒ¨ç½²æ€§ã€‚ä½†æ˜¯ä¸ºäº†å®ç°å…¶ç‹¬ç«‹éƒ¨ç½²ï¼Œæˆ‘ä»¬éœ€è¦ç¡®ä¿å¯¹å¾®æœåŠ¡çš„ä¿®æ”¹ä¸ä¼šå¹²æ‰°å…¶ä¸‹æ¸¸æ¶ˆè´¹è€…ã€‚</p>
</blockquote>
<p>å› æ­¤ï¼Œå¯¹äºå¾®æœåŠ¡æ¶æ„ä¸‹çš„ç³»ç»Ÿè€Œè¨€ï¼Œè™½ç„¶ä¸åŒçš„å¾®æœåŠ¡å†…éƒ¨å¯ä»¥åšåˆ°ç‹¬ç«‹éƒ¨ç½²ï¼Œä½†æ˜¯å´ä¸å¯é¿å…çš„ä¼šä½¿ç”¨åˆ°å…¶ä»–å›¢é˜Ÿæä¾›çš„å¾®æœåŠ¡ã€‚å½“å¾®æœåŠ¡çš„æ•°é‡ä¸æ–­å¢åŠ çš„åŒæ—¶æ›´å¸¦æ¥äº†å¼‚å¸¸å¤æ‚çš„æ²Ÿé€šã€åä½œæˆæœ¬ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œæ²Ÿé€šæ•ˆç‡å¯èƒ½ä¼šæˆä¸ºé˜»ç¢å¼€å‘æ•ˆèƒ½çš„é‡è¦å› ç´ ã€‚</p>
<p>æ‰€ä»¥ï¼Œæˆ‘è®¤ä¸ºï¼ŒGraphQL å¯¹äºå¾®æœåŠ¡æ¶æ„è€Œè¨€å…·å¤‡å¤©ç„¶çš„ä¼˜åŠ¿ã€‚å½“ç„¶ï¼Œå¦‚æœ REST API çš„æ¥å£æ–‡æ¡£èƒ½å¤Ÿåšåˆ°å’Œä»£ç å®ç°åŒæ­¥çš„è¯ï¼Œä½¿ç”¨ REST API ä¹Ÿæ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œä½†æ˜¯æœ‰å¤šå°‘å›¢é˜Ÿå¯ä»¥åšåˆ°è¿™ä¸€ç‚¹å‘¢ï¼Ÿ</p>
<h4 id="graphql-api-ç¡®å®ä¼šæœ‰æ€§èƒ½æŠ˜æŸ">GraphQL API ç¡®å®ä¼šæœ‰æ€§èƒ½æŠ˜æŸ</h4>
<p>åœ¨åŒä¸€å°æœºå™¨ä¸Šï¼Œé‡‡ç”¨ç›¸åŒçš„ QPS å¯¹åŒä¸€åŠŸèƒ½çš„ä¸åŒå®ç°è¿›è¡Œæ€§èƒ½æµ‹è¯•ï¼Œæœ€ç»ˆçš„æµ‹è¯•ç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="/2021/07/17/The-First-Python-Project-For-GraphQL/7.png" alt></p>
<p>ä»å‹æµ‹ç»“æœçœ‹ï¼ŒGraphQL API çš„è€—æ—¶æ¯” REST API çš„è€—æ—¶é«˜ <code>30ms</code> å·¦å³ã€‚ç”±äº GraphQL API å¼•å…¥äº† GraphQL Runtime å±‚æ¥è§£æ GraphQL API çš„è¯·æ±‚ï¼Œå› æ­¤ä»æ€§èƒ½è§’åº¦çœ‹ï¼ŒGraphQL API ä¼šä¸å¯é¿å…çš„å¸¦æ¥æ€§èƒ½æŸè€—ã€‚</p>
<p>ä½†æ˜¯ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒGraphQL æä¾›çš„æŒ‰éœ€ç´¢å–æ•°æ®çš„èƒ½åŠ›å¯ä»¥æœ€å¤§ç¨‹åº¦çš„é™ä½æ€§èƒ½æŠ˜æŸã€‚ä¾‹å¦‚åœ¨è¯·æ±‚è§†é¢‘åˆ—è¡¨çš„æ—¶å€™ï¼Œå¦‚æœä»…è¯·æ±‚æ¯ä¸ªè§†é¢‘çš„ vidï¼Œurl, videoMetainfo ä¿¡æ¯ï¼Œåˆ™ GraphQL API çš„æ€§èƒ½åŸºæœ¬ä¸Šèƒ½å’Œ REST API çš„æ€§èƒ½å·®å¼‚ä¼šä¸æ–­ç¼©å°ï¼ˆ<code>10ms</code> å·¦å³ï¼‰ï¼Œå…·ä½“å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="/2021/07/17/The-First-Python-Project-For-GraphQL/8.png" alt></p>
<p>è€Œåœ¨å¤§éƒ¨åˆ†çš„æƒ…å†µä¸‹ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„å®¢æˆ·ç«¯è¯·æ±‚éƒ½éœ€è¦è·å–æ‰€æœ‰çš„æ•°æ®ï¼Œå› æ­¤ GraphQL æŒ‰éœ€ç´¢å–çš„ç‰¹æ€§åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šä¹Ÿè§£å†³äº†å¼•å…¥ GraphQL Runtime å±‚è€Œå¸¦æ¥çš„æ€§èƒ½æŠ˜æŸã€‚</p>
<p>å› æ­¤ï¼Œåœ¨è€ƒè™‘ GraphQL API æ€§èƒ½çš„æ—¶å€™ï¼Œéœ€è¦ç»¼åˆè€ƒè™‘å’Œå¯¹æ¯”ï¼Œå¦åˆ™å¯èƒ½ä¼šåšå‡ºéå®¢è§‚çš„ç»“è®ºã€‚</p>
]]></content>
      <categories>
        <category>GraphQL</category>
      </categories>
      <tags>
        <tag>GraphQL-Python</tag>
        <tag>Graphene</tag>
        <tag>Graphene-Django</tag>
      </tags>
  </entry>
  <entry>
    <title>GraphQL åˆæ¢</title>
    <url>/2021/06/15/Preliminary-Exploration-of-the-GraphQL/</url>
    <content><![CDATA[<p><img src="/2021/06/15/Preliminary-Exploration-of-the-GraphQL/1.jpg" alt></p>
<p>æ—©åœ¨ 2019 å¹´çš„æ—¶å€™ï¼Œæˆ‘åœ¨ InfoQ ä¸Šè¯»åˆ°äº†ä¸€ç¯‡æºç¨‹ä»‹ç»å…¶å…³äº GraphQL æ¢ç´¢çš„æ–‡ç« ï¼š<a href="https://www.infoq.cn/article/xZ0ws6_A5jmrJ6ZTPOz8">å…¨é¢è§£æ GraphQLï¼Œæºç¨‹å¾®æœåŠ¡èƒŒæ™¯ä¸‹çš„å‰åç«¯æ•°æ®äº¤äº’æ–¹æ¡ˆ</a>ã€‚è¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡æ¥è§¦åˆ° GraphQL çš„æ¦‚å¿µï¼Œå½“æ—¶å¹¶æ²¡æœ‰åšæ·±å…¥çš„äº†è§£å’Œå­¦ä¹ ï¼Œåæ¥ï¼Œåœ¨å·¥ä½œä¸­ï¼Œè¿™ä¸ªæ¦‚å¿µä¹Ÿåœ¨è„‘æµ·ä¸­æ…¢æ…¢çš„æ·¡åŒ–äº†ã€‚</p>
<p>ä»Šå¹´ 3 æœˆä»½çš„æ—¶å€™ï¼Œæˆ‘åœ¨ InfoQ ä¸Šè¯»åˆ°äº†çˆ±å¥‡è‰ºå…³äº GraphQL è½åœ°çš„æ–‡ç« ï¼š<a href="https://www.infoq.cn/article/cWTUJhYMT6DjGQOHIse2">å‡å°‘é‡å¤å¼€å‘ï¼ŒGraphQL åœ¨ä½ä»£ç å¹³å°å¦‚ä½•è½åœ°ï¼Ÿ</a>ã€‚åˆšå¼€å§‹è§‰å¾—è¿™ä¸ªæ¦‚å¿µä¼¼æ›¾ç›¸è¯†ï¼Œäºæ˜¯å°±æœç´¢äº†ä¸€ä¸‹ï¼Œç„¶åå‹¾èµ·äº†åˆæ¬¡å¬åˆ° GraphQL çš„è®°å¿†ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘åœ¨ InfoQ ä¸Šæœç´¢äº†å’Œ GraphQL ç›¸å…³çš„å†…å®¹ï¼Œæ‰å‘ç°åŸæ¥æœ‰å¾ˆå¤šæ–‡ç« å·²ç»åœ¨ä»‹ç» GraphQLã€‚åŒæ—¶ï¼Œæˆ‘åœ¨ GitHub çš„æ–‡æ¡£ä¸­å‘ç° GitHub ä¹Ÿæä¾›äº† <a href="https://docs.github.com/en/graphql">GraphQL API æ–‡æ¡£</a>ï¼ŒæŠ€æœ¯çš„æ•æ„Ÿæ€§ä¿ƒä½¿æˆ‘ä¸‹å®šå†³å¿ƒæ¥ä»”ç»†&amp;æ·±å…¥çš„äº†è§£ GraphQLã€‚</p>
<p>äºæ˜¯ï¼Œæˆ‘åœ¨ <a href="https://www.manning.com/">manning</a> ä¸Šæ‰¾åˆ°äº† <a href="https://www.manning.com/books/graphql-in-action">GraphQL in Action</a>ï¼ˆæˆ‘ä¸€èˆ¬ä¼šè¯•å›¾åœ¨è¿™ä¸ªç«™ç‚¹æ‰¾åˆ°å¸Œæœ›äº†è§£çš„æŠ€æœ¯é¢†åŸŸçš„æœ€æ–°çš„ä¹¦ç±ï¼‰ï¼Œ ç„¶åå‚ç…§è¿™æœ¬ä¹¦ï¼Œå¼€å¯äº†æˆ‘çš„ GraphQL ä¹‹æ—…ã€‚</p>
<span id="more"></span>
<h2 id="graphql-ç®€ä»‹">GraphQL ç®€ä»‹</h2>
<p>å¯¹äº API è€Œè¨€ï¼ŒGraphQL è¢«è§†ä¸ºä¸€ç§é©å‘½æ€§çš„æ–°æ€è·¯ã€æ–°æŠ€æœ¯ã€‚GraphQL æ”¹å˜äº†å‰åç«¯å›¢é˜Ÿçš„äº¤äº’æ–¹å¼ã€é¢ è¦†äº†å‰åç«¯å›¢é˜Ÿçš„é€šä¿¡æ–¹å¼ï¼Œä½¿å¾—ä»–ä»¬å¯ä»¥æ›´é¡ºç•…è€Œé«˜æ•ˆåœ°åä½œã€‚</p>
<p>æ­£å¦‚Samer Bunaåœ¨å…¶è‘—ä½œ <a href="https://wangwei1237.gitee.io/shares/GraphQL_in_Action.pdf">ã€ŠGraphQL in Actionã€‹</a> ä¸­çš„åºè¨€ä¸­æ‰€è¯´çš„é‚£æ ·<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup>ï¼š</p>
<blockquote>
<p>æ—©åœ¨ 2015 å¹´ï¼ŒFacebook é¦–æ¬¡å®£å¸ƒ GraphQL é¡¹ç›®æ—¶ï¼Œæˆ‘ç¬¬ä¸€æ¬¡å¬è¯´äº† GraphQLï¼Œé‚£ä¸ªæ—¶å€™ GraphQL å°±æ·±æ·±çš„å¸å¼•äº†æˆ‘ã€‚å¹¶ä¸”ï¼Œå­¦ä¹  GraphQL æ˜¯æˆ‘åšè¿‡çš„æœ€å¥½çš„æ—¶é—´æŠ•èµ„ä¹‹ä¸€ã€‚</p>
</blockquote>
<p>åœ¨ä¸æ–­çš„äº†è§£ã€å­¦ä¹ ã€ä½¿ç”¨ GraphQL ä¹‹åï¼Œæˆ‘ä¹Ÿåƒ Samer Buna ä¸€æ ·ï¼Œè¢« GraphQL æ·±æ·±çš„å¸å¼•äº†ã€‚</p>
<p>å…³äº GraphQL çš„ä»‹ç»ï¼Œç½‘ä¸Šå·²ç»æœ‰éå¸¸å¤šçš„èµ„æ–™äº†ï¼Œè¿™é‡Œä¸å†è¿‡å¤šæè¿°ï¼Œå…·ä½“å¯ä»¥å‚è€ƒ <a href="https://graphql.cn/">GraphQL.org</a><sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup>ï¼Œ<a href="https://docs.github.com/en/graphql">GitHub GraphQL Docs</a><sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup>ï¼Œä»¥åŠ <a href="https://wangwei1237.gitee.io/shares/GraphQL_in_Action.pdf">GraphQL in Action</a>ã€‚</p>
<h2 id="graphql-vs-rest">GraphQL vs. REST</h2>
<p>å…³äº GraphQL å’Œ REST ä¹‹é—´çš„è¯¦ç»†å¯¹æ¯”ï¼Œæˆ‘è®¤ä¸ºå¯ä»¥å‚è€ƒ <a href="https://www.apollographql.com/blog/graphql/basics/graphql-vs-rest/">GraphQL vs. REST</a> ä»¥åŠ <a href="https://www.howtographql.com/basics/1-graphql-is-the-better-rest/">GraphQL is the better REST</a>ï¼Œæ­¤å¤„ä¸å†èµ˜è¿°äº†<sup class="footnote-ref"><a href="#fn4" id="fnref4">[4]</a></sup> <sup class="footnote-ref"><a href="#fn5" id="fnref5">[5]</a></sup>ã€‚</p>
<h2 id="graphql-çš„ä¼˜åŠ¿æœ‰å“ªäº›">GraphQL çš„ä¼˜åŠ¿æœ‰å“ªäº›</h2>
<p>åœ¨  <a href="https://wangwei1237.gitee.io/shares/GraphQL_in_Action.pdf">ã€ŠGraphQL in Actionã€‹</a> ä¸­ï¼Œä½œè€…å¯¹ GraphQL çš„ä¼˜ç¼ºç‚¹åšäº†å¾ˆå…¨é¢çš„ä»‹ç»ï¼›åœ¨ <a href="https://graphql.org/">GraphQL çš„ç¤¾åŒºç½‘ç«™</a> ä¸Šï¼Œä¹Ÿå¯¹ GraphQL çš„ä¼˜ç‚¹åšäº†å…¨é¢çš„ä»‹ç»ï¼›ç”šè‡³ï¼Œå¯ä»¥ç”¨æœç´¢å¼•æ“æœç´¢å‡ºä¸€å † GraphQL ç›¸å…³çš„æ–‡ç« å’Œèµ„æºâ€¦â€¦</p>
<p>ä½†æ˜¯ï¼Œä½œä¸ºä¸€ä¸ªåˆšæ¥è§¦ GraphQL çš„é—¨å¤–æ±‰ï¼Œæˆ‘è¿˜æ˜¯å¸Œæœ›å†™ä¸€å†™è‡ªå·±å­¦ä¹  GraphQL ä¹‹åçš„æ„Ÿæƒ³ï¼Œå°¤å…¶æ˜¯æˆ‘è§‰çš„ GraphQL é‚£äº›èƒ½è®©æˆ‘æ¿€åŠ¨æ— æ¯”çš„ç‰¹æ€§ã€‚</p>
<h4 id="graphql-çš„å¼ºç±»å‹ç³»ç»Ÿ">GraphQL çš„å¼ºç±»å‹ç³»ç»Ÿ</h4>
<p>åœ¨ GraphQL ä¸­ï¼Œç±»å‹ç³»ç»Ÿç”¨äºæè¿° GraphQL Server çš„èƒ½åŠ›å¹¶ç”¨äºåˆ¤æ–­ä¸€ä¸ªæŸ¥è¯¢æ˜¯å¦æœ‰æ•ˆã€‚ç±»å‹ç³»ç»Ÿè¿˜æè¿°äº†æŸ¥è¯¢å‚æ•°çš„è¾“å…¥ç±»å‹ï¼Œå¹¶åœ¨ GraphQL Runtime ä¸­æ£€æŸ¥å‚æ•°å€¼çš„æœ‰æ•ˆæ€§ã€‚</p>
<p>ä¸€ä¸ª GraphQL æœåŠ¡æ˜¯é€šè¿‡å®šä¹‰<code>ç±»å‹</code>å’Œ<code>ç±»å‹</code>ä¸Šçš„<code>å­—æ®µ</code>æ¥åˆ›å»ºçš„ï¼Œç„¶åç»™æ¯ä¸ª<code>ç±»å‹</code>ä¸Šçš„æ¯ä¸ª<code>å­—æ®µ</code>æä¾›<code>è§£æå‡½æ•°</code>ã€‚</p>
<p>ä¾‹å¦‚ï¼Œåœ¨ <a href="https://docs.github.com/en/graphql/overview/explorer">Github GraphQL Server</a> ä¸­ï¼Œä½¿ç”¨ <code>viewer</code> å­—æ®µæ¥æè¿°å½“å‰ç™»å½•ç”¨æˆ·çš„ä¿¡æ¯ï¼Œè€Œ <code>viewer</code> çš„<code>ç±»å‹</code>ä¸º <code>User</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">type Query &#123;</span><br><span class="line">  viewer: User!</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type User &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  location: <span class="built_in">String</span></span><br><span class="line">  login: <span class="built_in">String</span>!</span><br><span class="line">  name: <span class="built_in">String</span></span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸€æ—¦å¯åŠ¨æŸä¸ª GraphQL Serverï¼Œå®ƒå°±èƒ½æ¥æ”¶ GraphQL æŸ¥è¯¢ï¼Œå¹¶éªŒè¯å’Œæ‰§è¡Œè¯¥æŸ¥è¯¢ã€‚GraphQL Server é¦–å…ˆä¼šæ£€æŸ¥è¯¥æŸ¥è¯¢ä»¥ç¡®ä¿å®ƒåªå¼•ç”¨äº†å·²å®šä¹‰çš„<code>ç±»å‹</code>å’Œ<code>å­—æ®µ</code>ï¼Œç„¶åè¿è¡ŒæŒ‡å®šçš„<code>è§£æå‡½æ•°</code>æ¥ç”Ÿæˆç»“æœã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ <a href="https://docs.github.com/en/graphql/overview/explorer">Github GraphQL Server</a> ä¸­è¿è¡Œå¦‚ä¸‹çš„æŸ¥è¯¢ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">query &#123; </span><br><span class="line">  viewer &#123; </span><br><span class="line">    login</span><br><span class="line">    name</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä»å¦‚ä¸Šçš„ä¾‹å­å¯ä»¥çœ‹å‡ºï¼ŒGraphQL å®é™…ä¸Šæ˜¯ä¸€ç§å¼ºç±»å‹çš„ APIã€‚ä¸ä½¿ç”¨æ™®é€šçš„ REST API ç›¸æ¯”ï¼Œå¼ºç±»å‹ç³»ç»Ÿæ˜¯ GraphQL æœ€å¸å¼•æˆ‘çš„åœ°æ–¹ä¹‹ä¸€ã€‚åœ¨æˆ‘çœ‹æ¥ï¼Œæ­£æ˜¯ GraphQL å¼ºç±»å‹çš„ç‰¹æ€§ï¼Œå¼€åˆ›äº† API çš„æ–°å¤©åœ°ã€‚</p>
<p>åœ¨æˆ‘çœ‹æ¥ï¼ŒREST API ç¼ºä¹<code>ç±»å‹ç³»ç»Ÿ</code>ç‰¹æ€§åœ¨å¼€å‘ä¸­ä¼šå¼•å…¥å¾ˆå¤šçš„é—®é¢˜ï¼Œå·¥ä½œä¸­ï¼Œæˆ‘ç»å¸¸ä¼šé‡åˆ°å¦‚ä¸‹çš„æƒ…å†µï¼š</p>
<ul>
<li>ä¸Šæ¸¸æœåŠ¡ä¿®æ”¹äº† REST API çš„å­—æ®µç±»å‹è€Œæœªå‘¨çŸ¥ä¸‹æ¸¸æ¶ˆè´¹è€…å¯¼è‡´ä¸‹æ¸¸æœåŠ¡å¼‚å¸¸ç”šè‡³å´©æºƒ</li>
<li>æœåŠ¡ç«¯æœªè¿”å›ç‰¹å®šå­—æ®µå¯¼è‡´å®¢æˆ·ç«¯å´©æºƒ</li>
<li>å®¢æˆ·ç«¯è¯·æ±‚å‚æ•°å¼‚å¸¸ï¼Œå¯¼è‡´æœåŠ¡ç«¯çš„é”™è¯¯ç‡ä¸Šå‡</li>
<li>åˆ°å¤„æ‰¾å€Ÿå£æ–‡æ¡£ï¼Œå¥½ä¸å®¹æ˜“æ‰¾åˆ°äº†å¿½ç„¶å‘ç°ï¼Œæ¥å£æ–‡æ¡£å’Œæ¥å£çš„è¿”å›å¹¶ä¸ä¸€è‡´ï¼Œæ–‡æ¡£å¤ªæ»åäº†</li>
<li>â€¦â€¦</li>
</ul>
<p>å¦‚æœæœ‰ä¸€ä¸ªç±»å‹ç³»ç»Ÿè¿›è¡Œçº¦æŸï¼Œåˆ™æƒ…å†µä¼šå˜çš„æ›´å¥½ä¸€ç‚¹ã€‚å› æ­¤ï¼Œé’ˆå¯¹äº json æ ¼å¼çš„ REST API è€Œè¨€ï¼Œå¼€å§‹å‡ºç°ç±»ä¼¼ <a href="https://swagger.io/tools/swagger-ui/">Swagger UI</a> è¿™æ ·çš„å·¥å…·ï¼Œåˆ©ç”¨ <a href="https://json-schema.org/">Json Schema</a> æ¥å¼ºåŒ–å…¶ç±»å‹ç³»ç»Ÿã€‚è™½ç„¶å¦‚æ­¤ï¼Œä½†æ˜¯ï¼Œåœ¨æˆ‘çœ‹æ¥ï¼ŒåŸºäº Json Schema çš„ REST API ç±»å‹ç³»ç»Ÿä»…ä»…æ˜¯ä¸€ä¸ªè§„èŒƒå’Œå»ºè®®è€Œå·²ï¼Œå›¢é˜Ÿä¸­çš„å…¶ä»–äººä¸ä½¿ç”¨ä¹Ÿæ²¡åŠæ³•ã€‚ä½†æ˜¯ï¼ŒGraphQL çš„ç±»å‹ç³»ç»Ÿæ˜¯å…¶æ ¹åŸºï¼Œæ‰€æœ‰äººå¿…é¡»éµå®ˆï¼Œè¿™å°±åœ¨å¤§å®¶å¯¹æ¥å£æè¿°å½¢æˆç»Ÿä¸€è®¤è¯†ä¸Šå‘æŒ¥ç€é‡è¦ä½œç”¨ã€‚</p>
<p>åŒæ ·çš„é“ç†ï¼Œå¯¹äº <a href="https://github.com/Tencent/rapidjson/">rapidjson</a> è€Œè¨€ï¼Œä» v1.1 ç‰ˆæœ¬å¼€å§‹ï¼Œä¹ŸåŠ å…¥äº† JSON Schema åŠŸèƒ½ï¼Œä½¿å…¶å¯ä»¥åœ¨è§£ææˆ–ç”Ÿæˆ JSON æ—¶è¿›è¡Œæ ¡éªŒï¼Œä»¥é¿å…ç±»å‹é”™è¯¯çš„ json è€Œå¯¼è‡´çš„è§£ææ—¶å´©æºƒé—®é¢˜çš„å‘ç”Ÿã€‚</p>
<p>å¼±ç±»å‹è¯­è¨€å¼•å…¥ç±»å‹ç³»ç»Ÿä¹Ÿå˜å¾—è¶Šæ¥è¶Šæµè¡Œï¼Œä¾‹å¦‚å¾®è½¯çš„ <a href="https://www.typescriptlang.org/">TypeScript</a>ï¼ŒPHP7 çš„ <a href="https://www.php.net/manual/en/language.types.declarations.php">å¼ºç±»å‹æ¨¡å¼</a>ï¼Œè¿˜æœ‰ Facebook å¼€å‘çš„ <a href="https://hacklang.org/">Hackè¯­è¨€</a>â€¦â€¦</p>
<p>å¼±ç±»å‹è¯­è¨€ï¼Œçœ‹ä¼¼æ— æ‹˜æ— æŸï¼Œå®åˆ™å……æ»¡äº†æ··ä¹±ä¸å±é™©ï¼›å¼ºç±»å‹è¯­è¨€ï¼Œçœ‹ä¼¼ç”»åœ°ä¸ºç‰¢ï¼Œå®åˆ™æ˜¯å¦ä¸€ç§è‡ªç”±ã€‚åœ¨ GraphQL ç±»å‹ç³»ç»Ÿçš„å¸®åŠ©ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ç²¾ç¡®çš„æè¿°æˆ‘ä»¬çš„æ¥å£æ•°æ®ï¼Œå¹¶ä¸”å¯ä»¥åšåˆ°æ•°æ®æè¿°å’Œæ¥å£å®Œå…¨å¯¹åº”ã€‚è¿™ç§èƒ½åŠ›å¯¹äºå¤§å‹ã€å¤šäººåä½œå¼å›¢é˜Ÿè€Œè¨€ï¼Œè‡³å…³é‡è¦ã€‚å°¤å…¶æ˜¯å¾®æœåŠ¡ç››è¡Œçš„ä»Šå¤©ï¼Œæˆ‘è®¤ä¸ºï¼ŒGraphQL çš„å¼ºç±»å‹ç³»ç»Ÿä¸ºå¾®æœåŠ¡äº¤äº’æä¾›äº†æ–°çš„æ´»åŠ›ã€‚</p>
<h4 id="æˆ‘çš„åœ°ç›˜å¬æˆ‘çš„-ä»…è¦æˆ‘æ‰€éœ€">æˆ‘çš„åœ°ç›˜å¬æˆ‘çš„ï¼Œä»…è¦æˆ‘æ‰€éœ€</h4>
<p>åœ¨ GraphQL ä¸­ï¼ŒGraphQL Runtime ç¡®å®š GraphQL Server å¯ä»¥æä¾›çš„èƒ½åŠ›ï¼Œè€Œæ¶ˆè´¹ç«¯å…·ä½“è¦è·å–å“ªäº›æ•°æ®åˆ™å®Œå…¨ç”±æ¶ˆè´¹è€…è¯´äº†ç®—ã€‚å¯¹äºä¸‹æ¸¸æ¶ˆè´¹è€…è€Œè¨€çœŸæ­£åšåˆ°äº†ï¼šæˆ‘çš„åœ°ç›˜ï¼Œå¬æˆ‘çš„ï¼åªè¦æˆ‘æ‰€è¦çš„ï¼Œä¸å¤šä¹Ÿä¸å°‘ï¼</p>
<p>ä¹‹æ‰€ä»¥è¯´ GraphQL æ˜¯é©å‘½æ€§çš„æ–°æŠ€æœ¯ï¼Œæˆ‘è§‰å¾—å°±åœ¨äºæ­¤ã€‚GraphQL æ”¹å˜äº†æœåŠ¡ä¹‹é—´äº¤äº’çš„æ–¹å¼ï¼Œè®©é€šä¿¡åŒæ–¹åœ¨äº¤äº’çš„è¿‡ç¨‹ä¸­æ›´åŠ å¹³ç­‰ï¼Œæ”¹å˜äº†ä¹‹å‰å“åº”æ•°æ®å®Œå…¨ç”± Server ç«¯è¯´äº†ç®—çš„å±€é¢ã€‚å¦‚ä»Šï¼Œåœ¨ GraphQL ä¸­ï¼Œå®¢æˆ·ç«¯ï¼ˆæ¶ˆè´¹ç«¯ï¼‰å¯ä»¥ä»¥æ›´åŠ å¹³ç­‰çš„åœ°ä½ï¼Œæ›´åŠ ç§¯æçš„å‚ä¸åˆ°æ•´ä¸ªçš„æ•°æ®äº¤äº’è¿‡ç¨‹ã€‚</p>
<p>å€ŸåŠ©äº GraphQL çš„ç±»å‹ç³»ç»Ÿï¼Œå®¢æˆ·ç«¯å¯ä»¥æ›´åŠ è‡ªç”±çš„æ ¹æ®è‡ªå·±çš„éœ€æ±‚æ¥è·å¾—è‡ªå·±çš„æ‰€éœ€ï¼Œè€Œæ— éœ€æ”¶åˆ° Server ç«¯çš„é™åˆ¶ã€‚</p>
<p>åœ¨æˆ‘çš„ä¸ªäººåšå®¢ç«™ç‚¹ä¸­ï¼Œæˆ‘é‡‡ç”¨ <a href="https://docs.github.com/en/actions">github action</a> æ¥ç¼–è¯‘å¹¶å‘å¸ƒç«™ç‚¹å†…å®¹ã€‚ç«™ç‚¹ä¸­ï¼Œä¼šæœ‰å¾ˆå¤šåŸºäº <a href="https://www.gitbook.com/">gitbook</a> çš„ä¹¦ç±ï¼Œå¹¶ä¸”æ¯ä¸€æœ¬ä¹¦éƒ½å¯¹åº”ä¸€ä¸ª github ä»“åº“ã€‚ä¸ºäº†åŠ å¿«ç«™ç‚¹çš„å‘å¸ƒé€Ÿåº¦ï¼Œå¯¹äºæ¯ä¸€æœ¬ä¹¦ç±è€Œè¨€ï¼Œéƒ½ä¼šæå‰ç¼–è¯‘å¹¶ä¸”å°†ç¼–è¯‘äº§ç‰©ç½®äº latest release ä¸­ã€‚åœ¨å‘å¸ƒä¸»ç«™å†…å®¹æ—¶ï¼Œæˆ‘åˆ©ç”¨ <a href="https://github.com/wangwei1237/wangwei1237.github.io_src/blob/master/build_books.sh">build_books.sh</a> è„šæœ¬æ¥è·å–ä¹¦ç±çš„ release äº§ç‰©ã€‚å¦‚æœé‡‡ç”¨REST APIï¼Œåˆ™ç›¸å¯¹æ¯”è¾ƒç®€å•ï¼Œç›´æ¥è¯·æ±‚å¦‚ä¸‹çš„ <code>end point</code> å³å¯ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">https:<span class="comment">//api.github.com/repos/wangwei1237/$&#123;BOOKS[i]&#125;/releases/latest</span></span><br></pre></td></tr></table></figure>
<p>è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘åªéœ€è¦å¯¹åº”çš„ <code>assets.browser_download_url</code>å­—æ®µï¼Œä½†æ˜¯ä½¿ç”¨ REST API æˆ‘æ²¡åŠæ³•æ§åˆ¶æ¥å£çš„è¿”å›æ•°æ®ï¼Œå³ä¾¿æˆ‘åªéœ€è¦æŸä¸€ä¸ªå­—æ®µï¼Œæ¥å£è¿˜æ˜¯ä¼šè¿”ç»™æˆ‘æ‰€æœ‰çš„æ•°æ®ã€‚</p>
<p>è€Œå¦‚æœä½¿ç”¨ GraphQLï¼Œæˆ‘å°±å¯ä»¥è‡ªå·±è¯´äº†ç®—äº†ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// GraphQL Query</span></span><br><span class="line">query <span class="function"><span class="title">getBooksAssetUrl</span>(<span class="params">$repo: <span class="built_in">String</span>!, $owner: <span class="built_in">String</span>!</span>)</span> &#123; </span><br><span class="line">  <span class="function"><span class="title">repository</span>(<span class="params">name: $repo, owner: $owner</span>)</span> &#123;</span><br><span class="line">    latestRelease &#123;</span><br><span class="line">      <span class="function"><span class="title">releaseAssets</span>(<span class="params">first: <span class="number">1</span></span>)</span> &#123;</span><br><span class="line">        nodes &#123;</span><br><span class="line">          downloadUrl</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Query Variables</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;repo&quot;</span>: <span class="string">&quot;monolith-to-microservices&quot;</span>,</span><br><span class="line">  <span class="string">&quot;owner&quot;</span>: <span class="string">&quot;wangwei1237&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Query Response</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;data&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;repository&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;latestRelease&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;releaseAssets&quot;</span>: &#123;</span><br><span class="line">          <span class="string">&quot;nodes&quot;</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="string">&quot;downloadUrl&quot;</span>: <span class="string">&quot;https://github.com/wangwei1237/monolith-to-microservices/releases/download/v1.1.1/monolith-to-microservices.tar.gz&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">          ]</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å› æ­¤ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒGraphQL å®Œç¾çš„é¿å…äº†ä¸å¿…è¦çš„æ•°æ®ä¼ è¾“ï¼ˆoverfetchingï¼‰<sup class="footnote-ref"><a href="#fn6" id="fnref6">[6]</a></sup>,å°¤å…¶æ˜¯å¯¹äºå¦‚ä¸‹çš„åœºæ™¯ï¼šæµé‡è¾ƒå¤§ï¼Œç½‘ç»œè¾ƒå·®ï¼Œé’ˆå¯¹ä¸åŒçš„å®¢æˆ·ç«¯è¿”å›ä¸åŒæ•°æ®â€¦â€¦ï¼Œè¿™ä¸ªç‰¹æ€§å°¤ä¸ºé‡è¦ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œè¿™ä¸ªç‰¹æ€§æ”¹å˜äº†é€šä¿¡åŒæ–¹çš„è¯è¯­æƒã€‚</p>
<h4 id="ç²¾ç¡®é¢„æµ‹å“åº”æ•°æ®">ç²¾ç¡®é¢„æµ‹å“åº”æ•°æ®</h4>
<p>GraphQL ä¸ä½†æ”¹å˜äº†é€šä¿¡åŒæ–¹çš„è¯è¯­æƒï¼Œè¿˜ä½¿å¾—å®¢æˆ·ç«¯å¯ä»¥ç²¾ç¡®çš„é¢„æµ‹æœåŠ¡ç«¯çš„å“åº”ã€‚åœ¨ä½¿ç”¨ REST API æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å€ŸåŠ©å„ç§ API æ–‡æ¡£æ‰èƒ½<strong>å¤§æ¦‚</strong>é¢„æµ‹è¯·æ±‚çš„å“åº”ï¼Œåœ¨å¼€å‘ä¸­ï¼Œè¿™ç¡®å®æ˜¯ä¸€ä»¶éå¸¸è®¨åŒçš„äº‹æƒ…ã€‚æ— æ³•ç²¾ç¡®çš„é¢„æµ‹è¯·æ±‚çš„å“åº”ï¼Œè¿™å›ç›´æ¥å¯¼è‡´ä»£ç çš„å®¹é”™æ€§å¤§å¤§æŠ˜æ‰£ã€‚è°èƒ½ç¡®ä¿æ‰€æœ‰çš„æ¥å£çš„æ¥å£æ–‡æ¡£éƒ½ä¼šè¯¦ç»†çš„ç©·ä¸¾æ‰€æœ‰æƒ…å†µä¸‹çš„æ¥å£å“åº”å‘¢ï¼Ÿæ®æˆ‘çš„ç»éªŒè€Œè¨€ï¼Œå¾ˆéš¾â€¦â€¦</p>
<p>å½“æˆ‘è¯·æ±‚ä¸€ä¸ªæ²¡æœ‰ release äº§ç‰©çš„çš„ä»“åº“æ—¶ï¼Œæ ¹æ® GraphQL çš„ç±»å‹ç³»ç»Ÿï¼Œæˆ‘ä¼šé¢„æµ‹åˆ°ï¼Œæ­¤æ—¶ GraphQL ä¼šè¿”å› nullï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// latestRelease type</span></span><br><span class="line">latestRelease: Release</span><br><span class="line"></span><br><span class="line"><span class="comment">// Query Variables</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;repo&quot;</span>: <span class="string">&quot;wangwei1237.github.io&quot;</span>,</span><br><span class="line">  <span class="string">&quot;owner&quot;</span>: <span class="string">&quot;wangwei1237&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Query Response</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;data&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;repository&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;latestRelease&quot;</span>: <span class="literal">null</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="graphql-api-çš„ç‰ˆæœ¬æ§åˆ¶">GraphQL API çš„ç‰ˆæœ¬æ§åˆ¶</h4>
<p>å¯¹äº API çš„ç‰ˆæœ¬æ§åˆ¶è€Œè¨€ï¼ŒGraphQL å€Ÿé‰´äº†å…¶ä»–è¯­è¨€ä¸­çš„ <code>@deprecatedæ³¨è§£</code>ã€‚å¦‚æœç»å—è¿‡ REST API çš„ç‰ˆæœ¬æ§åˆ¶ä¹‹ç—›ï¼Œç»å—è¿‡é‚£äº› v1ï¼Œv2ï¼Œâ€¦â€¦ï¼Œé‚£ä¹ˆä½ ä¹Ÿä¼šåƒæˆ‘ä¸€æ ·ï¼Œå–œæ¬¢ GraphQL æä¾›çš„è¿™ä¸€ç‰¹æ€§ã€‚</p>
<p>æ‘˜å½•Samer Bunaåœ¨ <a href="https://wangwei1237.gitee.io/shares/GraphQL_in_Action.pdf">ã€ŠGraphQL in Actionã€‹</a> ä¸­çš„ä¾‹å­å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">type Query &#123;</span><br><span class="line">  hello: <span class="built_in">String</span></span><br><span class="line">  currentTime: <span class="built_in">String</span></span><br><span class="line">  sumNumbersInRange(begin: Int!, end: Int!): Int! @deprecated(reason: <span class="string">&quot;use new fields numbersInRange&quot;</span>)</span><br><span class="line">  numbersInRange(begin: Int!, end: Int!): NumbersInRange!</span><br><span class="line">  taskMainList: [Task!]</span><br><span class="line">  taskInfo(taskId: ID!): Task!</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;</span><span class="string">&quot;Aggregate info on a range numbers&quot;</span><span class="string">&quot;&quot;</span></span><br><span class="line">type NumbersInRange &#123;</span><br><span class="line">  sum: Int!</span><br><span class="line">  count: Int!</span><br><span class="line">  avg: Float!</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯¹äº <code>sumNumbersInRange</code> å­—æ®µï¼Œä½¿ç”¨ <code>@deprecated</code> æ ‡å¿—è¯¥å­—æ®µæ˜¯åºŸå¼ƒå­—æ®µï¼Œå¹¶ä¸”åˆ©ç”¨ <code>reason</code> å‚æ•°æ¥å°†è¯¥åºŸå¼ƒå­—æ®µå’Œæ¨èçš„æ–°å­—æ®µå…³è”èµ·æ¥ã€‚å¦‚æœé…åˆ IDE çš„ä»£ç æ‰«æèƒ½åŠ›ï¼Œå½“åœ¨æ¥å£ä¸­è¯·æ±‚ <code>sumNumbersInRange</code> çš„æ—¶å€™ï¼ŒIDE ç»™å‡ºå¯¹åº”çš„åºŸå¼ƒæç¤ºå’ŒåŸå› ï¼Œé‚£ä¹ˆç»è¿‡ä¸€æ®µæ—¶é—´çš„è¿­ä»£ï¼Œæ ‡è®°ä¸º <code>@deprecated</code> çš„å­—æ®µå°±ä¼šæ…¢æ…¢æ¶ˆå¤±åœ¨äº§å“ä»£ç ä¸­ã€‚è¿™ä¼šä½¿å¾— API çš„ç‰ˆæœ¬ç®¡ç†æ›´åŠ å®¹æ˜“ï¼Œä¹Ÿä½¿å¾—å®¢æˆ·ç«¯æ›´åŠ å®¹æ˜“ç†è§£ API çš„è¿›åŒ–å’Œå‘åå…¼å®¹ã€‚</p>
<p>è€Œä½¿ç”¨ REST API çš„æ—¶å€™ï¼Œåœ¨æ²¡æœ‰è¿™ç§ç±»ä¼¼æœºåˆ¶çš„å¸®åŠ©ä¸‹ï¼Œæˆ‘ç»å¸¸ä¼šä½¿ç”¨äº†ä¸Šæ¸¸æœåŠ¡å‡†å¤‡ <code>deprecated</code> çš„å­—æ®µï¼Œå› æ­¤ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå‡†å¤‡åºŸå¼ƒçš„å­—æ®µä¸å¾—ä¸ä¸ºäº†å…¼å®¹è€Œæ°¸ä¹…çš„ä¿ç•™åœ¨äº†æœåŠ¡ä¹‹ä¸­ã€‚</p>
<p>æˆ‘è§è¿‡ä¸€ä¸ª REST APIï¼Œè¿™ä¸ª API ç»è¿‡å¥½å‡ å¹´çš„å‘å±•ï¼Œæ¯æ¬¡è¯·æ±‚éƒ½ä¼šè¿”å› 10K+ çš„æ•°æ®ï¼Œå¹¶ä¸”é‡Œé¢æœ‰å¾ˆå¤šå­—æ®µçš„å«ä¹‰åŸºæœ¬ä¸€è‡´ï¼Œåªä¸è¿‡æ˜¯æœ‰äº›å­—æ®µä¸ºäº†å…¼å®¹æŸä¸ªç‰¹å®šçš„éœ€æ±‚è€Œå¢åŠ ã€‚è¿™ä¸ª API ä¸­çš„å­—æ®µè°ä¹Ÿä¸æ•¢åŠ¨ï¼Œèƒ½åšçš„åªèƒ½æ˜¯éšç€éœ€æ±‚çš„å¢åŠ è€Œä¸æ–­çš„å¢åŠ è¯¥ API çš„è§„æ¨¡ã€‚å¼€å‘è¿™ä¸ª API æ˜¯ä¸€ä»¶éå¸¸å¯æ€•çš„äº‹æƒ…ã€‚</p>
<h2 id="å¦‚ä½•çœ‹å¾…-graphql-çš„ç¼ºç‚¹">å¦‚ä½•çœ‹å¾… GraphQL çš„ç¼ºç‚¹</h2>
<p>æ–°ç”Ÿä¹‹ç‰©ï¼Œå…¶è²Œå¿…ä¸‘ã€‚è™½ç„¶ GraphQL å·²ç»å‘å±•äº†å‡ å¹´ï¼Œä½†æ˜¯å®é™…ä¸Šè€Œè¨€ GraphQL è¿˜ç®—æ˜¯ä¸€ä¸ªæ¯”è¾ƒæ–°é¢–çš„æŠ€æœ¯ã€‚æ ¹æ® <a href="https://wangwei1237.gitee.io/shares/GraphQL_in_Action.pdf">ã€ŠGraphQL in Actionã€‹</a> ä¸­çš„ç¬¬ 1.3 èŠ‚çš„ä»‹ç»ï¼Œåˆ°ç›®å‰ä¸ºæ­¢ï¼ŒGraphQL ä»ç„¶æœ‰å¾ˆå¤šçš„é—®é¢˜éœ€è¦è§£å†³ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>å®‰å…¨æ€§é—®é¢˜</li>
<li>ç¼“å­˜é—®é¢˜</li>
<li>å­¦ä¹ é—¨æ§›é—®é¢˜</li>
<li>â€¦â€¦</li>
</ul>
<p>è™½ç„¶å¦‚æ­¤ï¼Œæˆ‘è¿˜æ˜¯è®¤ä¸º GraphQL å¼€åˆ›äº† API äº¤äº’çš„æ–°å¤©åœ°ï¼Œä»£è¡¨ç€æ–°çš„æŠ€æœ¯çš„å‘å±•æ–¹å‘ã€‚å¹¶ä¸”æˆ‘ä¹Ÿå‘ç°ï¼Œç›®å‰æ•´ä¸ª GraphQL ç¤¾åŒºä¹Ÿåœ¨åšå¾ˆå¤šçš„å·¥ä½œæ¥è§£å†³ç›®å‰çš„ä¸€äº›é—®é¢˜ã€‚ä¾‹å¦‚ Facebook ä¸ºäº†è§£å†³ç¼“å­˜é—®é¢˜è€Œå¼€å‘çš„ dataloader åº“ï¼Œ<a href="https://www.apollographql.com/">apollo graphql</a> åœ¨æ¨åŠ¨ GraphQL å·¥ä¸šè½åœ°æ–¹é¢æ‰€åšçš„å„ç§åŠªåŠ›ï¼Œâ€¦â€¦</p>
<p>æ­£å¦‚æˆ‘åœ¨ <a href="/2021/05/01/how-to-improve-the-work-efficiency/">å¦‚ä½•æå‡å·¥ä½œæ•ˆç‡</a> ä¸€æ–‡ä¸­è¯´çš„é‚£æ ·ï¼š</p>
<blockquote>
<p>æˆ‘ä»¬å¿…é¡»è®¤è¯†åˆ°ï¼ŒçŸ­æœŸçœ‹ï¼Œæ–°æŠ€æœ¯ä¼šè§£å†³æˆ‘ä»¬å½“å‰çš„é—®é¢˜ï¼Œä½†æ˜¯æ–°æŠ€æœ¯å¿…ç„¶ä¼šå¼•å…¥æ–°çš„é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦ä¸æ—¶ä¿±è¿›ï¼Œåœ¨æ–°çš„åœºæ™¯ä¸‹ä¸æ–­è§£å†³æ–°æŠ€æœ¯å¸¦æ¥çš„é—®é¢˜ã€‚è¿™æœ‰è¿™æ ·ï¼Œæ‰èƒ½ä¸æ–­çš„æå‡å·¥ä½œæ•ˆç‡ã€‚</p>
<p>æˆ‘ä»¬ä¸èƒ½å› ä¸ºå µè½¦ï¼Œå°±å›é€€åˆ°è‡ªè¡Œè½¦çš„æ—¶ä»£ï¼›æˆ‘ä»¬ä¸èƒ½å› ä¸ºæœ‰å‡å¸ï¼Œå°±å›é€€åˆ°ç‰©ç‰©äº¤æ¢çš„æ—¶ä»£ï¼›â€¦â€¦</p>
</blockquote>
<p>å¹¶ä¸”ï¼Œç›®å‰çœ‹ï¼ŒGraphQL æ­£åœ¨å˜çš„è¶Šæ¥è¶Šæµè¡Œã€‚Postman åšå®¢ç«™ç‚¹çš„ <a href="https://blog.postman.com/postman-v7-2-supports-graphql/">Postman v7.2 Supports GraphQL</a> ä¸­æåˆ°ï¼š</p>
<blockquote>
<p>å¦‚æœæ‚¨ä¸€ç›´åœ¨ç­‰å¾… Postman å¯¹ GraphQL çš„æ”¯æŒï¼Œé‚£ä¹ˆç°åœ¨å¯ä»¥ç»“æŸè¿™ç§ç­‰å¾…äº†ã€‚éšç€ Postman v7.2 çš„å‘å¸ƒï¼ŒPostman å·²ç»æ”¯æŒ GraphQLï¼åœ¨ GitHub ä¸Šï¼Œ<a href="https://github.com/postmanlabs/postman-app-support/issues/1669">GraphQL çš„å†…ç½®æ”¯æŒ</a>ä¸€ç›´æ˜¯æˆ‘ä»¬çš„ç¬¬äºŒå¤§æœ€å—æ¬¢è¿çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬å¾ˆé«˜å…´å°†è¿™ä¸ªæµè¡Œçš„è§„èŒƒå¼•å…¥ Postman åº”ç”¨ç¨‹åºã€‚</p>
</blockquote>
<h2 id="å¦‚ä½•åˆ¤æ–­æ˜¯å¦è¦ä½¿ç”¨-graphql">å¦‚ä½•åˆ¤æ–­æ˜¯å¦è¦ä½¿ç”¨ GraphQL</h2>
<p>å³ä¾¿å¦‚æ­¤ï¼Œåœ¨ç¡®å®šæ˜¯å¦è¦ä½¿ç”¨ GraphQL æŠ€æœ¯æ—¶ï¼Œéœ€è¦åšè®¤çœŸçš„åˆ†æï¼Œä¸”ä¸å¯ä¸ºäº†è¿½æ–°è€Œé‡‡ç”¨ GraphQLã€‚</p>
<p>å¦‚æœæ‰€æä¾›æœåŠ¡çš„ä¸‹æ¸¸æ¶ˆè´¹è€…è¾ƒå°‘å¹¶ä¸”èŒƒå›´ä¹Ÿè¾ƒå°‘ï¼Œé‚£ä¹ˆè¿˜æ˜¯æ¨èä½¿ç”¨ REST APIã€‚ä½†æ˜¯å¦‚æœæä¾›çš„æœåŠ¡æ˜¯ç±»ä¼¼ Github Open API è¿™æ ·çš„è§„æ¨¡è¾ƒå¤§çš„æœåŠ¡ï¼Œæˆ–è€…ä½¿ç”¨è¯¥æœåŠ¡çš„ä¸‹æ¸¸æ¶ˆè´¹è€…èŒƒå›´è¾ƒå¤§ã€æ•°é‡è¾ƒå¤šï¼Œæˆ‘è®¤ä¸ºé‡‡ç”¨ GraphQL ç¡®å®æ˜¯ä¸Šä¸Šä¹‹é€‰ã€‚</p>
<p>æ€»ä¹‹ï¼Œè¶Šæ˜¯æ¶‰åŠåˆ°å›¢é˜Ÿäº¤äº’å¤šã€å›¢é˜Ÿåä½œå¤šçš„æœåŠ¡ï¼Œæˆ‘è¶Šæ˜¯å»ºè®®é‡‡ç”¨ GraphQLã€‚å› ä¸ºåä½œæœ€å¤æ‚çš„åœ°æ–¹åœ¨äº <code>communication</code>ï¼Œè€Œ GraphQL å°±æ˜¯é©æ–°å¤šæ–¹åä½œçš„ä¸€ç§æ–°æŠ€æœ¯ã€‚å°±åƒä¸‡ç»´ç½‘å½»åº•æ”¹å˜äº†äººç±»ä¸–ç•Œçš„äº¤æµæ–¹å¼ä¸€æ ·ï¼Œæˆ‘æƒ³ï¼ŒGraphQL æ­£åœ¨å½»åº•æ”¹å˜ API çš„äº¤æµæ–¹å¼ï¼Œå°¤å…¶æ˜¯åœ¨å¾®æœåŠ¡æ¶æ„ä¸­<sup class="footnote-ref"><a href="#fn7" id="fnref7">[7]</a></sup> <sup class="footnote-ref"><a href="#fn8" id="fnref8">[8]</a></sup> <sup class="footnote-ref"><a href="#fn9" id="fnref9">[9]</a></sup>ã€‚</p>
<style>.admonition {
    margin: 1.5625em 0;
    padding: .6rem;
    overflow: hidden;
    font-size: 1.6rem;
    page-break-inside: avoid;
    border-left: .6rem solid #42b983;
    border-radius: .6rem;
    box-shadow: 0 0.1rem 0.4rem rgba(0,0,0,.5), 0 0 0.05rem rgba(0,0,0,.1);
    background-color: #fafafa;
  }
  
  p.admonition-title {
    position: relative;
    margin: -.6rem -.6rem .8em -.6rem !important;
    padding: .4rem .6rem .4rem .4rem;
    font-weight: 700;
    background-color:rgba(66, 185, 131, .1);
  }
  
  /*
  .admonition-title::before {
    position: absolute;
    top: .9rem;
    left: 1rem;
    width: 12px;
    height: 12px;
    background-color: #42b983;
    border-radius: 50%;
    content: ' ';
  }
  */
  
  .info>.admonition-title, .todo>.admonition-title {
    background-color: rgba(0,184,212,.1);
  }
  
  .warning>.admonition-title, .attention>.admonition-title, .caution>.admonition-title {
    background-color: rgba(255,145,0,.1);
  }
  
  .failure>.admonition-title, .missing>.admonition-title, .fail>.admonition-title, .error>.admonition-title {
    background-color: rgba(255,82,82,.1);
  }
  
  .admonition.info, .admonition.todo {
    border-color: #00b8d4;
  }
  
  .admonition.warning, .admonition.attention, .admonition.caution {
    border-color: #ff9100;
  }
  
  .admonition.failure, .admonition.missing, .admonition.fail, .admonition.error {
    border-color: #ff5252;
  }
  
  .info>.admonition-title::before, .todo>.admonition-title::before {
    background-color: #00b8d4;
    border-radius: 50%;
  }
  
  .warning>.admonition-title::before, .attention>.admonition-title::before, .caution>.admonition-title::before {
    background-color: #ff9100;
    border-radius: 50%;
  }
  
  .failure>.admonition-title::before,.missing>.admonition-title::before,.fail>.admonition-title::before,.error>.admonition-title::before{
    background-color: #ff5252;;
    border-radius: 50%;
  }
  
  .admonition>:last-child {
    margin-bottom: 0 !important;
  }
  </style>
<div class="admonition warning"><p class="admonition-title">é™¤äº†å¦‚ä¸Šçš„è€ƒè™‘å¤–ï¼Œè¿˜éœ€è¦æ€è€ƒå¦‚ä¸‹çš„é—®é¢˜
</p><ul>
<li>GraphQL æ˜¯å¦é€‚åˆå½“å‰çš„ä¸šåŠ¡å‘å±•é˜¶æ®µï¼Ÿ</li>
<li>å¼•å…¥ GraphQL ä¹‹åçš„ç‰ˆæœ¬å…¼å®¹é—®é¢˜ã€é…å¥—åŸºç¡€è®¾æ–½çš„æ”¹é€ ç­‰å¦‚ä½•å¤„ç†ï¼Ÿ</li>
<li>å¼•å…¥ GraphQL æ˜¯å¦èƒ½å¤Ÿåœ¨è§£å†³ç°æœ‰ä¸šåŠ¡é—®é¢˜çš„åŸºç¡€ä¸Šé¿å…å¼•å…¥æ›´å¤šçš„é—®é¢˜ï¼Ÿ</li>
<li>å›¢é˜Ÿå†…éƒ¨çš„å…¶ä»–æˆå‘˜æ˜¯å¦æ¥å— GraphQL çš„è¿™ç§ç†å¿µï¼Œä¾‹å¦‚å‰ç«¯äººå‘˜æ˜¯å¦ä¹æ„æ‹¥æœ‰å®šä¹‰æ¥å£çš„è¿™ç§æƒåˆ©ï¼Ÿ</li>
<li>â€¦â€¦</li>
</ul>
</div>
<p><img src="/2021/06/15/Preliminary-Exploration-of-the-GraphQL/2.png" alt></p>
<h2 id="graphql-åˆ†äº«">GraphQL åˆ†äº«</h2>
<p>ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/wangwei1237/docs/releases/download/v1.0.0/GraphQL_in_Action.pdf">https://github.com/wangwei1237/docs/releases/download/v1.0.0/GraphQL_in_Action.pdf</a></p>
<h2 id="åè®°">åè®°</h2>
<p>åæ¥ï¼Œæˆ‘ä»¬å¯¹ä¸€ä¸ªå†…éƒ¨çš„å°é¡¹ç›®å®æ–½äº† GraphQL è¿ç§»ï¼Œå…·ä½“çš„å¯ä»¥å‚è§ï¼š<a href="/2021/07/17/The-First-Python-Project-For-GraphQL/">GraphQL å®è·µ</a>ã€‚</p>
<p>å†ä¹‹åï¼Œæˆ‘è¯»åˆ°äº†ä¸€ç¯‡ PayPal å®è·µ GraphQL çš„æ–‡ç«  â€”â€” <a href="https://www.infoq.cn/article/l7smlb4HFKjMZrt4wERK">PayPal å¤§è§„æ¨¡é‡‡ç”¨ GraphQL çš„æ¢ç´¢å’Œå®è·µ</a>ï¼Œåœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œè®²è¿°äº† PayPal é¢ä¸´çš„é—®é¢˜ï¼Œä¸ºä»€ä¹ˆä¼šé‡‡ç”¨ GraphQLï¼Œå¦‚ä½•é‡‡ç”¨ GraphQLï¼Œé‡‡ç”¨ GraphQL è¿˜é¢ä¸´çš„é—®é¢˜ï¼Œâ€¦â€¦è¿™ä¹Ÿæ˜¯å¯¹â€GraphQL å¾ˆéš¾é€‚åˆæœ‰ä¸šåŠ¡åŒ…è¢±çš„éƒ¨é—¨å’Œå…¬å¸â€œçš„ä¸€ä¸ªæ¯”è¾ƒå¥½çš„åé©³æ¡ˆä¾‹ã€‚</p>
<h2 id="å­¦ä¹ èµ„æº">å­¦ä¹ èµ„æº</h2>
<ul>
<li><a href="https://spec.graphql.cn/">https://spec.graphql.cn/</a></li>
<li><a href="https://graphql.org/">https://graphql.org/</a> or <a href="https://graphql.cn">https://graphql.cn</a></li>
<li><a href="https://graphql.org/swapi-graphql/">https://graphql.org/swapi-graphql/</a></li>
<li><a href="https://docs.github.com/en/graphql">https://docs.github.com/en/graphql</a></li>
<li><a href="https://docs.github.com/en/graphql/overview/explorer">https://docs.github.com/en/graphql/overview/explorer</a></li>
<li><a href="https://www.apollographql.com/docs/">https://www.apollographql.com/docs/</a></li>
<li><a href="https://www.howtographql.com">https://www.howtographql.com</a></li>
<li><a href="https://wangwei1237.gitee.io/shares/GraphQL_in_Action.pdf">https://wangwei1237.gitee.io/shares/GraphQL_in_Action.pdf</a></li>
<li><a href="https://github.com/graphql/graphql-playground">https://github.com/graphql/graphql-playground</a></li>
</ul>
<h2 id="å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</h2>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p>Samer Buna. GraphQL in Action. Manning Publications, March 9, 2021. <a href="#fnref1" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn2" class="footnote-item"><p><a href="https://graphql.org/">https://graphql.org/</a>, <a href="https://graphql.cn/">https://graphql.cn/</a>. <a href="#fnref2" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn3" class="footnote-item"><p><a href="https://docs.github.com/en/graphql">Github Docs: GitHub GraphQL API</a> <a href="#fnref3" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn4" class="footnote-item"><p><a href="https://www.apollographql.com/blog/graphql/basics/graphql-vs-rest/">GraphQL vs. REST</a>. <a href="#fnref4" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn5" class="footnote-item"><p><a href="https://www.howtographql.com/basics/1-graphql-is-the-better-rest/">GraphQL is the better REST</a> <a href="#fnref5" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn6" class="footnote-item"><p><a href="https://www.prisma.io/blog/top-5-reasons-to-use-graphql-b60cfa683511">Reasons to use GraphQL | Top 5 Reasons Why and How to use GraphQL</a> <a href="#fnref6" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn7" class="footnote-item"><p><a href="https://www.cloudbees.com/blog/graphql-as-an-api-gateway-to-micro-services">GraphQL as an API Gateway to Microservices</a> <a href="#fnref7" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn8" class="footnote-item"><p><a href="https://www.infoq.com/news/2021/03/netflix-graphql-microservices/">Netflix Embraces GraphQL Microservices for Rapid Application Development</a> <a href="#fnref8" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn9" class="footnote-item"><p><a href="https://netflixtechblog.com/beyond-rest-1b76f7c20ef6">Beyond RESTâ€”â€”Rapid Development with GraphQL Microservices</a> <a href="#fnref9" class="footnote-backref">â†©ï¸</a></p>
</li>
</ol>
</section>
]]></content>
      <categories>
        <category>GraphQL</category>
      </categories>
      <tags>
        <tag>GraphQL</tag>
      </tags>
  </entry>
  <entry>
    <title>ä¸åŒåˆ†è¾¨ç‡è§†é¢‘çš„æ¨èç ç‡</title>
    <url>/2021/05/28/Recommended-video-bitrates-for-different-resolutions/</url>
    <content><![CDATA[<p>è§†é¢‘çš„æ¸…æ™°åº¦ä¼šå—åˆ°å¤šç§å› ç´ çš„å½±å“ï¼šåˆ†è¾¨ç‡ï¼Œå¸§ç‡ï¼Œè‰²æ·±â€¦â€¦å¯¹äºUGCç±»å‹çš„è§†é¢‘ä¸šåŠ¡è€Œè¨€ï¼Œä¸ºäº†ä¿è¯æ•´ç«™è§†é¢‘çš„è´¨é‡ï¼Œéœ€è¦å¯¹ç”¨æˆ·ä¸Šä¼ çš„è§†é¢‘è´¨é‡è¿›è¡Œä¸€ç‚¹çš„åˆ¤æ–­ã€‚è™½ç„¶ä¸æ˜¯ç»å¯¹å‡†ç¡®ï¼Œä½†æ˜¯ï¼Œç ç‡ä¹Ÿæ˜¯ä¸€ç§ç›¸å¯¹æœ‰æ•ˆçš„è¯„ä¼°æŒ‡æ ‡ã€‚<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup></p>
<p><img src="/2021/05/28/Recommended-video-bitrates-for-different-resolutions/1.png" alt></p>
<p>åœ¨YouTubeçš„å¸®åŠ©æ–‡æ¡£ä¸­ï¼Œå°±æä¾›äº†ä¸€ä»½å»ºè®®ç”¨äºæŒ‡å¯¼ç”¨æˆ·è®¾ç½®å…¶ä¸Šä¼ çš„è§†é¢‘çš„ç¼–ç å‚æ•°<sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup>ã€‚æœ¬æ–‡å¯¹ç ç‡çš„æ¨èæ•°æ®è¿›è¡Œäº†æ‘˜å½•ã€‚</p>
<span id="more"></span>
<h2 id="sdrè§†é¢‘çš„æ¨èç ç‡">SDRè§†é¢‘çš„æ¨èç ç‡</h2>
<table>
<thead>
<tr>
<th style="text-align:left">Type</th>
<th style="text-align:left">Video Bitrate <br> æ ‡å‡†å¸§ç‡(24, 25, 30) <br> ç¼–ç å™¨(H264)</th>
<th style="text-align:left">Video Bitrate <br> é«˜å¸§ç‡(48, 50, 60) <br> ç¼–ç å™¨(H264)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">2160p (4K)</td>
<td style="text-align:left">35â€“45 Mbps</td>
<td style="text-align:left">53â€“68 Mbps</td>
</tr>
<tr>
<td style="text-align:left">1440p (2K)</td>
<td style="text-align:left">16 Mbps</td>
<td style="text-align:left">24 Mbps</td>
</tr>
<tr>
<td style="text-align:left">1080p</td>
<td style="text-align:left">8 Mbps</td>
<td style="text-align:left">12 Mbps</td>
</tr>
<tr>
<td style="text-align:left">720p</td>
<td style="text-align:left">5 Mbps</td>
<td style="text-align:left">7.5 Mbps</td>
</tr>
<tr>
<td style="text-align:left">480p</td>
<td style="text-align:left">2.5 Mbps</td>
<td style="text-align:left">4 Mbps</td>
</tr>
<tr>
<td style="text-align:left">360p</td>
<td style="text-align:left">1 Mbps</td>
<td style="text-align:left">1.5 Mbps</td>
</tr>
</tbody>
</table>
<h2 id="hdrè§†é¢‘çš„æ¨èç ç‡">HDRè§†é¢‘çš„æ¨èç ç‡</h2>
<table>
<thead>
<tr>
<th style="text-align:left">Type</th>
<th style="text-align:left">Video Bitrate <br> æ ‡å‡†å¸§ç‡(24, 25, 30) <br> ç¼–ç å™¨(H264)</th>
<th style="text-align:left">Video Bitrate <br> é«˜å¸§ç‡(48, 50, 60) <br> ç¼–ç å™¨(H264)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">2160p (4K)</td>
<td style="text-align:left">44â€“56 Mbps</td>
<td style="text-align:left">66â€“85 Mbps</td>
</tr>
<tr>
<td style="text-align:left">1440p (2K)</td>
<td style="text-align:left">20 Mbps</td>
<td style="text-align:left">30 Mbps</td>
</tr>
<tr>
<td style="text-align:left">1080p</td>
<td style="text-align:left">10 Mbps</td>
<td style="text-align:left">15 Mbps</td>
</tr>
<tr>
<td style="text-align:left">720p</td>
<td style="text-align:left">6.5 Mbps</td>
<td style="text-align:left">9.5 Mbps</td>
</tr>
<tr>
<td style="text-align:left">480p</td>
<td style="text-align:left">Not supported</td>
<td style="text-align:left">Not supported</td>
</tr>
<tr>
<td style="text-align:left">360p</td>
<td style="text-align:left">Not supported</td>
<td style="text-align:left">Not supported</td>
</tr>
</tbody>
</table>
<h2 id="éŸ³é¢‘çš„æ¨èç ç‡">éŸ³é¢‘çš„æ¨èç ç‡</h2>
<table>
<thead>
<tr>
<th style="text-align:left">Type</th>
<th style="text-align:left">Audio Bitrate <br> é‡‡æ ·ç‡(96K/48K HZ) <br> ç¼–ç å™¨(AAC-LC)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Mono</td>
<td style="text-align:left">128 kbps</td>
</tr>
<tr>
<td style="text-align:left">Stereo</td>
<td style="text-align:left">384 kbps</td>
</tr>
<tr>
<td style="text-align:left">5.1</td>
<td style="text-align:left">512 kbps</td>
</tr>
</tbody>
</table>
<h2 id="å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</h2>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p><a href="https://www.muvi.com/blogs/video-bitrate-or-resolution-what-makes-video-streaming-better.html">https://www.muvi.com/blogs/video-bitrate-or-resolution-what-makes-video-streaming-better.html</a>. <a href="#fnref1" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn2" class="footnote-item"><p><a href="https://support.google.com/youtube/answer/1722171?hl=en&amp;ref_topic=9257782">https://support.google.com/youtube/answer/1722171?hl=en&amp;ref_topic=9257782</a>. <a href="#fnref2" class="footnote-backref">â†©ï¸</a></p>
</li>
</ol>
</section>
]]></content>
      <categories>
        <category>IVQA</category>
      </categories>
      <tags>
        <tag>ç ç‡</tag>
        <tag>è§†é¢‘æ¸…æ™°åº¦</tag>
      </tags>
  </entry>
  <entry>
    <title>github commit messagesä¸­çš„emojiä½¿ç”¨æŒ‡å—</title>
    <url>/2021/05/05/An-emoji-guide-for-github-commit-messages/</url>
    <content><![CDATA[<p><img src="/2021/05/05/An-emoji-guide-for-github-commit-messages/1.gif" alt></p>
<p>åœ¨git commit messagesä¸­ä½¿ç”¨emojiè¡¨æƒ…å¯ä»¥åŒ…å«å¾ˆå¤šæœ‰ç”¨ä¿¡æ¯ï¼Œå¹¶ä¸”èƒ½å¤Ÿæå‡commit messageçš„é˜…è¯»ä½“éªŒã€‚ä½†æ˜¯ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨commit messageä¸­ï¼Œemojiä¸èƒ½ä¹±ç”¨ï¼Œå¦åˆ™å®¹æ˜“å¯¼è‡´è¯¯è§£ã€‚ä¸ºäº†è§£é‡Šå¹¶æ ‡å‡†åŒ–commit messageä¸­çš„emojiï¼Œ<a href="https://gitmoji.dev/">Gitmojié¡¹ç›®</a>åº”è¿è€Œç”Ÿã€‚</p>
<p>æˆ‘ä»¬åœ¨commit messageä¸­ä½¿ç”¨emojiçš„æ—¶å€™ï¼Œä¹Ÿåº”è¯¥å°½é‡éµå¾ª<a href="(https://gitmoji.dev/)">Gitmoji</a>çš„è§„èŒƒï¼Œé¿å…å¼•èµ·ä¸å¿…è¦çš„è¯¯ä¼šã€‚</p>
<span id="more"></span>
<p>åœ¨commit messageä¸­ä½¿ç”¨emojiå¯ä½¿å¾—æˆ‘ä»¬èƒ½å¤Ÿä»…é€šè¿‡emojiå°±å¯ä»¥è½»æ¾ç¡®å®šæ­¤æ¬¡ä»£ç çš„æäº¤æ„å›¾ã€‚</p>
<p><a href="https://gitmoji.dev/">Gitmojié¡¹ç›®</a>ä¸­æè¿°çš„emojiçš„å«ä¹‰å¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚</p>
<table>
<thead>
<tr>
<th style="text-align:center">è¡¨æƒ…</th>
<th style="text-align:left">emoji</th>
<th style="text-align:left">è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">ğŸ¨</td>
<td style="text-align:left"><code>:art</code></td>
<td style="text-align:left">æ”¹è¿›ç»“æ„å’Œä»£ç æ ¼å¼</td>
</tr>
<tr>
<td style="text-align:center">âš¡ï¸</td>
<td style="text-align:left"><code>:zap:</code></td>
<td style="text-align:left">ä¼˜åŒ–æ€§èƒ½</td>
</tr>
<tr>
<td style="text-align:center">ğŸ”¥</td>
<td style="text-align:left"><code>:fire:</code></td>
<td style="text-align:left">ç§»é™¤ä»£ç æˆ–æ–‡ä»¶</td>
</tr>
<tr>
<td style="text-align:center">ğŸ›</td>
<td style="text-align:left"><code>:bug:</code></td>
<td style="text-align:left">ä¿®å¤ bug</td>
</tr>
<tr>
<td style="text-align:center">ğŸš‘</td>
<td style="text-align:left"><code>:ambulance:</code></td>
<td style="text-align:left">å…³é”®ä¿®è¡¥ç¨‹åº</td>
</tr>
<tr>
<td style="text-align:center">âœ¨</td>
<td style="text-align:left"><code>:sparkles:</code></td>
<td style="text-align:left">å¼•å…¥æ–°åŠŸèƒ½</td>
</tr>
<tr>
<td style="text-align:center">ğŸ“</td>
<td style="text-align:left"><code>:memo:</code></td>
<td style="text-align:left">å¢åŠ æˆ–è€…å‡çº§æ–‡æ¡£</td>
</tr>
<tr>
<td style="text-align:center">ğŸš€</td>
<td style="text-align:left"><code>:rocket:</code></td>
<td style="text-align:left">éƒ¨ç½²æ–°åŠŸèƒ½</td>
</tr>
<tr>
<td style="text-align:center">ğŸ’„</td>
<td style="text-align:left"><code>:lipstick:</code></td>
<td style="text-align:left">å‡çº§ UI å’Œæ ·å¼æ–‡ä»¶</td>
</tr>
<tr>
<td style="text-align:center">ğŸ‰</td>
<td style="text-align:left"><code>:tada</code></td>
<td style="text-align:left">åˆæ¬¡æäº¤</td>
</tr>
<tr>
<td style="text-align:center">âœ…</td>
<td style="text-align:left"><code>:white_check_mark:</code></td>
<td style="text-align:left">å¢åŠ æˆ–å‡çº§æµ‹è¯•ç”¨ä¾‹</td>
</tr>
<tr>
<td style="text-align:center">ğŸ”’</td>
<td style="text-align:left"><code>:lock:</code></td>
<td style="text-align:left">ä¿®å¤å®‰å…¨é—®é¢˜</td>
</tr>
<tr>
<td style="text-align:center">ğŸ”–</td>
<td style="text-align:left"><code>:bookmark:</code></td>
<td style="text-align:left">å‘ç‰ˆ/ç‰ˆæœ¬tags</td>
</tr>
<tr>
<td style="text-align:center">ğŸš¨</td>
<td style="text-align:left"><code>:rotating_light:</code></td>
<td style="text-align:left">ä¿®å¤ç¼–è¯‘è­¦å‘Šæˆ–è€…linterè­¦å‘Š</td>
</tr>
<tr>
<td style="text-align:center">ğŸš§</td>
<td style="text-align:left"><code>:construction:</code></td>
<td style="text-align:left">å·¥ä½œåœ¨è¿›è¡Œä¸­</td>
</tr>
<tr>
<td style="text-align:center">ğŸ’š</td>
<td style="text-align:left"><code>:green_heart:</code></td>
<td style="text-align:left">ä¿®å¤ CI æ„å»ºé—®é¢˜</td>
</tr>
<tr>
<td style="text-align:center">â¬‡ï¸</td>
<td style="text-align:left"><code>:arrow_down:</code></td>
<td style="text-align:left">é™çº§ä¾èµ–åº“</td>
</tr>
<tr>
<td style="text-align:center">â¬†ï¸</td>
<td style="text-align:left"><code>:arrow_up:</code></td>
<td style="text-align:left">å‡çº§ä¾èµ–åº“</td>
</tr>
<tr>
<td style="text-align:center">ğŸ“Œ</td>
<td style="text-align:left"><code>:pushpin:</code></td>
<td style="text-align:left">Pin dependencies to specific versions.</td>
</tr>
<tr>
<td style="text-align:center">ğŸ‘·</td>
<td style="text-align:left"><code>:construction_worker:</code></td>
<td style="text-align:left">å¢åŠ æˆ–è€…å‡çº§CIæ„å»ºç³»ç»Ÿ</td>
</tr>
<tr>
<td style="text-align:center">ğŸ“ˆ</td>
<td style="text-align:left"><code>:chart_with_upwards_trend:</code></td>
<td style="text-align:left">å¢åŠ æˆ–å‡çº§åˆ†æä»£ç /è·Ÿè¸ªä»£ç </td>
</tr>
<tr>
<td style="text-align:center">â™»ï¸</td>
<td style="text-align:left"><code>:recycle:</code></td>
<td style="text-align:left">é‡æ„ä»£ç </td>
</tr>
<tr>
<td style="text-align:center">â•</td>
<td style="text-align:left"><code>:heavy_plus_sign:</code></td>
<td style="text-align:left">å¢åŠ ä¾èµ–é¡¹</td>
</tr>
<tr>
<td style="text-align:center">â–</td>
<td style="text-align:left"><code>:heavy_minus_sign:</code></td>
<td style="text-align:left">åˆ é™¤ä¾èµ–é¡¹</td>
</tr>
<tr>
<td style="text-align:center">ğŸ”§</td>
<td style="text-align:left"><code>:wrench:</code></td>
<td style="text-align:left">å¢åŠ æˆ–å‡çº§é…ç½®æ–‡ä»¶</td>
</tr>
<tr>
<td style="text-align:center">ğŸ”¨</td>
<td style="text-align:left"><code>:hammer:</code></td>
<td style="text-align:left">å¢åŠ æˆ–æ›´æ–°è„šæœ¬</td>
</tr>
<tr>
<td style="text-align:center">ğŸŒ</td>
<td style="text-align:left"><code>:globe_with_meridians:</code></td>
<td style="text-align:left">å›½é™…åŒ–å’Œæœ¬åœ°åŒ–</td>
</tr>
<tr>
<td style="text-align:center">âœï¸</td>
<td style="text-align:left"><code>:pencil2:</code></td>
<td style="text-align:left">ä¿®å¤é”™åˆ«å­—</td>
</tr>
<tr>
<td style="text-align:center">ğŸ’©</td>
<td style="text-align:left"><code>:poop:</code></td>
<td style="text-align:left">ç¼–å†™äº†éœ€è¦æ”¹è¿›çš„é”™è¯¯ä»£ç </td>
</tr>
<tr>
<td style="text-align:center">âª</td>
<td style="text-align:left"><code>:rewind:</code></td>
<td style="text-align:left">è¿˜åŸå˜æ›´</td>
</tr>
<tr>
<td style="text-align:center">ğŸ”€</td>
<td style="text-align:left"><code>:twisted_rightwards_arrows:</code></td>
<td style="text-align:left">åˆå¹¶åˆ†æ”¯</td>
</tr>
<tr>
<td style="text-align:center">ğŸ“¦</td>
<td style="text-align:left"><code>:package:</code></td>
<td style="text-align:left">å¢åŠ æˆ–æ›´æ–°å·²ç»ç¼–è¯‘çš„æ–‡ä»¶æˆ–package</td>
</tr>
<tr>
<td style="text-align:center">ğŸ‘½</td>
<td style="text-align:left"><code>:alien:</code></td>
<td style="text-align:left">å› ä¸ºå¤–éƒ¨APIçš„æ›´æ”¹è€Œæ›´æ–°ä»£ç </td>
</tr>
<tr>
<td style="text-align:center">ğŸšš</td>
<td style="text-align:left"><code>:truck:</code></td>
<td style="text-align:left">ç§»åŠ¨æˆ–è€…é‡å‘½åèµ„æº(ä¾‹å¦‚ï¼šfiles, paths, routes)</td>
</tr>
<tr>
<td style="text-align:center">ğŸ“„</td>
<td style="text-align:left"><code>:page_facing_up:</code></td>
<td style="text-align:left">å¢åŠ æˆ–æ›´æ–°è®¸å¯æ–‡ä»¶ï¼ˆlicenseï¼‰</td>
</tr>
<tr>
<td style="text-align:center">ğŸ’¥</td>
<td style="text-align:left"><code>:boom:</code></td>
<td style="text-align:left">å¼•å…¥äº†ç ´åæ€§ä¿®æ”¹</td>
</tr>
<tr>
<td style="text-align:center">ğŸ±</td>
<td style="text-align:left"><code>:bento:</code></td>
<td style="text-align:left">å¢åŠ æˆ–æ›´æ–°assets</td>
</tr>
<tr>
<td style="text-align:center">â™¿ï¸</td>
<td style="text-align:left"><code>:wheelchair:</code></td>
<td style="text-align:left">Improve accessibility</td>
</tr>
<tr>
<td style="text-align:center">ğŸ’¡</td>
<td style="text-align:left"><code>:bulb:</code></td>
<td style="text-align:left">åœ¨æºä»£ç ä¸­å¢åŠ æˆ–æ›´æ–°æ³¨é‡Š</td>
</tr>
<tr>
<td style="text-align:center">ğŸ»</td>
<td style="text-align:left"><code>:beers:</code></td>
<td style="text-align:left">Write code drunkenly</td>
</tr>
<tr>
<td style="text-align:center">ğŸ’¬</td>
<td style="text-align:left"><code>:speech_balloon:</code></td>
<td style="text-align:left">Add or update text and literals</td>
</tr>
<tr>
<td style="text-align:center">ğŸ—ƒ</td>
<td style="text-align:left"><code>:card_file_box:</code></td>
<td style="text-align:left">æ‰§è¡Œä¸æ•°æ®åº“ç›¸å…³çš„æ›´æ”¹</td>
</tr>
<tr>
<td style="text-align:center">ğŸ”Š</td>
<td style="text-align:left"><code>:loud_sound:</code></td>
<td style="text-align:left">å¢åŠ æˆ–å‡çº§æ—¥å¿—</td>
</tr>
<tr>
<td style="text-align:center">ğŸ”‡</td>
<td style="text-align:left"><code>:mute:</code></td>
<td style="text-align:left">åˆ é™¤æ—¥å¿—</td>
</tr>
<tr>
<td style="text-align:center">ğŸ‘¥</td>
<td style="text-align:left"><code>:busts_in_silhouette:</code></td>
<td style="text-align:left">Add or update contributor(s).</td>
</tr>
<tr>
<td style="text-align:center">ğŸš¸</td>
<td style="text-align:left"><code>:children_crossing:</code></td>
<td style="text-align:left">æ”¹å–„ç”¨æˆ·ä½“éªŒ/å¯ç”¨æ€§ã€‚</td>
</tr>
<tr>
<td style="text-align:center">ğŸ—</td>
<td style="text-align:left"><code>:building_construction:</code></td>
<td style="text-align:left">è¿›è¡Œæ¶æ„ä¸Šçš„ä¿®æ”¹</td>
</tr>
<tr>
<td style="text-align:center">ğŸ“±</td>
<td style="text-align:left"><code>:iphone:</code></td>
<td style="text-align:left">è¿›è¡Œå“åº”å¼è®¾è®¡</td>
</tr>
<tr>
<td style="text-align:center">ğŸ¤¡</td>
<td style="text-align:left"><code>:clown_face:</code></td>
<td style="text-align:left">Mock things</td>
</tr>
<tr>
<td style="text-align:center">ğŸ¥š</td>
<td style="text-align:left"><code>:egg:</code></td>
<td style="text-align:left">å¢åŠ æˆ–æ›´æ–°èœå•</td>
</tr>
<tr>
<td style="text-align:center">ğŸ™ˆ</td>
<td style="text-align:left"><code>:see_no_evil:</code></td>
<td style="text-align:left">å¢åŠ æˆ–æ›´æ–°.gitignoreæ–‡ä»¶</td>
</tr>
<tr>
<td style="text-align:center">ğŸ“¸</td>
<td style="text-align:left"><code>:camera_flash:</code></td>
<td style="text-align:left">æ·»åŠ æˆ–æ›´æ–°å¿«ç…§</td>
</tr>
<tr>
<td style="text-align:center">âš—ï¸</td>
<td style="text-align:left"><code>:alembic:</code></td>
<td style="text-align:left">Perform experiments</td>
</tr>
<tr>
<td style="text-align:center">ğŸ”</td>
<td style="text-align:left"><code>:mag:</code></td>
<td style="text-align:left">æ”¹å–„SEO</td>
</tr>
<tr>
<td style="text-align:center">ğŸ·</td>
<td style="text-align:left"><code>:label:</code></td>
<td style="text-align:left">å¢åŠ æˆ–æ›´æ–°ç±»å‹ï¼ˆtypesï¼‰</td>
</tr>
<tr>
<td style="text-align:center">ğŸŒ±</td>
<td style="text-align:left"><code>:seedling:</code></td>
<td style="text-align:left">å¢åŠ æˆ–æ›´æ–°seed files</td>
</tr>
<tr>
<td style="text-align:center">ğŸš©</td>
<td style="text-align:left"><code>:triangular_flag_on_post:</code></td>
<td style="text-align:left">Add, update, or remove feature flags</td>
</tr>
<tr>
<td style="text-align:center">ğŸ¥…</td>
<td style="text-align:left"><code>:goal_net:</code></td>
<td style="text-align:left">Catch errors</td>
</tr>
<tr>
<td style="text-align:center">ğŸ’«</td>
<td style="text-align:left"><code>:dizzy:</code></td>
<td style="text-align:left">Add or update animations and transitions</td>
</tr>
<tr>
<td style="text-align:center">ğŸ—‘</td>
<td style="text-align:left"><code>:wastebasket:</code></td>
<td style="text-align:left">Deprecate code that needs to be cleaned up</td>
</tr>
<tr>
<td style="text-align:center">ğŸ›‚</td>
<td style="text-align:left"><code>:passport_control:</code></td>
<td style="text-align:left">å¤„ç†ä¸æˆæƒã€è§’è‰²å’Œæƒé™ç›¸å…³çš„ä»£ç </td>
</tr>
<tr>
<td style="text-align:center">âš°ï¸</td>
<td style="text-align:left"><code>:coffin:</code></td>
<td style="text-align:left">åˆ é™¤æ— æ•ˆä»£ç </td>
</tr>
</tbody>
</table>
]]></content>
      <categories>
        <category>git</category>
      </categories>
      <tags>
        <tag>emoji</tag>
        <tag>commit message</tag>
      </tags>
  </entry>
  <entry>
    <title>å¦‚ä½•æå‡å·¥ä½œæ•ˆç‡</title>
    <url>/2021/05/01/how-to-improve-the-work-efficiency/</url>
    <content><![CDATA[<p><img src="/2021/05/01/how-to-improve-the-work-efficiency/0.jpeg" alt></p>
<blockquote>
<div align="right"> å›å­æ€§éå¼‚ä¹Ÿï¼Œå–„å‡äºç‰©ä¹Ÿã€‚</div>
</blockquote>
<p>å‰å‡ å¤©ï¼Œåœ¨ä¸€æ¬¡ä¼šè®®ä¸Šï¼Œæœ‰åŒå­¦é—®æˆ‘ï¼š<em>å¦‚ä½•æ‰èƒ½æå‡å·¥ä½œæ•ˆç‡ï¼Ÿ</em> å’Œä»¥å¾€çš„ç­”ç–‘ç¯èŠ‚ä¸åŒï¼Œæˆ‘è¿™æ¬¡æ²¡æœ‰ç»™å‡ºæ˜ç¡®çš„ã€é©¬ä¸Šå¯è¡Œçš„æ–¹æ³•ï¼Œç›¸åï¼Œæˆ‘ä»…ä»…æ˜¯ç»™å‡ºäº†è‡ªå·±å¯¹â€œ<em>å¦‚ä½•æå‡å·¥ä½œæ•ˆç‡</em>â€çš„æ€è€ƒã€‚</p>
<p>é‰´äºæ—¶é—´çš„å…³ç³»ï¼Œå½“æ—¶æ²¡æœ‰å±•å¼€æ¥è®²ï¼Œå¯¹å½“æ—¶çš„å†…å®¹è¿›è¡Œäº†æ¢³ç†ã€ä¸°å¯Œå’Œæ‰©å±•ï¼Œå°±å½¢æˆäº†è¿™ç¯‡æ–‡ç« ã€‚</p>
<span id="more"></span>
<h2 id="æ—¥å…‰ä¹‹ä¸‹-å¹¶æ— æ–°äº‹">æ—¥å…‰ä¹‹ä¸‹ï¼Œå¹¶æ— æ–°äº‹</h2>
<blockquote>
<p>å·²æœ‰çš„äº‹ï¼Œåå¿…å†æœ‰ï¼›å·²è¡Œçš„äº‹ï¼Œåå¿…å†è¡Œã€‚æ—¥å…‰ä¹‹ä¸‹ï¼Œå¹¶æ— æ–°äº‹ã€‚</p>
<div align="right">ã€Šåœ£ç»Â·ä¼ é“ä¹¦ã€‹1:9</div>
</blockquote>
<p>å•çº¯å°±å·¥ä½œæ•ˆç‡æå‡è¿™ä»¶äº‹è€Œè¨€ï¼Œç¡®å®ä¹Ÿå¹¶ä¸æ˜¯ä¸€ä»¶æ–°é²œçš„äº‹æƒ…ã€‚æœ‰å¤ªå¤šçš„ä¹¦ç±åœ¨è§£ç­”è¿™ä¸ªé—®é¢˜ï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li>é«˜æ•ˆèƒ½äººå£«çš„ä¸ƒä¸ªä¹ æƒ¯</li>
<li>å“æœ‰æˆæ•ˆçš„ç®¡ç†è€…</li>
<li>ç•ªèŒ„å·¥ä½œæ³•å›¾è§£</li>
<li>â€¦â€¦</li>
</ul>
<p>æˆ‘ä»¬ä¹Ÿç¡®å®å¯ä»¥é€šè¿‡å®è·µè¿™äº›ä¹¦ç±ä¸­çš„å…·ä½“æ–¹æ³•æ¥æå‡è‡ªå·±çš„å·¥ä½œæ•ˆç‡ã€‚ä½†æ˜¯ï¼Œå½“æˆ‘ä»¬æ¥ä¸‹æ¥ç»§ç»­æ€è€ƒå¦‚ä¸‹çš„é—®é¢˜æ—¶ï¼Œæˆ‘ä»¬åˆå°†å¦‚ä½•å±•å¼€å‘¢ï¼š</p>
<ul>
<li>æˆ‘ä»¬å¦‚ä½•è¿›ä¸€æ­¥æå‡å·¥ä½œæ•ˆç‡ï¼Ÿ</li>
<li>æå‡æ•ˆç‡çš„å¤§æ–¹å‘æ˜¯ä»€ä¹ˆï¼Ÿ</li>
</ul>
<p><a href="https://book.douban.com/author/1323905/">å¤§å«Â·å…‹é‡Œæ–¯è’‚å®‰</a> çš„â€œå¤§å†å²â€ç†è®ºæŒ‡å‡ºï¼šå¯ä»¥ä¾æ®æ•´ä¸ªäººç±»çš„å‘å±•å†å²å¯¹æœªæ¥å³å°†å‘ç”Ÿçš„ä¸€åˆ‡åšå‡ºåˆç†çš„åˆ¤æ–­ï¼Œç”¨é•¿è¿œçš„ã€æ¯”è¾ƒçš„æ€ç»´æ¥çœ‹å¾…é—®é¢˜ã€‚</p>
<p>äººç±»æ”¹é€ è‡ªç„¶çš„ç¤¾ä¼šæ´»åŠ¨å·²ç»è¿›è¡Œäº†å‡ åƒå¹´ï¼ŒåŒæ—¶æˆ‘ä»¬çš„å·¥ä½œä¹Ÿæ˜¯ä¸€ç§äººç±»æ”¹é€ è‡ªç„¶çš„æ´»åŠ¨ï¼Œå› æ­¤æˆ‘ä»¬ä¹Ÿå¯ä»¥è¿ç”¨â€œå¤§å†å²â€ç†è®ºæ¥æ€è€ƒ<em>å¦‚ä½•æå‡å·¥ä½œæ•ˆç‡</em>è¿™ä¸€é—®é¢˜ï¼Ÿ</p>
<h2 id="å¤§å†å²ç†è®º">å¤§å†å²ç†è®º</h2>
<p>å…³äºå¤§å†å²ç†è®ºçš„å…·ä½“å†…å®¹ï¼Œå¯ä»¥å‚è€ƒå¤§å«Â·å…‹é‡Œæ–¯è’‚å®‰çš„è‘—ä½œ <a href="https://item.jd.com/44600326697.html">ã€Šèµ·æº-ä¸‡ç‰©å¤§å†å²ã€‹</a>ã€‚</p>
<div class="douban-card-block">
	<a class="douban-card" href="https://book.douban.com/subject/30428815">
		<div class="douban-card-bgimg" style="background-image: url('https://images.weserv.nl/?url=https://img2.doubanio.com/view/subject/s/public/s32278451.jpg');"></div>
		<div class="douban-card-left">
			<div class="douban-card-img" style="background-image: url('https://images.weserv.nl/?url=https://img2.doubanio.com/view/subject/s/public/s32278451.jpg');"></div>
		</div>
		<div class="douban-card-right" style="line-height: 1.7;">
			<div class="douban-card-item"><span>ä¹¦å: </span><strong>èµ·æº</strong></div>
			<div class="douban-card-item"><span>ä½œè€…: </span><span>[ç¾]å¤§å«Â·å…‹é‡Œæ–¯è’‚å®‰</span></div>
			<div class="douban-card-item"><span>å‡ºç‰ˆå¹´ä»½: </span><span>2019-4-10</span></div>
			<div class="douban-card-item"><span>è¯„åˆ†: </span><span>8.0</span></div>
		</div>
	</a>
</div>
<style>
	.douban-card-block {
		display: flex;
		justify-content: center;
		align-items: center;
		width: 100%;
		max-height: 400px;
	}
	.douban-card {
		display: flex;
		margin: 30px 10px;
		padding: 15px;
		border-radius: 10px;
		position: relative;
		justify-content: center;
		align-items: center;
		overflow: hidden;
		color: antiquewhite;
		text-decoration: none;
	}
	.douban-card:hover {
		text-decoration: none;
	}
	.douban-card-bgimg {
		position: absolute;
		width: 115%;
		height: 115%;
		filter: blur(15px) brightness(0.6);
		background-size: 100%;
		background-position: center;
		background-repeat: no-repeat;
	}
	.douban-card-img {
		position: relative;
		height: 130px;
		width: 80px;
		background-size: 100%;
		background-position: center;
		background-repeat: no-repeat;
	}
	.douban-card-img {
		position: relative;
		height: 130px;
		width: 80px;
	}
	.douban-card-left {
		position: relative;
		display: flex;
		flex-direction: column;
		align-items: center;
	}
	.douban-card-right {
		position: relative;
		display: flex;
		flex-direction: column;
		margin-left: 12px;
		font-size: 16px;
		font-family: 'Courier New', Courier, monospace;
		line-height: 1.3;
		color: antiquewhite;
	}
	.douban-card-item {
		margin-top: 4px;
	}
</style>
<blockquote>
<p>å¤§å†å²å¯ä»¥ä¸ºæˆ‘ä»¬ç†è§£è‡ªå®‡å®™å¤§çˆ†ç‚¸è‡³ä»Šçš„ä¸€åˆ‡å†å²æä¾›æ¡†æ¶ã€‚</p>
<p>é€šå¸¸ï¼Œåœ¨å­¦æ ¡é‡Œï¼Œç§‘å­¦å’Œå†å²æ˜¯åˆ†å¼€æ•™æˆçš„ï¼Œæœ‰ä¸“é—¨çš„ç‰©ç†è¯¾ï¼Œä¹Ÿæœ‰ä¸“é—¨çš„è®²è¿°æ–‡æ˜èµ·æºçš„è¯¾ç¨‹ã€‚</p>
<p>ä½†æ˜¯ï¼Œå¤§å†å²æ‰“ç ´äº†è¿™ä¸€ç•Œé™ã€‚</p>
<p>æ¯å½“æˆ‘å­¦åˆ°æ–°çŸ¥è¯†ï¼Œä¸è®ºæ˜¯ç”Ÿç‰©å­¦ã€å†å²å­¦ï¼Œè¿˜æ˜¯å…¶ä»–ä»»ä½•ä¸€é—¨å­¦ç§‘ï¼Œæˆ‘æ€»æ˜¯ä¼šåŠªåŠ›å°†å®ƒæ”¾ç½®åœ¨å¤§å†å²çš„æ¡†æ¶ä¸­ã€‚</p>
<p>å†ä¹Ÿæ²¡æœ‰å…¶ä»–å…¶ä»–è¯¾ç¨‹ä¼šå¯¹æˆ‘çœ‹å¾…ä¸–ç•Œçš„æ–¹å¼äº§ç”Ÿå¦‚æ­¤ä¹‹å¤§çš„å½±å“ã€‚</p>
<div align="right">â€”â€”æ¯”å°”Â·ç›–èŒ¨</div>
</blockquote>
<p>åœ¨æ¼«é•¿çš„å†å²é•¿æ²³ä¸­ï¼Œäººç±»å…±ç»å†äº†ï¼šæ—§çŸ³å™¨æ—¶ä»£ã€æ–°çŸ³å™¨æ—¶ä»£ã€é’é“œå™¨æ—¶ä»£ã€é“å™¨æ—¶ä»£ã€è’¸æ±½æœºæ—¶ä»£ã€ç”µåŠ›æ—¶ä»£ï¼Œç„¶ååˆ°è¾¾äº†ç›®å‰çš„ä¿¡æ¯æ—¶ä»£ã€‚</p>
<p>å›é¡¾å†å²çš„é•¿æ²³ï¼Œæˆ‘ä»¬å‘ç°ï¼Œäººç±»çš„å‘å±•ä¹Ÿæ˜¯å·¥å…·è¿›åŒ–çš„å†ç¨‹ã€‚æ¯ä¸€æ¬¡å·¥å…·çš„å‡çº§æ¢ä»£ï¼Œéƒ½å½±å“ç€äººç±»ç¤¾ä¼šçš„å‘å±•æ–¹å‘å’Œäººä»¬çš„ç”Ÿæ´»æ–¹å¼ã€‚å„è¡Œå„ä¸šåœ¨æ¯ä¸€æ¬¡å·¥å…·å±‚çº§æå‡åå‘ç”Ÿç€å·¨å¤§çš„å˜åŒ–ï¼Œäººç±»ç”Ÿæ´»çš„èˆ’é€‚ç¨‹åº¦ä¹Ÿéšç€å·¥å…·å±‚çº§çš„ä¸æ–­æå‡è€Œæ”¹å–„ã€‚</p>
<p>å½“å¹´ï¼Œå”ç„å®—ä¸ºäº†åšå¾—ç¾äººä¸€ç¬‘ï¼Œåƒé‡Œå¿«éª‘é€è”æï¼Œæ‰æœ‰äº†â€œ<em>ä¸€éª‘çº¢å°˜å¦ƒå­ç¬‘ï¼Œæ— äººçŸ¥æ˜¯è”ææ¥</em>â€çš„å…¸æ•…ã€‚ç„¶è€Œï¼Œç°åœ¨ï¼Œåœ¨äº¤é€šå·¥å…·ï¼Œç‰©æµæŠ€æœ¯ç­‰é«˜é€Ÿå‘è¾¾çš„ä»Šå¤©ï¼Œåƒä¸Šæ–°é²œçš„è”æå·²ç»ä¸æ˜¯ä»€ä¹ˆéš¾äº‹äº†ã€‚</p>
<p><img src="/2021/05/01/how-to-improve-the-work-efficiency/1.jpeg" alt></p>
<blockquote>
<div align="right"> ä¸€éª‘çº¢å°˜å¦ƒå­ç¬‘ï¼Œæ— äººçŸ¥æ˜¯è”ææ¥ã€‚</div>
</blockquote>
<p>å› æ­¤ï¼Œä»å¤§å†å²ç†è®ºæ–¹é¢æ¥çœ‹ï¼Œæˆ‘è®¤ä¸ºï¼Œæå‡å·¥ä½œæ•ˆç‡çš„æœ¬è´¨æ˜¯â€œ<strong>æå‡å·¥ä½œä¸­æ‰€ä½¿ç”¨çš„å·¥å…·çš„å±‚çº§</strong>â€ã€‚è¿™é‡Œæˆ‘è¯´çš„â€œå·¥å…·â€æ³›æŒ‡æˆ‘ä»¬å·¥ä½œä¸­ä½¿ç”¨çš„å„ç±»æŠ€æœ¯ã€å¹³å°ã€å·¥å…·ã€è„šæœ¬â€¦â€¦</p>
<h2 id="æå‡å·¥å…·çš„å±‚çº§">æå‡å·¥å…·çš„å±‚çº§</h2>
<p>ä»å†å²çš„è¿›ç¨‹çœ‹ï¼Œå·¥å…·çš„æ°´å¹³ååº”ç”Ÿäº§åŠ›æ°´å¹³ï¼Œæ˜¯ç”Ÿäº§åŠ›æ°´å¹³çš„é‡è¦æ ‡å¿—ã€‚å› æ­¤è¦ä»æ ¹æœ¬ä¸Šæå‡å·¥ä½œæ•ˆç‡ï¼Œé¦–è¦çš„è¿˜æ˜¯è¦<strong>æå‡å·¥ä½œä¸­æ‰€ä½¿ç”¨çš„å·¥å…·çš„å±‚çº§</strong>ã€‚</p>
<p>å·¥å…·å±‚çº§ä¸ä½†å½±å“æˆ‘ä»¬çš„å·¥ä½œæ•ˆç‡ï¼Œæœ‰æ—¶å€™ç”šè‡³ä¼šå†³å®šæˆ‘ä»¬æ˜¯å¦å¯ä»¥å®ŒæˆæŸé¡¹å·¥ä½œã€‚æ­£æ‰€è°“ï¼šæ²¡æœ‰é‡‘åˆšé’»ï¼Œæ‹¦ä¸äº†ç“·å™¨æ´»ï¼Œè¯´çš„å°±æ˜¯è¿™ä¸ªé“ç†ã€‚</p>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœç°åœ¨è®©æˆ‘ä»¬ç”¨å¦‚ä¸‹å›¾æ‰€ç¤ºçš„â€œæ‰“å­”å¡â€<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup>æ¥ç¼–å†™ç¨‹åºï¼Œæˆ‘ä»¬å¤šé•¿æ—¶é—´èƒ½å†™å‡ºä¸€ä¸ªå¯ä»¥è¾“å‡º <code>hello world</code> çš„ç¨‹åºå‘¢ï¼Ÿè€Œç°åœ¨ï¼Œå€ŸåŠ©æ›´å¯Œæœ‰è¡¨ç°æ€§çš„è¯­è¨€å’Œæ›´é«˜çº§çš„å·¥å…·ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å‡ ç§’å†…å°±å®ç°è¿™ä¸ªåŠŸèƒ½ï¼Œä¸æ˜¯å—ï¼Ÿ</p>
<p><img src="/2021/05/01/how-to-improve-the-work-efficiency/2.jpeg" alt></p>
<h2 id="å·¥å…·ä¸å…·ä½“åœºæ™¯ç›¸ç»“åˆ">å·¥å…·ä¸å…·ä½“åœºæ™¯ç›¸ç»“åˆ</h2>
<blockquote>
<p>å¦‚æˆ‘è§£ä½›æ‰€è¯´ä¹‰ï¼Œæ— æœ‰å®šæ³•ï¼Œåé˜¿è€¨å¤šç½—ä¸‰è—ä¸‰è©æï¼›äº¦æ— æœ‰å®šæ³•ï¼Œå¦‚æ¥å¯è¯´ã€‚</p>
<div align="right">â€”â€”ã€Šé‡‘åˆšç»ã€‹</div>
</blockquote>
<p>æ³•æ— å®šæ³•ï¼Œä¸€åˆ‡äº‹ç‰©éƒ½ä¾èµ–äºä¸€å®šçš„å› ç¼˜æˆ–æ¡ä»¶æ‰èƒ½å­˜åœ¨ï¼Œæœ¬èº«æ²¡æœ‰ä»»ä½•è´¨çš„è§„å®šæ€§ã€‚ç”±æ­¤è§‚ä¹‹ï¼Œä¸€åˆ‡çš„æŠ€æœ¯å’Œå·¥å…·ï¼Œéƒ½éœ€è¦ä¾èµ–ä¸€å®šçš„åœºæ™¯æ‰èƒ½å­˜åœ¨ï¼Œè„±ç¦»åœºæ™¯çš„æŠ€æœ¯å’Œå·¥å…·ä¹Ÿä¸èƒ½å‘æŒ¥åº”æœ‰çš„ä½œç”¨ã€‚åŒæ—¶ï¼Œæ³•æ— å®šæ³•è¿˜æé†’æˆ‘ä»¬ï¼šè‡ªå·±çš„è§‰æ‚Ÿæ— æ³•ç§»æ¤ç»™åˆ«äººï¼Œè§‰æ‚Ÿéœ€è¦è¦é è‡ªè¯ã€è‡ªä¿®ã€è‡ªè§‚æ¥ä½“éªŒã€‚</p>
<p><img src="/2021/05/01/how-to-improve-the-work-efficiency/3.jpg" alt></p>
<p>åœ¨å·¥ä½œä¸­ï¼Œç»å¸¸ä¼šé‡åˆ°è„±ç¦»å…·ä½“åœºæ™¯è€Œæ‰§ç€äºå¼•å…¥æœ€é«˜å±‚çº§çš„å·¥å…·çš„æƒ…å†µï¼Œæˆ‘ç§°è¿™ç§è¡Œä¸ºä¸ºï¼š<strong>æƒŸå·¥å…·è®º</strong>ã€‚</p>
<p>åœ¨ã€ŠMonolith to Microservicesã€‹ä¸€ä¹¦çš„ç¬¬ <a href="/monolith-to-microservices/docs/Understanding_the_Goal.html">2.1èŠ‚</a> ä¸­ï¼Œä½œè€…æåˆ°ï¼š<em>ä¸äº†è§£ç›®æ ‡è¿˜ä¼šè®©æˆ‘ä»¬é¢ä¸´é™·å…¥è´§ç‰©å´‡æ‹œçš„é£é™©ï¼Œæ­¤æ—¶æˆ‘ä»¬å°±ä¼šå‡è®¾ï¼šâ€œå¦‚æœå¾®æœåŠ¡å¯¹ Netflix æœ‰å¥½å¤„ï¼Œé‚£ä¹ˆå¾®æœåŠ¡å¯¹æˆ‘ä»¬ä¹Ÿæœ‰å¥½å¤„ï¼â€</em></p>
<p>ä»¥å‡ºè¡Œæ•ˆç‡ä¸ºä¾‹ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ±½è½¦çš„å‡ºè¡Œæ•ˆç‡æ¯”è‡ªè¡Œè½¦è¦é«˜ã€‚ä½†æ˜¯å¯¹äºæ—©é«˜å³°å µè½¦æ—¶çš„çŸ­ç¨‹è¡Œç¨‹è€Œè¨€ï¼Œè‡ªè¡Œè½¦çš„æ•ˆç‡è¦è¿œè¿œé«˜äºæ±½è½¦ã€‚</p>
<p>å†ä»¥ä»£ç ç‰ˆæœ¬ç®¡ç†ç³»ç»Ÿè€Œè¨€ï¼Œç›®å‰ Git å·²ç»æˆä¸ºç›®å‰æœ€æµè¡Œçš„ä»£ç ç‰ˆæœ¬ç®¡ç†å·¥å…·ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬æ˜¯å¦æœ‰æ€è€ƒè¿‡ï¼š</p>
<ul>
<li>Git æ˜¯å¦é€‚ç”¨äºæˆ‘ä»¬ï¼Ÿ</li>
<li>å¦‚æœè®©æˆ‘ä»¬ä¸ºå…¬å¸é€‰æ‹©ä¸€æ¬¾ SCMï¼ˆSource Code Managementï¼‰ å·¥å…·ï¼Œæˆ‘ä»¬ä¼šå¦‚ä½•é€‰æ‹©ï¼Ÿæˆ‘ä»¬ä¼šé€‰æ‹© Git å—ï¼Ÿ</li>
</ul>
<p>ä» <a href="https://zhuanlan.zhihu.com/p/368422885">Google å’Œ Facebook ä¸ºä»€ä¹ˆä¸ç”¨ git ç®¡ç†æºç ï¼Ÿ</a> è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿèƒ½å‘ç°ï¼Œè™½ç„¶ Git éå¸¸ä¼˜ç§€ï¼Œä½†æ˜¯åœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œ Git è¿˜æ˜¯æœ‰å…¶å›ºæœ‰çš„é—®é¢˜ã€‚ä»æˆ‘çš„ä½¿ç”¨ç»éªŒè€Œè¨€ï¼Œ Git æ— æ³•åª <code>pull</code> ä»£ç åº“çš„å…¶ä¸­éƒ¨åˆ† path ç‰¹æ€§ç»å¸¸è®©æˆ‘å¿ƒæœ‰çƒ¦æ¼ï¼Œè€Œ Subversion å°±å¯ä»¥å¾ˆå¥½çš„è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å¦‚æœæˆ‘ä»¬çš„æ ¸å¿ƒç‚¹æ˜¯è¦ä¿è¯åŒä¸€ä¸ªä»£ç ä»“åº“çš„ä¸åŒéƒ¨åˆ†åˆ†å±ä¸åŒè§’è‰²ï¼ˆä¸åŒè§’è‰²å…·æœ‰ä¸åŒæƒé™ï¼‰æ¥ç®¡ç†æ—¶ï¼Œæˆ‘ä»¬è¿˜ä¼šé€‰æ‹© Git å—ï¼Ÿ<sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup></p>
<p>å› æ­¤ï¼Œåœ¨å…·ä½“å·¥å…·çš„ä½¿ç”¨ä¸­ï¼Œä¸èƒ½æƒŸå·¥å…·è®ºï¼Œéœ€è¦ç»“åˆå…·ä½“çš„åœºæ™¯ï¼Œç»“åˆæˆ‘ä»¬è‡ªå·±çš„ç›®æ ‡æ¥ä½¿ç”¨å·¥å…·ã€‚å¦åˆ™ï¼Œå·¥å…·ä¸ä½†æ— æ³•æå‡æ•ˆç‡ï¼Œåè€Œä¼šæˆä¸ºåˆ¶çº¦æ•ˆç‡çš„å› ç´ ã€‚</p>
<h2 id="æ²¡æœ‰å·¥å…·æ˜¯é“¶å¼¹">æ²¡æœ‰å·¥å…·æ˜¯é“¶å¼¹</h2>
<blockquote>
<p>åœ¨æ‰€æœ‰ææ€–æ°‘é—´ä¼ è¯´çš„å¦–æ€ªä¸­ï¼Œæœ€å¯æ€•çš„æ˜¯äººç‹¼ï¼Œå› ä¸ºå®ƒä»¬å¯ä»¥å®Œå…¨å‡ºä¹æ„æ–™åœ°ä»ç†Ÿæ‚‰çš„é¢å­”å˜æˆå¯æ€•çš„æ€ªç‰©ã€‚ä¸ºäº†å¯¹ä»˜äººç‹¼ï¼Œæˆ‘ä»¬åœ¨å¯»æ‰¾å¯ä»¥æ¶ˆç­å®ƒä»¬çš„é“¶å¼¹ã€‚</p>
<p>å¤§å®¶ç†Ÿæ‚‰çš„è½¯ä»¶é¡¹ç›®å…·æœ‰ä¸€äº›äººç‹¼çš„ç‰¹æ€§ï¼ˆè‡³å°‘åœ¨éæŠ€æœ¯ç»ç†çœ‹æ¥ï¼‰ï¼Œå¸¸å¸¸çœ‹ä¼¼ç®€å•æ˜äº†çš„ä¸œè¥¿ï¼Œå´æœ‰å¯èƒ½å˜æˆä¸€ä¸ªè½åè¿›åº¦ã€è¶…å‡ºé¢„ç®—ã€å­˜åœ¨å¤§é‡ç¼ºé™·çš„æ€ªç‰©ã€‚</p>
<p>å› æ­¤ï¼Œæˆ‘ä»¬å¬åˆ°äº†è¿‘ä¹ç»æœ›çš„å¯»æ±‚é“¶å¼¹çš„å‘¼å”¤ï¼Œå¯»æ±‚ä¸€ç§å¯ä»¥ä½¿è½¯ä»¶æˆæœ¬åƒè®¡ç®—æœºç¡¬ä»¶æˆæœ¬ä¸€æ ·é™ä½çš„å°šæ–¹å®å‰‘ã€‚</p>
<p>ä½†æ˜¯ï¼Œæˆ‘ä»¬çœ‹çœ‹è¿‘åå¹´æ¥çš„æƒ…å†µï¼Œæ²¡æœ‰é“¶å¼¹çš„è¸ªè¿¹ã€‚æ²¡æœ‰ä»»ä½•æŠ€æœ¯æˆ–ç®¡ç†ä¸Šçš„è¿›å±•ï¼Œèƒ½å¤Ÿç‹¬ç«‹åœ°è®¸è¯ºåœ¨ç”Ÿäº§ç‡ã€å¯é æ€§æˆ–ç®€æ´æ€§ä¸Šå–å¾—æ•°é‡çº§çš„æé«˜ã€‚</p>
<div align="right">â€”â€”ã€Šäººæœˆç¥è¯ã€‹ç¬¬16ç« </div>
</blockquote>
<p>ä»å†å²çš„ç»éªŒçœ‹ï¼Œæ²¡æœ‰ä»»ä½•ä¸€ç§æŠ€æœ¯é©æ–°èƒ½å¤Ÿç™¾åˆ†ç™¾çš„è§£å†³æ‰€æœ‰é—®é¢˜ï¼Œæ²¡æœ‰ä»»ä½•ä¸€ç§æŠ€æœ¯é©æ–°èƒ½å¤Ÿåœ¨æ²¡æœ‰ä»»ä½•æˆæœ¬çš„å‰æä¸‹è§£å†³æ‰€æœ‰é—®é¢˜ï¼Œä¹Ÿæ²¡æœ‰ä»»ä½•ä¸€ç§æŠ€æœ¯é©æ–°èƒ½å¤Ÿåœ¨ä¸å¼•å…¥æ–°é—®é¢˜çš„æ¡ä»¶ä¸‹è§£å†³æ‰€æœ‰é—®é¢˜ã€‚æ­£å¦‚ Sam Newman åœ¨ <a href="/monolith-to-microservices/docs/What_Are_Microservices.html">ã€ŠMonolith to Microservicesã€‹</a> ä¸€ä¹¦ä¸­è¯´çš„é‚£æ ·ï¼š</p>
<blockquote>
<p>æ­£å¦‚æˆ‘çš„è€åŒäº‹ã€è€æœ‹å‹ã€å¾®æœåŠ¡ä¸“å®¶ James Lewis æ‰€è¯´ï¼šâ€œMicroservices buy you optionsâ€ã€‚</p>
</blockquote>
<p><code>buy</code> è¿™ä¸ªè¯å‘Šè¯«æˆ‘ä»¬ï¼Œæ²¡æœ‰ä»»ä½•ä¸€ç§æŠ€æœ¯é©æ–°æ˜¯å…è´¹çš„ï¼Œæˆ‘ä»¬éƒ½å¿…é¡»ä»˜å‡ºä¸€å®šçš„æˆæœ¬æ‰èƒ½æ¢å–åˆ°æŠ€æœ¯é©æ–°å¸¦æ¥çš„ä¾¿åˆ©ã€‚</p>
<p>ä½†æ˜¯ï¼Œå®é™…ä¸Šï¼Œæ ¹æ®æˆ‘åœ¨å·¥ä½œä¸­çš„è§‚å¯Ÿï¼Œå¤§å¤šæ•°äººåœ¨å¼•å…¥æ–°æŠ€æœ¯ï¼Œæ–°å·¥å…·çš„æ—¶å€™ï¼Œéƒ½åªæƒ³æå–æ–°æŠ€æœ¯çš„æˆæœï¼Œè€Œä¸æƒ³ä¸ºä¹‹ä»˜å‡ºæ±—æ°´ã€‚</p>
<p>æˆ‘ä»¬è¿˜æ€»æ˜¯è¯¯è§£â€œè‡ªç”±è½¯ä»¶â€çš„å«ä¹‰ã€‚å®é™…ä¸Šï¼Œâ€œè‡ªç”±è½¯ä»¶â€æ˜¯å…³ä¹è‡ªç”±çš„é—®é¢˜ï¼Œä¸ä»·æ ¼æ— å…³ï¼Œè½¯ä»¶å¦‚ä½•å®šä»·å¹¶ä¸å½±å“å®ƒæ˜¯å¦è¢«å½’ç±»ä¸ºè‡ªç”±è½¯ä»¶ã€‚åœ¨è‹±æ–‡ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ Free Softwareï¼ŒFree ä¸€è¯æ—¢æœ‰è‡ªç”±ï¼Œä¹Ÿæœ‰å…è´¹çš„æ„æ€ã€‚è€Œ Free Software ä¸­çš„ Free æ˜¯æŒ‡â€œè‡ªç”±è¨€è®ºâ€ä¸­çš„è‡ªç”±ï¼Œè€Œéâ€œå…è´¹â€ã€‚<sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup></p>
<p>æˆ‘ä»¬å…è´¹ä»â€œè‡ªç”±è½¯ä»¶â€è·å¾—å…¶ä¾¿åˆ©ï¼Œä½†å´ä¸æƒ³èŠ±æ—¶é—´æ¥è´¡çŒ®è‡ªå·±çš„æƒ³æ³•ï¼Œå¯¼è‡´æˆ‘ä»¬æ‰€ä½¿ç”¨çš„ç‰ˆæœ¬å’Œâ€œç¤¾åŒºâ€ç‰ˆæœ¬ä¹‹é—´çš„å·®è·è¶Šæ¥è¶Šå¤§ï¼Œè¿›è€Œå¯¼è‡´æ— æ³•æŒç»­è·å–æ–°æŠ€æœ¯çš„ä¾¿åˆ©ã€‚ç”šè‡³æœ‰æ—¶å€™ï¼Œå½“å‘å±•åˆ°ä¸€å®šé˜¶æ®µï¼Œæœ€åˆä¸ºäº†è§£å†³é—®é¢˜è€Œå¼•å…¥çš„â€œè‡ªç”±è½¯ä»¶â€ï¼Œåè€Œæˆäº†å½±å“æ•ˆç‡çš„ä¸»è¦å› ç´ ã€‚</p>
<p>æˆ‘ä»¬å…è´¹å¼•å…¥é©æ–°æŠ€æœ¯ï¼Œä½†æ˜¯å´ä¸æƒ³èŠ±è´¹æ—¶é—´æ¥æå‡è‡ªå·±çš„èƒ½åŠ›ã€ç»´æŠ¤æ–°æŠ€æœ¯ã€‚å½“åœ¨ä½¿ç”¨æ–°æŠ€æœ¯é‡åˆ°äº›è®¸é—®é¢˜çš„æ—¶å€™ï¼Œæˆ‘ä»¬çš„è‚Œè‚‰è®°å¿†å°±å¼€å§‹å‘æŒ¥ä¸»å¯¼ä½œç”¨ï¼Œè¿›è€Œå¼€å§‹æ‰“é€€å ‚é¼“ï¼Œå¯¼è‡´åœ¨æŠ€æœ¯é©æ–°ä¸Šå‡ºç°â€œååå¤å¤â€çš„æƒ…å†µã€‚æˆ‘æ‰€ç»å†çš„ä¸åŒå›¢é˜Ÿå¯¹å¾…è‡ªåŠ¨åŒ–æµ‹è¯•çš„æ€åº¦ï¼Œéƒ½æœ‰åŠ›çš„è¯æ˜äº†è¿™ä¸€ç‚¹ã€‚</p>
<p>æˆ‘ä»¬æ€»æƒ³ç€åªè¦å¼•å…¥æŸç§æ–°æŠ€æœ¯ï¼Œæˆ‘ä»¬æ‰€é¢ä¸´çš„é—®é¢˜å°±ä¸€ä¸‹éƒ½è§£å†³äº†ã€‚æˆ‘ä»¬æ€»æƒ³ç€å¯»æ‰¾ä¸€ç§â€œé“¶å¼¹â€æ¥è§£å†³æˆ‘ä»¬çš„é—®é¢˜ã€‚ä»å¤§å†å²ç†è®ºçš„è§‚ç‚¹æ¥çœ‹ï¼Œè¿™æ€ä¹ˆå¯èƒ½ä¼šå®ç°å‘¢ï¼Ÿ</p>
<p>ä¸–ç•Œä¸Šï¼Œå¤§æ±Ÿå¤§æ²³ï¼Œå¤§å¤šå¼¯å¼¯æ›²æ›²ï¼Œå³ä½¿æ‰€å¤„å¹³åŸä¹‹å¤„çš„æ²³æµï¼Œä¹Ÿä¿æŒèœ¿èœ’ä¹‹æ€ã€‚<sup class="footnote-ref"><a href="#fn4" id="fnref4">[4]</a></sup></p>
<p>åˆ˜ç¦¹é”¡è¯´ï¼šâ€œä¹æ›²é»„æ²³ä¸‡é‡Œæ²™ï¼Œæµªæ·˜é£ç°¸è‡ªå¤©æ¶¯ã€‚â€</p>
<p><img src="/2021/05/01/how-to-improve-the-work-efficiency/4.jpeg" alt></p>
<p>é©¬å…‹æ€è¯´ï¼šç¤¾ä¼šå‘å±•æ˜¯å‰è¿›æ€§å’Œæ›²æŠ˜æ€§çš„ç»Ÿä¸€ï¼Œäº‹ç‰©çš„å‘å±•ä¸æ˜¯ç›´çº¿å¼å‰è¿›è€Œæ˜¯èºæ—‹å¼ä¸Šå‡çš„ï¼Œæ˜¯ä¸€ä¸ªå¦å®šä¹‹å¦å®šçš„è¿‡ç¨‹ã€‚</p>
<p>å› æ­¤ï¼Œæˆ‘ä»¬å¿…é¡»è®¤è¯†åˆ°ï¼ŒçŸ­æœŸçœ‹ï¼Œæ–°æŠ€æœ¯ä¼šè§£å†³æˆ‘ä»¬å½“å‰çš„é—®é¢˜ï¼Œä½†æ˜¯æ–°æŠ€æœ¯å¿…ç„¶ä¼šå¼•å…¥æ–°çš„é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦ä¸æ—¶ä¿±è¿›ï¼Œåœ¨æ–°çš„åœºæ™¯ä¸‹ä¸æ–­è§£å†³æ–°æŠ€æœ¯å¸¦æ¥çš„é—®é¢˜ã€‚è¿™æœ‰è¿™æ ·ï¼Œæ‰èƒ½ä¸æ–­çš„æå‡å·¥ä½œæ•ˆç‡ã€‚</p>
<p>æˆ‘ä»¬ä¸èƒ½å› ä¸ºå µè½¦ï¼Œå°±å›é€€åˆ°è‡ªè¡Œè½¦çš„æ—¶ä»£ï¼›æˆ‘ä»¬ä¸èƒ½å› ä¸ºæœ‰å‡å¸ï¼Œå°±å›é€€åˆ°ç‰©ç‰©äº¤æ¢çš„æ—¶ä»£ï¼›â€¦â€¦</p>
<h2 id="å¤©äººåˆä¸€">å¤©äººåˆä¸€</h2>
<p>è™½ç„¶å·¥å…·æ˜¯ç”Ÿäº§åŠ›çš„æ ‡å¿—ï¼Œä½†æ˜¯äººæ˜¯ç”Ÿäº§åŠ›çš„ä¸»ä½“ï¼Œæ˜¯é¦–è¦çš„ç”Ÿäº§åŠ›ï¼Œæ˜¯ç”Ÿäº§åŠ›çš„ä¸»å¯¼å› ç´ ã€‚å› æ­¤ï¼Œåœ¨æå‡å·¥å…·å±‚çº§çš„åŒæ—¶ï¼Œæˆ‘ä»¬ä¸èƒ½å¿½è§†â€œäººâ€åœ¨æ•ˆç‡æå‡ä¸­çš„é‡è¦ä½œç”¨ã€‚</p>
<p>ä¸ºäº†æœ€å¤§å¯èƒ½çš„æå‡æ•ˆç‡ï¼Œæˆ‘ä»¬éœ€è¦åˆ†ææ¸…æ¥šï¼š</p>
<ul>
<li>äººæ“…é•¿å¤„ç†ä»€ä¹ˆå·¥ä½œï¼Ÿ</li>
<li>å·¥å…·ã€æŠ€æœ¯ã€å¹³å°æ“…é•¿å¤„ç†ä»€ä¹ˆå·¥ä½œï¼Ÿ</li>
<li>äººå’Œå·¥å…·å¦‚ä½•æœ‰æ•ˆç»“åˆï¼Ÿ</li>
</ul>
<p>è¿™é‡Œï¼Œæˆ‘ç§°è¿™ç§ï¼Œäººå’Œå·¥å…·çš„å…³ç³»ä¸ºâ€œå¤©äººåˆä¸€â€ï¼Œåªè¦å½“äººçš„æ•ˆèƒ½å’Œå·¥å…·çš„æ•ˆèƒ½ç´§å¯†é…åˆåœ¨ä¸€èµ·çš„æ—¶å€™ï¼Œæˆ‘ä»¬çš„å·¥ä½œæ•ˆç‡æ‰èƒ½å¾—åˆ°æœ€å¤§ç¨‹åº¦çš„æå‡ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬è¦å‘æŒ¥è‡ªæˆ‘çš„æ€ç»´ä¼˜åŠ¿ï¼Œç»“åˆå…·ä½“çš„åœºæ™¯ï¼ŒæŠŠå„ç§å·¥å…·æœ‰æ•ˆçš„æ•´åˆåœ¨ä¸€èµ·ï¼Œå½¢æˆä¸€å¥—å®Œæ•´çš„å·¥å…·ä½“ç³»ï¼Œè¿™æœ‰è¿™æ ·ï¼Œæ‰èƒ½æå‡æˆ‘ä»¬çš„å·¥ä½œæ•ˆç‡ã€‚</p>
<p>åœ¨æˆ‘ä»¬è§£å†³è§†é¢‘è´¨é‡è¯„ä¼°çš„æ•´ä¸ªå·¥ä½œä¸­ï¼Œæˆ‘ä»¬å°±åˆ©ç”¨â€œå¤©äººåˆä¸€â€çš„æ€è·¯ï¼ŒæŠŠ <code>shell</code>ã€<code>c++</code>ã€<code>python</code> ç­‰è¯­è¨€æœ‰æœºçš„æ•´åˆåœ¨ä¸€èµ·ï¼Œä¸åŒè¯­è¨€åœ¨ç³»ç»Ÿçš„ä¸åŒéƒ¨åˆ†å‘æŒ¥å„è‡ªçš„ä¼˜åŠ¿ï¼Œæ—¢èƒ½ä¿è¯æ‰§è¡Œæ•ˆç‡ï¼Œåˆèƒ½ä¿è¯å¼€å‘æ•ˆç‡â€¦â€¦</p>
<div class="bili_video"><div style="position: relative; width: 100%; height: 0; padding-bottom: 75%;"><iframe src="https://player.bilibili.com/player.html?aid=540619133&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position: absolute; width: 100%; height: 100%; left: 0; top: 0;"> </iframe></div></div>
<h2 id="å·¥å…·çš„ä¸‰ä¸ªæ€ç»´å±‚æ¬¡">å·¥å…·çš„ä¸‰ä¸ªæ€ç»´å±‚æ¬¡</h2>
<blockquote>
<p>å‚ç¦…ä¹‹åˆï¼Œçœ‹å±±æ˜¯å±±ï¼Œçœ‹æ°´æ˜¯æ°´ï¼›</p>
<p>ç¦…æœ‰æ‚Ÿæ—¶ï¼Œçœ‹å±±ä¸æ˜¯å±±ï¼Œçœ‹æ°´ä¸æ˜¯æ°´ï¼›</p>
<p>ç¦…ä¸­å½»æ‚Ÿï¼Œçœ‹å±±ä»æ˜¯å±±ï¼Œçœ‹æ°´ä»æ˜¯æ°´ã€‚</p>
<div align="right">â€”â€”é’åŸè¡Œæ€ç¦…å¸ˆ</div>
</blockquote>
<p><img src="/2021/05/01/how-to-improve-the-work-efficiency/5.jpeg" alt></p>
<p>è®°å¾—å¤§å­¦çš„æ—¶å€™ï¼Œæˆ‘ä»¬çš„ã€Šè®¾è®¡æ¨¡å¼ã€‹è€å¸ˆè¯´ï¼šè®¾è®¡æ¨¡å¼æœ‰ä¸‰ä¸ªå±‚æ¬¡ï¼š</p>
<ul>
<li>ä¸æ‡‚è®¾è®¡æ¨¡å¼ï¼Œæ‰€ä»¥æ²¡æ³•ä½¿ç”¨è®¾è®¡æ¨¡å¼ï¼›</li>
<li>äº†è§£è®¾è®¡æ¨¡å¼ï¼Œå“ªé‡Œéƒ½æƒ³ç”¨è®¾è®¡æ¨¡å¼ï¼Œå¤„å¤„æ˜¯æ¨¡å¼ï¼Œå¤„å¤„æ˜¯åæ¨¡å¼ï¼›</li>
<li>é€å½»è®¾è®¡æ¨¡å¼ï¼Œä»£ç çœ‹ä¼¼æ²¡ç”¨è®¾è®¡æ¨¡å¼ï¼Œå´å¤„å¤„ä½“ç°è®¾è®¡æ¨¡å¼çš„æ€æƒ³ï¼›</li>
</ul>
<p>æ‰€ä»¥ï¼Œåœ¨æ•ˆç‡æå‡çš„è¿‡ç¨‹ä¸­ï¼Œå¯¹å¾…å·¥å…·ä¹Ÿéœ€è¦è¾¾åˆ°ï¼šçœ‹å±±ä»æ˜¯å±±ï¼Œçœ‹æ°´ä»æ˜¯æ°´çš„å¢ƒç•Œã€‚</p>
<h2 id="å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</h2>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p><a href="https://zhuanlan.zhihu.com/p/53300998">ä¸Šä¸–çºªçš„è€ç¨‹åºå‘˜æ˜¯å¦‚ä½•ç¼–ç¨‹çš„</a> <a href="#fnref1" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn2" class="footnote-item"><p><a href="https://zhuanlan.zhihu.com/p/368422885">Googleå’ŒFacebookä¸ºä»€ä¹ˆä¸ç”¨gitç®¡ç†æºç ï¼Ÿ</a> <a href="#fnref2" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn3" class="footnote-item"><p><a href="http://www.gnu.org/philosophy/free-sw.zh-cn.html">ä»€ä¹ˆæ˜¯è‡ªç”±è½¯ä»¶ï¼Ÿ</a> <a href="#fnref3" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn4" class="footnote-item"><p><a href="https://www.zhihu.com/question/27696813/answer/93053445">ä¸ºä»€ä¹ˆæ²³æµéƒ½æ˜¯å¼¯å¼¯æ›²æ›²çš„ï¼Ÿ</a> <a href="#fnref4" class="footnote-backref">â†©ï¸</a></p>
</li>
</ol>
</section>
]]></content>
      <categories>
        <category>æ–‡åŒ–</category>
      </categories>
      <tags>
        <tag>æ–¹æ³•è®º</tag>
        <tag>å¤§å†å²ç†è®º</tag>
      </tags>
  </entry>
  <entry>
    <title>FFmpegä¸­åŸºäºæ·±åº¦å­¦ä¹ æ¨¡å‹çš„ç›®æ ‡æ£€æµ‹</title>
    <url>/2021/04/27/object-detection-based-on-dnn-detect-in-FFmpeg/</url>
    <content><![CDATA[<p><img src="/2021/04/27/object-detection-based-on-dnn-detect-in-FFmpeg/1.png" alt></p>
<p>ä»FFmpegçš„ä»£ç æäº¤è®°å½•<a href="https://github.com/FFmpeg/FFmpeg/commit/aa9ffdaa1eaeb5e16fb6b89852f38ff488d81173"><strong>lavfi: add filter dnn_detect for object detection</strong></a>ä¸­ï¼Œæˆ‘ä»¬å‘ç°ï¼ŒFFmpegå·²ç»ä»¥æ»¤é•œçš„å½¢å¼æä¾›äº†åŸºäºDNNçš„ç›®æ ‡æ£€æµ‹èƒ½åŠ›ã€‚</p>
<span id="more"></span>
<h2 id="dnn-detectæ»¤é•œ">dnn_detectæ»¤é•œ</h2>
<p>åœ¨FFmpegä¸­ï¼ŒåŸºäºDNNçš„ç›®æ ‡æ£€æµ‹èƒ½åŠ›ç”±<code>dnn_detectæ»¤é•œ</code>ï¼ˆ<a href="https://github.com/FFmpeg/FFmpeg/blob/master/libavfilter/vf_dnn_detect.c">vf_dnn_detect.c</a>ï¼‰æä¾›ã€‚æ ¹æ®è¯¥èƒ½åŠ›çš„ä½œè€…æ‰€æä¾›çš„èµ„æ–™<a href="https://mp.weixin.qq.com/s?__biz=MzI3MjU1MjU1Mw==&amp;mid=2247483828&amp;idx=1&amp;sn=df8fe902868ca2a0ea1cf50fff28ff95"><em>ç›®æ ‡æ£€æµ‹ï¼ŒFFmpegä¸­ç¬¬ä¸€ä¸ªåŸºäºæ·±åº¦å­¦ä¹ æ¨¡å‹çš„è§†é¢‘åˆ†æåŠŸèƒ½</em></a>å¯çŸ¥ï¼š</p>
<blockquote>
<p>å½“å‰ç›®æ ‡æ£€æµ‹åªæ”¯æŒOpenVINOåç«¯ï¼Œåç»­è¿˜å°†å°½å¿«åŠ å…¥æ›´å¤šåŠŸèƒ½ï¼Œæ¯”å¦‚åŸºäºTensorFlowæ¨¡å‹çš„ç›®æ ‡æ£€æµ‹ã€æ”¯æŒOpenVINOåç«¯çš„ç›®æ ‡è¯†åˆ«ã€ç›®æ ‡æ£€æµ‹å’Œè¯†åˆ«ç»“æœçš„å¯è§†åŒ–ç­‰ã€‚</p>
</blockquote>
<p>æ ¹æ®<a href="https://mp.weixin.qq.com/s?__biz=MzI3MjU1MjU1Mw==&amp;mid=2247483828&amp;idx=1&amp;sn=df8fe902868ca2a0ea1cf50fff28ff95"><em>ç›®æ ‡æ£€æµ‹ï¼ŒFFmpegä¸­ç¬¬ä¸€ä¸ªåŸºäºæ·±åº¦å­¦ä¹ æ¨¡å‹çš„è§†é¢‘åˆ†æåŠŸèƒ½</em></a>ä¸€æ–‡æä¾›çš„demoå¯çŸ¥ï¼Œåœ¨å½“å‰çš„ç‰ˆæœ¬ä¸­ï¼Œæ£€æµ‹ç»“æœæ˜¯é€šè¿‡<code>showinfoæ»¤é•œ</code>ä»¥æ—¥å¿—çš„å½¢å¼è¾“å‡ºçš„ã€‚</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@9d26c3a57bc7:/workspace# ffmpeg -i cici.jpg -vf dnn_detect=dnn_backend=openvino:model=face-detection-adas-0001.xml:input=data:output=detection_out:confidence=0.6:labels=face-detection-adas-0001.label,showinfo -f null -</span><br><span class="line">...</span><br><span class="line">[Parsed_showinfo_1 @ 0x561cf20c1f40]   side data - detection bounding boxes:</span><br><span class="line">[Parsed_showinfo_1 @ 0x561cf20c1f40] source: face-detection-adas-0001.xml</span><br><span class="line">[Parsed_showinfo_1 @ 0x561cf20c1f40] index: 0,  region: (1005, 813) -&gt; (1086, 905), label: face, confidence: 10000/10000.</span><br><span class="line">[Parsed_showinfo_1 @ 0x561cf20c1f40] index: 1,  region: (888, 839) -&gt; (967, 926), label: face, confidence: 6917/10000.</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>æ—¥å¿—æ ¼å¼çš„æ£€æµ‹ç»“æœä¸åˆ©äºç›´è§‚çš„åˆ†æï¼Œå› æ­¤æˆ‘å¯¹è¯¥æ»¤é•œåšäº†ç®€å•çš„ä¿®æ”¹ï¼Œä¸ºå…¶å¢åŠ äº†æ£€æµ‹ç»“æœæ¡†é€‰çš„èƒ½åŠ›ï¼Œä»¥ä¾¿å¯ä»¥æ›´æ–¹ä¾¿çš„è¯„ä¼°<code>dnn_detect</code>çš„æ£€æµ‹èƒ½åŠ›ã€‚å…·ä½“æ•ˆæœå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="/2021/04/27/object-detection-based-on-dnn-detect-in-FFmpeg/2.jpg" alt></p>
<h2 id="dnn-detectæ»¤é•œçš„å®‰è£…">dnn_detectæ»¤é•œçš„å®‰è£…</h2>
<h4 id="å®‰è£…libtensorflow">å®‰è£…libtensorflow</h4>
<p>ä»<a href="https://storage.googleapis.com/tensorflow/">https://storage.googleapis.com/tensorflow/</a>ä¸­é€‰æ‹©é€‚åˆçš„libtensorflowç‰ˆæœ¬ä¸‹è½½å³å¯ï¼Œç”±äºæˆ‘æ˜¯åœ¨MacOSä¸Šè¿›è¡Œçš„å®éªŒï¼Œå› æ­¤æˆ‘é€‰æ‹©äº†<a href="https://storage.googleapis.com/tensorflow/libtensorflow/libtensorflow-cpu-darwin-x86_64-2.4.1.tar.gz">libtensorflow/libtensorflow-cpu-darwin-x86_64-2.4.1.tar.gz</a>ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cd workspace</span><br><span class="line">wget https:&#x2F;&#x2F;storage.googleapis.com&#x2F;tensorflow&#x2F;libtensorflow&#x2F;libtensorflow-cpu-darwin-x86_64-2.4.1.tar.gz --no-check-certificate</span><br><span class="line">tar xzvf libtensorflow-cpu-darwin-x86_64-2.4.1.tar.gz</span><br></pre></td></tr></table></figure>
<h4 id="å®‰è£…openvino-toolkit">å®‰è£…openvino_toolkit</h4>
<p>è¿›å…¥<a href="https://software.intel.com/content/www/us/en/develop/tools/openvino-toolkit/download.html">openvino_toolkitçš„ä¸‹è½½é¡µé¢</a>ï¼Œæ ¹æ®æç¤ºé€‰æ‹©å¯¹åº”çš„ç‰ˆæœ¬ä¸‹è½½å¹¶å®‰è£…å³å¯ã€‚MacOSçš„openvino_toolkitå®‰è£…æ¯”è¾ƒç®€å•ï¼Œä¸‹è½½å¯¹åº”çš„dmgæ–‡ä»¶ä¹‹åï¼Œä¸€è·¯ç‚¹å‡»é»˜è®¤ï¼Œç„¶åå®‰è£…å°±å¯ä»¥ã€‚é»˜è®¤ä¼šå°†ç›¸å…³çš„åº“æ–‡ä»¶å®‰è£…åœ¨<code>/opt/intel/openvino_2021</code>ç›®å½•ã€‚</p>
<h4 id="é‡æ–°ç¼–è¯‘ffmpeg">é‡æ–°ç¼–è¯‘FFmpeg</h4>
<ul>
<li>
<p>æ‹‰å–FFmpegçš„masteråˆ†æ”¯ä»£ç ã€‚</p>
</li>
<li>
<p>æ ¹æ®<a href="https://gitee.com/wangwei1237/wangwei1237/blob/master/2021/04/27/object-detection-based-on-dnn-detect-in-FFmpeg/vf_dnn_detect.7a6ea6ce2a.patch">vf_dnn_detect.7a6ea6ce2a.patch</a>ä¿®æ”¹<code>dnn_detect</code>çš„ä»£ç ã€‚</p>
</li>
<li>
<p>è®¾ç½®ç›¸å…³çš„ç¯å¢ƒå˜é‡ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
  <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:\</span><br><span class="line">/opt/intel/openvino_2021/inference_engine/lib/intel64:\</span><br><span class="line">/opt/intel/openvino_2021/inference_engine/external/tbb/lib:\</span><br><span class="line">/opt/intel/openvino_2021/deployment_tools/ngraph/lib:\</span><br><span class="line">/workspace/tensorflow/lib:\</span><br><span class="line">/workspace/ffmpeg/outputs/lib</span><br><span class="line"></span><br><span class="line">export DYLD_LIBRARY_PATH=$DYLD_LIBRARY_PATH:\</span><br><span class="line">/workspace/ffmpeg/outputs/lib</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>ç¼–è¯‘FFmpeg</p>
  <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.&#x2F;configure --prefix&#x3D;.&#x2F;outputs \</span><br><span class="line">... \</span><br><span class="line">--enable-libtensorflow \</span><br><span class="line">--enable-libopenvino \</span><br><span class="line">--extra-cflags&#x3D;&quot;-I&#x2F;workspace&#x2F;tensorflow&#x2F;include -I&#x2F;opt&#x2F;intel&#x2F;openvino_2021&#x2F;inference_engine&#x2F;include&quot; \</span><br><span class="line">--extra-ldflags&#x3D;&quot;-L&#x2F;workspace&#x2F;tensorflow&#x2F;lib -L&#x2F;opt&#x2F;intel&#x2F;openvino_2021&#x2F;inference_engine&#x2F;lib&#x2F;intel64&quot;</span><br><span class="line"></span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>æ ¹æ®<a href="https://mp.weixin.qq.com/s?__biz=MzI3MjU1MjU1Mw==&amp;mid=2247483828&amp;idx=1&amp;sn=df8fe902868ca2a0ea1cf50fff28ff95"><em>ç›®æ ‡æ£€æµ‹ï¼ŒFFmpegä¸­ç¬¬ä¸€ä¸ªåŸºäºæ·±åº¦å­¦ä¹ æ¨¡å‹çš„è§†é¢‘åˆ†æåŠŸèƒ½</em></a>ä¸­çš„demoä¸‹è½½å¯¹åº”çš„æ¨¡å‹å’Œç›¸å…³æ–‡ä»¶ï¼Œå¹¶ä½¿ç”¨ffplayæ’­æ”¾ã€‚</p>
  <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cd outputs &amp;&amp; .&#x2F;bin&#x2F;ffplay -i test.mp4 \</span><br><span class="line">-vf &quot;dnn_detect&#x3D;dnn_backend&#x3D;openvino:model&#x3D;model&#x2F;face-detection-adas-0001.xml:input&#x3D;data:output&#x3D;detection_out:confidence&#x3D;0.6:labels&#x3D;model&#x2F;face-detection-adas-0001.label&quot;</span><br></pre></td></tr></table></figure>
<p><img src="/2021/04/27/object-detection-based-on-dnn-detect-in-FFmpeg/3.jpg" alt></p>
</li>
</ul>
<h2 id="dnn-detectæ»¤é•œå‚æ•°">dnn_detectæ»¤é•œå‚æ•°</h2>
<p>ä»<a href="https://github.com/FFmpeg/FFmpeg/blob/master/libavfilter/vf_dnn_detect.c">vf_dnn_detect.c</a>å¯çŸ¥ï¼Œ<code>dnn_detectæ»¤é•œ</code>çš„å‚æ•°ä¸»è¦æœ‰ï¼š</p>
<ul>
<li>dnn_backendï¼šæ§åˆ¶dnnçš„åç«¯ï¼Œç›®å‰åªæ”¯æŒopenvivo</li>
<li>confidenceï¼šdnnç›®æ ‡æ£€æµ‹æ—¶çš„ç½®ä¿¡é˜ˆå€¼ï¼Œå¯ä»¥æ ¹æ®å®é™…æƒ…å†µæ¥è®¾ç½®</li>
<li>labelsï¼šæŒ‡å®šæ£€æµ‹ä½¿ç”¨æ¨¡å‹æ‰€å¯¹åº”çš„labelæ–‡ä»¶è·¯å¾„</li>
<li>modelï¼šæŒ‡å®šæ£€æµ‹ä½¿ç”¨æ¨¡å‹æ‰€å¯¹åº”çš„modelæ–‡ä»¶è·¯å¾„</li>
<li>inputï¼šæ¨¡å‹çš„è¾“å…¥</li>
<li>outputï¼šæ¨¡å‹çš„è¾“å‡º</li>
<li>backend_configs, optionsï¼šè¿™ä¸¤ä¸ªå‚æ•°éƒ½å¯¹åº”çš„æ˜¯æ¨¡å‹åç«¯çš„ç›¸å…³é…ç½®</li>
<li>asyncï¼šè®¾ç½®æ˜¯å¦å¯ç”¨å¼‚æ­¥çš„DNNæ¥å£ï¼Œé»˜è®¤ä¸ºå¼‚æ­¥</li>
</ul>
<p>åœ¨ä½¿ç”¨ä¸­ï¼Œå¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€è¦æ¥è®¾ç½®æ»¤é•œçš„ç›¸å…³å‚æ•°ï¼Œè¿›è€Œè¾¾åˆ°è‡ªå·±çš„ç›®çš„ã€‚ä¾‹å¦‚ï¼Œé€šè¿‡è®¾ç½®<code>async</code>æ¥å¯ç”¨åŒæ­¥DNNæ¥å£ï¼Œå…·ä½“å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.&#x2F;bin&#x2F;ffplay -i test.mp4 \</span><br><span class="line">    -vf &quot;dnn_detect&#x3D;dnn_backend&#x3D;openvino:model&#x3D;model&#x2F;face-detection-adas-0001.xml:input&#x3D;data:output&#x3D;detection_out:confidence&#x3D;0.6:labels&#x3D;model&#x2F;face-detection-adas-0001.label:async&#x3D;0&quot;</span><br></pre></td></tr></table></figure>
<h2 id="dnn-detectçš„å…¶ä»–æ¨¡å‹">dnn_detectçš„å…¶ä»–æ¨¡å‹</h2>
<p>åœ¨å¦‚ä¸Šçš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ç”¨äººè„¸æ£€æµ‹æ¨¡å‹ä½œä¸ºä¾‹å­æ¼”ç¤ºäº†FFmpegä¸­çš„DNNç›®æ ‡æ£€æµ‹ã€‚å®é™…ä¸Šï¼Œä½œä¸ºä¸€ä¸ªé€šç”¨çš„æ»¤é•œï¼Œæ›¿æ¢æ¨¡å‹ä¹‹åï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨æ¥è¿›è¡Œå…¶ä»–ç±»å‹çš„ç›®æ ‡æ£€æµ‹ã€‚</p>
<p>åœ¨<a href="https://github.com/openvinotoolkit/open_model_zoo">openvinotoolkit/open_model_zoo</a>ä¸­ï¼Œä»‹ç»äº†å¾ˆå¤šé¢„è®­ç»ƒå¥½çš„æ¨¡å‹ï¼Œæˆ‘ä»¬å¯ä»¥æ‹¿æ¥ç›´æ¥ç”¨ã€‚å„é¢„è®­ç»ƒæ¨¡å‹å¯ä»¥ä»<a href="https://download.01.org/opencv/">download.01.org/opencv/</a>ä¸‹è½½ã€‚é€‰æ‹©æ¨¡å‹çš„æ—¶å€™ï¼ŒåŠ¡å¿…ä¿è¯ä¸‹è½½å’Œæ‰€ä½¿ç”¨çš„OpenVINOç‰ˆæœ¬å¯¹åº”çš„æ¨¡å‹ï¼Œå¦åˆ™ï¼Œå¯èƒ½ä¼šå¯¼è‡´åŠ è½½æ¨¡å‹å¤±è´¥çš„é—®é¢˜ã€‚</p>
<p><img src="/2021/04/27/object-detection-based-on-dnn-detect-in-FFmpeg/4.jpg" alt></p>
]]></content>
      <categories>
        <category>è§†é¢‘æŠ€æœ¯</category>
      </categories>
      <tags>
        <tag>FFmpeg</tag>
        <tag>ç›®æ ‡æ£€æµ‹</tag>
        <tag>dnn_detect</tag>
      </tags>
  </entry>
  <entry>
    <title>å·ç§¯è¿ç®—ä»¥åŠé«˜æ–¯æ»¤æ³¢å™¨çš„æ„é€ </title>
    <url>/2021/04/14/convolution-and-the-gaussian-convolution-kernel/</url>
    <content><![CDATA[<h2 id="å·ç§¯çš„æ•°å­¦å®šä¹‰">å·ç§¯çš„æ•°å­¦å®šä¹‰</h2>
<p>åœ¨å›¾åƒåˆ†æå’Œå›¾åƒå¤„ç†ä¸­ï¼Œ<strong>å·ç§¯</strong>(<em>convolution</em>)æ˜¯ä¸€ç§éå¸¸é‡è¦çš„è¿ç®—ã€‚å·ç§¯æ˜¯ä¸€ä¸ªç§¯åˆ†è¿ç®—ï¼Œå…¶ååº”çš„æ˜¯å‡½æ•°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span></span>åœ¨å¦ä¸€ä¸ªå‡½æ•°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">h(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span></span>ä¸Šç§»åŠ¨æ—¶æ‰€å åŠ çš„é‡ã€‚å‡½æ•°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span></span></span></span>å’Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">h</span></span></span></span>åœ¨æœ‰é™åŸŸ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0,t]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">t</span><span class="mclose">]</span></span></span></span>ä¸Šçš„ä¸€ç»´å·ç§¯ä¸ºï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mo stretchy="false">(</mo><mi>f</mi><mo>âˆ—</mo><mi>h</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msubsup><mo>âˆ«</mo><mn>0</mn><mi>t</mi></msubsup><mi>f</mi><mo stretchy="false">(</mo><mi>Ï„</mi><mo stretchy="false">)</mo><mi>h</mi><mo stretchy="false">(</mo><mi>t</mi><mo>âˆ’</mo><mi>Ï„</mi><mo stretchy="false">)</mo><mi mathvariant="normal">d</mi><mi>Ï„</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msubsup><mo>âˆ«</mo><mn>0</mn><mi>t</mi></msubsup><mi>f</mi><mo stretchy="false">(</mo><mi>t</mi><mo>âˆ’</mo><mi>Ï„</mi><mo stretchy="false">)</mo><mi>h</mi><mo stretchy="false">(</mo><mi>Ï„</mi><mo stretchy="false">)</mo><mi mathvariant="normal">d</mi><mi>Ï„</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
(f*h)(t) &amp;= \int^{t}_{0}f(\tau)h(t-\tau)\mathrm{d}\tau \\
&amp;= \int^{t}_{0}f(t - \tau)h(\tau)\mathrm{d}\tau
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:5.510812em;vertical-align:-2.505406em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.005406em;"><span style="top:-5.005406em;"><span class="pstrut" style="height:3.543456em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">h</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathdefault">t</span><span class="mclose">)</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.543456em;"></span><span class="mord"></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.505406em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.005406em;"><span style="top:-5.005406em;"><span class="pstrut" style="height:3.543456em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">âˆ«</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5434560000000002em;"><span style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span><span style="top:-3.8129000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.1132em;">Ï„</span><span class="mclose">)</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.1132em;">Ï„</span><span class="mclose">)</span><span class="mord"><span class="mord mathrm">d</span></span><span class="mord mathdefault" style="margin-right:0.1132em;">Ï„</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.543456em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">âˆ«</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5434560000000002em;"><span style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span><span style="top:-3.8129000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.1132em;">Ï„</span><span class="mclose">)</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.1132em;">Ï„</span><span class="mclose">)</span><span class="mord"><span class="mord mathrm">d</span></span><span class="mord mathdefault" style="margin-right:0.1132em;">Ï„</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.505406em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå·ç§¯ç§¯åˆ†çš„ä¸Šä¸‹é™å®é™…ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mo>âˆ’</mo><mi mathvariant="normal">âˆ</mi><mo separator="true">,</mo><mo>+</mo><mi mathvariant="normal">âˆ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(-\infty, +\infty)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">âˆ’</span><span class="mord">âˆ</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">+</span><span class="mord">âˆ</span><span class="mclose">)</span></span></span></span>ï¼Œä½†æ˜¯æ­¤å¤„æˆ‘ä»¬å‡è®¾è´Ÿåæ ‡éƒ¨åˆ†çš„å€¼ä¸º0ï¼Œå› æ­¤è¿™é‡Œå¯ä»¥é™å®šåœ¨åŒºé—´<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0,t]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">t</span><span class="mclose">]</span></span></span></span>ä¸­ã€‚<sup>[1]</sup></p>
<span id="more"></span>
<p>æ ¹æ®ä¸€ç»´å·ç§¯çš„å®šä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°å‡½æ•°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x,y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span>åœ¨å¦ä¸€ä¸ªå‡½æ•°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">h(x,y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span>ä¸Šç§»åŠ¨æ—¶çš„å·ç§¯ï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mo stretchy="false">(</mo><mi>f</mi><mo>âˆ—</mo><mi>h</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msubsup><mo>âˆ«</mo><mrow><mo>âˆ’</mo><mi mathvariant="normal">âˆ</mi></mrow><mrow><mo>+</mo><mi mathvariant="normal">âˆ</mi></mrow></msubsup><mi>f</mi><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo><mi>h</mi><mo stretchy="false">(</mo><mi>x</mi><mo>âˆ’</mo><mi>a</mi><mo separator="true">,</mo><mi>y</mi><mo>âˆ’</mo><mi>b</mi><mo stretchy="false">)</mo><mi mathvariant="normal">d</mi><mi>a</mi><mi mathvariant="normal">d</mi><mi>b</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msubsup><mo>âˆ«</mo><mrow><mo>âˆ’</mo><mi mathvariant="normal">âˆ</mi></mrow><mrow><mo>+</mo><mi mathvariant="normal">âˆ</mi></mrow></msubsup><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo>âˆ’</mo><mi>a</mi><mo separator="true">,</mo><mi>y</mi><mo>âˆ’</mo><mi>b</mi><mo stretchy="false">)</mo><mi>h</mi><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo><mi mathvariant="normal">d</mi><mi>a</mi><mi mathvariant="normal">d</mi><mi>b</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
(f*h)(x,y) &amp;= \int^{+\infty}_{-\infty}f(a,b)h(x-a,y-b)\mathrm{d}a\mathrm{d}b \\ 
&amp;= \int^{+\infty}_{-\infty}f(x-a,y-b)h(a,b)\mathrm{d}a\mathrm{d}b
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:5.583024em;vertical-align:-2.541512em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.041512em;"><span style="top:-5.041512em;"><span class="pstrut" style="height:3.521231em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">h</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.521231em;"></span><span class="mord"></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.541512em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.041512em;"><span style="top:-5.041512em;"><span class="pstrut" style="height:3.521231em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">âˆ«</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5212310000000002em;"><span style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">âˆ</span></span></span></span><span style="top:-3.8129000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">+</span><span class="mord mtight">âˆ</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.970281em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span><span class="mclose">)</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">b</span><span class="mclose">)</span><span class="mord"><span class="mord mathrm">d</span></span><span class="mord mathdefault">a</span><span class="mord"><span class="mord mathrm">d</span></span><span class="mord mathdefault">b</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.521231em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">âˆ«</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5212310000000002em;"><span style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">âˆ</span></span></span></span><span style="top:-3.8129000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">+</span><span class="mord mtight">âˆ</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.970281em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">b</span><span class="mclose">)</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span><span class="mclose">)</span><span class="mord"><span class="mord mathrm">d</span></span><span class="mord mathdefault">a</span><span class="mord"><span class="mord mathrm">d</span></span><span class="mord mathdefault">b</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.541512em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<h2 id="æ•°å­—å›¾åƒåˆ†æä¸­çš„å·ç§¯">æ•°å­—å›¾åƒåˆ†æä¸­çš„å·ç§¯</h2>
<p>æ•°å­—å›¾åƒæ˜¯ä¸€ä¸ªäºŒç»´çš„ç¦»æ•£æ•°æ®ï¼Œå› æ­¤å¯¹äºæ•°å­—å›¾åƒè€Œè¨€ï¼Œéœ€è¦å°†ç§¯åˆ†è¿ç®—ï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>âˆ«</mo></mrow><annotation encoding="application/x-tex">\int</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.11112em;vertical-align:-0.30612em;"></span><span class="mop op-symbol small-op" style="margin-right:0.19445em;position:relative;top:-0.0005599999999999772em;">âˆ«</span></span></span></span>)æ”¹ä¸ºåŠ å’Œè¿ç®—ï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>âˆ‘</mo></mrow><annotation encoding="application/x-tex">\sum</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.00001em;vertical-align:-0.25001em;"></span><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">âˆ‘</span></span></span></span>ï¼‰ï¼Œä»è€Œå¾—åˆ°<strong>ç¦»æ•£å·ç§¯</strong>(<em>discrete convolution</em>)ã€‚</p>
<p>å¯¹äºæ•°å­—å›¾åƒè€Œè¨€ï¼Œåœ¨å›¾åƒå¹³é¢ä¸Šå­˜åœ¨æœ‰é™çš„å®šä¹‰åŸŸï¼Œå¯¹äºå®šä¹‰åŸŸä¹‹å¤–çš„ç¦»æ•£å·ç§¯ç»“æœä¸º0ã€‚å› æ­¤ï¼Œè¿™ä¸ªç‰¹ç‚¹å¹¶ä¸å¦¨ç¢æˆ‘ä»¬åœ¨æ•°å­—å›¾åƒä¸Šæ‰§è¡Œå·ç§¯è¿ç®—ã€‚æ­¤æ—¶ï¼Œå·ç§¯è¡¨ç¤ºçš„æ˜¯ä½¿ç”¨æ»¤æ³¢å™¨<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">h</span></span></span></span>å¯¹å›¾åƒæ‰§è¡Œä¸€ä¸ªçº¿æ€§æ»¤æ³¢å¤„ç†ã€‚</p>
<p>æˆ‘ä»¬åœ¨å›¾åƒ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(i,j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span>çš„ä¸€ä¸ªå±€éƒ¨é‚»åŸŸ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi></mrow><annotation encoding="application/x-tex">\mathcal{O}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.02778em;">O</span></span></span></span></span>å†…è®¡ç®—å…¶æ‰€æœ‰åƒç´ çš„çº¿æ€§ç»„åˆï¼Œé‚»åŸŸ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi></mrow><annotation encoding="application/x-tex">\mathcal{O}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.02778em;">O</span></span></span></span></span>ä¸­çš„å„ä¸ªåƒç´ çš„æƒé‡ç”±<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">h(i,j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span>æ¥ç¡®å®šã€‚å› æ­¤ï¼Œå¯¹äºå›¾åƒä¸­çš„åƒç´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(i,j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span>ï¼Œæˆ‘ä»¬åœ¨å…¶é‚»åŸŸ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi></mrow><annotation encoding="application/x-tex">\mathcal{O}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.02778em;">O</span></span></span></span></span>å†…ä½¿ç”¨æ»¤æ³¢å™¨<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">h</span></span></span></span>å¯¹å…¶æ‰§è¡Œå·ç§¯è¿ç®—ï¼Œå¾—åˆ°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">g(i,j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span>ï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>=</mo><mstyle scriptlevel="0" displaystyle="true"><munder><mo>âˆ‘</mo><mrow><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo><mo>âˆˆ</mo><mi mathvariant="script">O</mi></mrow></munder><mi>f</mi><mo stretchy="false">(</mo><mi>i</mi><mo>âˆ’</mo><mi>m</mi><mo separator="true">,</mo><mi>j</mi><mo>âˆ’</mo><mi>n</mi><mo stretchy="false">)</mo><mi>h</mi><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo></mstyle></mrow><annotation encoding="application/x-tex">g(i,j)=\displaystyle\sum_{(m,n)\in\mathcal{O}}f(i-m,j-n)h(m,n)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.5660100000000003em;vertical-align:-1.516005em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.808995em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">m</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">n</span><span class="mclose mtight">)</span><span class="mrel mtight">âˆˆ</span><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.02778em;">O</span></span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.516005em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></span></p>
<p>åœ¨ä¸Šå¼ä¸­ï¼Œç§°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">h</span></span></span></span>ä¸º<strong>å·ç§¯æ©è†œ</strong>(<em>convolution mask</em>)æˆ–è€…æ»¤æ³¢å™¨ï¼Œå¹¶ä¸”ä¸€èˆ¬ä¼šé€‰æ‹©å…·æœ‰å¥‡æ•°è¡Œå’Œåˆ—çš„çŸ©å½¢é‚»åŸŸ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi></mrow><annotation encoding="application/x-tex">\mathcal{O}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.02778em;">O</span></span></span></span></span>ï¼Œä»¥æ–¹ä¾¿ç¡®å®šé¢†åŸŸçš„ä¸­å¿ƒã€‚<sup>[1]</sup></p>
<h2 id="åˆ©ç”¨é«˜æ–¯æ»¤æ³¢å™¨æ¥æ¨¡ç³Šå›¾åƒ">åˆ©ç”¨é«˜æ–¯æ»¤æ³¢å™¨æ¥æ¨¡ç³Šå›¾åƒ</h2>
<p>é€šå¸¸ï¼Œå›¾åƒå¤„ç†è½¯ä»¶ä¼šæä¾›â€œæ¨¡ç³Šâ€ï¼ˆblurï¼‰æ»¤é•œï¼Œä½¿å›¾ç‰‡äº§ç”Ÿæ¨¡ç³Šçš„æ•ˆæœã€‚å…·ä½“å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="/2021/04/14/convolution-and-the-gaussian-convolution-kernel/1.jpeg" alt></p>
<p>æ¨¡ç³Šçš„æœ¬è´¨å°±æ˜¯åˆ©ç”¨åƒç´ é‚»åŸŸ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi></mrow><annotation encoding="application/x-tex">\mathcal{O}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.02778em;">O</span></span></span></span></span>å†…å…¶ä»–åƒç´ çš„çº¿æ€§è¿ç®—æ¥è®¡ç®—è¯¥åƒç´ çš„å€¼ï¼Œä»è€Œæé«˜è¯¥åƒç´ å’Œé‚»åŸŸå†…å…¶ä»–åƒç´ ä¹‹é—´çš„ç›¸å…³æ€§ã€‚</p>
<p>æ¨¡ç³Šçš„æ–¹å¼å’Œæ•ˆæœå–å†³äºçº¿æ€§è¿ç®—æ—¶çš„æ»¤æ³¢å™¨<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">h</span></span></span></span>çš„é€‰å–ã€‚<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">h</span></span></span></span>çš„é€‰æ‹©æœ‰å¾ˆå¤šï¼Œå…¶ä¸­æœ‰ä¸€ç§å°±æ˜¯é«˜æ–¯æ»¤æ³¢å™¨ï¼Œå…¶å¯¹åº”çš„æ¨¡ç³Šæ•ˆæœç§°ä¹‹ä¸ºâ€œé«˜æ–¯æ¨¡ç³Šâ€ã€‚â€œé«˜æ–¯æ¨¡ç³Šâ€çš„æœ¬è´¨å°±æ˜¯åˆ©ç”¨é«˜æ–¯å‡½æ•°ç”Ÿæˆçº¿æ€§è¿ç®—æ—¶å„åƒç´ çš„æƒé‡ï¼Œå³åˆ©ç”¨é«˜æ–¯å‡½æ•°ï¼ˆå½“<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¼</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\mu=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">Î¼</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>ä¸”å„æ–¹å‘çš„<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ïƒ</mi></mrow><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">Ïƒ</span></span></span></span>ç›¸ç­‰æ—¶ï¼‰ç”Ÿæˆæ»¤æ³¢å™¨<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">h</span></span></span></span>ï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>2</mn><mi>Ï€</mi><msup><mi>Ïƒ</mi><mn>2</mn></msup></mrow></mfrac><msup><mi>e</mi><mrow><mo>âˆ’</mo><mfrac><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup></mrow><mrow><mn>2</mn><msup><mi>Ïƒ</mi><mn>2</mn></msup></mrow></mfrac></mrow></msup></mrow><annotation encoding="application/x-tex">G(x,y) = \frac{1}{2\pi\sigma^2}e^{-\frac{x^2+y^2}{2\sigma^2}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">G</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord mathdefault" style="margin-right:0.03588em;">Ï€</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.3013099999999997em;"><span style="top:-3.4534200000000004em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2112714285714286em;"><span style="top:-2.5061857142857145em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9384399999999999em;"><span style="top:-2.93844em;margin-right:0.1em;"><span class="pstrut" style="height:2.64444em;"></span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.2255000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.4623857142857144em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.04844em;"><span style="top:-3.04844em;margin-right:0.1em;"><span class="pstrut" style="height:2.64444em;"></span><span class="mord mtight">2</span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.04844em;"><span style="top:-3.04844em;margin-right:0.1em;"><span class="pstrut" style="height:2.64444em;"></span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.49381428571428565em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">h</span></span></span></span>ä¸­å¿ƒç‚¹çš„åæ ‡ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(0,0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span>ï¼Œåˆ™æ•´ä¸ª<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">h</span></span></span></span>çš„åæ ‡å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="/2021/04/14/convolution-and-the-gaussian-convolution-kernel/2.png" alt></p>
<p>åˆ©ç”¨<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">G(x,y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">G</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span>çš„å…¬å¼ï¼Œå³å¯è®¡ç®—å¾—åˆ°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ïƒ</mi></mrow><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">Ïƒ</span></span></span></span>ä¸ºæŒ‡å®šå€¼æ—¶çš„é«˜æ–¯æ»¤æ³¢å™¨<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">h</span></span></span></span>ã€‚å…·ä½“ç»†èŠ‚æ­¤å¤„ä¸å†èµ˜è¿°ï¼Œå…·ä½“å¯ä»¥å‚è€ƒï¼š<a href="http://www.ruanyifeng.com/blog/2012/11/gaussian_blur.html">é«˜æ–¯æ¨¡ç³Šçš„ç®—æ³•</a>ã€‚</p>
<h2 id="ä¸ä¾èµ–å…¶ä»–åº“ç”Ÿæˆé«˜æ–¯æ»¤æ³¢å™¨">ä¸ä¾èµ–å…¶ä»–åº“ç”Ÿæˆé«˜æ–¯æ»¤æ³¢å™¨</h2>
<p>å½“<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¼</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\mu=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">Î¼</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>ä¸”å„æ–¹å‘çš„<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ïƒ</mi></mrow><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">Ïƒ</span></span></span></span>ç›¸ç­‰æ—¶ï¼Œå¯¹äº<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">h(i,j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span>æˆ‘ä»¬å¾—åˆ°ï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>h</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mrow><mi>G</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><mstyle scriptlevel="0" displaystyle="true"><munder><mo>âˆ‘</mo><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></munder><mrow><mi>G</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow></mstyle></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mrow><mfrac><mn>1</mn><mrow><mn>2</mn><mi>Ï€</mi><msup><mi>Ïƒ</mi><mn>2</mn></msup></mrow></mfrac><msup><mi>e</mi><mrow><mo>âˆ’</mo><mo stretchy="false">(</mo><msup><mi>i</mi><mn>2</mn></msup><mo>+</mo><msup><mi>j</mi><mn>2</mn></msup><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mn>2</mn><msup><mi>Ïƒ</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow></msup></mrow><mstyle scriptlevel="0" displaystyle="true"><munder><mo>âˆ‘</mo><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></munder><mrow><mfrac><mn>1</mn><mrow><mn>2</mn><mi>Ï€</mi><msup><mi>Ïƒ</mi><mn>2</mn></msup></mrow></mfrac><msup><mi>e</mi><mrow><mo>âˆ’</mo><mo stretchy="false">(</mo><msup><mi>i</mi><mn>2</mn></msup><mo>+</mo><msup><mi>j</mi><mn>2</mn></msup><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mn>2</mn><msup><mi>Ïƒ</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow></msup></mrow></mstyle></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mrow><mfrac><mn>1</mn><mrow><mn>2</mn><mi>Ï€</mi><msup><mi>Ïƒ</mi><mn>2</mn></msup></mrow></mfrac><msup><mi>e</mi><mrow><mo>âˆ’</mo><mo stretchy="false">(</mo><msup><mi>i</mi><mn>2</mn></msup><mo>+</mo><msup><mi>j</mi><mn>2</mn></msup><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mn>2</mn><msup><mi>Ïƒ</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow></msup></mrow><mrow><mfrac><mn>1</mn><mrow><mn>2</mn><mi>Ï€</mi><msup><mi>Ïƒ</mi><mn>2</mn></msup></mrow></mfrac><mstyle scriptlevel="0" displaystyle="true"><munder><mo>âˆ‘</mo><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></munder><msup><mi>e</mi><mrow><mo>âˆ’</mo><mo stretchy="false">(</mo><msup><mi>i</mi><mn>2</mn></msup><mo>+</mo><msup><mi>j</mi><mn>2</mn></msup><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mn>2</mn><msup><mi>Ïƒ</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow></msup></mstyle></mrow></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><msup><mi>e</mi><mrow><mo>âˆ’</mo><mo stretchy="false">(</mo><msup><mi>i</mi><mn>2</mn></msup><mo>+</mo><msup><mi>j</mi><mn>2</mn></msup><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mn>2</mn><msup><mi>Ïƒ</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow></msup><mstyle scriptlevel="0" displaystyle="true"><munder><mo>âˆ‘</mo><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></munder><msup><mi>e</mi><mrow><mo>âˆ’</mo><mo stretchy="false">(</mo><msup><mi>i</mi><mn>2</mn></msup><mo>+</mo><msup><mi>j</mi><mn>2</mn></msup><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mn>2</mn><msup><mi>Ïƒ</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow></msup></mstyle></mfrac></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}

h(i,j)&amp;=\frac{G(i,j)}{\displaystyle\sum_{i,j}{G(i,j)}} \\
&amp;=\frac{\frac{1}{2\pi\sigma^2}e^{-(i^2+j^2)/(2\sigma^2)}}{\displaystyle\sum_{i,j}{\frac{1}{2\pi\sigma^2}e^{-(i^2+j^2)/(2\sigma^2)}}} \\
&amp;=\frac{\frac{1}{2\pi\sigma^2}e^{-(i^2+j^2)/(2\sigma^2)}}{\frac{1}{2\pi\sigma^2}\displaystyle\sum_{i,j}e^{-(i^2+j^2)/(2\sigma^2)}} \\
&amp;=\frac{e^{-(i^2+j^2)/(2\sigma^2)}}{\displaystyle\sum_{i,j}e^{-(i^2+j^2)/(2\sigma^2)}}

\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:17.421323em;vertical-align:-8.4606615em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:8.9606615em;"><span style="top:-11.255581500000002em;"><span class="pstrut" style="height:3.72192em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span><span style="top:-6.879879499999999em;"><span class="pstrut" style="height:3.72192em;"></span><span class="mord"></span></span><span style="top:-2.232742499999998em;"><span class="pstrut" style="height:3.72192em;"></span><span class="mord"></span></span><span style="top:2.0849595em;"><span class="pstrut" style="height:3.72192em;"></span><span class="mord"></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:8.4606615em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:8.9606615em;"><span style="top:-11.255581500000002em;"><span class="pstrut" style="height:3.72192em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.11em;"><span class="pstrut" style="height:3.050005em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8723309999999997em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.413777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">G</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span><span style="top:-3.280005em;"><span class="pstrut" style="height:3.050005em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.727005em;"><span class="pstrut" style="height:3.050005em;"></span><span class="mord"><span class="mord mathdefault">G</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.3537820000000003em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-6.879879499999999em;"><span class="pstrut" style="height:3.72192em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.72192em;"><span style="top:-2.11em;"><span class="pstrut" style="height:3.32144em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8723309999999997em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.413777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord mathdefault" style="margin-right:0.03588em;">Ï€</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0369199999999998em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mord mtight">/</span><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.55144em;"><span class="pstrut" style="height:3.32144em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-4.05644em;"><span class="pstrut" style="height:3.32144em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">Ï€</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7463142857142857em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9869199999999998em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mord mtight">/</span><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.625217em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-2.232742499999998em;"><span class="pstrut" style="height:3.72192em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.72192em;"><span style="top:-2.11em;"><span class="pstrut" style="height:3.050005em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">Ï€</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7463142857142857em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8723309999999997em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.413777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0369199999999998em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mord mtight">/</span><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.280005em;"><span class="pstrut" style="height:3.050005em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.785005em;"><span class="pstrut" style="height:3.050005em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">Ï€</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7463142857142857em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9869199999999998em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mord mtight">/</span><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.3537820000000003em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:2.0849595em;"><span class="pstrut" style="height:3.72192em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6639199999999998em;"><span style="top:-2.11em;"><span class="pstrut" style="height:3.050005em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8723309999999997em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.413777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0369199999999998em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mord mtight">/</span><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.280005em;"><span class="pstrut" style="height:3.050005em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.727005em;"><span class="pstrut" style="height:3.050005em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9869199999999998em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mord mtight">/</span><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.3537820000000003em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:8.4606615em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>ä½¿ç”¨pythonå¾—åˆ°äºŒç»´çš„é«˜æ–¯æ»¤æ³¢å™¨çš„ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gaussian_kernel_2d</span>(<span class="params">sigma, width</span>):</span></span><br><span class="line">    <span class="keyword">if</span> width == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> np.ones((<span class="number">1</span>, <span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">    kernel_radius = np.floor(width &gt;&gt; <span class="number">1</span>)</span><br><span class="line">    ax            = np.arange(-kernel_radius, kernel_radius + <span class="number">1.</span>, dtype=np.float32)</span><br><span class="line">    xx, yy        = np.meshgrid(ax, ax)</span><br><span class="line">    kernel        = np.exp(-(xx**<span class="number">2</span> + yy**<span class="number">2</span>) / (<span class="number">2.</span> * sigma**<span class="number">2</span>))</span><br><span class="line">    <span class="keyword">return</span> kernel / np.<span class="built_in">sum</span>(kernel)</span><br></pre></td></tr></table></figure>
<p>è¯¦ç»†ä»£ç å¯ä»¥å‚è€ƒ<a href="https://gitee.com/wangwei1237/wangwei1237/blob/master/2021/04/14/convolution-and-the-gaussian-convolution-kernel/gaussian_cov_kernel.ipynb">é«˜æ–¯æ»¤æ³¢å™¨çš„ç”Ÿæˆå’Œå¯è§†åŒ–</a>ã€‚</p>
<h2 id="æ»¤æ³¢å™¨çš„å¯åˆ†ç¦»ç‰¹æ€§">æ»¤æ³¢å™¨çš„å¯åˆ†ç¦»ç‰¹æ€§</h2>
<p>å›¾åƒå¤„ç†ä¸­çš„<strong>å¯åˆ†ç¦»æ»¤æ³¢å™¨</strong>(<em>separable filter</em>)å¯ä»¥å†™æˆä¸¤ä¸ªæ›´ç®€å•çš„æ»¤æ³¢å™¨çš„ä¹˜ç§¯ã€‚é€šå¸¸ï¼Œå¯ä»¥æŠŠäºŒç»´å·ç§¯è¿ç®—åˆ†ç¦»ä¸ºä¸¤ä¸ªä¸€ç»´æ»¤æ³¢å™¨ï¼Œä»è€Œé™ä½å›¾åƒçš„å·ç§¯è¿ç®—å¤æ‚åº¦ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå¯¹äº<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mo>Ã—</mo><mi>H</mi></mrow><annotation encoding="application/x-tex">W \times H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span></span></span></span>çš„å›¾åƒï¼Œå¦‚æœé‡‡ç”¨<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>Ã—</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">n \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span>çš„äºŒç»´æ»¤æ³¢å™¨ï¼Œåˆ™å·ç§¯è¿ç®—çš„å¤æ‚åº¦ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>M</mi><mo separator="true">â‹…</mo><mi>N</mi><mo separator="true">â‹…</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(MÂ·NÂ·n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>ï¼Œè€Œå¦‚æœç”¨ä¸¤ä¸ª<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>Ã—</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">1 \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span>çš„ä¸€ç»´æ»¤æ³¢å™¨ï¼Œåˆ™å·ç§¯è¿ç®—çš„å¤æ‚åº¦ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>2</mn><mi>M</mi><mo separator="true">â‹…</mo><mi>N</mi><mo separator="true">â‹…</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(2MÂ·NÂ·n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">2</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span>ã€‚<sup>[4]</sup></p>
<p>Karas Pavelå’ŒSvoboda Davidåœ¨<a href="https://www.intechopen.com/books/design-and-architectures-for-digital-signal-processing/algorithms-for-efficient-computation-of-convolution">Algorithms for Efficient Computation of Convolution</a><sup>[5]</sup>çš„<strong>3. Separable convolution</strong>éƒ¨åˆ†æŒ‡å‡ºï¼š</p>
<p>ç»™å®šä¸€ä¸ªè¡Œå‘é‡<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>u</mi><mo stretchy="true">â†’</mo></mover><mo>=</mo><mo stretchy="false">(</mo><msub><mi>u</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>u</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><msub><mi>u</mi><mi>m</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\overrightarrow{u}=(u_1,u_2,...u_m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9525600000000001em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">u</span></span></span><span class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width="400em" height="0.522em" viewbox="0 0 400000 522" preserveaspectratio="xMaxYMin slice"><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z"/></svg></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>å’Œä¸€ä¸ªåˆ—å‘é‡<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mover accent="true"><mi>v</mi><mo stretchy="true">â†’</mo></mover><mi>T</mi></msup><mo>=</mo><mo stretchy="false">(</mo><msub><mi>v</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>v</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>v</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\overrightarrow{v}^T=(v_1,v_2,...,v_n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9525600000000001em;vertical-align:0em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span><span class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width="400em" height="0.522em" viewbox="0 0 400000 522" preserveaspectratio="xMaxYMin slice"><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z"/></svg></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>ï¼Œåˆ™å…¶äºŒè€…çš„å·ç§¯å®šä¹‰ä¸ºï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mover accent="true"><mi>u</mi><mo stretchy="true">â†’</mo></mover><mo>âˆ—</mo><mover accent="true"><mi>v</mi><mo stretchy="true">â†’</mo></mover></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mover accent="true"><mi>v</mi><mo stretchy="true">â†’</mo></mover><mtext>Â </mtext><mover accent="true"><mi>u</mi><mo stretchy="true">â†’</mo></mover></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mrow><mo fence="true">(</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>v</mi><mn>1</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>v</mi><mn>2</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="normal">.</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="normal">.</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="normal">.</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>v</mi><mi>n</mi></msub></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow><mo>âˆ—</mo><mrow><mo fence="true">(</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>u</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>u</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>u</mi><mi>m</mi></msub></mrow></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mrow><mo fence="true">(</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>v</mi><mn>1</mn></msub><msub><mi>u</mi><mn>1</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>v</mi><mn>1</mn></msub><msub><mi>u</mi><mn>2</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>v</mi><mn>1</mn></msub><msub><mi>u</mi><mn>3</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>v</mi><mn>1</mn></msub><msub><mi>u</mi><mi>m</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>v</mi><mn>2</mn></msub><msub><mi>u</mi><mn>1</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>v</mi><mn>2</mn></msub><msub><mi>u</mi><mn>2</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>v</mi><mn>2</mn></msub><msub><mi>u</mi><mn>3</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>v</mi><mn>2</mn></msub><msub><mi>u</mi><mi>m</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>v</mi><mn>3</mn></msub><msub><mi>u</mi><mn>1</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>v</mi><mn>3</mn></msub><msub><mi>u</mi><mn>2</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>v</mi><mn>3</mn></msub><msub><mi>u</mi><mn>3</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>v</mi><mn>3</mn></msub><msub><mi>u</mi><mi>m</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="normal">.</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="normal">.</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="normal">.</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="normal">.</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="normal">.</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="normal">.</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="normal">.</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="normal">.</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>Â Â Â Â Â Â </mtext><mi mathvariant="normal">.</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="normal">.</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="normal">.</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="normal">.</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="normal">.</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>Â Â Â Â Â Â Â Â Â Â Â Â </mtext><mi mathvariant="normal">.</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="normal">.</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>v</mi><mi>n</mi></msub><msub><mi>u</mi><mn>1</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>v</mi><mi>n</mi></msub><msub><mi>u</mi><mn>2</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>v</mi><mi>n</mi></msub><msub><mi>u</mi><mn>3</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>v</mi><mi>n</mi></msub><msub><mi>u</mi><mi>m</mi></msub></mrow></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi mathvariant="bold">A</mi><mrow><mi>n</mi><mo>Ã—</mo><mi>m</mi></mrow></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
\overrightarrow{u}*\overrightarrow{v}&amp;=\overrightarrow{v}\ \overrightarrow{u} \\
&amp;=\begin{pmatrix}
v_1 \\
v_2 \\
. \\
. \\
. \\
v_n \end{pmatrix} * \begin{pmatrix} u_1, u_2, ..., u_m\end{pmatrix} \\
&amp;=\begin{pmatrix}
v_1u_1 &amp; v_1u_2 &amp; v_1u_3 &amp; ... &amp; v_1u_m \\
v_2u_1 &amp; v_2u_2 &amp; v_2u_3 &amp; ... &amp; v_2u_m \\
v_3u_1 &amp; v_3u_2 &amp; v_3u_3 &amp; ... &amp; v_3u_m \\
. &amp; . &amp; . &amp; . &amp; . \\
. &amp; . &amp; . &amp; \ \ \ \ \ \ . &amp; . \\
. &amp; . &amp; . &amp; \ \ \ \ \ \ \ \ \ \ \ \ . &amp; . \\
v_nu_1 &amp; v_nu_2 &amp; v_nu_3 &amp; ... &amp; v_nu_m
\end{pmatrix} \\
&amp;=\mathbf{A}_{n \times m}
\end{aligned}

</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:19.312780000000004em;vertical-align:-9.406390000000002em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:9.90639em;"><span style="top:-15.40389em;"><span class="pstrut" style="height:6.450060000000001em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">u</span></span></span><span class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width="400em" height="0.522em" viewbox="0 0 400000 522" preserveaspectratio="xMaxYMin slice"><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z"/></svg></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span><span class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width="400em" height="0.522em" viewbox="0 0 400000 522" preserveaspectratio="xMaxYMin slice"><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z"/></svg></span></span></span></span></span></span></span></span><span style="top:-10.89384em;"><span class="pstrut" style="height:6.450060000000001em;"></span><span class="mord"></span></span><span style="top:-2.7937299999999983em;"><span class="pstrut" style="height:6.450060000000001em;"></span><span class="mord"></span></span><span style="top:2.296330000000001em;"><span class="pstrut" style="height:6.450060000000001em;"></span><span class="mord"></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:9.406390000000002em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:9.90639em;"><span style="top:-15.40389em;"><span class="pstrut" style="height:6.450060000000001em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span><span class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width="400em" height="0.522em" viewbox="0 0 400000 522" preserveaspectratio="xMaxYMin slice"><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z"/></svg></span></span></span></span></span></span><span class="mspace">Â </span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">u</span></span></span><span class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width="400em" height="0.522em" viewbox="0 0 400000 522" preserveaspectratio="xMaxYMin slice"><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z"/></svg></span></span></span></span></span></span></span></span><span style="top:-10.89384em;"><span class="pstrut" style="height:6.450060000000001em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.8500500000000004em;"><span style="top:-0.44997000000000076em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â</span></span></span><span style="top:-1.5999800000000008em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-2.1949900000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-2.7900000000000005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-3.3850100000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-3.9800200000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-4.57503em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-4.61003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-5.85005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â›</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:3.3500499999999995em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.850000000000001em;"><span style="top:-6.010000000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.810000000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.6100000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">.</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">.</span></span></span><span style="top:-1.2100000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">.</span></span></span><span style="top:-0.009999999999999953em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:3.35em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.8500500000000004em;"><span style="top:-0.44997000000000076em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â </span></span></span><span style="top:-1.5999800000000008em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-2.1949900000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-2.7900000000000005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-3.3850100000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-3.9800200000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-4.57503em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-4.61003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-5.85005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:3.3500499999999995em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span><span style="top:-2.7937299999999983em;"><span class="pstrut" style="height:6.450060000000001em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.450060000000001em;"><span style="top:0.1500399999999994em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â</span></span></span><span style="top:-0.9999700000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-1.5949800000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-2.1899900000000008em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-2.7850000000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-3.3800100000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-3.97502em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-4.57003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-5.16504em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-5.210040000000001em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âœ</span></span></span><span style="top:-6.450060000000001em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â›</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:3.9500599999999997em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.450000000000001em;"><span style="top:-6.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-5.410000000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.210000000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.0100000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">.</span></span></span><span style="top:-1.8100000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">.</span></span></span><span style="top:-0.6100000000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">.</span></span></span><span style="top:0.5900000000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:3.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.450000000000001em;"><span style="top:-6.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-5.410000000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.210000000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.0100000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">.</span></span></span><span style="top:-1.8100000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">.</span></span></span><span style="top:-0.6100000000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">.</span></span></span><span style="top:0.5900000000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:3.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.450000000000001em;"><span style="top:-6.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-5.410000000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.210000000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.0100000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">.</span></span></span><span style="top:-1.8100000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">.</span></span></span><span style="top:-0.6100000000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">.</span></span></span><span style="top:0.5900000000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:3.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.450000000000001em;"><span style="top:-6.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span></span></span><span style="top:-5.410000000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span></span></span><span style="top:-4.210000000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span></span></span><span style="top:-3.0100000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">.</span></span></span><span style="top:-1.8100000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mspace">Â </span><span class="mspace">Â </span><span class="mspace">Â </span><span class="mspace">Â </span><span class="mspace">Â </span><span class="mspace">Â </span><span class="mord">.</span></span></span><span style="top:-0.6100000000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mspace">Â </span><span class="mspace">Â </span><span class="mspace">Â </span><span class="mspace">Â </span><span class="mspace">Â </span><span class="mspace">Â </span><span class="mspace">Â </span><span class="mspace">Â </span><span class="mspace">Â </span><span class="mspace">Â </span><span class="mspace">Â </span><span class="mspace">Â </span><span class="mord">.</span></span></span><span style="top:0.5900000000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:3.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.450000000000001em;"><span style="top:-6.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-5.410000000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.210000000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.0100000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">.</span></span></span><span style="top:-1.8100000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">.</span></span></span><span style="top:-0.6100000000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">.</span></span></span><span style="top:0.5900000000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:3.95em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.450060000000001em;"><span style="top:0.1500399999999994em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â </span></span></span><span style="top:-0.9999700000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-1.5949800000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-2.1899900000000008em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-2.7850000000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-3.3800100000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-3.97502em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-4.57003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-5.16504em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-5.210040000000001em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>âŸ</span></span></span><span style="top:-6.450060000000001em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:3.9500599999999997em;"><span></span></span></span></span></span></span></span></span></span><span style="top:2.296330000000001em;"><span class="pstrut" style="height:6.450060000000001em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">A</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.25833100000000003em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">Ã—</span><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:9.406390000000002em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>å¹¶ä¸”ï¼Œå½“ä¸”ä»…å½“çŸ©é˜µ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">A</mi><mrow><mi>n</mi><mo>Ã—</mo><mi>m</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathbf{A}_{n \times m}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.894441em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">A</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.25833100000000003em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">Ã—</span><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span>çš„ç§©<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo stretchy="false">(</mo><mi mathvariant="bold">A</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">r(\mathbf{A})=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">A</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>æ—¶ï¼Œæ»¤æ³¢å™¨æ‰æ˜¯å¯åˆ†ç¦»çš„æ»¤æ³¢å™¨ã€‚Gaussianæ»¤æ³¢å™¨å’ŒSobelæ»¤æ³¢å™¨å°±æ˜¯è¿™ç§å¯åˆ†ç¦»çš„æ»¤æ³¢å™¨ã€‚</p>
<p>åˆ©ç”¨è¿™ä¸ªç‰¹æ€§ï¼Œå¯¹äºäºŒç»´é«˜æ–¯æ»¤æ³¢å™¨<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">h(x,y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span>è€Œè¨€ï¼Œæˆ‘ä»¬å°†å…¶åˆ†ç¦»æˆä¸¤ä¸ªä¸€ç»´æ»¤æ³¢å™¨ã€‚å¯¹å›¾åƒçš„äºŒç»´å·ç§¯è¿ç®—ä»è€Œç®€åŒ–ä¸ºå¯¹å›¾åƒçš„ä¸¤æ¬¡ä¸€ç»´å·ç§¯ï¼Œå…·ä½“å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>h</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo stretchy="false">(</mo><msub><mi>h</mi><mi>x</mi></msub><mo>âˆ—</mo><msub><mi>h</mi><mi>y</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mo stretchy="false">(</mo><mi>f</mi><mo>âˆ—</mo><mi>h</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>f</mi><mo>âˆ—</mo><mo stretchy="false">(</mo><msub><mi>h</mi><mi>x</mi></msub><mo>âˆ—</mo><msub><mi>h</mi><mi>y</mi></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo stretchy="false">(</mo><mi>f</mi><mo>âˆ—</mo><msub><mi>h</mi><mi>x</mi></msub><mo stretchy="false">)</mo><mo>âˆ—</mo><msub><mi>f</mi><mi>y</mi></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
h(x,y) &amp;= (h_x * h_y)(x) \\
(f*h)(x,y) &amp;= f*(h_x * h_y) \\
&amp;=(f*h_x)*f_y
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.500000000000002em;vertical-align:-2.000000000000001em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5000000000000004em;"><span style="top:-4.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">h</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span><span style="top:-1.6599999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.000000000000001em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5000000000000004em;"><span style="top:-4.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-1.6599999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.000000000000001em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>åŒæ—¶ï¼Œåˆ©ç”¨å¦‚ä¸Šçš„ç‰¹æ€§ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åˆ©ç”¨ä¸€ç»´é«˜æ–¯æ»¤æ³¢å™¨çš„ç»“æœç”ŸæˆäºŒç»´é«˜æ–¯æ»¤æ³¢å™¨ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gaussian_kernel_2d_acc</span>(<span class="params">self</span>):</span></span><br><span class="line">    <span class="keyword">if</span> self.width == <span class="number">1</span>:</span><br><span class="line">        self.kernel = np.ones((<span class="number">1</span>, <span class="number">1</span>))</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line">    self.gaussian_kernel_1d()</span><br><span class="line">    k = self.kernel</span><br><span class="line">    self.kernel = k.reshape(self.width,<span class="number">1</span>) * k.reshape(<span class="number">1</span>,self.width)</span><br></pre></td></tr></table></figure>
<p>æ›´è¯¦ç»†çš„ä»£ç å¯ä»¥å‚è€ƒ<a href="https://gitee.com/wangwei1237/wangwei1237/blob/master/2021/04/14/convolution-and-the-gaussian-convolution-kernel/gaussian_cov_kernel_acc.ipynb">é«˜æ–¯æ»¤æ³¢å™¨çš„ç”Ÿæˆ</a>ã€‚</p>
<h2 id="å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</h2>
<p>[1]: å›¾åƒå¤„ç†ã€åˆ†æä¸æœºå™¨è§†è§‰ï¼ˆç¬¬4ç‰ˆï¼‰<br>
[2]: <a href="https://www.zhihu.com/question/22298352">å¦‚ä½•é€šä¿—æ˜“æ‡‚çš„è§£é‡Šå·ç§¯ï¼Ÿ</a><br>
[3]: <a href="http://www.ruanyifeng.com/blog/2012/11/gaussian_blur.html">é«˜æ–¯æ¨¡ç³Šçš„ç®—æ³•</a><br>
[4]: <a href="https://en.wikipedia.org/wiki/Separable_filter">separable filter</a><br>
[5]: Karas Pavel and Svoboda David (January 16th 2013). Algorithms for Efficient Computation of Convolution, Design and Architectures for Digital Signal Processing, Gustavo Ruiz and Juan A. Michell, IntechOpen, DOI: 10.5772/51942. Available from: <a href="https://www.intechopen.com/books/design-and-architectures-for-digital-signal-processing/algorithms-for-efficient-computation-of-convolution">https://www.intechopen.com/books/design-and-architectures-for-digital-signal-processing/algorithms-for-efficient-computation-of-convolution</a></p>
]]></content>
      <categories>
        <category>ç®—æ³•ä¸æ•°å­¦</category>
      </categories>
      <tags>
        <tag>å·ç§¯</tag>
        <tag>é«˜æ–¯æ»¤æ³¢å™¨</tag>
        <tag>å›¾åƒæ»¤æ³¢</tag>
      </tags>
  </entry>
  <entry>
    <title>å¦‚ä½•åœ¨MacOSä¸‹ç¼–è¯‘vmafå¹¶è®­ç»ƒè‡ªå·±çš„æ¨¡å‹</title>
    <url>/2021/03/24/how-to-complie-VMAF-for-the-MacOS/</url>
    <content><![CDATA[<p><a href="https://github.com/Netflix/vmaf">VMAF</a>æ˜¯Netflixå¼€å‘çš„ã€ç”¨äºè¯„ä¼°è§†é¢‘æ„ŸçŸ¥è´¨é‡çš„ç®—æ³•ã€‚VMAFåŒ…æ‹¬ä¸€ä¸ªç‹¬ç«‹çš„Cè¯­è¨€åº“libvmafåŠå…¶å¯¹è¯¥åº“çš„PythonåŒ…è£…ã€‚åœ¨Pythonåº“ä¸­ï¼Œè¿˜æä¾›äº†ä¸€ç»„å·¥å…·ï¼Œä»¥æ–¹ä¾¿ç”¨æˆ·å¯ä»¥è®­ç»ƒå’Œæµ‹è¯•è‡ªå®šä¹‰çš„VMAFæ¨¡å‹ã€‚ç›®å‰ä¸ºæ­¢ï¼Œåœ¨å·¥ä¸šå®è·µä¸­ï¼ŒVMAFæ˜¯è§†é¢‘è´¨é‡è¯„ä¼°é¢†åŸŸä¸­æœ€ä¼˜ç§€çš„å…¨å‚è€ƒè¯„ä¼°ç®—æ³•ã€‚</p>
<p>ä½†æ˜¯ï¼Œåœ¨MacOSä¸Šç¼–è¯‘å¹¶ä½¿ç”¨VMAFçš„è¿‡ç¨‹ä¸­ï¼Œå‘ç°ä¼šæœ‰ä¸€äº›é—®é¢˜å¯¼è‡´æ— æ³•ç¼–è¯‘æˆåŠŸï¼Œå¹¶ä¸”å’Œæ¨¡å‹è®­ç»ƒç›¸å…³çš„pythonä»£ç ä¹Ÿå­˜åœ¨æŸäº›å°çš„å†²çªï¼Œå¯¼è‡´åœ¨æ•´ä¸ªæ¨¡å‹è®­ç»ƒçš„è¿‡ç¨‹ä¼šå‡ºç°æŸäº›å¼‚å¸¸ã€‚</p>
<p>æœ¬æ–‡å°±æ˜¯å¯¹è‡ªå·±åœ¨è°ƒè¯•è¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜çš„æ€»ç»“ã€‚</p>
<p><img src="/2021/03/24/how-to-complie-VMAF-for-the-MacOS/1.jpeg" alt></p>
<span id="more"></span>
<p>æˆ‘æ‰€ä½¿ç”¨çš„VMAFçš„ç‰ˆæœ¬ä¸ºcommit idä¸º<a href="https://github.com/Netflix/vmaf/commit/6f1f0c98845e4e9c34ae0bdfa00aee5c91fa6e0c">6f1f0c98</a>çš„è¿™æ¬¡æäº¤ã€‚é‡åˆ°çš„æ‰€æœ‰é—®é¢˜ä¹Ÿéƒ½æ˜¯åŸºäºè¿™æ¬¡æäº¤ï¼Œè¿™ä¸€ç‚¹è¦é¢å¤–æ³¨æ„ã€‚ä¸»è¦è§£å†³çš„é—®é¢˜å’Œå…·ä½“çš„è§£å†³æ–¹æ³•å¯ä»¥å‚è€ƒæ–‡ç« æ¥ä¸‹æ¥çš„éƒ¨åˆ†ã€‚</p>
<h2 id="libvmaf-test-toolsé“¾æ¥é—®é¢˜">libvmaf test/toolsé“¾æ¥é—®é¢˜</h2>
<p>åœ¨ç¼–è¯‘libvmafçš„<code>C</code>åº“çš„æ—¶å€™ï¼Œå‘ç°å½“ç¼–è¯‘<code>test</code>å’Œ<code>tools</code>ç›®å½•ä¸‹çš„æ–‡ä»¶æ—¶ï¼Œä¼šå‡ºç°å¼‚å¸¸ã€‚</p>
<p>ç»è¿‡æ’æŸ¥ä»¥åï¼Œå‘ç°æ˜¯å¯¹åº”çš„ç¼–è¯‘äº§å‡ºçš„é“¾æ¥åº“å‡ºç°äº†å¼‚å¸¸ã€‚åœ¨ç¼–è¯‘æ—¶ï¼Œå¦‚æœé…ç½®<code>default_library</code>ä¸º<code>both</code>ï¼Œåˆ™ä¼šäº§å‡ºlibvmafçš„é™æ€é“¾æ¥åº“å’ŒåŠ¨æ€é“¾æ¥åº“ï¼Œå¹¶ä¸”åœ¨äº§å‡º<code>test</code>å’Œ<code>tools</code>ç›¸å…³å¯¹è±¡æ—¶ï¼Œä¼šä¼˜å…ˆé€‰æ‹©é‡‡ç”¨é™æ€é“¾æ¥åº“è¿›è¡Œé“¾ç¼–ã€‚å…·ä½“å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">vmaf &#x3D; executable(</span><br><span class="line">    &#39;vmaf&#39;,</span><br><span class="line">    ...</span><br><span class="line">    link_with : get_option(&#39;default_library&#39;) &#x3D;&#x3D; &#39;both&#39; ? libvmaf.get_static_lib() : libvmaf,</span><br><span class="line">    ...</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>ä¸ç¡®å®šä¸ºä»€ä¹ˆè¿™é‡Œé‡‡ç”¨é™æ€é“¾æ¥åº“æ—¶ä¼šå‡ºç°å¼‚å¸¸ï¼Œä½†æ˜¯æŠŠé™æ€é“¾æ¥åº“æ”¹æˆåŠ¨æ€é“¾æ¥åº“ä¹‹åï¼Œæ•´ä¸ªå·¥ç¨‹å°±å¯ä»¥æˆåŠŸç¼–è¯‘äº†ã€‚è‡³äºåŸå› ï¼Œç­‰æœ‰æ—¶é—´å†ä»”ç»†å®šä½ä¸€ä¸‹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">vmaf &#x3D; executable(</span><br><span class="line">    &#39;vmaf&#39;,</span><br><span class="line">    ...</span><br><span class="line">    link_with : libvmaf,</span><br><span class="line">    ...</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h2 id="libsvmåº“çš„è·¯å¾„è®¾ç½®é—®é¢˜">libsvmåº“çš„è·¯å¾„è®¾ç½®é—®é¢˜</h2>
<p>åœ¨ä½¿ç”¨pythonç›®å½•ä¸‹æä¾›çš„ç›¸å…³å·¥å…·è¿›è¡Œæ¨¡å‹è®­ç»ƒçš„æ—¶å€™ï¼Œæœ€ç»ˆä¼šä½¿ç”¨<code>python/vmaf/svmutil.py</code>æ¥å®ç°å¯¹<code>libsvm</code>åº“çš„è°ƒç”¨ï¼Œè¿›è€Œæ ¹æ®è®­ç»ƒæ•°æ®äº§å‡º<code>SVM</code>çš„æ¨¡å‹æ–‡ä»¶ã€‚</p>
<p>ä½†æ˜¯ï¼Œåœ¨<code>svmutil.py</code>ä¸­ä¼šé…ç½®<code>libsvm</code>åº“çš„è·¯å¾„ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™ä¸ªè·¯å¾„çš„é…ç½®å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">libsvm_path &#x3D; VmafConfig.root_path(&#39;third_party&#39;, &#39;libsvm&#39;, &#39;python&#39;)</span><br></pre></td></tr></table></figure>
<p>è€Œå®é™…ä¸Šï¼Œåœ¨æˆ‘æ‰€ç¼–è¯‘çš„æœºå™¨ä¸Šï¼Œä½¿ç”¨<code>pip3 install libsvm</code>ä¹‹åï¼Œ<code>libsvm</code>çš„è·¯å¾„å¹¶éæ˜¯å¦‚ä¸ŠæŒ‡å®šçš„è·¯å¾„ï¼Œå› æ­¤ä¼šå¯¼è‡´åœ¨è°ƒç”¨<code>libsvm</code>æ—¶å‡ºç°å¼‚å¸¸ï¼Œæ ¹æ®è‡ªå·±ç¼–è¯‘æœºå™¨çš„å…·ä½“æƒ…å†µï¼Œä¿®æ”¹<code>libsvm_path</code>çš„è·¯å¾„å³å¯è§£å†³é—®é¢˜ï¼Œå…·ä½“å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">libsvm_path &#x3D; VmafConfig.root_path(&#39;site-packages&#39;, &#39;libsvm&#39;)</span><br></pre></td></tr></table></figure>
<h2 id="matplotlibä¸­è®¾ç½®backendä¸ºaggå¸¦æ¥çš„é—®é¢˜">Matplotlibä¸­è®¾ç½®backendä¸ºaggå¸¦æ¥çš„é—®é¢˜</h2>
<p>å…³äºMatplotlibä¸­çš„backendç›¸å…³çš„é—®é¢˜ï¼Œæ­¤å¤„ä¸å†è¯¦ç»†å±•å¼€ï¼Œå…·ä½“å¯ä»¥å‚è§<a href="/2020/04/28/Matplotlib-s-backends-and-non-interactive-backends-for-rendering/">matplotlibçš„backendsä»¥åŠéäº¤äº’å¼ç»˜å›¾</a>ã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œåœ¨vmafä¸­ï¼ŒMatplotlibçš„backendä¼šè®¾ç½®ä¸ºaggæ¨¡å¼ã€‚ä¾‹å¦‚ï¼Œåœ¨<a href="https://github.com/Netflix/vmaf/blob/master/python/vmaf/script/run_vmaf_training.py">python/vmaf/script/run_vmaf_training.py</a>ä¸­ï¼Œå°±è¿›è¡Œäº†ç›¸å…³çš„é…ç½®ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#!&#x2F;usr&#x2F;bin&#x2F;env python3</span><br><span class="line"></span><br><span class="line">import matplotlib</span><br><span class="line">matplotlib.use(&#39;Agg&#39;)</span><br></pre></td></tr></table></figure>
<p>åœ¨ä½¿ç”¨<code>libsvm</code>è®­ç»ƒå®Œæ¨¡å‹ä¹‹åï¼Œä¼šå¯¹VMAFçš„<code>SRCC</code>ï¼Œ<code>PCC</code>ç­‰æŒ‡æ ‡è¿›è¡Œè®¡ç®—ï¼Œå¹¶åˆ©ç”¨<code>python/vmaf/config.py</code>ä¸­çš„<code>DisplayConfig.show()</code>æœ€ç»ˆè°ƒç”¨<code>matplotlib</code>æ¥è¿›è¡Œç»“æœçš„å¯è§†åŒ–å±•ç°ã€‚ä½†æ˜¯ï¼Œåœ¨<code>DisplayConfig.show()</code>ä¸­ï¼Œå´æ˜¯ä½¿ç”¨æ˜¯å¦å­˜åœ¨å‚æ•°<code>write_to_dir</code>æ¥åˆ¤æ–­è°ƒç”¨ä»€ä¹ˆ<code>backends</code>ï¼Œè¿™å°±ä¼šå’Œä¹‹å‰çš„<code>Agg</code>é…ç½®å‡ºç°å†²çªï¼Œå› æ­¤è¿™é‡Œéœ€è¦åšä¸€ä¸ªç®€å•çš„å‡çº§ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> matplotlib.rcParams[<span class="string">&#x27;backend&#x27;</span>] == <span class="string">&#x27;agg&#x27;</span>:</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;write_to_dir&#x27;</span> <span class="keyword">in</span> kwargs:</span><br><span class="line">        <span class="built_in">format</span> = kwargs[<span class="string">&#x27;format&#x27;</span>] <span class="keyword">if</span> <span class="string">&#x27;format&#x27;</span> <span class="keyword">in</span> kwargs <span class="keyword">else</span> <span class="string">&#x27;png&#x27;</span></span><br><span class="line">        filedir = kwargs[<span class="string">&#x27;write_to_dir&#x27;</span>] <span class="keyword">if</span> kwargs[<span class="string">&#x27;write_to_dir&#x27;</span>] <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">else</span> VmafConfig.workspace_path(<span class="string">&#x27;output&#x27;</span>)</span><br><span class="line">        os.makedirs(filedir, exist_ok=<span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">for</span> fignum <span class="keyword">in</span> plt.get_fignums():</span><br><span class="line">            fig = plt.figure(fignum)</span><br><span class="line">            fig.savefig(os.path.join(filedir, <span class="built_in">str</span>(fignum) + <span class="string">&#x27;.&#x27;</span> + <span class="built_in">format</span>), <span class="built_in">format</span>=<span class="built_in">format</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">format</span> = <span class="string">&#x27;png&#x27;</span></span><br><span class="line">        filedir = VmafConfig.workspace_path(<span class="string">&#x27;output&#x27;</span>)</span><br><span class="line">        os.makedirs(filedir, exist_ok=<span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">for</span> fignum <span class="keyword">in</span> plt.get_fignums():</span><br><span class="line">            fig = plt.figure(fignum)</span><br><span class="line">            fig.savefig(os.path.join(filedir, <span class="built_in">str</span>(fignum) + <span class="string">&#x27;.&#x27;</span> + <span class="built_in">format</span>), <span class="built_in">format</span>=<span class="built_in">format</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    plt.show()</span><br></pre></td></tr></table></figure>
<p>å®é™…ä¸Šï¼Œåªæœ‰åœ¨MacOSä¸Šæ‰ä¼šå‡ºç°è¯¥é—®é¢˜ï¼Œå› æ­¤æ›´åˆç†çš„æ–¹å¼æ˜¯æ ¹æ®ç³»ç»Ÿæ¥è®¾ç½®Matplotlibçš„backendsï¼Œè€Œä¸æ˜¯ç›´æ¥ä¿®æ”¹Configç±»ã€‚å…·ä½“å¯ä»¥å‚è€ƒ<a href="https://github.com/Netflix/vmaf/pull/852">è¿™é‡Œçš„è®¨è®º</a>ã€‚</p>
<h2 id="libvmafçš„ç‰¹å¾å’Œpythonä¸­ä½¿ç”¨çš„ç‰¹å¾çš„å·®å¼‚">libvmafçš„ç‰¹å¾å’Œpythonä¸­ä½¿ç”¨çš„ç‰¹å¾çš„å·®å¼‚</h2>
<h4 id="libvmafç§å„ç‰¹å¾çš„ç±»å‹">libvmafç§å„ç‰¹å¾çš„ç±»å‹</h4>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œç¼–è¯‘å‡ºæ¥çš„libvmafåº“ä½¿ç”¨çš„æ˜¯integerç±»å‹çš„ç‰¹å¾ï¼Œå…·ä½“å¦‚<code>meson_option.txt</code>æ‰€ç¤ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">option(&#39;enable_float&#39;,</span><br><span class="line">    type: &#39;boolean&#39;,</span><br><span class="line">    value: false,</span><br><span class="line">    description: &#39;Compile floating-point feature extractors into the library&#39;)</span><br></pre></td></tr></table></figure>
<h4 id="pythonè®­ç»ƒæ¨¡å‹æ—¶å„ç‰¹å¾çš„ç±»å‹">pythonè®­ç»ƒæ¨¡å‹æ—¶å„ç‰¹å¾çš„ç±»å‹</h4>
<p>åœ¨ä½¿ç”¨pythonæ¥è®­ç»ƒæ¨¡å‹æ—¶ï¼Œä¼šæ ¹æ®<code>run_vmaf_training.py</code>æŒ‡å®šçš„ç‰¹å¾æ–‡ä»¶æ¥ç¡®å®šæ˜¯æŠ½å–<code>float</code>ç±»å‹çš„ç‰¹å¾è¿˜æ˜¯<code>integer</code>ç±»å‹çš„ç‰¹å¾ã€‚</p>
<p>å½“<code>feature_dict</code>çš„keyä¸º<code>VMAF_integer_feature</code>æ—¶ï¼Œåˆ™æŠ½å–çš„æ˜¯<code>integer</code>ç±»å‹çš„ç‰¹å¾ï¼Œå½“keyä¸º<code>VMAF_feature</code>æ—¶ï¼ŒæŠ½å–çš„ä¸º<code>float</code>ç±»å‹çš„ç‰¹å¾ã€‚å…·ä½“çš„åˆ¤æ–­é€»è¾‘ä½äº<a href="https://github.com/Netflix/vmaf/blob/master/python/vmaf/core/feature_assembler.py">feature_assembler.py</a>ä¸­çš„<code>FeatureAssembler.run()</code>ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27; æŠ½å–å„ç‰¹å¾çš„integerç±»å‹ç‰¹å¾</span></span><br><span class="line"><span class="string">feature_dict = &#123;</span></span><br><span class="line"><span class="string">    &#x27;VMAF_integer_feature&#x27;: [&#x27;vif_scale0&#x27;, </span></span><br><span class="line"><span class="string">                             &#x27;vif_scale1&#x27;, </span></span><br><span class="line"><span class="string">                             &#x27;vif_scale2&#x27;, </span></span><br><span class="line"><span class="string">                             &#x27;vif_scale3&#x27;, </span></span><br><span class="line"><span class="string">                             &#x27;adm2&#x27;, </span></span><br><span class="line"><span class="string">                             &#x27;motion&#x27;]</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span> æŠ½å–å„ç‰¹å¾çš„<span class="built_in">float</span>ç±»å‹ç‰¹å¾</span><br><span class="line">feature_dict = &#123;</span><br><span class="line">    <span class="string">&#x27;VMAF_feature&#x27;</span>: [<span class="string">&#x27;vif_scale0&#x27;</span>, </span><br><span class="line">                             <span class="string">&#x27;vif_scale1&#x27;</span>, </span><br><span class="line">                             <span class="string">&#x27;vif_scale2&#x27;</span>, </span><br><span class="line">                             <span class="string">&#x27;vif_scale3&#x27;</span>, </span><br><span class="line">                             <span class="string">&#x27;adm2&#x27;</span>, </span><br><span class="line">                             <span class="string">&#x27;motion&#x27;</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="ä¿æŒlibvmafå’Œpythonçš„å¯¹åº”">ä¿æŒlibvmafå’Œpythonçš„å¯¹åº”</h4>
<p>å› æ­¤ï¼Œåœ¨è‡ªå·±è®­ç»ƒæ¨¡å‹çš„æ—¶å€™è¦ç‰¹åˆ«æ³¨æ„ï¼šåŠ¡å¿…ä¿è¯libvmafå’Œpythonä¸¤å¤„çš„ç‰¹å¾ç±»å‹å¿…é¡»å¯¹åº”èµ·æ¥ã€‚</p>
<ol>
<li>
<p>å¯ä»¥ä¿®æ”¹<code>meson_option.txt</code>çš„é…ç½®ï¼Œè®©<code>libvmaf</code>çš„floatç±»å‹çš„ç‰¹å¾ç”Ÿæ•ˆï¼Œæ­¤æ—¶éœ€è¦ä½¿ç”¨<code>feature_dict['VMAF_feature']</code>æ¥è®­ç»ƒæ¨¡å‹ã€‚</p>
 <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">option(&#39;enable_float&#39;,</span><br><span class="line">    type: &#39;boolean&#39;,</span><br><span class="line">    value: true,</span><br><span class="line">    description: &#39;Compile floating-point feature extractors into the library&#39;)</span><br></pre></td></tr></table></figure>
<p>å¦‚ä¸Šçš„æ‰€æœ‰æ”¹åŠ¨ï¼Œå¯ä»¥å‚è€ƒ<a href="update.diff">update.diff</a>ã€‚</p>
</li>
<li>
<p>å½“ç„¶ï¼Œä¹Ÿå¯ä»¥åœ¨ç¼–è¯‘çš„æ—¶å€™ä½¿ç”¨<code>-Denable_float=true</code>æ¥å¼€å¯floatç±»å‹çš„ç‰¹å¾æ”¯æŒã€‚</p>
 <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">meson setup build -Denable_float&#x3D;true</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>ä½¿ç”¨<code>feature_dict['VMAF_integer_feature']</code>æ¥è®­ç»ƒæ¨¡å‹ï¼Œæ­¤æ—¶ä¸éœ€è¦ä¿®æ”¹libvmafçš„ç¼–è¯‘è„šæœ¬ã€‚ä½†æ˜¯éœ€è¦ä¿®æ”¹<a href="https://github.com/Netflix/vmaf/blob/master/python/vmaf/core/feature_extractor.py">feature_extractor.py</a>ï¼Œå°†<code>VmafIntegerFeatureExtractor</code>ç±»ä¸­çš„<code>float_ansnr</code>ç‰¹å¾å»æ‰ã€‚å…·ä½“å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
 <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ExternalProgramCaller.call_vmafexec_multi_features(</span><br><span class="line">    [&#39;adm&#39;, &#39;vif&#39;, &#39;motion&#39;],</span><br><span class="line">    yuv_type, ref_path, dis_path, w, h, log_file_path, logger, options&#x3D;&#123;</span><br><span class="line">        &#39;adm&#39;: &#123;&#39;debug&#39;: True&#125;,</span><br><span class="line">        &#39;vif&#39;: &#123;&#39;debug&#39;: True&#125;,</span><br><span class="line">        &#39;motion&#39;: &#123;&#39;debug&#39;: True&#125;,</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
</li>
</ol>
]]></content>
      <categories>
        <category>IVQA</category>
      </categories>
      <tags>
        <tag>VMAF</tag>
      </tags>
  </entry>
  <entry>
    <title>VIFè´¨é‡è¯„ä¼°æ–¹æ³•ç®€ä»‹</title>
    <url>/2021/03/05/intoduction-to-VIF/</url>
    <content><![CDATA[<p>è§†è§‰ä¿¡æ¯ä¿çœŸåº¦ï¼ˆVIFï¼‰æ˜¯åŸºäº<a href="https://en.wikipedia.org/wiki/Scene_statistics">è‡ªç„¶åœºæ™¯ç»Ÿè®¡ï¼ˆ<em>natural scene statistics</em>ï¼‰</a>å’Œ<a href="https://wangwei1237.gitee.io/digital-video-concept/docs/2_2_0_TheHumanVisualSystem.html">äººç±»è§†è§‰ç³»ç»Ÿï¼ˆ<em>human visual system</em>ï¼‰</a>æå–å›¾åƒä¿¡æ¯çš„ä¸€ç§å…¨å‚è€ƒçš„å›¾åƒè´¨é‡è¯„ä¼°æŒ‡æ ‡ï¼Œå¹¶ä¸”ä¸äººç±»å¯¹è§†è§‰è´¨é‡çš„åˆ¤æ–­å…·æœ‰è‰¯å¥½çš„ç›¸å…³æ€§ã€‚</p>
<p>2006å¹´ï¼ŒHamid R Sheikhå’ŒAlan Bovikåœ¨å¾·å…‹è¨æ–¯å¤§å­¦å¥¥æ–¯æ±€åˆ†æ ¡çš„å›¾åƒå’Œè§†é¢‘å·¥ç¨‹å®éªŒå®¤ï¼ˆ<em>LIVE: Laboratory for Image and Video Engineering</em>ï¼‰æå‡ºäº†<a href="https://live.ece.utexas.edu/research/Quality/VIF.htm">VIFç®—æ³•</a>ã€‚</p>
<p><img src="/2021/03/05/intoduction-to-VIF/1.gif" alt></p>
<span id="more"></span>
<h2 id="èƒŒæ™¯çŸ¥è¯†">èƒŒæ™¯çŸ¥è¯†</h2>
<h4 id="è‡ªç„¶åœºæ™¯ç»Ÿè®¡-nss-natural-scene-statistics">è‡ªç„¶åœºæ™¯ç»Ÿè®¡ï¼ˆ<em>NSS: natural scene statistics</em>ï¼‰</h4>
<p>ä½¿ç”¨å¯ä»¥åœ¨å…‰è°±èŒƒå›´å†…è¿›è¡Œæ“ä½œçš„é«˜è´¨é‡çš„<strong>æ•è·è®¾å¤‡</strong>ï¼ˆçº¢å¤–æ‹æ‘„ä»ªã€ç›¸æœºç­‰ï¼‰è€Œè·å–åˆ°çš„<strong>è§†è§‰ç¯å¢ƒ</strong>çš„å›¾åƒå’Œè§†é¢‘ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºè‡ªç„¶åœºæ™¯ã€‚å› æ­¤ï¼Œå½“æˆ‘ä»¬æåˆ°æœ¯è¯­<code>è‡ªç„¶åœºæ™¯(NS:natural scene)</code>çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸€èˆ¬æŒ‡çš„å°±æ˜¯æˆ‘ä»¬æ‰€æ‹æ‘„çš„ï¼Œæˆ‘ä»¬æ‰€å¤„çš„ï¼Œè¿™ä¸ªä¸–ç•Œçš„ç…§ç‰‡æˆ–è§†é¢‘ã€‚è¿™ä¸å…¶ä»–ç±»å‹çš„ä¿¡æ¯å®Œå…¨ä¸åŒï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>æ–‡æœ¬</li>
<li>è®¡ç®—æœºç”Ÿæˆçš„å›¾å½¢</li>
<li>å¡é€šæˆ–è€…åŠ¨ç”»</li>
<li>ç»˜ç”»æˆ–è€…ç»˜å›¾</li>
<li>éšæœºå™ªå£°</li>
<li>åˆ©ç”¨<code>nonvisual stimuli</code>ç”Ÿæˆçš„å›¾åƒæˆ–è€…è§†é¢‘ï¼Œä¾‹å¦‚é›·è¾¾ã€å£°å‘ã€X-raysã€è¶…å£°æˆåƒæŠ€æœ¯ç­‰</li>
</ul>
<p><code>è‡ªç„¶åœºæ™¯</code>æ„æˆäº†æ‰€æœ‰ç±»å‹çš„å›¾åƒé›†åˆä¸­çš„æå°çš„å­é›†ã€‚</p>
<p><code>åœºæ™¯ç»Ÿè®¡</code>æ˜¯æ„ŸçŸ¥é¢†åŸŸä¸­çš„ä¸€é—¨å­¦ç§‘ã€‚åœºæ™¯ç»Ÿè®¡æ¶‰åŠåˆ°ä¸åœºæ™¯æœ‰å…³çš„ç»Ÿè®¡è§„å¾‹ï¼Œå¹¶åŸºäºå¦‚ä¸‹çš„å‰æï¼šè®¾è®¡ä¸€ä¸ªæ„ŸçŸ¥ç³»ç»Ÿæ¥è§£é‡Šåœºæ™¯ã€‚</p>
<p>å¾ˆå¤šç ”ç©¶è€…è¯•å›¾é€šè¿‡ç ”ç©¶<a href="https://link.springer.com/article/10.1023/A:1021889010444"><code>è‡ªç„¶åœºæ™¯</code>çš„ç»Ÿè®¡ä¿¡æ¯æ¥äº†è§£å…¶ç»“æ„</a>ã€‚ç ”ç©¶äººå‘˜è®¤ä¸ºï¼Œè‡ªç„¶ç¯å¢ƒäº§ç”Ÿçš„è§†è§‰åˆºæ¿€ä¿ƒè¿›äº†HVSçš„è¿›åŒ–ï¼Œå¹¶ä¸”ï¼Œè‡ªç„¶åœºæ™¯å»ºæ¨¡å’ŒHVSå»ºæ¨¡åœ¨æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª<a href="https://baike.baidu.com/item/%E5%AF%B9%E5%81%B6%E7%90%86%E8%AE%BA/9582786">å¯¹å¶é—®é¢˜</a>ã€‚</p>
<p>ç»“åˆä¿¡å·æ£€æµ‹ç†è®ºï¼ˆ<em>signal detection theory</em>ï¼‰ï¼Œä¿¡æ¯è®ºï¼ˆ<em>information theory</em>ï¼‰æˆ–ä¼°è®¡ç†è®ºï¼ˆ<em>estimation theory.</em>ï¼‰ï¼Œè‡ªç„¶åœºæ™¯ç»Ÿè®¡å¯ç”¨äºå®šä¹‰è§‚å¯Ÿè€…çš„è¡Œä¸ºã€‚ç›®å‰ï¼Œè‡ªç„¶åœºæ™¯ç»Ÿè®¡æ¨¡å‹æœ€æˆåŠŸçš„åº”ç”¨ä¹‹ä¸€å°±æ˜¯å›¾ç‰‡å’Œè§†é¢‘çš„å¯æ„ŸçŸ¥çš„è´¨é‡é¢„æµ‹ã€‚ä¹‹æ‰€ä»¥å¯ä»¥å¦‚æ­¤åº”ç”¨ï¼Œå…¶åŸºæœ¬çš„å‰ææ˜¯ï¼š</p>
<ul>
<li>å›¾åƒã€è§†é¢‘é€šå¸¸ä¼šæ¶‰åŠè‡ªç„¶åœºæ™¯</li>
<li>å›¾åƒã€è§†é¢‘çš„å¤±çœŸä¼šæ”¹å˜è‡ªç„¶åœºæ™¯çš„ç»Ÿè®¡ä¿¡æ¯</li>
<li>äººç±»è§†è§‰ç³»ç»Ÿå¯¹è‡ªç„¶åœºæ™¯ç»Ÿè®¡ä¿¡æ¯çš„å˜åŒ–éå¸¸æ•æ„Ÿ</li>
</ul>
<h4 id="vmaf">VMAF</h4>
<p>ä»¥VIFä¸ºåŸºç¡€ï¼ŒNetflixå¼€å‘äº†åˆ°ç›®å‰ä¸ºæ­¢ï¼Œè§†é¢‘è´¨é‡è¯„ä¼°é¢†åŸŸçš„æœ€ä¼˜ç§€çš„å…¨å‚è€ƒè¯„ä¼°ç®—æ³•ï¼š<a href="https://netflixtechblog.com/toward-a-practimathcal-perceptual-video-quality-metric-653f208b9652">VMAFï¼ˆ<em>Video Multimethod Assessment Fusion</em>ï¼‰</a>ã€‚</p>
<p>VMAFè®¤ä¸ºæ¯ä¸ªåŸºæœ¬æµ‹é‡æŒ‡æ ‡éƒ½åœ¨è§†é¢‘ç‰¹å¾ã€å¤±çœŸç±»å‹å’Œå¤±çœŸåº¦ä¸Šæœ‰ä¸åŒçš„è¡¨ç°ï¼Œé€šè¿‡æœºå™¨å­¦ä¹ ç®—æ³•å¯ä»¥å°†åŸºç¡€çš„æµ‹é‡æŒ‡æ ‡èåˆå¾—åˆ°æœ€ç»ˆçš„ç»“æœã€‚å½“å‰ï¼ŒVMAFç®—æ³•ä½¿ç”¨VIFã€DLMï¼ˆ<em>ç»†èŠ‚æŸå¤±æŒ‡æ ‡</em>ï¼‰ã€è¿åŠ¨ï¼ˆ<em>ç›¸é‚»å¸§å·®å¼‚</em>ï¼‰ä½œä¸ºåŸºæœ¬æµ‹é‡æŒ‡æ ‡ï¼Œå¹¶ä½¿ç”¨SVMç®—æ³•å¯¹æµ‹é‡æŒ‡æ ‡è¿›è¡Œèåˆæ¥é¢„æµ‹æœ€ç»ˆç»“æœã€‚VMAFåŸºæœ¬åŸç†å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="/2021/03/05/intoduction-to-VIF/2.png" alt></p>
<p>è™½ç„¶ï¼ŒVMAFçš„æ•ˆæœæ¯”PSNRå’ŒSSIMè¦å¥½ï¼Œä½†æ˜¯å…¶è¿è¡Œé€Ÿåº¦å´è¾ƒæ…¢ï¼Œåœ¨éƒ¨åˆ†æœºå™¨ä¸Šç”šè‡³å°äº1å¸§/ç§’ã€‚</p>
<p>åŒæ—¶ï¼Œè™½ç„¶å¼€æºçš„VMAFä¹Ÿå¯ä»¥å¾—åˆ°è¾ƒå¥½çš„å¾—åˆ†ï¼Œä½†æ˜¯ä¸Netflixå…¬å¸ƒçš„åˆ†å€¼ç›¸æ¯”ä»ç„¶ç¨æœ‰é€Šè‰²ã€‚æˆ–è®¸æ˜¯å› ä¸ºVMAFæœªå¼€æºçš„éƒ¨åˆ†ä¸­åŒ…å«äº†æ›´å¤šçš„æ•°æ®é›†è®­ç»ƒæ¨¡å‹å’ŒGPUçš„æ”¯æŒã€‚</p>
<h2 id="vifç®—æ³•">VIFç®—æ³•</h2>
<h4 id="vifç®—æ³•çš„æ ¸å¿ƒæ€æƒ³">VIFç®—æ³•çš„æ ¸å¿ƒæ€æƒ³</h4>
<p>VIFç®—æ³•å°†å›¾åƒ/è§†é¢‘çš„è´¨é‡è¯„ä¼°é—®é¢˜çœ‹ä½œä¸€ä¸ªä¿¡æ¯ä¿çœŸçš„é—®é¢˜ï¼Œå¹¶ä»ä¿¡æ¯é€šä¿¡å’Œå…±äº«çš„è§’åº¦æ¥è¯„ä¼°å›¾åƒ/è§†é¢‘çš„è´¨é‡ã€‚</p>
<p>VIFè®¤ä¸ºï¼š</p>
<ul>
<li>äººçœ¼æ‰€çœ‹åˆ°çš„å›¾åƒæ˜¯é€šè¿‡HVSè¿‡æ»¤ä¹‹åè€Œæå–åˆ°çš„ä¿¡æ¯ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œäººç±»è§†è§‰ç³»ç»Ÿä¹Ÿæ˜¯ä¸€ä¸ªç®€å•çš„å¤±çœŸé€šé“</li>
<li>åœ¨ç»è¿‡HVSä¹‹å‰ï¼Œå¤±çœŸå›¾åƒåªæ˜¯æ¯”åŸå§‹å›¾åƒå¤šç»è¿‡äº†ä¸€ä¸ªå¤±çœŸé€šé“</li>
<li>åˆ©ç”¨ä¿¡æ¯è®ºçš„ç†è®ºï¼ŒæŠŠäººçœ¼ä»å¤±çœŸå›¾åƒä¸­æå–åˆ°çš„ä¿¡æ¯å’Œäººçœ¼ä»åŸå§‹å›¾åƒä¸­æå–åˆ°çš„ä¿¡æ¯è¿›è¡Œå¯¹æ¯”ï¼Œä»è€Œå¾—åˆ°ç¬¦åˆäººä¸»è§‚æ„ŸçŸ¥çš„å›¾åƒè´¨é‡</li>
</ul>
<p>æ•´ä½“VIFç®—æ³•ä¸­åŒ…å«ä¸‰ä¸ªéƒ¨åˆ†ï¼š<code>Source Model</code>ï¼Œ<code>Distortion Model</code>ï¼Œ<code>HVS Model</code>ï¼Œå…·ä½“å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="/2021/03/05/intoduction-to-VIF/1.gif" alt></p>
<h4 id="source-model">Source Model</h4>
<p><code>Source Model</code>ä¹Ÿç§°ä¸ºåŸå§‹å›¾åƒå»ºæ¨¡ï¼Œä¸ºäº†æ¨¡æ‹ŸHVSçš„å¤šé€šé“ç‰¹æ€§ï¼ŒVIFç®—æ³•åˆ©ç”¨<a href="/2020/03/18/introduction-to-image-pyramid/">é«˜æ–¯é‡‘å­—å¡”</a>å°†å›¾åƒåˆ†æˆå››ä¸ªä¸åŒçš„å°ºåº¦ï¼Œç„¶åå°†æ¯ä¸€ä¸ªå°ºåº¦åˆ†æˆå¤§å°ä¸ä¸€çš„å—ï¼Œæ¯ä¸€ä¸ªå—ä¸­çš„æ‰€æœ‰åƒç´ ç»„æˆä¸€ä¸ªå‘é‡<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>c</mi><mo stretchy="true">â†’</mo></mover></mrow><annotation encoding="application/x-tex">\overrightarrow{c}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9525600000000001em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">c</span></span></span><span class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width="400em" height="0.522em" viewbox="0 0 400000 522" preserveaspectratio="xMaxYMin slice"><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z"/></svg></span></span></span></span></span></span></span></span></span>ï¼Œå¹¶ä½¿ç”¨é«˜æ–¯æ··åˆæ¨¡å‹å¯¹å‘é‡è¿›è¡Œå»ºæ¨¡ï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">C</mi><mo>=</mo><mi mathvariant="script">S</mi><mo separator="true">â‹…</mo><mi mathvariant="script">U</mi><mo>=</mo><mo stretchy="false">{</mo><msub><mi>S</mi><mi>i</mi></msub><mo separator="true">â‹…</mo><msub><mover accent="true"><mi>U</mi><mo stretchy="true">â†’</mo></mover><mi>i</mi></msub><mo>:</mo><mi>i</mi><mo>âˆˆ</mo><mi>I</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\mathcal{C} = \mathcal{S} Â· \mathcal{U} = \{ S_i Â· \overrightarrow{U}_i : i \in I \}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.05834em;">C</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.075em;">S</span></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.09931em;">U</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.45533em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.20533em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">U</span></span></span><span class="svg-align" style="top:-3.6833299999999998em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width="400em" height="0.522em" viewbox="0 0 400000 522" preserveaspectratio="xMaxYMin slice"><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z"/></svg></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69862em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mclose">}</span></span></span></span></span></p>
<p>å¯¹äº<code>Source Model</code>è€Œè¨€ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mi>l</mi><mi>o</mi><mi>c</mi><mi>k</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">block(i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mclose">)</span></span></span></span>è¡¨ç¤ºç¬¬<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span>ä¸ªå—ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br>
<img src="/2021/03/05/intoduction-to-VIF/3.jpg" alt></p>
<p>åœ¨è®¡ç®—æ—¶ï¼Œå¯ä»¥åˆ©ç”¨ç¬¬<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span>å—ä¸­çš„ç³»æ•°æ¥ä¼°è®¡ç¬¬<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span>å—çš„å‚æ•°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">s</span></span></span></span>ï¼Œå…·ä½“å¦‚ä¸‹ï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mover accent="true"><mi>s</mi><mo stretchy="true">^</mo></mover><mi>i</mi><mn>2</mn></msubsup><mo>=</mo><mover accent="true"><mrow><mi>C</mi><mi>o</mi><mi>v</mi></mrow><mo stretchy="true">^</mo></mover><mo stretchy="false">(</mo><mi>C</mi><mo separator="true">,</mo><mi>C</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\widehat{s}_i^2 = \widehat{Cov}(C,C)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1111079999999998em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.67056em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">s</span></span></span><span class="svg-align" style="width:calc(100% - 0.11112em);margin-left:0.11112em;top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.24em;"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22
c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-2.4530000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.23333em;vertical-align:-0.25em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.98333em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span><span class="svg-align" style="top:-3.6833299999999998em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.3em;"><svg width="100%" height="0.3em" viewbox="0 0 2364 300" preserveaspectratio="none"><path d="M1181 0h2l1171 176c6 0 10 5 10 11l-2 23c-1 6-5 10
-11 10h-1L1182 67 15 220h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z"/></svg></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mclose">)</span></span></span></span></span></p>
<h4 id="distortion-model">Distortion Model</h4>
<p>å¯¹äº<code>Distortion Model</code>è€Œè¨€ï¼Œä¸ºäº†èƒ½å¤Ÿè®©<code>Distortion Model</code>ä¸­çš„è®¡ç®—å¯ä»¥æˆç«‹ï¼Œè®ºæ–‡é‡‡ç”¨å±€éƒ¨ä¼°è®¡çš„æ–¹å¼æ¥è·å–<code>distortion channel</code>çš„å‚æ•°ã€‚</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">D</mi><mo>=</mo><mrow><mi mathvariant="script">G</mi><mi mathvariant="script">C</mi></mrow><mo>+</mo><mi mathvariant="script">V</mi><mo>=</mo><mo stretchy="false">{</mo><msub><mi>g</mi><mi>i</mi></msub><msub><mover accent="true"><mi>C</mi><mo stretchy="true">â†’</mo></mover><mi>i</mi></msub><mo>+</mo><msub><mover accent="true"><mi>V</mi><mo stretchy="true">â†’</mo></mover><mi>i</mi></msub><mo>:</mo><mi>i</mi><mo>âˆˆ</mo><mi>I</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\mathcal{D} = \mathcal{GC} + \mathcal{V} = \{g_i {\overrightarrow{C}}_i+{\overrightarrow{V}}_i:i \in I\}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.02778em;">D</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.78055em;vertical-align:-0.09722em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.0593em;">G</span><span class="mord mathcal" style="margin-right:0.05834em;">C</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.08222em;">V</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.45533em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.20533em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span><span class="svg-align" style="top:-3.6833299999999998em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width="400em" height="0.522em" viewbox="0 0 400000 522" preserveaspectratio="xMaxYMin slice"><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z"/></svg></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.35533em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.20533em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span></span></span><span class="svg-align" style="top:-3.6833299999999998em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width="400em" height="0.522em" viewbox="0 0 400000 522" preserveaspectratio="xMaxYMin slice"><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z"/></svg></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69862em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mclose">}</span></span></span></span></span></p>
<p>å…·ä½“åšæ³•ä¸ºï¼Œåœ¨å¦‚ä¸‹å›¾æ‰€ç¤ºçš„å°æ³¢å˜æ¢ä¹‹åçš„é¢‘åŸŸå›¾ä¸­ï¼Œå¯¹äºå›¾ä¸­çš„ç¬¬<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span>ä¸ªç³»æ•°è€Œè¨€ï¼Œæˆ‘ä»¬é‡‡ç”¨ä»¥<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span>ä¸ºä¸­å¿ƒçš„<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>Ã—</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">B \times B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span></span>çš„ç³»æ•°å—ä¸Šä¼°è®¡ç¬¬<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span>ä¸ªç³»æ•°å¯¹åº”çš„å‚æ•°ï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">g_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>å’Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>Ïƒ</mi><mrow><mi>v</mi><mo separator="true">,</mo><mi>i</mi></mrow><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\sigma_{v,i}^{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.20888em;vertical-align:-0.394772em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.441336em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">i</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.394772em;"><span></span></span></span></span></span></span></span></span></span>ã€‚</p>
<p>å…¶ä¸­ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">g_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ä¸ºåœ¨è¯¥å¯¹åº”å—ä¹‹ä¸Šçš„éšæœºåœº<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">{G}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">G</span></span></span></span></span>çš„å€¼ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>Ïƒ</mi><mrow><mi>v</mi><mo separator="true">,</mo><mi>i</mi></mrow><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\sigma_{v,i}^{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.20888em;vertical-align:-0.394772em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.441336em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">i</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.394772em;"><span></span></span></span></span></span></span></span></span></span>ä¸ºåœ¨è¯¥å¯¹åº”å—ä¹‹ä¸Šçš„éšæœºåœº<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">{V}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span></span></span></span></span>çš„æ–¹å·®ã€‚<br>
<img src="/2021/03/05/intoduction-to-VIF/4.jpg" alt></p>
<p>æ­¤æ—¶ï¼Œ<code>Distortion Model</code>ä¸­çš„å‚è€ƒä¿¡å·å’ŒæŠ˜æŸä¿¡å·éƒ½èƒ½è·å–ï¼Œå› æ­¤å¯ä»¥å¾ˆå®¹æ˜“çš„ç”¨å¦‚ä¸‹æ‰€ç¤ºæ–¹æ³•æ¥å¯¹<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">g_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>å’Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>Ïƒ</mi><mrow><mi>v</mi><mo separator="true">,</mo><mi>i</mi></mrow><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\sigma_{v,i}^{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.20888em;vertical-align:-0.394772em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.441336em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">i</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.394772em;"><span></span></span></span></span></span></span></span></span></span>è¿›è¡Œä¼°è®¡ã€‚</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>g</mi><mo stretchy="true">^</mo></mover><mi>i</mi></msub><mo>=</mo><mover accent="true"><mrow><mi>C</mi><mi>o</mi><mi>v</mi></mrow><mo stretchy="true">^</mo></mover><mo stretchy="false">(</mo><mi>C</mi><mo separator="true">,</mo><mi>D</mi><mo stretchy="false">)</mo><mover accent="true"><mrow><mi>C</mi><mi>o</mi><mi>v</mi></mrow><mo stretchy="true">^</mo></mover><mo stretchy="false">(</mo><mi>C</mi><mo separator="true">,</mo><mi>C</mi><msup><mo stretchy="false">)</mo><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\widehat{g}_{i} = \widehat{Cov}(C,D)\widehat{Cov}(C,C)^{-1}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.865em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.67056em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span></span></span><span class="svg-align" style="width:calc(100% - 0.05556em);margin-left:0.05556em;top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.24em;"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22
c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.23333em;vertical-align:-0.25em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.98333em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span><span class="svg-align" style="top:-3.6833299999999998em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.3em;"><svg width="100%" height="0.3em" viewbox="0 0 2364 300" preserveaspectratio="none"><path d="M1181 0h2l1171 176c6 0 10 5 10 11l-2 23c-1 6-5 10
-11 10h-1L1182 67 15 220h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z"/></svg></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mclose">)</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.98333em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span><span class="svg-align" style="top:-3.6833299999999998em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.3em;"><svg width="100%" height="0.3em" viewbox="0 0 2364 300" preserveaspectratio="none"><path d="M1181 0h2l1171 176c6 0 10 5 10 11l-2 23c-1 6-5 10
-11 10h-1L1182 67 15 220h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z"/></svg></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mover accent="true"><mi>Ïƒ</mi><mo stretchy="true">^</mo></mover><mrow><mi>v</mi><mo separator="true">,</mo><mi>i</mi></mrow><mn>2</mn></msubsup><mo>=</mo><mover accent="true"><mrow><mi>C</mi><mi>o</mi><mi>v</mi></mrow><mo stretchy="true">^</mo></mover><mo stretchy="false">(</mo><mi>D</mi><mo separator="true">,</mo><mi>D</mi><mo stretchy="false">)</mo><mo>âˆ’</mo><msub><mover accent="true"><mi>g</mi><mo stretchy="true">^</mo></mover><mi>i</mi></msub><mover accent="true"><mrow><mi>C</mi><mi>o</mi><mi>v</mi></mrow><mo stretchy="true">^</mo></mover><mo stretchy="false">(</mo><mi>C</mi><mo separator="true">,</mo><mi>D</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\widehat{\sigma}_{v,i}^{2} = \widehat{Cov}(D,D) - \widehat{g}_{i}\widehat{Cov}(C,D)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2472159999999999em;vertical-align:-0.383108em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.67056em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">Ïƒ</span></span></span><span class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.24em;"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22
c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-2.4530000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">i</span></span></span></span><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.383108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.23333em;vertical-align:-0.25em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.98333em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span><span class="svg-align" style="top:-3.6833299999999998em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.3em;"><svg width="100%" height="0.3em" viewbox="0 0 2364 300" preserveaspectratio="none"><path d="M1181 0h2l1171 176c6 0 10 5 10 11l-2 23c-1 6-5 10
-11 10h-1L1182 67 15 220h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z"/></svg></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.23333em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.67056em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span></span></span><span class="svg-align" style="width:calc(100% - 0.05556em);margin-left:0.05556em;top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.24em;"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22
c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.98333em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span><span class="svg-align" style="top:-3.6833299999999998em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.3em;"><svg width="100%" height="0.3em" viewbox="0 0 2364 300" preserveaspectratio="none"><path d="M1181 0h2l1171 176c6 0 10 5 10 11l-2 23c-1 6-5 10
-11 10h-1L1182 67 15 220h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z"/></svg></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mclose">)</span></span></span></span></span></p>
<p>åœ¨ä¼°è®¡å‰ï¼Œä¼šå¯¹æ¯ä¸€ä¸ªç³»æ•°è¿›è¡Œä¸åŒå°ºåº¦çš„é«˜æ–¯å·ç§¯è®¡ç®—ã€‚</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>o</mi><mi>v</mi><mo stretchy="false">(</mo><mi>C</mi><mo separator="true">,</mo><mi>D</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">[</mo><mi>C</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mi>D</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>âˆ—</mo><mi>F</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>âˆ’</mo><mspace linebreak="newline"></mspace><mo stretchy="false">[</mo><mi>C</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>âˆ—</mo><mi>F</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>D</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>âˆ—</mo><mi>F</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">Cov(C,D) = [C(n)D(n)] * F(n) - \\ 
           [C(n)*F(n)][D(n)*F(n)] 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mclose">]</span></span></span></span></span></p>
<h4 id="hvs-model">HVS Model</h4>
<p>å¯¹äº<code>HVS Model</code>è€Œè¨€ï¼ŒVIFå°†å…¶å¸¦æ¥çš„è¯¯å·®æ•´åˆä¸ºä¸€ä¸ªå™ªå£°ã€‚å…·ä½“å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">E</mi><mo>=</mo><mi mathvariant="script">C</mi><mo>+</mo><mi mathvariant="script">N</mi><mo>=</mo><mi mathvariant="script">S</mi><mo separator="true">â‹…</mo><mi mathvariant="script">U</mi><mo>+</mo><mi mathvariant="script">N</mi><mspace linebreak="newline"></mspace><mi mathvariant="script">F</mi><mo>=</mo><mi mathvariant="script">D</mi><mo>+</mo><msup><mi mathvariant="script">N</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><mo>=</mo><mrow><mi mathvariant="script">G</mi><mi mathvariant="script">C</mi></mrow><mo>+</mo><mi mathvariant="script">V</mi><mo>+</mo><msup><mi mathvariant="script">N</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup></mrow><annotation encoding="application/x-tex">\mathcal{E} = \mathcal{C} + \mathcal{N} = \mathcal{S} Â· \mathcal{U} + \mathcal{N} \\
\mathcal{F} = \mathcal{D} + \mathcal{N}&#x27; = \mathcal{GC} + \mathcal{V} + \mathcal{N}&#x27;
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.08944em;">E</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.05834em;">C</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.14736em;">N</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.075em;">S</span></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.09931em;">U</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.14736em;">N</span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.02778em;">D</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.801892em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.14736em;">N</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.78055em;vertical-align:-0.09722em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.0593em;">G</span><span class="mord mathcal" style="margin-right:0.05834em;">C</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.08222em;">V</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.801892em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.14736em;">N</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>å› æ­¤ï¼Œåœ¨VIFç®—æ³•ä¸­ï¼Œ<code>HVS Model</code>å…¶åªæœ‰ä¸€ä¸ªå‚æ•°ï¼šè§†è§‰å™ªå£°çš„æ–¹å·®<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>Ïƒ</mi><mi>n</mi><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\sigma_n^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.061108em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œä»è®ºæ–‡ä¸­å¯ä»¥å‘ç°ï¼Œè¯¥å‚æ•°æ˜¯ä¸€ä¸ªå¯ä»¥è°ƒèŠ‚çš„å‚æ•°ï¼Œéœ€è¦æ ¹æ®ä¸åŒçš„è§†é¢‘æ•°æ®é›†æ¥è°ƒæ•´ä»¥è·å–æœ€ä½³çš„<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>Ïƒ</mi><mi>n</mi><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\sigma_n^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.061108em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span>ã€‚</p>
<p>åœ¨VIFæä¾›çš„å°æ³¢åŸŸä¸‹çš„ç®—æ³•å®ç°ä¸­ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>Ïƒ</mi><mi>n</mi><mn>2</mn></msubsup><mo>=</mo><mn>0.4</mn></mrow><annotation encoding="application/x-tex">\sigma_n^2=0.4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.061108em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">4</span></span></span></span>ï¼Œåœ¨VIFæä¾›çš„<a href="vifp_mscale.m">åƒç´ åŸŸä¸‹çš„ç®—æ³•å®ç°ä¸­</a>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>Ïƒ</mi><mi>n</mi><mn>2</mn></msubsup><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">\sigma_n^2=2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.061108em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span>ï¼Œåœ¨VMAFçš„integer_vifä¸­ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>Ïƒ</mi><mi>n</mi><mn>2</mn></msubsup><mo>=</mo><mn>65536</mn><mo>&lt;</mo><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\sigma_n^2=65536&lt;&lt;1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.061108em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68354em;vertical-align:-0.0391em;"></span><span class="mord">6</span><span class="mord">5</span><span class="mord">5</span><span class="mord">3</span><span class="mord">6</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>ã€‚</p>
<p><a href="https://github.com/Netflix/vmaf/blob/master/libvmaf/src/feature/vif_tools.c">VMAFå®ç°VIFæ—¶</a>ï¼Œå¯¹ç›¸å…³å‚æ•°çš„è®¡ç®—å‡½æ•°<code>vif_statistic_s</code>å°±æ˜¯é‡‡ç”¨äº†å¦‚ä¸Šçš„æ–¹æ³•ã€‚</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">g     = sigma12 / (sigma1_sq + eps);</span><br><span class="line">sv_sq = sigma2_sq - g * sigma12;</span><br></pre></td></tr></table></figure>
<h4 id="vifçš„å¤šå°ºåº¦è®¡ç®—">VIFçš„å¤šå°ºåº¦è®¡ç®—</h4>
<p>æœ€ç»ˆï¼Œç»“åˆ<code>Source Model</code>ï¼Œ<code>Distortion Model</code>ï¼Œ<code>HVS Model</code>ï¼Œå¾—åˆ°VIFç®—æ³•ï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mi>I</mi><mi>F</mi><mo>=</mo><mfrac><mrow><mi>I</mi><mo stretchy="false">(</mo><mi>C</mi><mo separator="true">;</mo><mi>F</mi><mi mathvariant="normal">âˆ£</mi><mi>s</mi><mo stretchy="false">)</mo></mrow><mrow><mi>I</mi><mo stretchy="false">(</mo><mi>C</mi><mo separator="true">;</mo><mi>E</mi><mi mathvariant="normal">âˆ£</mi><mi>s</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">VIF = \frac{I(C;F|s)}{I(C;E|s)}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord">âˆ£</span><span class="mord mathdefault">s</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mord">âˆ£</span><span class="mord mathdefault">s</span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>åœ¨å¾—åˆ°ä¸€ä¸ªå°ºåº¦VIFå¾—åˆ†ä¹‹åï¼Œå¯ä»¥éå¸¸æ–¹ä¾¿çš„å°†è®¡ç®—è¿‡ç¨‹æ‰©å±•åˆ°å…¶ä»–çš„å°ºåº¦ã€‚ä¾‹å¦‚ï¼Œå¯¹äºæœ‰4ä¸ªå°ºåº¦çš„VIFçš„è®¡ç®—è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br>
<img src="/2021/03/05/intoduction-to-VIF/5.jpg" alt><br>
å…¶ä¸­ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mn>0</mn></mrow><annotation encoding="application/x-tex">f0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord">0</span></span></span></span>-<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mn>3</mn></mrow><annotation encoding="application/x-tex">f3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord">3</span></span></span></span>æ»¤æ³¢åˆ†åˆ«å¯¹åº”ç€å®½åº¦ï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span>ï¼‰ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>17</mn><mo>Ã—</mo><mn>17</mn></mrow><annotation encoding="application/x-tex">17 \times 17</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mord">7</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">7</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>9</mn><mo>Ã—</mo><mn>9</mn></mrow><annotation encoding="application/x-tex">9 \times 9</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">9</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">9</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>5</mn><mo>Ã—</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">5 \times 5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">5</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">5</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn><mo>Ã—</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">3 \times 3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ïƒ</mi><mo>=</mo><mi>N</mi><mi mathvariant="normal">/</mi><mn>5</mn></mrow><annotation encoding="application/x-tex">\sigma=N/5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">Ïƒ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord">/</span><span class="mord">5</span></span></span></span>çš„é«˜æ–¯å·ç§¯æ ¸ï¼Œå…·ä½“å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br>
<img src="/2021/03/05/intoduction-to-VIF/6.jpg" alt></p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mi>I</mi><mi>F</mi><mo>=</mo><mfrac><mstyle scriptlevel="0" displaystyle="true"><munder><mo>âˆ‘</mo><mrow><mi>i</mi><mo>âˆˆ</mo><mi>a</mi><mi>l</mi><mi>l</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>c</mi><mi>a</mi><mi>l</mi><mi>e</mi><mi>s</mi></mrow></munder><mrow><mi>n</mi><mi>u</mi><msub><mi>m</mi><mi>i</mi></msub></mrow></mstyle><mstyle scriptlevel="0" displaystyle="true"><munder><mo>âˆ‘</mo><mrow><mi>i</mi><mo>âˆˆ</mo><mi>a</mi><mi>l</mi><mi>l</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>c</mi><mi>a</mi><mi>l</mi><mi>e</mi><mi>s</mi></mrow></munder><mrow><mi>d</mi><mi>e</mi><msub><mi>n</mi><mi>i</mi></msub></mrow></mstyle></mfrac></mrow><annotation encoding="application/x-tex">VIF = \frac{\displaystyle\sum_{i \in all\_scales}{num_i}}{\displaystyle\sum_{i \in all\_scales}{den_i}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:5.418236em;vertical-align:-2.459118em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9591180000000006em;"><span style="top:-2.1100000000000003em;"><span class="pstrut" style="height:3.0500050000000005em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0500050000000003em;"><span style="top:-1.847887em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">âˆˆ</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mtight" style="margin-right:0.02778em;">_</span><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">s</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.519113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.2800050000000005em;"><span class="pstrut" style="height:3.0500050000000005em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-4.959118em;"><span class="pstrut" style="height:3.0500050000000005em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0500050000000003em;"><span style="top:-1.847887em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">âˆˆ</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mtight" style="margin-right:0.02778em;">_</span><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">s</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.519113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="mord mathdefault">u</span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.459118em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<h2 id="åˆ©ç”¨libvmafè®¡ç®—vif">åˆ©ç”¨libvmafè®¡ç®—VIF</h2>
<p>ä¾èµ–äº<a href="https://github.com/Netflix/vmaf">VMAF</a>è‰¯å¥½çš„è®¾è®¡å’Œå¼ºå¤§çš„å¯æ‰©å±•æ€§ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨VMAFæ¥å•ç‹¬çš„è®¡ç®—å…¶å•ä¸ªç‰¹å¾çš„è¯„ä¼°ç»“æœã€‚å¯¹äºVIFè€Œè¨€ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨å¦‚ä¸‹çš„æ­¥éª¤ï¼Œæ¥è®¡ç®—ä¸¤ä¸ªç»™å®šçš„YUVæ ¼å¼çš„è§†é¢‘çš„VIFå¾—åˆ†ï¼š</p>
<ul>
<li>æŒ‰ç…§<a href="https://github.com/Netflix/vmaf/tree/master/libvmaf">libvmafçš„æ–‡æ¡£</a>ç¼–è¯‘libvmafï¼Œå¦‚æœå¸Œæœ›å¾—åˆ°æ›´å¤šçš„debugçš„ä¿¡æ¯ï¼Œå¯ä»¥å°†<a href="https://github.com/Netflix/vmaf/blob/master/libvmaf/src/feature/integer_vif.c">integer_vif</a>çš„debugå‚æ•°ä¿®æ”¹ä¸º<code>true</code>ã€‚</li>
<li>ç¼–å†™æµ‹è¯•ä»£ç ï¼Œè°ƒç”¨libvmafåº“ä¸­æä¾›çš„ç›¸å…³apiè®¡ç®—å„å°ºåº¦çš„VIFå¾—åˆ†ï¼Œå…·ä½“å‚è§<a href="test_vif.cpp">test_vif.cpp</a>ã€‚</li>
<li>åˆ©ç”¨å¦‚ä¸‹å‘½ä»¤ç¼–è¯‘test_vif.cpp:<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> g++ -o vif test_vif.cpp -Ilibvmaf/include -Llibvmaf/build/src -lvmaf</span></span><br></pre></td></tr></table></figure>
</li>
<li>è®¡ç®—ä¸¤ä¸ªè§†é¢‘çš„vifå¾—åˆ†ï¼š<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">export</span> DYLD_LIBRARY_PATH=<span class="variable">$DYLD_LIBRARY_PATH</span>:libvmaf/build/src <span class="comment"># å¦‚æœæ‰§è¡ŒvifæŠ¥é”™</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> vif t1.yuv t3.yuv 2160x2840</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>å¯¹äºå¦‚ä¸‹å›¾æ‰€ç¤ºçš„è§†é¢‘å¯¹ï¼Œ</p>
<p><img src="/2021/03/05/intoduction-to-VIF/9.jpg" alt></p>
<p>æˆ‘ä»¬åˆ†åˆ«è®¡ç®—vifï¼Œssimï¼Œpsnrçš„å¾—åˆ†å¯ä»¥å¾—å‡ºå¦‚ä¸‹ç»“æœï¼š</p>
<p><img src="/2021/03/05/intoduction-to-VIF/8.jpg" alt></p>
<p>ä»ç»“æœçœ‹ï¼Œå¯¹äºè¿™ç§æŠ˜æŸVIFç®—æ³•ç»™å‡ºçš„ç»“æœæ›´ç¬¦åˆäººçš„ä¸»è§‚æ„Ÿå—ã€‚</p>
<h2 id="vifçš„ä¼˜åŠ¿å’Œå±€é™æ€§">VIFçš„ä¼˜åŠ¿å’Œå±€é™æ€§</h2>
<h4 id="vifçš„ä¼˜åŠ¿">VIFçš„ä¼˜åŠ¿</h4>
<ul>
<li>
<p>ä¸€ä¸ªå¥½çš„<code>Distortion Model</code>å¯ä»¥ä½¿å¾—æŠ˜æŸå›¾åƒå’Œåˆæˆçš„å›¾åƒèƒ½å¤Ÿæœ‰ç›¸åŒçš„æ„Ÿå®˜è´¨é‡ã€‚<code>Distortion Model</code>çš„ç›®çš„å¹¶ä¸æ˜¯å¯¹å›¾åƒçš„æ‰€æœ‰æŠ˜æŸç±»å‹è¿›è¡Œå»ºæ¨¡ï¼Œè€Œæ˜¯å¯¹å›¾åƒçš„æŠ˜æŸå¸¦æ¥çš„ä¸»è§‚æ„Ÿå—è¿›è¡Œå»ºæ¨¡ã€‚å› æ­¤ï¼ŒVIFä¸ä¸€å®šèƒ½å¤Ÿæ•è·æ‰€æœ‰çš„å›¾åƒæŠ˜æŸï¼Œä½†æ˜¯å´å¯ä»¥æ•è·è¿™äº›å›¾åƒçš„æŠ˜æŸå¸¦æ¥çš„æ„ŸçŸ¥æŠ˜æŸã€‚</p>
</li>
<li>
<p>å¦å¤–ï¼Œä»<code>Distortion Model</code>ï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">D</mi><mo>=</mo><mrow><mi mathvariant="script">G</mi><mi mathvariant="script">C</mi></mrow><mo>+</mo><mi mathvariant="script">V</mi></mrow><annotation encoding="application/x-tex">\mathcal{D} = \mathcal{GC} + \mathcal{V}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.02778em;">D</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.78055em;vertical-align:-0.09722em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.0593em;">G</span><span class="mord mathcal" style="margin-right:0.05834em;">C</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.08222em;">V</span></span></span></span></span>ï¼‰å¯ä»¥å‘ç°ï¼ŒVIFå°†å›¾åƒçš„æŠ˜æŸæ‹†åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼š</p>
<ul>
<li>ä¿¡å·å¢ç›Š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">G</span></span></span></span></li>
<li>å™ªå£°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span></span></span></span></li>
<li>HVSå™ªå£°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>N</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup></mrow><annotation encoding="application/x-tex">N&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span></span></li>
</ul>
<p>è¿™ä½¿å¾—VIFæ›´ç¬¦åˆå½“å‰çš„å®é™…åº”ç”¨ã€‚ä¾‹å¦‚å›¾åƒçš„äº®åº¦å¢å¼ºï¼Œå¯¹æ¯”åº¦å¢å¼ºç­‰åœºæ™¯ã€‚åœ¨è¿™äº›åœºæ™¯ä¸‹ï¼Œå›¾åƒä¿¡å·è™½ç„¶å‘ç”Ÿäº†å˜åŒ–ï¼Œä½†æ˜¯è¿™å¹¶ä¸æ˜¯å›¾åƒå¤„ç†è¿‡ç¨‹å¼•å…¥çš„å™ªå£°ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆPSNRï¼ŒSSIMç­‰ç®—æ³•æ— æ³•åº”ç”¨äºç±»ä¼¼åœºæ™¯çš„åŸå› ï¼Œè€ŒVIFçš„æŠ˜æŸå›¾åƒæ¨¡å‹å´å¯ä»¥å®Œç¾çš„åº”ç”¨äºè¿™äº›åœºæ™¯ã€‚å¯¹äºäº®åº¦å¢å¼ºæˆ–å¯¹æ¯”åº¦å¢å¼ºçš„åœºæ™¯ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">G&gt;1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">G</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>ï¼Œä»è€Œä½¿å¾—<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mi>I</mi><mi>F</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">VIF&gt;1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>ï¼Œä»è€Œå¯ä»¥å¾—å‡ºå¢å¼ºåçš„å›¾åƒåœ¨æ„Ÿå®˜è´¨é‡ä¸Šè¦ä¼˜äºå‚è€ƒå›¾åƒçš„ç»“è®ºã€‚æˆ‘ä»¬ç”¨VIFè®¡ç®—å¯¹æ¯”åº¦æå‡50%çš„è§†é¢‘è§†é¢‘æ—¶ï¼Œå‘ç°å‚æ•°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">G</span></span></span></span>å®é™…ä¸Šæ˜¯&gt;1çš„ï¼Œ<br>
<img src="/2021/03/05/intoduction-to-VIF/12.jpg" alt><br>
å¹¶ä¸”å¾—åˆ°å¦‚ä¸‹çš„ç»“æœï¼š<br>
<img src="/2021/03/05/intoduction-to-VIF/11.jpg" alt></p>
</li>
<li>
<p>ä»VIFçš„è®¡ç®—å¯ä»¥ï¼ŒVIFçš„æœ€ç»ˆå¾—åˆ†æ˜¯å¤±çœŸå›¾åƒDåœ¨å‚è€ƒå›¾åƒCä¸‹çš„å¾—åˆ†ã€‚å®é™…ä¸Šè€Œè¨€ï¼ŒVIFæ˜¯ä¸€ç§å†…å®¹è‡ªé€‚åº”çš„ç®—æ³•ã€‚ç»™å®šçš„å›¾åƒæŠ˜æŸï¼Œå¯¹äºä¸åŒçš„å†…å®¹è€Œè¨€ï¼Œå…¶å¸¦æ¥çš„ä¸»è§‚æ„Ÿå—æ˜¯ä¸ä¸€æ ·çš„ã€‚åˆ©å¦‚ï¼ŒæŸäº›æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦åˆ©ç”¨è¿åŠ¨æ¨¡ç³Šæ¥å±•ç°ç‰©ä½“çš„é«˜é€Ÿè¿åŠ¨ï¼Œä½†æ˜¯å¯¹äºè§‚çœ‹ç¾½æ¯›çƒæ¯”èµ›æ—¶ï¼Œå¦‚æœå‡ºç°ç¾½æ¯›çƒè¿åŠ¨æ¨¡ç³Šçš„æƒ…å†µï¼Œå°±ä¼šä»¤äººè®¨åŒäº†ã€‚å¯¹äºï¼ŒPSNRå’ŒSSIMç­‰ç®—æ³•è€Œè¨€ï¼Œåœ¨è®¡ç®—è¿‡ç¨‹ä¸­æ˜¯æ²¡æœ‰åšç±»ä¼¼çš„è€ƒè™‘çš„ã€‚<br>
<img src="/2021/03/05/intoduction-to-VIF/7.jpeg" alt></p>
</li>
</ul>
<h4 id="vifçš„å±€é™æ€§">VIFçš„å±€é™æ€§</h4>
<ul>
<li>VIFçš„ç†è®ºåŸºç¡€æ¥è‡ªäº<code>è‡ªç„¶åœºæ™¯</code>ï¼Œå› æ­¤VIFå¹¶ä¸é€‚ç”¨äºé<code>è‡ªç„¶åœºæ™¯</code>ä¸‹çš„å›¾åƒ/è§†é¢‘çš„è´¨é‡è¯„ä¼°ï¼Œè¿™ä¸€ç‚¹è¦å°¤å…¶æ³¨æ„ã€‚</li>
<li>å’ŒPSNRï¼ŒSSIMç­‰ç®—æ³•ç›¸æ¯”ï¼ŒVIFç®—æ³•çš„è®¡ç®—æ€§èƒ½ä¹Ÿæ˜¯éœ€è¦è€ƒè™‘çš„é—®é¢˜ä¹‹ä¸€ï¼Œåœ¨æŸäº›æ€§èƒ½è¾ƒå·®çš„æœºå™¨ä¸Šï¼Œå…¶è¿ç®—é€Ÿåº¦ç”šè‡³ä½äº1FPSã€‚</li>
</ul>
]]></content>
      <categories>
        <category>IVQA</category>
      </categories>
      <tags>
        <tag>VIF</tag>
        <tag>FR</tag>
      </tags>
  </entry>
  <entry>
    <title>æ€æ ·æ›´å¥½çš„æ±‡æŠ¥è‡ªå·±çš„å·¥ä½œ</title>
    <url>/2021/02/25/how-to-report-ourselves-work/</url>
    <content><![CDATA[<p>ä»Šå¹´çš„èŒç§°è¯„å®šå·¥ä½œæ¯”ä»¥å¾€æ¥çš„è¦æ—©ä¸€ç‚¹ï¼Œå¥½å¤šçš„åŒå­¦ä¸å¾—ä¸åœ¨æ˜¥èŠ‚å‡æœŸå°±å‡†å¤‡è‡ªå·±çš„ææ–™ã€‚æ¯ä¸€æ¬¡reviewåˆ«äººçš„ææ–™åï¼Œæ€»ä¼šæœ‰ä¸€äº›æ„Ÿæƒ³ï¼Œä¸€ç›´ä¹Ÿæ²¡æœ‰æ—¶é—´æ•´ç†å‡ºæ¥ï¼Œè¶ç€è¿™æ¬¡æœºä¼šï¼Œä¹Ÿç»“åˆè‡ªå·±è¿‡å»çš„å®è·µåšä¸€ä¸ªç®€å•çš„æ€»ç»“ã€‚</p>
<p><img src="/2021/02/25/how-to-report-ourselves-work/4.jpeg" alt></p>
<span id="more"></span>
<h2 id="æˆ‘å¦‚ä½•çœ‹å¾…ppt">æˆ‘å¦‚ä½•çœ‹å¾…PPT</h2>
<p>2019å¹´ï¼Œæ–°ä¸œæ–¹å¹´ä¼šçš„ä¸€ä¸ªèŠ‚ç›®â€œé‡Šæ”¾è‡ªæˆ‘â€åœ¨äº’è”ç½‘åœˆç«äº†ï¼š</p>
<blockquote>
<p>å¹²æ´»çš„ç´¯æ­»ç´¯æ´»ï¼Œæœ‰æˆæœé‚£åˆå¦‚ä½•ï¼Œåˆ°å¤´æ¥å¹²ä¸è¿‡å†™PPTçš„</p>
</blockquote>
<div class="bili_video"><div style="position: relative; width: 100%; height: 0; padding-bottom: 75%;"><iframe src="https://player.bilibili.com/player.html?aid=47440004&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position: absolute; width: 100%; height: 100%; left: 0; top: 0;"> </iframe></div></div>
<p>ä½œä¸ºä¸€ä¸ªæŠ€æœ¯äººï¼Œæˆ‘å³åå¯¹è¿‡åº¦çš„PPTæ€»ç»“ï¼ŒåŒæ—¶æ›´åå¯¹ç¼ºä¹ä»»ä½•çš„PPTçš„æ€»ç»“ï¼Œåªæ˜¯ä¸è¦è¿‡åº¦åŒ…è£…å°±å¥½ã€‚å¾ˆå¤šçš„æŠ€æœ¯äººå‘˜ä¼šè®¤ä¸ºåªæœ‰å†™å†™ä»£ç æ‰æ˜¯æ­£äº‹ï¼Œå†™PPTçº¯ç²¹æ˜¯æµªè´¹æ—¶é—´ï¼Œå¹¶ä¸”è¿˜ä¼šè¯´åœ¨äºšé©¬é€Šå†…éƒ¨ï¼Œå¼€ä¼šæ—¶æ˜¯ä¸ä¼šå‡ºç°ç”»é¢ä¸°å¯Œçš„PPTçš„ï¼Œè€Œæ˜¯ä»¥æ–‡å­—å‘ˆç°å‡ºæ¥çš„å¤‡å¿˜å½•ã€‚</p>
<p>ä½†æ˜¯ï¼Œå¯¹äºèŒç§°ç”³è¯·è€Œè¨€ï¼Œè¿™å¯ä¸æ˜¯ä¸€æ¬¡æ™®é€šçš„ä¼šè®®ã€‚æˆ‘ä»¬è¦å±•ç°å‡ºè‡ªå·±çš„äº®ç‚¹ï¼Œè®©è¯„å§”è®¤å¯æˆ‘ä»¬çš„å·¥ä½œï¼ŒPPTæ— ç–‘æ˜¯æˆ‘ä»¬ç†æ¸…å·¥ä½œæ€è·¯ï¼Œå±•ç°å·¥ä½œæˆæœï¼Œåˆ†äº«è‡ªå·±è§‚ç‚¹çš„ç»ä½³æ‰‹æ®µå’Œå‘ˆç°å½¢å¼ã€‚å½“å¯¹å¤–å®£ä¼ è‡ªå·±çš„äº§å“çš„æ—¶å€™ï¼Œäºšé©¬é€Šä¹Ÿæ˜¯é‡‡ç”¨PPTçš„æ–¹å¼ã€‚</p>
<h2 id="å¦‚ä½•æ¡†å®špptçš„ç‰ˆå¼">å¦‚ä½•æ¡†å®šPPTçš„ç‰ˆå¼</h2>
<p>å½“ç„¶ï¼Œå¯¹äºæŠ€æœ¯äººå‘˜è€Œè¨€ï¼ŒPPTä¸åœ¨äºæœ‰å¤šç‚«é…·ã€åŠ¨æ•ˆæœ‰å¤šç‰›ï¼Œè€Œåœ¨äºå¯¹å†…å®¹çš„åˆç†çš„ç»„ç»‡ã€‚ç¼ºä¹å†…å®¹çš„PPTï¼Œå³ä¾¿å†ç‚«é…·ä¹Ÿæ— ç”¨ã€‚</p>
<p>ä½œä¸ºå¤šå¹´çš„æŠ€æœ¯äººï¼Œæˆ‘å†™è¿‡å„ç§åœºæ™¯çš„PPTï¼š</p>
<ul>
<li>éƒ¨é—¨æ€»ç»“å¤§ä¼šçš„</li>
<li>èŒç§°ç”³è¯·çš„</li>
<li>å‘ä¸Šæ±‡æŠ¥çš„</li>
<li>æŠ€æœ¯åˆ†äº«ä¼šçš„</li>
<li>æŠ€æœ¯å®£è®²ä¼šçš„</li>
<li>â€¦â€¦</li>
</ul>
<p>æˆ‘è®¤ä¸ºï¼Œåœ¨PPTçš„ç‰ˆå¼ä¸Šï¼Œæˆ‘ä»¬åªéœ€è¦åšåˆ°è®©PPTçœ‹èµ·æ¥å¾ˆå¹²å‡€å°±å¯ä»¥äº†ï¼Œæ²¡å¿…è¦åœ¨PPTçš„æ ·å¼ä¸ŠèŠ±è´¹å¤ªå¤šçš„å¿ƒæ€ã€‚å¹²å‡€è¦æ±‚æˆ‘ä»¬çš„PPTçš„å†…å®¹è¦ï¼šå­—ä½“ç»Ÿä¸€ã€æ ·å¼ç»Ÿä¸€ã€è‰²è°ƒç»Ÿä¸€ï¼Œé£æ ¼ç»Ÿä¸€â€¦â€¦</p>
<p>æœ‰çš„åŒå­¦ï¼ŒåŠ¨ä¸åŠ¨å°±é£˜çº¢ï¼ŒåŠ ç²—ï¼ŒåŠ èƒŒæ™¯ï¼Œå¯èƒ½æ˜¯æƒ³å¼ºè°ƒè¿™é‡Œæ˜¯é‡ç‚¹ï¼Œä½†æ˜¯å½“è¿™ä¸€é¡µä¸­æ‰€æœ‰å†…å®¹éƒ½æœ‰å„ç§æ ·å¼çš„æ—¶å€™ï¼Œä¹Ÿå°±åˆ†ä¸æ¸…å“ªé‡Œæ˜¯é‡ç‚¹ï¼Œå“ªé‡Œæ˜¯éé‡ç‚¹äº†ã€‚ä¸ƒç§é¢œè‰²ä¸€æ··åˆï¼Œé‚£ä¸å°±æˆäº†ç™½è‰²äº†å—ï¼Ÿ</p>
<h2 id="å¦‚ä½•è¿›è¡Œpptçš„æ•´ä½“ç»„ç»‡">å¦‚ä½•è¿›è¡ŒPPTçš„æ•´ä½“ç»„ç»‡</h2>
<p>åœ¨è¯„å®¡è¿‡ç¨‹ä¸­ï¼Œæˆ‘å‘ç°å¤§éƒ¨åˆ†åŒå­¦æ— è®ºæ˜¯åœ¨ææ–™çš„ç»„ç»‡ä¸Šè¿˜æ˜¯åœ¨PPTçš„ç»„ç»‡ä¸Šï¼Œéƒ½æ˜¯ä¹±çš„ä¸€å¡Œç³Šæ¶‚ï¼Œæ²¡æœ‰ä»»ä½•é€»è¾‘å¯è¨€ï¼Œçº¯ç²¹å°±æ˜¯åœ¨ç½—åˆ—ä¸€ä»¶ä»¶è‡ªå·±åšçš„äº‹æƒ…ã€‚</p>
<p>è¿™é‡Œæˆ‘ä»¬è¦æ¸…æ¥šä¸€ç‚¹ï¼šææ–™çš„æ„ä¹‰å’Œä½œç”¨åœ¨äºè¯æ˜æˆ‘ä»¬å·²ç»å…·å¤‡äº†æŸäº›æ–¹é¢çš„èƒ½åŠ›ï¼Œææ–™çš„åŠŸèƒ½å°±æ˜¯è®ºæ®ã€‚åªæœ‰ææ–™ï¼Œæ²¡æœ‰ææ–™æ‰€æ”¯æŒçš„è§‚ç‚¹é‚£åˆæœ‰ä»€ä¹ˆæ„ä¹‰å‘¢ï¼Ÿè®©è¯„å§”é€šè¿‡ææ–™æ¥çŒœå—ï¼Ÿ</p>
<p>å› æ­¤ï¼Œåœ¨ææ–™çš„ç»„ç»‡ä¸Šï¼Œæˆ‘ä¸€èˆ¬æ¨èä½¿ç”¨è®®è®ºæ–‡çš„ä¸‰è¦ç´ æ¥ç»„ç»‡ï¼š</p>
<ul>
<li>è®ºç‚¹</li>
<li>è®ºæ®</li>
<li>è®ºè¯</li>
</ul>
<p>æˆ‘ä»¬éœ€è¦æ ¹æ®è¦è¯æ˜çš„ä¸åŒèƒ½åŠ›æ¥å¯¹ææ–™è¿›è¡Œåˆ†ç±»ï¼Œèšåˆï¼Œç„¶åé€šè¿‡ä¸€å®šçš„è®ºè¯æ–¹æ³•æ¥æ•´åˆè‡ªå·±æ‰€åšçš„æ¯ä¸€ä»¶äº‹æƒ…ã€‚åœ¨æ•´åˆçš„è¿‡ç¨‹ä¸­å¯ä»¥éµå¾ªä»¥ä¸‹çš„å‡ ç‚¹ï¼š</p>
<ul>
<li>
<p>ç»“æ„åŒ–æ€ç»´æ¥ç»„ç»‡ææ–™ï¼š</p>
<ul>
<li>ç»“è®ºå…ˆè¡Œ</li>
<li>ä»¥ä¸Šç»Ÿä¸‹</li>
<li>å½’çº³åˆ†ç»„ï¼šåŒç±»ææ–™å½’ç±»ï¼Œæœ‰æ—¶å€™åŒä¸€ä¸ªææ–™å¯èƒ½è¯´æ˜æˆ‘ä»¬å…·å¤‡å¤šç§èƒ½åŠ›ï¼Œé‚£è¿™ç§æƒ…å†µä¸‹ï¼Œåœ¨ææ–™çš„é€‰æ‹©ä¸Šéœ€è¦æœ‰æ‰€å–èˆï¼Œè¿™ä¸ªææ–™é‡ç‚¹èƒ½è¯´æ˜å“ªäº›èƒ½åŠ›ï¼Ÿæ­£æ‰€è°“â€œæ¨ªçœ‹æˆå²­ä¾§æˆå³°ï¼Œè¿œè¿‘é«˜ä½å„ä¸åŒâ€ã€‚</li>
<li>é€»è¾‘é€’è¿›ï¼šçºµå‘æœ‰é€»è¾‘å…³ç³»ï¼Œæ¨ªå‘æœ‰é€’è¿›å…³ç³»ã€‚<br>
<img src="/2021/02/25/how-to-report-ourselves-work/1.jpeg" alt></li>
</ul>
</li>
<li>
<p>æ¯ä¸€ä¸ªå¤§çš„è®ºç‚¹ä¸‹é¢å¯ä»¥æœ‰å¤šä¸ªä¸åŒçš„åˆ†è®ºç‚¹ï¼Œä½†æ˜¯åˆ‡å¿Œï¼Œåˆ†è®ºç‚¹ä¸å®œè¿‡å¤šï¼Œæœ€å¥½ä¸è¦è¶…è¿‡3ä¸ªã€‚</p>
</li>
<li>
<p>ä¸åŒè®ºç‚¹çš„ç»„ç»‡å¯ä»¥é‡‡ç”¨æ€»åˆ†çš„ç»“æ„ï¼Œä¹Ÿå¯ä»¥é‡‡ç”¨æ€»åˆ†æ€»çš„ç»“æ„ï¼Œå…·ä½“å¯ä»¥æ ¹æ®è‡ªå·±çš„å–œå¥½é€‰æ‹©ä¸€ç§ã€‚</p>
</li>
<li>
<p>æ•´ä¸ªPPTçš„æ‰€æœ‰é¡µé¢éƒ½æ˜¯æœ‰é€»è¾‘å…³ç³»çš„ï¼Œéœ€è¦è®¤çœŸè€ƒè™‘ä¸Šä¸‹é¡µä¹‹é—´çš„å…³è”å’Œè¡”æ¥ã€‚</p>
</li>
</ul>
<h2 id="å¦‚ä½•é€‰æ‹©pptçš„ææ–™">å¦‚ä½•é€‰æ‹©PPTçš„ææ–™</h2>
<p>åœ¨ç¡®å®šäº†PPTçš„å¤§çš„ç»„ç»‡æ–¹å¼ä¹‹åï¼Œåœ¨æ­£å¼å¼€å§‹ä¹‹å‰ï¼Œä¹Ÿéœ€è¦å¯¹è‡ªå·±çš„æ‰€æœ‰çš„ææ–™è¿›è¡Œç”„é€‰ï¼Œéœ€è¦æ˜ç¡®å¥½è¦é€‰æ‹©é‚£äº›ææ–™ï¼Œè¦æ”¾å¼ƒé‚£äº›ææ–™ï¼Œä¸åŒçš„ææ–™ç”¨æ¥æ”¯æ’‘é‚£äº›è®ºç‚¹ç­‰ã€‚åœ¨é€‰æ‹©ææ–™çš„æ—¶å€™ï¼Œå¯ä»¥éµå¾ªä»¥ä¸‹çš„å‡ ç‚¹ï¼š</p>
<ul>
<li>é‡è¦çš„å†…å®¹è¯´ä¸‰éï¼Œå¯¹äºç‰¹åˆ«é‡è¦çš„å†…å®¹ï¼Œå¯ä»¥é‡å¤æåŠï¼Œä½†æ˜¯è¦ä»ä¸åŒçš„å±‚é¢æ¥æåŠï¼Œè€Œä¸æ˜¯ç®€å•çš„é‡å¤åŒæ ·çš„å†…å®¹ã€‚å¦‚æœè¦å¼ºè°ƒè‡ªå·±çš„æŠ€æœ¯èƒ½åŠ›ï¼Œå¯ä»¥é€šè¿‡ï¼šæŠ€æœ¯è°ƒç ”ï¼Œæ”»å…‹æŠ€æœ¯éš¾ç‚¹ï¼Œè‡ªç ”æ ¸å¿ƒå¡è„–å­æŠ€æœ¯ç­‰å¤šä¸ªæ–¹é¢æ¥å†™ã€‚åŒæ ·æ˜¯å†™å®¹è²Œï¼Œå¯ä»¥ä»æ²‰é±¼ã€è½é›ã€é—­æœˆã€ç¾èŠ±ç­‰æ–¹é¢æ¥åå¤é™ˆè¿°ã€‚</li>
<li>é€šè¿‡åˆ«äººçš„è¯„ä»·æ¥è¯æ˜è‡ªå·±çš„èƒ½åŠ›ã€‚é›·å£«ç…§æ˜åˆ›å§‹äººå´é•¿æ±Ÿè¯´ï¼šäººç”Ÿäº”å¤§å‘å±•é˜¶æ®µï¼Œé¦–å…ˆè‡ªå·±è¦è¡Œï¼›å…¶æ¬¡è¦æœ‰äººè¯´ä½ è¡Œï¼›å†æ¬¡ï¼Œè¯´ä½ è¡Œçš„äººè¦è¡Œï¼›ç„¶åï¼Œä½ è¯´è°è¡Œè°å°±è¡Œï¼›æœ€åï¼Œè°æ•¢è¯´ä½ ä¸è¡Œã€‚å› æ­¤ï¼Œåœ¨é€‰æ‹©åˆ«äººè¯„ä»·çš„æ—¶å€™è¦é€‰æ‹©é‚£äº›é‡é‡çº§çš„äººç‰©ï¼Œé€‰æ‹©é‚£äº›å¤§å®¶å…¬è®¤çš„â€œèƒ½è¡Œâ€çš„äººç‰©ã€‚</li>
</ul>
<p>å½“æŒ‰ç…§ç»“æ„åŒ–æ€ç»´ç¡®å®šäº†PPTçš„æ•´ä½“ç»„ç»‡ï¼Œå¹¶ä¸”æŒ‰ç…§PPTçš„æ•´ä½“ç»„ç»‡é€‰å®šäº†ææ–™åï¼Œå¦‚æœæ­¤æ—¶ææ–™ä»ç„¶æ¯”è¾ƒå¤šï¼Œè¯¥å¦‚ä½•å¤„ç†å‘¢ï¼Ÿæ€ä»¬æ¥ç¡®å®šå“ªäº›ææ–™è¦æ”¾åœ¨å‰é¢ï¼Œå“ªäº›ææ–™éœ€è¦åˆ å‡ï¼Ÿæˆ‘ä¸€èˆ¬é‡‡ç”¨çš„æ–¹æ³•æ˜¯æŠŠææ–™åˆ’åˆ†ä¸º5ç±»ï¼š</p>
<ul>
<li>ç—›ç‚¹ææ–™ï¼šè§£å†³ç—›ç‚¹é—®é¢˜çš„ææ–™ï¼Œä¾‹å¦‚æ‰‹æœºä¸Šå¤©å¤©æœ‰éªšæ‰°ç”µè¯ã€åƒåœ¾çŸ­ä¿¡ï¼Œæœ‰äº†å·ç é€šï¼Œä¸€åˆ‡éƒ½è§£å†³äº†ã€‚</li>
<li>å…´å¥‹ç‚¹ææ–™ï¼šè¿™ç±»ææ–™å¯ä»¥è®©åˆ«äººæœ‰çœ¼å‰ä¸€äº®çš„â€œå“‡å¡â€æ„Ÿï¼Œå°±å¥½åƒæ˜¯ç‚çƒ­å¤å¤©æ—¶å–ä¸‹çš„é‚£å£å†°çº¢èŒ¶ã€‚</li>
<li>ç—’ç‚¹ææ–™ï¼šè¿™ç§ææ–™è§£å†³çš„é—®é¢˜ä¸ä¸€å®šæ˜¯ç—›ç‚¹é—®é¢˜ï¼Œä½†æ˜¯è®²å‡ºæ¥ä¹‹ååˆ«äººä¹Ÿæƒ³å°è¯•ã€‚</li>
<li>ä¸ç—›ä¸ç—’çš„ææ–™ï¼šå¯åšå¯ä¸åšï¼Œä½†æ˜¯æˆ‘ä»¬åšäº†ï¼Œæ•ˆæœå±‚é¢åˆä¸å¤ªå¥½è¯´çš„ææ–™ã€‚</li>
<li>å¸¸è§„ææ–™ï¼šæ—¥å¸¸çš„å¸¸è§„å·¥ä½œã€‚</li>
</ul>
<p>åœ¨å¯¹ææ–™æ’åºçš„æ—¶å€™ï¼Œä¼˜å…ˆé€‰æ‹©ç—›ç‚¹ææ–™å’Œå…´å¥‹ç‚¹ææ–™ï¼Œå¯ä»¥é…Œæƒ…é€‰æ‹©ç—’ç‚¹ææ–™ï¼Œå°½é‡åˆ å‡ä¸ç—›ä¸ç—’çš„ææ–™å’Œå¸¸è§„ææ–™ã€‚</p>
<h2 id="å¦‚ä½•ç»„ç»‡æ¯ä¸ªææ–™">å¦‚ä½•ç»„ç»‡æ¯ä¸ªææ–™</h2>
<p>å¥½å¤šçš„ææ–™éƒ½æ˜¯åœ¨è®°æµæ°´è´¦ï¼Œæ¯”å¦‚ï¼šéƒ½æ˜¯æˆ‘ä¼˜åŒ–äº†ç®—æ³•ï¼Œä¼˜åŒ–äº†æµç¨‹ï¼Œä¼˜åŒ–äº†â€¦â€¦æˆ‘å¹²äº†è¿™ä¸ªï¼Œåšäº†é‚£ä¸ªï¼Œâ€¦â€¦</p>
<p>æ¯æ¬¡çœ‹åˆ°è¿™ç§ææ–™ï¼Œæˆ‘å°±ä¼šå¾ˆæ°”æ„¤ï¼Œæˆ‘å°±å¿ä¸ä½çš„æƒ³æ‰“ä½åˆ†ï¼Œè¿™ç§ææ–™æ¯«æ— è¥å…»å¯è¨€ï¼Œæ¯«æ— ä¿¡æ¯é‡å¯è¨€ã€‚</p>
<p>æ¯ä¸ªææ–™éƒ½åº”è¯¥æ˜¯ä¸€ä¸ªå®Œæ•´çš„æ•…äº‹å•å…ƒï¼Œæ¯ä¸ªææ–™éƒ½åº”è¯¥ç”¨æœ€ç®€çŸ­çš„å†…å®¹ä½“ç°å‡ºæœ€å¤§çš„ä¿¡æ¯é‡ï¼Œå¦‚ä½•æ‰èƒ½åšåˆ°è¿™ä¸€ç‚¹å‘¢ï¼Ÿ</p>
<p>æˆ‘ä¸€èˆ¬é‡‡ç”¨çš„åŸåˆ™å°±æ˜¯STARåŸåˆ™ï¼š</p>
<ul>
<li>Sï¼ˆSituationï¼‰æƒ…å¢ƒï¼šåšè¿™ä¸ªäº‹æƒ…çš„èƒŒæ™¯ä¸‹æ˜¯ä»€ä¹ˆï¼Ÿ</li>
<li>Tï¼ˆTargetï¼‰ä»»åŠ¡/ç›®æ ‡ï¼šåšè¿™ä¸ªäº‹æƒ…è¦è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Œè¦è¾¾åˆ°çš„ç›®æ ‡æ˜¯ä»€ä¹ˆï¼Ÿ</li>
<li>Aï¼ˆActionï¼‰è¡ŒåŠ¨ï¼šåœ¨æ•´ä¸ªé¡¹ç›®ä¸­æˆ‘ä»¬åšäº†ä»€ä¹ˆï¼Ÿ</li>
<li>Rï¼ˆResultï¼‰ç»“æœï¼šæœ€ç»ˆçš„ç»“æœå¦‚ä½•ï¼Ÿä»·å€¼æ˜¯æ€æ ·çš„ï¼Ÿæ”¶ç›Šæ˜¯æ€æ ·çš„ï¼Ÿ</li>
</ul>
<p><img src="/2021/02/25/how-to-report-ourselves-work/2.png" alt></p>
<p>æŒ‰ç…§å¦‚ä¸Šçš„åŸåˆ™ç»„ç»‡çš„ææ–™é¦–å…ˆèƒ½åœ¨èƒŒæ™¯æ–¹é¢è®²æ‰€æœ‰äººæ‹‰åˆ°ä¸€ä¸ªåœºæ™¯ä¸‹æ¥æ€è€ƒé—®é¢˜ï¼Œä¿è¯å¤§å®¶çš„åŸºå‡†æ˜¯ä¸€è‡´çš„ã€‚</p>
<p>å¦å¤–ï¼ŒèƒŒæ™¯çš„æ„ä¹‰è¿˜åœ¨äºå¤§å®¶ä¼šé€šè¿‡èƒŒæ™¯æ¥äº†è§£åˆ°æˆ‘ä»¬æ‰€åšå·¥ä½œé¢ä¸´çš„éš¾åº¦ï¼Œæˆ‘ä»¬è¦è§£å†³çš„ç›®æ ‡çš„å¤æ‚åº¦ã€‚éš¾åº¦ï¼Œå¤æ‚åº¦å†³å®šäº†æˆ‘ä»¬çš„é«˜åº¦ã€‚æœ‰äº›æ—¶å€™ï¼Œéš¾åº¦ä¸æ˜¯æˆ‘ä»¬è¯´å‡ºæ¥çš„ï¼Œè€Œæ˜¯åœ¨æˆ‘ä»¬ä»‹ç»å®ŒèƒŒæ™¯ä¹‹åå¤§å®¶çš„å…±è¯†ã€‚</p>
<p>èƒŒæ™¯è¦åšåˆ°å°‘ä¸€å­—åˆ™è§£é‡Šä¸æ¸…æ¥šï¼Œå¤šä¸€å­—åˆ™æ˜¯ç´¯èµ˜çš„è¦æ±‚ï¼Œåˆ‡å¿Œé•¿ç¯‡å¤§è®ºã€‚å¼±æ°´ä¸‰åƒï¼Œåªå–ä¸€ç“¢é¥®ã€‚å“å“å“æ•´é¡µæ•´é¡µçš„ä¸Šæ¶æ„å›¾å¹²å˜›å‘€ã€‚</p>
<p>ç„¶ååœ¨å¯¹é—®é¢˜æœ‰äº†ä¸€è‡´è®¤è¯†çš„æƒ…å†µä¸‹ï¼Œæ‰èƒ½è¯„ä¼°æˆ‘ä»¬æ‹†è§£çš„ç›®æ ‡æ˜¯ä¸æ˜¯åˆç†çš„ï¼Œå¦‚æœè¿ç›®æ ‡éƒ½ä¸åˆç†ï¼Œé‚£ä¹ˆåŸºæœ¬ä¸Šåé¢æ‰€æœ‰çš„å†…å®¹å°±æ²¡æœ‰ä»€ä¹ˆæ„ä¹‰äº†ã€‚</p>
<p>æœ‰äº†èƒŒæ™¯ï¼Œæœ‰äº†ç›®æ ‡ï¼Œæˆ‘ä»¬çš„è¡ŒåŠ¨æ‰æ›´æœ‰æ„ä¹‰ï¼Œæ‰èƒ½ä½“ç°å‡ºæˆ‘ä»¬çš„æŠ€æœ¯èƒ½åŠ›ï¼Œè§£å†³é—®é¢˜çš„èƒ½åŠ›â€¦â€¦</p>
<p>æœ€é‡è¦çš„æ˜¯ï¼Œæˆ‘ä»¬åšçš„äº‹æƒ…æ˜¯æœ‰ç»“æœçš„ï¼Œæ‰€ä»¥æœ€ç»ˆçš„ç»“æœä¹Ÿæ˜¯ä¸å¯æˆ–ç¼ºçš„å†…å®¹ã€‚åªæœ‰ç»“æœæ²¡æœ‰è¿‡ç¨‹ï¼Œé‚£æˆåŠŸå°±ä¸å¯å¤åˆ¶ï¼›åªæœ‰è¿‡ç¨‹ï¼Œæ²¡æœ‰ç»“æœï¼Œé‚£è¿‡ç¨‹å°±æ˜¯åƒåœ¾ã€‚</p>
<h4 id="å¸é©¬å…‰ç ¸ç¼¸çš„ææ–™">å¸é©¬å…‰ç ¸ç¼¸çš„ææ–™</h4>
<p>ä»¥å¸é©¬å…‰ç ¸ç¼¸ä¸ºä¾‹ï¼Œä¸ºäº†ä½“ç°å¸é©¬å…‰çš„è‹±å‹‡æœæ•¢ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰STARåŸåˆ™æ¥ç»„ç»‡ææ–™ï¼š</p>
<ul>
<li>Sï¼šä¸€ç¾¤å°å­©åœ¨é™¢å­é‡Œç©é—¹ï¼Œå…¶ä¸­ä¸€ä¸ªå°å­©çˆ¬åˆ°äº†æ°´ç¼¸è¾¹æ²¿ï¼Œä¸€ä¸å°å¿ƒï¼Œè·Œå…¥äº†æ°´ç¼¸æ²¡å…¥æ°´ä¸­ï¼Œå…¶ä»–å°å­©éƒ½å“è·‘äº†ã€‚</li>
<li>Tï¼šè¦æŠŠå°å­©æ•‘å‡ºæ¥ã€‚</li>
<li>Aï¼šå¸é©¬å…‰æ‹¿èµ·çŸ³å¤´ï¼Œç ¸ç ´äº†æ°´ç¼¸ã€‚</li>
<li>Rï¼šæ°´ä»æ°´ç¼¸é‡Œæµäº†å‡ºæ¥ï¼Œå°å­©å¾—æ•‘äº†ã€‚</li>
</ul>
<p><img src="/2021/02/25/how-to-report-ourselves-work/3.jpeg" alt></p>
<p>å¦‚æœæŒ‰ç…§ä¹‹å‰çš„ææ–™å†™æ³•ï¼Œé‚£ä¹ˆè¿™ä¸ªææ–™å°±æˆäº†ï¼šå¸é©¬å…‰æ‹¿èµ·çŸ³å¤´ï¼Œç ¸ç ´äº†æ°´ç¼¸ã€‚å¦‚æœæ˜¯è¿™æ ·çš„è¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•æ ¹æ®è¿™ä¸ªææ–™æ¥å¯¹å¸é©¬å…‰åšå‡ºè¯„ä»·å‘¢ï¼Ÿ</p>
<h2 id="å¦‚ä½•å¤„ç†ä¸åŒçº§åˆ«ä½¿ç”¨åŒä¸€ææ–™çš„åœºæ™¯">å¦‚ä½•å¤„ç†ä¸åŒçº§åˆ«ä½¿ç”¨åŒä¸€ææ–™çš„åœºæ™¯</h2>
<p>æˆ‘ç»å¸¸ä¼šå‘ç°å¾ˆå¤šä¸åŒçš„çº§åˆ«ä¼šå¼•ç”¨åŒæ ·çš„é¡¹ç›®ï¼Œä½†æ˜¯åœ¨ææ–™çš„è¡¨è¿°ä¸Šï¼ŒåˆåŸºæœ¬ä¸€è‡´ã€‚å¦‚æœæ˜¯è¿™æ ·ï¼Œé‚£ä¹ˆé«˜çº§åˆ«çš„åŒå­¦å¦‚ä½•èƒ½ä½“ç°å‡ºè‡ªå·±çš„ä»·å€¼å‘¢ï¼Ÿ</p>
<p>ä¸€ä¸ªé¡¹ç›®ç¡®å®æ˜¯ç”±ä¸€ä¸ªå›¢é˜Ÿæ¥å®Œæˆçš„ï¼Œä½†æ˜¯è¿™ä¸ªå›¢é˜Ÿçš„ç»„æˆæ˜¯ä¸åŒçš„ï¼Œå°±åƒç¯®çƒé˜Ÿä¸€æ ·ï¼Œæœ‰ï¼š</p>
<ul>
<li>æ•™ç»ƒ</li>
<li>å‰é”‹
<ul>
<li>å°å‰é”‹</li>
<li>å¤§å‰é”‹</li>
</ul>
</li>
<li>ä¸­é”‹</li>
<li>åå«
<ul>
<li>æ§çƒåå«</li>
<li>å¾—åˆ†åå«</li>
</ul>
</li>
</ul>
<p>å®Œæˆä¸€ä¸ªé¡¹ç›®çš„ä¼—å¤šå›¢é˜Ÿæˆå‘˜ä¸­ä¹Ÿä¼šæœ‰ä¸åŒçš„çº§åˆ«ï¼Œè€Œä¸åŒçš„çº§åˆ«æ‰€æ‹…è´Ÿçš„èŒèƒ½å’Œè´£ä»»ä¹Ÿä¸å°½ç›¸åŒã€‚å› æ­¤ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåœ¨ææ–™çš„å‡†å¤‡ä¸Šï¼Œè¦ä½“ç°å‡ºç¬¦åˆè‡ªå·±æ‰€å¤„çº§åˆ«è¦æ±‚çš„ææ–™ã€‚</p>
<h2 id="å¦‚ä½•ç»„ç»‡å·¥ä½œæ”¶ç›Š">å¦‚ä½•ç»„ç»‡å·¥ä½œæ”¶ç›Š</h2>
<p>æˆ‘çœ‹åˆ°æœ€å¤šçš„ææ–™æ”¶ç›Šæ˜¯ä¸‹é¢çš„æ ·å­ï¼š</p>
<ul>
<li>æˆ‘çš„æŠ€æœ¯ç´¯è®¡ä»£ç è¡Œæ•°xxxè¡Œ</li>
<li>æˆ‘çš„æŠ€æœ¯è¢«å¤šå°‘äº§å“çº¿ä½¿ç”¨</li>
<li>æˆ‘å¼€å‘äº†å¤šå°‘æ¥å£</li>
<li>æˆ‘çš„æ¥å£è¢«è°ƒç”¨äº†å¤šå°‘æ¬¡</li>
<li>â€¦â€¦</li>
</ul>
<p>ä½†æ˜¯ï¼Œåœ¨æˆ‘çœ‹æ¥ï¼Œè¿™äº›ä¸æ˜¯å…·ä½“çš„æ”¶ç›Šï¼Œè¿™äº›ä¸è¿‡æ˜¯ä¸€ä¸ªç»“æœè€Œå·²ã€‚ä»¥å¸é©¬å…‰ç ¸ç¼¸ä¸ºä¾‹ï¼Œè¿™å°±å¥½æ¯”æ˜¯ï¼šå°å­©è·Œå…¥æ°´ç¼¸ï¼Œæ²¡å…¥æ°´ä¸­ï¼Œå¸é©¬å…‰æ‹¿èµ·çŸ³å¤´ï¼Œç ¸ç ´æ°´ç¼¸ï¼Œæ°´æµäº†å‡ºæ¥ã€‚</p>
<p>å¦‚ä¸Šçš„è¿™ç§ç»“æœçš„å†™æ³•ï¼Œè¿™ç§æ”¶ç›Šçš„å†™æ³•ï¼Œåœ¨æˆ‘çœ‹æ¥æ˜¯ä¸å®Œæ•´çš„ã€‚</p>
<p>æˆ‘ä»¬åœ¨å†™æ”¶ç›Šçš„æ—¶å€™ï¼Œéœ€è¦ç‰¹åˆ«æ³¨æ„è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬è¦å¤šé—®è‡ªå·±å‡ ä¸ªï¼šç„¶åå‘¢ï¼Ÿ</p>
<p>æ°´æµäº†å‡ºæ¥ï¼Œç„¶åå‘¢ï¼Ÿ</p>
<p>æ°´æµäº†å‡ºæ¥ä¸æ˜¯æ”¶ç›Šï¼Œä¸æ˜¯ä»·å€¼ï¼Œå°å­©å¾—æ•‘äº†æ‰æ˜¯æœ€å¤§çš„ä»·å€¼ã€‚å¼€å‘äº†å‡ ç™¾ä¸ªæ¥å£æ˜¯ç°å®ï¼Œç„¶åå‘¢ï¼Ÿè¿™äº›æ¥å£æå‡äº†50%çš„ç ”å‘æ•ˆç‡ï¼Œè¿™æ‰æ˜¯ä»·å€¼ã€‚</p>
<p>ç›®æ ‡æ˜¯ä¸šåŠ¡ä»·å€¼ï¼ŒæŠ€æœ¯æ”¹è¿›åªæ˜¯æ‰‹æ®µè€Œå·²ï¼ŒåšæŠ€æœ¯æ”¹è¿›çš„ç›®æ ‡ä¸æ˜¯ä¸ºäº†å¤šå°‘æ¬¡çš„æ¥å£è°ƒç”¨ï¼Œè€Œæ˜¯å®ç°ä¸šåŠ¡ä»·å€¼ã€‚å› æ­¤ï¼Œåœ¨æ”¶ç›Šéƒ¨åˆ†è¦æ˜ç¡®å¥½ç›®æ ‡å’Œæ‰‹æ®µçš„å…³ç³»ã€‚</p>
<h2 id="å¦‚ä½•ç»„ç»‡-ä¸ªäººä»‹ç»">å¦‚ä½•ç»„ç»‡â€œä¸ªäººä»‹ç»â€</h2>
<p>å¹³æ—¶å°±è®©æ‰€æœ‰çš„äººå°±å¯¹æˆ‘ä»¬å°±éå¸¸äº†è§£æ˜¯ä¸€ä»¶éå¸¸éš¾çš„äº‹ã€‚å› æ­¤ï¼Œåœ¨è¿™ç§åœºæ™¯ä¸‹ï¼Œä¸€ä»½å®Œç¾çš„ä¸ªäººä»‹ç»ææ–™å°±ç›¸å½“äºæ˜¯ï¼šä¸‡äº‹å¼€å¤´éš¾ã€‚</p>
<p>æœ‰äº›åŒå­¦åœ¨è¿™ä¸€é¡µç»„ç»‡çš„çš„è¿‡äºéšæ„ï¼Œåªæ˜¯ç®€å•ç½—åˆ—ä¸€ä¸‹è‡ªå·±çš„å·¥ä½œç»å†å°±è‰è‰äº†äº‹ã€‚æ®Šä¸çŸ¥ï¼Œè¿™ç§å†…å®¹è¿˜ä¸å¦‚æ²¡æœ‰ã€‚è‰è‰äº†äº‹å¾€å¾€ä¼šç»™äººä¸å¥½çš„å°è±¡ï¼Œå¾€å¾€ä»ä¸€å¼€å§‹å°±æ‹‰ä½äº†è‡ªå·±åœ¨åˆ«äººä¸­çš„å±‚çº§ã€‚è¿™ç§æ—¶å€™å°±å±äºï¼šæ²¡æœ‰å°è±¡æ¯”æœ‰ä¸€ä¸ªæ¯”è¾ƒå·®çš„å°è±¡è¦å¥½å¾ˆå¤šã€‚</p>
<p>å…¶å®ï¼Œä¸ªäººä»‹ç»è¿™ä¸€é¡µçš„å†…å®¹ä¸åœ¨å¤šï¼Œè€Œåœ¨äºå¼•å¯¼åˆ«äººä»å“ªä¸ªè§’åº¦æ¥è¯„ä»·è‡ªå·±ï¼Œåœ¨äºå¼•å¯¼åˆ«äººç»™è‡ªå·±æ‰“ä¸Šä¸€ä¸ªä»€ä¹ˆæ ‡ç­¾ï¼Œåœ¨äºå¼•å¯¼åˆ«äººç¡®å®šè‡ªå·±çš„å±‚çº§â€¦â€¦</p>
<p>å› æ­¤ï¼Œè¿™ä¸€é¡µçš„ææ–™ç»„ç»‡è¦ç‰¹åˆ«ç”¨å¿ƒï¼Œè¦ä»è‡ªå·±å–å¾—çš„æˆå°±æ¥é“ºå¼€ï¼Œè¦é’ˆå¯¹è‡ªå·±æœŸæœ›çš„æ ‡ç­¾æ¥é“ºå¼€ã€‚æ¯”å¦‚è¦ä½“ç°è‡ªå·±çš„æŠ€æœ¯å“è¶Šï¼Œå¯ä»¥ä»ï¼šä¸“åˆ©ï¼Œè·å¾—çš„é«˜ä»·å€¼çš„æŠ€æœ¯åˆ›æ–°å¥–ç­‰æ–¹é¢æ¥å±•å¼€ã€‚å› ä¸ºï¼Œè¿™äº›å¥–é¡¹çš„è·å–ï¼Œæ˜¯ç»è¿‡äº†å®¡æ ¸å’Œè®¤è¯çš„ï¼Œæ˜¯å¤§å®¶å…¬è®¤çš„ï¼Œæ˜¯ä¸éœ€è¦åˆ«äººå†åšäºŒæ¬¡è¯„ä¼°çš„ã€‚</p>
<p>å› æ­¤ï¼Œä¸ªäººä»‹ç»ä¸­çš„ææ–™éœ€è¦æœ¬ç€å¦‚ä¸‹çš„åŸåˆ™ï¼š</p>
<ul>
<li>ææ–™è¶³å¤Ÿç²¾ç®€ä½†è¦è¶³å¤Ÿé—ªå…‰</li>
<li>ææ–™ä¸éœ€è¦åˆ«äººäºŒæ¬¡è¯„ä¼°</li>
<li>æ ¹æ®æœŸæœ›åˆ«äººå¦‚ä½•å®šä½è‡ªå·±æ¥ç»„ç»‡ææ–™</li>
</ul>
<h2 id="å¦‚ä½•åº”å¯¹åˆ«äººçš„è´¨ç–‘">å¦‚ä½•åº”å¯¹åˆ«äººçš„è´¨ç–‘</h2>
<p>æ‰€æœ‰äººéƒ½ä¼šå­˜åœ¨å¿ƒç†ä¸Šçš„è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶ï¼Œå½“åˆ«äººè´¨ç–‘æˆ‘ä»¬çš„æ—¶å€™ï¼Œè¿™ç§è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶å°±ä¼šä¸è‡ªç„¶å¼€å¯ã€‚æ­¤æ—¶ï¼Œä¸ºäº†å‡è½»åˆ«äººçš„è´¨ç–‘æ‰€äº§ç”Ÿçš„ç´§å¼ å’Œç„¦è™‘ï¼Œæˆ‘ä»¬ä¼šæ‰¾ä¸€äº›è¡¨é¢ä¸Šå† å†•å ‚çš‡çš„ç†ç”±æ¥ä¸ºè‡ªå·±è¾©æŠ¤ä»¥è‡ªåœ†å…¶è¯´ï¼Œå½“ç„¶è¿™äº›ç†ç”±æ˜¯ç»ä¸èµ·æ¨æ•²çš„ï¼Œå¹¶éçœŸç†ç”±ï¼Œä¹Ÿéå¥½ç†ç”±ã€‚</p>
<p><img src="/2021/02/25/how-to-report-ourselves-work/5.gif" alt></p>
<p>è¿˜ä¼šæœ‰åŒå­¦è‡ªå‘½ä¸å‡¡ï¼Œè§‰å¾—è¯„å§”ä»€ä¹ˆéƒ½ä¸æ‡‚ï¼Œå°±æ˜¯ååœ¨ä¸‹é¢ä¸åœçš„çé—®ï¼Œæ‰€ä»¥åœ¨å›ç­”è¯„å§”çš„é—®é¢˜ä¸Šï¼Œä¹Ÿä¼šæ˜¾å¾—æ¼«ä¸ç»å¿ƒã€‚</p>
<p>æˆ‘ä»¬éƒ½æ˜¯å‡¡äººï¼Œå‡­ä»€ä¹ˆæˆ‘ä»¬è®²çš„å†…å®¹åˆ«äººå°±ä¸èƒ½æœ‰ç–‘é—®å‘¢ï¼Ÿå‡­ä»€ä¹ˆè¦æ±‚åˆ«äººå°±å¿…é¡»è®¤åŒæˆ‘ä»¬çš„è§‚ç‚¹å‘¢ï¼Ÿ</p>
<p>æœ‰æ—¶å€™ï¼Œæœ‰è´¨ç–‘å°±æ˜¯æˆ‘ä»¬ä½“ç°è‡ªå·±çš„ç»ä½³æ—¶åˆ»ï¼Œå› ä¸ºè´¨ç–‘ï¼Œæˆ‘ä»¬æ‰èƒ½åˆ©ç”¨è¿™ç§æœºä¼šæ¥æ›´è¯¦ç»†çš„é˜è¿°è‡ªå·±æ‰€åšçš„äº‹æƒ…çš„æ€è·¯å’Œä»·å€¼ã€‚æˆ‘ä»¬ä¹‹å‰è®²è¿‡ï¼šé‡è¦çš„äº‹æƒ…è¯´ä¸‰éï¼Œå…¶å®ï¼Œåœ¨å›ç­”é—®é¢˜æ—¶ï¼Œå°±æ˜¯å…¶ä¸­çš„ä¸€éå‘€ã€‚å°†åˆ«äººä»è´¨ç–‘å¸¦å…¥åˆ°è®¤åŒçš„è¿‡ç¨‹ï¼Œæ˜¯ä¸€ä¸ªå‘ˆç°è‡ªå·±çš„è‰¯å¥½çš„æœºä¼šã€‚</p>
<p>åœ¨åº”å¯¹åˆ«äººçš„è´¨ç–‘çš„æ—¶å€™ï¼Œéœ€è¦éµå¾ªå¦‚ä¸‹çš„åŸåˆ™ï¼š</p>
<ul>
<li>æŠŠå›ç­”è´¨ç–‘çœ‹ä½œæ˜¯ä¸€ä¸ªåˆ†äº«æˆæœçš„è¿‡ç¨‹ï¼Œé¿å…å¯åŠ¨è‡ªæˆ‘å¿ƒç†ä¿æŠ¤</li>
<li>å…ˆæƒ³æ¸…æ¥šåˆ«äººè´¨ç–‘çš„ç‚¹åœ¨å“ªé‡Œï¼Œä¸è¦ç­”éæ‰€é—®ï¼Œä¹±è¯´ä¸€é€š</li>
<li>æŒæ¡æ•´ä¸ªç­”ç–‘çš„ä¸»åŠ¨æƒï¼Œåˆ«è¢«åˆ«äººç‰µç€é¼»å­èµ°</li>
</ul>
]]></content>
      <categories>
        <category>æ–‡åŒ–</category>
      </categories>
      <tags>
        <tag>æ±‡æŠ¥</tag>
        <tag>è¿°èŒ</tag>
      </tags>
  </entry>
  <entry>
    <title>HDRæŠ€æœ¯å¯¼è®º</title>
    <url>/2021/01/26/HDR-introduction/</url>
    <content><![CDATA[<p>çœŸå®ä¸–ç•Œçš„äº®åº¦èŒƒå›´æ˜¯ååˆ†å¹¿é˜”çš„ï¼Œè€Œäººçœ¼èƒ½æ„ŸçŸ¥åˆ°çš„äº®åº¦èŒƒå›´åœ¨åä¸‡å°¼ç‰¹å·¦å³ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œç”¨åˆ†å…‰è‰²åº¦è®¡æµ‹é‡å‘ç€é˜³å…‰ç››å¼€çš„èŠ±æœµï¼Œå…¶é»„è‰²åŒºåŸŸäº®åº¦æœ€é«˜å¯è¾¾14700å°¼ç‰¹ï¼Œè¾¹ç¼˜çš„çº¢è‰²æ˜¯2300å°¼ç‰¹ï¼Œä¸­å¤®çš„èŠ±è•Šå’Œç»¿å¶åªæœ‰200å°¼ç‰¹ä»¥ä¸‹ã€‚ä½†æ˜¯ï¼Œåœ¨çª„è‰²åŸŸã€äº®åº¦æ™®éä¸è¶…è¿‡100å°¼ç‰¹ã€å¯¹æ¯”åº¦ä¹Ÿåªæœ‰1000ï¼š1çš„SDRæ˜¾ç¤ºå™¨ä¸‹ï¼Œè¿™å¼ ç…§ç‰‡çš„è‰²å½©ä¼šæš—æ·¡å¾ˆå¤šã€‚ä½†æ˜¯éšç€æŠ€æœ¯çš„å‘å±•ï¼ŒHDRæŠ€æœ¯å¯ä»¥è¾¾åˆ°å¹¿è‰²åŸŸã€1000å°¼ç‰¹äº®åº¦ä»¥åŠä¸Šä¸‡çš„å¯¹æ¯”åº¦ã€‚è™½ç„¶å’Œç°å®æ ‡å‡†ç›¸å·®è¿˜æ˜¯æ¯”è¾ƒå¤§ï¼Œä½†æ˜¯ç›¸è¾ƒäºä¸‰åå¹´å‰çš„SDRï¼ŒHDRè¿˜æ˜¯å‰è¿›äº†ä¸€å¤§æ­¥ã€‚</p>
<p><img src="/2021/01/26/HDR-introduction/nit.jpg" alt></p>
<span id="more"></span>
<h2 id="hdrä»‹ç»">HDRä»‹ç»</h2>
<p>HDRæ˜¯<em>High Dynamic Range</em>çš„ç¼©å†™ã€‚HDRæ˜¯ä¸€ç§æ•°å­—å›¾åƒæŠ€æœ¯ï¼Œå¯ä»¥åˆ©ç”¨è¿™ç§æŠ€æœ¯æ¥æå‡æ•°å­—å›¾åƒçš„è‰²å½©ä»¥åŠå¯¹æ¯”åº¦çš„èŒƒå›´ã€‚</p>
<p>å’ŒSDRï¼ˆ<em>Standard Dynamic Range</em>ï¼šæ ‡å‡†åŠ¨æ€èŒƒå›´ï¼‰ç›¸æ¯”ï¼ŒHDRå…·æœ‰å¦‚ä¸‹ç‰¹ç‚¹ï¼š</p>
<ul>
<li>æ›´å®½çš„è‰²å½©èŒƒå›´</li>
<li>æ›´äº®çš„äº®åº¦ä¸Šé™</li>
<li>æ›´é»‘çš„äº®åº¦ä¸‹é™</li>
<li>åœ¨å¯¹æ¯”åº¦ã€ç°åº¦åˆ†è¾¨ç‡ç­‰ç»´åº¦ä¸Šå¯¹å½±åƒè´¨é‡ä¸Šè¿›è¡Œäº†æ•´ä½“æå‡</li>
</ul>
<p>ä»è€Œï¼ŒHDRå¯ä»¥ç»™ç”¨æˆ·å¸¦æ¥æ›´å…·æ²‰æµ¸å¼çš„æ„Ÿå—ã€‚</p>
<p>HDRæŠ€æœ¯å¯ä»¥åº”ç”¨äºæ‹ç…§ï¼ˆ<em>photography</em>ï¼‰å’Œè§†é¢‘ï¼ˆ<em>video</em>ï¼‰ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼šè™½ç„¶<code>photo HDR</code>å’Œ<code>video HDR</code>çš„ç›®æ ‡éƒ½æ˜¯è®©æˆ‘ä»¬æ‰€çœ‹åˆ°çš„æ•°å­—å†…å®¹æ›´é€¼è¿‘äººçœ¼çš„çœŸå®ä½“éªŒï¼Œä½†æ˜¯è¿™ä¸¤è€…ç¡®å®æ˜¯å®Œå…¨ä¸åŒçš„ä¸¤ä¸ªæ¦‚å¿µã€‚æœ¬è´¨ä¸Šè®²ï¼Œ<code>photo HDR</code>æ˜¯ä¸€ä¸ªç›¸æœºæ•è·ç…§ç‰‡ï¼ˆ<em>capture</em>ï¼‰çš„è¿‡ç¨‹ï¼Œè€Œ<code>video HDR</code>åˆ™æ˜¯ä¸€ä¸ªæ˜¾ç¤º(<em>display</em>)çš„è¿‡ç¨‹ã€‚[^1]</p>
<h2 id="å…‰åº¦å­¦æ¦‚å¿µåŠå•ä½">å…‰åº¦å­¦æ¦‚å¿µåŠå•ä½</h2>
<p>åœ¨è¿›ä¸€æ­¥ä»‹ç»HDRä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆäº†è§£ä¸€äº›<a href="http://openstd.samr.gov.cn/bzgk/gb/newGbInfo?hcno=AB4FAB66987D97573EA90F4DD56ABA36">å…‰åº¦å­¦</a>çš„ç›¸å…³æ¦‚å¿µï¼Œä»¥ä¾¿èƒ½å¤Ÿèƒ½å¤Ÿå¯¹HDRæœ‰æ›´å¥½çš„ç†è§£å’Œè®¤è¯†ã€‚</p>
<ul>
<li>
<p><strong>è¾å°„é€šé‡</strong>ï¼šåœ¨å…‰è¾å°„æµ‹é‡å­¦ä¸­ï¼Œä½¿ç”¨çš„åŸºæœ¬ç‰©ç†é‡æ˜¯<code>è¾å°„é€šé‡</code>æˆ–<code>è¾å°„åŠŸç‡</code>ï¼Œç¬¦å·è¡¨ç¤ºä¸ºï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Î¦</mi><mi>e</mi></msub></mrow><annotation encoding="application/x-tex">\Phi_{e}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">Î¦</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œå•ä½æ˜¯ç“¦ç‰¹ï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">W</span></span></span></span>ï¼‰ã€‚è¾å°„é€šé‡ç”±ä¸€ä¸ªè¾å°„æºå‘å‡ºï¼Œå¹¶é€šè¿‡æŸç§ä¼ æ’­ä»‹è´¨è¿›è¡Œä¼ è¾“å¹¶åœ¨æŸç§è¡¨é¢ä¸Šæ¥æ”¶è¯¥è¾å°„é€šé‡ã€‚</p>
</li>
<li>
<p><strong>å…‰é€šé‡</strong>ï¼š<code>å…‰é€šé‡</code>æ˜¯æŒ‡æŒ‰ç…§å›½é™…è§„å®šçš„æ ‡å‡†äººçœ¼è§†è§‰ç‰¹æ€§è¯„ä»·çš„è¾å°„é€šé‡çš„å¯¼å‡ºé‡ï¼Œä¹Ÿå°±æ˜¯å¯¹<code>è¾å°„é€šé‡</code>çš„å…‰åº¦é‡ï¼Œå…¶ç¬¦å·ä¸ºï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Î¦</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">\Phi_{v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">Î¦</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ã€‚å¯ä»¥ä»<code>è¾å°„é€šé‡</code>æ¥å¯¼å‡º<code>å…‰é€šé‡</code>ã€‚</p>
</li>
<li>
<p><strong>å…‰é‡</strong>ï¼š <code>å…‰é‡</code>ä¹Ÿç§°ä¸º<code>å…‰èƒ½</code>ï¼ŒæŒ‡çš„æ˜¯åœ¨ç»™å®šçš„æ—¶é—´é—´éš”ï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Î”</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">\Delta t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">Î”</span><span class="mord mathdefault">t</span></span></span></span>ï¼‰å†…ï¼Œ<code>å…‰é€šé‡</code>çš„æ—¶é—´ç§¯åˆ†ï¼Œç¬¦å·è¡¨ç¤ºä¸ºï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Q</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">Q_{v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œä¸”<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Q</mi><mi>v</mi></msub><mo>=</mo><msub><mo>âˆ«</mo><mrow><mi mathvariant="normal">Î”</mi><mi>t</mi></mrow></msub><mrow><msub><mi mathvariant="normal">Î¦</mi><mi>v</mi></msub><mo>â‹…</mo><mi>d</mi><mi>t</mi></mrow></mrow><annotation encoding="application/x-tex">Q_{v}=\int_{\Delta t}{\Phi_{v} \cdot dt}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1608200000000002em;vertical-align:-0.35582em;"></span><span class="mop"><span class="mop op-symbol small-op" style="margin-right:0.19445em;position:relative;top:-0.0005599999999999772em;">âˆ«</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.12251099999999993em;"><span style="top:-2.34418em;margin-left:-0.19445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">Î”</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.35582em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord">Î¦</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span></span></span>ã€‚</p>
</li>
<li>
<p><strong>å‘å…‰å¼ºåº¦</strong>ï¼š<code>å‘å…‰å¼ºåº¦</code>ï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">I_{v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼‰ä¸ºå…‰æºå‘å‡ºçš„å¹¶ä¸”åœ¨æŒ‡å®šæ–¹å‘çš„ç«‹ä½“è§’å…ƒ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi mathvariant="normal">Î©</mi></mrow><annotation encoding="application/x-tex">d \Omega</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">d</span><span class="mord">Î©</span></span></span></span>å†…ä¼ æ’­çš„å…‰é€šé‡<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><msub><mi mathvariant="normal">Î¦</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">d \Phi_{v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord mathdefault">d</span><span class="mord"><span class="mord">Î¦</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ä¸è¯¥ç«‹ä½“è§’å…ƒ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi mathvariant="normal">Î©</mi></mrow><annotation encoding="application/x-tex">d \Omega</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">d</span><span class="mord">Î©</span></span></span></span>çš„å•†ï¼Œå³ï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>v</mi></msub><mo>=</mo><mfrac><mrow><mi>d</mi><msub><mi mathvariant="normal">Î¦</mi><mi>v</mi></msub></mrow><mrow><mi>d</mi><mi mathvariant="normal">Î©</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">I_{v}=\frac{d \Phi_{v}}{d \Omega}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2412079999999999em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8962079999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mord mtight">Î©</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mord mtight"><span class="mord mtight">Î¦</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>ã€‚<code>å‘å…‰å¼ºåº¦</code>çš„å•ä½ä¸º<code>åå¾·æ‹‰</code>ï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">cd</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">d</span></span></span></span>ï¼‰ã€‚åå¾·æ‹‰æ˜¯å‘å°„å‡ºé¢‘ç‡ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>540</mn><mo>Ã—</mo><mn>1</mn><msup><mn>0</mn><mn>12</mn></msup><mi>H</mi><mi>z</mi></mrow><annotation encoding="application/x-tex">540 \times 10^{12} Hz</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">5</span><span class="mord">4</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span></span></span></span>çš„å•è‰²è¾å°„çš„å…‰æºåœ¨æŒ‡å®šæ–¹å‘ä¸Šçš„å‘å…‰å¼ºåº¦ï¼Œå¹¶ä¸”è¯¥å…‰æºåœ¨è¯¥æ–¹å‘ä¸Šçš„è¾å°„å¼ºåº¦ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mn>683</mn></mfrac><mi>W</mi><mo>â‹…</mo><mi>s</mi><mi>r</mi></mrow><annotation encoding="application/x-tex">\frac{1}{683} W \cdot sr</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span><span class="mord mtight">8</span><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span></span></span></span>ã€‚</p>
</li>
<li>
<p><strong>å…‰äº®åº¦</strong>ï¼š <code>å…‰äº®åº¦</code>ï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">I_{v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼‰æŒ‡åœ¨æŸæ–¹å‘ä¸Šå•ä½æŠ•å½±é¢ç§¯çš„é¢å…‰æºæ²¿è¯¥æ–¹å‘çš„<code>å‘å…‰å¼ºåº¦</code>ã€‚é¢å…‰æºä¸Šå°é¢å…ƒçš„é¢ç§¯ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>A</mi></mrow><annotation encoding="application/x-tex">dA</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">A</span></span></span></span>ï¼ŒæŸä¸€æ–¹å‘ä¸é¢å…ƒæ³•çº¿çš„å¤¹è§’ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¸</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">Î¸</span></span></span></span>ï¼Œé¢å…ƒæ²¿è¿™ä¸ªæ–¹å‘çš„æŠ•å½±é¢ç§¯ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>A</mi><mo>â‹…</mo><mi>c</mi><mi>o</mi><mi>s</mi><mi>Î¸</mi></mrow><annotation encoding="application/x-tex">dA \cdot cos \theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault" style="margin-right:0.02778em;">Î¸</span></span></span></span>ï¼Œåˆ™é¢å…ƒæ²¿è¿™ä¸ªæ–¹å‘çš„å…‰äº®åº¦ä¸ºï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><msub><mi>I</mi><mi>v</mi></msub><mrow><mi>d</mi><mi>A</mi><mo>â‹…</mo><mi>c</mi><mi>o</mi><mi>s</mi><mi>Î¸</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{I_{v}}{dA \cdot cos \theta}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.233431em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8884309999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">A</span><span class="mbin mtight">â‹…</span><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">Î¸</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:-0.07847em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>ï¼Œå³<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>v</mi></msub><mo>=</mo><mfrac><mrow><mi>d</mi><msub><mi mathvariant="normal">Î¦</mi><mi>v</mi></msub></mrow><mrow><mi>d</mi><mi>A</mi><mo>â‹…</mo><mi>c</mi><mi>o</mi><mi>s</mi><mi>Î¸</mi><mo>â‹…</mo><mi>d</mi><mi mathvariant="normal">Î©</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">I_{v}=\frac{d \Phi_{v}}{dA \cdot cos \theta \cdot d \Omega}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2412079999999999em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8962079999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">A</span><span class="mbin mtight">â‹…</span><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">Î¸</span><span class="mbin mtight">â‹…</span><span class="mord mathdefault mtight">d</span><span class="mord mtight">Î©</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mord mtight"><span class="mord mtight">Î¦</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>ã€‚ç”±æ­¤å¯çŸ¥ï¼Œ<code>å…‰äº®åº¦</code>çš„å•ä½ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>d</mi><mi mathvariant="normal">/</mi><msup><mi>m</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">cd/m^{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">d</span><span class="mord">/</span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>ï¼ˆåå¾·æ‹‰/å¹³æ–¹ç±³ï¼‰ï¼Œåˆç§°ä¸º<code>å°¼ç‰¹</code>ã€‚ä¾‹å¦‚ï¼ŒiPhone12çš„å±å¹•çš„å…‰äº®åº¦ä¸ºï¼š625 å°¼ç‰¹æœ€å¤§äº®åº¦ (å…¸å‹)ï¼Œ1200 å°¼ç‰¹æœ€å¤§äº®åº¦ (HDR)ã€‚</p>
</li>
</ul>
<h2 id="photography-hdr">photography HDR</h2>
<p>å¯ä»¥é€šè¿‡åŒæ—¶æ•è·ä¸åŒæ›å…‰åº¦çš„å¤šå¼ å›¾åƒçš„æ–¹æ³•æ¥ç”ŸæˆHDRç…§ç‰‡ã€‚ç›¸æœºä¼šä½¿ç”¨ä¸åŒçš„æ›å…‰å€¼å¿«é€Ÿæ‹æ‘„ä¸‰å¼ æˆ–æ›´å¤šçš„ç…§ç‰‡ï¼Œç„¶åå¯¹å…¶è¿›è¡Œå¤„ç†ï¼Œä»¥ç”Ÿæˆä¸€å¼ HDRç…§ç‰‡ã€‚</p>
<p>åœ¨æ‹æ‘„é«˜å¯¹æ¯”åº¦åœºæ™¯çš„ç…§ç‰‡æ—¶ï¼ŒHDRå›¾åƒå¤„ç†éå¸¸æœ‰ç”¨ã€‚</p>
<p>å¦‚ä¸‹å›¾çš„å¤œæ™¯æ‰€ç¤ºï¼Œä¾‹å¦‚ï¼Œæ›å…‰åº¦å¤ªä½æ—¶ï¼Œä¼šè®©åé¢çš„æ™¯è‰²æ˜¾å¾—æš—æ·¡ã€‚å¦‚æœè°ƒæ•´æ›å…‰ä»¥æ˜¾ç¤ºåé¢çš„æ™¯è‰²ï¼Œåˆ™å‰é¢çš„æ™¯è‰²åˆä¼šå¤ªäº®ï¼Œç”šè‡³å¯èƒ½ä¼šå®Œå…¨å˜ç™½ã€‚é€šè¿‡ç»„åˆå¤šæ¬¡æ›å…‰ï¼Œåˆ™å¯ä»¥å¹³å‡è¿™äº›ä¸åŒçš„æ›å…‰ï¼Œä½¿çš„åé¢çš„æ™¯è‰²å¯ä»¥å‡ºç°åœ¨ç…§ç‰‡ä¸Šï¼Œè€Œåˆä¸ä¼šè¿‡åº¦æ›å…‰å‰é¢çš„æ™¯è‰²ã€‚[^2]</p>
<p><img src="/2021/01/26/HDR-introduction/EVDifferent.png" alt></p>
<p><img src="/2021/01/26/HDR-introduction/EVToneMapping.png" alt></p>
<p>ç›®å‰ï¼Œå¾ˆå¤šæ™ºèƒ½æ‰‹æœºï¼ˆä¾‹å¦‚iPhoneï¼‰çš„ç›¸æœºéƒ½å…·æœ‰HDRé€‰é¡¹ã€‚æˆ‘ä»¬å¯ä»¥é€‰æ‹©è®©ç›¸æœºï¼š</p>
<ul>
<li>å¼€å¯HDRï¼ˆONï¼‰</li>
<li>å…³é—­HDRï¼ˆOFFï¼‰</li>
<li>è‡ªåŠ¨åˆ¤æ–­æ˜¯å¦å¼€å¯HDRï¼ˆAutoï¼‰</li>
</ul>
<p>å¯¹äºAutoæ¨¡å¼ï¼Œç›¸æœºä»…åœ¨é«˜å¯¹æ¯”åº¦çš„æƒ…å†µä¸‹æ‰æ‹æ‘„HDRç…§ç‰‡ã€‚å¤§å¤šæ•°ç›¸æœºè¿˜ä¼šåœ¨åˆæˆHDRç…§ç‰‡æ—¶ï¼ŒåŒæ—¶æ•è·æ™®é€šç…§ç‰‡ï¼Œä»è€Œå…è®¸æˆ‘ä»¬å¯ä»¥åœ¨HDRç…§ç‰‡å’Œæ™®é€šç…§ç‰‡ä¹‹é—´è¿›è¡Œé€‰æ‹©ã€‚</p>
<h3 id="dodging-and-burningå’Œtone-mapping">dodging and burningå’Œtone mapping</h3>
<p>å®é™…ä¸Šï¼Œåœ¨èƒ¶ç‰‡æ—¶ä»£ï¼Œæ‘„å½±å¸ˆå°±ä¼šæ‹æ‘„å¤šå¼ ä¸åŒæ›å…‰ç¨‹åº¦çš„åº•ç‰‡ï¼Œå¹¶åœ¨<a href="https://baike.baidu.com/item/%E6%9A%97%E6%88%BF/62291">æš—æˆ¿</a>ä¸­ä½¿ç”¨ä¸€ç§**<a href="https://en.wikipedia.org/wiki/Dodging_and_burning">dodging and burning</a>**çš„æ‰‹æ³•ï¼ŒæŠŠæ•°å¼ åº•ç‰‡åˆæˆä¸ºä¸€å¼ å…·æœ‰é«˜åŠ¨æ€èŒƒå›´çš„ç…§ç‰‡ã€‚éšç€æ•°ç ç›¸æœºçš„å‡ºç°ï¼ŒHDRå°†æš—æˆ¿é‡Œçš„æŠ€æœ¯å¼•å…¥ç›¸æœºæˆåƒä¼ æ„Ÿå™¨ï¼Œé€šè¿‡å¯¹åŒä¸€ä¸ªåœºæ™¯è¿›è¡Œå¤šç§ä¸åŒçš„æ›å…‰ï¼Œç„¶åå¯¹å…¶è¿›è¡Œåˆæˆï¼Œæœ€ç»ˆå®ç°å¢å¼ºç…§ç‰‡åŠ¨æ€èŒƒå›´ï¼Œè¾¾åˆ°å¢åŠ ç…§ç‰‡å±‚æ¬¡æ„Ÿçš„ç›®çš„ã€‚åœ¨ç…§ç‰‡HDRä¸­ï¼Œè¿™ç§åˆæˆæŠ€æœ¯ç§°ä¹‹ä¸º<a href="https://en.wikipedia.org/wiki/Tone_mapping">è‰²è°ƒæ˜ å°„ï¼ˆ<em>tone mapping</em>ï¼‰</a>ã€‚å½“ç„¶ï¼Œåœ¨æ¥ä¸‹æ¥çš„<code>video HDR</code>ä¸­ä¹Ÿä¼šç”¨åˆ°è‰²è°ƒæ˜ å°„æŠ€æœ¯ï¼Œä¸åŒçš„æ˜¯ï¼Œ<code>video HDR</code>ä¸­çš„è‰²è°ƒæ˜ å°„æ˜¯ç”¨æ¥å°†HDRå†…å®¹æ˜ å°„åˆ°SDRæ˜¾ç¤ºè®¾å¤‡ï¼Œä½¿å¾—SDRè®¾å¤‡ä¹Ÿèƒ½æ˜¾ç¤ºHDRå†…å®¹ã€‚</p>
<h2 id="video-hdr">video HDR</h2>
<p>HDRè§†é¢‘çš„æ•è·æ–¹å¼ä¸HDRç…§ç‰‡ç±»ä¼¼ã€‚åŒæ—¶ä»¥ä¸åŒçš„æ›å…‰ï¼ˆæˆ–ä¸åŒçš„ISOé…ç½®ï¼‰æ¥å½•åˆ¶æ¯ä¸ªé•œå¤´ã€‚ç„¶åæŠŠè¿™äº›é•œå¤´èåˆåœ¨ä¸€èµ·ä»¥ç”Ÿæˆå•ä¸ªé•œå¤´ã€‚å°½ç®¡ä¼šäº§ç”Ÿçœ‹èµ·æ¥ä¸çœŸå®çš„ç°è‰²æ•ˆæœï¼Œä½†è¿™ç§æ–¹æ³•é€šå¸¸å¯ä»¥ä½¿è§†é¢‘æ›´äº®ã€‚å› æ­¤ï¼ŒHDRè§†é¢‘é€šå¸¸ä¼šåœ¨å‘å¸ƒä¹‹å‰è¿›è¡ŒåæœŸå¤„ç†ã€‚</p>
<p>ä¸ºäº†æ­£ç¡®çš„æ˜¾ç¤ºHDRè§†é¢‘ï¼Œæ˜¾ç¤ºè®¾å¤‡ä¹Ÿå¿…é¡»æ”¯æŒHDRã€‚ä¾‹å¦‚ï¼Œå…·å¤‡HDRåŠŸèƒ½çš„ç”µè§†å¿…é¡»æ”¯æŒç‰¹å®šçš„è§†é¢‘è¾“å‡ºæ ‡å‡†ã€‚è¿™äº›æ ‡å‡†ä¸­ä¼šæ¶‰åŠï¼š10-bitè‰²å½©å’Œè‡³å°‘è¦†ç›–90ï¼…çš„DCI-P3è‰²å½©ç©ºé—´ã€‚HDRæ˜¾ç¤ºå™¨è¿˜å¿…é¡»æ”¯æŒç‰¹å®šçš„HDRæ ¼å¼ï¼Œä¾‹å¦‚HDR10ï¼ŒDolby Visionæˆ–Hybrid Log Gammaï¼ˆHLGï¼‰ã€‚</p>
<p><img src="/2021/01/26/HDR-introduction/color_space.jpg" alt></p>
<p>CIE 1931 xy ä¸­å„ä¸ªè‰²å½©ç©ºé—´çš„å¯¹æ¯”</p>
<p>ä»¥HDR10ä¸ºä¾‹ï¼Œå› ä¸ºHDR10æ ‡å‡†ä½¿ç”¨å¹¿è‰²åŸŸ<code>Rec.2020</code>ï¼Œ10-bitè‰²æ·±ä»¥åŠ<code>SMTPE ST 2084</code>PQè½¬æ¢å‡½æ•°ï¼Œå› æ­¤åœ¨ä¸€å°éHDRæ˜¾ç¤ºè®¾å¤‡ä¸Šå»æ˜¾ç¤ºHDR10çš„å†…å®¹ï¼Œåˆ™ä¼šå‡ºç°ä¸¤ç§æƒ…å†µ[<sup>3],[</sup>4]ï¼š</p>
<ul>
<li>æ— æ³•è§£ç å¯¼è‡´èŠ±å±</li>
<li>å¯ä»¥è§£ç ï¼Œä½†æ˜¯å› ä¸ºå½±ç‰‡ä¸­çš„é«˜äº®éƒ¨åˆ†ä¼šæŒ‰ç…§æ˜¾ç¤ºè®¾å¤‡çš„æœ€é«˜äº®åº¦æ¥æ˜¾ç¤ºè€Œå¯¼è‡´å½±ç‰‡æ•´ä½“å˜ç°</li>
</ul>
<p>è¿™ä¹Ÿå°±æ˜¯HDRç…§ç‰‡å’ŒHDRè§†é¢‘çš„ä¸åŒä¹‹å¤„ï¼šHDRè§†é¢‘é™¤äº†è§†é¢‘æ•è·ä¹‹å¤–ï¼Œå¯¹æ˜¾ç¤ºè®¾å¤‡çš„èƒ½åŠ›æœ‰è¾ƒå¼ºçš„ä¾èµ–ã€‚</p>
<h4 id="pq-hlg">PQ &amp; HLG</h4>
<p>ä¸ºäº†æ­£ç¡®æ˜¾ç¤ºHDRå›¾åƒï¼Œä»…ä»…æé«˜äº®åº¦æ˜¯ä¸å¤Ÿçš„ï¼Œä»¥ä¸€ç§ä¸äººç±»è§†åŠ›ç›¸åŒ¹é…çš„æ–¹å¼æ˜¾ç¤ºè‰²å½©å’Œè‰²è°ƒè‡³å…³é‡è¦ã€‚è‰²å½©å’Œè‰²è°ƒå—ä¼½ç›<code>è¾“å…¥-è¾“å‡º</code>ç‰¹æ€§çš„å½±å“ã€‚åœ¨HDRä¸­ï¼Œä¼½ç›æ›²çº¿æœ‰ä¸¤ç§ï¼Œåˆ†åˆ«æ˜¯PQå’ŒHLGã€‚</p>
<ul>
<li>PQä¼½ç›æ›²çº¿åŸºäºäººç±»è§†è§‰æ„ŸçŸ¥çš„ç‰¹å¾ï¼Œå¹¶ä¸”æœ€é€‚åˆäºåœ¨äº’è”ç½‘ä¸Šåˆ¶ä½œç”µå½±æˆ–ä¸²æµè§†é¢‘çš„å†…å®¹ï¼Œå…¶ä¸­å†ç°å‡†ç¡®æ€§æ˜¯å…³é”®ã€‚</li>
<li>HLGä¼½ç›æ›²çº¿æ—¨åœ¨å…è®¸åœ¨ç°æœ‰çš„SDRç”µè§†ä¸Šæ˜¾ç¤ºè€Œä¸ä¼šçœ‹ä¸åˆ°ä½ç½®ï¼Œå¹¶ä¸”æœ€é€‚åˆäºå¹¿æ’­ç”µè§†å’Œç›´æ’­è§†é¢‘é¦ˆé€ã€‚</li>
</ul>
<p>PQå’ŒHLGçš„å…·ä½“åŒºåˆ«å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p>
<table>
<thead>
<tr>
<th></th>
<th>PQ (æ„ŸçŸ¥é‡åŒ–)</th>
<th>HLG (æ··åˆå¯¹æ•°ä¼½ç›)</th>
</tr>
</thead>
<tbody>
<tr>
<td>ç›®æ ‡</td>
<td>äº’è”ç½‘è§†é¢‘æµï¼Œç”µå½±</td>
<td>å¹¿æ’­ç”µè§†ï¼Œç›´æ’­è§†é¢‘</td>
</tr>
<tr>
<td>ä¼˜ç‚¹</td>
<td>å¤„ç†äº®åº¦çš„ç»å¯¹å€¼é«˜è¾¾ 10,000 cd/mÂ²ï¼ŒåŸºäºäººç±»è§†è§‰æ„ŸçŸ¥çš„æ–°ä¼½ç›æ›²çº¿</td>
<td>å°†äº®åº¦å¤„ç†ä¸ºç›¸å¯¹å€¼ï¼ˆä¸ç°æœ‰æ ‡å‡†ç›¸åŒï¼‰å…¼å®¹SDRç”µè§†</td>
</tr>
<tr>
<td>æœ€å¤§äº®åº¦</td>
<td>1,000 cd/mÂ² ç»å¯¹å€¼ ä¸€è‡´ï¼Œä¸ç®¡æ˜¾ç¤ºè£…ç½®</td>
<td>ç›¸å¯¹å€¼ï¼Œå› æ˜¾ç¤ºè®¾å¤‡è€Œå¼‚</td>
</tr>
<tr>
<td>é»‘è‰²ç­‰çº§</td>
<td>0.005 cd/m2æˆ–æ›´ä½</td>
<td>0.005 cd/m2 æˆ–æ›´ä½</td>
</tr>
<tr>
<td>æè®®è€…</td>
<td>Dolby</td>
<td>BBC å’Œ NHK</td>
</tr>
<tr>
<td>å‚è€ƒæ ‡å‡†</td>
<td>SMPTE ST 2084ã€ITU-R BT.2100</td>
<td>ITU-R BT.2100</td>
</tr>
<tr>
<td>åœ¨SDRæ˜¾ç¤ºè®¾å¤‡ä¸Šçš„æ•ˆæœ</td>
<td>Poor</td>
<td>è‰¯</td>
</tr>
<tr>
<td>ç›´æ’­æ•ˆæœ</td>
<td>è‰¯</td>
<td>ä¼˜</td>
</tr>
</tbody>
</table>
<h2 id="hdræ ‡å‡†">HDRæ ‡å‡†</h2>
<h4 id="hdr10">HDR10</h4>
<h4 id="dolby-vision">DOLBY VISION</h4>
<h4 id="hdr10">HDR10+</h4>
<h4 id="uhd-premium">UHD Premium</h4>
<h4 id="displayhdr">DisPlayHDR</h4>
<h4 id="mobile-hdr">Mobile HDR</h4>
<h4 id="cuva-hdr">CUVA HDR</h4>
<h4 id="vesa-hdr">VESA HDR</h4>
<h2 id="æ‰‹æœºå¯¹hdrçš„æ”¯æŒ">æ‰‹æœºå¯¹HDRçš„æ”¯æŒ</h2>
<h4 id="iphone">iPhone</h4>
<p>iPhone 12 Proå¯¹äºæœæ¯”è§†ç•Œçš„å…¨æ–¹ä½æ”¯æŒï¼Œå¯ä»¥è¯´æ˜¯å‡­å€Ÿç€ä¸€å·±ä¹‹åŠ›ï¼Œå°†ä¸€é¡¹æœ€å…ˆè¿›ï¼Œæœ€å‰å«çš„HDRæŠ€æœ¯ï¼Œå¸¦åˆ°äº†æ™®ç½—å¤§ä¼—çš„çœ¼å‰ã€‚ä½œä¸ºç¬¬ä¸€éƒ¨æ”¯æŒHDRæ‹æ‘„çš„æ‰‹æœºï¼ŒiPhone 12çš„Dolby Vision HDRæ‹æ‘„æ˜¯å¦‚ä½•å®ç°çš„ï¼ŸçœŸçš„å¦‚å®£ä¼ æ‰€è¯´çš„é‚£ä¹ˆç‰›å—ï¼Ÿ</p>
<p>æˆ–è®¸æˆ‘ä»¬èƒ½å¤Ÿä»è¿™ä½æ‹¥æœ‰5å¹´HDRè°ƒè‰²å’Œæ•™å­¦ç»éªŒçš„ä¸“å®¶Samuel Bilodeauæ’°å†™çš„è¿™ç¯‡è¯„æµ‹ä¸­æ‰¾åˆ°ç­”æ¡ˆã€‚ä½œè€…åœ¨è¯„æµ‹çš„æœ€åè¯´ï¼šæˆ‘ç‰¹åˆ«å…´å¥‹å’Œå¼€å¿ƒçš„çœ‹åˆ°iPhoneå’Œå…¶ä»–å…·æœ‰HDRæ‹æ‘„åŠŸèƒ½çš„æ¶ˆè´¹çº§ç›¸æœºçš„å‡ºç°ï¼Œå¹¶æ¨åŠ¨ç€HDRå‘å‰è¿ˆäº†ä¸€æ­¥ã€‚</p>
<div class="bili_video"><div style="position: relative; width: 100%; height: 0; padding-bottom: 75%;"><iframe src="https://player.bilibili.com/player.html?aid=289414701&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position: absolute; width: 100%; height: 100%; left: 0; top: 0;"> </iframe></div></div>
<h2 id="ffmpegåˆ†æhdrå†…å®¹">FFmpegåˆ†æHDRå†…å®¹</h2>
<h4 id="ffprobeåˆ†æhdrå†…å®¹çš„å…ƒæ•°æ®">ffprobeåˆ†æHDRå†…å®¹çš„å…ƒæ•°æ®</h4>
<p>å¯ä»¥ä½¿ç”¨ffprobeå‘½ä»¤æ¥æå–<code>Mastering Display</code>å’Œ<code>Content Light Level</code>çš„å…ƒæ•°æ®ã€‚æˆ‘ä»¬åªéœ€è¦æå–ç¬¬ä¸€å¸§çš„ç›¸å…³æ•°æ®å³å¯ï¼Œå› æ­¤ï¼Œåœ¨åˆ†ææ—¶ï¼Œå¯ä»¥ä½¿ç”¨<a href="http://ffmpeg.org/ffprobe.html#Main-options"><code>-read_intervals &quot;%+#1&quot;</code></a>é€‰é¡¹ï¼Œè®©ffprobeåªæå–ç¬¬ä¸€å¸§çš„å…ƒæ•°æ®ã€‚å…·ä½“åˆ†æååˆ©å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ffprobe \</span><br><span class="line">-hide_banner \</span><br><span class="line">-loglevel warning \</span><br><span class="line">-select_streams v \</span><br><span class="line">-print_format json \</span><br><span class="line">-show_frames \</span><br><span class="line">-read_intervals &quot;%+#1&quot; \</span><br><span class="line">-show_entries &quot;frame=color_space,color_primaries,color_transfer,side_data_list,pix_fmt&quot; \</span><br><span class="line">HDR.mp4</span><br></pre></td></tr></table></figure>
<p>å„é€‰é¡¹çš„å«ä¹‰å¦‚ä¸‹ï¼š</p>
<ul>
<li>-hide_banner -loglevel warningï¼šä¸æ˜¾ç¤ºæˆ‘ä»¬ä¸éœ€è¦çš„ä¿¡æ¯</li>
<li>-select_streams vï¼šåªé€‰æ‹©è§†é¢‘æµæ¥åˆ†æ</li>
<li>-print_format jsonï¼šä»¥jsonæ ¼å¼è¾“å‡ºåˆ†æç»“æœ</li>
<li>-read_intervals â€œ%+#1â€ï¼šåªåˆ†æç¬¬ä¸€å¸§ä¸­çš„æ•°æ®</li>
<li>-show_entries â€¦ ï¼šåªè¾“å‡ºæˆ‘ä»¬æŒ‡å®šçš„æ•°æ®</li>
</ul>
<p>å‘½ä»¤æ‰§è¡Œåï¼Œä¼šæ˜¾ç¤ºå¦‚ä¸‹çš„åˆ†æç»“æœï¼š</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;frames&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">&quot;pix_fmt&quot;</span>: <span class="string">&quot;yuv420p10le&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;color_space&quot;</span>: <span class="string">&quot;bt2020nc&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;color_primaries&quot;</span>: <span class="string">&quot;bt2020&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;color_transfer&quot;</span>: <span class="string">&quot;smpte2084&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;side_data_list&quot;</span>: [</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">&quot;side_data_type&quot;</span>: <span class="string">&quot;Mastering display metadata&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;red_x&quot;</span>: <span class="string">&quot;34000/50000&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;red_y&quot;</span>: <span class="string">&quot;16000/50000&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;green_x&quot;</span>: <span class="string">&quot;13250/50000&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;green_y&quot;</span>: <span class="string">&quot;34500/50000&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;blue_x&quot;</span>: <span class="string">&quot;7500/50000&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;blue_y&quot;</span>: <span class="string">&quot;3000/50000&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;white_point_x&quot;</span>: <span class="string">&quot;15635/50000&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;white_point_y&quot;</span>: <span class="string">&quot;16450/50000&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;min_luminance&quot;</span>: <span class="string">&quot;40/10000&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;max_luminance&quot;</span>: <span class="string">&quot;11000000/10000&quot;</span></span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚ä¸Šæ‰€ç¤ºï¼Œffprobeåˆ†æç»“æœä¸­çš„é¢œè‰²å€¼ä»¥åŠæœ€å¤§/å°äº®åº¦å€¼å‡ä¸ºä¸€ä¸ªæ¯”å€¼ï¼Œé¢œè‰²å€¼çš„æœ€ç»ˆç»“æœä¼šç¡®å®šæ¯ç‰ˆå†…å®¹æ‰€ç”¨çš„é¢œè‰²ç©ºé—´ï¼Œè€Œæœ€å¤§/å°äº®åº¦å€¼åˆ™ç¡®å®šäº†æ¯ç‰ˆå†…å®¹çš„åŠ¨æ€èŒƒå›´ã€‚</p>
<p>æ ¹æ®å¦‚ä¸Šçš„ç»“æœï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œåœ¨CIEåæ ‡ä¸Šï¼Œçº¢è‰²ï¼Œç»¿è‰²ï¼Œè“è‰²ä»¥åŠç™½ç‚¹çš„åæ ‡åˆ†åˆ«æ˜¯ï¼š</p>
<ul>
<li>red: (0.68, 0.32)</li>
<li>green: (0.265, 0.69)</li>
<li>blue: (0.15, 0.06)</li>
<li>white point: (0.3127, 0.329)</li>
</ul>
<p>ä»<a href="https://en.wikipedia.org/wiki/DCI-P3">DCI-P3</a>çš„ç›¸å…³ä¿¡æ¯å¯çŸ¥ï¼Œè¯¥è§†é¢‘çš„æ¯ç‰ˆå†…å®¹åœ¨åˆ¶ä½œçš„æ—¶å€™é‡‡ç”¨çš„æ˜¯<code>P3-D65 (Display)</code>é¢œè‰²ç©ºé—´ï¼Œå…¶æœ€å°äº®åº¦ä¸º0.004å°¼ç‰¹ï¼Œæœ€å¤§äº®åº¦ä¸º1100å°¼ç‰¹ï¼Œå¯¹æ¯”åº¦ä¸º275000ã€‚</p>
<h4 id="ffmpegè½¬ç hdrå†…å®¹">FFmpegè½¬ç HDRå†…å®¹</h4>
<p>å¯¹äºHDRè§†é¢‘çš„è½¬ç æ—¶ï¼Œéœ€è¦å°†<code>Mastering Display</code>å’Œ<code>Content Light Level</code>å…ƒæ•°æ®çš„å†…å®¹ä¼ é€’ç»™ç¼–ç å™¨ï¼ˆæ³¨æ„ï¼Œä¸æ˜¯ä¼ é€’ç»™FFmpegï¼‰ï¼Œå¦åˆ™ï¼Œåœ¨è½¬ç çš„è¿‡ç¨‹ä¸­ä¼šä¸¢å¤±è¿™äº›ä¿¡æ¯ï¼Œè¿›è€Œå¯¼è‡´è½¬ç å¯¹ç”»é¢å†…å®¹çš„å½±å“ã€‚å…·ä½“çš„æ–¹å¼å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ffmpeg  -i hdr.mp4 \</span><br><span class="line">-map 0 -c:v libx265 \</span><br><span class="line">-x265-params hdr-opt=1:repeat-headers=1:colorprim=bt2020:transfer=smpte2084:colormatrix=bt2020nc:master-display=G(13250,34500)B(7500,3000)R(34000,16000)WP(15635,16450)L(11000000,40) \</span><br><span class="line">-crf 20 \</span><br><span class="line">-preset veryfast \</span><br><span class="line">-pix_fmt yuv420p10le \</span><br><span class="line">test.mp4</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­ï¼Œ</p>
<ul>
<li>hdr-opt=1: è¡¨ç¤ºæˆ‘ä»¬è¦å¯ç”¨HDR</li>
<li>repeat-headers=1: è¡¨ç¤ºæ¯ä¸€å¸§éƒ½éœ€è¦è¿™äº›æ•°æ®</li>
<li>colorprim, transfer and colormatrix: å’Œffprobeä¿æŒä¸€è‡´</li>
<li>master-display: æ ¹æ®ffprobeçš„ç»“æœæ¥æ„é€ çš„é¢œè‰²å­—ç¬¦ä¸²</li>
</ul>
<h2 id="ç›¸å…³æœ¯è¯­">ç›¸å…³æœ¯è¯­</h2>
<h4 id="color-calibration-of-screens-å±å¹•çš„è‰²å½©æ ¡æ­£">Color Calibration of Screensï¼ˆå±å¹•çš„è‰²å½©æ ¡æ­£ï¼‰</h4>
<p>ç”¨äºç¡®ä¿å±å¹•ä¸Šè‰²å½©è¢«å‡†ç¡®æ˜¾ç¤ºçš„ä¸€ä¸ªè¿‡ç¨‹ã€‚ä¸€èˆ¬ä½¿ç”¨è‰²åº¦è®¡æ¥æµ‹é‡ä¸€å—æ˜¾ç¤ºå±çš„åŸç”Ÿè‰²å½©å“åº”ï¼Œä¹‹åè®¡ç®—ä¸€ä¸ªç”¨äºä¿®æ­£çš„æŒ‡æ ‡ä»¥ç¡®ä¿é¢œè‰²èƒ½æ­£ç¡®åœ°æ˜¾ç¤ºåœ¨è¯¥æ˜¾ç¤ºå™¨ä¸Šï¼Œæœ€åå¯¹ç»è¿‡ä¿®æ­£åçš„å“åº”è¿›è¡Œæ£€æµ‹ã€‚</p>
<h4 id="color-spaces-è‰²å½©ç©ºé—´">Color Spacesï¼ˆè‰²å½©ç©ºé—´ï¼‰</h4>
<p>ä¸€ä¸ªè‰²å½©ç©ºé—´å¯ä»¥æŒ‡ä¸€ç§é¢œè‰²çš„ç»„ç»‡æ–¹å¼ï¼Œä¹Ÿå¯ä»¥æŒ‡æŸä¸ªç‰¹å®šèŒƒå›´çš„è‰²å½©ã€‚åœ¨å½±é™¢å’Œç”µè§†çš„é¢†åŸŸï¼Œæˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨ RGBï¼ˆç”¨çº¢ã€ç»¿ã€è“åŸè‰²åˆ†é‡æ¥è¡¨ç¤ºä¸€ä¸ªé¢œè‰²ï¼‰æˆ–è€… YUVï¼ˆç”¨ä¸€ä¸ªé¢œè‰²çš„æ˜åº¦ï¼ˆé»‘ç™½å€¼ï¼‰ï¼Œä»¥åŠå®ƒçš„åŸºäºè‰²å½©æˆåˆ†å·®å€¼æ‰€è®¡ç®—çš„è‰²åº¦å€¼ï¼‰è‰²å½©ç©ºé—´ï¼ˆè¯‘è€…æ³¨ï¼šRGB å’Œ YUV ä¸ºè‰²å½©æ¨¡å‹ï¼Œéè‰²å½©ç©ºé—´ï¼Œæ­¤å¤„åŸæ–‡æœ‰é”™è¯¯ï¼‰ã€‚è¿™äº›è‰²å½©ç©ºé—´ä¸€èˆ¬åŸºäºç‰¹å®šçš„æ˜¾ç¤ºè®¾å¤‡ç‰¹æ€§ï¼Œå‚è§ D65-P3 è¯æ¡ã€‚å…¶å®ƒçš„è‰²å½©ç©ºé—´ï¼Œæ¯”å¦‚ XYZ æˆ–è€… Lab æ›´é€‚ç”¨äºè¡¨ç¤ºäººçœ¼è‰²å½©è§†è§‰æ¨¡å‹ã€‚</p>
<h4 id="contrast-ratio-å¯¹æ¯”åº¦">Contrast Ratioï¼ˆå¯¹æ¯”åº¦ï¼‰</h4>
<p>å¯¹æ¯”åº¦æ˜¯ä¸€ä¸ªç³»ç»Ÿæ‰€èƒ½äº§ç”Ÿçš„æœ€äº®ï¼ˆç™½ï¼‰éƒ¨åˆ†å’Œæœ€æš—ï¼ˆé»‘ï¼‰éƒ¨åˆ†ä¹‹é—´çš„æ˜åº¦æ¯”å€¼ï¼Œé€šå¸¸ç”¨ä¸€ä¸ª n:1 çš„æ¯”å€¼æè¿°ã€‚</p>
<h4 id="cri-color-remapping-information-è‰²å½©é‡æ˜ å°„ä¿¡æ¯">CRI Color Remapping Informationï¼ˆè‰²å½©é‡æ˜ å°„ä¿¡æ¯ï¼‰</h4>
<p>ä¸€å¥—é€šè¿‡åˆ†æç›¸åŒå†…å®¹çš„ä¸¤ä»½ä¸åŒæ¯ç‰ˆï¼ˆå¦‚ HDR å’Œ SDR æ¯ç‰ˆï¼‰æ‰€äº§ç”Ÿçš„æ ‡å‡†å…ƒæ•°æ®ã€‚å½“ä¸€ä»½æ¯ç‰ˆï¼ˆå¦‚ HDRï¼‰å’Œ CRI å…ƒæ•°æ®è¢«ä¸€åŒä¼ è¾“æ—¶ï¼Œè§£ç å™¨åœ¨é¢å¯¹ HDR å±å¹•æ—¶å¯ä»¥ä»…è§£ç  HDR å†…å®¹ï¼Œè€Œåœ¨é¢å¯¹ SDR å±å¹•æ—¶ä¹Ÿå¯ä»¥é€šè¿‡åˆ©ç”¨ CRI å…ƒæ•°æ®çš„æ–¹å¼å°† HDR å†…å®¹å˜æ¢æˆ SDR å†…å®¹ã€‚é‡‡ç”¨è¿™ä¸€æ–¹æ¡ˆçš„ä¸»è¦ä¼˜åŠ¿åœ¨äºå¯¹äºä¸¤ä¸ªè§£ç åçš„ç‰ˆæœ¬ï¼Œä½œè€…çš„åˆ›ä½œæ„å›¾å¾—ä»¥ä¿ç•™ã€‚CRI æ˜¯ MPEGï¼ˆHEVC v2ï¼‰çš„æ ‡å‡†æˆåˆ†ä¹‹ä¸€ï¼Œå¹¶ä¸”å¯¹äº Ultra HD Blu-ray åˆ¶ä½œæ˜¯å¯é€‰åŠŸèƒ½ã€‚</p>
<h4 id="dci-p3-d65-p3-st-428-1">DCI-P3ï¼ŒD65-P3ï¼ŒST 428-1</h4>
<p>ä¸€ä¸ªæ•°å­—ç”µå½±è‰²å½©ç©ºé—´ã€‚DCI-P3 è‰²å½©ç©ºé—´æ˜¯ä¸€ä¸ª 2005 å¹´ç”±æ•°å­—å½±é™¢è”ç›Ÿï¼ˆDigital Cinema Initiativesï¼‰å¼•å…¥çš„ RGB è‰²å½©ç©ºé—´ï¼Œå¹¶ç”± SMPTE ST428-1 äº 2006 å¹´æ ‡å‡†åŒ–ã€‚</p>
<p>è¿™ä¸€è‰²å½©ç©ºé—´æ‹¥æœ‰è¿œæ¯” sRGBï¼ˆå‚è§ Rec.709ï¼‰å®½å¹¿å¾—å¤šçš„è‰²åŸŸã€‚</p>
<p>æ‰€æœ‰çš„æ•°å­—ç”µå½±æ”¾æ˜ æœºéƒ½èƒ½å®Œæ•´æ˜¾ç¤º DCI-P3 è‰²å½©ç©ºé—´ï¼ŒD65 P3 æŒ‡çš„æ˜¯å…¶ç™½ç‚¹çš„è‰²æ¸©ç”± DCI ç™½ç‚¹æ”¹ä¸º D65 ç™½ç‚¹ã€‚</p>
<p>å›¾ä¸­çš„ä¸‰ä¸ªä¸‰è§’å½¢å±•ç°äº†ï¼šæœ€å¤§çš„æ˜¯ Rec.2020 æ ‡å‡†ï¼ŒUltra HD TV çš„æ–°æ ‡å‡†ï¼ˆç›®å‰åªæœ‰æ¿€å…‰æ˜¾ç¤ºèƒ½å®Œæ•´å®ç°ï¼‰ï¼Œç•¥å°çš„ã€ç”¨äºæ•°å­—ç”µå½±çš„ DCI-P3ï¼Œä»¥åŠä¼ ç»Ÿè§†é¢‘ç›‘è§†å™¨ã€é«˜æ¸…å¹¿æ’­ç”µè§†ã€è“å…‰ã€OTT æ‰€é‡‡ç”¨çš„æœ€å°çš„ Rec.709 è‰²å½©ç©ºé—´ã€‚</p>
<h4 id="edid-æ‰©å±•æ˜¾ç¤ºæ ‡è¯†æ•°æ®">EDID æ‰©å±•æ˜¾ç¤ºæ ‡è¯†æ•°æ®</h4>
<p>EDID æ˜¯æ‰©å±•æ˜¾ç¤ºæ ‡è¯†æ•°æ®ï¼ˆExtended Display Information Dataï¼‰çš„ç¼©å†™ï¼Œè¿™ä¸ªæ ‡å‡†ç”± Consumer Technology Associationï¼ˆCTAï¼‰åˆ¶å®šã€‚è¿™æ˜¯ç”±æ¯ä¸ª DVI æ˜¾ç¤ºå™¨ã€HDMI æ˜¾ç¤ºå™¨ï¼Œæˆ–å…¶å®ƒæ”¯æŒ DVI HDMI è¾“å…¥çš„è®¾å¤‡ï¼ˆaka DVI/HDMI Sinksï¼‰æ‰€æä¾›çš„ã€‚å¯èƒ½æ¯ä¸ª DVI/HDMI è¾“å…¥éƒ½æœ‰è‡ªå·±çš„ EDIDã€‚EDID ä¼šå‘Šè¯‰è®¾å¤‡å®ƒæ‰€è¿æ¥çš„æ˜¾ç¤ºå™¨çš„æ€§èƒ½ç‰¹å¾ã€‚</p>
<p>æºè®¾å¤‡ç¡®è®¤æ˜¾ç¤ºå™¨çš„ DVI æˆ–è€… HDMI æ¥å£æ˜¯å¦å­˜åœ¨ EDID å­˜å‚¨å™¨ï¼ˆEDID memoryï¼‰å¹¶ä½¿ç”¨å…¶ä¸­çš„ä¿¡æ¯ä¼˜åŒ–è¾“å‡ºçš„è§†é¢‘ï¼ˆåˆ†è¾¨ç‡ã€å¸§ç‡ã€è‰²å½©â€¦â€¦ï¼‰å’Œ/æˆ–éŸ³é¢‘æ ¼å¼ã€‚æ‰€æœ‰æ”¯æŒ DVI/HDMI æ ‡å‡†è¾“å…¥çš„è®¾å¤‡ï¼Œå³ TMDS æ¥æ”¶ç«¯ï¼ˆDVI/HDMI Sinksï¼‰å¿…é¡»å®ç° EDIDã€‚</p>
<h4 id="eotf-ç”µå…‰è½¬æ¢å‡½æ•°">EOTF ç”µå…‰è½¬æ¢å‡½æ•°</h4>
<p>EOTF æ˜¯ Electro-Optical Transfer Function çš„ç¼©å†™ã€‚ä»–æ˜¯ä¸€ä¸ªæ˜ å°„ç å€¼åˆ°æ˜¾ç¤ºäº®åº¦çš„æ•°å­¦å‡½æ•°ã€‚æ¢è¨€ä¹‹ï¼Œä¸€ä¸ª ETOF å®šä¹‰äº†å›¾åƒä¸­çš„ç å€¼å¦‚ä½•è¢«æ˜¾ç¤ºå™¨æˆ–è€…æŠ•å½±ä»ªæ˜¾ç¤ºä¸ºå¯è§å…‰ã€‚</p>
<p>å‚è§ OETF å…‰ç”µè½¬æ¢å‡½æ•°ï¼ŒST2084ã€‚</p>
<h4 id="oetf-å…‰ç”µè½¬æ¢å‡½æ•°">OETF å…‰ç”µè½¬æ¢å‡½æ•°</h4>
<p>OETF æ˜¯ Opto-Electronic Transfer Function çš„ç¼©å†™ã€‚å®ƒæ˜¯ä¸€ä¸ªæ˜ å°„åœºæ™¯æ˜åº¦ï¼ˆæŸä¸ªåœºæ™¯çš„å…‰ï¼‰ä¸å¯ä¼ è¾“å‹ç¼©çš„æ•°å­—ç¼–ç å€¼ä¹‹é—´çš„æ•°å­¦å‡½æ•°æ˜ å°„å…³ç³»ã€‚è¿™ä¸ªæœ¯è¯­ä¸€èˆ¬ç”¨äºè·å–å›¾åƒçš„è®¾å¤‡ï¼Œæ¯”å¦‚æ•°å­—ç›¸æœºã€‚</p>
<p>åœ¨åæœŸåˆ¶ä½œä¸­ï¼Œå†…å®¹ä¸€èˆ¬åœ¨æŸä¸ªæ‹¥æœ‰ç‰¹å®š EOTF çš„å±å¹•ä¸Šè¿›è¡Œè°ƒè‰²ï¼Œå†å²ä¸Šï¼Œå¸¸ç”¨ä¸€ä¸ªOETF çš„é€†å‡½æ•°ä½œä¸ºå±å¹•çš„ EOTFã€‚</p>
<h4 id="ootf-å…‰å…‰è½¬æ¢å‡½æ•°">OOTF å…‰å…‰è½¬æ¢å‡½æ•°</h4>
<p>OOTF æ˜¯ Optical-to-Optical Transfer Function çš„ç¼©å†™ã€‚å®ƒæ˜¯ä¸€ä¸ªæŠŠç›¸æœºæ‰€æ‹æ‘„çš„åœºæ™¯äº®åº¦æ˜ å°„åˆ°æ˜¾ç¤ºå™¨äº®åº¦çš„æ•°å­¦å‡½æ•°ã€‚</p>
<h4 id="flicker-é—ªçƒ">Flicker é—ªçƒ</h4>
<p>éƒ¨åˆ†ç‰¹å®šç§ç±»çš„æ˜¾ç¤ºå™¨çš„ç‰¹å¾ï¼Œæ¯”å¦‚è€çš„é˜´æå°„çº¿ç®¡æ˜¾ç¤ºå™¨ï¼ˆCRTï¼‰ï¼Œæˆ–è€…è°ƒæ•™å¾—å¾ˆç³Ÿç³•çš„å¹³æ¿æ˜¾ç¤ºå™¨ï¼Œç”šè‡³ç”µå½±ï¼ˆmotion picture filmï¼‰æ”¾æ˜ æœºè¿™ä¸€ä¸å—æ¬¢è¿çš„äº®åº¦æ”¹å˜ä¸»è¦åœ¨é¢‘ç‡ä½äº 50 å¸§æ¯ç§’æ—¶å¯è§ã€‚å¯¹äºäº®åº¦æ›´é«˜çš„æ˜¾ç¤ºå™¨æ¥è¯´ï¼Œäººçœ¼èƒ½æ„Ÿå—åˆ°æ›´é«˜é¢‘ç‡çš„é—ªçƒã€‚</p>
<h4 id="f-stop-of-dynamic-range-åŠ¨æ€èŒƒå›´çš„-f-åˆ¶å…‰åœˆæ¡£æ•°">f-stop of Dynamic Range åŠ¨æ€èŒƒå›´çš„ f åˆ¶å…‰åœˆæ¡£æ•°</h4>
<p>åœ¨æ‘„å½±ä¸­ï¼Œä¸€æ¡£ f åˆ¶å…‰åœˆçš„æ”¹å˜å¯¹åº”åŒå€ï¼ˆæˆ–å‡åŠï¼‰æ•è·å›¾åƒæ—¶æ‰€æ•æ‰çš„å…‰ã€‚</p>
<p>ä¸€å¼ å›¾ç‰‡ä¸­æ‰€åŒ…å«çš„ f åˆ¶å…‰åœˆæ•°é‡æè¿°äº†è¿™å¼ å›¾ç‰‡çš„å¯¹æ¯”åº¦ï¼ˆ2^N æ ‡è®°ï¼‰æ¯”å¦‚ä¸€å°ç›¸æœºå¯ä»¥è¾“å‡º 10 æ¡£çš„å›¾åƒï¼Œè¿™æ„å‘³ç€å¯¹æ¯”åº¦å¯ä»¥é«˜è¾¾ 2^10ï¼ˆ1024ï¼š1ï¼‰ï¼Œå³ç™½è‰²éƒ¨åˆ†ä¼šæ¯”é»‘è‰²éƒ¨åˆ†äº® 1024 å€ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œäººçœ¼å¯ä»¥è¾¾åˆ° 18-20 æ¡£ï¼ˆè¿™æ˜¯ä¸€ä¸ªå¾ˆé«˜çš„åŠ¨æ€èŒƒå›´ HDRï¼Œä¸€èˆ¬çš„ SDR è§†é¢‘å›¾åƒæ˜¯ 6-7 æ¡£ï¼‰</p>
<h4 id="gamut-or-color-gamut-è‰²åŸŸ">Gamut or Color Gamut è‰²åŸŸ</h4>
<p>åœ¨åŒ…æ‹¬ä½†ä¸é™äºè®¡ç®—æœºå›¾å½¢å’Œæ‘„å½±é¢†åŸŸçš„è‰²å½©è¿˜åŸè¿‡ç¨‹ä¸­ï¼Œè‰²åŸŸæ˜¯æŸä¸ªç‰¹å®šçš„è‰²å½©çš„å­é›†ã€‚</p>
<p>è‰²åŸŸä¸€è¯æœ€å¸¸è§çš„ç”¨é€”æ˜¯æŒ‡æŸä¸ªèŒƒå›´å†…å¯ä»¥è¢«å‡†ç¡®ååº”çš„è‰²å½©å­é›†ï¼Œè¿™ä¸ªå‰æå¯èƒ½æ˜¯æŸä¸ªç‰¹å®šçš„æ˜¾ç¤ºè®¾å¤‡æˆ–æŸä¸ªç»™å®šçš„è‰²å½©ç©ºé—´ã€‚è‰²åŸŸä¸€èˆ¬ä½¿ç”¨ CIE 1931 è‰²åº¦å›¾ä¸Šçš„é¢ç§¯æ¥è¡¨ç¤ºï¼ŒCIE 1931 æ›²çº¿çš„è¾¹ç¼˜ä»£è¡¨å¯è§å…‰å…‰è°±é¢œè‰²çš„èŒƒå›´ã€‚</p>
<h4 id="gamut-mapping-è‰²åŸŸæ˜ å°„">Gamut Mapping è‰²åŸŸæ˜ å°„</h4>
<p>åœ¨å‡ ä¹æ‰€æœ‰çš„è½¬è¯‘è¿‡ç¨‹ï¼ˆæŒ‡çš„æ˜¯å¯¹äºæŸä¸ªç‰¹å®šé¢œè‰²çš„è¡¨ç¤ºï¼Œåœ¨ä¸åŒè‰²å½©ç©ºé—´ä¸­çš„è½¬æ¢è¿‡ç¨‹ï¼‰ä¸­ï¼Œæˆ‘ä»¬å¿…é¡»é¢å¯¹ä¸åŒè®¾å¤‡çš„è‰²åŸŸæ‰€è¦†ç›–çš„èŒƒå›´æ˜¯æœ‰æ‰€ä¸åŒçš„ç°å®ï¼Œè¿™ä½¿å¾—å‡†ç¡®è¿˜åŸè‰²å½©æ˜¯ä¸å¯èƒ½çš„ã€‚</p>
<p>å› æ­¤ï¼Œå¯¹äºé è¿‘è‰²åŸŸè¾¹ç¼˜çš„éƒ¨åˆ†æ˜¯æœ‰å¿…è¦è¿›è¡Œä¸€äº›å¤„ç†çš„ã€‚æœ‰äº›é¢œè‰²å¿…é¡»è¢«ç§»å…¥è‰²åŸŸä¸­ï¼Œä¸ç„¶å®ƒä»¬åœ¨è¾“å‡ºè®¾å¤‡ä¸Šæ— æ³•è¢«æ˜¾ç¤ºï¼Œå®ƒä»¬ä¼šè¢«ç²—æš´åœ°èˆå¼ƒï¼ˆclippedï¼‰æ‰ã€‚è¿™å°±æ˜¯æ‰€è°“çš„è‰²åŸŸä¸åŒ¹é…ï¼Œæ¯”å¦‚è¯´å½“æˆ‘ä»¬å°†æ›´å¹¿çš„ RGB è‰²å½©ç©ºé—´è½¬æ¢åˆ° CMYK è‰²å½©ç©ºé—´çš„æ—¶å€™å°±ä¼šå‡ºç°ã€‚</p>
<p>è‰²å½©ç®¡ç†ç³»ç»Ÿå¯ä»¥ä½¿ç”¨å¤šç§æ–¹æ³•æ¥å®ç°æ‰€éœ€çš„ç»“æœå¹¶ä¸”ç»™äºˆæœ‰ç»éªŒçš„ç”¨æˆ·æ§åˆ¶è‰²åŸŸæ˜ å°„çš„çš„æ–¹å¼ã€‚</p>
<h4 id="imf-å¯äº¤äº’æ¯ç‰ˆæ–‡ä»¶">IMF å¯äº¤äº’æ¯ç‰ˆæ–‡ä»¶</h4>
<p>Interoperable Master Formatï¼ˆIMFï¼‰æ˜¯ä¸€ä¸ªç”± SMPTE æä¾›çš„æ ‡å‡†ï¼Œç”¨äºå®ç°ä¸€ä¸ªå•æ–‡ä»¶çš„ã€å¯äº¤æ¢ä½¿ç”¨çš„æ¯ç‰ˆæ–‡ä»¶æ ¼å¼å’Œç»“æ„ï¼Œç”¨äºå…¨çƒèŒƒå›´å†…çš„å•†ä¸šå†…å®¹åˆ†å‘ã€‚å®ƒæ˜¯ç”± Digital Cinema Packageï¼ˆDCPï¼‰æ¶æ„è¿›åŒ–è€Œæ¥çš„ï¼ŒDCP ä¸ºåˆ†å‘æ¸ é“æä¾›äº†ä¸€ä¸ªå®Œæ•´çš„æ–‡ä»¶å¯äº¤æ¢å•å…ƒã€‚IMF å¯ä»¥è¯´æ˜¯ä¸€ä¸ªé©å‘½æ€§çš„è¿›æ­¥ï¼ŒIMF æä¾›äº†ä¸€ä¸ªçœŸæ­£çš„åŸºäºæ–‡ä»¶çš„æœ€ç»ˆæ¯ç‰ˆã€‚DCP é’ˆå¯¹çš„æ˜¯å½±é™¢å†…å®¹åˆ†å‘ï¼Œè€Œ IMF ä¸ºå•†ç”¨ç¯å¢ƒæä¾›äº†ä¸€ä¸ªå¯ä»¥åŸºäºåŒä¸€å†…å®¹ä¸ºä¸åŒçš„è§‚ä¼—åˆ›å»ºå¤šç§å‰ªè¾‘ç‰ˆæœ¬çš„æ¯ç‰ˆæ ¼å¼ã€‚</p>
<h4 id="inverse-tone-mapping-itm-é€†å½±è°ƒæ˜ å°„-åå‘å½±è°ƒæ˜ å°„">Inverse Tone Mapping (ITM) é€†å½±è°ƒæ˜ å°„/åå‘å½±è°ƒæ˜ å°„</h4>
<p>å¯¹äº SDR å†…å®¹çš„æ¯ç‰ˆé‡åˆ¶ä»è€Œå®ç° HDR å†…å®¹ã€‚</p>
<p>ITM ä½¿ç”¨ SDR å†…å®¹å¹¶ä¸”æ‰©å±•å…¶æ˜åº¦å’Œè‰²å½©ç©ºé—´ï¼Œä½¿å…¶åŒ¹é… HDR æ˜¾ç¤ºå™¨çš„èƒ½åŠ›ï¼Œå¹¶ä¸”ä¿ç•™åŸæœ¬å†…å®¹åˆ›ä½œè€…çš„æ„å›¾ã€‚</p>
<h4 id="lut-æŸ¥æ‰¾è¡¨">LUT æŸ¥æ‰¾è¡¨</h4>
<p>æ˜¯ Look Up Table çš„ç¼©å†™ã€‚LUT æä¾›äº†ä¸€ç§å¯¹è¾“å…¥çš„æ•°æ®æ–½åŠ å¤æ‚æ•°å­¦è¿ç®—çš„é«˜æ•ˆæ–¹å¼â€”â€”â€”å¦‚æœä¸ä½¿ç”¨ LUT åˆ™ä¼šè€—è´¹è®¸å¤šçš„è®¡ç®—èµ„æºã€‚å› æ­¤ï¼Œå®ƒä»¬æ˜¯ä¸€ç§å°†å›¾åƒä»ä¸€ä¸ªè‰²å½©ç©ºé—´æ˜ å°„åˆ°é›¶ä¸€ä¸ªè‰²å½©ç©ºé—´çš„ç†æƒ³å®ç°æ–¹æ³•ã€‚</p>
<p>å­˜åœ¨ä»¥ä¸‹çš„ LUTsï¼š</p>
<p>3D LUTsï¼Œæ¯ä¸ªåƒç´ çš„è¾“å‡º Râ€™ã€Gâ€™ã€Bâ€™ å€¼æ˜¯ç”±è¾“å…¥åƒç´ çš„ Rã€Gã€B å€¼å…±åŒè®¡ç®—çš„ã€‚</p>
<p>1D LUTsï¼Œè¾“å‡ºçš„ Râ€™ åªç”±è¾“å…¥çš„ R å€¼è®¡ç®—ï¼ŒGâ€™ã€Bâ€™ åŒç†ã€‚å®ƒä»¬ä¸€èˆ¬è¢«ç”¨äº gamma å‡½æ•°å’Œå…¶å®ƒ EOTF çš„æ–½åŠ çŸ«æ­£ï¼Œä¸€èˆ¬åœ¨æ¶ˆè´¹çº§ç”µå­è®¾å¤‡çš„èŠ¯ç‰‡ç»„ä¸­å‡ºç°ã€‚</p>
<p>3D LUT ç›¸è¾ƒäº 1D LUT è€Œè¨€ï¼Œå®ƒæ”¯æŒæ›´åŠ å¼ºå¤§çš„æ•°å­¦è½¬æ¢ï¼Œä½†åœ¨èŠ¯ç‰‡ç»„é‡Œéƒ¨ç½²èµ·æ¥æ›´å¤æ‚ä¸”æ›´æ˜‚è´µã€‚ä¸€èˆ¬ 3D LUT è¢«ç”¨äºåœ¨åæœŸåˆ¶ä½œè¿‡ç¨‹ä¸­æ–½åŠ åˆ›é€ æ€§çš„â€œé£æ ¼â€ä»¥åŠè‰²å½©ç©ºé—´çš„è½¬æ¢ã€‚</p>
<h4 id="maxcll-metadata-maxcll-å…ƒæ•°æ®">MaxCLL Metadata MaxCLL å…ƒæ•°æ®</h4>
<p>Maximum Content Light Levelï¼ˆMaxCLLï¼‰æ˜¯ä¸€ä¸ªæ•´æ•°ç±»å‹çš„å…ƒæ•°æ®å€¼ï¼Œç”¨äºå®šä¹‰æŸä¸ªç¼–ç çš„ HDR è§†é¢‘æµæˆ–è€…æ–‡ä»¶ä¸­ï¼Œä»»æ„ä¸€ä¸ªåƒç´ çš„æœ€é«˜äº®åº¦ï¼Œå•ä½æ˜¯ nitsã€‚MaxCLL å¯ä»¥åœ¨æ¯ç‰ˆåˆ¶ä½œè¿‡ç¨‹ä¸­æˆ–è€…åˆ¶ä½œè¿‡ç¨‹åæ¥æµ‹é‡ï¼Œä½†æ˜¯ä¸ºäº†ä¿è¯ HDR æ˜¾ç¤ºå™¨åœ¨ MaxCLL HDR èŒƒå›´é‡Œçš„è‰²å½©è¿‡æ¸¡ï¼Œå¹¶ä¸”åœ¨æ˜¾ç¤ºå™¨çš„æœ€å¤§äº®åº¦å¤–æ–½åŠ ä¸€ä¸ªç¡¬ clipï¼Œæ˜¾ç¤ºå™¨çš„ MaxCLL ä¹Ÿå¯ä»¥è¢«ç”¨ä½œ MaxCLL å…ƒæ•°æ®ã€‚</p>
<h4 id="maxfall-metadata-maxfall-å…ƒæ•°æ®">MaxFALL Metadata MaxFALL å…ƒæ•°æ®</h4>
<p>Maximum Frame Average Light Levelï¼ˆMaxFALLï¼‰æ˜¯ä¸€ä¸ªæ•´æ•°ç±»å‹çš„å…ƒæ•°æ®å€¼ï¼Œç”¨äºå®šä¹‰æŸä¸ªç¼–ç çš„ HDR è§†é¢‘æµæˆ–è€…æ–‡ä»¶ä¸­ï¼Œä»»æ„ä¸€å¸§ç”»é¢çš„æœ€é«˜çš„å¹³å‡äº®åº¦ï¼Œå•ä½æ˜¯ nitsã€‚MaxFALL æ˜¯é€šè¿‡è®¡ç®—æ¯ä¸€å¸§ç”»é¢è§£ç åçš„æ‰€æœ‰åƒç´ çš„äº®åº¦çš„å¹³å‡å€¼æ¥è·å–çš„ã€‚</p>
<h4 id="peak-code-value-å³°å€¼ç¼–ç å€¼">Peak Code Value å³°å€¼ç¼–ç å€¼</h4>
<p>Peak Code Value æŒ‡çš„æ˜¯é€šè¿‡æŸä¸€ä¸ªç³»ç»Ÿç»„ä»¶è€Œä¸äº§ç”Ÿç¡¬å‰ªï¼ˆclipï¼‰çš„æœ€å¤§æ•°å­—ç¼–ç å€¼ã€‚</p>
<h4 id="peak-display-luminance-å³°å€¼æ˜¾ç¤ºäº®åº¦">Peak Display Luminance å³°å€¼æ˜¾ç¤ºäº®åº¦</h4>
<p>ä¸€ä¸ªæ˜¾ç¤ºå™¨æ‰€èƒ½äº§ç”Ÿçš„æœ€é«˜äº®åº¦ã€‚</p>
<h4 id="perceptual-quantizer-æ„Ÿå®˜é‡åŒ–æ›²çº¿">Perceptual Quantizer æ„Ÿå®˜é‡åŒ–æ›²çº¿</h4>
<p>Perceptual Quantizer çš„ç¼©å†™ï¼Œå®ƒæ˜¯ä¸€ä¸ª EOTFã€‚</p>
<p>MovieLabs æå‡ºäº†ä¸€æ¡åŸºäº Barton Curveï¼Œå¹¶å¯è¢«ç”¨äºé«˜åŠ¨æ€èŒƒå›´ï¼ˆHDRï¼‰çš„æ•°å­¦æ›²çº¿ï¼Œäº 2014 å¹´ç”± SMPTE åˆ¶å®šäº† ST2084 æ ‡å‡†ã€‚</p>
<p>Perceptual Quantization æ˜¯ä¸€ä¸ªé«˜æ•ˆç‡çš„ç¼–ç  HDR æ˜åº¦ä¿¡æ¯çš„æ–¹å¼ã€‚åœ¨æ•´ä¸ªåŠ¨æ€èŒƒå›´ä¸­ï¼Œæ¯ä¸€å¯¹ç›¸é‚»çš„ç¼–ç å€¼åŒºåˆ«éƒ½æ¯”å¯æ„ŸçŸ¥çš„åŒºåˆ«ç•¥å°ï¼Œä½¿å¾—ç å€¼åˆ©ç”¨ç‡æé«˜ã€‚</p>
<p>ä½†æ˜¯ï¼Œè¿™ä¸€ EOTF å¹¶ä¸å…¼å®¹ä¼ ç»Ÿæ˜¾ç¤ºå™¨ï¼ˆlegacy displayï¼‰ï¼ŒPQ ç¼–ç çš„ä¿¡å·åªèƒ½åœ¨æ–°çš„ã€æ”¯æŒ HDR çš„è®¾å¤‡ä¸Šè¢«è§£ç ã€‚</p>
<p>PQ ä¸º 10bit æˆ–è€… 12bit å†…å®¹æ‰€è®¾è®¡ï¼Œä¸”æ ¹æ® SMPTE ST2084 æ ‡å‡†ï¼Œä¸æ¨èåœ¨å®æ—¶å¹¿æ’­æ—¶ä½¿ç”¨å®ƒã€‚</p>
<h4 id="quantum-dot-qd-displays-é‡å­ç‚¹æ˜¾ç¤ºå™¨">Quantum Dotï¼ˆQDï¼‰Displays é‡å­ç‚¹æ˜¾ç¤ºå™¨</h4>
<p>é‡å­ç‚¹æ˜¾ç¤ºå™¨ä½¿ç”¨äº†çº³ç±³å°ºåº¦ï¼ˆ2nm-10nmï¼‰çš„æ™¶ä½“â€œç‚¹â€ã€‚æ¯ä¸€ä¸ªç‚¹ä¼šå‘å‡ºä¸€ä¸ªä¸åŒçš„çº¯è‰²ï¼Œè€Œå®ƒä»¬æ‰€å‘å‡ºçš„é¢œè‰²å–å†³äºå®ƒçš„å°ºå¯¸ã€‚</p>
<p>åœ¨ LCD èƒŒå…‰å‰åŠ å…¥ä¸€å¼ å¸¦æœ‰é‡å­ç‚¹çš„è–„è†œï¼ˆfilmï¼‰ï¼Œå›¾åƒçš„è‰²å½©è¿˜åŸå’Œæ€»ä½“çš„äº®åº¦å¯ä»¥è¢«æ˜¾è‘—æé«˜ã€‚</p>
<p>è¿™äº›å¾®å°çš„çº³ç±³æ™¶ä½“å¯ä»¥åœ¨èƒŒå…‰åˆ°è¾¾çº¢ã€ç»¿ã€è“å­åƒç´ å‰æ”¹å˜èƒŒå…‰çš„å…‰è°±ï¼Œå®ç°é«˜è¾¾ 20-30% çš„è‰²åŸŸæå‡ï¼Œä½¿å¾—æ˜¾ç¤ºè®¾å¤‡çš„è‰²å½©å¯ä»¥æ›´æ¥è¿‘ Rec.2020 ç›®æ ‡è‰²åŸŸã€‚</p>
<h4 id="st2084">ST2084</h4>
<p>SMPTE æ ‡å‡†ä¸­å®šä¹‰çš„ç”¨äºåˆ¶ä½œ HDR å†…å®¹æ¯ç‰ˆæ‰€ç”¨çš„ EOTFã€‚è¯¥ EOTF åˆè¢«ç§°ä¸º PQï¼Œä¸»è¦ç”¨äºåˆ¶ä½œéå¹¿æ’­å†…å®¹çš„æ¯ç‰ˆã€‚</p>
<h4 id="st2086">ST2086</h4>
<p>SMPTE æ ‡å‡†ä¸­å®šä¹‰çš„ç”¨äºæè¿°åˆ¶ä½œè§†é¢‘æ¯ç‰ˆæ‰€ä½¿ç”¨çš„æ˜¾ç¤ºå™¨çš„ç»å¯¹è‰²å½©ç©ºé—´çš„å…ƒæ•°æ®ï¼ˆåŸºè‰²åæ ‡ã€ç™½ç‚¹ã€äº®åº¦èŒƒå›´ï¼‰ã€‚</p>
<h4 id="tone-mapping-tone-mapping-operator-tmo-è‰²è°ƒæ˜ å°„-è‰²è°ƒæ˜ å°„è¿ç®—ç¬¦">Tone Mapping/Tone Mapping Operatorï¼ˆTMOï¼‰ è‰²è°ƒæ˜ å°„/è‰²è°ƒæ˜ å°„è¿ç®—ç¬¦</h4>
<p>è‰²è°ƒæ˜ å°„æ˜¯ä¸€ç§ç”¨äºå›¾åƒå¤„ç†å’Œè®¡ç®—æœºå›¾å½¢çš„æŠ€æœ¯ï¼Œå®ƒè¢«ç”¨äºå°†ä¸€ç»„é¢œè‰²æ˜ å°„åˆ°å¦ä¸€ç»„é¢œè‰²ï¼Œä»è€Œåœ¨å…·æœ‰æ›´æœ‰é™åŠ¨æ€èŒƒå›´çš„ä»‹è´¨ä¸­å®ç°é€¼è¿‘é«˜åŠ¨æ€èŒƒå›´ï¼ˆHDRï¼‰å›¾åƒçš„è§‚æ„Ÿã€‚ æ‰“å°è¾“å‡ºï¼ŒCRTæˆ–æ ‡å‡†åŠ¨æ€èŒƒå›´ï¼ˆSDRï¼‰ç›‘è§†å™¨å’ŒæŠ•å½±ä»ªéƒ½å…·æœ‰è¾ƒä½çš„åŠ¨æ€èŒƒå›´ï¼Œä¸è¶³ä»¥å†ç°HDRå›¾åƒä¸­å­˜åœ¨çš„å…¨éƒ¨å…‰å¼ºã€‚è‰²è°ƒæ˜ å°„è§£å†³äº†ä»è®°å½•èŒƒå›´åˆ°å¯æ˜¾ç¤ºèŒƒå›´çš„å¯¹æ¯”åº¦å‰§çƒˆé™ä½çš„é—®é¢˜ï¼ŒåŒæ—¶ä¿ç•™äº†å›¾åƒç»†èŠ‚å’Œè‰²å½©è¡¨ç°ï¼Œè¿™å¯¹äºæ¬£èµåŸå§‹åœºæ™¯å†…å®¹å’Œä¿ç•™åˆ›ä½œæ„å›¾æ˜¯é‡è¦çš„ã€‚ä¸€èˆ¬ä½¿ç”¨è‰²è°ƒæ˜ å°„è¿ç®—ç¬¦ï¼ˆTone Mapping Operatorï¼‰æ‰§è¡Œè¯¥è‰²è°ƒæ˜ å°„è¿‡ç¨‹ï¼Œé€šå¸¸ä¸ºâ€œSâ€å½¢æ›²çº¿ä»¥å®ç°é«˜å…‰å’Œé˜´å½±ç»†èŠ‚çš„æŸ”å’Œè¿‡æ¸¡ã€‚å‚è§ Inverse Tone Mappingï¼ˆITMï¼‰ã€‚</p>
<h4 id="wide-color-gamut-wcg-å¹¿è‰²åŸŸ">Wide Color Gamutï¼ˆWCGï¼‰ å¹¿è‰²åŸŸ</h4>
<p>Wide Color Gamut çš„ç¼©å†™ï¼Œæ„ä¸ºå¹¿è‰²åŸŸã€‚å¹¿è‰²åŸŸåŒ…æ‹¬äº†æ¯” Recommendation ITU-R BT.709 æ›´é¥±å’Œçš„è‰²å½©ï¼Œæ¯”å¦‚è¯´è¢« Rec.2020 æ‰€å®šä¹‰çš„è‰²å½©ç©ºé—´å°±å±äºå¹¿è‰²åŸŸã€‚</p>
<h4 id="white-point-ç™½ç‚¹">White Point ç™½ç‚¹</h4>
<p>ç™½ç‚¹ï¼ˆé€šå¸¸åœ¨æŠ€æœ¯æ–‡æ¡£ä¸­è¢«ç§°ä¸ºå‚è€ƒç™½ reference white æˆ–ç›®æ ‡ç™½ target whiteï¼‰æ˜¯ä¸€ç»„ç”¨äºå®šä¹‰å›¾åƒé‡‡é›†ï¼Œç¼–ç æˆ–å†ç°ä¸­çš„â€œç™½è‰²â€é¢œè‰²çš„è‰²åº¦åæ ‡ã€‚æ ¹æ®åº”ç”¨ï¼Œéœ€è¦ä¸åŒçš„â€œç™½è‰²â€å®šä¹‰ä»¥æä¾›å¯æ¥å—çš„ç»“æœã€‚ä¾‹å¦‚ï¼Œåœ¨å®¤å†…æ‹æ‘„çš„ç…§ç‰‡å¯èƒ½ç”¨ç™½ç‚½ç¯ç…§æ˜ï¼Œç™½ç‚½ç¯æ¯”æ—¥å…‰ç›¸å¯¹åæ©™ã€‚ å› æ­¤ï¼Œå¤§å¤šæ•°ä¸“ä¸šç›¸æœºæ‹¥æœ‰åœ¨ç™½ç‚½ç¯ç…§æ˜ä¸æ—¥å…‰ä¸‹æ‹æ‘„æ‰€ç”¨çš„ä¸åŒè®¾ç½®ã€‚åŒæ ·ï¼Œä¸º D65 ç™½ç‚¹æ˜¾ç¤ºå™¨æ‰€ç”Ÿäº§çš„å›¾åƒåœ¨å…·æœ‰ä¸åŒç™½ç‚¹çš„æ˜¾ç¤ºå™¨ä¸Šå°†æ— æ³•è¢«æ­£ç¡®æ˜¾ç¤ºã€‚</p>
<p>CIE å®šä¹‰ D65 å¸¸è¢«ç”¨æ¥å®šä¹‰è§†é¢‘æ˜¾ç¤ºå™¨çš„ç™½ç‚¹ã€‚</p>
<p>D55 æ›¾æ˜¯èƒ¶ç‰‡æŠ•å½±çš„æ ‡å‡†ç™½ç‚¹ï¼ŒDCI ç™½ç‚¹ï¼ˆè¯‘è€…æ³¨ï¼šæ¥è¿‘ D63ï¼Œä½†æ›´ç»¿ï¼‰å’Œ D60 ç™½ç‚¹è¿™ä¸¤ä¸ªç™½ç‚¹å‡è¢«æ•°å­—ç”µå½±å¹¿æ³›ä½¿ç”¨ã€‚</p>
<blockquote>
<p>æ›´å¤šæœ¯è¯­å¯ä»¥å‚è€ƒï¼š<a href="/shares/hdr-field-guide-final-web.pdf"><strong>Quick Reference HDR Glossary</strong></a></p>
</blockquote>
<h2 id="å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™</h2>
<p>1: <a href="https://www.cnet.com/news/hdr-for-cameras-vs-hdr-for-tvs-whats-the-difference/">https://www.cnet.com/news/hdr-for-cameras-vs-hdr-for-tvs-whats-the-difference/</a><br>
2: <a href="https://en.wikipedia.org/wiki/High-dynamic-range_imaging">https://en.wikipedia.org/wiki/High-dynamic-range_imaging</a><br>
3: <a href="https://en.wikipedia.org/wiki/High-dynamic-range_video">https://en.wikipedia.org/wiki/High-dynamic-range_video</a><br>
4: <a href="https://www.zhihu.com/question/19774840/answer/998271233">https://www.zhihu.com/question/19774840/answer/998271233</a><br>
5: <a href="https://alliance.experienceuhd.com/uhd-premium-features">https://alliance.experienceuhd.com/uhd-premium-features</a><br>
6: <a href="https://www.experienceuhd.com/uhd-mobile-hdr-premium-features">https://www.experienceuhd.com/uhd-mobile-hdr-premium-features</a><br>
7: <a href="http://openstd.samr.gov.cn/bzgk/gb/newGbInfo?hcno=AB4FAB66987D97573EA90F4DD56ABA36">http://openstd.samr.gov.cn/bzgk/gb/newGbInfo?hcno=AB4FAB66987D97573EA90F4DD56ABA36</a><br>
8: <a href="http://www.cuva.org.cn/ueditor/php/upload/file/20200904/1599186578364054.pdf">http://www.cuva.org.cn/ueditor/php/upload/file/20200904/1599186578364054.pdf</a><br>
9: <a href="https://zhuanlan.zhihu.com/p/345169019">https://zhuanlan.zhihu.com/p/345169019</a><br>
10: <a href="https://www.videoproc.com/resource/high-dynamic-range.htm">What Is HDR: Concepts, Standards, and Related Aspects</a></p>
]]></content>
      <categories>
        <category>è§†é¢‘æŠ€æœ¯</category>
      </categories>
      <tags>
        <tag>HDR</tag>
      </tags>
  </entry>
  <entry>
    <title>FFmpegè§£ç APIä»¥åŠåœ¨è§£ç è¿‡ç¨‹ä¸­å­˜åœ¨çš„ä¸¢å¸§é—®é¢˜</title>
    <url>/2021/01/19/FFMpeg-decode-process-and-lose-frame-in-that-process/</url>
    <content><![CDATA[<p><img src="/2021/01/19/FFMpeg-decode-process-and-lose-frame-in-that-process/1.png" alt></p>
<h2 id="èƒŒæ™¯">èƒŒæ™¯</h2>
<p>åœ¨ä¼˜åŒ–è§†é¢‘å®¢è§‚å…¨å‚è€ƒç®—æ³•ï¼ˆä¸»è¦æ˜¯<em>PSNR</em>, <em>SSIM</em>, <em>MS-SSIM</em>ï¼‰æ—¶ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ©ç”¨FFmpegæä¾›çš„APIï¼ˆ<em><code>avcodec_send_packet()</code></em>ï¼Œ<em><code>avcodec_receive_frame()</code></em>ï¼‰å¯¹è¾“å…¥çš„ä¸¤ä¸ªMP4æ–‡ä»¶è½¬æˆå¯¹åº”çš„YUVæ ¼å¼çš„æ•°æ®æ–‡ä»¶ï¼Œç„¶åå†åŸºäºè¿™ä¸¤ä»½YUVæ•°æ®æ–‡ä»¶è¿›è¡Œè®¡ç®—ï¼Œå¾—åˆ°å¯¹åº”çš„ç»“æœã€‚</p>
<p>ä½†æ˜¯ï¼Œæˆ‘ä»¬å‘ç°ï¼ŒMP4æ–‡ä»¶è½¬æˆYUVæ•°æ®åï¼Œæ€»æ˜¯ä¼šå‘ç”Ÿ<strong>ä¸¢å¤±è§†é¢‘æœ€åå‡ å¸§</strong>çš„ç°è±¡ã€‚</p>
<p>ä¸ºäº†å¼„æ¸…æ¥šè¿™ä¸ªé—®é¢˜ï¼ŒæŸ¥é˜…äº†FFmpegçš„æºç ï¼Œå¹¶å‚è€ƒäº†ç½‘ç»œä¸Šçš„èµ„æ–™ï¼Œç„¶åæ€»ç»“å‡ºäº†è¿™ç¯‡æ–‡ç« ã€‚</p>
<span id="more"></span>
<h2 id="ffmpegçš„ç¼–è§£ç api">FFmpegçš„ç¼–è§£ç API</h2>
<p>ä»<a href="https://github.com/FFmpeg/FFmpeg/commit/7fc329e2dd6226dfecaa4a1d7adf353bf2773726">3.1ç‰ˆæœ¬</a>å¼€å§‹ï¼ŒFFmpegæä¾›äº†<a href="https://github.com/FFmpeg/FFmpeg/blob/release/3.1/libavcodec/avcodec.h">æ–°çš„ç¼–è§£ç API</a>æ¥å¯¹éŸ³è§†é¢‘æ•°æ®è¿›è¡Œç¼–è§£ç æ“ä½œï¼Œä»è€Œå®ç°å¯¹è¾“å…¥å’Œè¾“å‡ºçš„è§£è€¦ï¼š</p>
<ul>
<li>è§£ç API
<ul>
<li>avcodec_send_packet()</li>
<li>avcodec_receive_frame()</li>
</ul>
</li>
<li>ç¼–ç API
<ul>
<li>avcodec_send_frame()</li>
<li>avcodec_receive_packet()</li>
</ul>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @ingroup libavc</span></span><br><span class="line"><span class="comment"> * @defgroup lavc_encdec send/receive encoding and decoding API overview</span></span><br><span class="line"><span class="comment"> * @&#123;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * The avcodec_send_packet()/avcodec_receive_frame()/avcodec_send_frame()/</span></span><br><span class="line"><span class="comment"> * avcodec_receive_packet() functions provide an encode/decode API, which</span></span><br><span class="line"><span class="comment"> * decouples input and output.</span></span><br><span class="line"><span class="comment"> * ...</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>
<p>åŒæ—¶ï¼Œä¹Ÿæ­£æ˜¯ä»3.1ç‰ˆæœ¬å¼€å§‹ï¼Œä¹‹å‰çš„ç¼–è§£ç APIä¹Ÿè¢«æ ‡æ³¨ä¸º<code>deprecated</code>ï¼š</p>
<ul>
<li>è§£ç API
<ul>
<li>avcodec_decode_video2()</li>
<li>avcodec_decode_audio4():</li>
</ul>
</li>
<li>ç¼–ç API
<ul>
<li>avcodec_encode_video2()</li>
<li>avcodec_encode_audio2()</li>
</ul>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">attribute_deprecated</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">avcodec_decode_audio4</span><span class="params">(AVCodecContext *avctx, AVFrame *frame,</span></span></span><br><span class="line"><span class="function"><span class="params">                          <span class="keyword">int</span> *got_frame_ptr, <span class="keyword">const</span> AVPacket *avpkt)</span></span>;</span><br></pre></td></tr></table></figure>
<p>åœ¨æˆ‘ä»¬çš„å·¥å…·ä¸­ï¼Œæˆ‘ä»¬é‡‡ç”¨äº†æ–°çš„è§£ç APIï¼š<code>avcodec_send_packet()</code>å’Œ<code>avcodec_receive_frame()</code>ï¼Œå®ç°è§†é¢‘å¸§çš„è§£ç ï¼Œå¹¶å°†è§£ç åçš„æ•°æ®è½¬æˆYUVæ•°æ®ã€‚å…·ä½“çš„ä»£ç ç‰‡æ®µå¦‚ä¸‹ï¼Œ<a href="https://github.com/wangwei1237/wangwei1237.github.io/blob/master/2021/01/19/FFMpeg-decode-process-and-lose-frame-in-that-process/test_video_parser_1.cpp">ç‚¹å‡»å¯æŸ¥çœ‹å®Œæ•´æµ‹è¯•ä»£ç </a>ã€‚</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">process_frame</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ......</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//decode operation.</span></span><br><span class="line"><span class="keyword">while</span> (!<span class="built_in">av_read_frame</span>(fmt_ctx, pkt)) &#123;</span><br><span class="line">    <span class="keyword">if</span> (pkt-&gt;stream_index != video_stream_idx) &#123;</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> packet_new = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">process_frame</span>(fmt_ctx, dec_ctx, video_stream-&gt;codecpar, </span><br><span class="line">                         frame, pkt, &amp;packet_new) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        i++;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="built_in">av_packet_unref</span>(pkt);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä»ä»£ç å¯ä»¥çœ‹å‡ºï¼Œ<code>i</code>æ˜¯è§£ç å¸§çš„æ€»æ•°ï¼Œä½†æ˜¯æˆ‘ä»¬è¿è¡Œä¹‹åå‘ç°ï¼Œä¸€ä¸ª252å¸§çš„è§†é¢‘ï¼Œæœ€ç»ˆåªå¾—åˆ°äº†248å¸§ã€‚</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> g++ --std=c++11 test_video_parser_1.cpp $(pkg-config --cflags --libs libavcodec libavdevice libavformat libavutil)</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> frame count: 248</span></span><br></pre></td></tr></table></figure>
<h2 id="send-packet-receive-frame">send_packet &amp; receive_frame</h2>
<p>ä¸ºäº†åŠ æ·±å¯¹è§£ç APIçš„äº†è§£ï¼Œä»¥ä¾¿èƒ½æŸ¥å‡ºé—®é¢˜åŸå› ï¼Œæˆ‘ä»¬æŸ¥é˜…äº†<a href="https://github.com/FFmpeg/FFmpeg/blob/master/libavcodec/avcodec.h">FFmpegçš„ä»£ç </a>ï¼Œä»ä»£ç çš„æ³¨é‡Šä¸­ï¼Œæˆ‘ä»¬å‘ç°äº†é—®é¢˜ï¼š<strong>æˆ‘ä»¬æ²¡æœ‰éµå¾ªAPIçš„ä½¿ç”¨è§„èŒƒï¼ŒåŒæ—¶FFmpegåœ¨æ³¨é‡Šä¸­ä¹Ÿè¯´æ˜äº†ä¸ºä»€ä¹ˆä¼šå‡ºç°æˆ‘ä»¬é‡åˆ°çš„é—®é¢˜</strong>ã€‚</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * ... </span></span><br><span class="line"><span class="comment">  * At the beginning of decoding or encoding, the codec might accept multiple</span></span><br><span class="line"><span class="comment">  * input frames/packets without returning a frame, until its internal buffers</span></span><br><span class="line"><span class="comment">  * are filled. This situation is handled transparently if you follow the steps</span></span><br><span class="line"><span class="comment">  * outlined above.</span></span><br><span class="line"><span class="comment">  * </span></span><br><span class="line"><span class="comment">  * End of stream situations. These require &quot;flushing&quot; (aka draining) the codec,</span></span><br><span class="line"><span class="comment">  * as the codec might buffer multiple frames or packets internally for</span></span><br><span class="line"><span class="comment">  * performance or out of necessity (consider B-frames).</span></span><br><span class="line"><span class="comment">  * ...</span></span><br><span class="line"><span class="comment">  */</span></span><br></pre></td></tr></table></figure>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸ºäº†æå‡æ€§èƒ½æˆ–å‡ºäºå…¶ä»–çš„è€ƒè™‘ï¼Œè§£ç å™¨ä¼šåœ¨å†…éƒ¨ç¼“å­˜å¤šä¸ª<code>frames</code>/<code>packets</code>ã€‚å› æ­¤ï¼Œå½“æµç»“æŸçš„æ—¶å€™ï¼Œéœ€è¦å¯¹è§£ç å™¨æ‰§è¡Œ<code>flushing</code>æ“ä½œï¼Œä»¥ä¾¿è·å–è§£ç å™¨ç¼“å­˜çš„<code>frames</code>/<code>packets</code>ã€‚</p>
<p>æˆ‘ä»¬çš„å·¥å…·ä¸­ï¼Œåœ¨æµç»“æŸä¹‹åï¼Œå¹¶æ²¡æœ‰æ‰§è¡Œ<code>flushing</code>æ“ä½œï¼Œå› æ­¤å°±å‡ºç°äº†è§£ç è¿‡ç¨‹ä¸¢å¸§çš„ç°è±¡ã€‚æŒ‰ç…§FFmpegçš„æŒ‡å¯¼ï¼Œæˆ‘ä»¬è¡¥å……äº†å¦‚ä¸‹çš„é€»è¾‘ï¼Œä»¥ä¾¿è·å–è§£ç å™¨ä¸­ç¼“å­˜çš„å¸§ï¼Œ<a href="https://github.com/wangwei1237/wangwei1237.github.io/blob/master/2021/01/19/FFMpeg-decode-process-and-lose-frame-in-that-process/test_video_parser_2.cpp">ç‚¹å‡»å¯æŸ¥çœ‹å®Œæ•´æµ‹è¯•ä»£ç </a>ã€‚</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//Flush remaining frames that are cached in the decoder</span></span><br><span class="line"><span class="keyword">int</span> packet_new = <span class="number">1</span>;</span><br><span class="line"><span class="built_in">av_init_packet</span>(pkt);</span><br><span class="line">pkt-&gt;data = <span class="literal">NULL</span>;</span><br><span class="line">pkt-&gt;size = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">process_frame</span>(fmt_ctx, dec_ctx, video_stream-&gt;codecpar, </span><br><span class="line">                     frame, pkt, &amp;packet_new) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    i++;</span><br><span class="line">    packet_new = <span class="number">1</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>å†æ¬¡è¿è¡Œï¼Œæˆ‘ä»¬å‘ç°ï¼Œä¸¢å¸§é—®é¢˜æ¶ˆå¤±äº†ã€‚</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> g++ --std=c++11 test_video_parser_1.cpp $(pkg-config --cflags --libs libavcodec libavdevice libavformat libavutil)</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> frame count: 252</span></span><br></pre></td></tr></table></figure>
<h2 id="ffmpegè§£ç apiçŠ¶æ€æœº">FFMPegè§£ç APIçŠ¶æ€æœº</h2>
<h3 id="avcodec-send-packetè¿”å›å€¼">avcodec_send_packetè¿”å›å€¼</h3>
<p>ä»FFmpegçš„æºç ä¸­ï¼Œæˆ‘ä»¬ä¼šå‘ç°ï¼Œæ­£å¸¸æƒ…å†µä¸‹ï¼Œ<code>avcodec_send_packet()</code>å‡½æ•°çš„è¿”å›å€¼ä¸»è¦æœ‰ä»¥ä¸‹ä¸‰ç§ï¼š</p>
<ul>
<li><code>0</code>: on success.</li>
<li><code>EAGAIN</code>: input is not accepted in the current state - user must read output with avcodec_receive_frame() (once all output is read, the packet should be resent, and the call will not fail with EAGAIN).</li>
<li><code>EOF</code>: the decoder has been flushed, and no new packets can be sent to it (also returned if more than 1 flush packet is sent).</li>
</ul>
<h3 id="avcodec-receive-frameè¿”å›å€¼">avcodec_receive_frameè¿”å›å€¼</h3>
<p>åŒæ ·çš„ï¼Œæ­£å¸¸æƒ…å†µä¸‹ï¼Œ<code>avcodec_receive_frame()</code>å‡½æ•°çš„è¿”å›å€¼ä¸»è¦æœ‰ä»¥ä¸‹ä¸‰ç§ï¼š</p>
<ul>
<li><code>0</code>: success, a frame was returned.</li>
<li><code>EAGAIN</code>: output is not available in this state - user must try to send new input.</li>
<li><code>EOF</code>: the decoder has been fully flushed, and there will be no more output frames.</li>
</ul>
<h3 id="è§£ç apiçŠ¶æ€æœº">è§£ç APIçŠ¶æ€æœº</h3>
<p><code>avcodec_send_packet()</code>å’Œ<code>avcodec_receive_frame()</code>ä¸åŒçš„è¿”å›å€¼ä»£è¡¨äº†è§£ç å™¨çš„ä¸åŒçš„çŠ¶æ€ã€‚</p>
<p>å¯¹APIçš„è°ƒç”¨å®é™…ä¸Šæ˜¯ä¸€ç§åŠ¨ä½œï¼Œè€ŒAPIçš„è¿”å›å€¼åˆ™ç”¨æ¥æ ‡å¿—å½“å‰è§£ç å™¨çš„çŠ¶æ€ã€‚å› æ­¤ï¼Œè§£ç APIçš„æ•´ä¸ªè¿‡ç¨‹å®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªçŠ¶æ€æœºã€‚</p>
<p>æ ¹æ®<a href="#avcodec_send_packet%E8%BF%94%E5%9B%9E%E5%80%BC">avcodec_send_packetè¿”å›å€¼</a>å’Œ<a href="#avcodec_receive_frame%E8%BF%94%E5%9B%9E%E5%80%BC">avcodec_receive_frameè¿”å›å€¼</a>ä¸­çš„ä»‹ç»ï¼Œå¯ä»¥å¾—åˆ°æ­£å¸¸æƒ…å†µä¸‹ï¼Œè§£ç è¿‡ç¨‹çš„çŠ¶æ€æœºï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p>
<p><img src="/2021/01/19/FFMpeg-decode-process-and-lose-frame-in-that-process/2.png" alt></p>
<p>åœ¨å›¾ä¸­ï¼Œ<code>èŠ‚ç‚¹</code>ä»£è¡¨çŠ¶æ€ï¼ˆAPIçš„è¿”å›å€¼ï¼‰ï¼Œ<code>ç®­å¤´</code>ä»£è¡¨APIçš„è°ƒç”¨ã€‚è“è‰²è¡¨ç¤ºå’Œ<code>avcodec_send_packet()</code>ç›¸å…³ï¼Œçº¢è‰²è¡¨ç¤ºå’Œ<code>avcodec_receive_frame()</code>ç›¸å…³ã€‚</p>
<p><a href="https://wangwei1237.gitee.io/2021/01/19/FFMpeg-decode-process-and-lose-frame-in-that-process/test_video_parser_2.cpp">æˆ‘ä»¬ä¿®å¤ç‰ˆæœ¬çš„è§£ç å®ç°</a>å®é™…ä¸Šå°±æ˜¯å¯¹å¦‚ä¸Šå›¾æ‰€ç¤ºçš„çŠ¶æ€æœºçš„å®ç°ã€‚</p>
<p>è€Œå¦‚æœåœ¨å®ç°çš„æ—¶å€™ï¼Œæ²¡æœ‰å¤„ç†å¦‚ä¸‹å›¾æ‰€ç¤ºçš„çŠ¶æ€ï¼Œåˆ™ä¼šå¯¼è‡´æ— æ³•è·å–è§†é¢‘æœ€åå‡ å¸§çš„é—®é¢˜ã€‚</p>
<p><img src="/2021/01/19/FFMpeg-decode-process-and-lose-frame-in-that-process/3.png" alt></p>
<h2 id="æ€è€ƒ">æ€è€ƒ</h2>
<ul>
<li>æºç é¢å‰ï¼Œäº†æ— ç§˜å¯†ã€‚ä¾¯æ·è€å¸ˆè¯´è¿‡â€œæºç é¢å‰ï¼Œäº†æ— ç§˜å¯†â€ã€‚å·¥ä½œä¸­å‘ç°ï¼Œæºç ç¡®å®æ˜¯æˆ‘ä»¬è·å–çŸ¥è¯†å’Œç»éªŒçš„ä¸€ä¸ªéå¸¸æœ‰æ•ˆçš„é€”å¾„ï¼Œå°¤å…¶æ˜¯é‚£äº›å¥½çš„å¼€æºé¡¹ç›®çš„æºç ï¼Œæ›´æ˜¯å¦‚æ­¤ã€‚</li>
<li>æºç è¿˜æ˜¯æˆ‘ä»¬è§£å†³é—®é¢˜çš„å¼ºæœ‰åŠ›çš„æ‰‹æ®µä¹‹ä¸€ã€‚å¯¹äºè¿™äº›ä¼˜ç§€çš„å¼€æºé¡¹ç›®çš„æºç è€Œè¨€ï¼Œä»£ç åªæ˜¯ä¸€ä¸ªéƒ¨åˆ†ï¼Œæºç ä¸­çš„æ³¨é‡Šã€æ–‡æ¡£ç­‰ä¼šä¸ºæˆ‘ä»¬æä¾›è¶³å¤Ÿçš„èµ„æºã€‚è¿™æ¬¡é—®é¢˜çš„è§£å†³å°±æ˜¯ä¾èµ–æºç ï¼Œä¹‹å‰åœ¨Androidæ‘„åƒå¤´MockæŠ€æœ¯çš„ç ”ç©¶ä¸­ï¼Œä¹Ÿæ˜¯åœ¨æŸ¥é˜…Androidç›¸å…³æºç åæ‰æœ‰äº†æ€è·¯ã€‚å› æ­¤ï¼Œå½“æˆ‘ä»¬åœ¨å·¥ä½œä¸­é‡åˆ°é—®é¢˜çš„æ—¶å€™ï¼Œç¬¬ä¸€æ‰‹çš„èµ„æ–™è¿˜æ˜¯æºç ï¼ˆå½“ç„¶ï¼Œè¦æœ‰æºç æ‰è¡Œï¼‰ï¼Œå…¶æ¬¡æ‰æ˜¯å®˜æ–¹æ–‡æ¡£ï¼Œæœ€åæ‰æ˜¯ç½‘ç»œä¸Šçš„å…¶ä»–èµ„æºã€‚</li>
<li>çœ‹äº†é‚£ä¹ˆå¤šçš„æºç æ‰å‘ç°ï¼šä¼˜ç§€çš„é¡¹ç›®æ˜¯é‚£ä¹ˆçš„ä¸€è‡´ï¼Œè€Œç³Ÿç³•çš„é¡¹ç›®ï¼Œå„æœ‰å„çš„ç³Ÿç³•ä¹‹å¤„ã€‚</li>
</ul>
]]></content>
      <categories>
        <category>è§†é¢‘æŠ€æœ¯</category>
      </categories>
      <tags>
        <tag>FFmpeg</tag>
        <tag>è§†é¢‘è§£ç </tag>
        <tag>è§£ç ä¸¢å¸§</tag>
        <tag>avcodec_send_packet</tag>
        <tag>avcodec_receive_frame</tag>
      </tags>
  </entry>
  <entry>
    <title>ä¿¡ä»»ï¼Œä½†ä¹Ÿè¦æ ¸æŸ¥</title>
    <url>/2021/01/11/Trust-but-Verify/</url>
    <content><![CDATA[<p><img src="/2021/01/11/Trust-but-Verify/1.jpg" alt></p>
<blockquote>
<p>1987å¹´ï¼Œåœ¨ç¾è‹ä¸­ç¨‹æ ¸æ­¦å™¨åè®®è°ˆåˆ¤æ—¶ï¼Œç¾å›½æ€»ç»Ÿé‡Œæ ¹æ—æ•²ä¾§å‡»ï¼Œå¯¹æˆˆå°”å·´ä¹”å¤«è¯´ï¼šâ€œæˆ‘éå¸¸å–œæ¬¢ä¸€å¥ä¿„å›½è°šè¯­â€”â€”<strong><code>Trust, but verify</code></strong>â€ã€‚</p>
<p>æ„æ€å°±æ˜¯ï¼Œé‡Œæ ¹ç›¸ä¿¡è‹è”é¢†å¯¼äººçš„æ‰¿è¯ºï¼Œä½†è¿˜å¿…é¡»æœ‰ä¸ªæœ‰æ•ˆçš„éªŒè¯æœºåˆ¶ã€‚</p>
<p><a href="https://en.wikipedia.org/wiki/Trust,_but_verify"><div align="right">å…³äºè¯¥è°šè¯­çš„è¯¦ç»†ä¿¡æ¯ï¼Œå¯ä»¥å‚è€ƒç»´åŸºç™¾ç§‘</div></a></p>
</blockquote>
<span id="more"></span>
<p>éšç€è‡ªå·±çš„æˆé•¿ï¼Œéšç€å·¥ä½œå†…å®¹ä»å®Œæˆä¸Šçº§å®‰æ’çš„å·¥ä½œåˆ°è‡ªå·±å¼€å§‹è§„åˆ’å¹¶å®‰æ’æŸäº›å·¥ä½œï¼Œéšç€å·¥ä½œèŒƒå›´ä»å›¢é˜Ÿå†…éƒ¨åˆ°è·¨å›¢é˜Ÿçš„åä½œï¼Œè‡ªå·±å¯¹<code>Trust, but verify</code>è¿™ç§æ€æƒ³çš„æ„Ÿè§¦è¶Šæ¥è¶Šæ·±ã€‚</p>
<p>å°¤å…¶æ˜¯åœ¨åšå¤§å›¢é˜Ÿæ¨ªå‘å·¥ä½œçš„è§„åˆ’å’Œæ¨åŠ¨ï¼Œä»¥åŠç»„å»ºè§†é¢‘å°ç»„æ¥æ¢ç´¢è§†é¢‘ç›¸å…³çš„æŠ€æœ¯ï¼Œæ›´åŠ æ·±äº†å¯¹<code>Trust, but verify</code>çš„ç†è§£ã€‚</p>
<p><code>ä¿¡ä»»</code>ç»™äºˆæˆ‘ä»¬å·¥ä½œçš„è‡ªç”±ï¼Œè€Œ<code>æ ¸æŸ¥</code>ä¼šç»™è¿™ä»½è‡ªç”±å¢åŠ ä¸€å®šçš„é™åˆ¶ã€‚ç»å¯¹çš„ä¿¡ä»»ä¼šå¯¼è‡´ä¿¡ä»»çš„ç»ˆç»“ï¼Œä¸åŠ é™åˆ¶çš„ä¿¡ä»»æœ€ç»ˆå¯èƒ½ä¼šå½±å“å›¢é˜Ÿçš„å¯æŒç»­å‘å±•ã€‚ä¿¡é©¬ç”±ç¼°è€…ï¼Œç»ˆä¸èƒ½è¾¾åˆ°ç›®æ ‡ã€‚</p>
<p><code>æ ¸æŸ¥</code>æœºåˆ¶ä¸‹çš„<code>ä¿¡ä»»</code>ï¼Œæ‰èƒ½åœ¨ç»™äºˆå·¥ä½œè‡ªç”±çš„åŒæ—¶ï¼Œè·å¾—ä¸ªäººå’Œå…¬å¸çš„åˆ©ç›Šæœ€å¤§åŒ–ã€‚</p>
<h2 id="ç½‘é£æ–‡åŒ–ä¸­çš„è‡ªç”±ä¸è´£ä»»">ç½‘é£æ–‡åŒ–ä¸­çš„è‡ªç”±ä¸è´£ä»»</h2>
<p>ä½œä¸ºä¸€å®¶ä¼ å¥‡çš„å…¬å¸ï¼Œæˆç«‹äº1997å¹´çš„ç½‘é£ï¼Œåœ¨æˆåŠŸåº”å¯¹äº†å¨±ä¹é¢†åŸŸå’Œå•†ä¸šé¢†åŸŸçš„å››æ¬¡å¤§è§„æ¨¡è½¬å‹ä¹‹åï¼Œå…¶è‚¡ä»·å·²ç»ä»1$ä¸€è·¯æ”€å‡è‡³500$ï¼Œå¦‚ä»Šï¼Œå…¶å¸‚å€¼å·²ç»è¶…è¿‡äº†2000äº¿ç¾å…ƒã€‚</p>
<p><img src="/2021/01/11/Trust-but-Verify/3.jpg" alt></p>
<p>æ ¹æ®æ‹›è˜ç½‘ç«™<a href="https://hired.com/">Hired</a>çš„<a href="https://hired.com/blog/highlights/2020-brand-health-report/">ç¬¬4æ¬¡ã€Šå…¨çƒå“ç‰Œå¥åº·æŠ¥å‘Šã€‹</a>ï¼ŒNetflixå·²ç»å–ä»£Googleï¼Œæˆä¸ºäººä»¬æœ€æƒ³å»å·¥ä½œçš„é¡¶çº§ç§‘æŠ€å…¬å¸ã€‚</p>
<p><img src="/2021/01/11/Trust-but-Verify/2.png" alt></p>
<p>ç½‘é£çš„æˆåŠŸï¼Œç¦»ä¸å¼€å…¶ä¼ä¸šæ–‡åŒ–ã€‚åœ¨ã€Šè‡ªç”±ä¸è´£ä»»â€”â€”ç½‘é£æ–‡åŒ–æ‰‹å†Œã€‹çš„<em>ç½‘é£æ–‡åŒ–çš„ä¸ƒä¸ªæ–¹é¢</em>ä¸­ï¼Œå°±æåˆ°äº†<strong>è‡ªç”±ä¸è´£ä»»</strong>è¿™ä¸€æ–‡åŒ–ã€‚åœ¨æ‰‹å†Œä¸­ï¼Œä¹Ÿæåˆ°ï¼šè‡ªç”±ä¸æ˜¯ç»å¯¹çš„ï¼Œå’Œè¨€è®ºè‡ªç”±ä¸€æ ·ï¼Œå·¥ä½œè‡ªç”±ä¹Ÿæ˜¯æœ‰é™åº¦çš„ã€‚</p>
<div class="douban-card-block">
	<a class="douban-card" href="https://book.douban.com/subject/35102294">
		<div class="douban-card-bgimg" style="background-image: url('https://images.weserv.nl/?url=https://img1.doubanio.com/view/subject/s/public/s33784858.jpg');"></div>
		<div class="douban-card-left">
			<div class="douban-card-img" style="background-image: url('https://images.weserv.nl/?url=https://img1.doubanio.com/view/subject/s/public/s33784858.jpg');"></div>
		</div>
		<div class="douban-card-right" style="line-height: 1.7;">
			<div class="douban-card-item"><span>ä¹¦å: </span><strong>ä¸æ‹˜ä¸€æ ¼</strong></div>
			<div class="douban-card-item"><span>ä½œè€…: </span><span>[ç¾]é‡Œå¾·Â·å“ˆæ–¯å»·æ–¯</span></div>
			<div class="douban-card-item"><span>å‡ºç‰ˆå¹´ä»½: </span><span>2021-1-1</span></div>
			<div class="douban-card-item"><span>è¯„åˆ†: </span><span>8.1</span></div>
		</div>
	</a>
</div>
<style>
	.douban-card-block {
		display: flex;
		justify-content: center;
		align-items: center;
		width: 100%;
		max-height: 400px;
	}
	.douban-card {
		display: flex;
		margin: 30px 10px;
		padding: 15px;
		border-radius: 10px;
		position: relative;
		justify-content: center;
		align-items: center;
		overflow: hidden;
		color: antiquewhite;
		text-decoration: none;
	}
	.douban-card:hover {
		text-decoration: none;
	}
	.douban-card-bgimg {
		position: absolute;
		width: 115%;
		height: 115%;
		filter: blur(15px) brightness(0.6);
		background-size: 100%;
		background-position: center;
		background-repeat: no-repeat;
	}
	.douban-card-img {
		position: relative;
		height: 130px;
		width: 80px;
		background-size: 100%;
		background-position: center;
		background-repeat: no-repeat;
	}
	.douban-card-img {
		position: relative;
		height: 130px;
		width: 80px;
	}
	.douban-card-left {
		position: relative;
		display: flex;
		flex-direction: column;
		align-items: center;
	}
	.douban-card-right {
		position: relative;
		display: flex;
		flex-direction: column;
		margin-left: 12px;
		font-size: 16px;
		font-family: 'Courier New', Courier, monospace;
		line-height: 1.3;
		color: antiquewhite;
	}
	.douban-card-item {
		margin-top: 4px;
	}
</style>
<p>åœ¨ç½‘é£åˆ›å§‹äººé‡Œå¾·Â·å“ˆæ–¯å»·æ–¯çš„ã€Šä¸æ‹˜ä¸€æ ¼â€”â€”ç½‘é£çš„è‡ªç”±ä¸è´£ä»»å·¥ä½œæ³•ã€‹ä¸€ä¹¦çš„ç¬¬ä¸‰ç« ä¸­ï¼Œä¹Ÿåˆ—ä¸¾äº†2ä¸ªä¾‹å­æ¥ä»‹ç»å…¶è‡ªç”±ä¸è´£ä»»çš„æ–‡åŒ–ï¼š</p>
<ul>
<li>å–æ¶ˆé™æœŸä¼‘å‡åˆ¶åº¦</li>
<li>å–æ¶ˆå·®æ—…å’Œç»è´¹å®¡æ‰¹</li>
</ul>
<p>ç½‘é£æ²¡æœ‰å¯¹å…³äºèŠ±é”€ã€å¨±ä¹ã€é¦ˆèµ ã€å‡ºå·®ã€ä»¥åŠä¼‘å‡ç»™å‡ºå…·ä½“çš„è§„åˆ™å’Œåˆ¶åº¦ï¼Œè€Œæ˜¯ç»™äºˆå‘˜å·¥æå¤§çš„è‡ªç”±æ¥è‡ªä¸»å®‰æ’ï¼Œä½†æ˜¯è¿™ç§è‡ªç”±çš„å‰ææ˜¯ï¼šå…¬å¸åˆ©ç›Šè‡³ä¸Šã€‚</p>
<p>è€Œå…¬å¸åˆ©ç›Šè‡³ä¸Šï¼Œåˆ™æ„å‘³ç€ï¼š</p>
<ul>
<li>èŠ±è¯¥èŠ±çš„é’±ï¼Œå¦åˆ™å°±åˆ«èŠ±ï¼Œè€Œä¸”è¿™äº›é’±åº”è¯¥æ˜¯ä¸ºäº†å·¥ä½œè€ŒèŠ±</li>
<li>é€æ¼é‡è¦ä¾›åº”å•†é¦ˆèµ çš„ç¤¼ç‰©</li>
<li>åˆ©ç”¨å…¬å¸çš„èµ„æºï¼Œå¿…é¡»æ˜¯ä¸ºäº†æé«˜å·¥ä½œæ•ˆç‡ï¼Œä¸”å¿…é¡»åˆç†</li>
<li>â€¦â€¦</li>
</ul>
<p>åŒæ—¶ï¼Œå¯¹äºå…¬å¸ç»™äºˆå‘˜å·¥çš„è¿™ä»½è‡ªç”±ï¼Œç½‘é£è¿˜æœ‰ä¸€å¥—æ—¶å€™æ ¸å®çš„åˆ¶åº¦æ¥ç¡®ä¿ï¼Œå‘˜å·¥çš„è‡ªç”±æ»¡è¶³äº†å…¬å¸åˆ©ç›Šè‡³ä¸Šçš„åŸåˆ™ã€‚è¿™ç§åˆ¶åº¦åœ¨ç½‘é£å†…éƒ¨ç§°ä¸ºï¼š<strong>äº‹æƒ…æƒ…æ™¯è®¾å®šï¼Œæ—¶å€™æ ¸å®æŠ¥é”€</strong>ã€‚</p>
<h2 id="è‡ªç”±ä¸è´£ä»»-ä¿¡ä»»ä¸æ ¸æŸ¥">è‡ªç”±ä¸è´£ä»»&amp;ä¿¡ä»»ä¸æ ¸æŸ¥</h2>
<p>å½“æœ€å¼€å§‹æ²¡æœ‰æµç¨‹å’Œåˆ¶åº¦çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®é‡åˆ°çš„å…·ä½“çš„é—®é¢˜åˆ¶å®šç›¸å…³çš„æµç¨‹å’Œåˆ¶åº¦ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæµç¨‹å’Œåˆ¶åº¦ä¼šæ˜¯æœ‰æ•ˆçš„ã€‚ä½†é—®é¢˜æ˜¯ï¼Œéšç€æ—¶é—´çš„ä¸æ–­å‘å±•ï¼Œéšç€é—®é¢˜çš„ä¸æ–­å¢åŠ ï¼Œèµ·åˆçš„é‚£ä¸ªæµç¨‹åˆ¶åº¦å°±è¢«è¡¥å……çš„ä¼šè¶Šæ¥è¶Šå¤šã€‚è¿™ä¸ªæ—¶å€™ï¼Œæ¯ä¸ªäººéƒ½éœ€è¦å¯¹æµç¨‹å’Œåˆ¶åº¦è¿›è¡Œå­¦ä¹ ï¼Œç„¶åæŒ‰ç…§è¿™ä¸ªå¤æ‚çš„åˆ¶åº¦æ¥è¡Œäº‹ï¼Œåœ¨äº’è”ç½‘å…¬å¸ä¸­ï¼Œè¿™ç®€ç›´æ˜¯ä¸€ä»¶ä¸å¯æƒ³è±¡çš„äº‹æƒ…ã€‚å¦‚æœå‘˜å·¥åœ¨é‡åˆ°é—®é¢˜çš„æ—¶å€™ï¼Œè¿˜éœ€è¦é€šè¿‡æŸ¥é˜…æµç¨‹åˆ¶åº¦æ–‡æ¡£æ¥æŒ‡å¼•è‡ªå·±çš„è¡ŒåŠ¨ï¼Œé‚£æ–‡åŒ–çš„æ„ä¹‰ä¹Ÿå°±è¡ç„¶æ— å­˜äº†ã€‚</p>
<p>æˆ‘æ€»æ˜¯é‡åˆ°å¾ˆå¤šçš„æµç¨‹åˆ¶åº¦ï¼Œæ¯”å¦‚ç”³è¯·æŸä¸ªä¸€èˆ¬çš„æƒé™éœ€è¦æ€»ç›‘æ¥å®¡æ‰¹ï¼Œåœ¨æŸä¸ªæ—¶é—´ç‚¹ä¸Šçº¿éœ€è¦æ€»ç›‘å®¡æ‰¹ç¡®è®¤ï¼Œâ€¦â€¦è¿™äº›åˆ¶åº¦çœŸçš„èƒ½è§£å†³é—®é¢˜å—ï¼Ÿæ— éæ˜¯ç”¨è¿™äº›é—¨æ§›æ¥é™åˆ¶æŸäº›äº‹æƒ…çš„å‘ç”Ÿè€Œå·²ã€‚ä½†æ˜¯ï¼Œå½“ç´§æ€¥äº‹æƒ…çœŸçš„å‡ºç°çš„æ—¶å€™ï¼Œè¿™äº›åˆ¶åº¦åè€Œæˆä¸ºäº†é˜»ç¢æ•ˆç‡æœ€å¤§çš„é—®é¢˜ã€‚è¿™äº›å¾€å¾€è¢«ç§°ä½œä¸ºâ€œå¤§å…¬å¸â€é€šç—…ã€‚æ ¹æœ¬åŸå› å°±æ˜¯éšç€å…¬å¸çš„å‘å±•ï¼Œå·¥ä½œçš„æ ¸å¿ƒåŠ¨åŠ›ä¸å†æ˜¯åˆå¿ƒï¼Œä¸å†æ˜¯æ€è€ƒâ€œè¿™æ˜¯å¦å¯¹å…¬å¸æ˜¯æœ‰åˆ©çš„â€ï¼Œè€Œæ˜¯å¤æ‚çš„åˆ¶åº¦å’Œæµç¨‹ã€‚</p>
<p>åœ¨ã€Šä¸æ‹˜ä¸€æ ¼ã€‹ä¸­ä¹Ÿæåˆ°ï¼š</p>
<blockquote>
<p>éšç€ä¸€ä¸ªå¿«é€Ÿçµæ´»çš„åˆåˆ›ä¼ä¸šå‘å±•ä¸ºæˆç†Ÿçš„ä¼ä¸šï¼Œå…¬å¸å¾€å¾€ä¼šå»ºç«‹ä¸€å¥—å®Œæ•´çš„ä½“ç³»å¯¹å‘˜å·¥çš„æ”¯å‡ºè¿›è¡Œç›‘ç®¡ã€‚</p>
<p>è¿™è®©ç®¡ç†æœ‰äº†ä¸€ç§æ§åˆ¶æ„Ÿï¼Œä½†å¾€å¾€ä¹Ÿä¼šæ‹–æ…¢å…¬å¸ä¸šåŠ¡çš„è¿›ç¨‹ã€‚</p>
<p>è€Œç½‘é£çš„<strong>äº‹æƒ…æƒ…æ™¯è®¾å®šï¼Œæ—¶å€™æ ¸å®æŠ¥é”€</strong>åˆ¶åº¦åœ¨ä¿è¯å‘˜å·¥ä¸ä¼šè™šå‡æŠ¥é”€çš„æƒ…å†µä¸‹ï¼Œç»™äºˆå‘˜å·¥æå¤§çš„è‡ªç”±ï¼Œæ¥ä½¿çš„ä»–ä»¬å¯ä»¥å†å…³é”®æ—¶åˆ»ä½œå‡ºæœ‰åˆ©äºå…¬å¸çš„å†³æ–­ã€‚</p>
</blockquote>
<p>å®é™…ä¸Šï¼Œ<strong>äº‹å‰æƒ…æ™¯è®¾å®šï¼Œäº‹åæ ¸å®æŠ¥é”€</strong>æ­£æ˜¯ä¸€ç§Trust, but verifyåˆ¶åº¦ã€‚</p>
<p>æˆ‘ä»¬è¦ç›¸ä¿¡å‘˜å·¥èƒ½ç§‰æ‰¿å…¬å¸åˆ©ç›Šè‡³ä¸Šçš„åŸåˆ™ï¼Œä½†æ˜¯æˆ‘ä»¬ä¹Ÿéœ€è¦å¯¹å…¶è¡Œä¸ºè¿›è¡Œæ ¸æŸ¥ã€‚å•çº¯çš„ç›¸ä¿¡æ˜¯ä¸è¡Œçš„ã€‚</p>
<p>åœ¨ã€Šä¸æ‹˜ä¸€æ ¼ã€‹ä¸­æåˆ°ï¼š</p>
<blockquote>
<p>æ®ä¸€é¡¹ç ”ç©¶æ˜¾ç¤ºï¼šè¢«è°ƒæŸ¥è€…ä¸€æ—¦ç¡®è®¤è‡ªå·±çš„è¡Œä¸ºä¸ä¼šä¸ºäººæ‰€çŸ¥ï¼Œè¿œè¶…åŠæ•°çš„äººä¼šåˆ©ç”¨æ¼æ´ï¼Œä¸ºè‡ªå·±è°‹å–æ›´å¤šåˆ©ç›Šã€‚</p>
</blockquote>
<p>æ‰€ä»¥ï¼Œä½œä¸ºé¡¹ç›®çš„è´Ÿè´£äººæˆ–è€…ç®¡ç†è€…ï¼Œéœ€è¦åšå¥½æ ¸æŸ¥çš„å·¥ä½œï¼š</p>
<ul>
<li>ç¡®ä¿å‘˜å·¥å½¢æˆå…¬å¸åˆ©ç›Šè‡³ä¸Šçš„ç†å¿µ</li>
<li>ç¡®ä¿å‘˜å·¥æ˜¯åœ¨æŒ‰ç…§é¢„æœŸå®Œæˆå·¥ä½œ</li>
<li>ç¡®ä¿åŠæ—¶å‘ç°é—®é¢˜ï¼Œå¹¶ç»™äºˆåŠæ—¶çš„é¼“åŠ±ã€æŒ‡å¯¼ã€èµ„æºæ”¯æŒ</li>
<li>ç¡®ä¿å½¢æˆå³é‡è§†ç»“æœï¼Œä¹Ÿé‡è§†è¿‡ç¨‹çš„æ–‡åŒ–ï¼Œåªæœ‰è¿‡ç¨‹ï¼Œæ²¡æœ‰ç»“æœï¼Œæ˜¯ä¸è¡Œçš„ï¼Œåªæœ‰ç»“æœï¼Œæ²¡æœ‰è¿‡ç¨‹ï¼ŒåŒæ ·ä¹Ÿæ˜¯ä¸è¡Œçš„</li>
</ul>
<p><img src="/2021/01/11/Trust-but-Verify/4.jpg" alt></p>
]]></content>
      <categories>
        <category>æ–‡åŒ–</category>
      </categories>
      <tags>
        <tag>ä¸æ‹˜ä¸€æ ¼</tag>
        <tag>è‡ªç”±ä¸è´£ä»»</tag>
      </tags>
  </entry>
  <entry>
    <title>ä¸€åœºå…³äºFLVæ˜¯å¦è¦æ”¯æŒHEVCçš„äº‰è®º</title>
    <url>/2020/10/29/a-debate-about-supporting-HEVC-over-FLV/</url>
    <content><![CDATA[<blockquote>
<p>å‰å‡ å¤©ï¼Œåœ¨æµè§ˆFFmpegçš„Tracæ—¶ï¼Œå‘ç°äº†ä¸€ä¸ªå¸Œæœ›<a href="https://trac.ffmpeg.org/ticket/6389"><strong>FFmpegå¢åŠ <em>è®©FLVæ”¯æŒHEVCç¼–ç </em></strong></a>çš„éœ€æ±‚ã€‚</p>
<p>è¿™ä¸ªéœ€æ±‚æ˜¯2017å¹´æäº¤åˆ°FFmpegç¤¾åŒºçš„ï¼Œä»æ•´ä¸ªäº¤æµè¿‡ç¨‹å¯ä»¥çœ‹å‡ºï¼Œéœ€æ±‚æå‡ºè€…å’ŒFFmpegçš„ç¤¾åŒºç»´æŠ¤è€…å¯¹è¿™ä¸ªéœ€æ±‚çš„åˆ†æ­§è¾ƒå¤§ï¼Œä»ä¸­ä¹Ÿèƒ½çœ‹å‡ºä¸€äº›å·¥ä½œæ€è·¯å’Œå·¥ä½œæ–‡åŒ–ä¸Šçš„å·®å¼‚ã€‚çœ‹å®Œæ•´ä¸ªè®¨è®ºè¿‡ç¨‹ï¼Œæ„Ÿè§¦è¿˜æ˜¯æ¯”è¾ƒæ·±çš„ï¼Œæ‰€ä»¥æƒ³å†™ä¸€ç¯‡æ–‡ç« æ¥è®°å½•ä¸€ä¸‹è‡ªå·±çš„æ„Ÿè§¦ã€‚</p>
</blockquote>
<p><img src="/2020/10/29/a-debate-about-supporting-HEVC-over-FLV/1.png" alt></p>
<span id="more"></span>
<h2 id="æ•´ä¸ªéœ€æ±‚è®¨è®ºçš„å¤§æ¦‚è¿‡ç¨‹">æ•´ä¸ªéœ€æ±‚è®¨è®ºçš„å¤§æ¦‚è¿‡ç¨‹</h2>
<ul>
<li><strong>æè®®å‘èµ·</strong>ï¼šç›®å‰HLSå’ŒTSéƒ½å·²ç»æ”¯æŒH265äº†ï¼Œä½†æ˜¯å›½å†…å¤§éƒ¨åˆ†CDNæ›´å¤šé‡‡ç”¨çš„æ˜¯RTMP/HTTP-FLVæ ¼å¼ã€‚å¹¶ä¸”ï¼Œå› ä¸ºHLSçš„å»¶è¿Ÿæ¯”è¾ƒé«˜ï¼Œå› æ­¤å›½å†…å¤§éƒ¨åˆ†ç›´æ’­ä¸šåŠ¡é‡‡ç”¨çš„éƒ½æ˜¯RTMP/HTTP-FLVæ ¼å¼ã€‚æ‰€ä»¥ï¼Œè¯¥ISSUEçš„å‘èµ·è€…å°±æƒ³é—®ä¸€ä¸‹FFmpegç¤¾åŒºæ˜¯å¦æœ‰è®¡åˆ’è®©FLVæ”¯æŒHEVCã€‚</li>
<li><strong>FFmpegç¤¾åŒºå›å¤</strong>ï¼šä¸å¾—ä¸è¯´ï¼Œç¤¾åŒºçš„å›å¤è¿˜æ˜¯å¾ˆå¿«çš„ã€‚åœ¨éœ€æ±‚æå‡º20åˆ†é’Ÿåï¼Œæœ‰äººå›å¤äº†ã€‚å¤§æ¦‚æ„æ€å°±æ˜¯ï¼šå¹¶ä¸æ˜¯ä¸èƒ½è®©FLVæ”¯æŒHEVCï¼Œåªæ˜¯å› ä¸ºAdobeæ²¡æœ‰å¯¹FLVæ”¯æŒHEVCåšå‡ºå…·ä½“è¯´æ˜ã€‚å› æ­¤ï¼Œå¦‚æœAdobeä¸æ‰©å±•æ ‡å‡†ï¼ŒFFmpegæ˜¯ä¸ä¼šè®©FLVæ”¯æŒHEVCçš„ã€‚åŒæ—¶ï¼Œç¤¾åŒºè¿˜æå‡ºäº†ä¸€äº›å¤‡é€‰çš„è§£å†³æ–¹æ³•ã€‚</li>
<li><strong>é’ˆå¯¹å»¶è¿Ÿçš„äº‰è®º</strong>ï¼šæ¥ä¸‹æ¥å°±æ˜¯åŒæ–¹é’ˆå¯¹ç›´æ’­æµå»¶è¿Ÿçš„äº‰è®ºäº†ã€‚ä¸€æ–¹è®¤ä¸ºå¯ä»¥å¯¹HLSæˆ–MPEG-DASHåšä¸€äº›ä¼˜åŒ–æ¥é™ä½å»¶è¿Ÿï¼Œä¸€æ–¹è®¤ä¸ºHLSä¸å¯èƒ½è¾¾åˆ°1-3ç§’çš„å»¶è¿Ÿï¼ŒåŸºæœ¬ä¸Šæ¥ä¸‹æ¥çš„è®¨è®ºå°±æ˜¯åœ¨è®¨è®ºå»¶è¿Ÿäº†ã€‚å› ä¸ºRTMP/HTTP-FLVçš„ä½å»¶è¿Ÿå·²ç»å›½å†…CDNå‚å•†çš„å®Œç¾æ”¯æŒï¼Œå› æ­¤ï¼Œè¿˜æ˜¯å¸Œæœ›FFmpegèƒ½è®©FLVæ”¯æŒHEVCã€‚å¹¶ä¸”ï¼Œæœ‰å¥½å¤šè¯„è®ºä¹Ÿåœ¨æ”¯æŒè¿™ä¸ªéœ€æ±‚ã€‚ç¡®å®ï¼Œåœ¨2017å¹´ï¼Œå°¤å…¶æ˜¯åœ¨å›½å†…ï¼Œå¯¹äºç›´æ’­ä¸šåŠ¡è€Œè¨€ï¼Œèƒ½è®©FLVæ”¯æŒH265çœŸçš„æ˜¯ä¸€ä»¶éå¸¸å€¼å¾—æ¿€åŠ¨çš„äº‹ã€‚</li>
<li><strong>ç¤¾åŒºå¼ºçƒˆåå¯¹</strong>ï¼šåœ¨ä¼—å¤šæ”¯æŒè¯¥éœ€æ±‚çš„è¯„è®ºä¹‹åï¼ŒFFmpegç›´æ¥å…³é—­äº†è¿™ä¸ªæè®®ï¼Œå¹¶ä¸”å°†è¯¥æè®®ç½®ä¸ºäº†<code>invalid</code>çŠ¶æ€ã€‚
<ul>
<li>è¿™äº›æ˜¯é©¬ç”²è´¦å·çš„çŒæ°´è¯„è®ºï¼Œè¿™äº›è¯„è®ºå¯¹äºFFmpegæ˜¯å¦å®ç°è¯¥æè®®æ²¡æœ‰ä»»ä½•ä½œç”¨ã€‚</li>
<li>åªè¦Adobeä¸å‡çº§FLVçš„æ ‡å‡†ï¼ŒFFmpegå°±ä¸ä¼šè®©FLVæ”¯æŒHEVCã€‚</li>
<li>ä¸ç®¡æ€ä¹ˆæ ·ï¼ŒFFmpegéƒ½ä¸ä¼šæ”¯æŒè¿™ç§å®šåˆ¶çš„éœ€æ±‚ã€‚</li>
</ul>
</li>
</ul>
<p>å› æ­¤ï¼Œä¸€ç›´åˆ°ç°åœ¨ï¼Œ3å¹´è¿‡å»äº†ï¼ŒFFmpegä¹Ÿæ²¡æœ‰å®ç°åœ¨FLVä¸­æ”¯æŒHEVCçš„ç‰¹æ€§ã€‚å› æ­¤ï¼Œç›´åˆ°å¦‚ä»Šï¼Œåœ¨ç›´æ’­ä¸šåŠ¡ä¸­ï¼Œä¹Ÿéƒ½æ— æ³•ä½¿ç”¨ç¤¾åŒºç‰ˆæœ¬çš„FFmpegå®ç°ï¼šåœ¨FLVæ ¼å¼ä¸­ä¼ è¾“H265çš„ç›´æ’­æµã€‚</p>
<p>æ‰€å¹¸çš„<a href="https://github.com/ksvc/FFmpeg/tree/release/3.4"><strong>é‡‘å±±äº‘å®ç°äº†FFmpegçš„<em>hack</em>ç‰ˆæœ¬</strong></a>ï¼Œä»è€Œè®©RTMP/HTTP-FLVåè®®æ”¯æŒäº†HEVCç¼–ç ã€‚å› æ­¤ï¼Œå³ä½¿æ ‡å‡†çš„è§£ç å™¨ï¼ˆæ’­æ”¾å™¨ï¼‰æ— æ³•æ’­æ”¾é‡‘å±±äº‘çš„<em>hack</em>ç‰ˆæœ¬ç”Ÿæˆçš„RTMP/HTTP-FLVçš„H265ç›´æ’­æµï¼Œä½†æ˜¯ï¼Œé‡‘å±±äº‘å®ç°çš„è¿™ä¸ªç§æœ‰çš„åè®®ä¹ŸåŸºæœ¬ä¸Šæˆä¸ºäº†å›½å†…ç›´æ’­ç›¸å…³ä¸šåŠ¡çš„æ ‡å‡†åè®®äº†ã€‚</p>
<h2 id="åè®®-æ ‡å‡†å…ˆè¡Œ-è¿˜æ˜¯å®ç°å…ˆè¡Œï¼Ÿ">åè®®/æ ‡å‡†å…ˆè¡Œï¼Œè¿˜æ˜¯å®ç°å…ˆè¡Œï¼Ÿ</h2>
<blockquote>
<p>11:6 è€¶å’Œåè¯´ï¼Œçœ‹å“ªï¼Œä»–ä»¬æˆä¸ºä¸€æ ·çš„äººæ°‘ï¼Œéƒ½æ˜¯ä¸€æ ·çš„è¨€è¯­ï¼Œå¦‚ä»Šæ—¢ä½œèµ·è¿™äº‹æ¥ï¼Œä»¥åä»–ä»¬æ‰€è¦ä½œçš„äº‹å°±æ²¡æœ‰ä¸æˆå°±çš„äº†ã€‚</p>
<p>11:7 æˆ‘ä»¬ä¸‹å»ï¼Œåœ¨é‚£é‡Œå˜ä¹±ä»–ä»¬çš„å£éŸ³ï¼Œä½¿ä»–ä»¬çš„è¨€è¯­å½¼æ­¤ä¸é€šã€‚</p>
<p>11:8 äºæ˜¯ï¼Œè€¶å’Œåä½¿ä»–ä»¬ä»é‚£é‡Œåˆ†æ•£åœ¨å…¨åœ°ä¸Šã€‚ä»–ä»¬å°±åœå·¥ï¼Œä¸é€ é‚£åŸäº†ã€‚</p>
<p>11:9 å› ä¸ºè€¶å’Œååœ¨é‚£é‡Œå˜ä¹±å¤©ä¸‹äººçš„è¨€è¯­ï¼Œä½¿ä¼—äººåˆ†æ•£åœ¨å…¨åœ°ä¸Šï¼Œæ‰€ä»¥é‚£åŸåå«å·´åˆ«ï¼ˆå°±æ˜¯å˜ä¹±çš„æ„æ€ï¼‰ã€‚</p>
<div align="right">â€”â€”ã€Šåœ£ç»Â·åˆ›ä¸–çºªã€‹</div>
</blockquote>
<p>å¦‚ä»Šï¼Œç”Ÿäº§ç¤¾ä¼šåŒ–ç¨‹åº¦è¶Šæ¥è¶Šé«˜ï¼ŒæŠ€æœ¯è¦æ±‚è¶Šæ¥è¶Šå¤æ‚ï¼Œç”Ÿäº§åä½œè¶Šæ¥è¶Šå¹¿æ³›ã€‚è®¸å¤šæŠ€æœ¯å’Œäº§å“ï¼Œå¾€å¾€æ¶‰åŠå‡ åä¸ªã€å‡ ç™¾ä¸ªç”šè‡³ä¸Šä¸‡ä¸ªä¼ä¸šï¼Œè¿™å®¢è§‚ä¸Šè¦æ±‚ï¼šå¿…é¡»åœ¨æŠ€æœ¯ä¸Šä½¿ç”Ÿäº§æ´»åŠ¨ä¿æŒé«˜åº¦çš„ç»Ÿä¸€å’Œåè°ƒã€‚æ­¤æ—¶ï¼Œå¿…é¡»é€šè¿‡åˆ¶å®šå’Œæ‰§è¡ŒæŠ€æœ¯æ ‡å‡†ä½¿å„ç”Ÿäº§éƒ¨é—¨å’Œä¼ä¸šå†…éƒ¨å„ç”Ÿäº§ç¯èŠ‚æœ‰æœºåœ°è”ç³»èµ·æ¥ï¼Œä¿è¯ç”Ÿäº§æœ‰æ¡ä¸ç´Šåœ°è¿›è¡Œã€‚æ²¡æœ‰æ ‡å‡†ã€åè®®ï¼Œå°±æ— æ³•æœ‰æ•ˆçš„å®ç°ç¤¾ä¼šåŒ–å¤§ç”Ÿäº§ã€‚</p>
<p>çºµè§‚æ•´ä¸ªè®¡ç®—æœºè¡Œä¸šï¼Œæ— è®ºå“ªä¸ªé¢†åŸŸï¼Œæ— è®ºæ˜¯ç½‘ç»œé€šä¿¡è¿˜æ˜¯ç¼–è§£ç åè®®ï¼Œéƒ½æ˜¯åè®®å…ˆè¡Œã€‚ç§æœ‰åè®®çš„æ¨å¹¿ï¼Œä¹Ÿæ˜¯å…ˆä»æ ‡å‡†åŒ–å¼€å§‹ï¼Œç„¶åæ‰æ¨åŠ¨å…·ä½“å®ç°ã€‚å¦åˆ™ï¼Œè¡Œä¸šå†…å°±æ— æ³•è¾¾æˆå…±è¯†ï¼Œå¦åˆ™ï¼Œæ•´ä¸ªç½‘ç»œçš„äº’è”ã€äº’é€šä¹Ÿå°±æ— ä»è°ˆèµ·ã€‚å› æ­¤ï¼Œå¿…é¡»æ˜¯æ ‡å‡†ã€åè®®å…ˆè¡Œã€‚</p>
<p>å¦ä¸€ä¸ªæ–¹é¢ï¼Œæ ‡å‡†ã€åè®®æ˜¯å…·ä½“å®ç°çš„æŠ½è±¡ï¼Œæ²¡æœ‰æ¥å£çš„å®šä¹‰ï¼Œå“ªé‡Œæ¥çš„æ¥å£çš„å®ç°å‘¢ï¼Ÿå½“ç„¶ï¼Œä¹Ÿå¯ä»¥ä»å…·ä½“çš„å®ç°ä¸­æŠ½å–æ¥å£ï¼Œä½†æ˜¯æˆ‘ä»¬å¿…é¡»æ„è¯†åˆ°ï¼Œåœ¨æ¥å£æŠ½å–ä¹‹å‰ï¼Œè¿™ä¸ªå®ç°ç›¸å½“äºæ˜¯ç§æœ‰çš„ã€‚</p>
<p>å› æ­¤ï¼ŒFFmpegç¤¾åŒºæ‹’ç»è®©FLVè‡ªæŒHEVCæ˜¯åˆç†çš„ã€‚å¦åˆ™ï¼Œæˆ‘ä»¬çš„å·¥ä½œå°±ä¼šå……æ–¥ç€å„ç§FFmpegçš„<em>hack</em>ç‰ˆæœ¬ï¼Œå¹¶ä¸”æ¯ä¸ª<em>hack</em>ç‰ˆæœ¬éƒ½æ˜¯ç”¨æ¥è§£å†³ä¸åŒçš„é—®é¢˜ã€‚è¿™çœŸæ˜¯ä¸€ä»¶éå¸¸ææ€–çš„äº‹æƒ…ã€‚</p>
<p>å…µé©¬æœªåŠ¨ï¼Œç²®è‰å…ˆè¡Œã€‚å¦‚æœçœŸçš„æƒ³è®©äº‹æƒ…å˜çš„æ›´ä¾¿æ·ï¼Œæœ€å¥½çš„æ–¹å¼å°±æ˜¯ä¼˜å…ˆæ¨åŠ¨æ ‡å‡†æˆ–åè®®çš„å‡çº§ã€‚</p>
<p>æˆ‘è§åˆ°è¿‡å¾ˆå¤šæ¬¡è¾ƒä¸ºä¸¥é‡çš„çº¿ä¸Šé—®é¢˜ï¼Œå…¶æ ¹æœ¬åŸå› å°±æ˜¯ä¸Šä¸‹æ¸¸ä¹‹é—´æ²¡æœ‰ä¸€ä¸ªå®šä¹‰è‰¯å¥½çš„åè®®ï¼Œå¯¼è‡´å‡çº§è¿‡ç¨‹å‡ºç°äº†<a href="/monolith-to-microservices/docs/Breaking_Changes.html">ç ´åæ€§ä¿®æ”¹</a>ï¼Œè¿›è€Œå¯¼è‡´é—®é¢˜çš„å‘ç”Ÿã€‚</p>
<h2 id="ç»„ç»‡æ–‡åŒ–ä¼˜å…ˆè¿˜æ˜¯ç”¨æˆ·éœ€æ±‚ä¼˜å…ˆï¼Ÿ">ç»„ç»‡æ–‡åŒ–ä¼˜å…ˆè¿˜æ˜¯ç”¨æˆ·éœ€æ±‚ä¼˜å…ˆï¼Ÿ</h2>
<p>ä¸åŒçš„ç¤¾åŒºæœ‰ä¸åŒçš„æ–‡åŒ–ã€‚ç»„ç»‡çš„æ–‡åŒ–ä¼šä½¿å¾—å½“å‡ºç°é—®é¢˜çš„æ—¶å€™ï¼Œç»„ç»‡å†…æ‰€æœ‰æˆå‘˜å¯¹è¯¥é—®é¢˜çš„åº”æ¿€ååº”éƒ½æ˜¯ä¸€è‡´çš„ï¼Œè¿™ç§åº”æ¿€ååº”æ˜¯æ— éœ€è¯·æ±‚ä¸Šçº§å°±å¯ä»¥ä½œå‡ºçš„ã€‚ä»<a href="https://trac.ffmpeg.org/ticket/6389">æè®®</a>ä¸­å¯ä»¥çœ‹å‡ºï¼ŒFFmpegç¤¾åŒºçš„æ–‡åŒ–ä¹‹ä¸€æ˜¯ï¼šç¼–è§£ç å™¨è¦é’ˆå¯¹æ ‡å‡†å’Œè§„èŒƒæ¥å®æ–½ã€‚</p>
<p>å¦‚æœé˜…è¯»FFmpegçš„æºç ï¼Œå…¶å®ä¹Ÿèƒ½å‘ç°å¾ˆå¤šå¦‚ä¸‹çš„ä»£ç ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> &#123;</span></span><br><span class="line">    <span class="comment">// 7.4.3.1: vps_max_layers_minus1 is in [0, 62].</span></span><br><span class="line">    HEVC_MAX_LAYERS     = <span class="number">63</span>,</span><br><span class="line">    <span class="comment">// 7.4.3.1: vps_max_sub_layers_minus1 is in [0, 6].</span></span><br><span class="line">    HEVC_MAX_SUB_LAYERS = <span class="number">7</span>,</span><br><span class="line">    <span class="comment">// 7.4.3.1: vps_num_layer_sets_minus1 is in [0, 1023].</span></span><br><span class="line">    HEVC_MAX_LAYER_SETS = <span class="number">1024</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 7.4.2.1: vps_video_parameter_set_id is u(4).</span></span><br><span class="line">    HEVC_MAX_VPS_COUNT = <span class="number">16</span>,</span><br><span class="line">    <span class="comment">// 7.4.3.2.1: sps_seq_parameter_set_id is in [0, 15].</span></span><br><span class="line">    HEVC_MAX_SPS_COUNT = <span class="number">16</span>,</span><br><span class="line">    <span class="comment">// 7.4.3.3.1: pps_pic_parameter_set_id is in [0, 63].</span></span><br><span class="line">    HEVC_MAX_PPS_COUNT = <span class="number">64</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// A.4.2: MaxDpbSize is bounded above by 16.</span></span><br><span class="line">    HEVC_MAX_DPB_SIZE = <span class="number">16</span>,</span><br><span class="line">    <span class="comment">// 7.4.3.1: vps_max_dec_pic_buffering_minus1[i] is in [0, MaxDpbSize - 1].</span></span><br><span class="line">    HEVC_MAX_REFS     = HEVC_MAX_DPB_SIZE,</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>å› æ­¤ï¼Œç¤¾åŒºä¸åŒçš„äººå¯¹è¯¥æè®®çš„æ„è§éƒ½æ˜¯ä¸€è‡´çš„ã€‚å³ä¾¿è¿™ä¸ªç”¨æˆ·éœ€æ±‚å†åˆç†ï¼Œå³ä¾¿è¿™ä¸ªéœ€æ±‚æœ‰å¤šå°‘ç”¨æˆ·æ”¯æŒï¼Œåªè¦æ˜¯æ ‡å‡†ä¸æ›´æ–°ï¼ŒFFmpegæ°¸è¿œéƒ½ä¸ä¼šæ”¯æŒã€‚</p>
<p>å¦å¤–ï¼Œç”¨æˆ·åªæ˜¯éœ€è¦ä¸€ç§èƒ½å¤Ÿæ”¯æŒH265ç¼–ç çš„ã€CDNåˆæ”¯æŒè‰¯å¥½çš„ã€å»¶è¿Ÿåˆéå¸¸ä½çš„è§†é¢‘æµåª’ä½“æ ¼å¼è€Œå·²ï¼Œä¸æ˜¯å—ï¼Ÿå¦‚æœçœŸçš„æœ‰è¿™ç§æ ¼å¼ï¼Œè®©FLVæ”¯æŒHEVCæ˜¯å¦å°±ä¸æ˜¯ä¸€ä¸ªé—®é¢˜äº†å‘¢ï¼Ÿæ—¢ç„¶ï¼ŒAdobeå·²ç»åœæ­¢äº†å¯¹RTMPçš„ç»´æŠ¤äº†ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆè¿˜è¦èŠ±æ—¶é—´åœ¨è¿™ä¸ªåè®®ä¸Šå‘¢ï¼Ÿä¸ºä»€ä¹ˆä¸é€‰æ‹©æ›´æ–°çš„æŠ€æœ¯å‘¢ï¼Ÿè™½ç„¶é€‰æ‹©æ–°çš„æŠ€æœ¯æ„å‘³ç€éœ€è¦å†’æ›´å¤§çš„é£é™©å’ŒèŠ±è´¹æ›´å¤šçš„æˆæœ¬ã€‚</p>
<p>å°¤å…¶æ˜¯å½“ä¸åŒçš„ç”¨æˆ·éœ€æ±‚ä¹‹é—´å­˜åœ¨å†²çªï¼Œå¦‚ä½•å¤„ç†ï¼ŸTo be or not to be,thatâ€™s a question!</p>
<h2 id="å¯¹äºæŠ€æœ¯-æ˜¯å‘å‰çœ‹è¿˜æ˜¯å›å¤´çœ‹ï¼Ÿ">å¯¹äºæŠ€æœ¯ï¼Œæ˜¯å‘å‰çœ‹è¿˜æ˜¯å›å¤´çœ‹ï¼Ÿ</h2>
<p>â€œå§‹ç”Ÿä¹‹ç‰©ï¼Œå…¶å½¢å¿…ä¸‘â€ã€‚ä½†æ˜¯ï¼Œæ–°æŠ€æœ¯å¿…ç„¶ä¼šå–ä»£æ—§æŠ€æœ¯ï¼Œä»æ ¹æœ¬ä¸Šè¯´æ˜¯å› ä¸ºï¼š</p>
<ul>
<li>æ–°æŠ€æœ¯å…·æœ‰æ–°çš„ç»“æ„å’ŒåŠŸèƒ½ï¼Œèƒ½é€‚åº”å·²ç»å˜åŒ–äº†çš„ç¯å¢ƒå’Œæ¡ä»¶</li>
<li>æ–°æŠ€æœ¯æ˜¯å¯¹æ—§æŠ€æœ¯çš„æ‰¬å¼ƒï¼Œå¹¶æ·»åŠ äº†æ—§æŠ€æœ¯æ‰€ä¸èƒ½å®¹çº³çš„æ–°å†…å®¹</li>
</ul>
<p>å› æ­¤ï¼Œå¯¹äºæŠ€æœ¯è€Œè¨€ï¼Œæˆ‘ä»¬éœ€è¦å‘å‰çœ‹ï¼Œéœ€è¦å»äº†è§£è¿™äº›æ–°æŠ€æœ¯ã€‚å½“ç„¶ï¼Œé‡‡ç”¨æ–°æŠ€æœ¯è‚¯å®šæ˜¯è¦ä»˜å‡ºä¸€å®šä»£ä»·çš„ï¼Œæ²¡æœ‰ä¸ä»˜å‡ºå°±ä¼šæœ‰çš„æ”¶è·ã€‚éœ€è¦æ·±å…¥ç ”ç©¶æ–°æŠ€æœ¯å’Œæˆ‘ä»¬ä¸šåŠ¡ä¹‹é—´çš„å·®è·ï¼Œç„¶ååœ¨ä¸šåŠ¡çš„å®è·µä¸­ä¸æ–­å®Œå–„æ–°çš„æŠ€æœ¯ã€‚</p>
<p>å¦å¤–ï¼Œåœ¨äº†è§£æ–°æŠ€æœ¯æ—¶ï¼Œè¿˜è¦äº†è§£æ–°æŠ€æœ¯çš„å†å²ï¼Œäº†è§£åœ¨æ–°æŠ€æœ¯æ˜¯åŸºäºä»€ä¹ˆå†å²èƒŒæ™¯è€Œäº§å‡ºçš„ï¼Œæ˜¯ç”¨äºè§£å†³ä»€ä¹ˆé—®é¢˜çš„ï¼Ÿè¿™äº›ä¸œè¥¿ï¼Œæ˜¯æ–°æŠ€æœ¯çš„åº”ç”¨æ ¹æœ¬ï¼Œåªæœ‰æ·±å…¥äº†è§£äº†è¿™äº›ï¼Œæ‰èƒ½åœ¨åç»­çš„åº”ç”¨ä¸­ï¼Œå¾—å¿ƒåº”æ‰‹ã€‚é”™è¯¯çš„åº”ç”¨æ–°æŠ€æœ¯äº§ç”Ÿçš„é—®é¢˜æ¯”æ­£ç¡®çš„ä½¿ç”¨æ—§æŠ€æœ¯è¦å¤§çš„å¤šã€‚</p>
<p>ä¾‹å¦‚åœ¨HTTP2çš„åè®®ä¸­ï¼Œæœ‰è¿™æ ·çš„æè¿°ï¼š</p>
<blockquote>
<p>HTTP/2 addresses these issues by defining an optimized mapping of HTTPâ€™s semantics to an underlying connection. Specifically, it allows interleaving of request and response messages on the same connection and uses an efficient coding for HTTP header fields. It also allows prioritization of requests, letting more important requests complete more quickly, further improving performance.</p>
</blockquote>
<p>åœ¨HTTP3ä¸­ï¼Œæœ‰å¦‚ä¸‹çš„æè¿°ï¼š</p>
<blockquote>
<p>HTTP/2 introduced a binary framing and multiplexing layer to improve latency without modifying the transport layer. However, because the parallel nature of HTTP/2â€™s multiplexing is not visible to TCPâ€™s loss recovery mechanisms, a lost or reordered packet causes all active transactions to experience a stall regardless of whether that transaction was impacted by the lost packet.</p>
<p>The QUIC transport protocol incorporates stream multiplexing and per-stream flow control, similar to that provided by the HTTP/2 framing layer. By providing reliability at the stream level and congestion control across the entire connection, it has the capability to improve the performance of HTTP compared to a TCP mapping.</p>
</blockquote>
<p><img src="/2020/10/29/a-debate-about-supporting-HEVC-over-FLV/2.jpg" alt></p>
<p>å°±åƒä¸Šå›¾çš„â€œä¹Œé¸¦å–æ°´â€ä¸€æ ·ï¼Œæ˜¯é‡‡ç”¨å¸ç®¡å‘¢ï¼Ÿè¿˜æ˜¯å¯¹åŸæœ‰çš„çŸ³å¤´è¿›è¡Œå„ç§æ”¹è¿›å‘¢ï¼Ÿ</p>
<p>åæ¥ï¼Œåœ¨ç½‘ä¸Šæ‰¾åˆ°äº†åˆæ‹äº‘çš„ä¸€ç¯‡<a href="https://www.cnblogs.com/upyun/p/7053150.html">ã€Šå¦‚ä½•å°†HLSå»¶æ—¶ç¼©çŸ­è‡³4ç§’ï¼ŒHLS+æŠ€æœ¯è¯¦è§£ã€‹</a>çš„ä¸€ç¯‡æ–‡ç« ã€‚</p>
]]></content>
      <categories>
        <category>è§†é¢‘æŠ€æœ¯</category>
      </categories>
      <tags>
        <tag>ç›´æ’­</tag>
        <tag>hevc</tag>
        <tag>flv</tag>
      </tags>
  </entry>
  <entry>
    <title>é«˜å¹¶å‘ä¸‹çš„â€œè¯»åå†™â€æ¨¡å¼å­˜åœ¨çš„é—®é¢˜</title>
    <url>/2020/09/07/keep-the-architecture-from-write-after-read/</url>
    <content><![CDATA[<p>æˆ‘ä»¬çš„æœåŠ¡æœ‰ä¸€ä¸ªåŠŸèƒ½ï¼Œè¯¥åŠŸèƒ½ä¼šé™åˆ¶åŒæ—¶ä½¿ç”¨çš„ç”¨æˆ·æ•°ï¼Œä¾‹å¦‚ä½¿ç”¨è¯¥åŠŸèƒ½çš„ç”¨æˆ·ä¸èƒ½è¶…è¿‡100ä¸ªã€‚å°±å¥½åƒè´­ä¹°è½¦ç¥¨ä¸€æ ·ï¼Œå¯ä»¥è´­ä¹°åˆ°è½¦ç¥¨çš„äººæ•°ä¸èƒ½è¶…è¿‡è¯¥è½¦æ¬¡çš„å¯¹åº”åŒºé—´çš„è½¦ç¥¨æ€»æ•°ã€‚ç„¶åï¼Œåœ¨å¹¶å‘æµ‹è¯•ä¸­ï¼Œæˆ‘ä»¬å‘ç°ï¼Œå®é™…å¯ä»¥ä½¿ç”¨è¯¥åŠŸèƒ½çš„ç”¨æˆ·æ•°è¾¾åˆ°äº†200ã€‚è¿½æŸ¥ä¹‹åï¼Œæˆ‘ä»¬å‘ç°ï¼Œè¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„â€œè¯»åå†™â€œçš„æ¨¡å¼å¸¦æ¥å¹¶å‘é—®é¢˜ã€‚</p>
<p><img src="/2020/09/07/keep-the-architecture-from-write-after-read/1.png" alt></p>
<span id="more"></span>
<h2 id="ä»€ä¹ˆæ˜¯-è¯»åå†™-æ¨¡å¼">ä»€ä¹ˆæ˜¯â€œè¯»åå†™â€æ¨¡å¼</h2>
<p><code>è¯»åå†™</code>æ˜¯åœ¨å¹¶å‘åœºæ™¯ä¸‹ï¼Œé’ˆå¯¹åŒä¸€æ•°æ®è®°å½•çš„<strong>å…ˆè¯»åå†™</strong>æ“ä½œï¼Œå¹¶ä¸”æ•°æ®å†™å…¥çš„å€¼ä¾èµ–äºæ•°æ®è¯»å–çš„å€¼ã€‚å…·ä½“å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="/2020/09/07/keep-the-architecture-from-write-after-read/2.png" alt></p>
<p>ä»å®šä¹‰ä¸­å¯ä»¥çœ‹å‡ºï¼Œåªæœ‰åœ¨3ä¸ªæ¡ä»¶éƒ½å…·å¤‡çš„å‰æä¸‹ï¼Œæ‰ä¼šè€ƒè™‘<code>è¯»åå†™</code>æ¨¡å¼å¸¦æ¥çš„é—®é¢˜ï¼š</p>
<ul>
<li>å¹¶å‘åœºæ™¯</li>
<li>åŒä¸€æ•°æ®</li>
<li>å¯¹æ•°æ®çš„ä¿®æ”¹ä¾èµ–äºå¯¹æ•°æ®çš„è¯»å–</li>
</ul>
<h2 id="æ˜¾ç¤ºçš„-è¯»åå†™-æ¨¡å¼çš„é—®é¢˜">æ˜¾ç¤ºçš„â€œè¯»åå†™â€æ¨¡å¼çš„é—®é¢˜</h2>
<p>å¯¹äº<code>redis</code>è€Œè¨€ï¼Œå…¸å‹çš„<code>è¯»åå†™</code>é€»è¾‘å¦‚<strong><a href="http://test.sh">test.sh</a></strong>æ‰€ç¤ºï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">x=$(redis-cli -h 127.0.0.1 -p 8079 GET x)</span><br><span class="line">x=$(expr $&#123;x&#125; + 1)</span><br><span class="line">redis-cli -h 127.0.0.1 -p 8079 SET x $&#123;x&#125;</span><br></pre></td></tr></table></figure>
<p>è®¾ç½®<code>x=0</code>åœ¨éå¹¶å‘åœºæ™¯ä¸‹ï¼Œå¤šæ¬¡è¿è¡Œ<strong><a href="http://test.sh">test.sh</a></strong>åä¸ä¼šå­˜åœ¨é—®é¢˜ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"><span class="keyword">for</span> ((i=0; i&lt;100; i++)); <span class="keyword">do</span> sh test.sh; <span class="keyword">done</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> redis-cli -h 127.0.0.1 -p 8079 GET x</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="string">&quot;100&quot;</span></span></span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯ï¼Œå¯¹äºå¦‚ä¸‹çš„ä»£ç ï¼Œæˆ‘ä»¬åˆ™ä¼šå‘ç°ï¼Œå¯¹<code>KEY x</code>çš„æ›´æ–°å¹¶æ²¡æœ‰æŒ‰ç…§é¢„æœŸçš„é€»è¾‘æ¥æ›´æ–°ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> <span class="keyword">for</span> ((i=0; i&lt;100; i++)); <span class="keyword">do</span> sh test.sh &gt;/dev/null 2&gt;&amp;1 &amp;; <span class="keyword">done</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> redis-cli -h 127.0.0.1 -p 8079 GET x</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="string">&quot;3&quot;</span></span></span><br></pre></td></tr></table></figure>
<p>æˆ‘ç§°è¿™ç§åœºæ™¯ä¸‹å¯¼è‡´çš„é—®é¢˜ä¸ºï¼šæ˜¾ç¤ºçš„â€œè¯»åå†™â€æ¨¡å¼å¸¦æ¥çš„é—®é¢˜ã€‚å› ä¸ºæ­¤æ—¶ï¼Œå¹¶å‘æ˜¯æ˜¾è€Œæ˜“è§çš„ï¼Œå¹¶ä¸”æ“ä½œçš„æ˜¯å•ä¸€çš„rediså®ä¾‹ã€‚</p>
<h2 id="éšå¼çš„-è¯»åå†™-æ¨¡å¼çš„é—®é¢˜">éšå¼çš„â€œè¯»åå†™â€æ¨¡å¼çš„é—®é¢˜</h2>
<p>åœ¨å®é™…çš„æœåŠ¡ä¸­ï¼Œä¸ºäº†æå‡æœåŠ¡çš„æ€§èƒ½ï¼Œå¾€å¾€ä¼šé‡‡ç”¨<code>è¯»å†™åˆ†ç¦»</code>çš„æ¶æ„æ¥è®¾è®¡æ•°æ®å­˜å‚¨ï¼Œä¾‹å¦‚MySQLçš„ä¸»ä»æ¶æ„ï¼ŒRedisçš„ä¸»ä»æ¶æ„ã€‚åœ¨<code>è¯»å†™åˆ†ç¦»</code>æ¶æ„ä¸‹ï¼Œ<code>å†™æ“ä½œ</code>ä¸€èˆ¬å‡åœ¨<strong>ä¸»</strong>æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼Œè€Œ<code>è¯»æ“ä½œ</code>åˆ™åœ¨<strong>ä»</strong>æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼Œè€Œä¸»ä»ä¹‹é—´åˆ™é€šè¿‡æŸç§æ–¹å¼æ¥é€šä¿¡ã€‚å…·ä½“å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="/2020/09/07/keep-the-architecture-from-write-after-read/3.png" alt></p>
<p>è¿™ç§åœºæ™¯ä¸‹ï¼Œæ¯”è¾ƒé‡è¦çš„é—®é¢˜å°±æ˜¯â€œä¸»ä»å»¶è¿Ÿâ€çš„é—®é¢˜ã€‚å½“â€œä¸»ä»å»¶è¿Ÿâ€çš„æ—¶é—´ï¼Œè¶…è¿‡äº†è¯·æ±‚é—´éš”çš„æ—¶é—´æ—¶ï¼Œè™½ç„¶çœ‹èµ·æ¥å¹¶æ²¡æœ‰ä»€ä¹ˆå¹¶å‘çš„åœºæ™¯ï¼Œä½†æ˜¯å®é™…ä¸Šä¹Ÿæ˜¯ä¸€ç§â€œéšå¼çš„å¹¶å‘â€ã€‚</p>
<p>ä¸¾ä¸ªæç«¯çš„ä¾‹å­â€”â€”ç°å®åœºæ™¯ä¸­å¯èƒ½ä¸ä¼šæœ‰è¿™ä¹ˆå¤§çš„ä¸»ä»å»¶è¿Ÿâ€”â€”ä¸»ä»å»¶è¿Ÿçš„æ—¶é—´ä¸º5sï¼Œè€Œå½“å‰æœåŠ¡çš„è´Ÿè½½ä¸º2sä¸€ä¸ªè¯·æ±‚ã€‚æ­¤æ—¶ï¼Œè™½ç„¶çœ‹èµ·æ¥æ²¡æœ‰ä»€ä¹ˆâ€œå¹¶å‘â€çš„åœºæ™¯ï¼Œä½†æ˜¯å®é™…ä¸Šï¼Œå½“ç¬¬2ä¸ªè¯·æ±‚åˆ°æ¥æ—¶ï¼Œç”±äºä¸»ä»å»¶è¿Ÿçš„å­˜åœ¨ï¼Œåˆ°æ—¶æ­¤æ—¶è¯¥è¯·æ±‚è·å–çš„æ•°æ®ä»ç„¶ä¸ºæ—§çš„æ•°æ®ï¼Œè¿›è€Œå¯¼è‡´æ›´æ–°é€»è¾‘çš„å¼‚å¸¸ã€‚</p>
<p>å› ä¸ºï¼Œè¿™ç§åœºæ™¯ä¸‹çš„å¹¶å‘å®é™…ä¸Šè¢«â€œä¸»ä»â€æ¶æ„éšè—äº†èµ·æ¥ï¼Œå› æ­¤ï¼Œæˆ‘ç§°è¿™ç§åœºæ™¯ä¸‹å¯¼è‡´çš„é—®é¢˜ä¸ºï¼šéšå¼çš„â€œè¯»åå†™â€æ¨¡å¼çš„é—®é¢˜ã€‚</p>
<p>å¾ˆå¤šæ—¶å€™ï¼Œè¿™ä¸¤ç§æ¨¡å¼ä¼šåŒæ—¶å‘ç”Ÿã€‚åœ¨æ–‡ç« å¼€å§‹ä»‹ç»çš„é—®é¢˜ï¼Œå°±æ˜¯è¿™ä¸¤ç§åœºæ™¯å…±åŒä½œç”¨è€Œäº§ç”Ÿçš„â€œè¯»åå†™â€çš„é—®é¢˜ã€‚</p>
<h2 id="å¦‚ä½•é¿å…-è¯»åå†™-å¸¦æ¥çš„é—®é¢˜">å¦‚ä½•é¿å…â€œè¯»åå†™â€å¸¦æ¥çš„é—®é¢˜</h2>
<p>è§£å†³è¯¥é—®é¢˜çš„å…·ä½“æ–¹æ³•éœ€è¦è§†å…·ä½“çš„åº”ç”¨åœºæ™¯ã€‚ä¸è¦æœŸå¾…é‚£ç§â€œæ”¾ä¹‹å››æµ·è€Œçš†å‡†â€çš„è§£å†³æ–¹æ¡ˆï¼Œè€Œè¦æ ¹æ®è‡ªå·±æ‰€é¢ä¸´çš„å…·ä½“åœºæ™¯æ¥é€‰æ‹©æœ€åˆé€‚çš„è§£å†³æ–¹æ¡ˆã€‚å°½ç®¡å¦‚æ­¤ï¼Œæˆ‘ä»¬åœ¨è§£å†³è¯¥é—®é¢˜æ—¶ï¼Œå¯ä»¥æœ‰ä¸€ä¸ªæ€»çš„æŒ‡å¯¼åŸåˆ™ï¼šå°†â€œè¯»åå†™â€æ¨¡å¼æ”¹ä¸ºâ€œäº‹åŠ¡å†™åå†™â€æ¨¡å¼ã€‚</p>
<p>â€œå†™æ“ä½œâ€éƒ½åœ¨â€œä¸»â€æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼Œå› æ­¤ï¼Œæ”¹ä¸ºâ€œå†™åå†™â€æ¨¡å¼é¦–å…ˆé¿å…äº†â€œä¸»ä»â€æ¶æ„çš„é—®é¢˜ã€‚ç„¶åï¼Œåœ¨â€œå†™åå†™â€çš„åŸºç¡€ä¸Šï¼Œå†ä½¿ç”¨â€œäº‹åŠ¡æ€§çš„å†™æ“ä½œâ€ï¼Œå°±å¯ä»¥åŸºæœ¬è§£å†³â€œè¯»åå†™â€çš„é—®é¢˜ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå°†<code>test.sh</code>ç¨ä½œä¿®æ”¹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">redis-cli -h 127.0.0.1 -p 8079 incr x</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> <span class="keyword">for</span> ((i=0; i&lt;100; i++)); <span class="keyword">do</span> sh test.sh &gt;/dev/null 2&gt;&amp;1 &amp;; <span class="keyword">done</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> redis-cli -h 127.0.0.1 -p 8079 GET x</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="string">&quot;100&quot;</span></span></span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>æ¶æ„</category>
      </categories>
      <tags>
        <tag>æ•°æ®ä¸€è‡´æ€§</tag>
        <tag>redisåŸå­æ“ä½œ</tag>
      </tags>
  </entry>
  <entry>
    <title>ä»å•ä½“æ¶æ„è¿ç§»åˆ°å¾®æœåŠ¡æ¶æ„</title>
    <url>/2020/08/19/monolith-to-microservices/</url>
    <content><![CDATA[<p><img src="/2020/08/19/monolith-to-microservices/cover.png" alt></p>
<span id="more"></span>
<p>æ°å¥½ä»Šå¹´åœ¨äº†è§£å¾®æœåŠ¡ç›¸å…³çš„æŠ€æœ¯ï¼Œåˆæ°å¥½åœ¨æµè§ˆnginxå®˜ç½‘çš„æ—¶å€™å‘ç°äº†è¿™æœ¬ä¹¦ï¼Œå½“æ—¶è¯»å®Œç¬¬ä¸€ç« çš„ç¬¬ä¸€èŠ‚å°±æ„Ÿè§‰è¿™æ˜¯ä¸€æœ¬æˆ‘ä¼šè®¤çœŸé˜…è¯»çš„æŠ€æœ¯ä¹¦ç±ã€‚</p>
<p>åæ¥ï¼Œéšç€é˜…è¯»çš„æ·±å…¥ï¼Œå‘ç°æˆ‘è‡ªå·±å·¥ä½œä¸­é‡åˆ°çš„å¾ˆå¤šçš„é—®é¢˜æ°å·§å°±æ˜¯ä¹¦é‡Œå†™çš„é‚£æ ·ï¼Œä¸å…¶å¯¹æ¯ä¸€ä¸ªç‚¹å•ç‹¬å†™æˆä¸€ç¯‡æ–‡ç« æˆ–åšå®¢ï¼Œè¿˜ä¸å¦‚å°±ä»¥æ‰¹æ³¨çš„å½¢å¼å‘ˆç°å‡ºæ¥ï¼Œè¿™æ ·ä¹Ÿèƒ½æ›´ç³»ç»Ÿã€‚</p>
<p>åŸºäºå¦‚ä¸Šçš„æƒ³æ³•ï¼Œåœ¨é˜…è¯»æœ¬ä¹¦çš„è¿‡ç¨‹ä¸­ï¼Œå¯¹æ•´ä¸ªä¹¦ç±å†…å®¹è¿›è¡Œäº†ä¸­æ–‡ç‰ˆçš„ç¿»è¯‘ï¼Œå¹¶åœ¨æ­£æ–‡ä¸­ä»¥æ‰¹æ³¨çš„å½¢å¼å†™å…¥çš„è‡ªå·±çš„æ€è€ƒï¼Œç»å†ã€‚</p>
<p>è¿™æœ¬ä¹¦æ˜¯æˆ‘è¯»è¿‡çš„ç›¸å¯¹ä¸Šä¹˜çš„ä¸€æœ¬ä¹¦ï¼Œåœ¨äºšé©¬é€Šä¸Šçš„è¯„ä»·éå¸¸å¥½ï¼Œä¸ä½†è®²äº†å¾®æœåŠ¡çš„è¿ç§»æŠ€æœ¯ï¼Œæ›´å¤šè®²äº†å¾ˆå¤šä½œè€…çš„æ€è€ƒå’Œå¾ˆå¤šä¸ºä»€ä¹ˆçš„é—®é¢˜ã€‚æ­£å¦‚ä¸€ä½è¯»è€…çš„è¯„è®ºï¼šè¿™æœ¬ä¹¦æ²¡æœ‰å®£ä¼ ä»€ä¹ˆæŠ€æœ¯ï¼Œæ²¡æœ‰å…œå”®ä»€ä¹ˆæŠ€æœ¯ï¼Œè€Œæ›´å¤šçš„æ˜¯è®©æˆ‘ä»¬å­¦ä¼šå¦‚ä½•æ€è€ƒï¼Ÿæˆ‘ä»¬æ˜¯å¦çœŸçš„éœ€è¦ä½¿ç”¨å¾®æœåŠ¡ï¼Ÿä½¿ç”¨è¿‡ç¨‹è¦æ³¨æ„ä»€ä¹ˆï¼Ÿâ€¦â€¦</p>
<p>ç¿»è¯‘çš„ç‰ˆæœ¬å¯ä»¥ç‚¹å‡»ï¼š<a href="/monolith-to-microservices"><strong>monolith to microservicesä¸­æ–‡ç‰ˆ</strong></a>ï¼Œæ­¤ç‰ˆæœ¬ä»…ä¾›å­¦ä¹ äº¤æµä½¿ç”¨ã€‚å¦‚æœ‰ç–‘é—®ï¼Œè¯„è®ºåŒºç•™è¨€äº¤æµã€‚</p>
<p>å› ä¸ºå®˜æ–¹ç‰ˆçš„ç¿»è¯‘ç‰ˆæœ¬è‡³ä»Šè¿˜æ²¡æœ‰ï¼Œå› æ­¤ï¼Œæ¨èå¤§å®¶è´­ä¹°è‹±æ–‡åŸç‰ˆï¼Œ<a href="https://www.amazon.com/Monolith-Microservices-Evolutionary-Patterns-Transform/dp/1492047848"><strong>è´­ä¹°é“¾æ¥</strong></a>ã€‚</p>
]]></content>
      <categories>
        <category>æ¶æ„</category>
      </categories>
      <tags>
        <tag>èä¹¦</tag>
        <tag>å¾®æœåŠ¡</tag>
        <tag>å•ä½“</tag>
      </tags>
  </entry>
  <entry>
    <title>kill -9å¯¼è‡´subprocess.runå¯åŠ¨çš„å­è¿›ç¨‹æ— æ³•é€€å‡º</title>
    <url>/2020/08/07/cannot-terminate-the-subprocess-run-child-process-caused-by-kill-9/</url>
    <content><![CDATA[<h2 id="èƒŒæ™¯">èƒŒæ™¯</h2>
<p>æˆ‘ä»¬æœ‰ä¸€ä¸ªä»»åŠ¡æ‰˜ç®¡å¹³å°ï¼Œè¯¥å¹³å°å¯ä»¥æ‰˜ç®¡<code>python</code>è¯­è¨€ç¼–å†™ä»»åŠ¡ï¼Œå¹¶ä¸”å¯ä»¥å¯¹ä»»åŠ¡çŠ¶æ€è¿›è¡Œç®¡ç†ã€‚ç”±äºä¸šåŠ¡çš„éœ€è¦ï¼Œæˆ‘ä»¬éœ€è¦åœ¨<code>python</code>çš„ä»»åŠ¡ä¸­è°ƒèµ·ä¸€ä¸ª<code>shell</code>è„šæœ¬æ¥å®Œæˆä¸€äº›é¢å¤–çš„äº‹æƒ…ã€‚å½“æˆ‘ä»¬æŠŠç¼–å†™å¥½çš„ä»»åŠ¡éƒ¨ç½²åˆ°ä»»åŠ¡æ‰˜ç®¡å¹³å°ä¹‹åï¼Œæˆ‘ä»¬å‘ç°ä¸€ä¸ªå¥‡æ€ªçš„ç°è±¡ï¼šå½“åœ¨ä»»åŠ¡çš„è¶…æ—¶æ—¶é—´å†…æ‰‹åŠ¨ç»“æŸä»»åŠ¡çš„æ—¶å€™ï¼Œåªæœ‰<code>python</code>çš„çˆ¶è¿›ç¨‹é€€å‡ºäº†ï¼Œè€Œ<code>python</code>å¯åŠ¨çš„<code>shell</code>å­è¿›ç¨‹å´æ²¡æœ‰é€€å‡ºã€‚</p>
<span id="more"></span>
<h2 id="subprocessæ¨¡å—">subprocessæ¨¡å—</h2>
<p>æˆ‘ä»¬ä½¿ç”¨subprocess.run()æ¥åˆ›å»ºæ–°çš„shellè¿›ç¨‹ï¼Œå…·ä½“å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">subprocess.run(</span><br><span class="line">    cmd,</span><br><span class="line">    cwd=cwd,</span><br><span class="line">    shell=<span class="literal">True</span>,</span><br><span class="line">    stdout=subprocess.PIPE,</span><br><span class="line">    stderr=subprocess.PIPE,</span><br><span class="line">    encoding=<span class="string">&quot;utf-8&quot;</span>,</span><br><span class="line">    timeout=<span class="number">600</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>ä¸ºäº†æ–¹ä¾¿æµ‹è¯•ï¼Œåˆ†åˆ«å†™äº†ä¸€æ®µ<a href="https://gitee.com/wangwei1237/wangwei1237/blob/master/2020/08/07/cannot-terminate-the-subprocess-run-child-process-caused-by-kill-9/timeout.py"><code>python</code>ä»£ç </a>å’Œ<a href="https://gitee.com/wangwei1237/wangwei1237/blob/master/2020/08/07/cannot-terminate-the-subprocess-run-child-process-caused-by-kill-9/timeout.sh"><code>shell</code>ä»£ç </a>ï¼Œå¯ä»¥ç‚¹å‡»é“¾æ¥æŸ¥çœ‹å…·ä½“ä»£ç ã€‚å…¶ä¸­ï¼Œ<code>shell</code>è„šæœ¬ä¸ºä¸€ä¸ªæ­»å¾ªç¯ï¼Œå…·ä½“å¦‚ä¸‹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">for((i=0;;i++))</span><br><span class="line">do</span><br><span class="line">    echo &quot;$i&quot; &gt;log 2&gt;&amp;1</span><br><span class="line">done</span><br></pre></td></tr></table></figure>
<p>ç„¶åï¼Œæˆ‘ä»¬åœ¨æœ¬åœ°ä½¿ç”¨<code>kill -2ï¼ˆctrl+cï¼‰</code>ç»“æŸçˆ¶è¿›ç¨‹çš„æ—¶å€™ï¼Œå­è¿›ç¨‹ä¹Ÿç¡®å®ç»“æŸäº†ã€‚å…·ä½“å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="/2020/08/07/cannot-terminate-the-subprocess-run-child-process-caused-by-kill-9/sigint.png" alt></p>
<p>æˆ‘ä»¬ç»§ç»­æŸ¥å‡ºé—®é¢˜çš„åŸå› ï¼Œæˆ‘ä»¬å’¨è¯¢äº†ä»»åŠ¡æ‰˜ç®¡å¹³å°çš„è´Ÿè´£äººï¼šä»»åŠ¡æ‰˜ç®¡å¹³å°é¡µé¢ä¸Šçš„<code>ç»“æŸä»»åŠ¡</code>æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ</p>
<p>å¹³å°çš„è´Ÿè´£äººå›åº”è¯´ï¼š<code>kill -9</code>å‘½ä»¤ç»“æŸçš„ã€‚</p>
<p>åœ¨è¿™æ—¶å€™ï¼Œæˆ‘çŸ¥é“ï¼Œæˆ‘å¯èƒ½å¤§æ¦‚çŸ¥é“é—®é¢˜çš„åŸå› äº†ã€‚</p>
<h2 id="killå’Œsignal">killå’Œsignal</h2>
<p>å…³äº<code>kill</code>å‘½ä»¤ï¼Œæ­¤å¤„ä¸åšè¯¦ç»†ä»‹ç»ï¼Œå…·ä½“å¯ä»¥å‚è€ƒ<a href="https://man7.org/linux/man-pages/man1/kill.1.html">kill(1)æ‰‹å†Œ</a>ã€‚<code>kill</code>çš„ä½œç”¨æ˜¯å‘æŸä¸ªç‰¹æ®Šçš„è¿›ç¨‹æˆ–è¿›ç¨‹ç»„å‘é€ä¸€ä¸ªç‰¹æ®Šçš„ä¿¡å·ï¼Œä»è€Œè¾¾åˆ°ç»“æŸè¿›ç¨‹çš„ç›®çš„ã€‚å…³äº<code>ä¿¡å·(signal)</code>ï¼Œæ­¤å¤„ä¹Ÿä¸åšè¯¦ç»†ä»‹ç»ï¼Œå…·ä½“å¯ä»¥å‚è€ƒ<a href="https://man7.org/linux/man-pages/man7/signal.7.html">signal(7)æ‰‹å†Œ</a>ã€‚</p>
<p>è€Œ<code>kill -9</code>å‘½ä»¤å®é™…ä¸Šæ˜¯å‘è¿›ç¨‹å‘é€äº†<code>SIGKILL</code>ä¿¡å·ï¼Œè€Œåœ¨<a href="https://man7.org/linux/man-pages/man7/signal.7.html">signal(7)æ‰‹å†Œ</a>ä¸­å¯ä»¥çœ‹åˆ°ï¼š<strong>The signals SIGKILL and SIGSTOP cannot be caught, blocked, or ignored.</strong> å› æ­¤ï¼Œ<code>kill -9</code>æ˜¯ä¸€ç§ä¸å¯æ•è·çš„ã€ä¸å¯å¿½ç•¥çš„ä¿¡å·ï¼Œç”¨æ¥åœ¨ç‰¹æ®Šæƒ…å†µä¸‹ç´§æ€¥ç»“æŸè¿›ç¨‹ï¼ˆå¦‚æœè¯¥ä¿¡å·å¯ä»¥æ•è·å’Œå¿½ç•¥çš„è¯ï¼Œå°±è¾¾ä¸åˆ°è¿™ä¸ªç›®çš„äº†ï¼‰ã€‚</p>
<p>è€Œå¯¹äºä¸€ä¸ªå•è¿›ç¨‹çš„ç¨‹åºè€Œè¨€ï¼Œç›´æ¥<code>kill -9</code>ç»“æŸå¹¶æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯å¯¹äºä¸€ä¸ªå¤šè¿›ç¨‹çš„ç¨‹åºï¼Œä¾‹å¦‚æœ¬æ–‡ä¸­çš„ä¾‹å­ï¼Œåœ¨<code>python</code>è¿›ç¨‹ä¸­åˆåˆ›å»ºäº†<code>shell</code>å­è¿›ç¨‹ï¼Œé‚£ä¹ˆç›´æ¥ç”¨<code>kill -9</code>ç²—æš´çš„ç»“æŸçˆ¶è¿›ç¨‹æ˜¯éå¸¸ä¸å®‰å…¨çš„ï¼Œå…·ä½“å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="/2020/08/07/cannot-terminate-the-subprocess-run-child-process-caused-by-kill-9/sig9.jpg" alt></p>
<p>å¯è§ï¼Œåœ¨<code>kill -9</code>ç»“æŸçˆ¶è¿›ç¨‹ä¹‹åï¼Œ<code>shell</code>ç¼–å†™çš„å­è¿›ç¨‹æˆä¸ºäº†<a href="https://www.geeksforgeeks.org/zombie-and-orphan-processes-in-c/">å­¤å„¿è¿›ç¨‹</a>ï¼Œå¹¶ç»§ç»­æ‰§è¡Œã€‚</p>
<p>è¿™ä¹Ÿå°±æ˜¯ï¼Œæˆ‘ä»¬åœ¨ä»»åŠ¡æ‰˜ç®¡å¹³å°ä¸Šç»“æŸä»»åŠ¡åï¼Œå­è¿›ç¨‹å¹¶æ²¡æœ‰é€€å‡ºçš„æ ¹æœ¬åŸå› ã€‚çˆ¶è¿›ç¨‹ç»“æŸçš„ä¿¡å·æ ¹æœ¬å°±æ²¡æœ‰æœºä¼šé€šçŸ¥åˆ°å­è¿›ç¨‹ï¼Œå­è¿›ç¨‹ä¹Ÿå°±ä¸å¯èƒ½ç»“æŸäº†ã€‚</p>
<p>é‚£ä¹ˆï¼Œæˆ‘ä»¬æ¢å¦å¤–ä¸€ä¸ªå¯ä»¥è¢«æ•è·å’Œå¿½ç•¥çš„ä¿¡å·ï¼Œä¾‹å¦‚<code>SIGTERM</code>æ˜¯å¦èƒ½ç»“æŸå­è¿›ç¨‹å‘¢ï¼Ÿ</p>
<p><img src="/2020/08/07/cannot-terminate-the-subprocess-run-child-process-caused-by-kill-9/sigterm.jpg" alt></p>
<p>ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œ<code>SIGTERM</code>ä¿¡å·ä¹Ÿæ²¡æœ‰ç»“æŸå­è¿›ç¨‹ã€‚</p>
<h2 id="subprocess-run-æ‰€æ•è·çš„å¼‚å¸¸">subprocess.run()æ‰€æ•è·çš„å¼‚å¸¸</h2>
<p>æˆ‘ä»¬ä»<a href="https://github.com/python/cpython/blob/3.8/Lib/subprocess.py">subprocessæ¨¡å—çš„æºç </a>ä¸­å¯ä»¥å‘ç°ï¼Œ<code>subprocess.run()</code>å®é™…ä¸Šåªæ•è·è‡ªå®šä¹‰çš„<code>TimeoutExpired</code>å¼‚å¸¸å’Œ<code>KeyboardInterrupt</code>å¼‚å¸¸ï¼Œè€Œåœ¨<code>python</code>ä¸­ï¼Œ<code>KeyboardInterrupt</code>å¼‚å¸¸å¯¹åº”çš„å°±æ˜¯<strong>ç”¨æˆ·ä¸­æ–­æ‰§è¡Œ</strong>ï¼Œä¸€èˆ¬å°±æ˜¯è¾“å…¥<code>ctl+c</code>æˆ–å‘é€<code>SIGINT</code>ä¿¡å·ã€‚å…·ä½“å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span> Popen(*popenargs, **kwargs) <span class="keyword">as</span> process:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        stdout, stderr = process.communicate(<span class="built_in">input</span>, timeout=timeout)</span><br><span class="line">    <span class="keyword">except</span> TimeoutExpired <span class="keyword">as</span> exc:</span><br><span class="line">        <span class="comment"># ...</span></span><br><span class="line">        <span class="keyword">raise</span></span><br><span class="line">    <span class="keyword">except</span>:  <span class="comment"># Including KeyboardInterrupt, communicate handled that.</span></span><br><span class="line">        process.kill()</span><br><span class="line">        <span class="comment"># We don&#x27;t call process.wait() as .__exit__ does that for us.</span></span><br><span class="line">        <span class="keyword">raise</span></span><br></pre></td></tr></table></figure>
<p>å¯è§ï¼Œå¯¹äº<code>SIGINT</code>ä¿¡å·è€Œè¨€ï¼Œ<code>subprocess.run()</code>å‡½æ•°ä¼šè°ƒç”¨<code>Popen.kill()</code>æ¥ç»“æŸå­è¿›ç¨‹ã€‚</p>
<p>å› æ­¤ï¼Œå¯¹äºå¤šè¿›ç¨‹è€Œè¨€ï¼Œå½“çˆ¶è¿›ç»“æŸä¹‹å‰ï¼Œéœ€è¦é€šè¿‡æŸç§æœºåˆ¶æ¥é€šçŸ¥å…¶å­è¿›ç¨‹ï¼Œè¿›è€Œè®©å­è¿›ç¨‹çŸ¥æ™“çˆ¶è¿›ç¨‹çš„é€€å‡ºä¿¡æ¯ï¼Œå¹¶ä½œå‡ºåˆç†çš„åç»­è¡Œä¸ºã€‚å¦åˆ™ï¼Œå°±ä¼šå‡ºç°æœ¬æ–‡ä¸­å‡ºç°çš„å­¤å„¿è¿›ç¨‹çš„ç°è±¡ã€‚</p>
<p>å› æ­¤ï¼Œå¯¹äºå…¶ä»–çš„ä¿¡å·ï¼Œ<code>subprocess</code>æ¨¡å—æœ¬èº«å°±æ— æ³•å¤„ç†äº†ã€‚</p>
<h2 id="æ•è·sigtermä¿¡å·">æ•è·SIGTERMä¿¡å·</h2>
<p>å¦‚æœè¦æ•è·<code>SIGTERM</code>ä¿¡å·ï¼Œä½¿å¾—<code>kill -15</code>ç»“æŸpythonä»»åŠ¡çš„æ—¶å€™ï¼ŒåŒæ—¶ä¹Ÿèƒ½ç»“æŸå­è¿›ç¨‹ï¼Œé‚£ä¹ˆå°±è¦è€ç‚¹å°èªæ˜äº†ï¼Œä¾‹å¦‚ï¼šåœ¨<code>python</code>ä¸­æ•è·å…¶ä»–ä¿¡å·ï¼Œå¹¶å°†å…¶è½¬æˆ<code>SIGINT</code>ä¿¡å·ï¼Œå…·ä½“å¯ä»¥å‚è§<a href="https://gitee.com/wangwei1237/wangwei1237/blob/master/2020/08/07/cannot-terminate-the-subprocess-run-child-process-caused-by-kill-9/timeout_1.py">timeout_1.py</a>ã€‚å…·ä½“æ‰§è¡Œæ•ˆæœå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="/2020/08/07/cannot-terminate-the-subprocess-run-child-process-caused-by-kill-9/popen.jpg" alt></p>
<p>æ­¤å¤„ï¼Œæˆ‘ç”¨äº†ä¸€ä¸ªå·æ‡’çš„æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯æŠŠ<code>SIGTERM</code>ä¿¡å·æ•è·ä¹‹åè½¬æˆ<code>SIGINT</code>ä¿¡å·ï¼Œå…·ä½“çš„ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">def sigintHandler(signum, frame):</span><br><span class="line">    raise KeyboardInterrupt</span><br><span class="line"></span><br><span class="line">    exit()</span><br><span class="line"></span><br><span class="line">def run_cmd(cmd, cwd):</span><br><span class="line">    signal.signal(signal.SIGTERM, sigintHandler)</span><br><span class="line">    # ...</span><br></pre></td></tr></table></figure>
<h2 id="ç»“è¯­">ç»“è¯­</h2>
<p>æŸ¥å®Œè¿™ä¸ªé—®é¢˜ï¼Œä¹Ÿç®—æ˜¯å¯¹è¿›ç¨‹ç›¸å…³çš„å†…å®¹æœ‰äº†æ›´æ·±å…¥çš„äº†è§£ã€‚å­¤å„¿è¿›ç¨‹ï¼Œåƒµå°¸è¿›ç¨‹ï¼Œä¸å¯å±è”½è¿›ç¨‹â€¦â€¦ï¼Œå¥½åƒç»è¿‡å¾ˆå¤šæ—¶é—´ä¹‹åï¼Œå¿½ç„¶éƒ½ä¸è®°å¾—è‡ªå·±æ›¾ç»ä¹Ÿé’»ç ”è¿‡è¿™äº›æ¦‚å¿µä¸€æ ·ã€‚æ„Ÿè°¢æˆ‘çš„åŒäº‹<em>ä¸€å“</em>(<a href="https://github.com/GerenLiu">@GerenLiu</a>)ï¼Œåœ¨å·¥ä½œä¹‹ä½™æŠ½æ—¶é—´æ¥ä¸€èµ·è®¨è®ºè¿™ä¸ªé—®é¢˜ã€‚</p>
]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>subprocess</tag>
        <tag>killå‘½ä»¤</tag>
        <tag>å¤šçº¿ç¨‹</tag>
      </tags>
  </entry>
  <entry>
    <title>è‡ªåŠ¨åŒ–æµ‹è¯•é¦–å…ˆæ˜¯ä¸€ç§å·¥ä½œæ–‡åŒ–</title>
    <url>/2020/07/08/autotest-is-a-working-culture-first/</url>
    <content><![CDATA[<blockquote>
<p>è‡ªå¤ä»¥æ¥ï¼Œäººç±»å°±æœ‰åˆ›é€ è‡ªåŠ¨è£…ç½®ä»¥å‡è½»æˆ–ä»£æ›¿äººåŠ³åŠ¨çš„æƒ³æ³•ã€‚è‡ªåŠ¨åŒ–æŠ€æœ¯çš„äº§ç”Ÿå’Œå‘å±•ç»å†äº†æ¼«é•¿çš„å†å²è¿‡ç¨‹ã€‚å¤ä»£ä¸­å›½çš„é“œå£¶æ»´æ¼ï¼ˆç®€ç§°æ¼å£¶ï¼‰ã€æŒ‡å—è½¦ä»¥åŠ17ä¸–çºªæ¬§æ´²å‡ºç°çš„é’Ÿè¡¨å’Œé£ç£¨æ§åˆ¶è£…ç½®ï¼Œè™½ç„¶éƒ½æ˜¯æ¯«æ— è”ç³»çš„å‘æ˜ï¼Œä½†å¯¹è‡ªåŠ¨åŒ–æŠ€æœ¯çš„å½¢æˆå´èµ·åˆ°äº†å…ˆå¯¼ä½œç”¨ã€‚</p>
</blockquote>
<h2 id="è‡ªåŠ¨åŒ–æµ‹è¯•ä¹‹ç—›">è‡ªåŠ¨åŒ–æµ‹è¯•ä¹‹ç—›</h2>
<p>æœ€è¿‘åœ¨å¸®åŠ©ä¸€ä¸ªå›¢é˜Ÿæ¢³ç†å›¢é˜Ÿæµ‹è¯•æ•ˆç‡çš„é—®é¢˜ï¼Œå…¶ç›®æ ‡æ˜¯æå‡è¯¥å›¢é˜Ÿçš„æµ‹è¯•æ•ˆç‡ã€‚åœ¨æ•´ä¸ªæ¢³ç†çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘å‘ç°ä¸€ä»¶éå¸¸æœ‰æ„æ€çš„äº‹æƒ…ï¼šè¿™ä¸ªå›¢é˜ŸåŸºæœ¬ä¸Šæ²¡æœ‰è‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œå¤§éƒ¨åˆ†çš„æµ‹è¯•æ‰‹æ®µè¿˜æ˜¯æ‰‹å·¥æµ‹è¯•åŠ CRã€‚æ›´ä¸ºæœ‰æ„æ€çš„äº‹æƒ…æ˜¯ï¼šå›¢é˜Ÿæˆå‘˜å¤§éƒ½å¯¹è‡ªåŠ¨åŒ–æµ‹è¯•æ¯”è¾ƒæŠµè§¦ï¼Œè®¤ä¸ºè‡ªåŠ¨åŒ–æµ‹è¯•çš„æˆæœ¬è¾ƒå¤§ï¼Œä¸”çœ‹ä¸åˆ°æ”¶ç›Šã€‚</p>
<p>å›æƒ³è¿‡å»å‡ å¹´çš„æµ‹è¯•å·¥ä½œï¼Œæˆ‘å‘ç°ï¼Œå‡ ä¹æ‰€æœ‰çš„æµ‹è¯•å›¢é˜Ÿåœ¨é¢å¯¹è‡ªåŠ¨åŒ–æµ‹è¯•æ—¶éƒ½ä¼šå­˜åœ¨ç±»ä¼¼çš„é—®é¢˜ï¼š<strong>å¸Œæœ›è‡ªåŠ¨åŒ–æµ‹è¯•æå‡æ•ˆç‡ï¼Œä½†æ˜¯æ‰§è¡Œæ—¶å´å‘ç°è‡ªåŠ¨åŒ–æµ‹è¯•åè€Œæ²¡æœ‰æå‡æ•ˆç‡ï¼Œå› æ­¤æ…¢æ…¢åºŸå¼ƒè‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œç›´è‡³æŠµè§¦è‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œåˆ°æœ€åè‡ªåŠ¨åŒ–æµ‹è¯•å˜æˆä¸€ç§â€œå½¢è€Œä¸Šâ€èˆ¬çš„å­˜åœ¨</strong>ã€‚æˆ‘å§‘ä¸”ç§°è¿™ç§ç°è±¡ä¸ºâ€”â€”<strong>è‡ªåŠ¨åŒ–æµ‹è¯•ä¹‹ç—›</strong>ã€‚</p>
<span id="more"></span>
<p>è‡ªåŠ¨åŒ–æµ‹è¯•ä¹‹ç—›çš„é—®é¢˜æ ¹æºç©¶ç«Ÿæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿäº‹æƒ…çœŸçš„å¦‚æœ‰äº›å›¢é˜Ÿæ‰€è¯´ï¼šè‡ªåŠ¨åŒ–caseçš„æˆæœ¬å¤ªå¤§ï¼Œåˆæ²¡æœ‰æ”¶ç›Šå—ï¼Ÿ</p>
<h2 id="ä¾ å®¢å²›çš„æ•…äº‹">ä¾ å®¢å²›çš„æ•…äº‹</h2>
<blockquote>
<p>è‡ªä»ä¸‰åå¹´å‰å¼€å§‹ï¼Œæ¯è¿‡åå¹´ï¼Œå°±ä¼šæœ‰å¤§æ‰¹çš„æ­¦æ—é«˜æ‰‹è¢«è¯·å»ä¾ å®¢å²›å–è…Šå…«ç²¥ï¼Œä¸ä½†è¿™äº›æ­¦æ—é«˜æ‰‹ä»æ­¤éƒ½ä¸€å»ä¸å¤è¿”ï¼Œè€Œä¸”ä¾ å®¢å²›è¿˜æ¼”å˜æˆä¸ºäº†èµå–„ç½šæ¶çš„è¡ŒåŠ¨ã€‚</p>
<p>ä¸ºæ­¤ï¼Œæ±Ÿæ¹–ä¸­äººäººè‡ªå±ï¼Œæ¯åˆ°åå¹´ä¹‹æœŸï¼Œå„å¤§é—¨æ´¾çš„æŒé—¨å°±çº·çº·å¯»æ‰¾æ›¿èº«ï¼Œæ¥èº²é¿ä¾ å®¢å²›çš„èµå–„ç½šæ¶ã€‚ä½†æ˜¯ï¼Œå½“è¿™äº›æ­¦æ—é«˜æ‰‹åˆ°äº†ä¾ å®¢å²›ä¹‹åæ‰ç»ˆäºæ­å¼€äº†ä¾ å®¢å²›çš„ç§˜å¯†ã€‚</p>
<p>åŸæ¥å²›ä¸Šåˆ»æœ‰æ­¦æ—ç§˜ç±ï¼Œç”±äºå²›ä¸»äººå‚ä¸é€ç§˜ç±ï¼Œæ‰€ä»¥æ‰ä¼šè¯·æ­¦æ—é«˜æ‰‹åˆ°å²›ä¸Šå…±åŒå‚æ‚Ÿã€‚å¹¶ä¸”ç”±äºå²›ä¸Šçš„â€˜æ–­è‚ èš€éª¨è…å¿ƒè‰â€™åå¹´ä¸€å¼€èŠ±ï¼Œæ­¤è‰è‹¥å†é…ä»¥å…¶ä»–ä½ä½¿ä¹‹è¯ï¼Œç†¬æˆçƒ­ç²¥ï¼Œæœåäºç»ƒæ­¦ä¹‹å£«å¤§æœ‰è¡¥ç›Šï¼Œå› æ­¤æ‰æœ‰äº†æ¯åå¹´é‚€è¯·ä¸€æ¬¡çš„æƒ¯ä¾‹ã€‚è¢«é‚€ä¸Šå²›çš„äººä¹Ÿå¹¶ä¸æ˜¯é‡å®³ï¼Œè€Œæ˜¯ç—´è¿·äºæ­¦å­¦ï¼Œéƒ½ä¸æƒ³å›å»ç½¢äº†ã€‚</p>
<p><strong><div align="right">â€”â€”ã€Šä¾ å®¢è¡Œã€‹</div></strong></p>
</blockquote>
<p>æœ‰å¤šå°‘æ—¶å€™ï¼Œæˆ‘ä»¬å¯¹è‡ªåŠ¨åŒ–æµ‹è¯•çš„è®¤è¯†å’Œæ±Ÿæ¹–äººå£«å¯¹ä¾ å®¢å²›çš„è®¤è¯†æ˜¯ç±»ä¼¼çš„å‘¢ï¼Ÿ<br>
æœ‰å¤šå°‘æ—¶å€™ï¼Œæ˜æ˜æ˜¯ä¾ å®¢å²›ç››æƒ…æ‰€é‚€ï¼Œæ±Ÿæ¹–ä¹‹ä¸Šå´äººäººèº²è€Œé¿ä¹‹å‘¢ï¼Ÿ<br>
æœ‰å¤šå°‘æ—¶å€™ï¼Œæ˜æ˜æ˜¯å¯¹è‡ªå·±å¤§æœ‰è¡¥ç›Šçš„è…Šå…«ç²¥ï¼Œæ‰€æœ‰è¢«é‚€çš„æ­¦æ—äººå£«å´ä¸æ•¢å–ä¸‹å‘¢ï¼Ÿ</p>
<p>æˆ–è®¸ä½ ä¼šåé©³ï¼Œä½†å‡¡æœ‰ä¸Šå²›çš„æ­¦æ—äººå£«æ‰©æ•£ä¸€ä¸‹äº‹å®çœŸç›¸ï¼Œé‚£æ•´ä¸ªæ±Ÿæ¹–ä¹Ÿä¸è‡³äºå¦‚æ­¤ï¼Ÿ<br>
ä½†æ˜¯ï¼Œæ­£å¦‚æœ¬æ–‡å¼€ç¯‡æ‰€è¿°ï¼Œæ•´ä¸ªäººç±»ç¤¾ä¼šéƒ½æ˜¯è¯æ˜è‡ªåŠ¨åŒ–çš„å†å²ï¼Œä¸ºä»€ä¹ˆè¿˜æœ‰é‚£ä¹ˆå¤šçš„å›¢é˜Ÿåœ¨è´¨ç–‘è‡ªåŠ¨åŒ–æµ‹è¯•å‘¢ï¼Ÿ<br>
ä¸ºä»€ä¹ˆæœ‰é‚£ä¹ˆå¤šçš„æµ‹è¯•å®è·µå·²ç»è¯æ˜äº†è‡ªåŠ¨åŒ–æµ‹è¯•çš„æˆæ•ˆâ€”â€”ä¾‹å¦‚è°·æ­Œçš„<a href="https://mike-bland.com/2012/07/10/test-mercenaries.html"><strong>Test Mercenaries</strong></a>è®¡åˆ’ï¼Œè¿˜æ˜¯æœ‰é‚£ä¹ˆå¤šçš„å›¢é˜Ÿå¯¹è‡ªåŠ¨åŒ–æµ‹è¯•å¿ƒå­˜è´¨ç–‘å‘¢ï¼Ÿ</p>
<p>æ­£å¦‚Sam NewManåœ¨<a href="https://samnewman.io/books/monolith-to-microservices/"><strong>Monolith To Microservices</strong></a>ä¸€ä¹¦ä¸­è¯´çš„é‚£æ ·ï¼š<a href="https://wangwei1237.gitee.io/monolith-to-microservices/docs/The_Monolith.html#ref_denigrating_monolith">ä¸€æ—¦æˆ‘ä»¬é™·å…¥ç³»ç»Ÿæ€§æŠ¹é»‘å•ä½“çš„é™·é˜±ï¼Œæˆ‘ä»¬å°±ä¼šé¢ä¸´å¾ˆå¤§çš„éº»çƒ¦</a>ã€‚</p>
<h2 id="è‡ªåŠ¨åŒ–æµ‹è¯•çš„å®šä½">è‡ªåŠ¨åŒ–æµ‹è¯•çš„å®šä½</h2>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»3ä¸ªæ–¹é¢æ¥é˜è¿°è‡ªåŠ¨åŒ–æµ‹è¯•çš„å®šä½ã€‚</p>
<h3 id="æµ‹è¯•çš„4å¤§æ´»åŠ¨">æµ‹è¯•çš„4å¤§æ´»åŠ¨</h3>
<p>æ ¹æ®ä¹”æ¢è€å¸ˆçš„<a href="https://item.jd.com/12512514.html">ã€ŠæŒç»­é›†æˆ2.0ã€‹</a>ä¸€ä¹¦ä¸­æ‰€è¿°ï¼Œæµ‹è¯•é¢†åŸŸæœ‰4å¤§åŸºæœ¬æ´»åŠ¨ï¼Œå¦‚<a href="#f1">å›¾1</a>æ‰€ç¤ºã€‚</p>
<p><span id="f1"><img src="/2020/07/08/autotest-is-a-working-culture-first/f1.png" alt></span></p>
<p>å›¾1. æµ‹è¯•çš„4å¤§åŸºæœ¬æ´»åŠ¨</p>
<p>å…¶ä¸­ï¼Œå„æ´»åŠ¨çš„åŸºæœ¬å«ä¹‰å¦‚ä¸‹ï¼š</p>
<ul>
<li><strong>é—®é¢˜è®¤çŸ¥</strong>ï¼šå¯¹ä¸šåŠ¡é—®é¢˜æœ¬èº«çš„ç†è§£å’Œè®¤çŸ¥ï¼ŒåŒ…æ‹¬éœ€æ±‚ç†è§£ï¼ŒæŠ€æœ¯è®¾è®¡ç†è§£â€¦â€¦</li>
<li><strong>åˆ†æ</strong>ï¼šæµ‹è¯•åˆ†æå’Œæµ‹è¯•è®¾è®¡ï¼Œæ ¹æ®å¯¹é—®é¢˜çš„è®¤çŸ¥ï¼Œè®¾è®¡æµ‹è¯•æ–¹æ¡ˆå’Œç”¨ä¾‹ï¼Œä¿è¯ä¸šåŠ¡è´¨é‡</li>
<li><strong>æ‰§è¡Œ</strong>ï¼šæ‰§è¡Œåˆ†æé˜¶æ®µçš„æµ‹è¯•ç”¨ä¾‹ï¼Œäº§å‡ºæµ‹è¯•ç»“è®º</li>
<li><strong>å†³ç­–</strong>ï¼šæ ¹æ®æµ‹è¯•ç»“è®ºè¿›è¡Œç›¸å…³å†³ç­–ï¼ŒåŒ…æ‹¬æ˜¯å¦å­˜åœ¨é£é™©ï¼Œæ˜¯å¦è¾¾åˆ°ä¸Šçº¿æ ‡å‡†â€¦â€¦</li>
</ul>
<h3 id="æ•æ·æµ‹è¯•4è±¡é™">æ•æ·æµ‹è¯•4è±¡é™</h3>
<p>æ ¹æ®æµ‹è¯•æ‰€æ”¯æŒçš„å¯¹è±¡ï¼Œæµ‹è¯•å¯ä»¥åˆ†ä¸ºï¼š<a href="https://www.tutorialspoint.com/agile_testing/agile_testing_quadrants.htm">é¢å‘ä¸šåŠ¡çš„æµ‹è¯•å’Œé¢å‘ç ”å‘çš„æµ‹è¯•</a>ã€‚<a href="http://www.exampler.com/old-blog/2003/08/22/#agile-testing-project-2">Brian Marick</a>æ ¹æ®è¿™ä¸¤ç§æµ‹è¯•ç±»å‹æå‡ºäº†<strong>æ•æ·æµ‹è¯•4è±¡é™</strong>çš„æ¦‚å¿µï¼Œå¦‚<a href="#f2">å›¾2</a>æ‰€ç¤ºã€‚</p>
<p><span id="f2"><img src="/2020/07/08/autotest-is-a-working-culture-first/f2.png" alt></span></p>
<p>å›¾2. æ•æ·æµ‹è¯•4è±¡é™</p>
<p>åœ¨<a href="#f2">å›¾2</a>ä¸­ï¼š</p>
<ul>
<li><strong>åŠŸèƒ½éªŒæ”¶æµ‹è¯•</strong>ï¼šä»ç”¨æˆ·çš„è§’åº¦æ¥éªŒæ”¶åŠŸèƒ½</li>
<li><strong>ç¬¬ä¸‰è±¡é™çš„è‡ªåŠ¨åŒ–æµ‹è¯•</strong>ï¼šç ”å‘å›¢é˜Ÿå¯¹è‡ªæˆ‘è½¯ä»¶æŠ€æœ¯å®ç°çš„éªŒè¯</li>
</ul>
<h3 id="è‡ªåŠ¨åŒ–æµ‹è¯•çš„4è¦ç´ ">è‡ªåŠ¨åŒ–æµ‹è¯•çš„4è¦ç´ </h3>
<p>åœ¨æµ‹è¯•çš„4å¤§æ´»åŠ¨ä¸­ï¼Œâ€œæ‰§è¡Œâ€ç¯èŠ‚ä¼šå­˜åœ¨å¤§é‡çš„é‡å¤å·¥ä½œï¼Œè€Œå…¶ä¸­çš„å¤§éƒ¨åˆ†å·¥ä½œéƒ½å¯ä»¥ç”±æœºå™¨æ¥æ‰¿æ‹…ã€‚æ­¤æ—¶å°±å¯ä»¥å‘æŒ¥è‡ªåŠ¨åŒ–æµ‹è¯•çš„ä¼˜åŠ¿ï¼Œé‡Šæ”¾äººçš„é‡å¤åŠ³åŠ¨ã€‚</p>
<p>è€Œåœ¨Brian Marickçš„æ•æ·æµ‹è¯•4è±¡é™ä¸­ï¼Œç¬¬2ã€ç¬¬3è±¡é™çš„æµ‹è¯•ç±»å‹ä¹Ÿå¯ä»¥å‘æŒ¥è‡ªåŠ¨åŒ–æµ‹è¯•çš„ä¼˜åŠ¿ï¼Œæå‡æ•´ä¸ªæµ‹è¯•æ‰§è¡Œçš„æ•ˆç‡ã€‚</p>
<p>å¯¹äºè‡ªåŠ¨åŒ–æµ‹è¯•è€Œè¨€ï¼Œæˆ‘æ€»ç»“äº†è‡ªåŠ¨åŒ–æµ‹è¯•çš„4è¦ç´ ï¼šè‡ªåŠ¨éƒ¨ç½²ã€è‡ªåŠ¨æ‰§è¡Œã€è‡ªåŠ¨æ ¡éªŒã€è‡ªåŠ¨æŠ¥å‘Šï¼Œå¦‚<a href="#f3">å›¾3</a>æ‰€ç¤ºã€‚</p>
<p><span id="f3"><img src="/2020/07/08/autotest-is-a-working-culture-first/f3.gif" alt></span></p>
<p>å›¾3. è‡ªåŠ¨åŒ–æµ‹è¯•çš„4è¦ç´ </p>
<h2 id="è‡ªåŠ¨åŒ–æµ‹è¯•çš„è¯¯åŒº">è‡ªåŠ¨åŒ–æµ‹è¯•çš„è¯¯åŒº</h2>
<p>æ¥ä¸‹æ¥ï¼Œç€é‡æ¥è¯´ä¸€ä¸‹æˆ‘æ‰€è§åˆ°ã€å¬åˆ°çš„ä¸€äº›å…³äºè‡ªåŠ¨åŒ–æµ‹è¯•çš„è¯¯åŒºã€‚</p>
<h3 id="è¯¯åŒº1ï¼šåªçœ‹çŸ­æœŸæ•ˆç‡æ”¶ç›Š">è¯¯åŒº1ï¼šåªçœ‹çŸ­æœŸæ•ˆç‡æ”¶ç›Š</h3>
<p>æœ‰çš„å›¢é˜Ÿå¸Œæœ›è‡ªåŠ¨åŒ–caseæ¥æå‡æµ‹è¯•æ•ˆç‡ï¼Œå½“ç„¶ï¼Œè¿™æ˜¯è‡ªåŠ¨åŒ–caseå¯ä»¥è·å–çš„æ”¶ç›Šä¹‹ä¸€ã€‚è¿™äº›å›¢é˜Ÿè¿˜ä¼šé’ˆå¯¹è‡ªåŠ¨åŒ–å¯¹æ•ˆç‡çš„æå‡åˆ¶å®šå®šé‡çš„æŒ‡æ ‡ï¼Œç„¶åæ¯å‘¨ï¼Œæ¯æœˆï¼Œæ¯å­£åº¦ï¼ˆå½“ç„¶ï¼Œæœ‰äº›äººè¿˜æ²¡æœ‰åšæŒåˆ°å­£åº¦æœ«å°±ä¸åšäº†ï¼‰æ¥è·Ÿè¿›ã€‚</p>
<p>ä½†æ˜¯ï¼Œæ­£å¦‚Sam Newmanåœ¨<a href="https://wangwei1237.gitee.io/monolith-to-microservices/docs/How_Will_You_Know_if_the_Transition_Is_Working.html#%E5%AE%9A%E9%87%8F%E6%8C%87%E6%A0%87"><em>Monolith To Microservices</em></a>ä¸€ä¹¦ä¸­æ‰€è¯´ï¼š</p>
<blockquote>
<p>æœ‰çš„æŒ‡æ ‡å¯èƒ½å¾ˆéš¾åœ¨çŸ­æ—¶é—´å†…æœ‰é‡çš„å˜åŒ–ã€‚</p>
<p>å¦‚æœåœ¨å¾®æœåŠ¡è¿ç§»çš„å‰å‡ ä¸ªæœˆå°±çœ‹åˆ°cycle timeçš„å¤§å¹…æ”¹å–„ï¼Œæˆ‘ä¼šæ„Ÿåˆ°æƒŠè®¶ã€‚</p>
<p>å®é™…ä¸Šï¼Œæˆ‘æ›´å¸Œæœ›çœ‹åˆ°cycle timeä¼šåœ¨è¿ç§»çš„åˆæœŸå˜å¾—æ›´ç³Ÿã€‚</p>
<p>å› ä¸ºå›¢é˜Ÿéœ€è¦ä¸æ–­é€‚åº”æ–°çš„å·¥ä½œæ–¹å¼ï¼Œå› æ­¤çŸ­æœŸå†…å¯¹å·¥ä½œæ–¹å¼çš„å˜é©é€šå¸¸ä¼šå¯¹ç”Ÿäº§æ•ˆç‡äº§ç”Ÿè´Ÿé¢å½±å“ã€‚</p>
</blockquote>
<p>è‡ªåŠ¨åŒ–æµ‹è¯•ä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆéš¾åœ¨å¾ˆçŸ­çš„æ—¶é—´å†…å°±èƒ½çœ‹åˆ°æ”¶ç›Šçš„å·¥å…·ï¼Œå¹¶ä¸”è¿˜éœ€è¦ä»˜å‡ºä¸€äº›æˆæœ¬ï¼šéœ€è¦å­¦ä¹ è‡ªåŠ¨åŒ–æµ‹è¯•çš„é…å¥—å·¥å…·ï¼Œç¼–å†™è‡ªåŠ¨åŒ–caseçš„æ¡†æ¶ï¼Œè°ƒåº¦è‡ªåŠ¨åŒ–æ‰§è¡Œçš„ç›¸å…³å·¥å…·â€¦â€¦</p>
<p>å› æ­¤ï¼Œæœ€å¼€å§‹çš„ä¸€æ®µæ—¶é—´å†…ï¼Œè‡ªåŠ¨åŒ–æµ‹è¯•æœ‰å¯èƒ½ä¼šé™ä½æµ‹è¯•æ•ˆç‡ã€‚ä½†æ˜¯ï¼Œä¸€æ—¦æŒæ¡è¿™äº›æŠ€å·§ï¼Œæˆ‘ä»¬å°±ä¼šå‘ç°æ±½è½¦ç¡®å®æ¯”é©¬è½¦è·‘çš„å¿«ï¼Œéš¾é“ä¸æ˜¯å—ï¼Ÿ</p>
<p>çŸ­æœŸæ”¶ç›Šä¸æ˜æ˜¾è¿˜æœ‰å¦å¤–ä¸€ä¸ªå› ç´ ï¼šçŸ­æœŸå†…é€‚åˆè‡ªåŠ¨åŒ–æµ‹è¯•çš„é¡¹ç›®åˆ†å¸ƒå¹¶ä¸å‡åŒ€ã€‚å¦‚<a href="#f3">å›¾3</a>æ‰€ç¤ºï¼Œè‡ªåŠ¨åŒ–æµ‹è¯•åœ¨<a href="#%E6%B5%8B%E8%AF%95%E7%9A%844%E5%A4%A7%E6%B4%BB%E5%8A%A8">æµ‹è¯•4å¤§æ´»åŠ¨</a>ä¸­çš„æ‰§è¡Œé˜¶æ®µä»¥åŠ<a href="#%E6%95%8F%E6%8D%B7%E6%B5%8B%E8%AF%954%E8%B1%A1%E9%99%90">æ•æ·æµ‹è¯•4è±¡é™</a>ä¸­çš„ç¬¬2ã€ç¬¬3è±¡é™æ‰èƒ½å‘æŒ¥å…¶ä½œç”¨ã€‚ä½†æ˜¯å¯¹äºå‘¨ã€æœˆç»´åº¦çš„é¡¹ç›®è€Œè¨€ï¼Œèƒ½æœ‰å¤šå°‘é¡¹ç›®ä¼šè®©è‡ªåŠ¨åŒ–æµ‹è¯•æœ‰ç”¨æ­¦ä¹‹åœ°å‘¢ï¼Ÿæ¥ä¸‹æ¥å‘ç”Ÿçš„äº‹æƒ…å°±æ˜¯å¯¹è‡ªåŠ¨åŒ–æµ‹è¯•çš„å®šé‡æŒ‡æ ‡è€Œè¨€ï¼Œæ²¡æœ‰æ•°æ®ä¸Šçš„å˜åŒ–ï¼Œç„¶ååçš„äº‹æƒ…å°±ä¼šå‘ç”Ÿäº†ï¼Œå›¢é˜Ÿæ…¢æ…¢å°±å¤±å»äº†è€å¿ƒâ€¦â€¦</p>
<h3 id="è¯¯åŒº2ï¼šåªçœ‹ä¸ªäººæ•ˆç‡æ”¶ç›Š">è¯¯åŒº2ï¼šåªçœ‹ä¸ªäººæ•ˆç‡æ”¶ç›Š</h3>
<p>åœ¨è¿›è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•ä¹‹å‰ï¼Œå¤§å¤šæ•°å›¢é˜Ÿéƒ½ä¼šé€‰æ‹©ä¸€äº›ä¸šåŠ¡æ¥è¯•ç‚¹ï¼Œç„¶åæ ¹æ®è¯•ç‚¹ä¸šåŠ¡çš„åé¦ˆæ¥ç¡®å®šæ˜¯å¦è¦å¤§èŒƒå›´æ¨å¹¿ã€‚</p>
<p>ä½†æ˜¯ï¼Œåœ¨å®é™…è¯•ç‚¹çš„æ—¶å€™ï¼Œä¼šå‡ºç°å¾ˆå¤šå½±å“å› ç´ ï¼šä¾‹å¦‚æµ‹è¯•äººå‘˜å‰æœŸæ²¡æœ‰æ¥å…¥æµ‹è¯•äº†è§£ï¼Œæµ‹è¯•äººå‘˜æ²¡æœ‰æå‰å’Œç ”å‘äººå‘˜ç¡®å®šæ¥å£å®šä¹‰ï¼Œæµ‹è¯•äººå‘˜å‰æœŸåœ¨è·Ÿè¿›å…¶ä»–é¡¹ç›®â€¦â€¦</p>
<p>å¦‚ä¸Šçš„å› ç´ ä¼šå¯¼è‡´å½“ä¸€ä¸ªæµ‹è¯•é¡¹ç›®åˆ°æ¥æ—¶ï¼Œæµ‹è¯•äººå‘˜æ²¡æœ‰è¶³å¤Ÿçš„æ—¶é—´æ¥æ¶ˆåŒ–é‚£äº›éœ€è¦åœ¨å‰æœŸæ‰€ä»˜å‡ºçš„å­¦ä¹ æˆæœ¬ã€‚åœ¨é¢å¯¹ä¸€ä¸ªä¸ªç´§æ€¥çš„é¡¹ç›®å’Œéœ€è¦ä»˜å‡ºä¸€å®šçš„æˆæœ¬æ—¶ï¼Œè¿™äº›è¯•ç‚¹çš„æµ‹è¯•äººå‘˜ä¼šè‡ªç„¶è€Œç„¶çš„ç»§ç»­ä½¿ç”¨æ—§æœ‰çš„æ‰‹å·¥æµ‹è¯•çš„æ–¹å¼æ¥ä¿è¯é¡¹ç›®çš„å¿«é€Ÿè·Ÿè¿›ã€‚</p>
<p>è¯•ç‚¹é¡¹ç›®çš„æµ‹è¯•äººå‘˜ä¼šä»è‡ªèº«çš„åˆ©ç›Šå‡ºå‘æ¥é€‰æ‹©æµ‹è¯•æ–¹æ¡ˆã€‚ç„¶åè¿™äº›è¯•ç‚¹çš„æµ‹è¯•äººå‘˜å°±ä¼šæ±‡æŠ¥è¯´ï¼šè‡ªåŠ¨åŒ–æµ‹è¯•å¤ªæµªè´¹æ—¶é—´äº†ï¼Œæ²¡æ³•æé«˜æ•ˆç‡ã€‚å¦‚æœç®¡ç†è€…ä¸ä»”ç»†ç»§ç»­å’Œè¿™äº›ä¸€çº¿çš„åŒå­¦æ·±å…¥æ¢è®¨ï¼Œé‚£ä¹ˆæœ€ç»ˆå°±ä¼šæ ¹æ®è¯•ç‚¹åŒå­¦çš„ç»“è®ºå¾—å‡ºä¸€ä¸ªåç¦»äº‹å®çš„ç»“è®ºï¼šè‡ªåŠ¨åŒ–æµ‹è¯•ç¡®å®æ— æ³•æå‡æ•ˆç‡ã€‚</p>
<p>ç„¶è€Œï¼Œä¸Šè¿°çš„ä¸€äº›è¯•ç‚¹äººå‘˜é‡åˆ°çš„é—®é¢˜ä»æœ¬è´¨ä¸Šè®²ï¼Œå¹¶ä¸æ˜¯è‡ªåŠ¨åŒ–æµ‹è¯•æœ¬èº«çš„é—®é¢˜ï¼Œè¿™é‡Œæ¶‰åŠåˆ°æ›´å¤šçš„æµç¨‹ã€æ²Ÿé€šã€åä½œçš„é—®é¢˜ã€‚ä¸æ˜¯è‡ªåŠ¨åŒ–æµ‹è¯•ä¸èƒ½æå‡æ•ˆç‡ï¼Œè€Œæ˜¯å½“å‰çš„ç¯å¢ƒä¸å…è®¸è‡ªåŠ¨åŒ–æµ‹è¯•å‘æŒ¥ä½œç”¨ã€‚</p>
<p>æ³¥æ³çš„é“è·¯ä¸Šï¼Œæ˜¯é©¬è½¦å¿«å‘¢è¿˜æ˜¯è·‘è½¦å¿«å‘¢ï¼Ÿ</p>
<p>åœ¨æ‰€æœ‰äººåªä»è‡ªèº«åˆ©ç›Šæ¥è€ƒè™‘é—®é¢˜ï¼Œè€Œå¿½ç•¥å…¶æ‰€å¤„çš„ç¯å¢ƒæ—¶ï¼Œå°±ä¼šå‡ºç°è¿™ç§ï¼šé©¬è½¦æ¯”è·‘è½¦å¿«çš„æ»‘ç¨½ç»“è®ºã€‚</p>
<h3 id="è¯¯åŒº3ï¼šæˆæœ¬æ ¸ç®—æ ‡å‡†ä¸ä¸€è‡´">è¯¯åŒº3ï¼šæˆæœ¬æ ¸ç®—æ ‡å‡†ä¸ä¸€è‡´</h3>
<p>å¦‚å‰æ‰€è¿°ï¼Œè‡ªåŠ¨åŒ–æµ‹è¯•æ˜¯éœ€è¦å­¦ä¹ æˆæœ¬çš„ï¼Œä¸ç»å†é£é›¨æ€ä¹ˆè§å½©è™¹ï¼Ÿè‡ªåŠ¨åŒ–æµ‹è¯•å’Œæ‰‹å·¥æµ‹è¯•çš„ROIæƒè¡¡å¦‚<a href="#f4">å›¾4</a>æ‰€ç¤ºã€‚</p>
<p><span id="f4"><img src="/2020/07/08/autotest-is-a-working-culture-first/f4.png" alt></span></p>
<p>ä½†æ˜¯åœ¨æˆ‘çš„è§‚å¯Ÿä¸­ï¼Œæˆ‘å‘ç°å¤§å¤šæ•°å›¢é˜Ÿåœ¨æ ¸ç®—æ‰‹å·¥æµ‹è¯•å’Œè‡ªåŠ¨åŒ–æµ‹è¯•çš„æˆæœ¬æ—¶é‡‡ç”¨çš„æ ‡å‡†å¹¶ä¸ä¸€è‡´ã€‚ä»–ä»¬ä¼šå¿½ç•¥ï¼šæ‰‹å·¥æµ‹è¯•é‡å¤æµ‹è¯•çš„æˆæœ¬ï¼Œä¼šå¿½ç•¥æ‰‹å·¥æµ‹è¯•é‡å¤ä¹¦å†™æµ‹è¯•æŠ¥å‘Šçš„æˆæœ¬â€¦â€¦ä½†æ˜¯ä»–ä»¬ä¼šç»™è‡ªåŠ¨åŒ–æµ‹è¯•è¿½åŠ ä¸Šï¼šä¸Šä¸‹æ¸¸ç¯å¢ƒä¾èµ–æˆæœ¬ï¼Œç¯å¢ƒéƒ¨ç½²æˆæœ¬ï¼Œæ¥å£å®šä¹‰ä¸å®Œå¤‡çš„æˆæœ¬ï¼Œè‡ªåŠ¨åŒ–ç”¨ä¾‹çš„ç»´æŠ¤æˆæœ¬å¤ªå¤§äº†â€¦â€¦</p>
<p>ç‚¹ä¸€ä¸‹æœ€ç®€å•ï¼Œæˆæœ¬æœ€ä½ï¼Œç‚¹ç‚¹å§ã€‚</p>
<p>å½“å¤œæ·±äººé™çš„æ—¶å€™ï¼Œä½ å†ç»†æƒ³è¿™äº›è¯æœ¯ã€ä½ ç»†æƒ³â€¦â€¦å°±ä¼šå‘ç°è¿™äº›æˆæœ¬å’Œè‡ªåŠ¨åŒ–æµ‹è¯•ä»€ä¹ˆå…³ç³»ï¼Œæ‰‹å·¥æµ‹è¯•ä¸ä¹Ÿéœ€è¦è¿™äº›æˆæœ¬å—ï¼Ÿè¦æ˜¯ä¸€ä¸ªé¡¹ç›®è¦æµ‹å¤šè½®ï¼Œéš¾ä¸æˆæ¯æ¬¡éƒ½ç‚¹ç‚¹ï¼ŸOHï¼Œå½“ç„¶ä¸æ˜¯äº†ï¼Œä¸‹ä¸€æ¬¡åªç‚¹é‚£äº›ä¸Šä¸€æ¬¡å¤±è´¥çš„ç”¨ä¾‹å°±å¥½äº†â€¦â€¦OMGâ€¦â€¦</p>
<p>æ‰‹å·¥ç”¨ä¾‹å°±ä¸éœ€è¦ç»´æŠ¤æˆæœ¬ï¼Ÿä¸è¿‡ä»æˆ‘çš„è§‚å¯Ÿå‘ç°ï¼Œç¡®å®ä¸éœ€è¦ã€‚å› ä¸ºæœ‰äº›å›¢é˜Ÿå‹æ ¹å°±ä¸å†™æ‰‹å·¥ç”¨ä¾‹ï¼Œå½“ç„¶å°±è°ˆä¸ä¸Šæˆæœ¬äº†ã€‚è¿˜æœ‰çš„å›¢é˜Ÿå³ä¾¿æœ‰æ‰‹å·¥ç”¨ä¾‹ä¹Ÿä»æ¥ä¸ä¼šç»´æŠ¤ï¼Œä¸‹ä¸€ä¸ªåŒå­¦æµ‹è¯•ç±»ä¼¼çš„é¡¹ç›®çš„æ—¶å€™ï¼Œå‚è€ƒä¸€ä¸‹ä¹‹å‰çš„ç”¨ä¾‹ï¼Œç„¶åè‡ªå·±é‡æ–°å†™ç”¨ä¾‹ã€‚</p>
<h3 id="è¯¯åŒº4ï¼šä¸å…³æ³¨å›¢é˜Ÿæ”¶ç›Š">è¯¯åŒº4ï¼šä¸å…³æ³¨å›¢é˜Ÿæ”¶ç›Š</h3>
<p>åœ¨è¯¯åŒº2ä¸­ï¼Œè¯•ç‚¹é¡¹ç›®çš„æµ‹è¯•äººå‘˜åªæ ¹æ®è‡ªå·±çš„ä¸ªäººæ”¶ç›Šæ¥åšæµ‹è¯•æ–¹æ¡ˆçš„é€‰æ‹©ã€‚ä½†æ˜¯å›¢é˜Ÿä¸­çš„ä¸ªäººæ˜¯ç›¸äº’è”ç³»çš„ï¼Œå›¢é˜Ÿå†…éƒ¨çš„é¡¹ç›®ä¹Ÿä¼šæ˜¯è¿ç»­çš„ï¼Œè€Œä¸æ˜¯ç¦»æ•£çš„ã€‚</p>
<p>æŸä¸ªäººæµ‹è¯•çš„æŸä¸ªé¡¹ç›®ï¼Œä¸‹ä¸€æ¬¡å¯èƒ½å°±æ¢å…¶ä»–äººæ¥æµ‹è¯•äº†ã€‚æŸä¸ªçŸ­æœŸæ¥çœ‹ä¸ä¼šå˜åŒ–çš„é¡¹ç›®ï¼Œå¯èƒ½æ•°æœˆä¹‹åå°±ä¼šä¿®æ”¹äº†ã€‚é¡¹ç›®æ¯æ¬¡éƒ½ä¿®æ”¹ä¸€ç‚¹ç‚¹ï¼Œå¯èƒ½åŠå¹´ä¹‹åå°±ä¼šæœ‰ä¸Šç™¾ä¸ªä¿®æ”¹ç‚¹äº†â€¦â€¦</p>
<p>å¦‚æœç«™åœ¨å›¢é˜Ÿçš„è§’åº¦è€ƒè™‘ï¼Œæˆ‘ä»¬å›¢é˜Ÿå†…æ¯ä¸ªäººç¼–å†™çš„è‡ªåŠ¨åŒ–ç”¨ä¾‹æœ‰æ—¶å€™è™½ç„¶å¯¹ä¸ªäººè€Œè¨€ROIå¾ˆä½ï¼Œä½†æ˜¯å¯¹å›¢é˜Ÿçš„ROIå´å¯èƒ½éå¸¸å¤§ã€‚</p>
<p>å¦‚æœæ¯ä¸€ä¸ªå˜æ›´å¾ˆå°çš„é¡¹ç›®éƒ½ä¸ç¼–å†™è‡ªåŠ¨åŒ–ç”¨ä¾‹ï¼Œé‚£ä¹ˆå½“é¡¹ç›®åšå¤§çš„æ—¶å€™æ€ä¹ˆåŠï¼Ÿ<br>
å¦‚æœæ¯ä¸ªé¡¹ç›®éƒ½æ˜¯ä¸Šçº¿åå°±ä¸ä¿®æ”¹äº†ï¼Œé‚£å½“è¿™ä¸ªé¡¹ç›®çš„ä»£ç è¦ä¸‹çº¿çš„æ—¶å€™æ€ä¹ˆåŠï¼Ÿ</p>
<p>å½“ç„¶ï¼Œè¿™äº›å¯¹äºä¸ªäººè€Œè¨€æ˜¯æ— éœ€å…³æ³¨çš„äº‹æƒ…ï¼Œå› ä¸ºè°çŸ¥é“æ¥ä¸‹æ¥çš„æµ‹è¯•è¿˜æ˜¯ä¸æ˜¯ä½ è´Ÿè´£ï¼Ÿä½†æ˜¯ï¼Œæœ€ç»ˆå´è¿˜æ˜¯è¿™ä¸ªå›¢é˜Ÿæ¥è´Ÿè´£çš„ï¼Œä¸æ˜¯å—ï¼Ÿå½“æ‰€æœ‰è¿™äº›éƒ½æ²¡æœ‰ä»”ç»†æ‰§è¡Œçš„æ—¶å€™ï¼Œåœ¨é‡åˆ°å¤§çš„é¡¹ç›®ï¼Œåœ¨é‡åˆ°å›¢é˜ŸæŠ€æœ¯é‡æ„çš„é¡¹ç›®æ—¶ï¼Œå¯¹äºå›¢é˜Ÿè€Œè¨€ï¼Œä¸€ä¸ªæ€ªå¼‚çš„ç°è±¡å°±å‘ç”Ÿäº†ï¼šå¤§å¤šæ•°å›¢é˜Ÿéƒ½åœ¨è¯•å›¾å¯»æ‰¾å¦å¤–çš„æµ‹è¯•æ–¹æ³•æ¥å¼¥è¡¥è‡ªåŠ¨åŒ–ç”¨ä¾‹ç¼ºå¤±çš„é—æ†¾ï¼Œæ¯”å¦‚å¼•æµæµ‹è¯•diffæµ‹è¯•ç­‰ç­‰ã€‚</p>
<h3 id="è¯¯åŒº5ï¼šè‡ªåŠ¨åŒ–ç”¨ä¾‹æ˜¯ä¸‡å¹´ä¸å˜çš„">è¯¯åŒº5ï¼šè‡ªåŠ¨åŒ–ç”¨ä¾‹æ˜¯ä¸‡å¹´ä¸å˜çš„</h3>
<p>å› ä¸ºè‡ªåŠ¨åŒ–ç”¨ä¾‹éœ€è¦éšç€ä¸šåŠ¡ä»£ç çš„è¿­ä»£è€Œè¿­ä»£ï¼Œè€Œå¾ˆå¤šå›¢é˜Ÿåˆè®¤ä¸ºè¿™æ ·çš„æˆæœ¬å¤ªå¤§äº†ã€‚å› æ­¤è‡ªåŠ¨åŒ–ç”¨ä¾‹å°±æˆäº†ä¸€å †ä¸‡å¹´ä¸å˜çš„åŠŸèƒ½çš„æµ‹è¯•ç”¨ä¾‹ï¼Œæœ€ç»ˆè‡ªåŠ¨åŒ–å°±æˆäº†â€œå½¢è€Œä¸Šâ€èˆ¬çš„å­˜åœ¨ã€‚</p>
<p>ä¸šåŠ¡ä»£ç éƒ½åœ¨ä¸æ–­å˜åŒ–ï¼Œä¸æ–­å‡çº§ï¼Œä¸æ–­è¿­ä»£ï¼Œå‡­ä»€ä¹ˆè‡ªåŠ¨åŒ–çš„ç”¨ä¾‹å°±å¾—ä¸‡å¹´ä¸å˜ï¼Œè‡ªåŠ¨åŒ–çš„ç”¨ä¾‹å°±ä¸ç”¨ç»´æŠ¤ï¼Ÿå®åœ¨æ˜¯æƒ³ä¸é€šè¿™é‡Œé¢çš„é“ç†ã€‚</p>
<p>è‡ªåŠ¨åŒ–ç”¨ä¾‹çš„è½åï¼Œä¼šå¯¼è‡´è‡ªåŠ¨åŒ–ç”¨ä¾‹æ— æ³•æˆä¸ºä¸šåŠ¡ä»£ç çš„è¯•åˆ€çŸ³ï¼Œå½“ä»–å˜æˆä¸€ä»¶é™„å±å“æ—¶ï¼Œä»–æ‰€å¸¦æ¥çš„ä¸€åˆ‡å°±åªæœ‰æˆæœ¬äº†ã€‚</p>
<h3 id="è¯¯åŒº6ï¼šé¡¹ç›®è¿­ä»£å¤ªå¿«äº†-ç­‰ç¨³å®šäº†å†ç”¨è‡ªåŠ¨åŒ–æµ‹è¯•">è¯¯åŒº6ï¼šé¡¹ç›®è¿­ä»£å¤ªå¿«äº†ï¼Œç­‰ç¨³å®šäº†å†ç”¨è‡ªåŠ¨åŒ–æµ‹è¯•</h3>
<p>è¿™ä¸€ç‚¹æ˜¯æˆ‘å¬åˆ°è¿‡çš„æ‰€æœ‰çš„è°¬è¯¯ä¸­æœ€æ²¡æœ‰é“ç†çš„ä¸€ä¸ªäº†ã€‚</p>
<p>ä»<a href="#f4">å›¾4</a>ä¸­å¯ä»¥çœ‹å‡ºï¼Œè¶Šæ˜¯å¤§çš„é¡¹ç›®ï¼Œè¶Šæ˜¯è¿­ä»£æ¬¡æ•°å¤šçš„é¡¹ç›®ï¼Œè¶Šæ˜¯å˜åŒ–å¿«çš„é¡¹ç›®ï¼Œè‡ªåŠ¨åŒ–æµ‹è¯•çš„æ”¶ç›Šè¶Šå¤§ã€‚å¤§å¤šæ•°å›¢é˜Ÿï¼Œæ­¤æ—¶æƒ³åˆ°çš„æ›´å¤šçš„æ˜¯å¿«é€Ÿçš„å˜åŒ–å¸¦æ¥çš„æ˜¯æ›´å¤šçš„è‡ªåŠ¨åŒ–ç”¨ä¾‹çš„ç»´æŠ¤æˆæœ¬ã€‚</p>
<p>ä½†æ˜¯ï¼Œå³ä¾¿æ˜¯åˆ›ä¸šå…¬å¸ï¼Œè°ä¹Ÿä¸ä¼šåœ¨é¡¹ç›®å¯åŠ¨çš„æ—¶å€™å°±æœç€æŠŠé¡¹ç›®åšçƒ‚çš„ç›®æ ‡è¡Œè¿›å§ï¼Ÿ</p>
<p>ç­‰é¡¹ç›®ç¨³å®šçš„æ—¶å€™ï¼Œä¼°è®¡å°±æ˜¯è¿™ä¸ªäº§å“è¦ä¸‹çº¿çš„æ—¶å€™äº†ã€‚</p>
<h2 id="è‡ªåŠ¨åŒ–æµ‹è¯•æ˜¯ä¸€ç§æ–‡åŒ–">è‡ªåŠ¨åŒ–æµ‹è¯•æ˜¯ä¸€ç§æ–‡åŒ–</h2>
<p>åœ¨è€ƒè™‘è‡ªåŠ¨åŒ–æµ‹è¯•çš„æ—¶å€™ï¼Œéœ€è¦è®¤çœŸçš„æ€è€ƒè‡ªåŠ¨åŒ–æµ‹è¯•çš„å®šä½å’Œç›®æ ‡ï¼Œéœ€è¦è®¤è¯†åˆ°è‡ªåŠ¨åŒ–æµ‹è¯•éœ€è¦ä»˜å‡ºä¸€å®šçš„æˆæœ¬ï¼Œè‡ªåŠ¨åŒ–æµ‹è¯•è¿˜éœ€è¦ä¿®æ”¹æ—¢æœ‰çš„ç ”å‘æµç¨‹ï¼Œéœ€è¦è®¤è¯†åˆ°å›¢é˜Ÿçš„ç´¯è®¡æ”¶ç›Šâ€¦â€¦</p>
<p>åœ¨è€ƒè™‘è‡ªåŠ¨åŒ–æµ‹è¯•çš„æ—¶å€™ï¼Œè¿˜éœ€è¦æ„è¯†åˆ°ï¼Œè‡ªåŠ¨åŒ–æµ‹è¯•ä¸€ç§é¡¹ç›®æ–‡æ¡£åŒ–çš„æ‰‹æ®µï¼Œæ­£æ‰€è°“â€œæµ‹è¯•å³æ–‡æ¡£â€ï¼Œè‡ªåŠ¨åŒ–æµ‹è¯•è¿˜æ˜¯å›¢é˜Ÿå†…éƒ¨ä¸åŒæµ‹è¯•äººå‘˜æœ‰æ•ˆæ²Ÿé€šçš„ä¸€ç§æ‰‹æ®µï¼Œè‡ªåŠ¨åŒ–æµ‹è¯•æ›´æ˜¯å›¢é˜Ÿç§¯ç´¯çš„ä¸€ç§æœ‰æ•ˆè½½ä½“â€¦â€¦</p>
<p>è‡ªæˆ‘çœ‹æ¥ï¼Œè‡ªåŠ¨åŒ–æµ‹è¯•é¦–å…ˆåº”è¯¥æ˜¯ä¸€ç§å·¥ä½œæ–‡åŒ–ï¼Œè€Œä¸å•çº¯æ˜¯ä¸€ç§æµ‹è¯•æ‰‹æ®µã€‚å·¥ä½œæ–‡åŒ–æ„å‘³ç€å½“å‡ºç°é—®é¢˜çš„æ—¶å€™ï¼Œæˆ‘ä»¬çš„ååº”æ˜¯æˆ‘ä»¬æ²¡ä¼šä½¿ç”¨è¿™ä¸ªå·¥å…·ï¼Œæˆ–è€…æˆ‘ä»¬çš„ä½¿ç”¨æ–¹æ³•ä¸å¯¹ï¼Œè€Œä¸æ˜¯è¯´è¿™ä¸ªå·¥å…·æ˜¯æœ‰é—®é¢˜çš„ã€‚</p>
]]></content>
      <categories>
        <category>æ€»ç»“</category>
      </categories>
      <tags>
        <tag>æ–¹æ³•è®º</tag>
        <tag>æµ‹è¯•</tag>
        <tag>è‡ªåŠ¨åŒ–æµ‹è¯•</tag>
        <tag>auto test</tag>
        <tag>æ•æ·</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½¿ç”¨Boost::Pythonç”¨C++å¼€å‘Pythonåº“</title>
    <url>/2020/06/13/write-python-library-using-c-with-boost-python/</url>
    <content><![CDATA[<h2 id="èƒŒæ™¯">èƒŒæ™¯</h2>
<p>å¾ˆå¤šç³»ç»Ÿéƒ½ä¼šç”¨<code>json</code>æ ¼å¼è¿›è¡Œæ•°æ®äº¤äº’ã€‚ä¸ºäº†ä¿è¯æ•°æ®åœ¨ç³»ç»Ÿä¸Šä¸‹æ¸¸çš„è‡ªåŠ¨æ ¡éªŒï¼Œé¿å…æ•°æ®ç»“æ„å¼‚å¸¸å¸¦æ¥çš„ç³»ç»Ÿç¨³å®šæ€§é—®é¢˜ï¼Œå¯ä»¥é‡‡ç”¨<a href="http://json-schema.org"><code>json-schema</code></a>æ¥å®šä¹‰<code>jsonæ¥å£</code>ï¼Œå¹¶åˆ©ç”¨<a href="https://datatracker.ietf.org/doc/draft-handrews-json-schema-validation"><code>json-schema-validator</code></a>æ¥æ ¡éªŒæ¥å£å“åº”çš„ç»“æ„çš„åˆæ³•æ€§ã€‚</p>
<p>ç„¶è€Œç³»ç»Ÿä¸­ä¸åŒå­ç³»ç»Ÿçš„å®ç°ï¼ˆç¼–ç¨‹è¯­è¨€ï¼‰å¹¶éæ€»æ˜¯ä¸€è‡´ï¼Œè™½ç„¶å„ç§è¯­è¨€éƒ½æä¾›äº†<a href="https://datatracker.ietf.org/doc/draft-handrews-json-schema-validation"><code>json-schema-validator</code></a>çš„å…·ä½“å®ç°ï¼Œä½†æ˜¯ä¸åŒè¯­è¨€æ”¯æŒçš„<code>json-schema-validator</code>æ ‡å‡†çš„ç‰ˆæœ¬å¹¶éå®Œå…¨ä¸€è‡´ï¼Œè¿™ä¼šå¯¹åç»­çš„ä½¿ç”¨å¸¦æ¥ä¸€äº›æ··ä¹±ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>Java: <a href="https://github.com/java-json-tools/json-schema-validator">json-schema-validator</a>æ”¯æŒ<a href="https://tools.ietf.org/html/draft-fge-json-schema-validation-00">Draft 4</a></li>
<li>C++: <a href="https://github.com/pboettch/json-schema-validator">json-schema-validator</a>æ”¯æŒ<a href="https://tools.ietf.org/html/draft-handrews-json-schema-validation-01">Draft 7</a></li>
<li>Python <a href="https://github.com/Julian/jsonschema">jsonschema</a>æ”¯æŒ<a href="https://tools.ietf.org/html/draft-handrews-json-schema-validation-01">Draft 7</a></li>
</ul>
<span id="more"></span>
<p>ç›®å‰å¤§å¤šæ•°è¯­è¨€ï¼Œä¾‹å¦‚ï¼šJava, Golang, Php, Python, Luaç­‰éƒ½æ”¯æŒC/C<ins>çš„æ‰©å±•ã€‚å› æ­¤ï¼Œå¯ä»¥ç”¨C/C</ins>æ¥ä¸ºå…¶ä»–è¯­è¨€æä¾›ç»Ÿä¸€çš„æ‰©å±•åº“æ”¯æŒï¼Œæœ¬æ–‡å°±æ˜¯ä»‹ç»æ€ä¹ˆåˆ©ç”¨<code>Boost::Python</code>åº“æä¾›<a href="https://github.com/pboettch/json-schema-validator"><code>json-schema-validator</code></a>çš„Pythonæ”¯æŒï¼Œå¹¶ä»‹ç»å¦‚ä½•åˆ©ç”¨<code>distutils</code>æ¥ç¼–è¯‘&amp;åˆ†å‘Pythonåº“ã€‚</p>
<p><img src="/2020/06/13/write-python-library-using-c-with-boost-python/1.png" alt></p>
<h2 id="pythonè°ƒç”¨c-c-çš„æ–¹å¼">Pythonè°ƒç”¨C/C++çš„æ–¹å¼</h2>
<p>æœ‰ä¸¤ç§æ–¹å¼å¯ä»¥å®ç°Pythonè°ƒç”¨C/C++ç¼–å†™çš„åº“ï¼š</p>
<ul>
<li>ä½¿ç”¨Pythonæ‰©å±•</li>
<li>ä½¿ç”¨<code>ctypes</code>æ¨¡å—ç›´æ¥åŠ è½½C/C++ç¼–å†™çš„so</li>
</ul>
<h4 id="ctypesåŠ è½½soæ–‡ä»¶">ctypesåŠ è½½soæ–‡ä»¶</h4>
<p><code>ctype</code>æ˜¯Pythonçš„å¤–éƒ¨å‡½æ•°åº“ã€‚å®ƒæä¾›äº†Cå…¼å®¹çš„æ•°æ®ç±»å‹ï¼Œå¹¶å…è®¸åœ¨DLLæˆ–å…±äº«åº“ä¸­è°ƒç”¨å‡½æ•°ã€‚</p>
<p><code>ctype</code>æ˜¯Pythonå°è£…çš„APIå‡½æ•°åº“ã€‚å…¶ä¸­<code>cdll = &lt;ctypes.LibraryLoader object&gt;</code>æ˜¯ä¸€ä¸ªåº“åŠ è½½å™¨å¯¹è±¡ï¼Œè°ƒç”¨<code>cdll.LoadLibrary</code>ä¾¿å¯è°ƒç”¨C/C++çš„soåº“ã€‚</p>
<p>æ­¤å¤„ä¸å†å¯¹å¦‚ä½•ä½¿ç”¨<code>ctype</code>æ¨¡å—åŠ è½½soæ–‡ä»¶åšè¿‡å¤šçš„ä»‹ç»ï¼Œå…·ä½“å¯ä»¥å‚è€ƒå…¶<a href="https://docs.python.org/3/library/ctypes.html#module-ctypes">å®˜æ–¹æ–‡æ¡£</a>ã€‚</p>
<h4 id="ä½¿ç”¨pythonæ‰©å±•">ä½¿ç”¨Pythonæ‰©å±•</h4>
<p>è¯¥æ–¹å¼æ˜¯Pythonä¸ºæ•´åˆå…¶å®ƒè¯­è¨€è€Œæä¾›çš„ä¸€ç§æ‰©å±•æœºåˆ¶ï¼Œå¹¶ä¸”è¯¥æœºåˆ¶ä¸å±€é™äºC/C++ï¼Œä¹Ÿå¯ä»¥ç”¨äºå…¶å®ƒè¯­è¨€ã€‚Pythonçš„å¯æ‰©å±•æ€§å…·æœ‰å¦‚ä¸‹çš„ä¼˜ç‚¹ï¼š</p>
<ul>
<li>æ–¹ä¾¿ä¸ºè¯­è¨€å¢åŠ æ–°åŠŸèƒ½</li>
<li>å…·æœ‰å¯å®šåˆ¶æ€§</li>
<li>å¯ä»¥å®ç°ä»£ç å¤ç”¨</li>
<li>â€¦â€¦</li>
</ul>
<p>è¯¥æ–¹å¼çš„å…·ä½“ä½¿ç”¨æ­¤å¤„ä¹Ÿä¸å†åšè¿‡å¤šä»‹ç»ï¼Œå…·ä½“ä¿¡æ¯å¯ä»¥ç›´æ¥å‚è€ƒPythonçš„å®˜æ–¹æ–‡æ¡£<a href="https://docs.python.org/3/extending/building.html"><strong>Building C and C++ Extensions</strong></a>æ¥äº†è§£ã€‚æ¥ä¸‹æ¥è¦è®²çš„ä¾‹å­å°±æ˜¯åˆ©ç”¨äº†<code>å¯ä»¥å®ç°ä»£ç å¤ç”¨</code>çš„ä¼˜ç‚¹ã€‚</p>
<p>å¦‚<a href="https://docs.python.org/3/extending/building.html"><strong>Building C and C++ Extensions</strong></a>æ‰€ç¤ºï¼ŒPythonæä¾›äº†<code>Python/C++ API</code>ç”¨æ¥å®ç°Pythonå’ŒC<ins>çš„äº¤äº’ã€‚ç„¶è€Œï¼Œç›´æ¥ä½¿ç”¨è¿™äº›APIæ¥å®ŒæˆPythonå’ŒC/C</ins>çš„äº¤äº’è¿˜æ˜¯ä¼šå­˜åœ¨å¾ˆå¤šé‡å¤å·¥ä½œçš„ã€‚<code>Boost::Python</code>åˆ™å¯¹<code>Python/C++ API</code>è¿›è¡Œäº†æŠ½è±¡å’ŒåŒ…è£…ï¼Œä»è€Œä½¿å¾—Pythonå’ŒC++çš„äº¤äº’æ›´åŠ æ–¹ä¾¿ã€‚</p>
<h2 id="boost-pythonå°è£…c-c-æ‰©å±•">Boost::Pythonå°è£…C/C++æ‰©å±•</h2>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬ä»‹ç»æˆ‘ä»¬æ˜¯å¦‚ä½•åˆ©ç”¨Boost::Pythonæ¥ä¸º<a href="https://github.com/pboettch/json-schema-validator">nlohmann_json_schema_validator</a>å¢åŠ Pythonæ‰©å±•ã€‚</p>
<p><code>nlohmann_json_schema_validator</code> is a C++ library for validating JSON documents based on a <strong>JSON Schema</strong> which itself should validate with <strong>draft-7 of JSON Schema Validation</strong>.</p>
<h4 id="ç¼–è¯‘nlohmann-json-schema-validatoråº“">ç¼–è¯‘nlohmann json schema validatoråº“</h4>
<p><code>nlohmann json schema validator</code>æ”¯æŒäº§å‡ºå¯æ‰§è¡Œçš„binæ–‡ä»¶ä»¥åŠå¯ä¾›å…¶ä»–é¡¹ç›®ä½¿ç”¨çš„åŠ¨æ€åº“ã€‚ä¸ºäº†å¯ä»¥å°†è¯¥æ‰©å±•åŒ…è£…æˆPythonæ‰©å±•ï¼Œæˆ‘ä»¬éœ€è¦ç”Ÿæˆè¯¥åº“çš„åŠ¨æ€åº“ã€‚</p>
<p>é¦–å…ˆæ ¹æ®<code>nlohmann json schema validator</code>çš„<a href="https://github.com/pboettch/json-schema-validator/blob/master/README.md#building-as-shared-library">ç¼–è¯‘æ–‡æ¡£</a>ç¼–è¯‘å‡º<code>nlohmann json schema validator</code>çš„åŠ¨æ€åº“ã€‚</p>
<p><img src="/2020/06/13/write-python-library-using-c-with-boost-python/2.jpg" alt></p>
<h4 id="boost-pythonå°è£…c-c-ä»£ç ">Boost::Pythonå°è£…C/C++ä»£ç </h4>
<p>åœ¨å®‰è£…Boostçš„æ—¶å€™ï¼Œè™½ç„¶Boostçš„å¤´æ–‡ä»¶ä¸­å­˜åœ¨Boost::Pythonç›¸å…³çš„hppæ–‡ä»¶ï¼Œä½†æ˜¯é»˜è®¤å´æ²¡æœ‰è¯¥åŠ¨æ€åº“ã€‚å› æ­¤ï¼Œåœ¨ä½¿ç”¨Boost::Pythonä¹‹å‰ï¼Œé¦–å…ˆéœ€è¦å®‰è£…è¯¥åº“ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ brew install boost-python3</span><br></pre></td></tr></table></figure>
<p>ç„¶åï¼Œæˆ‘ä»¬ç”¨C++ç¼–å†™<code>class json_validator_python;</code>æ¥å°è£…<code>nlohmann json schema validator</code>åº“ï¼Œå¹¶åˆ©ç”¨Boost::Pythonæ¥å¯¼å‡ºï¼Œå…·ä½“å¦‚ä¸‹ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// jsv_python.cpp</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;nlohmann/json-schema.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;boost/python.hpp&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> boost::python;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">JSON_SCHEMA_VALIDATOR_API</span> <span class="title">json_validator_python</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    nlohmann::json_schema::json_validator validator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">json_validator_python</span>() &#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">set_root_schema</span><span class="params">(<span class="keyword">const</span> std::string &amp;json_string)</span> </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        validator.<span class="built_in">set_root_schema</span>(nlohmann::json::<span class="built_in">parse</span>(json_string.<span class="built_in">begin</span>(), json_string.<span class="built_in">end</span>()));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">validate</span><span class="params">(<span class="keyword">const</span> std::string &amp;json_string)</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        validator.<span class="built_in">validate</span>(nlohmann::json::<span class="built_in">parse</span>(json_string.<span class="built_in">begin</span>(), json_string.<span class="built_in">end</span>()));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// json_schema_validatorä¸ºmoduleåï¼Œå¿…éœ€å’Œç”Ÿæˆçš„soåº“åä¸€æ ·</span></span><br><span class="line"><span class="built_in">BOOST_PYTHON_MODULE</span>(json_schema_validator)</span><br><span class="line">&#123;</span><br><span class="line">    class_&lt;json_validator_python, boost::noncopyable&gt; (<span class="string">&quot;json_validator_python&quot;</span>)</span><br><span class="line">            .<span class="built_in">def</span>(<span class="string">&quot;set_root_schema&quot;</span>, &amp;json_validator_python::set_root_schema)</span><br><span class="line">            .<span class="built_in">def</span>(<span class="string">&quot;validate&quot;</span>, &amp;json_validator_python::validate)</span><br><span class="line">            ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚ä¸Šæ‰€ç¤ºçš„<code>BOOST_PYTHON_MODULE</code>ä»£ç ï¼Œç›®çš„æ˜¯å¯¼å‡ºç±»åŠæˆå‘˜æ–¹æ³•ï¼Œè¿™äº›å¯¼å‡ºçš„ç±»å’Œæ–¹æ³•å¯ä»¥åœ¨Pythonä¸­è°ƒç”¨ã€‚</p>
<p>å…³äºBoost::Pythonæ›´è¯¦ç»†çš„ä½¿ç”¨ï¼Œå¯ä»¥å‚è€ƒå…¶<a href="https://www.boost.org/doc/libs/1_66_0/libs/python/doc/html/index.html">å®˜æ–¹æ–‡æ¡£</a>ã€‚</p>
<h4 id="ç¼–è¯‘å¹¶äº§å‡ºpythonæ‰©å±•">ç¼–è¯‘å¹¶äº§å‡ºPythonæ‰©å±•</h4>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">g++ --std&#x3D;c++11 -fPIC -c jsv_python.cpp \</span><br><span class="line">-I$&#123;json-schema-validator_PATH&#125;&#x2F;src \</span><br><span class="line">-I$&#123;nlohmann-json_PATH&#125; \</span><br><span class="line">-I$&#123;Boost_PATH&#125;&#x2F;include \</span><br><span class="line">-I$&#123;Python_INCLUDE_PATH&#125;</span><br><span class="line"></span><br><span class="line">g++ --std&#x3D;c++11 -shared \</span><br><span class="line">-L$&#123;json-schema-validator_LIB_PATH&#125; \</span><br><span class="line">-L$&#123;Python_LIB_PATH&#125; \</span><br><span class="line">-L$&#123;Boost_Python_LIB_PATH&#125; \</span><br><span class="line">-lnlohmann_json_schema_validator \</span><br><span class="line">-lboost_python38 -lpython3.8 \</span><br><span class="line">-o json_schema_validator.so jsv_python.o</span><br></pre></td></tr></table></figure>
<p>å¦‚ä¸Šçš„æŒ‡ä»¤ï¼Œä¼šç”Ÿæˆå°è£…ä¹‹åçš„Pythonæ‰©å±•ï¼š<code>json_schema_validator.so</code>ã€‚</p>
<h4 id="æµ‹è¯•pythonæ‰©å±•">æµ‹è¯•pythonæ‰©å±•</h4>
<p>åœ¨å½“å‰ç›®å½•æ‰§è¡Œå¦‚ä¸‹çš„Pythonä»£ç ï¼Œå¯ä»¥å‘ç°ï¼Œæˆ‘ä»¬å°è£…çš„æ‰©å±•å·²ç»å¯ä»¥å½“åšPythonæ‰©å±•æ¥å¯¼å…¥å¹¶ä½¿ç”¨äº†ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> json_schema_validator <span class="keyword">as</span> jsv</span><br><span class="line"></span><br><span class="line">validator = jsv.json_validator_python()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">isValidator = <span class="literal">True</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    validator.set_root_schema(<span class="string">&#x27;&#123;&quot;type&quot;:&quot;object&quot;, &quot;properties&quot;: &#123;&quot;a&quot;:&#123;&quot;type&quot;: &quot;string&quot;&#125;&#125;&#125;&#x27;</span>)</span><br><span class="line">    validator.validate(<span class="string">&#x27;&#123;&quot;a&quot;:&quot;1&quot;&#125;&#x27;</span>);</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    isValidator = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(isValidator)</span><br></pre></td></tr></table></figure>
<h2 id="ä½¿ç”¨distutilsç¼–è¯‘å¹¶åˆ†å‘æ‰©å±•">ä½¿ç”¨distutilsç¼–è¯‘å¹¶åˆ†å‘æ‰©å±•</h2>
<p>ä¸ºäº†ä½¿ç”¨æ–¹ä¾¿ï¼Œä½¿ç”¨<a href="https://docs.python.org/3/extending/building.html"><strong>Building C and C++ Extensions</strong></a>ä»‹ç»çš„<code>distutilsæ¨¡å—</code>ç¼–è¯‘Pythonæ‰©å±•ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> distutils.core <span class="keyword">import</span> setup, Extension</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">os.environ[<span class="string">&quot;CC&quot;</span>] = <span class="string">&quot;g++&quot;</span></span><br><span class="line">os.environ[<span class="string">&quot;CXX&quot;</span>] = <span class="string">&quot;g++&quot;</span></span><br><span class="line"></span><br><span class="line">module1 = Extension(<span class="string">&#x27;json_schema_validator&#x27;</span>,</span><br><span class="line">                    include_dirs = [<span class="string">&#x27;../../src&#x27;</span>,</span><br><span class="line">                        <span class="string">&#x27;../../&#x27;</span>,</span><br><span class="line">                        <span class="string">&#x27;/usr/local/Cellar/boost/1.72.0_3/include&#x27;</span>,</span><br><span class="line">                        <span class="string">&#x27;/usr/local/opt/python@3.8/Frameworks/Python.framework/Versions/3.8/include/python3.8&#x27;</span>],</span><br><span class="line">                    libraries = [<span class="string">&#x27;boost_python38&#x27;</span>, <span class="string">&#x27;python3.8&#x27;</span>,</span><br><span class="line">                        <span class="string">&#x27;nlohmann_json_schema_validator&#x27;</span>],</span><br><span class="line">                    library_dirs = [<span class="string">&#x27;/usr/local/opt/python@3.8/Frameworks/Python.framework/Versions/3.8/lib&#x27;</span>,</span><br><span class="line">                        <span class="string">&#x27;/usr/local/Cellar/boost-python3/1.72.0_1/lib&#x27;</span>,</span><br><span class="line">                        <span class="string">&#x27;.&#x27;</span>],</span><br><span class="line">                    sources = [<span class="string">&#x27;jsv_python.cpp&#x27;</span>],</span><br><span class="line">                    extra_compile_args=[<span class="string">&#x27;--std=c++11&#x27;</span>],</span><br><span class="line">                    extra_link_args=[<span class="string">&#x27;--std=c++11&#x27;</span>])</span><br><span class="line"></span><br><span class="line">setup (name = <span class="string">&#x27;json-schema-validator&#x27;</span>,</span><br><span class="line">       version = <span class="string">&#x27;1.0&#x27;</span>,</span><br><span class="line">       description = <span class="string">&#x27;json schema validator&#x27;</span>,</span><br><span class="line">       ext_modules = [module1])</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ python3 setup.py build</span><br><span class="line">$ python3 setup.py install</span><br><span class="line">$ export LD_LIBRARY_PATH&#x3D;$LD_LIBRARY_PATH:&#x2F;usr&#x2F;local&#x2F;lib&#x2F;python3.7&#x2F;site-packages&#x2F;json_schema_validator</span><br></pre></td></tr></table></figure>
<p>ç„¶åå°±å¯ä»¥åœ¨ä»»æ„ä½ç½®ï¼Œæ‰§è¡Œ<a href="#%E6%B5%8B%E8%AF%95python%E6%89%A9%E5%B1%95">æµ‹è¯•pythonæ‰©å±•</a>ä¸€èŠ‚çš„æµ‹è¯•ä»£ç å•¦ã€‚</p>
]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>Boost::Python</tag>
        <tag>setup.py</tag>
        <tag>distutils</tag>
      </tags>
  </entry>
  <entry>
    <title>é›†ç¾¤æ—¶é—´æˆ³ä¸ä¸€è‡´å¯¼è‡´çš„é—®é¢˜åŠå…¶åˆ†æå’Œæ€è€ƒ</title>
    <url>/2020/05/29/problem-caused-by-timestamp-s-difference-in-cluster-and-analysis/</url>
    <content><![CDATA[<blockquote>
<p>1883å¹´11æœˆ18æ—¥ï¼Œç¾å›½ç¬¬ä¸€ä¸ªå…¨å›½ç»Ÿä¸€é“è·¯æ—¶åˆ»è¡¨è¯ç”Ÿï¼Œè¿™ä¸€å¤©çš„æ­£åˆæ—¶åˆ†ï¼Œç¾å›½ä¸œéƒ¨çš„æ—¶é’Ÿå…¨éƒ¨å›æ‹¨ã€‚ä»æ­¤ï¼Œä¸Šå¸çš„æ—¶é—´è¢«æ”¹ç”¨äººé—´çš„æŒ‡é’ˆæ¥åº¦é‡ã€‚ â€”â€”<strong>å…¬å¸çš„åŠ›é‡</strong></p>
</blockquote>
<h2 id="èƒŒæ™¯">èƒŒæ™¯</h2>
<p>æœ€è¿‘é‡åˆ°çš„ä¸šåŠ¡ä¸Šçš„é—®é¢˜æ¶‰åŠï¼š<em>åœ¨ä¸€ä¸ªé›†ç¾¤ä¸­ï¼Œå­˜åœ¨éƒ¨åˆ†æœºå™¨çš„<code>æ—¶é—´æˆ³</code>å’Œå…¶å®ƒæœºå™¨ä¸ä¸€è‡´è€Œå¯¼è‡´çš„é‡å¤§é—®é¢˜</em>ã€‚ä¸ºäº†ä¸æ³„éœ²ä¸šåŠ¡çš„ç›¸å…³ä¿¡æ¯ï¼Œæ–‡ä¸­ä¼šç”¨ä¸€ä¸ªç±»ä¼¼çš„åœºæ™¯æ¥å¯¹è¿™ä¸ªé—®é¢˜è¿›è¡Œåˆ†æã€‚</p>
<span id="more"></span>
<h2 id="æ—¶é—´æˆ³-unix-time-stamp">æ—¶é—´æˆ³ï¼ˆunix time stampï¼‰</h2>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œæ¶‰åŠåˆ°çš„é—®é¢˜æ˜¯é›†ç¾¤<code>æ—¶é—´æˆ³</code>ä¸ä¸€è‡´è€Œä¸æ˜¯<code>æ—¶é—´</code>ä¸ä¸€è‡´ã€‚</p>
<p><a href="https://www.unixtimestamp.com">The unix time stamp</a> is a way to track time as a running total of seconds. This count starts at the Unix Epoch on January 1st, 1970 at UTC. Therefore, the unix time stamp is merely the number of seconds between a particular date and the Unix Epoch. It should also be pointed out (thanks to the comments from visitors to this site) that <strong><code>this point in time technically does not change no matter where you are located on the globe</code></strong>. This is very useful to computer systems for tracking and sorting dated information in dynamic and distributed applications both online and client side.</p>
<p>ç”±æ­¤å¯çŸ¥ï¼Œ<code>æ—¶é—´æˆ³</code>å’Œ<code>æ—¶é—´</code>ä¸åŒï¼Œæ˜¯ä¸€ä¸ªå’Œæ—¶åŒºæ— å…³çš„å…¨çƒä¸€è‡´çš„æ—¶é—´è®¡é‡æ–¹å¼ã€‚ä¸åŒé›†ç¾¤ä¼šå› ä¸ºå…¶æ‰€åœ¨çš„æ—¶åŒºä¸åŒè€Œå­˜åœ¨æ—¶é—´ä¸åŒçš„é—®é¢˜ï¼Œä½†æ˜¯å…¶æ—¶é—´æˆ³æ˜¯ä¸€è‡´çš„ã€‚</p>
<p>Linuxç³»ç»Ÿè€Œè¨€ï¼Œæ—¶é—´æˆ³å¯ä»¥åˆ©ç”¨<a href="https://www.gnu.org/software/shellutils/shellutils.html"><code>GNU shell utilities</code></a>æä¾›çš„<a href="https://github.com/coreutils/coreutils/blob/master/src/date.c"><code>date</code>å‘½ä»¤</a>æ¥è·å–ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ date +%s</span><br><span class="line">$ 1590719825</span><br></pre></td></tr></table></figure>
<h2 id="æ—¶é—´æˆ³ä¸ä¸€è‡´å¸¦æ¥çš„é—®é¢˜">æ—¶é—´æˆ³ä¸ä¸€è‡´å¸¦æ¥çš„é—®é¢˜</h2>
<p>è€ƒè™‘å¦‚ä¸‹çš„ä¸€ä¸ªè´­ç‰©ç«™ç‚¹çš„æ´»åŠ¨åœºæ™¯ï¼Œå¦‚ä¸‹çš„åœºæ™¯å¯èƒ½ä¸ä¼šåœ¨ç°å®çš„ç”µå•†æ´»åŠ¨ä¸­å­˜åœ¨ï¼Œè¯¥åœºæ™¯ä»…ä»…æ˜¯ä¸ºäº†è¯´æ˜æœ¬æ–‡çš„é—®é¢˜è€ŒæŠ½è±¡çš„ä¸€ä¸ªåœºæ™¯ã€‚</p>
<blockquote>
<p>åŸä»·100ï¿¥çš„å•†å“ï¼Œç°ä»·10ï¿¥å…ƒé”€å”®ï¼Œä½†å‰ææ˜¯ä¸‹å•çš„ç”¨æˆ·éœ€è¦åœ¨1åˆ†é’Ÿå†…å®Œæˆæ”¯ä»˜ã€‚å¦‚æœä¸‹å•ç”¨æˆ·æœªèƒ½åœ¨1åˆ†é’Ÿå†…å®Œæˆæ”¯ä»˜ï¼Œåˆ™è¯¥è®¢å•æ— æ•ˆï¼ŒåŒæ—¶è¯¥ç”¨æˆ·æ— æ³•ç»§ç»­ä»¥æŠ˜æ‰£ä»·ä¸‹å•ã€‚</p>
</blockquote>
<p>ä¸ºäº†æ–¹ä¾¿é—®é¢˜è¯´æ˜ï¼Œä¸‹å•å’Œæ”¯ä»˜ç­‰åŠŸèƒ½åˆå¹¶åœ¨<code>trade</code>ï¼Œäº§ç”Ÿçš„ç›¸å…³æ•°æ®åˆ™å­˜å‚¨äº<code>DB</code>ã€‚ç®€åŒ–ä¹‹åçš„æ¶æ„å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="/2020/05/29/problem-caused-by-timestamp-s-difference-in-cluster-and-analysis/1.png" alt></p>
<p>å½“<code>trade</code>ä¸ºå•æœºéƒ¨ç½²æ—¶ï¼Œä¸ä¼šå­˜åœ¨é—®é¢˜ã€‚ä½†æ˜¯å½“<code>trade</code>ä½œä¸ºé›†ç¾¤éƒ¨ç½²æ—¶ï¼Œåˆ™ä¼šå­˜åœ¨é›†ç¾¤æ—¶é—´æˆ³ä¸ä¸€è‡´å¯¼è‡´ç”¨æˆ·æ”¯ä»˜å¤±è´¥çš„é—®é¢˜ã€‚å…·ä½“å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="/2020/05/29/problem-caused-by-timestamp-s-difference-in-cluster-and-analysis/2.png" alt></p>
<p>å¦‚å›¾æ‰€ç¤ºï¼Œ<code>m1</code>å’Œ<code>m2</code>çš„æ—¶é—´æˆ³æ˜¯ä¸€è‡´çš„ï¼Œä½†æ˜¯<code>m3</code>çš„æ—¶é—´æˆ³æ¯”å…¶å®ƒæœºå™¨æ­£å¥½å¿«äº†<strong>60s</strong>ã€‚å› æ­¤ï¼Œå¦‚æœ<code>æ”¯ä»˜</code>çš„æµé‡ç”±<code>m3</code>æœºå™¨çš„<code>trade</code>å¤„ç†ï¼Œåˆ™å³ä¾¿æ˜¯åœ¨1åˆ†é’Ÿå†…æ”¯ä»˜ï¼Œå› ä¸º<code>m3</code>æœºå™¨çš„æ—¶é—´æˆ³å¿«60sè€Œå¯¼è‡´æ”¯ä»˜è¶…æ—¶ï¼Œè¿›è€Œå¯¼è‡´ç”¨æˆ·æ”¯ä»˜å¤±è´¥ï¼Œå½±å“ç”¨æˆ·ä½“éªŒã€‚</p>
<p>è¿™å°±æ˜¯æˆ‘ä»¬è¦è®²çš„ï¼šåœ¨ä¸€ä¸ªé›†ç¾¤ä¸­ï¼Œéƒ¨åˆ†æœºå™¨çš„<code>æ—¶é—´æˆ³</code>å’Œå…¶å®ƒæœºå™¨ä¸ä¸€è‡´è€Œå¯¼è‡´çš„é‡å¤§é—®é¢˜ã€‚</p>
<h2 id="é—®é¢˜å¦‚ä½•è§£å†³">é—®é¢˜å¦‚ä½•è§£å†³</h2>
<p>åœ¨ä¸ä¿®æ”¹ç³»ç»Ÿæ¶æ„çš„å‰æä¸‹ï¼Œåˆ™å¯ä»¥åˆ©ç”¨åŒä¸€æ—¶é’ŸåŒæ­¥é›†ç¾¤ä¸­æ‰€æœ‰æœºå™¨çš„æ—¶é’Ÿï¼Œä»è€Œè®©é›†ç¾¤çš„æ—¶é’Ÿä¿æŒåŒæ­¥ï¼Œè¿›è€Œè§£å†³è¯¥é—®é¢˜ã€‚å…·ä½“çš„æ–¹æ¡ˆå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p>
<p><img src="/2020/05/29/problem-caused-by-timestamp-s-difference-in-cluster-and-analysis/3.png" alt></p>
<h3 id="ntp">ntp</h3>
<p>å¯¹Linuxè€Œè¨€ï¼Œå¯ä»¥ä½¿ç”¨<a href="https://en.wikipedia.org/wiki/Network_Time_Protocol"><code>ntp</code></a>æ¥å®ç°é›†ç¾¤çš„æ—¶é—´åŒæ­¥ã€‚</p>
<p>åŒæ­¥æ—¶é—´ï¼Œå¯ä»¥ä½¿ç”¨<code>ntpdate</code>å‘½ä»¤ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨<code>ntpd</code>æœåŠ¡ã€‚</p>
<h3 id="ntpdate">ntpdate</h3>
<p>ä½¿ç”¨<code>ntpdate</code>æ¯”è¾ƒç®€å•ã€‚æ ¼å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ ntpdate [-nv] [NTP IP&#x2F;hostname]</span><br><span class="line">$ ntpdate 192.168.0.1</span><br><span class="line">$ ntpdate time.ntp.org</span><br></pre></td></tr></table></figure>
<p><code>ntpdate</code>åªæ˜¯å¼ºåˆ¶å°†ç³»ç»Ÿæ—¶é—´è®¾ç½®ä¸ºntpæœåŠ¡å™¨æ—¶é—´ã€‚å¦‚æœæœºå™¨cpu tickæœ‰é—®é¢˜ï¼Œè¿™ç§åŒæ­¥æ²»æ ‡ä¸æ²»æœ¬ã€‚æ­¤æ—¶ï¼Œä¸€èˆ¬é…åˆ<code>cron</code>ä»»åŠ¡æ¥å®šæœŸåŒæ­¥ã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">0 12 * * * * &#x2F;usr&#x2F;sbin&#x2F;ntpdate 192.168.0.1</span><br></pre></td></tr></table></figure>
<h3 id="ntpd">ntpd</h3>
<p>ä½¿ç”¨<code>ntpd</code>æœåŠ¡ï¼Œè¦å¥½äºä½¿ç”¨<code>ntpdate+cron</code>ã€‚</p>
<p><code>ntpdate</code>åŒæ­¥æ—¶é—´ï¼Œä¼šé€ æˆæ—¶é—´çš„è·³è·ƒï¼Œå¯¹ä¸€äº›ä¾èµ–æ—¶é—´çš„ç¨‹åºå’ŒæœåŠ¡ä¼šé€ æˆå½±å“ï¼Œæ¯”å¦‚sleepï¼Œtimerç­‰ã€‚</p>
<p><code>ntpd</code>æœåŠ¡å¯ä»¥åœ¨ä¿®æ­£æ—¶é—´çš„åŒæ—¶ï¼Œä¿®æ­£cpu tickã€‚</p>
<p>ç†æƒ³çš„åšæ³•ä¸ºï¼Œåœ¨å¼€æœºçš„æ—¶å€™ï¼Œä½¿ç”¨<code>ntpdate</code>å¼ºåˆ¶åŒæ­¥æ—¶é—´ï¼Œåœ¨å…¶ä»–æ—¶å€™ä½¿ç”¨<code>ntpd</code>æœåŠ¡æ¥åŒæ­¥æ—¶é—´ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<code>ntpd</code>æœ‰ä¸€ä¸ªè‡ªæˆ‘ä¿æŠ¤è®¾ç½®: å¦‚æœæœ¬æœºæ—¶é—´ä¸æºæ—¶é—´ç›¸å·®å¤ªå¤§, åˆ™<code>ntpd</code>ä¸è¿è¡Œã€‚æ‰€ä»¥æ–°è®¾ç½®çš„æ—¶é—´æœåŠ¡å™¨ä¸€å®šè¦å…ˆåˆ©ç”¨<code>ntpdate</code>å‘½ä»¤è·å–åˆå§‹æ—¶é—´, ç„¶åå¯åŠ¨<code>ntpd</code>æœåŠ¡ã€‚</p>
<p>å…³äºntpdçš„ä½¿ç”¨ï¼Œç½‘ä¸Šå·²ç»æœ‰å¾ˆå¤šèµ„æ–™äº†ï¼Œè¿™é‡Œå°±ä¸åšè¿‡å¤šçš„ä»‹ç»äº†ã€‚</p>
<h3 id="ntpstat">ntpstat</h3>
<p><code>ntpstat</code>ç”¨äºæ˜¾ç¤ºç½‘ç»œæ—¶é—´çš„åŒæ­¥çŠ¶æ€ã€‚<code>ntpstat</code>ä¼šç»™å‡ºæœ¬åœ°è®¡ç®—æœºä¸Šè¿è¡Œçš„<code>ntpd</code>çš„åŒæ­¥çŠ¶æ€ã€‚å¦‚æœæœ¬åœ°ç³»ç»Ÿä¸å‚è€ƒæ—¶é—´æºåŒæ­¥ï¼Œåˆ™<code>ntpstat</code>ä¼šç»™å‡ºè¿‘ä¼¼çš„æ—¶é—´ç²¾åº¦ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ ntpstat</span><br><span class="line">synchronised to NTP server (192.168.0.1) at stratum 3</span><br><span class="line">   time correct to within 43 ms</span><br><span class="line">   polling server every 1024 s</span><br></pre></td></tr></table></figure>
<h2 id="é—®é¢˜å¼•ç”³">é—®é¢˜å¼•ç”³</h2>
<p>è™½ç„¶å¯ä»¥åˆ©ç”¨<code>ntp</code>æ¥åŒæ­¥é›†ç¾¤æ—¶é—´ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜æ˜¯å€¼çš„æ€è€ƒçš„ï¼š<strong>å¦‚ä½•åœ¨é›†ç¾¤æ—¶é’Ÿä¸åŒçš„æƒ…å†µä¸‹ï¼Œè§£å†³<a href="#%E6%97%B6%E9%97%B4%E6%88%B3%E4%B8%8D%E4%B8%80%E8%87%B4%E5%B8%A6%E6%9D%A5%E7%9A%84%E9%97%AE%E9%A2%98">æ—¶é—´æˆ³ä¸ä¸€è‡´å¸¦æ¥çš„é—®é¢˜</a>ä¸€èŠ‚ä¸­æè¿°çš„é—®é¢˜</strong>ã€‚</p>
<p>ç³»ç»Ÿåœ¨æ¶æ„ä¸Šè¦åšä½•ç§ä¼˜åŒ–ï¼Œæ‰èƒ½é¿å…ä¸šåŠ¡å¯¹é›†ç¾¤æ—¶é’ŸåŒæ­¥çš„ä¾èµ–ï¼Ÿè€Œè¿™ç§ä¼˜åŒ–æ‰€å¸¦æ¥çš„ç³»ç»Ÿæ¶æ„çš„å¤æ‚åº¦å’Œæˆæœ¬åˆå°†å¦‚ä½•ï¼Ÿ</p>
]]></content>
      <categories>
        <category>æ€»ç»“</category>
      </categories>
      <tags>
        <tag>ntp</tag>
        <tag>æ—¶é—´æˆ³ä¸åŒæ­¥</tag>
      </tags>
  </entry>
  <entry>
    <title>è½¯ä»¶çš„ç†µå’Œç ´çª—åŸç†</title>
    <url>/2020/05/20/Software-Entropy-and-A-Broken-Window/</url>
    <content><![CDATA[<blockquote>
<p><strong>å¦‚ä¸‹çš„å†…å®¹ï¼Œæ‘˜é€‰è‡ªã€Šç¨‹åºå‘˜ä¿®ç‚¼ä¹‹é“â€”â€”é€šå‘åŠ¡å®çš„æœ€é«˜å¢ƒç•Œï¼ˆç¬¬äºŒç‰ˆï¼‰ã€‹ã€‚</strong></p>
</blockquote>
<p>è™½ç„¶è½¯ä»¶å¼€å‘ä¸å—ç»å¤§å¤šæ•°ç‰©ç†æ³•åˆ™çš„çº¦æŸï¼Œä½†æˆ‘ä»¬æ— æ³•èº²é¿æ¥è‡ªâ€œç†µâ€çš„å¢åŠ çš„é‡å‡»ã€‚â€œç†µâ€æ˜¯ä¸€ä¸ªç‰©ç†å­¦æœ¯è¯­ï¼Œå®ƒå®šä¹‰äº†ä¸€ä¸ªç³»ç»Ÿçš„â€œæ— åºâ€æ€»é‡ã€‚ä¸å¹¸çš„æ˜¯ï¼Œçƒ­åŠ›å­¦æ³•åˆ™å†³å®šäº†å®‡å®™ä¸­çš„ç†µä¼šè¶‹å‘æœ€å¤§åŒ–ã€‚å½“è½¯ä»¶ä¸­çš„æ— åºåŒ–å¢åŠ æ—¶ï¼Œç¨‹åºå‘˜ä¼šè¯´â€œè½¯ä»¶åœ¨è…çƒ‚â€ã€‚æœ‰äº›äººå¯èƒ½ä¼šç”¨æ›´ä¹è§‚çš„æœ¯è¯­æ¥ç§°å‘¼å®ƒï¼Œå³â€œæŠ€æœ¯å€ºâ€ï¼Œæ½œå°è¯æ˜¯è¯´ä»–ä»¬æ€»æœ‰ä¸€å¤©ä¼šå¿è¿˜çš„â€”â€”ææ€•ä¸ä¼šè¿˜äº†ã€‚</p>
<p><img src="/2020/05/20/Software-Entropy-and-A-Broken-Window/1.png" alt></p>
<span id="more"></span>
<p>ä¸è¿‡ä¸ç®¡å«ä»€ä¹ˆåå­—ï¼Œå€ºåŠ¡å’Œè…çƒ‚éƒ½å¯èƒ½å¤±æ§åœ°è”“å»¶å¼€ã€‚</p>
<p>æœ‰å¾ˆå¤šå› ç´ ä¼šå¯¼è‡´è½¯ä»¶è…çƒ‚ã€‚æœ€é‡è¦çš„ä¸€ä¸ªä¼¼ä¹æ˜¯é¡¹ç›®å·¥ä½œä¸­çš„å¿ƒç†æ€§çŠ¶æ€ï¼Œæˆ–è€…è¯´æ–‡åŒ–ã€‚å³ä½¿æ˜¯ä¸€ä¸ªå•äººå›¢é˜Ÿï¼Œä½ çš„é¡¹ç›®çš„å¿ƒç†æ€§çŠ¶æ€ä¹Ÿæ˜¯ä¸ªéå¸¸è„†å¼±çš„ä¸œè¥¿ã€‚å³ä½¿æœ‰æœ€åˆç†çš„è®¡åˆ’å’Œæœ€ä½³çš„äººå‘˜ï¼Œé¡¹ç›®è¿˜æ˜¯å¯èƒ½åœ¨ç”Ÿå‘½å‘¨æœŸä¸­é€æ­¥è’åºŸã€è…çƒ‚ã€‚ä½†ä¹Ÿæœ‰ä¸€äº›é¡¹ç›®åœ¨ç»å†äº†å·¨å¤§çš„å›°éš¾ã€æŒç»­ä¸æ–­çš„æŒ«æŠ˜ä¹‹åï¼ŒæˆåŠŸåœ°å¯¹æŠ—äº†å¤©ç„¶çš„æ— åºåŒ–å€¾å‘ï¼Œèµ°å‡ºäº†å›°å¢ƒã€‚</p>
<p>æ˜¯ä»€ä¹ˆé€ æˆäº†å·®å¼‚ï¼Ÿ</p>
<p>åœ¨åŸå¸‚ä¸­å¿ƒï¼Œæœ‰äº›å»ºç­‘å¹²å‡€æ¼‚äº®ï¼Œè€Œå¦ä¸€äº›åˆ™ç ´è½ä¸å ªã€‚ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿä¸€äº›çŠ¯ç½ªå’ŒåŸå¸‚è¡°è´¥é¢†åŸŸçš„ç ”ç©¶äººå‘˜å‘ç°äº†ä¸€ä¸ªæœ‰è¶£çš„è§¦å‘æœºåˆ¶ï¼Œåªéœ€ä¸€æ ·ä¸œè¥¿å°±èƒ½éå¸¸è¿…é€Ÿåœ°æŠŠä¸€å¹¢å¹²å‡€å®Œå¥½çš„å®œå±…å»ºç­‘å˜æˆä¸€ä¸ªç ´è´¥çš„åºŸå¼ƒç‰©ã€‚</p>
<h2 id="ç ´çª—åŸç†">ç ´çª—åŸç†</h2>
<p>ä¸€æ‰‡ç ´æŸçš„çª—æˆ·ï¼Œåªè¦ä¸€æ®µæ—¶é—´ä¸å»ä¿®ç†ï¼Œå»ºç­‘ä¸­çš„å±…æ°‘å°±ä¼šæ½œç§»é»˜åŒ–åœ°äº§ç”Ÿä¸€ç§è¢«é—å¼ƒçš„æ„Ÿè§‰â€”â€”å½“æƒè€…ä¸å…³å¿ƒè¿™å¹¢å»ºç­‘çš„æ„Ÿè§‰ã€‚ç„¶åï¼Œå…¶ä»–çš„çª—æˆ·ä¹Ÿå¼€å§‹æŸåï¼Œå±…æ°‘å¼€å§‹ä¹±ä¸¢åºŸç‰©ï¼Œå¢™ä¸Šå¼€å§‹å‡ºç°æ¶‚é¸¦ï¼Œå»ºç­‘å¼€å§‹å‡ºç°ä¸¥é‡çš„ç»“æ„æ€§æŸåã€‚åœ¨çœ‹ä¸Šå»å¾ˆçŸ­çš„æ—¶é—´å†…ï¼Œå»ºç­‘çš„æŸåç¨‹åº¦å°±è¶³ä»¥æ‰“æ¶ˆä¸šä¸»ä»¬æƒ³ä¿®å¥½å®ƒçš„æœŸæœ›ï¼Œè¢«é—å¼ƒçš„æ„Ÿè§‰ç»ˆå˜æˆäº†ç°å®ã€‚</p>
<p><img src="/2020/05/20/Software-Entropy-and-A-Broken-Window/2.jpeg" alt></p>
<p>ä¸ºä½•é€ æˆè¿™æ ·çš„å½±å“ï¼Ÿ</p>
<p><strong>å¿ƒç†å­¦å®¶çš„ç ”ç©¶è¡¨æ˜ï¼Œç»æœ›æ˜¯ä¼šä¼ æŸ“çš„ï¼Œå°±åƒç‹­çª„ç©ºé—´ä¸­çš„æµæ„Ÿç—…æ¯’ã€‚æ— è§†ä¸€ä¸ªæ˜æ˜¾æŸåçš„ä¸œè¥¿ï¼Œä¼šå¼ºåŒ–è¿™æ ·ä¸€ç§è§‚å¿µï¼šçœ‹æ¥æ²¡æœ‰ä»€ä¹ˆæ˜¯èƒ½ä¿®å¥½çš„ï¼Œä¹Ÿæ²¡äººåœ¨ä¹ï¼Œä¸€åˆ‡éƒ½å‘½ä¸­æ³¨å®šäº†ã€‚æ‰€æœ‰çš„è´Ÿé¢æƒ…ç»ªä¼šåœ¨å›¢é˜Ÿæˆå‘˜é—´è”“å»¶ï¼Œå˜æˆæ¶æ€§å¾ªç¯ã€‚</strong></p>
<h2 id="ä¸è¦æ”¾ä»»ç ´çª—">ä¸è¦æ”¾ä»»ç ´çª—</h2>
<p><strong>ä¸è¦æç½®â€œç ´çª—â€(ç³Ÿç³•çš„è®¾è®¡ã€é”™è¯¯çš„å†³å®šã€ä½åŠ£çš„ä»£ç ï¼‰ä¸å»ä¿®ç†ã€‚</strong></p>
<p>æ¯å‘ç°ä¸€ä¸ªå°±èµ¶ç´§ä¿®ä¸€ä¸ªã€‚å¦‚æœæ²¡æœ‰è¶³å¤Ÿçš„æ—¶é—´å®Œå…¨ä¿®å¥½ï¼Œé‚£ä¹ˆå°±æŠŠå®ƒé’‰èµ·æ¥ã€‚ä¹Ÿè®¸ä½ å¯ä»¥æ³¨é‡Šæ‰é‚£äº›ç³Ÿç³•çš„ä»£ç ï¼Œæ˜¾ç¤ºä¸€è¡Œâ€œå°šæœªå®ç°â€çš„ä¿¡æ¯ï¼Œæˆ–ç”¨å‡æ•°æ®å…ˆæ›¿ä»£ä¸€ä¸‹ã€‚é‡‡å–è¡ŒåŠ¨ï¼Œé¢„é˜²è¿›ä¸€æ­¥çš„æŸå®³å‘ç”Ÿï¼Œè¡¨æ˜ä¸€åˆ‡å°½åœ¨ä½ çš„æŒæ¡ä¸­ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬äº†è§£äº†ä¸€æ—¦çª—æˆ·å¼€å§‹ç ´è£‚ï¼Œè¿è½¬è‰¯å¥½çš„å¹²å‡€ç³»ç»Ÿä¼šè¿…é€Ÿæ¶åŒ–ã€‚è¿˜æœ‰ä¸€äº›å…¶ä»–å› ç´ ä¼šå¯¼è‡´è½¯ä»¶è…çƒ‚ï¼Œæˆ‘ä»¬å°†åœ¨åˆ«å¤„æ¢è®¨ï¼Œä½†ä¸å…¶ä»–ä»»ä½•å› ç´ ç›¸æ¯”ï¼Œæ¼ è§†ä¼šåŠ é€Ÿè…çƒ‚çš„è¿‡ç¨‹ã€‚</p>
<p>ä½ æˆ–è®¸ä¼šè§‰å¾—ï¼Œæ²¡äººæœ‰æ—¶é—´æ¥æ¥å›å›æ¸…ç†é¡¹ç›®ä¸­æ‰€æœ‰çš„ç¢ç»ç’ƒã€‚å¦‚æœä½ çœŸè¿™ä¹ˆæƒ³ï¼ŒåŠä½ è¿˜æ˜¯è¶æ—©å¤šæƒ³æƒ³æ€ä¹ˆæ–™ç†è¿™ä¸ªé¡¹ç›®çš„åäº‹ï¼Œæˆ–æ˜¯ç›´æ¥ç¦»å¼€æ˜¯éä¹‹åœ°ã€‚</p>
<p>ä¸è¦è®©ç†µèµ¢å¾—èƒœåˆ©ã€‚</p>
<h2 id="å…ˆå‹¿ä¼¤å®³">å…ˆå‹¿ä¼¤å®³</h2>
<p>å¤šå¹´ä»¥å‰ï¼ŒAndyè®¤è¯†ä¸€ä¸ªåœŸè±ªã€‚ä»–çš„æˆ¿å­å¯Œä¸½å ‚çš‡ï¼Œå±‹å­é‡Œæ‘†æ»¡äº†æ— ä»·çš„å¤è‘£ï¼Œåˆ°å¤„é™ˆåˆ—ç€ç²¾ç¾çš„è‰ºæœ¯å“ã€‚æœ‰ä¸€å¤©ï¼Œä¸€å¼ æŒ‚æ¯¯å› ä¸ºç¦»å®¢å…å£ç‚‰å¤ªè¿‘è€Œç€ç«äº†ã€‚æ¶ˆé˜²å‘˜å¥‹å‹‡å†²è¿›å»æ•‘æ°‘äºæ°´ç«ï¼Œå½“ç„¶ä¸»è¦æ˜¯ç«ã€‚ä½†æ˜¯åœ¨æŠŠå·¨å¤§çš„æ°´ç®¡æ‹–è¿›å±‹å­å‰ï¼Œä»–ä»¬åœäº†ä¸‹æ¥â€”â€”å°½ç®¡é‡Œé¢ç«åŠ¿ç´§æ€¥â€”â€”æ¶ˆé˜²å‘˜æ¯…ç„¶é€‰æ‹©å…ˆåœ¨å‰é—¨å’Œç«æºä¹‹é—´é“ºä¸Šå«å­ï¼Œå› ä¸ºä»–ä»¬è§‰å¾—æ°´ç®¡å¤ªè„ã€‚</p>
<p>ä»–ä»¬ä¸æƒ³å¼„ååœ°æ¯¯ã€‚</p>
<p>ç°åœ¨å¬èµ·æ¥è¿™å¾ˆåæ¿€ã€‚æ¶ˆé˜²éƒ¨é—¨çš„é¦–è¦ä»»åŠ¡å½“ç„¶æ˜¯ç­ç«ï¼Œä½•å¿…ç®¡è¿‡ç¨‹ä¸­çš„é‚£äº›é™„å¸¦æŸå®³å‘¢ï¼Ÿä½†æ˜¯ï¼Œä»–ä»¬åœ¨æ¸…é†’åœ°è¯„ä¼°äº†å½¢åŠ¿åï¼Œå‡ºäºå¯¹è‡ªå·±æ§åˆ¶è¿™åœºç«åŠ¿èƒ½åŠ›çš„ç»å¯¹è‡ªä¿¡ï¼Œè¿˜æ˜¯å°½åŠ›å…¼é¡¾äº†ä¸å¯¹è´¢ç‰©é€ æˆä¸å¿…è¦çš„æ¯å®³ã€‚</p>
<p>è¿™ä¹Ÿæ˜¯è½¯ä»¶å¼€å‘ä¸­åº”è¯¥éµå¾ªçš„æ–¹æ³•ï¼š<strong>ä¸è¦åªæ˜¯å› ä¸ºä¸€äº›ä¸œè¥¿éå¸¸å±æ€¥ï¼Œå°±å»é€ æˆé™„å¸¦æŸå®³ã€‚ç ´çª—ä¸€æ‰‡éƒ½å«Œå¤ªå¤š</strong>ã€‚</p>
<p><img src="/2020/05/20/Software-Entropy-and-A-Broken-Window/3.jpg" alt></p>
<p><strong>ä¸€æ‰‡ç ´çª—â€”â€”ä¸€æ®µè®¾è®¡æƒ…ç³•çš„ä»£ç ï¼Œä¸€ä¸ªè®©å›¢é˜Ÿåœ¨æ•´ä¸ªé¡¹ç›®å‘¨æœŸå†…éƒ½å¿…é¡»è¦éµå®ˆçš„ç³Ÿç³•çš„ç®¡ç†å†³ç­–â€”â€”æ˜¯ä¸€åˆ‡è¡°é€€çš„å¼€å§‹ã€‚</strong></p>
<p>å¦‚æœä½ å‘ç°è‡ªå·±æ­£å¤„åœ¨æœ‰å‡ æ‰‡ç ´çª—çš„é¡¹ç›®ä¸­ï¼Œå°±éå¸¸å®¹æ˜“é™·å…¥è¿™æ ·çš„æƒ³æ³•â€”â€”â€œåæ­£ä»£ç æ‰€æœ‰å…¶ä»–éƒ¨åˆ†éƒ½æ˜¯ä¸€å¨å±ï¼Œæˆ‘åªæ˜¯éšå¤§æµè€Œå·²ã€‚â€</p>
<p>é¡¹ç›®åœ¨è¿™ä¸ªæ—¶é—´ç‚¹ä¹‹å‰æ˜¯å¦ä¸€ç›´è‰¯å¥½è¿è¡Œå¹¶ä¸é‡è¦ã€‚åœ¨æœ€åˆå¯å‘â€œç ´çª—ç†è®ºâ€çš„å®éªŒä¸­ï¼Œä¸€è¾†åºŸå¼ƒçš„æ±½è½¦å®Œå¥½æ— æŸåœ°åœæ”¾äº†ä¸€ä¸ªæ˜ŸæœŸã€‚ä½†æ˜¯ä¸€æ—¦æœ‰ä¸€å—ç»ç’ƒè¢«æ‰“ç ´ï¼Œè¿™è¾†è½¦åœ¨å‡ ä¸ªå°æ—¶å†…å°±ä¼šè¢«æ‰’å…‰å¹¶ç¿»äº†ä¸ªåº•æœå¤©ã€‚</p>
<p><strong>å‡ºäºåŒæ ·åŸå› ï¼Œå¦‚æœèº«å¤„ä¸€ä¸ªå¥åº·å›¢é˜Ÿï¼Œä½ ä»¬é¡¹ç›®çš„ä»£ç å¦‚æ­¤å®Œç¾â€”â€”ç¼–å†™æ¸…æ™°ã€è®¾è®¡ä¼˜è‰¯ã€ç®€æ´ä¼˜é›…â€”â€”ä½ å°±ä¼šå€¾å‘äºæ ¼å¤–åœ°å°å¿ƒï¼Œä¸æŠŠå®ƒå¼„ç³Ÿã€‚</strong> å°±åƒé‚£äº›æ¶ˆé˜²å‘˜ä¸€æ ·ï¼Œå³ä½¿å±‹å†…ç«åŠ¿ç†Šç†Šï¼ˆæˆªæ­¢æ—¶é™ã€å‘è¡Œæ—¥æœŸã€é”€å”®æ¼”ç¤ºï¼Œç­‰ç­‰ï¼‰ï¼Œä½ ä¹Ÿä¸æƒ³æˆä¸ºç¬¬ä¸€ä¸ªå¼„ä¹±å®ƒã€é€ æˆé™„å¸¦æŸå®³çš„äººã€‚åä¹‹ï¼Œè¿™ä¸ªé¡¹ç›®å°±ä¼šä»æŸä¸€æ‰‡ç ´çª—ï¼ˆç³Ÿç³•çš„è®¾è®¡ï¼Œæ··ä¹±çš„ä»£ç â€¦â€¦ï¼‰å¼€å§‹è¡°é€€ï¼Œè…çƒ‚â€¦â€¦</p>
<p>ä¸€å®šè¦å‘Šè¯‰è‡ªå·±ï¼Œâ€œä¸è¦æ‰“ç ´çª—æˆ·â€ã€‚</p>
]]></content>
      <categories>
        <category>è½¯ä»¶ç†è®º</category>
      </categories>
      <tags>
        <tag>æŠ€æœ¯å€º</tag>
        <tag>èä¹¦</tag>
      </tags>
  </entry>
  <entry>
    <title>matplotlibçš„backendsä»¥åŠéäº¤äº’å¼ç»˜å›¾</title>
    <url>/2020/04/28/Matplotlib-s-backends-and-non-interactive-backends-for-rendering/</url>
    <content><![CDATA[<p>åœ¨åˆ†æè§†é¢‘çš„psnræ—¶ï¼Œéœ€è¦ç”¨åˆ°<code>matplotlib</code>æ¥ç»˜åˆ¶è§†é¢‘æ¯ä¸€å¸§çš„psnrã€‚åœ¨Macè°ƒè¯•çš„æ—¶å€™å¯ä»¥æ­£å¸¸ç”Ÿæˆå¦‚ä¸‹æ‰€ç¤ºçš„psnrè¶‹åŠ¿å›¾ï¼š</p>
<p><img src="/2020/04/28/Matplotlib-s-backends-and-non-interactive-backends-for-rendering/1.png" alt></p>
<p>ä½†æ˜¯å°†åº”ç”¨éƒ¨ç½²åˆ°linuxæœºå™¨çš„æ—¶å€™ï¼Œå´æç¤º**ModuleNotFoundError: No module named â€˜_tkinterâ€™**çš„é”™è¯¯ã€‚</p>
<span id="more"></span>
<p>å…·ä½“å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="/2020/04/28/Matplotlib-s-backends-and-non-interactive-backends-for-rendering/2.jpg" alt></p>
<p>è¯·æ•™äº†åŒäº‹åé‡‡ç”¨å¦‚ä¸‹çš„æ–¹å¼è§£å†³äº†é—®é¢˜ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import matplotlib </span><br><span class="line">matplotlib.use(&#39;Agg&#39;)</span><br><span class="line">import matplotlib.pyplot as plt</span><br></pre></td></tr></table></figure>
<p><img src="/2020/04/28/Matplotlib-s-backends-and-non-interactive-backends-for-rendering/3.jpg" alt></p>
<p>è™½ç„¶è§£å†³äº†é—®é¢˜ï¼Œä½†æ˜¯å½“æ—¶æ²¡æœ‰æ˜ç™½ï¼š</p>
<ul>
<li>é—®é¢˜ç©¶ç«Ÿæ˜¯å¦‚ä½•è§£å†³çš„ï¼Ÿ</li>
<li>ä¸ºä»€ä¹ˆè¿™æ ·å°±å¯ä»¥è§£å†³ï¼Ÿ</li>
<li>è§£å†³æ–¹æ¡ˆå’Œä¹‹å‰çš„å†™æ³•çš„å·®å¼‚åœ¨å“ªé‡Œï¼Ÿ</li>
</ul>
<p>å› æ­¤æŸ¥é˜…äº†matplotlibçš„æ–‡æ¡£ï¼Œç„¶åå°±æœ‰äº†è¯¥æ–‡æ¥ä¸‹æ¥çš„å†…å®¹ã€‚ä¸ºäº†ä¿è¯ææ–™çš„åŸæ±åŸå‘³ï¼Œå¦‚ä¸‹çš„å†…å®¹å‡æ‘˜å½•è‡ª<a href="https://matplotlib.org/3.2.1/tutorials/introductory/usage.html#backends">matplotlibçš„å¼€å‘æ–‡æ¡£</a>ã€‚</p>
<h2 id="matplotlibä¸­backendçš„æ¦‚å¿µ">matplotlibä¸­backendçš„æ¦‚å¿µ</h2>
<p>A lot of documentation on the website and in the mailing lists refers to the <strong>â€œbackendâ€</strong> and many new users are confused by this term. matplotlib targets many different use cases and output formats. Some people use matplotlib interactively from the python shell and have plotting windows pop up when they type commands. Some people run Jupyter notebooks and draw inline plots for quick data analysis. Others embed matplotlib into graphical user interfaces like wxpython or pygtk to build rich applications. Some people use matplotlib in batch scripts to generate postscript images from numerical simulations, and still others run web application servers to dynamically serve up graphs.</p>
<p><strong>To support all of these use cases, matplotlib can target different outputs, and each of these capabilities is called a backend; the â€œfrontendâ€ is the user facing code, i.e., the plotting code, whereas the â€œbackendâ€ does all the hard work behind-the-scenes to make the figure.</strong></p>
<p>There are two types of backends:</p>
<ul>
<li>user interface backends (for use in pygtk, wxpython, tkinter, qt4, or macosx; also referred to as <code>&quot;interactive backends&quot;</code>). The interactive backends: GTK3Agg, GTK3Cairo, MacOSX, nbAgg, Qt4Agg, Qt4Cairo, Qt5Agg, Qt5Cairo, TkAgg, TkCairo, WebAgg, WX, WXAgg, WXCairo.</li>
<li>hardcopy backends to make image files (PNG, SVG, PDF, PS; also referred to as <code>&quot;non-interactive backends&quot;</code>). The non-interactive backends: agg, cairo, pdf, pgf, ps, svg, template.</li>
</ul>
<h2 id="matplotlibä¸­backendçš„é»˜è®¤é…ç½®">matplotlibä¸­backendçš„é»˜è®¤é…ç½®</h2>
<p>By default, <strong>Matplotlib should automatically select a default backend which allows both interactive work and plotting from scripts</strong>, with output to the screen and/or to a file, so at least initially you will not need to worry about the backend. <strong>The most common exception is if your Python distribution comes without tkinter and you have no other GUI toolkit installed; this happens on certain Linux distributions</strong>, where you need to install a Linux package named python-tk (or similar).</p>
<p>If, however, you want to write graphical user interfaces, or a web application server, or need a better understanding of what is going on, read on. To make things a little more customizable for graphical user interfaces, matplotlib separates the concept of the renderer (the thing that actually does the drawing) from the canvas (the place where the drawing goes). The canonical renderer for user interfaces is Agg which uses the Anti-Grain Geometry C++ library to make a raster (pixel) image of the figure; it is used by the Qt5Agg, Qt4Agg, GTK3Agg, wxAgg, TkAgg, and macosx backends. An alternative renderer is based on the Cairo library, used by Qt5Cairo, Qt4Cairo, etc.</p>
<h2 id="interactiveæ¨¡å¼çš„æ¦‚å¿µ">interactiveæ¨¡å¼çš„æ¦‚å¿µ</h2>
<p>Use of an interactive backend (see What is a backend?) permitsâ€“but does not by itself require or ensureâ€“plotting to the screen. Whether and when plotting to the screen occurs, and whether a script or shell session continues after a plot is drawn on the screen, depends on the functions and methods that are called, and on a state variable that determines whether matplotlib is in â€œinteractive modeâ€. The default Boolean value is set by the matplotlibrc file, and may be customized like any other configuration parameter (see Customizing Matplotlib with style sheets and rcParams). It may also be set via matplotlib.interactive(), and its value may be queried via matplotlib.is_interactive(). Turning interactive mode on and off in the middle of a stream of plotting commands, whether in a script or in a shell, is rarely needed and potentially confusing, so in the following we will assume all plotting is done with interactive mode either on or off.</p>
<p>Interactive mode may also be turned on via matplotlib.pyplot.ion(), and turned off via matplotlib.pyplot.ioff().</p>
<p><strong>In interactive mode, pyplot functions automatically draw to the screen.</strong> When plotting interactively, if using object method calls in addition to pyplot functions, then call draw() whenever you want to refresh the plot.</p>
<p>Use non-interactive mode in scripts in which you want to generate one or more figures and display them before ending or generating a new set of figures. In that case, use show() to display the figure(s) and to block execution until you have manually destroyed them.</p>
<h2 id="å¦‚ä½•é€‰æ‹©backend">å¦‚ä½•é€‰æ‹©backend</h2>
<p>There are three ways to configure your backend:</p>
<ul>
<li>The <code>rcParams[&quot;backend&quot;]</code> (default: â€˜aggâ€™) parameter in your matplotlibrc file</li>
<li>The <code>MPLBACKEND</code> environment variable</li>
<li>The function <code>matplotlib.use()</code></li>
</ul>
<p>A more detailed description is given below.</p>
<p>If multiple of these are configurations are present, the last one from the list takes precedence; e.g. calling <code>matplotlib.use()</code> will override the setting in your matplotlibrc.</p>
<p>If no backend is explicitly set, Matplotlib automatically detects a usable backend based on what is available on your system and on whether a GUI event loop is already running. On Linux, if the environment variable <code>DISPLAY</code> is unset, the â€œevent loopâ€ is identified as â€œheadlessâ€, which causes a fallback to a noninteractive backend (agg).</p>
<p>Here is a detailed description of the configuration methods:</p>
<ol>
<li>Setting <code>rcParams[&quot;backend&quot;]</code> (default: â€˜aggâ€™) in your matplotlibrc file:</li>
</ol>
  <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">backend : qt5agg   # use pyqt5 with antigrain (agg) rendering</span><br></pre></td></tr></table></figure>
<p>See also Customizing Matplotlib with style sheets and rcParams.</p>
<ol start="2">
<li>Setting the <code>MPLBACKEND</code> environment variable:</li>
</ol>
<p>You can set the environment variable either for your current shell or for a single script.</p>
<p>On Unix:</p>
  <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt; export MPLBACKEND&#x3D;qt5agg</span><br><span class="line">&gt; python simple_plot.py</span><br><span class="line"></span><br><span class="line">&gt; MPLBACKEND&#x3D;qt5agg python simple_plot.py</span><br></pre></td></tr></table></figure>
<p>On Windows, only the former is possible:</p>
  <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt; set MPLBACKEND&#x3D;qt5agg</span><br><span class="line">&gt; python simple_plot.py</span><br></pre></td></tr></table></figure>
<p>Setting this environment variable will override the backend parameter in any matplotlibrc, even if there is a matplotlibrc in your current working directory. Therefore, setting MPLBACKEND globally, e.g. in your .bashrc or .profile, is discouraged as it might lead to counter-intuitive behavior.</p>
<ol start="3">
<li>If your script depends on a specific backend you can use the function <code>matplotlib.use()</code>:</li>
</ol>
  <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import matplotlib</span><br><span class="line">matplotlib.use(&#39;qt5agg&#39;)</span><br></pre></td></tr></table></figure>
<p>This should be done before any figure is created; otherwise Matplotlib may fail to switch the backend and raise an ImportError.</p>
<p>Using use will require changes in your code if users want to use a different backend. Therefore, you should avoid explicitly calling use unless absolutely necessary.</p>
<h2 id="matplotlib-use-agg-çš„ä½œç”¨">matplotlib.use(â€˜Aggâ€™)çš„ä½œç”¨</h2>
<p>åœ¨ä»‹ç»å®Œæ•´æ•´ä½“çš„matplotlibä¸­çš„backendsä»¥åŠmatplotlibä¸­çš„ç»˜å›¾æ¨¡å¼ä¹‹åï¼Œå°±èƒ½æ˜ç™½ä¸ºä»€ä¹ˆæ–‡ç« å¼€å§‹å‡ºç°çš„è¿ç§»è¿‡ç¨‹ä¸­ä¼šå‡ºç°ç±»ä¼¼çš„é”™è¯¯ã€‚</p>
<p>é¦–å…ˆæ ¹æ®<a href="#matplotlib%E4%B8%ADbackend%E7%9A%84%E9%BB%98%E8%AE%A4%E9%85%8D%E7%BD%AE">matplotlibä¸­backendçš„é»˜è®¤é…ç½®</a>ä¸­çš„ä»‹ç»å¯ä»¥çŸ¥é“ï¼Œmatplotlibä¼šæœ‰ä¸€ä¸ªé»˜è®¤çš„backendé…ç½®ï¼Œå¹¶ä¸”è¯¥é»˜è®¤çš„backendä¼šåŒæ—¶æ”¯æŒäº¤äº’å¼ç»˜å›¾æ¨¡å¼ä»¥åŠåˆ©ç”¨è„šæœ¬ç»˜å›¾çš„æ¨¡å¼ã€‚å¹¶ä¸”ï¼Œäº¤äº’å¼ç»˜å›¾è¿˜éœ€è¦åˆ©ç”¨GUIå·¥å…·æ¥ç”Ÿæˆä¸€ä¸ªå±å¹•ç»˜å›¾çš„çª—å£ã€‚è€Œè¿ç§»çš„Linuxæœºå™¨ä¸Šç¼ºä¹tkinterè¿™æ ·çš„GUIå·¥å…·ï¼Œå› æ­¤åœ¨<code>import matplotlib.pyplot as plt</code>çš„æ—¶å€™ä¼šäº§ç”Ÿé”™è¯¯ã€‚</p>
<p>è€Œåˆ©ç”¨<code>matplotlib.use('Agg')</code>å¯ä»¥åˆ‡æ¢matplotlibçš„backendï¼Œå°†å…¶backendä»é»˜è®¤çš„äº¤äº’å¼æ¨¡å¼åˆ‡æ¢ä¸ºéäº¤äº’å¼æ¨¡å¼ï¼Œæ­¤æ—¶ï¼Œç”Ÿæˆçš„å›¾å½¢ä¼šä»¥å›¾ç‰‡çš„å½¢å¼ä¿å­˜èµ·æ¥ï¼Œè€Œæ— éœ€tkinterè¿™æ ·çš„GUIå·¥å…·çš„æ”¯æŒï¼Œå› æ­¤å¯ä»¥è§£å†³æœ¬æ–‡æœ€å¼€å§‹å‡ºç°çš„é—®é¢˜ã€‚</p>
]]></content>
      <categories>
        <category>matplotlib</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>matplotlib</tag>
        <tag>non-interactive rendering</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½¿ç”¨Wiresharkåˆ†æSRTç›´æ’­æµ</title>
    <url>/2020/04/09/analysize-SRT-protocol-live-stream-with-wireshark/</url>
    <content><![CDATA[<p><a href="https://www.haivision.com/products/srt-secure-reliable-transport/">SRT(Secure Reliable Transport)</a>æ˜¯ä¸€ç§åŸºäº<a href="https://tools.ietf.org/html/draft-gg-udt-03">UDT(UDP-based Data Transfer)</a>çš„ã€å®‰å…¨çš„ã€å¯é çš„ã€å¼€æºçš„æ•°æ®ä¼ è¾“åè®®&amp;æŠ€æœ¯ã€‚SRTåœ¨UDPåŸºç¡€ä¹‹ä¸Šå®ç°äº†ï¼šæ™ºèƒ½æ•°æ®é‡ä¼ æœºåˆ¶å’ŒAES256åŠ å¯†æŠ€æœ¯ï¼Œè¿™ä½¿å¾—å…¶æˆä¸ºä¸€ç§å®‰å…¨ã€å¯é ã€ä½å»¶è¿Ÿçš„ä¼ è¾“æŠ€æœ¯ã€‚åˆ©ç”¨SRTï¼Œå¯ä»¥å®ç°åœ¨ä¸å¯é¢„æµ‹çš„ç½‘ç»œç¯å¢ƒä¸‹ï¼ˆä¾‹å¦‚äº’è”ç½‘ï¼‰é«˜æ•ˆã€å®‰å…¨çš„ä¼ è¾“æ•°æ®ã€‚<a href="https://github.com/Haivision/srt/">SRT</a>è¿˜åšäº†ç‰¹æ®Šä¼˜åŒ–ä»¥é€‚åˆè§†é¢‘å®æ—¶æµæ•°æ®çš„ä¼ è¾“ã€‚æ ¹æ®<a href="https://www.srtalliance.org/srt-alliance-announces-the-addition-of-the-srt-low-latency-protocol-to-open-broadcaster-softwares-obs-studio/">SRT Alliance</a>åœ¨2019-04-04çš„ä»‹ç»ï¼Œç›®å‰å¦‚ä¸‹çš„åº”ç”¨å·²ç»é›†æˆå¹¶æ”¯æŒSRTï¼š<a href="https://obsproject.com/">OBS Studio</a>ï¼Œ<a href="https://www.videolan.org/vlc/">VideoLANâ€™s VLC</a>ï¼Œ<a href="http://ffmpeg.org/">FFmpeg</a>ï¼Œ<a href="https://www.wireshark.org/">Wireshark</a>ã€‚</p>
<p><img src="/2020/04/09/analysize-SRT-protocol-live-stream-with-wireshark/1.png" alt></p>
<span id="more"></span>
<p>æœ¬æ–‡åªä»‹ç»ï¼š<strong>å¦‚ä½•åˆ©ç”¨FFmpegç”ŸæˆSRTæ•°æ®æµå¹¶åˆ©ç”¨Wiresharkå¯¹è¯¥SRTæ•°æ®è¿›è¡ŒæŠ“åŒ…åˆ†æ</strong>ã€‚å…³äºSRTçš„è¯¦ç»†å†…å®¹ï¼Œå¯ä»¥å‚è€ƒ<a href="https://github.com/Haivision/srt/files/2489142/SRT_Protocol_TechnicalOverview_DRAFT_2018-10-17.pdf">SRT Protocol Technical Overview Draft</a>ã€‚</p>
<h2 id="å‰æœŸå‡†å¤‡">å‰æœŸå‡†å¤‡</h2>
<ol>
<li>
<p>æŒ‰ç…§<a href="https://github.com/Haivision/srt/blob/master/README.md">è¯´æ˜</a>å®‰è£…SRT</p>
</li>
<li>
<p>åˆ©ç”¨<code>./configure --enable-libsrt</code>é‡æ–°ç¼–è¯‘FFmpegï¼Œè®©ffmpegå·¥å…·é›†æ”¯æŒSRTåè®®ã€‚é‡æ–°configureçš„è¿‡ç¨‹å¦‚æœé‡åˆ°<code>ERROR: srt &gt;= 1.3.0 not found using pkg-config</code>çš„é”™è¯¯ï¼Œå¯ä»¥æŸ¥çœ‹<code>ffbuild/config.log</code>çš„ç›¸å…³ä¿¡æ¯ï¼Œä¸€èˆ¬éœ€è¦æŠŠsrtå’Œsrtæ‰€ä¾èµ–çš„opensslçš„<strong>pkgconfig</strong>è·¯å¾„å¢åŠ åˆ°<code>PKG_CONFIG_PATH</code>ç¯å¢ƒå˜é‡ä¸­å³å¯ã€‚</p>
</li>
<li>
<p>å‡çº§Wiresharkåˆ°3.0ä¹‹åçš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”è®¾ç½®Wiresharkå–æ¶ˆWiresharkå¯¹UDTåè®®çš„æ”¯æŒï¼Œå…·ä½“åšæ³•ä¸ºï¼šç‚¹å‡»èœå•æ ä¸­çš„<code>Analyze</code>-&gt;<code>Enabled Protocols</code>ï¼Œç„¶åä»å¼¹å‡ºçš„æ”¯æŒåè®®ä¸­æ‰¾åˆ°UDTï¼Œå¹¶å–æ¶ˆUDTå‰é¢çš„é€‰æ‹©æ ‡è®°ã€‚</p>
<p><img src="/2020/04/09/analysize-SRT-protocol-live-stream-with-wireshark/2.jpg" alt></p>
</li>
<li>
<p>å®‰è£…VLCæ’­æ”¾å™¨ï¼Œç”¨äºæ’­æ”¾SRTåè®®çš„è§†é¢‘æµã€‚</p>
</li>
</ol>
<h2 id="ç”Ÿæˆsrtç›´æ’­æµ">ç”ŸæˆSRTç›´æ’­æµ</h2>
<p>å¯ä»¥åˆ©ç”¨<code>ffmpeg</code>å’Œ<code>srt-live-transmit</code>ï¼ˆè¯¥å·¥å…·åœ¨å®‰è£…srtçš„æ—¶å€™ä¼šé»˜è®¤å®‰è£…ï¼‰æ¥ç”ŸæˆSRTç›´æ’­æµã€‚ä¸»è¦æ€è·¯æ˜¯é¦–å…ˆåˆ©ç”¨<code>ffmpeg</code>ç”ŸæˆUDPçš„ç›´æ’­æµï¼Œç„¶ååˆ©ç”¨<code>srt-live-transmit</code>æŠŠUDPçš„ç›´æ’­æµè½¬æ¢æˆSRTçš„ç›´æ’­æµï¼Œæ›´è¯¦ç»†çš„æ–¹å¼å¯ä»¥å‚è€ƒ<a href="https://github.com/Haivision/srt/blob/master/docs/srt-live-transmit.md">srt-live-transmitçš„ä½¿ç”¨è¯´æ˜</a>ã€‚</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> ç”ŸæˆUDPè§†é¢‘æµ</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> ffmpeg -f lavfi -re -i smptebars=duration=300:size=1280x720:rate=30 \</span></span><br><span class="line"><span class="bash">-f lavfi -re -i sine=frequency=1000:duration=60:sample_rate=44100 \</span></span><br><span class="line"><span class="bash">-pix_fmt yuv420p -c:v libx264 -b:v 1000k -g 30 -keyint_min 120 \</span></span><br><span class="line"><span class="bash">-profile:v baseline -preset veryfast -f mpegts \</span></span><br><span class="line"><span class="bash"><span class="string">&quot;udp://127.0.0.1:5000?pkt_size=1316&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> ç”ŸæˆSRTè§†é¢‘æµ</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> srt-live-transmit -s:10 udp://:5000 srt://:5001</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> ä½¿ç”¨ffplayæ’­æ”¾SRTè§†é¢‘æµ</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> ffplay <span class="string">&quot;srt://127.0.0.1:5001&quot;</span></span></span><br></pre></td></tr></table></figure>
<p>å…·ä½“æ’­æ”¾æ•ˆæœå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="/2020/04/09/analysize-SRT-protocol-live-stream-with-wireshark/3.jpg" alt></p>
<h2 id="ä½¿ç”¨wiresharkåˆ†æsrt">ä½¿ç”¨Wiresharkåˆ†æSRT</h2>
<p>ä¸ºäº†å¯ä»¥ç”¨WiresharkæŠ“åˆ°SRTæ•°æ®åŒ…ï¼Œéœ€è¦ä½¿ç”¨VLCæ’­æ”¾å™¨æ¥æ‰“å¼€åˆšæ‰åˆ›å»ºçš„SRTè§†é¢‘æµï¼Œå…·ä½“å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="/2020/04/09/analysize-SRT-protocol-live-stream-with-wireshark/4.jpg" alt></p>
<p>æ‰“å¼€Wiresharkï¼Œé€‰æ‹©Lookbackï¼ˆå› ä¸ºè¦æ•è·çš„SRTåœ°å€ä¸º127.0.0.1ï¼‰ï¼Œç„¶ååœ¨æ•è·çš„æ•°æ®çª—å£é€‰æ‹©srtåè®®è¿‡æ»¤ï¼Œç¨ç­‰ç‰‡åˆ»å°±å¯ä»¥çœ‹åˆ°æ•è·çš„SRTæ•°æ®åŒ…ï¼Œå…·ä½“å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="/2020/04/09/analysize-SRT-protocol-live-stream-with-wireshark/5.jpg" alt></p>
<p>æ¥ä¸‹æ¥å°±å¯ä»¥åˆ©ç”¨Wiresharkæ¥åˆ†æSRTåè®®çš„å¤„ç†æµç¨‹ï¼Œä¾‹å¦‚ä¸Šå›¾ä¸­çš„Handshakeæ•°æ®åŒ…ã€‚å°¤å…¶æ˜¯åœ¨å­¦ä¹ çš„è¿‡ç¨‹ä¸­ï¼Œé…åˆ<a href="https://github.com/Haivision/srt/files/2489142/SRT_Protocol_TechnicalOverview_DRAFT_2018-10-17.pdf">SRTçš„åè®®æ–‡æ¡£</a>ä»¥åŠWiresharkçš„æŠ“åŒ…åˆ†æï¼Œèƒ½å¤ŸåŠ æ·±å¯¹SRTåè®®çš„ç†è§£ï¼Œè¾¾åˆ°äº‹åŠåŠŸå€çš„æ•ˆæœã€‚</p>
]]></content>
      <categories>
        <category>è§†é¢‘æŠ€æœ¯</category>
      </categories>
      <tags>
        <tag>Wireshark</tag>
        <tag>SRT</tag>
        <tag>ç½‘ç»œåè®®åˆ†æ</tag>
      </tags>
  </entry>
  <entry>
    <title>macOS Catalinaçš„stripç‰ˆæœ¬å¼‚å¸¸å¯¼è‡´ç¼–è¯‘çš„FFmpegè¿è¡Œè¢«kill</title>
    <url>/2020/04/08/ffmpeg-compiled-in-macOS-Catalina-runs-crash/</url>
    <content><![CDATA[<p>å› ä¸ºè¿‘æœŸæ­£åœ¨è°ƒç ”&amp;äº†è§£<a href="https://github.com/Haivision/srt">SRTåè®®</a>çš„ç›¸å…³å†…å®¹ï¼Œä¸ºäº†æ–¹ä¾¿ï¼Œéœ€è¦æ‰“å¼€FFmpegçš„<code>--enable-libsrt</code>åŠŸèƒ½å¹¶é‡æ–°ç¼–è¯‘FFmpegï¼Œä»è€Œä¿è¯FFmpegæ”¯æŒSRTåè®®ã€‚ä½†æ˜¯é‡æ–°ç¼–è¯‘ä¹‹åå´å‘ç°å¯åŠ¨ffmpegå·¥å…·å°±ä¼šè¢«å†…æ ¸æ€æ­»ï¼Œå…·ä½“å¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<p><img src="/2020/04/08/ffmpeg-compiled-in-macOS-Catalina-runs-crash/1.jpg" alt></p>
<span id="more"></span>
<p>åˆ©ç”¨<em>lldb</em>è°ƒè¯•è¯¥<em>ffmpeg</em>å‘ç°ç›´æ¥æç¤º<code>error: Malformed Mach-o file</code>çš„é”™è¯¯ï¼Œå…·ä½“å¦‚ä¸‹ï¼š</p>
<p><img src="/2020/04/08/ffmpeg-compiled-in-macOS-Catalina-runs-crash/2.jpg" alt></p>
<p>ç¼–è¯‘å¼‚å¸¸çš„Macç‰ˆæœ¬å’ŒXcodeç‰ˆæœ¬ä¿¡æ¯åˆ†åˆ«å¦‚ä¸‹ï¼š</p>
<p><img src="/2020/04/08/ffmpeg-compiled-in-macOS-Catalina-runs-crash/3.jpg" alt></p>
<p>æŸ¥é˜…äº†<a href="https://trac.ffmpeg.org/ticket/8073">ç½‘ä¸Šçš„èµ„æ–™</a>ï¼Œä¹ŸæŸ¥çœ‹äº†<a href="https://github.com/Homebrew/homebrew-core/blob/master/Formula/ffmpeg.rb">brewç¼–è¯‘FFmpegçš„æŒ‡ä»¤</a>ï¼ŒåŸå› å¯èƒ½æ˜¯ï¼š<strong>Xcode11ä¸‹clangé»˜è®¤å¼€å¯-fstack-check</strong>ã€‚</p>
<p>åŒæ—¶ï¼Œåœ¨å¦‚ä¸‹å›¾æ‰€ç¤ºçš„Xcode 10.3ç‰ˆæœ¬çš„Macä¸Šåˆ™å¯ç¼–è¯‘æˆåŠŸï¼š</p>
<p><img src="/2020/04/08/ffmpeg-compiled-in-macOS-Catalina-runs-crash/4.jpg" alt></p>
<p>å› æ­¤æ ¹æ®å¦‚ä¸Šä¿¡æ¯ï¼š<code>./configure</code>æ—¶éœ€è¦å¢åŠ <code>--host-cflags=-fno-stack-check</code>é…ç½®ã€‚</p>
<p>ä½†æ˜¯å¢åŠ è¯¥é…ç½®ä¹‹åï¼Œç¼–è¯‘å‡ºçš„ffmpegä¾ç„¶æ— æ³•æ­£å¸¸è¿è¡Œã€‚</p>
<h2 id="å‘ç°åŸå› ">å‘ç°åŸå› </h2>
<p><strong>æ°å¥½æœ€è¿‘å‡çº§äº†ç³»ç»Ÿå’ŒXcodeç‰ˆæœ¬ï¼Œæƒ³ç€å†ç¼–è¯‘ä¸€ä¸‹çœ‹ä¸‹æ˜¯å¦å¯ç”¨ï¼Œç»ˆäºæœ‰äº†æ–°çš„å‘ç°ã€‚</strong></p>
<p>ç¼–è¯‘çš„ç³»ç»Ÿç‰ˆæœ¬å’ŒXcodeç‰ˆæœ¬å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="/2020/04/08/ffmpeg-compiled-in-macOS-Catalina-runs-crash/5.jpg" alt></p>
<p>ç¼–è¯‘å‘½ä»¤å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"> .&#x2F;configure --enable-shared --enable-pthreads --enable-version3 --enable-avresample \</span><br><span class="line">--cc&#x3D;clang --host-cflags&#x3D; --host-ldflags&#x3D; --enable-ffplay --enable-gnutls --enable-gpl \</span><br><span class="line">--enable-libaom --enable-libbluray --enable-libmp3lame --enable-libopus \</span><br><span class="line">--enable-librubberband --enable-libsnappy --enable-libtesseract --enable-libtheora \</span><br><span class="line">--enable-libvidstab --enable-libvorbis --enable-libvpx --enable-libwebp --enable-libx264 \</span><br><span class="line">--enable-libx265 --enable-libxvid --enable-lzma --enable-libfontconfig --enable-libfreetype \</span><br><span class="line">--enable-frei0r --enable-libass --enable-libopencore-amrnb --enable-libopencore-amrwb \</span><br><span class="line">--enable-libopenjpeg --enable-librtmp --enable-libspeex --enable-libsoxr \</span><br><span class="line">--enable-videotoolbox --disable-libjack --disable-indev&#x3D;jack</span><br></pre></td></tr></table></figure>
<p>ç¼–è¯‘ä¹‹åï¼ŒæƒŠå–œçš„å‘ç°ï¼Œè™½ç„¶<code>ffprobe</code>å‘½ä»¤ä¾æ—§å¼‚å¸¸ï¼Œä½†æ˜¯<code>ffprobe_g</code>å‘½ä»¤å·²ç»å¯ä»¥ä½¿ç”¨äº†ã€‚å…·ä½“å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="/2020/04/08/ffmpeg-compiled-in-macOS-Catalina-runs-crash/6.jpg" alt></p>
<p><code>ffprobe</code>å’Œ<code>ffprobe_g</code>çš„ä¸åŒå°±æ˜¯<code>ffprobe_g</code>ä¼šåŒ…å«è°ƒè¯•ä¿¡æ¯ã€‚</p>
<p>å›é¡¾ç¼–è¯‘æŒ‡ä»¤çš„æœ€åå‡ æ¡æŒ‡ä»¤ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">LD ffmpeg_g</span><br><span class="line">LD ffprobe_g</span><br><span class="line">LD ffplay_g</span><br><span class="line">STRIP ffmpeg</span><br><span class="line">STRIP ffprobe</span><br><span class="line">STRIP ffplay</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥å‘ç°ï¼Œåœ¨ç¼–è¯‘çš„æœ€åï¼Œä½¿ç”¨<code>strip</code>å‘½ä»¤ï¼Œå»æ‰äº†<code>ffprobe</code>ä¸­çš„è°ƒè¯•ä¿¡æ¯ã€‚é‚£ä¹ˆæ˜¯å¦æ˜¯<code>strip</code>å‘½ä»¤æœ‰é—®é¢˜å‘¢ï¼Ÿ</p>
<p>å¸¦ç€è¿™ä¸ªç–‘é—®ï¼Œå†™äº†ä¸€æ®µæµ‹è¯•ä»£ç <code>test.cpp</code>ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;Hello World!&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨<code>clang++</code>ç¼–è¯‘å¹¶å¯¹æ¯”åˆ©ç”¨<code>strip</code>å‘½ä»¤å»æ‰è°ƒè¯•ä¿¡æ¯å‰åçš„è¿è¡Œç»“æœï¼Œç»ˆäºå‘ç°äº†é—®é¢˜æ‰€åœ¨ï¼š</p>
<p><img src="/2020/04/08/ffmpeg-compiled-in-macOS-Catalina-runs-crash/7.jpg" alt></p>
<p>è‡³æ­¤ï¼Œç»ˆäºæ‰¾åˆ°åŸå› ï¼š<code>strip</code>å‘½ä»¤ç”Ÿæˆçš„æ— è°ƒè¯•ä¿¡æ¯çš„å¯æ‰§è¡Œç¨‹åºï¼Œä¼šå‘ç”Ÿ<code>Malformed Mach-o file</code>çš„ç°è±¡ã€‚</p>
<h2 id="ä¿®æ­£stripç‰ˆæœ¬">ä¿®æ­£stripç‰ˆæœ¬</h2>
<p>æ€€ç–‘æœºå™¨ä¸Šçš„<code>strip</code>ç‰ˆæœ¬å¼‚å¸¸å¯¼è‡´å»æ‰è°ƒè¯•ä¿¡æ¯åçš„å¯æ‰§è¡Œæ–‡ä»¶å‡ºç°å¼‚å¸¸ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ which strip</span><br><span class="line">&#x2F;usr&#x2F;local&#x2F;opt&#x2F;binutils&#x2F;bin&#x2F;strip</span><br><span class="line">$ which clang++</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;clang++</span><br><span class="line">$ ls &#x2F;usr&#x2F;bin&#x2F;strip</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;strip</span><br><span class="line">$ &#x2F;usr&#x2F;bin&#x2F;strip -x a.out</span><br><span class="line">$ .&#x2F;a.out</span><br><span class="line">Hello World!</span><br></pre></td></tr></table></figure>
<p>ç»è¿‡å¦‚ä¸Šçš„è¿‡ç¨‹å‘ç°ï¼Œç¡®å®æ˜¯<code>strip</code>çš„ç‰ˆæœ¬æœ‰é—®é¢˜ï¼Œåˆ©ç”¨<code>/usr/bin/strip</code>ç”Ÿæˆçš„æ— è°ƒè¯•ä¿¡æ¯çš„å¯æ‰§è¡Œç¨‹åºæ˜¯æ­£å¸¸çš„ã€‚</p>
<h2 id="é—®é¢˜è§£å†³">é—®é¢˜è§£å†³</h2>
<p>åœ¨ç¼–è¯‘ffmpegæ—¶ï¼Œåˆ©ç”¨<code>--strip</code>é€‰é¡¹æ¥æŒ‡å®š<code>strip</code>çš„ç‰ˆæœ¬ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"> .&#x2F;configure --enable-shared --enable-pthreads --enable-version3 --enable-avresample \</span><br><span class="line">--cc&#x3D;clang --host-cflags&#x3D; --host-ldflags&#x3D; --enable-ffplay --enable-gnutls --enable-gpl \</span><br><span class="line">--enable-libaom --enable-libbluray --enable-libmp3lame --enable-libopus \</span><br><span class="line">--enable-librubberband --enable-libsnappy --enable-libtesseract --enable-libtheora \</span><br><span class="line">--enable-libvidstab --enable-libvorbis --enable-libvpx --enable-libwebp --enable-libx264 \</span><br><span class="line">--enable-libx265 --enable-libxvid --enable-lzma --enable-libfontconfig --enable-libfreetype \</span><br><span class="line">--enable-frei0r --enable-libass --enable-libopencore-amrnb --enable-libopencore-amrwb \</span><br><span class="line">--enable-libopenjpeg --enable-librtmp --enable-libspeex --enable-libsoxr \</span><br><span class="line">--enable-videotoolbox --disable-libjack --disable-indev&#x3D;jack \</span><br><span class="line">--strip&#x3D;&#x2F;usr&#x2F;bin&#x2F;strip</span><br></pre></td></tr></table></figure>
<p>å¤§åŠŸå‘Šæˆï¼Œé—®é¢˜è§£å†³ï¼Œå…·ä½“å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="/2020/04/08/ffmpeg-compiled-in-macOS-Catalina-runs-crash/8.jpg" alt></p>
]]></content>
      <categories>
        <category>è§†é¢‘æŠ€æœ¯</category>
      </categories>
      <tags>
        <tag>FFmpeg</tag>
        <tag>ç¼–è¯‘</tag>
        <tag>macOS Catalina</tag>
        <tag>strip</tag>
      </tags>
  </entry>
  <entry>
    <title>Androidç¯å¢ƒä¸‹ç¼–è¯‘libyuv</title>
    <url>/2020/03/30/compile-libyuv-for-Android/</url>
    <content><![CDATA[<p>libyuvæ˜¯Googleå¼€æºçš„å®ç°å„ç§YUVæ ¼å¼ä¸RGBæ ¼å¼ä¹‹é—´ç›¸äº’è½¬æ¢ã€æ—‹è½¬ã€ç¼©æ”¾çš„åº“ã€‚å…³äºlibyuvçš„å…·ä½“ä»‹ç»å¯ä»¥å‚è€ƒ<a href="https://chromium.googlesource.com/libyuv/libyuv">å®˜ç½‘ä»‹ç»</a>ã€‚</p>
<span id="more"></span>
<h2 id="android-studioç¼–è¯‘libyuv">Android Studioç¼–è¯‘libyuv</h2>
<p>åœ¨è‡ªå·±ç¼–è¯‘libyuvçš„è¿‡ç¨‹ä¸­ï¼Œé‡åˆ°äº†å¾ˆå¤šå‘ã€‚åœ¨è§£å†³è¿™äº›å‘çš„è¿‡ç¨‹ä¸­å‘ç°ï¼Œä»ç½‘ä¸ŠæŸ¥è¯¢çš„å¾ˆå¤šèµ„æ–™å¹¶æ²¡æœ‰å¯¹é—®é¢˜çš„è§£å†³æä¾›å¸®åŠ©ã€‚å› æ­¤ï¼Œåœ¨è‡ªå·±è¶Ÿè¿‡äº†æ‰€æœ‰çš„å‘ä¹‹åï¼Œå°±æƒ³æŠŠç¼–è¯‘libyuvçš„è¿‡ç¨‹æ•´ç†äº†å‡ºæ¥ï¼Œä¸€æ–¹é¢æ˜¯åšä¸€ä¸ªæ¢³ç†å’Œæ€»ç»“ï¼Œå¦ä¸€æ–¹é¢ä¹Ÿå¸Œæœ›å¸®åŠ©æ›´å¤šæœ‰ç±»ä¼¼éœ€æ±‚çš„äººã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œå¼€å§‹ä»‹ç»åœ¨Androidå¹³å°ä¸Šï¼Œåˆ©ç”¨NKDç¼–è¯‘åŒ…å«libjpegåº“çš„libyuvåº“ã€‚è¿™ä¸ªä¸»è¦é€šè¿‡<a href="https://chromium.googlesource.com/libyuv/libyuv/+/refs/heads/master/Android.mk">libyuv/Android.mk</a>ä¸­çš„å¦‚ä¸‹ä»£ç å®ç°ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">include $(CLEAR_VARS)</span><br><span class="line"></span><br><span class="line">LOCAL_WHOLE_STATIC_LIBRARIES :&#x3D; libyuv_static</span><br><span class="line">LOCAL_MODULE :&#x3D; libyuv</span><br><span class="line">ifneq ($(LIBYUV_DISABLE_JPEG), &quot;yes&quot;)</span><br><span class="line">LOCAL_SHARED_LIBRARIES :&#x3D; jpeg</span><br><span class="line">endif</span><br><span class="line"></span><br><span class="line">include $(BUILD_SHARED_LIBRARY)</span><br></pre></td></tr></table></figure>
<h2 id="éœ€è¦ä¸‹è½½çš„åº“">éœ€è¦ä¸‹è½½çš„åº“</h2>
<ul>
<li><a href="https://chromium.googlesource.com/libyuv/libyuv">libyuv</a>æˆ–è€…<a href="https//github.com/lemenkov/libyuv.git">libyuv</a></li>
<li><a href="https://github.com/libjpeg-turbo/libjpeg-turbo.git">libjpeg-turbo</a></li>
</ul>
<h2 id="ç¼–è¯‘ä¾èµ–">ç¼–è¯‘ä¾èµ–</h2>
<h3 id="ndk">NDK</h3>
<p>å› ä¸ºNDK-r17ä¹‹åçš„ç‰ˆæœ¬ï¼Œä¸æ”¯æŒgccç¼–è¯‘soï¼Œéœ€è¦ä½¿ç”¨clangæ¥ç¼–è¯‘soåº“ã€‚å› æ­¤ç¼–è¯‘æ—¶ï¼Œéœ€è¦ç¡®å®šå¥½è‡ªå·±çš„NDKç‰ˆæœ¬ã€‚</p>
<h3 id="cmake-nasm-gccç­‰">CMAKE, NASM, GCCç­‰</h3>
<p>è¯¥éƒ¨åˆ†ç¼–è¯‘ä¾èµ–ä¸ºç¼–è¯‘libjpeg-turboåº“çš„ç¼–è¯‘ä¾èµ–ï¼Œå…·ä½“å¯ä»¥å‚è§libjpeg-turboçš„<a href="https://github.com/libjpeg-turbo/libjpeg-turbo/blob/master/BUILDING.md">BUILD.md</a></p>
<h2 id="ç¼–è¯‘libjpeg-turbo">ç¼–è¯‘libjpeg-turbo</h2>
<ol>
<li>
<p>ä¸‹è½½ç¼–è¯‘è„šæœ¬ï¼Œç¼–è¯‘è„šæœ¬ä½äº<a href="https://github.com/wangwei1237/libyuv-with-jpeg/tree/master/libjpeg-turbo">libjpeg-turbo</a>ç›®å½•ä¸‹ï¼Œå…±è®¡æœ‰ä¸‰ä¸ªè„šæœ¬ï¼š</p>
<ol>
<li><a href="http://config.sh">config.sh</a>ï¼šé…ç½®ç¼–è¯‘å‚æ•°ï¼Œä¾‹å¦‚ANDROID_NDK_ROOTç­‰ï¼Œéœ€è¦æ ¹æ®è‡ªå·±çš„ç¯å¢ƒå˜é‡è¿›è¡Œæ›¿æ¢ã€‚</li>
<li>build_jpeg.shï¼šç¼–è¯‘æŸä¸ªCPUæ¶æ„çš„soåº“ï¼Œè¯¥è„šæœ¬ä¸­çš„å˜é‡ä¸€èˆ¬ä¸éœ€è¦ä¿®æ”¹ã€‚</li>
<li>build_jpeg_all.shï¼šç¼–è¯‘æ‰€æœ‰CPUæ¶æ„çš„soåº“</li>
</ol>
</li>
<li>
<p>ä¸‹è½½<a href="https://github.com/libjpeg-turbo/libjpeg-turbo">libjpeg-turbo</a>æºç ï¼š<code>git clone https://github.com/libjpeg-turbo/libjpeg-turbo.git</code>ã€‚</p>
</li>
<li>
<p>å°†ç¬¬<em>1</em>æ­¥ä¸­ä¸‹è½½åˆ°çš„ä¸‰ä¸ªæ–‡ä»¶å¤åˆ¶åˆ°libjepg-turobæºç çš„æ ¹ç›®å½•ä¸‹ï¼š<code>cp -r libjpeg-turbo/* JPEG_SRC_ROOT_PATH/</code>ã€‚</p>
</li>
<li>
<p>ä¿®æ”¹<em><a href="http://config.sh">config.sh</a></em>ä¸­çš„<code>ANDROID_NDK_ROOT</code>ä¸ºè‡ªå·±çš„NDKè·¯å¾„ï¼Œä¿®æ”¹<code>ANDROID_NDK_VERSION</code>ä¸ºå¯¹åº”çš„æ•°å­—ç‰ˆæœ¬ã€‚ä¾‹å¦‚<em>r16b</em>ç‰ˆæœ¬çš„ä¸º<code>ANDROID_NDK_VERSION=16</code>ã€‚</p>
</li>
<li>
<p>è¿è¡Œ<code>sh build_jpeg_all.sh</code>ç¼–è¯‘libjpeg-turboï¼Œè¿è¡Œä¹‹åä¼šåœ¨å½“å‰ç›®å½•çš„<em>libs</em>ç›®å½•ä¸‹ç”Ÿæˆå„ç§CPUæ¶æ„å¯¹åº”çš„soåº“ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="/2020/03/30/compile-libyuv-for-Android/1.jpg" alt="å›¾1. libjpeg-turboç¼–è¯‘äº§ç‰©"></p>
</li>
</ol>
<h2 id="ç¼–è¯‘libyuv">ç¼–è¯‘libyuv</h2>
<ol>
<li>
<p>å°†ä¹‹å‰ä¸‹è½½çš„libyuvçš„æºç å¯¼å…¥åˆ°Android Studioä¸­çš„æŒ‡å®šç›®å½•ï¼šPROJECT/app/jni/libyuv,è¯¥ç›®å½•è‡ªå·±å®šä¹‰å°±å¯ä»¥ã€‚</p>
</li>
<li>
<p>å°†ä¸Šä¸€æ­¥ç”Ÿæˆçš„soæ–‡ä»¶æŒ‰ç…§ABIçš„æ ¼å¼å¤åˆ¶åˆ°libyuv/libsç›®å½•ä¸‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="/2020/03/30/compile-libyuv-for-Android/2.png" alt="å›¾2"></p>
</li>
<li>
<p>ä¿®æ”¹libyuvç›®å½•ä¸‹çš„Android.mkæ–‡ä»¶ï¼Œ<a href="https://github.com/wangwei1237/libyuv-with-jpeg/blob/master/myapp/jni/libyuv/Android.mk">libyuv/Android.mk</a>æ–‡ä»¶ä¸­çš„ç¬¬4~12è¡Œçš„å†…å®¹å³å¯ã€‚</p>
 <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">########################################################</span><br><span class="line">## &#123;&#123;BEGIN å¢åŠ å¦‚ä¸‹çš„ä»£ç </span><br><span class="line">include $(CLEAR_VARS)</span><br><span class="line">LOCAL_MODULE :&#x3D; jpeg</span><br><span class="line">LOCAL_SRC_FILES :&#x3D; libs&#x2F;$(TARGET_ARCH_ABI)&#x2F;libjpeg.so</span><br><span class="line">LOCAL_EXPORT_C_INCLUDES :&#x3D; $(LOCAL_PATH)&#x2F;include</span><br><span class="line">include $(PREBUILT_SHARED_LIBRARY)</span><br><span class="line">## END&#125;&#125;</span><br><span class="line">########################################################</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>æŒ‰ç…§<a href="https://github.com/wangwei1237/libyuv-with-jpeg">ä»“åº“</a>æ‰€ç¤ºçš„<a href="https://github.com/wangwei1237/libyuv-with-jpeg/tree/master/myapp/jni">myapp/jni</a>ç›®å½•ä¸‹çš„<em><a href="http://Android.mk">Android.mk</a></em>å’Œ<em><a href="http://Application.mk">Application.mk</a></em>æ–‡ä»¶ä¿®æ”¹è‡ªå·±ä»£ç ä¸­çš„å¯¹åº”æ–‡ä»¶å³å¯ï¼Œä¸»è¦æ˜¯ç”¨äºç¼–è¯‘libyuvä½¿ç”¨ã€‚</p>
</li>
<li>
<p>ä¿®æ”¹è‡ªå·±appç›®å½•ä¸‹çš„<a href="https://github.com/wangwei1237/libyuv-with-jpeg/blob/master/myapp/build.gradle">build.gradle</a>ï¼Œåœ¨android{}ä¸­å¢åŠ å¦‚ä¸‹ç¼–è¯‘ä»»åŠ¡</p>
 <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">externalNativeBuild &#123;</span><br><span class="line">    ndkBuild &#123;</span><br><span class="line">        path file(&#39;jni&#x2F;Android.mk&#39;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>ç‚¹å‡»Android Studioçš„ç¼–è¯‘æŒ‰é’®ç¼–è¯‘å³å¯ï¼Œç¼–è¯‘åç”Ÿæˆçš„ç¼–è¯‘äº§ç‰©å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="/2020/03/30/compile-libyuv-for-Android/3.jpg" alt="å›¾3. libyuvçš„ç¼–è¯‘äº§ç‰©"></p>
</li>
</ol>
]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>libyuv</tag>
      </tags>
  </entry>
  <entry>
    <title>å›¾åƒé‡‘å­—å¡”ç®€ä»‹</title>
    <url>/2020/03/18/introduction-to-image-pyramid/</url>
    <content><![CDATA[<h1>å›¾åƒé‡‘å­—å¡”</h1>
<h2 id="å›¾åƒé‡‘å­—å¡”çš„æ¦‚å¿µ">å›¾åƒé‡‘å­—å¡”çš„æ¦‚å¿µ</h2>
<p>ä¸€èˆ¬è€Œè¨€ï¼Œæˆ‘ä»¬å¤„ç†çš„å›¾åƒé€šå¸¸æ˜¯æ’å®šå¤§å°ï¼ˆåˆ†è¾¨ç‡ï¼‰çš„å›¾åƒã€‚ä½†æ˜¯åœ¨æŸäº›ç‰¹æ®Šçš„åœºæ™¯ä¸‹ï¼Œéœ€è¦å¤„ç†åŒä¸€å›¾åƒçš„ä¸åŒåˆ†è¾¨ç‡çš„å›¾åƒã€‚ä¾‹å¦‚ï¼Œåœ¨å›¾åƒä¸­æœç´¢æŸäº›å†…å®¹æ—¶ï¼ˆä¾‹å¦‚é¢éƒ¨ï¼‰ï¼Œç”±äºä¸ç¡®å®šå¾…æœç´¢çš„å†…å®¹åœ¨å›¾åƒä¸­çš„åŒºåŸŸå¤§å°ï¼Œå› æ­¤éœ€è¦åˆ›å»ºä¸€ä¸ªå…·æœ‰ä¸åŒåˆ†è¾¨ç‡çš„å›¾åƒé›†ï¼Œå¹¶åœ¨è¯¥å›¾åƒé›†çš„æ‰€æœ‰å›¾åƒä¸­æ‰§è¡Œæœç´¢æ“ä½œã€‚</p>
<p>è¿™äº›å…·æœ‰ä¸åŒåˆ†è¾¨ç‡çš„å›¾åƒé›†ç§°ä¸ºâ€œå›¾åƒé‡‘å­—å¡”â€ã€‚ä¹‹æ‰€ä»¥ç§°å…¶ä¸ºâ€œå›¾åƒé‡‘å­—å¡”â€ï¼Œæ˜¯å› ä¸ºå½“è¿™äº›å›¾åƒæŒ‰ç…§åˆ†è¾¨ç‡ç”±ä½åˆ°é«˜å †å åœ¨ä¸€èµ·æ—¶ï¼Œåº•éƒ¨çš„æœ€å¤§å›¾åƒå’Œé¡¶éƒ¨çš„æœ€å°å›¾åƒçœ‹èµ·æ¥å°±åƒæ˜¯ä¸€åº§é‡‘å­—å¡”ã€‚</p>
<span id="more"></span>
<p>å› æ­¤ï¼Œå›¾åƒé‡‘å­—å¡”æ˜¯å›¾åƒçš„é›†åˆï¼Œè¿™äº›å›¾åƒé›†åˆç”±å•ä¸ªåŸå§‹å›¾åƒé€šè¿‡è¿ç»­çš„é™é‡‡æ ·â€”â€”ç›´åˆ°è¾¾åˆ°æŸä¸ªæœŸæœ›çš„æš‚åœç‚¹ä¸ºæ­¢â€”â€”äº§ç”Ÿã€‚</p>
<p><img src="/2020/03/18/introduction-to-image-pyramid/1.jpg" alt></p>
<h2 id="å›¾åƒé‡‘å­—å¡”çš„åˆ†ç±»">å›¾åƒé‡‘å­—å¡”çš„åˆ†ç±»</h2>
<p>åº”ç”¨ä¸­ç»å¸¸ç”¨åˆ°çš„å›¾åƒé‡‘å­—å¡”ä¸»è¦æœ‰ä¸¤ç§ï¼š</p>
<ul>
<li>é«˜æ–¯é‡‘å­—å¡”</li>
<li>æ‹‰æ™®æ‹‰æ–¯é‡‘å­—å¡”</li>
</ul>
<p>é«˜æ–¯é‡‘å­—å¡”ä¸€èˆ¬ç”¨äºå›¾åƒçš„é™é‡‡æ ·ï¼Œè€Œæ‹‰æ™®æ‹‰æ–¯é‡‘å­—å¡”åˆ™ç”¨äºé€šè¿‡å›¾åƒé‡‘å­—å¡”ä¸­çš„ä½åˆ†è¾¨ç‡å›¾åƒé‡æ„é«˜åˆ†ç‡å›¾åƒçš„å›¾åƒä¸Šé‡‡æ ·ã€‚</p>
<h3 id="é«˜æ–¯é‡‘å­—å¡”">é«˜æ–¯é‡‘å­—å¡”</h3>
<p>é«˜æ–¯é‡‘å­—å¡”ä¸­çš„ä½åˆ†è¾¨ç‡å›¾åƒæ˜¯é€šè¿‡åˆ é™¤é«˜åˆ†è¾¨ç‡å›¾åƒä¸­çš„è¡Œå’Œåˆ—è€Œäº§ç”Ÿï¼Œå…·ä½“å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<ul>
<li>ä»¤é«˜æ–¯é‡‘å­—å¡”ä¸­ç¬¬<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span>å±‚çš„å›¾åƒä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>G</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">G_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
<li>ä½¿ç”¨ä¸€ä¸ªé«˜æ–¯æ ¸å¯¹<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>G</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">G_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>æ‰§è¡Œå·ç§¯æ“ä½œå¾—åˆ°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>G</mi><mi>i</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msubsup></mrow><annotation encoding="application/x-tex">G_i^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.010556em;vertical-align:-0.258664em;"></span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-2.441336em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.258664em;"><span></span></span></span></span></span></span></span></span></span></li>
<li>ç„¶ååˆ é™¤<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>G</mi><mi>i</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msubsup></mrow><annotation encoding="application/x-tex">G_i^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.010556em;vertical-align:-0.258664em;"></span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-2.441336em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.258664em;"><span></span></span></span></span></span></span></span></span></span>ä¸­çš„å¶æ•°è¡Œå’Œå¶æ•°åˆ—ï¼Œå¾—åˆ°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>G</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">G_{i+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span></li>
</ul>
<p>æ ¹æ®å¦‚ä¸Šçš„æ­¥éª¤ï¼Œå¯ä»¥çŸ¥é“ï¼Œç¬¬<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.74285em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>çº§å›¾åƒçš„åˆ†è¾¨ç‡æ˜¯ç¬¬<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span>çº§å›¾åƒçš„åˆ†è¾¨ç‡çš„<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mn>4</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{1}{4}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>ã€‚</p>
<h4 id="pyrdown">pyrDown</h4>
<p>åœ¨OpenCVä¸­ï¼Œå¯ä»¥ä½¿ç”¨<code>cv2.pyrDown()</code>ç”Ÿæˆå›¾åƒçš„ä¸Šä¸€å±‚çº§å›¾åƒã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">higher_resolution = cv2.imread(<span class="string">&#x27;img.jpg&#x27;</span>)</span><br><span class="line">lower_resolution  = cv2.pyrDown(higher_resolution)</span><br></pre></td></tr></table></figure>
<p>ä¸‹å›¾æ˜¯ä¸€ä¸ª4çº§çš„é«˜æ–¯é‡‘å­—å¡”çš„ä¾‹å­ã€‚<br>
<img src="/2020/03/18/introduction-to-image-pyramid/2.jpg" alt></p>
<h4 id="pyrup">pyrUp</h4>
<p>æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨<code>cv2.pyrUp()</code>å°†å›¾åƒè½¬æ¢ä¸ºæ¯ä¸ªæ–¹å‘ä¸¤å€å¤§å°çš„å›¾åƒï¼Œè¯¥å‡½æ•°</p>
<ul>
<li>é¦–å…ˆå°†å›¾åƒçš„å¤§å°åœ¨å„ä¸ªç»´åº¦ä¸Šæ‰©å±•2å€</li>
<li>ç„¶åå¯¹æ–°å¢çš„è¡Œç”¨0è¿›è¡Œå¡«å……</li>
<li>æœ€åå†ä½¿ç”¨é«˜æ–¯æ»¤æ³¢å™¨æ‰§è¡Œå·ç§¯è®¡ç®—æ¥è·å–â€œä¸¢å¤±â€çš„åƒç´ çš„å€¼</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">higher_resolution_2 = cv2.pyrUp(lower_resolution)</span><br></pre></td></tr></table></figure>
<p>ä»å¦‚ä¸Šçš„æ­¥éª¤ä¸éš¾å‘ç°ï¼Œ<code>cv2.pyrUp()</code>å¹¶ä¸æ˜¯<code>cv2.pyrDown()</code>çš„é€†è¿ç®—ï¼Œå› ä¸º<code>cv2.pyrDown()</code>æ˜¯ä¸€ä¸ªä¸¢å¤±ä¿¡æ¯çš„æ“ä½œï¼Œä¸€æ—¦åˆ†è¾¨ç‡é™ä½ï¼Œå°±ä¼šå­˜åœ¨ä¿¡æ¯ä¸¢å¤±ã€‚</p>
<p>å› æ­¤ï¼Œåœ¨ç¤ºä¾‹ä»£ç ä¸­ï¼Œ<code>higher_resolution_2</code>å’Œ<code>higher_resolution</code>æ˜¯ä¸åŒçš„ã€‚</p>
<p>å¯¹<a href="#pyrDown">pyrDown</a>ä¸­çš„å›¾åƒæ‰§è¡Œ<code>pyrUp()</code>æ•ˆæœå¦‚ä¸‹æ‰€ç¤ºï¼š<br>
<img src="/2020/03/18/introduction-to-image-pyramid/3.jpg" alt></p>
<h3 id="æ‹‰æ™®æ‹‰æ–¯é‡‘å­—å¡”">æ‹‰æ™®æ‹‰æ–¯é‡‘å­—å¡”</h3>
<p>ä¸ºäº†ä»å›¾åƒé‡‘å­—å¡”ä¸­çš„ä½åˆ†è¾¨ç‡å›¾åƒæ¢å¤é«˜åˆ†è¾¨ç‡çš„å›¾åƒï¼Œéœ€è¦ä½¿ç”¨ä¸‹é‡‡æ ·è¿‡ç¨‹ä¸­ä¸¢å¼ƒçš„ä¿¡æ¯ã€‚è€Œè¿™äº›æ•°æ®åˆ™æ„æˆäº†æ‹‰æ™®æ‹‰æ–¯é‡‘å­—å¡”ã€‚</p>
<p>ä»¤<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">L_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ä¸ºé«˜æ–¯é‡‘å­—å¡”çš„ç¬¬<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span>çº§å›¾åƒ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>G</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">G_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ä¸‹é‡‡æ ·å¾—åˆ°ç¬¬<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.74285em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>çº§å›¾åƒ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>G</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">G_{i+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span>æ—¶ä¸¢å¤±çš„ä¿¡æ¯ï¼Œåˆ™ï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>i</mi></msub><mo>=</mo><msub><mi>G</mi><mi>i</mi></msub><mo>âˆ’</mo><mi>c</mi><mi>v</mi><mn>2.</mn><mi>p</mi><mi>y</mi><mi>r</mi><mi>U</mi><mi>p</mi><mo stretchy="false">(</mo><msub><mi>G</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">L_i=G_i - cv2.pyrUp(G_{i+1})
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord">2</span><span class="mord">.</span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace linebreak="newline"></mspace><mrow><msub><mi>L</mi><mi>i</mi></msub><mi mathvariant="normal">âˆ£</mi><mi>i</mi><mo>âˆˆ</mo><mn>1...</mn><mi>n</mi><mspace linebreak="newline"></mspace></mrow></mrow><annotation encoding="application/x-tex">\\{L_i | i \in 1...n\\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">âˆ£</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord mathdefault">n</span><span class="mspace newline"></span></span></span></span></span>åˆ™æ„æˆæ‹‰æ™®æ‹‰æ–¯é‡‘å­—å¡”ã€‚</p>
<p>æ‹‰æ™®æ‹‰æ–¯é‡‘å­—å¡”ç”±é«˜æ–¯é‡‘å­—å¡”è€Œå½¢æˆï¼Œå¹¶æ²¡æœ‰å…¶å®ƒçš„é¢å¤–åŠŸèƒ½ï¼Œå¹¶ä¸”æ‹‰æ™®æ‹‰æ–¯é‡‘å­—å¡”å›¾åƒå’Œå›¾åƒçš„è¾¹ç¼˜å›¾åƒå¾ˆåƒã€‚åœ¨æ‹‰æ™®æ‹‰æ–¯é‡‘å­—å¡”ä¸­çš„å›¾åƒçš„å¤§å¤šæ•°å…ƒç´ ä¸ºé›¶ã€‚ä¸€ä¸ª4çº§æ‹‰æ™®æ‹‰æ–¯é‡‘å­—å¡”çš„å›¾åƒå¦‚ä¸‹æ‰€ç¤ºï¼ˆå·²è°ƒæ•´å›¾åƒçš„æ›å…‰åº¦ä»¥å¢å¼ºå›¾åƒå†…å®¹ï¼‰ï¼š<br>
<img src="/2020/03/18/introduction-to-image-pyramid/4.jpg" alt></p>
<h2 id="å°ºåº¦ç©ºé—´å’Œå›¾åƒé‡‘å­—å¡”å·ç§¯æ ¸çš„é€‰æ‹©">å°ºåº¦ç©ºé—´å’Œå›¾åƒé‡‘å­—å¡”å·ç§¯æ ¸çš„é€‰æ‹©</h2>
<p>åœ¨ç°å®ä¸–ç•Œä¸­ï¼Œå®¢è§‚ç‰©ä½“åœ¨ä¸åŒå°ºåº¦æ—¶æœ‰ç€ä¸åŒçš„ç»“æ„ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœä»ä¸åŒçš„å°ºåº¦å»è§‚å¯ŸåŒä¸€ä¸ªç‰©ä½“ï¼Œä¼šå¾—å‡ºä¸ä¸€æ ·çš„ç»“æœã€‚ä¾‹å¦‚ï¼Œä»ä¸åŒçš„è·ç¦»è§‚å¯ŸåŒä¸€ä¸ªå›¾åƒæ—¶ï¼Œéšç€è·ç¦»çš„ä¸æ–­ç¼©å°ï¼Œèƒ½å¤Ÿè§‚å¯Ÿåˆ°çš„å›¾åƒçš„ç»“æ„ä¹Ÿæœ‰æ‰€ä¸åŒã€‚</p>
<p>è§‚å¯Ÿä¸€æ£µæ ‘çš„å°ºåº¦å’Œè§‚å¯Ÿä¸€ç‰‡æ ‘å¶çš„å°ºåº¦ä¹Ÿæ˜¯ä¸åŒçš„ï¼šè§‚å¯Ÿä¸€æ£µæ ‘çš„é€‚å½“å°ºåº¦åº”è¯¥æ˜¯<strong>ç±³</strong>ï¼Œè€Œè§‚å¯Ÿä¸€ç‰‡å¶å­å¯èƒ½éœ€è¦æ›´ç»†ç²’åº¦çš„å°ºåº¦æ‰èƒ½å¾—å‡ºè¾ƒå¥½çš„ç»“æœã€‚</p>
<p>å½“è®¡ç®—æœºç³»ç»Ÿè¦å¯¹ä¸€ä¸ªæœªçŸ¥çš„åœºæ™¯è¿›è¡Œåˆ†ææ—¶ï¼Œå¹¶ä¸èƒ½æå‰é¢„çŸ¥ç”¨ä»€ä¹ˆæ ·çš„å°ºåº¦æ¥æè¿°å›¾åƒä¿¡æ¯ä¸­çš„<strong>interesting structures</strong>æ˜¯æœ€åˆé€‚çš„ã€‚å› æ­¤ï¼Œå”¯ä¸€å¯è¡Œçš„æ–¹æ¡ˆå°±æ˜¯å°†å¤šä¸ªä¸åŒå°ºåº¦çš„æè¿°éƒ½è€ƒè™‘è¿›æ¥ï¼Œä»¥ä¾¿æ•è·æœªçŸ¥çš„å°ºåº¦å˜åŒ–ã€‚</p>
<p>å°ºåº¦ç©ºé—´ç†è®ºå’Œç”Ÿç‰©è§†è§‰ä¹‹é—´ä¹Ÿæœ‰ç€ååˆ†å¯†åˆ‡çš„è”ç³»ã€‚å“ºä¹³åŠ¨ç‰©çš„è§†ç½‘è†œä»¥åŠè§†è§‰çš®å±‚ç¬¬ä¸€é˜¶æ®µæ‰€è®°å½•çš„æ¥å—åœºçš„åˆ†å¸ƒï¼Œä¸è®¸å¤šå°ºåº¦ç©ºé—´æ“ä½œéƒ½é«˜åº¦è¿‘ä¼¼ã€‚</p>
<p>å¦‚<a href="#%E9%AB%98%E6%96%AF%E9%87%91%E5%AD%97%E5%A1%94">é«˜æ–¯é‡‘å­—å¡”</a>çš„æè¿°ï¼Œåœ¨ç”Ÿæˆé«˜æ–¯é‡‘å­—å¡”æ—¶ï¼Œä¼šé‡‡ç”¨é«˜æ–¯æ ¸(<em>filter</em>)å¯¹å›¾åƒè¿›è¡Œå¤„ç†ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆéè¦é‡‡ç”¨é«˜æ–¯æ ¸å‘¢ï¼Ÿ</p>
<p>å®é™…ä¸Šï¼Œå¹¶éä»»ä½•ä½é€šæ»¤æ³¢å™¨ï¼ˆ<em>low-pass filter</em>ï¼‰éƒ½å¯ç”¨äºç”Ÿæˆå°ºåº¦ç©ºé—´ã€‚å¯ç”¨äºç”Ÿæˆå°ºåº¦ç©ºé—´çš„filterå¿…é¡»æ»¡è¶³å¦‚ä¸‹çš„æ¡ä»¶ï¼š</p>
<blockquote>
<p>ç”±è¯¥å¹³æ»‘filterç”Ÿæˆçš„ç²—å°ºåº¦å›¾åƒï¼ˆé«˜å±‚å›¾åƒï¼‰ä¸ä¼šå¼•å…¥ä¸å­˜åœ¨äºç»†å°ºåº¦å›¾åƒï¼ˆä½å±‚å›¾åƒï¼‰ä¸­çš„æ‚æ•£ç»“æ„ã€‚</p>
</blockquote>
<p>å¦‚ä¸Šçš„æ¡ä»¶çš„è¨€å¤–ä¹‹æ„å°±æ˜¯ï¼šç»™å®šç²—å°ºåº¦å›¾åƒä¸­çš„ä»»ä½•ä¸€ä¸ªåŒºåŸŸï¼Œç»†å°ºåº¦å›¾åƒä¸Šæ€»èƒ½æ‰¾åˆ°ç›¸åº”çš„åŒºåŸŸã€‚å¯¹è¿™ä¸¤ä¸ªåŒºåŸŸè€Œè¨€ï¼Œç²—å°ºåº¦å›¾åƒåŒºåŸŸä¸èƒ½æœ‰æ–°çš„ç»“æ„ã€‚</p>
<p>å—åˆ¶äº<a href="https://en.wikipedia.org/wiki/Scale-space_axioms">å°ºåº¦ç©ºé—´å…¬ç†</a>ï¼Œé«˜æ–¯å·ç§¯æ ¸æ˜¯å®ç°å°ºåº¦å˜æ¢çš„å”¯ä¸€çº¿æ€§æ ¸ã€‚å› æ­¤ï¼Œåœ¨å›¾åƒé‡‘å­—å¡”ä¸­ï¼Œéœ€è¦é‡‡ç”¨é«˜æ–¯å·ç§¯æ ¸å¯¹å›¾åƒè¿›è¡Œå¤„ç†ã€‚</p>
<p><a href="https://en.wikipedia.org/wiki/Scale-space_axioms">å°ºåº¦ç©ºé—´å…¬ç†</a>éœ€è¦æ»¡è¶³å¦‚ä¸‹çš„æ¡ä»¶ï¼š</p>
<ul>
<li>çº¿æ€§</li>
<li>å¹³ç§»ä¸å˜æ€§</li>
<li>åŠç¾¤ç‰¹æ€§</li>
<li>æ—‹è½¬ä¸å˜æ€§</li>
<li>å°ºåº¦ä¸å˜æ€§</li>
<li>æ­£å®šæ€§</li>
<li>æ­£è§„æ€§(ç§¯åˆ†ä¸º1)</li>
<li>ä¸ä¼šå¼•å…¥æ–°çš„æç‚¹</li>
<li>ä¸ä¼šå¢å¼ºæç‚¹</li>
<li>å­˜åœ¨æ— ç©·å°çš„ç®—å­ï¼ˆå¯å¾®æ€§ï¼‰</li>
</ul>
<h2 id="å›¾åƒé‡‘å­—å¡”çš„åº”ç”¨">å›¾åƒé‡‘å­—å¡”çš„åº”ç”¨</h2>
<p>å›¾åƒé‡‘å­—å¡”çš„ä¸€ç§åº”ç”¨æ˜¯å›¾åƒèåˆã€‚ä¾‹å¦‚ï¼Œåœ¨å›¾åƒæ‹¼æ¥ä¸­ä¼šå°†ä¸¤ä¸ªå›¾åƒå †å ï¼Œä½†æ˜¯ç”±äºå›¾åƒä¹‹é—´çš„ä¸è¿ç»­æ€§ï¼Œè¿™ç§å¯¹åŸå§‹å›¾åƒçš„ç›´æ¥æ‹¼æ¥çš„æ•ˆæœå¹¶ä¸å¥½ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯¹å¦‚ä¸‹å›¾æ‰€ç¤ºçš„ä¸¤å¹…å›¾åƒï¼š</p>
<p><img src="/2020/03/18/introduction-to-image-pyramid/5.jpg" alt></p>
<p>çš„ç›´æ¥æ‹¼æ¥æ•ˆæœå’Œé‡‡ç”¨å›¾åƒé‡‘å­—å¡”æ‹¼æ¥æ•ˆæœåˆ†åˆ«ä¸ºï¼ˆå·¦å›¾ä¸ºç›´æ¥æ‹¼æ¥ï¼‰ï¼š</p>
<p><img src="/2020/03/18/introduction-to-image-pyramid/8.jpg" alt></p>
<p>ç”±æ­¤å¯ä»¥çœ‹å‡ºï¼Œä½¿ç”¨â€œå›¾åƒé‡‘å­—å¡”â€èåˆå›¾åƒåˆ™å¯ä»¥è®©æ‹¼æ¥ä¹‹åçš„å›¾åƒçœ‹èµ·æ¥å¤©è¡£æ— ç¼ã€‚</p>
<p>å¯ä»¥æŒ‰ç…§å¦‚ä¸‹çš„æ­¥éª¤ä½¿ç”¨â€œå›¾åƒé‡‘å­—å¡”â€æ¥æ‹¼æ¥å¦‚ä¸Šçš„å›¾åƒï¼ˆ<a href="https://gitee.com/wangwei1237/wangwei1237/blob/master/2020/03/18/introduction-to-image-pyramid/image_pyramid_blend.ipynb">ç©è½¬å¤šå°ºåº¦å›¾åƒèåˆ</a>)ï¼š</p>
<ol>
<li>åŠ è½½å›¾åƒ</li>
<li>è®¡ç®—å›¾åƒçš„é«˜æ–¯é‡‘å­—å¡”ï¼ˆåœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œçº§æ•°ä¸º6ï¼‰</li>
<li>ä»é«˜æ–¯é‡‘å­—å¡”ä¸­è®¡ç®—æ‹‰æ™®æ‹‰æ–¯é‡‘å­—å¡”</li>
<li>åœ¨æ¯ä¸ªæ‹‰æ™®æ‹‰æ–¯é‡‘å­—å¡”ä¸­åŠ å…¥è‹¹æœçš„å·¦åŠéƒ¨åˆ†å’Œæ©™å­çš„å³åŠéƒ¨åˆ†</li>
<li>æœ€åï¼Œä»è”åˆå›¾åƒé‡‘å­—å¡”ä¸­é‡å»ºåŸå§‹å›¾åƒ</li>
</ol>
<p>é™¤äº†å¦‚ä¸Šçš„<strong>å¤šåˆ†è¾¨ç‡å›¾åƒèåˆç®—æ³•ä¼šç”¨åˆ°å›¾åƒé‡‘å­—å¡”</strong>ä¹‹å¤–ï¼Œå›¾åƒé‡‘å­—å¡”è¿˜å¯ç”¨äºå¦‚ä¸‹çš„åœºæ™¯ï¼š</p>
<ul>
<li>siftç®—æ³•</li>
<li>åœ¨from coarse to fineç”±ç²—åˆ°ç²¾çš„æœç´¢ç­–ç•¥ä¸­éƒ½å¯ä»¥ç”¨é‡‘å­—å¡”</li>
<li>optical flowå…‰æµæ³•</li>
<li>slamå½“ä¸­çš„å§¿æ€ä¼°è®¡</li>
<li>â€¦â€¦</li>
</ul>
]]></content>
      <categories>
        <category>è§†è§‰æŠ€æœ¯</category>
      </categories>
      <tags>
        <tag>å›¾åƒé‡‘å­—å¡”</tag>
        <tag>é«˜æ–¯é‡‘å­—å¡”</tag>
        <tag>æ‹‰æ™®æ‹‰æ–¯é‡‘å­—å¡”</tag>
        <tag>image pyramid</tag>
      </tags>
  </entry>
  <entry>
    <title>æ•°å­—è§†é¢‘åŸºæœ¬æ¦‚å¿µ</title>
    <url>/2020/03/03/digital-video-concept/</url>
    <content><![CDATA[<p>åœ¨å­¦ä¹ å’Œç ”ç©¶è§†é¢‘æŠ€æœ¯çš„è¿‡ç¨‹ä¸­ï¼Œè”åˆå‡ ä¸ªåŒäº‹ä¸€èµ·ç¿»è¯‘äº†<a href="https://link.springer.com/book/10.1007/978-1-4302-6713-3">Digital Video Concepts, Methods, and Metrics: Quality, Compression, Performance, and Power Trade-off Analysis</a>ï¼Œå½¢æˆäº†<a href="/digital-video-concept"><strong>æ•°å­—è§†é¢‘æ¦‚å¿µï¼Œæ–¹æ³•å’Œæµ‹é‡æŒ‡æ ‡ï¼šè´¨é‡ï¼Œå‹ç¼©ï¼Œæ€§èƒ½å’Œç”µé‡ç­‰çš„æƒè¡¡åˆ†æï¼ˆä¸­æ–‡ç‰ˆï¼‰</strong></a>ã€‚è¯¥ç¿»è¯‘ç‰ˆæœ¬ä»…ä¾›å­¦ä¹ äº¤æµä¹‹ç”¨ã€‚å¸Œæœ›å¯¹æƒ³å­¦ä¹ å’Œäº†è§£æ•°å­—è§†é¢‘ç›¸å…³æŠ€æœ¯çš„åŒå­¦ï¼Œæœ‰æ‰€å¸®åŠ©ã€‚</p>
<p>åœ¨ç¿»è¯‘çš„è¿‡ç¨‹ä¸­ï¼Œå°½å¯èƒ½çš„ä¿ç•™äº†åŸä¹¦çš„å†…å®¹ï¼Œå¹¶ä¸”å¯¹åŸä¹¦ä¸­çš„ä¸ªåˆ«å†…å®¹è¿›è¡Œäº†ä¿®æ­£å’Œè¡¥å……ã€‚</p>
<span id="more"></span>
<p><img src="/digital-video-concept/images/cover_0.jpg" alt></p>
<p>è¯¥ä¹¦åœ¨ç¿»è¯‘çš„è¿‡ç¨‹ä¸­é‡‡ç”¨gitbookæ–¹å¼ç¼–å†™ï¼Œå¯ä»¥åˆ©ç”¨gitbookå°†è¯¥é¡¹ç›®æ‰“åŒ…æˆé™æ€ç½‘é¡µæ ¼å¼æˆ–è€…PDF<br>
æ ¼å¼ï¼Œå…·ä½“å¯ä»¥å‚è§ï¼š<a href="https://einverne.github.io/gitbook-tutorial/output/static.html">gitbookæ•™ç¨‹</a>ã€‚</p>
<p>é¡¹ç›®ä¸»é¡µåœ°å€ï¼š<a href="https://github.com/wangwei1237/digital_video_concepts.git">githubä»“åº“</a></p>
<p>åœ¨çº¿é¢„è§ˆåœ°å€ï¼š<a href="https://wangwei1237.gitee.io/digital-video-concept">é¢„è§ˆåœ°å€1</a>, <a href="https://wangwei1237.github.io/digital-video-concept">é¢„è§ˆåœ°å€2</a>, <a href="https://wangwei1237.gitbook.io/digital_video_concepts">é¢„è§ˆåœ°å€3</a></p>
<p>åœ¨é˜…è¯»è¿‡ç¨‹ä¸­æœ‰ä»»ä½•æ„è§æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨githubä¸Šæäº¤issueï¼Œæˆ‘ä»¬ä¹Ÿä¼šå¿«é€Ÿè·Ÿè¿›ã€‚</p>
]]></content>
      <categories>
        <category>è§†é¢‘æŠ€æœ¯</category>
      </categories>
      <tags>
        <tag>æ•°å­—è§†é¢‘</tag>
        <tag>èä¹¦</tag>
        <tag>digital video</tag>
        <tag>è§†é¢‘åŸºç¡€çŸ¥è¯†</tag>
      </tags>
  </entry>
  <entry>
    <title>æ•°å­—è§†é¢‘æŠ€æœ¯å¯¼è®º</title>
    <url>/2020/02/28/Introduction-to-digital-video-technology/</url>
    <content><![CDATA[<h1>èƒŒæ™¯</h1>
<p>å› ä¸ºå·¥ä½œå…³ç³»éœ€è¦äº†è§£æ•°å­—è§†é¢‘ç›¸å…³æŠ€æœ¯ï¼Œåœ¨å­¦ä¹ çš„è¿‡ç¨‹ä¸­æ‰¾åˆ°äº†è¿™ä»½æ‰˜ç®¡åœ¨githubä¸Šçš„<strong>æ•°å­—è§†é¢‘å¯¼è®º</strong>çš„ææ–™ã€‚</p>
<p>è¿™ä»½ææ–™ä»‹ç»äº†åŸºæœ¬çš„æ•°å­—è§†é¢‘ç›¸å…³æŠ€æœ¯ï¼Œè¨€ç®€æ„èµ…ä½†åˆä¸æ¯ç‡¥æ— å‘³ï¼Œå³æœ‰ç†è®ºåˆæœ‰ä¸°å¯Œçš„å®è·µæ“ä½œï¼Œåœ¨æˆ‘å­¦ä¹ çš„æ‰€æœ‰ææ–™ä¸­ç®—æ˜¯æ¯”è¾ƒä¸Šä¹˜çš„ææ–™ã€‚</p>
<p>åŸºäºå¦‚ä¸Šçš„åŸå› ï¼Œå°†è¯¥ææ–™çš„ç›¸å…³å†…å®¹è½¬è½½åˆ°æ­¤å¤„ã€‚å¤§å®¶å¯ä»¥ç›´æ¥è®¿é—®è¯¥ææ–™çš„githubä»“åº“<a href="https://github.com/leandromoreira/digital_video_introduction"><strong>digital_video_introduction</strong></a>è·å–ç›¸å…³å†…å®¹ã€‚å¦‚ä¸‹çš„æ‰€æœ‰å†…å®¹çš†æ¥è‡ª<a href="https://github.com/leandromoreira/digital_video_introduction"><strong>digital_video_introduction</strong></a>ï¼Œç‰¹æ­¤æ ‡æ³¨ã€‚</p>
<p><a href="license-BSD--3--Clause-blue.svg"><img src="/2020/02/28/Introduction-to-digital-video-technology/license-BSD--3--Clause-blue.svg" alt="license"></a></p>
<span id="more"></span>
<h1>ä»‹ç»</h1>
<p>è¿™æ˜¯ä¸€ä»½å¾ªåºæ¸è¿›çš„è§†é¢‘æŠ€æœ¯çš„ä»‹ç»ã€‚å°½ç®¡å®ƒé¢å‘çš„æ˜¯è½¯ä»¶å¼€å‘äººå‘˜/å·¥ç¨‹å¸ˆï¼Œä½†æˆ‘ä»¬å¸Œæœ›<strong>å¯¹ä»»ä½•äººè€Œè¨€</strong>ï¼Œè¿™ä»½æ–‡æ¡£éƒ½èƒ½ç®€å•æ˜“å­¦ã€‚è¿™ä¸ªç‚¹å­äº§ç”Ÿäºä¸€ä¸ª<a href="https://docs.google.com/presentation/d/17Z31kEkl_NGJ0M66reqr9_uTG6tI5EDDVXpdPKVuIrs/edit#slide=id.p">è§†é¢‘æŠ€æœ¯æ–°æ‰‹å°å‹ç ”è®¨ä¼š</a>æœŸé—´ã€‚</p>
<p>æœ¬æ–‡æ¡£æ—¨åœ¨å°½å¯èƒ½ä½¿ç”¨<strong>æµ…æ˜¾çš„è¯è¯­ï¼Œä¸°å¯Œçš„å›¾åƒå’Œå®é™…ä¾‹å­</strong>ä»‹ç»æ•°å­—è§†é¢‘æ¦‚å¿µï¼Œä½¿è¿™äº›çŸ¥è¯†èƒ½é€‚ç”¨äºå„ç§åœºåˆã€‚ä½ å¯ä»¥éšæ—¶åé¦ˆæ„è§æˆ–å»ºè®®ï¼Œä»¥æ”¹è¿›è¿™ç¯‡æ–‡æ¡£ã€‚</p>
<h1>ç›®å½•</h1>
<ul>
<li><a href="#%E4%BB%8B%E7%BB%8D">ä»‹ç»</a></li>
<li><a href="#%E7%9B%AE%E5%BD%95">ç›®å½•</a></li>
<li><a href="#%E5%9F%BA%E6%9C%AC%E6%9C%AF%E8%AF%AD">åŸºæœ¬æœ¯è¯­</a>
<ul>
<li><a href="#%E7%BC%96%E7%A0%81%E5%BD%A9%E8%89%B2%E5%9B%BE%E5%83%8F%E7%9A%84%E5%85%B6%E5%AE%83%E6%96%B9%E6%B3%95">ç¼–ç å½©è‰²å›¾åƒçš„å…¶å®ƒæ–¹æ³•</a></li>
<li><a href="#%E8%87%AA%E5%B7%B1%E5%8A%A8%E6%89%8B%EF%BC%9A%E7%8E%A9%E8%BD%AC%E5%9B%BE%E5%83%8F%E5%92%8C%E9%A2%9C%E8%89%B2">è‡ªå·±åŠ¨æ‰‹ï¼šç©è½¬å›¾åƒå’Œé¢œè‰²</a></li>
<li><a href="#DVD-%E7%9A%84-DAR-%E6%98%AF-4-3">DVD çš„ DAR æ˜¯ 4:3</a></li>
<li><a href="#%E8%87%AA%E5%B7%B1%E5%8A%A8%E6%89%8B%EF%BC%9A%E6%A3%80%E6%9F%A5%E8%A7%86%E9%A2%91%E5%B1%9E%E6%80%A7">è‡ªå·±åŠ¨æ‰‹ï¼šæ£€æŸ¥è§†é¢‘å±æ€§</a></li>
</ul>
</li>
<li><a href="#%E6%B6%88%E9%99%A4%E5%86%97%E4%BD%99">æ¶ˆé™¤å†—ä½™</a>
<ul>
<li><a href="#%E9%A2%9C%E8%89%B2%EF%BC%8C%E4%BA%AE%E5%BA%A6%E5%92%8C%E6%88%91%E4%BB%AC%E7%9A%84%E7%9C%BC%E7%9D%9B">é¢œè‰²ï¼Œäº®åº¦å’Œæˆ‘ä»¬çš„çœ¼ç›</a>
<ul>
<li><a href="#%E9%A2%9C%E8%89%B2%E6%A8%A1%E5%9E%8B">é¢œè‰²æ¨¡å‹</a></li>
<li><a href="#YCbCr-%E5%92%8C-RGB-%E4%B9%8B%E9%97%B4%E7%9A%84%E8%BD%AC%E6%8D%A2">YCbCr å’Œ RGB ä¹‹é—´çš„è½¬æ¢</a></li>
<li><a href="#%E8%89%B2%E5%BA%A6%E5%AD%90%E9%87%87%E6%A0%B7">è‰²åº¦å­é‡‡æ ·</a></li>
<li><a href="#%E8%87%AA%E5%B7%B1%E5%8A%A8%E6%89%8B%EF%BC%9A%E6%A3%80%E6%9F%A5-YCbCr-%E7%9B%B4%E6%96%B9%E5%9B%BE">è‡ªå·±åŠ¨æ‰‹ï¼šæ£€æŸ¥ YCbCr ç›´æ–¹å›¾</a></li>
</ul>
</li>
<li><a href="#%E5%B8%A7%E7%B1%BB%E5%9E%8B">å¸§ç±»å‹</a>
<ul>
<li><a href="#I-%E5%B8%A7%EF%BC%88%E5%B8%A7%E5%86%85%E7%BC%96%E7%A0%81%EF%BC%8C%E5%85%B3%E9%94%AE%E5%B8%A7%EF%BC%89">I å¸§ï¼ˆå†…éƒ¨ï¼Œå…³é”®å¸§ï¼‰</a></li>
<li><a href="#P-%E5%B8%A7%EF%BC%88%E9%A2%84%E6%B5%8B%EF%BC%89">P å¸§ï¼ˆé¢„æµ‹ï¼‰</a>
<ul>
<li><a href="#%E8%87%AA%E5%B7%B1%E5%8A%A8%E6%89%8B%EF%BC%9A%E5%85%B7%E6%9C%89%E5%8D%95%E4%B8%AA-I-%E5%B8%A7%E7%9A%84%E8%A7%86%E9%A2%91">è‡ªå·±åŠ¨æ‰‹ï¼šå…·æœ‰å•ä¸ª I å¸§çš„è§†é¢‘</a></li>
</ul>
</li>
<li><a href="#B-%E5%B8%A7%EF%BC%88%E5%8F%8C%E5%90%91%E9%A2%84%E6%B5%8B%EF%BC%89">B å¸§ï¼ˆåŒå‘é¢„æµ‹ï¼‰</a>
<ul>
<li><a href="#%E8%87%AA%E5%B7%B1%E5%8A%A8%E6%89%8B%EF%BC%9A%E4%BD%BF%E7%94%A8-B-%E5%B8%A7%E6%AF%94%E8%BE%83%E8%A7%86%E9%A2%91">è‡ªå·±åŠ¨æ‰‹ï¼šä½¿ç”¨ B å¸§æ¯”è¾ƒè§†é¢‘</a></li>
</ul>
</li>
<li><a href="#%E5%B0%8F%E7%BB%93">å°ç»“</a></li>
</ul>
</li>
<li><a href="#%E6%97%B6%E9%97%B4%E5%86%97%E4%BD%99%EF%BC%88%E5%B8%A7%E9%97%B4%E9%A2%84%E6%B5%8B%EF%BC%89">æ—¶é—´å†—ä½™ï¼ˆå¸§é—´é¢„æµ‹ï¼‰</a>
<ul>
<li><a href="#%E8%87%AA%E5%B7%B1%E5%8A%A8%E6%89%8B%EF%BC%9A%E6%9F%A5%E7%9C%8B%E8%BF%90%E5%8A%A8%E5%90%91%E9%87%8F">è‡ªå·±åŠ¨æ‰‹ï¼šæŸ¥çœ‹è¿åŠ¨å‘é‡</a></li>
</ul>
</li>
<li><a href="#%E7%A9%BA%E9%97%B4%E5%86%97%E4%BD%99%EF%BC%88%E5%B8%A7%E5%86%85%E9%A2%84%E6%B5%8B%EF%BC%89">ç©ºé—´å†—ä½™ï¼ˆå¸§å†…é¢„æµ‹ï¼‰</a>
<ul>
<li><a href="#%E8%87%AA%E5%B7%B1%E5%8A%A8%E6%89%8B%EF%BC%9A%E6%9F%A5%E7%9C%8B%E5%B8%A7%E5%86%85%E9%A2%84%E6%B5%8B">è‡ªå·±åŠ¨æ‰‹ï¼šæŸ¥çœ‹å¸§å†…é¢„æµ‹</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E8%A7%86%E9%A2%91%E7%BC%96%E8%A7%A3%E7%A0%81%E5%99%A8%E6%98%AF%E5%A6%82%E4%BD%95%E5%B7%A5%E4%BD%9C%E7%9A%84%EF%BC%9F">è§†é¢‘ç¼–è§£ç å™¨æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ</a>
<ul>
<li><a href="#%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F%E4%B8%BA%E4%BB%80%E4%B9%88%EF%BC%9F%E6%80%8E%E4%B9%88%E5%81%9A%EF%BC%9F">æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆï¼Ÿæ€ä¹ˆåšï¼Ÿ</a></li>
<li><a href="#%E5%8E%86%E5%8F%B2">å†å²</a>
<ul>
<li><a href="#AV1-%E7%9A%84%E8%AF%9E%E7%94%9F">AV1 çš„è¯ç”Ÿ</a></li>
</ul>
</li>
<li><a href="#%E9%80%9A%E7%94%A8%E7%BC%96%E8%A7%A3%E7%A0%81%E5%99%A8">é€šç”¨ç¼–è§£ç å™¨</a></li>
<li><a href="#%E7%AC%AC%E4%B8%80%E6%AD%A5-%E5%9B%BE%E7%89%87%E5%88%86%E5%8C%BA">ç¬¬ä¸€æ­¥ - å›¾ç‰‡åˆ†åŒº</a>
<ul>
<li><a href="#%E8%87%AA%E5%B7%B1%E5%8A%A8%E6%89%8B%EF%BC%9A%E6%9F%A5%E7%9C%8B%E5%88%86%E5%8C%BA">è‡ªå·±åŠ¨æ‰‹ï¼šæŸ¥çœ‹åˆ†åŒº</a></li>
</ul>
</li>
<li><a href="#%E7%AC%AC%E4%BA%8C%E6%AD%A5-%E9%A2%84%E6%B5%8B">ç¬¬äºŒæ­¥ - é¢„æµ‹</a></li>
<li><a href="#%E7%AC%AC%E4%B8%89%E6%AD%A5-%E8%BD%AC%E6%8D%A2">ç¬¬ä¸‰æ­¥ - è½¬æ¢</a>
<ul>
<li><a href="#%E8%87%AA%E5%B7%B1%E5%8A%A8%E6%89%8B%EF%BC%9A%E4%B8%A2%E5%BC%83%E4%B8%8D%E5%90%8C%E7%9A%84%E7%B3%BB%E6%95%B0">è‡ªå·±åŠ¨æ‰‹ï¼šä¸¢å¼ƒä¸åŒçš„ç³»æ•°</a></li>
</ul>
</li>
<li><a href="#%E7%AC%AC%E5%9B%9B%E6%AD%A5-%E9%87%8F%E5%8C%96">ç¬¬å››æ­¥ - é‡åŒ–</a>
<ul>
<li><a href="#%E8%87%AA%E5%B7%B1%E5%8A%A8%E6%89%8B%EF%BC%9A%E9%87%8F%E5%8C%96">è‡ªå·±åŠ¨æ‰‹ï¼šé‡åŒ–</a></li>
</ul>
</li>
<li><a href="#%E7%AC%AC%E4%BA%94%E6%AD%A5-%E7%86%B5%E7%BC%96%E7%A0%81">ç¬¬äº”æ­¥ - ç†µç¼–ç </a>
<ul>
<li><a href="#VLC-%E7%BC%96%E7%A0%81%EF%BC%9A">VLC ç¼–ç </a></li>
<li><a href="#%E7%AE%97%E6%9C%AF%E7%BC%96%E7%A0%81">ç®—æœ¯ç¼–ç </a></li>
<li><a href="#%E8%87%AA%E5%B7%B1%E5%8A%A8%E6%89%8B%EF%BC%9ACABAC-vs-CAVLC">è‡ªå·±åŠ¨æ‰‹ï¼šCABAC vs CAVLC</a></li>
</ul>
</li>
<li><a href="#%E7%AC%AC%E5%85%AD%E6%AD%A5-%E6%AF%94%E7%89%B9%E6%B5%81%E6%A0%BC%E5%BC%8F">ç¬¬å…­æ­¥ - æ¯”ç‰¹æµæ ¼å¼</a>
<ul>
<li><a href="#H-264-%E6%AF%94%E7%89%B9%E6%B5%81">H.264 æ¯”ç‰¹æµ</a></li>
<li><a href="#%E8%87%AA%E5%B7%B1%E5%8A%A8%E6%89%8B%EF%BC%9A%E6%A3%80%E6%9F%A5-H-264-%E6%AF%94%E7%89%B9%E6%B5%81">è‡ªå·±åŠ¨æ‰‹ï¼šæ£€æŸ¥ H.264 æ¯”ç‰¹æµ</a></li>
</ul>
</li>
<li><a href="#%E5%9B%9E%E9%A1%BE">å›é¡¾</a></li>
<li><a href="#H-265-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E6%AF%94-H-264-%E6%9B%B4%E5%A5%BD%E7%9A%84%E5%8E%8B%E7%BC%A9%E7%8E%87">H.265 å¦‚ä½•å®ç°æ¯” H.264 æ›´å¥½çš„å‹ç¼©ç‡?</a></li>
</ul>
</li>
<li><a href="#%E5%9C%A8%E7%BA%BF%E6%B5%81%E5%AA%92%E4%BD%93">åœ¨çº¿æµåª’ä½“</a>
<ul>
<li><a href="#%E9%80%9A%E7%94%A8%E6%9E%B6%E6%9E%84">é€šç”¨æ¶æ„</a></li>
<li><a href="#%E6%B8%90%E8%BF%9B%E5%BC%8F%E4%B8%8B%E8%BD%BD%E5%92%8C%E8%87%AA%E9%80%82%E5%BA%94%E6%B5%81">æ¸è¿›å¼ä¸‹è½½å’Œè‡ªé€‚åº”æµ</a></li>
<li><a href="#%E5%86%85%E5%AE%B9%E4%BF%9D%E6%8A%A4">å†…å®¹ä¿æŠ¤</a></li>
</ul>
</li>
<li><a href="#%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8-jupyter">å¦‚ä½•ä½¿ç”¨ jupyter</a></li>
<li><a href="#%E4%BC%9A%E8%AE%AE">ä¼šè®®</a></li>
<li><a href="#%E5%8F%82%E8%80%83">å‚è€ƒ</a></li>
</ul>
<h1>åŸºæœ¬æœ¯è¯­</h1>
<p>ä¸€ä¸ª<strong>å›¾åƒ</strong>å¯ä»¥è§†ä½œä¸€ä¸ª<strong>äºŒç»´çŸ©é˜µ</strong>ã€‚å¦‚æœå°†<strong>è‰²å½©</strong>è€ƒè™‘è¿›æ¥ï¼Œæˆ‘ä»¬å¯ä»¥åšå‡ºæ¨å¹¿ï¼šå°†è¿™ä¸ªå›¾åƒè§†ä½œä¸€ä¸ª<strong>ä¸‰ç»´çŸ©é˜µ</strong>â€”â€”å¤šå‡ºæ¥çš„ç»´åº¦ç”¨äºå‚¨å­˜è‰²å½©ä¿¡æ¯ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬é€‰æ‹©ä¸‰åŸè‰²ï¼ˆçº¢ã€ç»¿ã€è“ï¼‰ä»£è¡¨è¿™äº›è‰²å½©ï¼Œè¿™å°±å®šä¹‰äº†ä¸‰ä¸ªå¹³é¢ï¼šç¬¬ä¸€ä¸ªæ˜¯çº¢è‰²å¹³é¢ï¼Œç¬¬äºŒä¸ªæ˜¯ç»¿è‰²å¹³é¢ï¼Œæœ€åä¸€ä¸ªæ˜¯è“è‰²å¹³é¢ã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/image_3d_matrix_rgb.png" alt="an image is a 3d matrix RGB" title="An image is a 3D matrix"></p>
<p>æˆ‘ä»¬æŠŠè¿™ä¸ªçŸ©é˜µé‡Œçš„æ¯ä¸€ä¸ªç‚¹ç§°ä¸º<strong>åƒç´ </strong>ï¼ˆå›¾åƒå…ƒç´ ï¼‰ã€‚åƒç´ çš„è‰²å½©ç”±ä¸‰åŸè‰²çš„<strong>å¼ºåº¦</strong>ï¼ˆé€šå¸¸ç”¨æ•°å€¼è¡¨ç¤ºï¼‰è¡¨ç¤ºã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ª<strong>çº¢è‰²åƒç´ </strong>æ˜¯æŒ‡å¼ºåº¦ä¸º 0 çš„ç»¿è‰²ï¼Œå¼ºåº¦ä¸º 0 çš„è“è‰²å’Œå¼ºåº¦æœ€å¤§çš„çº¢è‰²ã€‚<strong>ç²‰è‰²åƒç´ </strong>å¯ä»¥é€šè¿‡ä¸‰ç§é¢œè‰²çš„ç»„åˆè¡¨ç¤ºã€‚å¦‚æœè§„å®šå¼ºåº¦çš„å–å€¼èŒƒå›´æ˜¯ 0 åˆ° 255ï¼Œ<strong>çº¢è‰² 255ã€ç»¿è‰² 192ã€è“è‰² 203</strong> åˆ™è¡¨ç¤ºç²‰è‰²ã€‚</p>
<blockquote>
<h3 id="ç¼–ç å½©è‰²å›¾åƒçš„å…¶å®ƒæ–¹æ³•">ç¼–ç å½©è‰²å›¾åƒçš„å…¶å®ƒæ–¹æ³•</h3>
<p>è¿˜æœ‰è®¸å¤šå…¶å®ƒæ¨¡å‹ä¹Ÿå¯ä»¥ç”¨æ¥è¡¨ç¤ºè‰²å½©ï¼Œè¿›è€Œç»„æˆå›¾åƒã€‚ä¾‹å¦‚ï¼Œç»™æ¯ç§é¢œè‰²éƒ½æ ‡ä¸Šåºå·ï¼ˆå¦‚ä¸‹å›¾ï¼‰ï¼Œè¿™æ ·æ¯ä¸ªåƒç´ ä»…éœ€ä¸€ä¸ªå­—èŠ‚å°±å¯ä»¥è¡¨ç¤ºå‡ºæ¥ï¼Œè€Œä¸æ˜¯ RGB æ¨¡å‹é€šå¸¸æ‰€éœ€çš„ 3 ä¸ªã€‚åœ¨è¿™æ ·ä¸€ä¸ªæ¨¡å‹é‡Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªäºŒç»´çŸ©é˜µæ¥ä»£æ›¿ä¸‰ç»´çŸ©é˜µå»è¡¨ç¤ºæˆ‘ä»¬çš„è‰²å½©ï¼Œè¿™å°†èŠ‚çœå­˜å‚¨ç©ºé—´ï¼Œä½†è‰²å½©çš„æ•°é‡å°†ä¼šå—é™ã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/nes-color-palette.png" alt="NES palette" title="NES palette"></p>
</blockquote>
<p>ä¾‹å¦‚ä»¥ä¸‹å‡ å¼ å›¾ç‰‡ã€‚ç¬¬ä¸€å¼ åŒ…å«æ‰€æœ‰é¢œè‰²å¹³é¢ã€‚å‰©ä¸‹çš„åˆ†åˆ«æ˜¯çº¢ã€ç»¿ã€è“è‰²å¹³é¢ï¼ˆæ˜¾ç¤ºä¸ºç°è°ƒï¼‰ï¼ˆè¯‘æ³¨ï¼šé¢œè‰²å¼ºåº¦é«˜çš„åœ°æ–¹æ˜¾ç¤ºä¸ºäº®è‰²ï¼Œå¼ºåº¦ä½ä¸ºæš—è‰²ï¼‰ã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/rgb_channels_intensity.png" alt="RGB channels intensity" title="RGB channels intensity"></p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå¯¹äºæœ€ç»ˆçš„æˆåƒï¼Œçº¢è‰²å¹³é¢å¯¹å¼ºåº¦çš„è´¡çŒ®æ›´å¤šï¼ˆä¸‰ä¸ªå¹³é¢æœ€äº®çš„æ˜¯çº¢è‰²å¹³é¢ï¼‰ï¼Œè“è‰²å¹³é¢ï¼ˆæœ€åä¸€å¼ å›¾ç‰‡ï¼‰çš„è´¡çŒ®å¤§å¤šåªåœ¨é©¬é‡Œå¥¥çš„çœ¼ç›å’Œä»–è¡£æœçš„ä¸€éƒ¨åˆ†ã€‚æ‰€æœ‰é¢œè‰²å¹³é¢å¯¹é©¬é‡Œå¥¥çš„èƒ¡å­ï¼ˆæœ€æš—çš„éƒ¨åˆ†ï¼‰å‡è´¡çŒ®è¾ƒå°‘ã€‚</p>
<p>å­˜å‚¨é¢œè‰²çš„å¼ºåº¦ï¼Œéœ€è¦å ç”¨ä¸€å®šå¤§å°çš„æ•°æ®ç©ºé—´ï¼Œè¿™ä¸ªå¤§å°è¢«ç§°ä¸ºé¢œè‰²æ·±åº¦ã€‚å‡å¦‚æ¯ä¸ªé¢œè‰²ï¼ˆå¹³é¢ï¼‰çš„å¼ºåº¦å ç”¨ 8 bitï¼ˆå–å€¼èŒƒå›´ä¸º 0 åˆ° 255ï¼‰ï¼Œé‚£ä¹ˆé¢œè‰²æ·±åº¦å°±æ˜¯ 24ï¼ˆ8*3ï¼‰bitï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æ¨å¯¼å‡ºæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ 2 çš„ 24 æ¬¡æ–¹ç§ä¸åŒçš„é¢œè‰²ã€‚</p>
<blockquote>
<p>å¾ˆæ£’çš„å­¦ä¹ ææ–™ï¼š<a href="http://www.cambridgeincolour.com/tutorials/camera-sensors.htm">ç°å®ä¸–ç•Œçš„ç…§ç‰‡æ˜¯å¦‚ä½•æ‹æ‘„æˆ 0 å’Œ 1 çš„</a>ã€‚</p>
</blockquote>
<p>å›¾ç‰‡çš„å¦ä¸€ä¸ªå±æ€§æ˜¯<strong>åˆ†è¾¨ç‡</strong>ï¼Œå³ä¸€ä¸ªå¹³é¢å†…åƒç´ çš„æ•°é‡ã€‚é€šå¸¸è¡¨ç¤ºæˆå®½*é«˜ï¼Œä¾‹å¦‚ä¸‹é¢è¿™å¼  <strong>4x4</strong> çš„å›¾ç‰‡ã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/resolution.png" alt="image resolution" title="image resolution"></p>
<blockquote>
<h3 id="è‡ªå·±åŠ¨æ‰‹ï¼šç©è½¬å›¾åƒå’Œé¢œè‰²">è‡ªå·±åŠ¨æ‰‹ï¼šç©è½¬å›¾åƒå’Œé¢œè‰²</h3>
<p>ä½ å¯ä»¥ä½¿ç”¨ <a href="#%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8-jupyter">jupyter</a>ï¼ˆpython, numpy, matplotlib ç­‰ç­‰ï¼‰<a href="https://gitee.com/wangwei1237/wangwei1237/blob/master/2020/02/28/Introduction-to-digital-video-technology/py/image_as_3d_array.ipynb">ç©è½¬å›¾åƒ</a>ã€‚</p>
<p>ä½ ä¹Ÿå¯ä»¥å­¦ä¹ <a href="https://gitee.com/wangwei1237/wangwei1237/blob/master/2020/02/28/Introduction-to-digital-video-technology/py/filters_are_easy.ipynb">å›¾åƒæ»¤é•œï¼ˆè¾¹ç¼˜æ£€æµ‹ï¼Œç£¨çš®ï¼Œæ¨¡ç³Šã€‚ã€‚ã€‚ï¼‰çš„åŸç†</a>ã€‚</p>
</blockquote>
<p>å›¾åƒæˆ–è§†é¢‘è¿˜æœ‰ä¸€ä¸ªå±æ€§æ˜¯å®½é«˜æ¯”ï¼Œå®ƒç®€å•åœ°æè¿°äº†å›¾åƒæˆ–åƒç´ çš„å®½åº¦å’Œé«˜åº¦ä¹‹é—´çš„æ¯”ä¾‹å…³ç³»ã€‚</p>
<p>å½“äººä»¬è¯´è¿™ä¸ªç”µå½±æˆ–ç…§ç‰‡æ˜¯ 16:9 æ—¶ï¼Œé€šå¸¸æ˜¯æŒ‡æ˜¾ç¤ºå®½é«˜æ¯”ï¼ˆDARï¼‰ï¼Œç„¶è€Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æœ‰ä¸åŒå½¢çŠ¶çš„å•ä¸ªåƒç´ ï¼Œæˆ‘ä»¬ç§°ä¸ºåƒç´ å®½é«˜æ¯”ï¼ˆPARï¼‰ã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/DAR.png" alt="display aspect ratio" title="display aspect ratio"></p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/PAR.png" alt="pixel aspect ratio" title="pixel aspect ratio"></p>
<blockquote>
<h2 id="dvd-çš„-dar-æ˜¯-4-3">DVD çš„ DAR æ˜¯ 4:3</h2>
<p>è™½ç„¶ DVD çš„å®é™…åˆ†è¾¨ç‡æ˜¯ 704x480ï¼Œä½†å®ƒä¾ç„¶ä¿æŒ 4:3 çš„å®½é«˜æ¯”ï¼Œå› ä¸ºå®ƒæœ‰ä¸€ä¸ª 10:11ï¼ˆ704x10ï¼480x11ï¼‰çš„ PARã€‚</p>
</blockquote>
<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥å°†<strong>è§†é¢‘</strong>å®šä¹‰ä¸ºåœ¨<strong>å•ä½æ—¶é—´</strong>å†…<strong>è¿ç»­çš„ n å¸§</strong>ï¼Œè¿™å¯ä»¥è§†ä½œä¸€ä¸ªæ–°çš„ç»´åº¦ï¼Œn å³ä¸ºå¸§ç‡ï¼Œè‹¥å•ä½æ—¶é—´ä¸ºç§’ï¼Œåˆ™ç­‰åŒäº FPS (æ¯ç§’å¸§æ•° Frames Per Second)ã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/video.png" alt="video" title="video"></p>
<p>æ’­æ”¾ä¸€æ®µè§†é¢‘æ¯ç§’æ‰€éœ€çš„æ•°æ®é‡å°±æ˜¯å®ƒçš„<strong>æ¯”ç‰¹ç‡</strong>ï¼ˆå³å¸¸è¯´çš„ç ç‡ï¼‰ã€‚</p>
<blockquote>
<p>æ¯”ç‰¹ç‡ = å®½ * é«˜ * é¢œè‰²æ·±åº¦ * å¸§æ¯ç§’</p>
</blockquote>
<p>ä¾‹å¦‚ï¼Œä¸€æ®µæ¯ç§’ 30 å¸§ï¼Œæ¯åƒç´  24 bitsï¼Œåˆ†è¾¨ç‡æ˜¯ 480x240 çš„è§†é¢‘ï¼Œå¦‚æœæˆ‘ä»¬ä¸åšä»»ä½•å‹ç¼©ï¼Œå®ƒå°†éœ€è¦ <strong>82,944,000 æ¯”ç‰¹æ¯ç§’</strong>æˆ– 82.944 Mbps (30x480x240x24)ã€‚</p>
<p>å½“<strong>æ¯”ç‰¹ç‡</strong>å‡ ä¹æ’å®šæ—¶ç§°ä¸ºæ’å®šæ¯”ç‰¹ç‡ï¼ˆ<strong>CBR</strong>ï¼‰ï¼›ä½†å®ƒä¹Ÿå¯ä»¥å˜åŒ–ï¼Œç§°ä¸ºå¯å˜æ¯”ç‰¹ç‡ï¼ˆ<strong>VBR</strong>ï¼‰ã€‚</p>
<blockquote>
<p>è¿™ä¸ªå›¾å½¢æ˜¾ç¤ºäº†ä¸€ä¸ªå—é™çš„ VBRï¼Œå½“å¸§ä¸ºé»‘è‰²æ—¶ä¸ä¼šèŠ±è´¹å¤ªå¤šçš„æ•°æ®é‡ã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/vbr.png" alt="constrained vbr" title="constrained vbr"></p>
</blockquote>
<p>åœ¨æ—©æœŸï¼Œå·¥ç¨‹å¸ˆä»¬æƒ³å‡ºäº†ä¸€é¡¹æŠ€æœ¯èƒ½å°†è§†é¢‘çš„æ„Ÿå®˜å¸§ç‡åŠ å€è€Œ<strong>æ²¡æœ‰æ¶ˆè€—é¢å¤–å¸¦å®½</strong>ã€‚è¿™é¡¹æŠ€æœ¯è¢«ç§°ä¸º<strong>éš”è¡Œæ‰«æ</strong>ï¼›æ€»çš„æ¥è¯´ï¼Œå®ƒåœ¨ä¸€ä¸ªæ—¶é—´ç‚¹å‘é€ä¸€ä¸ªç”»é¢â€”â€”ç”»é¢ç”¨äºå¡«å……å±å¹•çš„ä¸€åŠï¼Œè€Œä¸‹ä¸€ä¸ªæ—¶é—´ç‚¹å‘é€çš„ç”»é¢ç”¨äºå¡«å……å±å¹•çš„å¦ä¸€åŠã€‚</p>
<p>å¦‚ä»Šçš„å±å¹•æ¸²æŸ“å¤§å¤šä½¿ç”¨<strong>é€è¡Œæ‰«ææŠ€æœ¯</strong>ã€‚è¿™æ˜¯ä¸€ç§æ˜¾ç¤ºã€å­˜å‚¨ã€ä¼ è¾“è¿åŠ¨å›¾åƒçš„æ–¹æ³•ï¼Œæ¯å¸§ä¸­çš„æ‰€æœ‰è¡Œéƒ½ä¼šè¢«ä¾æ¬¡ç»˜åˆ¶ã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/interlaced_vs_progressive.png" alt="interlaced vs progressive" title="interlaced vs progressive"></p>
<p>ç°åœ¨æˆ‘ä»¬çŸ¥é“äº†æ•°å­—åŒ–<strong>å›¾åƒ</strong>çš„åŸç†ï¼›å®ƒçš„<strong>é¢œè‰²</strong>çš„ç¼–æ’æ–¹å¼ï¼›ç»™å®š<strong>å¸§ç‡</strong>å’Œ<strong>åˆ†è¾¨ç‡</strong>æ—¶ï¼Œå±•ç¤ºä¸€ä¸ªè§†é¢‘éœ€è¦èŠ±è´¹å¤šå°‘<strong>æ¯”ç‰¹ç‡</strong>ï¼›å®ƒæ˜¯æ’å®šçš„ï¼ˆCBRï¼‰è¿˜æ˜¯å¯å˜çš„ï¼ˆVBRï¼‰ï¼›è¿˜æœ‰å¾ˆå¤šå…¶å®ƒå†…å®¹ï¼Œå¦‚éš”è¡Œæ‰«æå’Œ PARã€‚</p>
<blockquote>
<h2 id="è‡ªå·±åŠ¨æ‰‹ï¼šæ£€æŸ¥è§†é¢‘å±æ€§">è‡ªå·±åŠ¨æ‰‹ï¼šæ£€æŸ¥è§†é¢‘å±æ€§</h2>
<p>ä½ å¯ä»¥<a href="https://github.com/leandromoreira/introduction_video_technology/blob/master/encoding_pratical_examples.md#inspect-stream">ä½¿ç”¨ ffmpeg æˆ– mediainfo æ£€æŸ¥å¤§å¤šæ•°å±æ€§çš„è§£é‡Š</a>ã€‚</p>
</blockquote>
<h1>æ¶ˆé™¤å†—ä½™</h1>
<p>æˆ‘ä»¬è®¤è¯†åˆ°ï¼Œä¸å¯¹è§†é¢‘è¿›è¡Œå‹ç¼©æ˜¯ä¸è¡Œçš„ï¼›<strong>ä¸€ä¸ªå•ç‹¬çš„ä¸€å°æ—¶é•¿çš„è§†é¢‘</strong>ï¼Œåˆ†è¾¨ç‡ä¸º 720p å’Œ 30fps æ—¶å°†<strong>éœ€è¦ 278GB<sup>*</sup></strong>ã€‚ä»…ä»…ä½¿ç”¨æ— æŸæ•°æ®å‹ç¼©ç®—æ³•â€”â€”å¦‚ DEFLATEï¼ˆè¢«PKZIP, Gzip, å’Œ PNG ä½¿ç”¨ï¼‰â€”â€”ä¹Ÿæ— æ³•å……åˆ†å‡å°‘è§†é¢‘æ‰€éœ€çš„å¸¦å®½ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°å…¶å®ƒå‹ç¼©è§†é¢‘çš„æ–¹æ³•ã€‚</p>
<blockquote>
<p><sup>*</sup>æˆ‘ä»¬ä½¿ç”¨ä¹˜ç§¯å¾—å‡ºè¿™ä¸ªæ•°å­— 1280 x 720 x 24 x 30 x 3600 ï¼ˆå®½ï¼Œé«˜ï¼Œæ¯åƒç´ æ¯”ç‰¹æ•°ï¼Œfps å’Œç§’æ•°ï¼‰</p>
</blockquote>
<p>ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥<strong>åˆ©ç”¨è§†è§‰ç‰¹æ€§</strong>ï¼šå’ŒåŒºåˆ†é¢œè‰²ç›¸æ¯”ï¼Œæˆ‘ä»¬åŒºåˆ†äº®åº¦è¦æ›´åŠ æ•é”ã€‚<strong>æ—¶é—´ä¸Šçš„é‡å¤</strong>ï¼šä¸€æ®µè§†é¢‘åŒ…å«å¾ˆå¤šåªæœ‰ä¸€ç‚¹å°å°æ”¹å˜çš„å›¾åƒã€‚<strong>å›¾åƒå†…çš„é‡å¤</strong>ï¼šæ¯ä¸€å¸§ä¹ŸåŒ…å«å¾ˆå¤šé¢œè‰²ç›¸åŒæˆ–ç›¸ä¼¼çš„åŒºåŸŸã€‚</p>
<h2 id="é¢œè‰²-äº®åº¦å’Œæˆ‘ä»¬çš„çœ¼ç›">é¢œè‰²ï¼Œäº®åº¦å’Œæˆ‘ä»¬çš„çœ¼ç›</h2>
<p>æˆ‘ä»¬çš„çœ¼ç›<a href="http://vanseodesign.com/web-design/color-luminance/">å¯¹äº®åº¦æ¯”å¯¹é¢œè‰²æ›´æ•æ„Ÿ</a>ï¼Œä½ å¯ä»¥çœ‹çœ‹ä¸‹é¢çš„å›¾ç‰‡è‡ªå·±æµ‹è¯•ã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/luminance_vs_color.png" alt="luminance vs color" title="luminance vs color"></p>
<p>å¦‚æœä½ çœ‹ä¸å‡ºå·¦å›¾çš„<strong>æ–¹å— A å’Œæ–¹å— B</strong> çš„é¢œè‰²æ˜¯<strong>ç›¸åŒçš„</strong>ï¼Œé‚£ä¹ˆå¥½ï¼Œæ˜¯æˆ‘ä»¬çš„å¤§è„‘ç©äº†ä¸€ä¸ªå°æŠŠæˆï¼Œè¿™è®©æˆ‘ä»¬æ›´å¤šçš„å»æ³¨æ„å…‰ä¸æš—ï¼Œè€Œä¸æ˜¯é¢œè‰²ã€‚å³è¾¹è¿™é‡Œæœ‰ä¸€ä¸ªä½¿ç”¨åŒæ ·é¢œè‰²çš„è¿æ¥å™¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬ï¼ˆçš„å¤§è„‘ï¼‰å°±èƒ½è½»æ˜“åˆ†è¾¨å‡ºäº‹å®ï¼Œå®ƒä»¬æ˜¯åŒæ ·çš„é¢œè‰²ã€‚</p>
<blockquote>
<p><strong>ç®€å•è§£é‡Šæˆ‘ä»¬çš„çœ¼ç›å·¥ä½œçš„åŸç†</strong></p>
<p><a href="http://www.biologymad.com/nervoussystem/eyenotes.htm">çœ¼ç›æ˜¯ä¸€ä¸ªå¤æ‚çš„å™¨å®˜</a>ï¼Œæœ‰è®¸å¤šéƒ¨åˆ†ç»„æˆï¼Œä½†æˆ‘ä»¬æœ€æ„Ÿå…´è¶£çš„æ˜¯è§†é”¥ç»†èƒå’Œè§†æ†ç»†èƒã€‚çœ¼ç›æœ‰<a href="https://en.wikipedia.org/wiki/Photoreceptor_cell">å¤§çº¦1.2äº¿ä¸ªè§†æ†ç»†èƒå’Œ6ç™¾ä¸‡ä¸ªè§†é”¥ç»†èƒ</a>ã€‚</p>
<p><strong>ç®€å•æ¥è¯´</strong>ï¼Œè®©æˆ‘ä»¬æŠŠé¢œè‰²å’Œäº®åº¦æ”¾åœ¨çœ¼ç›çš„åŠŸèƒ½éƒ¨ä½ä¸Šã€‚<a href="https://en.wikipedia.org/wiki/Rod_cell">è§†æ†ç»†èƒ</a><strong>ä¸»è¦è´Ÿè´£äº®åº¦</strong>ï¼Œè€Œ<a href="https://en.wikipedia.org/wiki/Cone_cell">è§†é”¥ç»†èƒ</a><strong>è´Ÿè´£é¢œè‰²</strong>ï¼Œæœ‰ä¸‰ç§ç±»å‹çš„è§†é”¥ï¼Œæ¯ä¸ªéƒ½æœ‰ä¸åŒçš„é¢œæ–™ï¼Œå«åšï¼š<a href="https://upload.wikimedia.org/wikipedia/commons/1/1e/Cones_SMJ2_E.svg">S-è§†é”¥ï¼ˆè“è‰²ï¼‰ï¼ŒM-è§†é”¥ï¼ˆç»¿è‰²ï¼‰å’ŒL-è§†é”¥ï¼ˆçº¢è‰²ï¼‰</a>ã€‚</p>
<p>æ—¢ç„¶æˆ‘ä»¬çš„è§†æ†ç»†èƒï¼ˆäº®åº¦ï¼‰æ¯”è§†é”¥ç»†èƒå¤šå¾ˆå¤šï¼Œä¸€ä¸ªåˆç†çš„æ¨æ–­æ˜¯ç›¸æ¯”é¢œè‰²ï¼Œæˆ‘ä»¬æœ‰æ›´å¥½çš„èƒ½åŠ›å»åŒºåˆ†é»‘æš—å’Œå…‰äº®ã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/eyes.jpg" alt="eyes composition" title="eyes composition"></p>
</blockquote>
<p>ä¸€æ—¦æˆ‘ä»¬çŸ¥é“æˆ‘ä»¬å¯¹<strong>äº®åº¦</strong>ï¼ˆå›¾åƒä¸­çš„äº®åº¦ï¼‰æ›´æ•æ„Ÿï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨å®ƒã€‚</p>
<h3 id="é¢œè‰²æ¨¡å‹">é¢œè‰²æ¨¡å‹</h3>
<p>æˆ‘ä»¬æœ€å¼€å§‹å­¦ä¹ çš„<a href="#%E5%9F%BA%E6%9C%AC%E6%9C%AF%E8%AF%AD">å½©è‰²å›¾åƒçš„åŸç†</a>ä½¿ç”¨çš„æ˜¯ <strong>RGB æ¨¡å‹</strong>ï¼Œä½†ä¹Ÿæœ‰å…¶ä»–æ¨¡å‹ã€‚æœ‰ä¸€ç§æ¨¡å‹å°†äº®åº¦ï¼ˆå…‰äº®ï¼‰å’Œè‰²åº¦ï¼ˆé¢œè‰²ï¼‰åˆ†ç¦»å¼€ï¼Œå®ƒè¢«ç§°ä¸º <strong>YCbCr</strong><sup>*</sup>ã€‚</p>
<blockquote>
<p><sup>*</sup> æœ‰å¾ˆå¤šç§æ¨¡å‹åšåŒæ ·çš„åˆ†ç¦»ã€‚</p>
</blockquote>
<p>è¿™ä¸ªé¢œè‰²æ¨¡å‹ä½¿ç”¨ <strong>Y</strong> æ¥è¡¨ç¤ºäº®åº¦ï¼Œè¿˜æœ‰ä¸¤ç§é¢œè‰²é€šé“ï¼šCbï¼ˆè“è‰²è‰²åº¦ï¼‰ å’Œ Crï¼ˆçº¢è‰²è‰²åº¦ï¼‰ã€‚YCbCr å¯ä»¥ç”± RGB è½¬æ¢å¾—æ¥ï¼Œä¹Ÿå¯ä»¥è½¬æ¢å› RGBã€‚ä½¿ç”¨è¿™ä¸ªæ¨¡å‹æˆ‘ä»¬å¯ä»¥åˆ›å»ºæ‹¥æœ‰å®Œæ•´è‰²å½©çš„å›¾åƒï¼Œå¦‚ä¸‹å›¾ã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/ycbcr.png" alt="ycbcr ä¾‹å­" title="ycbcr ä¾‹å­"></p>
<h3 id="ycbcr-å’Œ-rgb-ä¹‹é—´çš„è½¬æ¢">YCbCr å’Œ RGB ä¹‹é—´çš„è½¬æ¢</h3>
<p>æœ‰äººå¯èƒ½ä¼šé—®ï¼Œåœ¨**ä¸ä½¿ç”¨ç»¿è‰²ï¼ˆè‰²åº¦ï¼‰**çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¦‚ä½•è¡¨ç°å‡ºæ‰€æœ‰çš„è‰²å½©ï¼Ÿ</p>
<p>ä¸ºäº†å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å°†ä»‹ç»ä» RGB åˆ° YCbCr çš„è½¬æ¢ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ <a href="https://en.wikipedia.org/wiki/ITU-R">ITU-R å°ç»„</a>*å»ºè®®çš„<a href="https://en.wikipedia.org/wiki/Rec._601">æ ‡å‡† BT.601</a> ä¸­çš„ç³»æ•°ã€‚</p>
<p>ç¬¬ä¸€æ­¥æ˜¯è®¡ç®—äº®åº¦ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ ITU å»ºè®®çš„å¸¸é‡ï¼Œå¹¶æ›¿æ¢ RGB å€¼ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Y &#x3D; 0.299R + 0.587G + 0.114B</span><br></pre></td></tr></table></figure>
<p>ä¸€æ—¦æˆ‘ä»¬æœ‰äº†äº®åº¦åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ‹†åˆ†é¢œè‰²ï¼ˆè“è‰²è‰²åº¦å’Œçº¢è‰²è‰²åº¦ï¼‰ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Cb &#x3D; 0.564(B - Y)</span><br><span class="line">Cr &#x3D; 0.713(R - Y)</span><br></pre></td></tr></table></figure>
<p>å¹¶ä¸”æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ YCbCr è½¬æ¢å›æ¥ï¼Œç”šè‡³å¾—åˆ°ç»¿è‰²ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">R &#x3D; Y + 1.402Cr</span><br><span class="line">B &#x3D; Y + 1.772Cb</span><br><span class="line">G &#x3D; Y - 0.344Cb - 0.714Cr</span><br></pre></td></tr></table></figure>
<blockquote>
<p><sup>*</sup>ç»„ç»‡å’Œæ ‡å‡†åœ¨æ•°å­—è§†é¢‘é¢†åŸŸä¸­å¾ˆå¸¸è§ï¼Œå®ƒä»¬é€šå¸¸å®šä¹‰ä»€ä¹ˆæ˜¯æ ‡å‡†ï¼Œä¾‹å¦‚ï¼Œ<a href="https://en.wikipedia.org/wiki/Rec._2020">ä»€ä¹ˆæ˜¯ 4Kï¼Ÿæˆ‘ä»¬åº”è¯¥ä½¿ç”¨ä»€ä¹ˆå¸§ç‡ï¼Ÿåˆ†è¾¨ç‡ï¼Ÿé¢œè‰²æ¨¡å‹ï¼Ÿ</a></p>
</blockquote>
<p>é€šå¸¸ï¼Œ<strong>æ˜¾ç¤ºå±</strong>ï¼ˆç›‘è§†å™¨ï¼Œç”µè§†æœºï¼Œå±å¹•ç­‰ç­‰ï¼‰<strong>ä»…ä½¿ç”¨ RGB æ¨¡å‹</strong>ï¼Œå¹¶ä»¥ä¸åŒçš„æ–¹å¼æ¥ç»„ç»‡ï¼Œçœ‹çœ‹ä¸‹é¢è¿™äº›æ”¾å¤§æ•ˆæœï¼š</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/new_pixel_geometry.jpg" alt="pixel geometry" title="pixel geometry"></p>
<h3 id="è‰²åº¦å­é‡‡æ ·">è‰²åº¦å­é‡‡æ ·</h3>
<p>ä¸€æ—¦æˆ‘ä»¬èƒ½ä»å›¾åƒä¸­åˆ†ç¦»å‡ºäº®åº¦å’Œè‰²åº¦ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨äººç±»è§†è§‰ç³»ç»Ÿå¯¹äº®åº¦æ¯”è‰²åº¦æ›´æ•æ„Ÿçš„ç‰¹ç‚¹ï¼Œé€‰æ‹©æ€§åœ°å‰”é™¤ä¿¡æ¯ã€‚<strong>è‰²åº¦å­é‡‡æ ·</strong>æ˜¯ä¸€ç§ç¼–ç å›¾åƒæ—¶ï¼Œä½¿<strong>è‰²åº¦åˆ†è¾¨ç‡ä½äºäº®åº¦</strong>çš„æŠ€æœ¯ã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/ycbcr_subsampling_resolution.png" alt="ycbcr å­é‡‡æ ·åˆ†è¾¨ç‡" title="ycbcr å­é‡‡æ ·åˆ†è¾¨ç‡"></p>
<p>æˆ‘ä»¬åº”è¯¥å‡å°‘å¤šå°‘è‰²åº¦åˆ†è¾¨ç‡å‘¢ï¼Ÿå·²ç»æœ‰ä¸€äº›æ¨¡å¼å®šä¹‰äº†å¦‚ä½•å¤„ç†åˆ†è¾¨ç‡å’Œåˆå¹¶ï¼ˆ<code>æœ€ç»ˆçš„é¢œè‰² = Y + Cb + Cr</code>ï¼‰ã€‚</p>
<p>è¿™äº›æ¨¡å¼ç§°ä¸ºå­é‡‡æ ·ç³»ç»Ÿï¼Œå¹¶è¢«è¡¨ç¤ºä¸º 3 éƒ¨åˆ†çš„æ¯”ç‡ - <code>a:x:y</code>ï¼Œå…¶å®šä¹‰äº†è‰²åº¦å¹³é¢çš„åˆ†è¾¨ç‡ï¼Œä¸äº®åº¦å¹³é¢ä¸Šçš„ã€åˆ†è¾¨ç‡ä¸º <code>a x 2</code> çš„å°å—ä¹‹é—´çš„å…³ç³»ã€‚</p>
<ul>
<li><code>a</code> æ˜¯æ°´å¹³é‡‡æ ·å‚è€ƒ (é€šå¸¸æ˜¯ 4)ï¼Œ</li>
<li><code>x</code> æ˜¯ç¬¬ä¸€è¡Œçš„è‰²åº¦æ ·æœ¬æ•°ï¼ˆç›¸å¯¹äº a çš„æ°´å¹³åˆ†è¾¨ç‡ï¼‰ï¼Œ</li>
<li><code>y</code> æ˜¯ç¬¬äºŒè¡Œçš„è‰²åº¦æ ·æœ¬æ•°ã€‚</li>
</ul>
<blockquote>
<p>å­˜åœ¨çš„ä¸€ä¸ªä¾‹å¤–æ˜¯ 4:1:0ï¼Œå…¶åœ¨æ¯ä¸ªäº®åº¦å¹³é¢åˆ†è¾¨ç‡ä¸º 4 x 4 çš„å—å†…æä¾›ä¸€ä¸ªè‰²åº¦æ ·æœ¬ã€‚</p>
</blockquote>
<p>ç°ä»£ç¼–è§£ç å™¨ä¸­ä½¿ç”¨çš„å¸¸ç”¨æ–¹æ¡ˆæ˜¯ï¼š 4:4:4 (æ²¡æœ‰å­é‡‡æ ·)**, 4:2:2, 4:1:1, 4:2:0, 4:1:0 and 3:1:1ã€‚</p>
<blockquote>
<p>YCbCr 4:2:0 åˆå¹¶</p>
<p>è¿™æ˜¯ä½¿ç”¨ YCbCr 4:2:0 åˆå¹¶çš„ä¸€ä¸ªå›¾åƒçš„ä¸€å—ï¼Œæ³¨æ„æˆ‘ä»¬æ¯åƒç´ åªèŠ±è´¹ 12bitã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/ycbcr_420_merge.png" alt="YCbCr 4:2:0 åˆå¹¶" title="YCbCr 4:2:0 åˆå¹¶"></p>
</blockquote>
<p>ä¸‹å›¾æ˜¯åŒä¸€å¼ å›¾ç‰‡ä½¿ç”¨å‡ ç§ä¸»è¦çš„è‰²åº¦å­é‡‡æ ·æŠ€æœ¯è¿›è¡Œç¼–ç ï¼Œç¬¬ä¸€è¡Œå›¾åƒæ˜¯æœ€ç»ˆçš„ YCbCrï¼Œè€Œæœ€åä¸€è¡Œå›¾åƒå±•ç¤ºäº†è‰²åº¦çš„åˆ†è¾¨ç‡ã€‚è¿™ä¹ˆå°çš„æŸå¤±ç¡®å®æ˜¯ä¸€ä¸ªä¼Ÿå¤§çš„èƒœåˆ©ã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/chroma_subsampling_examples.jpg" alt="è‰²åº¦å­é‡‡æ ·ä¾‹å­" title="è‰²åº¦å­é‡‡æ ·ä¾‹å­"></p>
<p>å‰é¢æˆ‘ä»¬è®¡ç®—è¿‡æˆ‘ä»¬éœ€è¦ <a href="#%E6%B6%88%E9%99%A4%E5%86%97%E4%BD%99">278GB å»å­˜å‚¨ä¸€ä¸ªä¸€å°æ—¶é•¿ï¼Œåˆ†è¾¨ç‡åœ¨720på’Œ30fpsçš„è§†é¢‘æ–‡ä»¶</a>ã€‚å¦‚æœæˆ‘ä»¬ä½¿ç”¨ <code>YCbCr 4:2:0</code> æˆ‘ä»¬èƒ½å‰ªæ‰<code>ä¸€åŠçš„å¤§å°ï¼ˆ139GBï¼‰</code><sup>*</sup>ï¼Œä½†ä»ç„¶ä¸å¤Ÿç†æƒ³ã€‚</p>
<blockquote>
<p><sup>*</sup> æˆ‘ä»¬é€šè¿‡å°†å®½ã€é«˜ã€é¢œè‰²æ·±åº¦å’Œ fps ç›¸ä¹˜å¾—å‡ºè¿™ä¸ªå€¼ã€‚å‰é¢æˆ‘ä»¬éœ€è¦ 24 bitï¼Œç°åœ¨æˆ‘ä»¬åªéœ€è¦ 12 bitã€‚</p>
</blockquote>
<blockquote>
<h3 id="è‡ªå·±åŠ¨æ‰‹ï¼šæ£€æŸ¥-ycbcr-ç›´æ–¹å›¾">è‡ªå·±åŠ¨æ‰‹ï¼šæ£€æŸ¥ YCbCr ç›´æ–¹å›¾</h3>
<p>ä½ å¯ä»¥<a href="https://github.com/leandromoreira/digital_video_introduction/blob/master/encoding_pratical_examples.md#generates-yuv-histogram">ä½¿ç”¨ ffmpeg æ£€æŸ¥ YCbCr ç›´æ–¹å›¾</a>ã€‚è¿™ä¸ªåœºæ™¯æœ‰æ›´å¤šçš„è“è‰²è´¡çŒ®ï¼Œç”±<a href="https://en.wikipedia.org/wiki/Histogram">ç›´æ–¹å›¾</a>æ˜¾ç¤ºã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/yuv_histogram.png" alt="ycbcr é¢œè‰²ç›´æ–¹å›¾" title="ycbcr é¢œè‰²ç›´æ–¹å›¾"></p>
</blockquote>
<h2 id="å¸§ç±»å‹">å¸§ç±»å‹</h2>
<p>ç°åœ¨æˆ‘ä»¬è¿›ä¸€æ­¥æ¶ˆé™¤<code>æ—¶é—´å†—ä½™</code>ï¼Œä½†åœ¨è¿™ä¹‹å‰è®©æˆ‘ä»¬æ¥ç¡®å®šä¸€äº›åŸºæœ¬æœ¯è¯­ã€‚å‡è®¾æˆ‘ä»¬ä¸€æ®µ 30fps çš„å½±ç‰‡ï¼Œè¿™æ˜¯æœ€å¼€å§‹çš„ 4 å¸§ã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/smw_background_ball_1.png" alt="çƒ 1" title="çƒ 1"> <img src="/2020/02/28/Introduction-to-digital-video-technology/smw_background_ball_2.png" alt="çƒ 2" title="çƒ 2"> <img src="/2020/02/28/Introduction-to-digital-video-technology/smw_background_ball_3.png" alt="çƒ 3" title="çƒ 3"><br>
<img src="/2020/02/28/Introduction-to-digital-video-technology/smw_background_ball_4.png" alt="çƒ 4" title="çƒ 4"></p>
<p>æˆ‘ä»¬å¯ä»¥åœ¨å¸§å†…çœ‹åˆ°<strong>å¾ˆå¤šé‡å¤å†…å®¹</strong>ï¼Œå¦‚<strong>è“è‰²èƒŒæ™¯</strong>ï¼Œä» 0 å¸§åˆ°ç¬¬ 3 å¸§å®ƒéƒ½æ²¡æœ‰å˜åŒ–ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒä»¬<strong>æŠ½è±¡åœ°åˆ†ç±»</strong>ä¸ºä¸‰ç§ç±»å‹çš„å¸§ã€‚</p>
<h3 id="i-å¸§-å¸§å†…ç¼–ç -å…³é”®å¸§">I å¸§ï¼ˆå¸§å†…ç¼–ç ï¼Œå…³é”®å¸§ï¼‰</h3>
<p>I å¸§ï¼ˆå¯å‚è€ƒï¼Œå…³é”®å¸§ï¼Œå¸§å†…ç¼–ç ï¼‰æ˜¯ä¸€ä¸ª<strong>è‡ªè¶³çš„å¸§</strong>ã€‚å®ƒä¸ä¾é ä»»ä½•ä¸œè¥¿æ¥æ¸²æŸ“ï¼ŒI å¸§ä¸é™æ€å›¾ç‰‡ç›¸ä¼¼ã€‚ç¬¬ä¸€å¸§é€šå¸¸æ˜¯ I å¸§ï¼Œä½†æˆ‘ä»¬å°†çœ‹åˆ° I å¸§è¢«å®šæœŸæ’å…¥å…¶å®ƒç±»å‹çš„å¸§ä¹‹é—´ã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/smw_background_ball_1.png" alt="çƒ 1" title="çƒ 1"></p>
<h3 id="p-å¸§-é¢„æµ‹">P å¸§ï¼ˆé¢„æµ‹ï¼‰</h3>
<p>P å¸§åˆ©ç”¨äº†ä¸€ä¸ªäº‹å®ï¼šå½“å‰çš„ç”»é¢å‡ ä¹æ€»èƒ½<strong>ä½¿ç”¨ä¹‹å‰çš„ä¸€å¸§è¿›è¡Œæ¸²æŸ“</strong>ã€‚ä¾‹å¦‚ï¼Œåœ¨ç¬¬äºŒå¸§ï¼Œå”¯ä¸€çš„æ”¹å˜æ˜¯çƒå‘å‰ç§»åŠ¨äº†ã€‚ä»…ä»…ä½¿ç”¨ï¼ˆç¬¬äºŒå¸§ï¼‰å¯¹å‰ä¸€å¸§çš„å¼•ç”¨å’Œå·®å€¼ï¼Œæˆ‘ä»¬å°±èƒ½é‡å»ºå‰ä¸€å¸§ã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/smw_background_ball_1.png" alt="çƒ 1" title="çƒ 1"> &lt;-  <img src="/2020/02/28/Introduction-to-digital-video-technology/smw_background_ball_2_diff.png" alt="çƒ 2" title="çƒ 2"></p>
<blockquote>
<h4 id="è‡ªå·±åŠ¨æ‰‹ï¼šå…·æœ‰å•ä¸ª-i-å¸§çš„è§†é¢‘">è‡ªå·±åŠ¨æ‰‹ï¼šå…·æœ‰å•ä¸ª I å¸§çš„è§†é¢‘</h4>
<p>æ—¢ç„¶ P å¸§ä½¿ç”¨è¾ƒå°‘çš„æ•°æ®ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸èƒ½ç”¨<a href="https://github.com/leandromoreira/digital_video_introduction/blob/master/encoding_pratical_examples.md#1-i-frame-and-the-rest-p-frames">å•ä¸ª I å¸§å’Œå…¶ä½™çš„ P å¸§</a>æ¥ç¼–ç æ•´ä¸ªè§†é¢‘ï¼Ÿ</p>
<p>ç¼–ç å®Œè¿™ä¸ªè§†é¢‘ä¹‹åï¼Œå¼€å§‹è§‚çœ‹å®ƒï¼Œå¹¶<strong>å¿«è¿›åˆ°è§†é¢‘çš„æœ«å°¾éƒ¨åˆ†</strong>ï¼Œä½ ä¼šæ³¨æ„åˆ°<strong>å®ƒéœ€è¦èŠ±ä¸€äº›æ—¶é—´</strong>æ‰çœŸæ­£è·³è½¬åˆ°è¿™éƒ¨åˆ†ã€‚è¿™æ˜¯å› ä¸º <strong>P å¸§éœ€è¦ä¸€ä¸ªå¼•ç”¨å¸§</strong>ï¼ˆæ¯”å¦‚ I å¸§ï¼‰æ‰èƒ½æ¸²æŸ“ã€‚</p>
<p>ä½ å¯ä»¥åšçš„å¦ä¸€ä¸ªå¿«é€Ÿè¯•éªŒï¼Œæ˜¯ä½¿ç”¨å•ä¸ª I å¸§ç¼–ç è§†é¢‘ï¼Œç„¶å<a href="https://github.com/leandromoreira/digital_video_introduction/blob/master/encoding_pratical_examples.md#1-i-frames-per-second-vs-05-i-frames-per-second">å†æ¬¡ç¼–ç ä¸”æ¯ 2 ç§’æ’å…¥ä¸€ä¸ª I å¸§</a>ï¼Œå¹¶<strong>æ¯”è¾ƒæˆå“çš„å¤§å°</strong>ã€‚</p>
</blockquote>
<h3 id="b-å¸§-åŒå‘é¢„æµ‹">B å¸§ï¼ˆåŒå‘é¢„æµ‹ï¼‰</h3>
<p>å¦‚ä½•å¼•ç”¨å‰é¢å’Œåé¢çš„å¸§å»åšæ›´å¥½çš„å‹ç¼©ï¼Ÿï¼ç®€å•åœ°è¯´ B å¸§å°±æ˜¯è¿™ä¹ˆåšçš„ã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/smw_background_ball_1.png" alt="çƒ 1" title="çƒ 1"> &lt;-  <img src="/2020/02/28/Introduction-to-digital-video-technology/smw_background_ball_2_diff.png" alt="çƒ 2" title="çƒ 2"> -&gt; <img src="/2020/02/28/Introduction-to-digital-video-technology/smw_background_ball_3.png" alt="çƒ 3" title="çƒ 3"></p>
<blockquote>
<h4 id="è‡ªå·±åŠ¨æ‰‹ï¼šä½¿ç”¨-b-å¸§æ¯”è¾ƒè§†é¢‘">è‡ªå·±åŠ¨æ‰‹ï¼šä½¿ç”¨ B å¸§æ¯”è¾ƒè§†é¢‘</h4>
<p>ä½ å¯ä»¥ç”Ÿæˆä¸¤ä¸ªç‰ˆæœ¬ï¼Œä¸€ä¸ªä½¿ç”¨ B å¸§ï¼Œå¦ä¸€ä¸ª<a href="https://github.com/leandromoreira/digital_video_introduction/blob/master/encoding_pratical_examples.md#no-b-frames-at-all">å…¨éƒ¨ä¸ä½¿ç”¨ B å¸§</a>ï¼Œç„¶åæŸ¥çœ‹æ–‡ä»¶çš„å¤§å°ä»¥åŠç”»è´¨ã€‚</p>
</blockquote>
<h3 id="å°ç»“">å°ç»“</h3>
<p>è¿™äº›å¸§ç±»å‹ç”¨äºæä¾›æ›´å¥½çš„å‹ç¼©ç‡ï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹ä¸€ç« çœ‹åˆ°è¿™æ˜¯å¦‚ä½•å‘ç”Ÿçš„ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥æƒ³åˆ° I å¸§æ˜¯æ˜‚è´µçš„ï¼ŒP å¸§æ˜¯ä¾¿å®œçš„ï¼Œæœ€ä¾¿å®œçš„æ˜¯ B å¸§ã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/frame_types.png" alt="å¸§ç±»å‹ä¾‹å­" title="å¸§ç±»å‹ä¾‹å­"></p>
<h2 id="æ—¶é—´å†—ä½™-å¸§é—´é¢„æµ‹">æ—¶é—´å†—ä½™ï¼ˆå¸§é—´é¢„æµ‹ï¼‰</h2>
<p>è®©æˆ‘ä»¬æ¢ç©¶å»é™¤<strong>æ—¶é—´ä¸Šçš„é‡å¤</strong>ï¼Œå»é™¤è¿™ä¸€ç±»å†—ä½™çš„æŠ€æœ¯å°±æ˜¯<strong>å¸§é—´é¢„æµ‹</strong>ã€‚</p>
<p>æˆ‘ä»¬å°†å°è¯•<strong>èŠ±è´¹è¾ƒå°‘çš„æ•°æ®é‡</strong>å»ç¼–ç åœ¨æ—¶é—´ä¸Šè¿ç»­çš„ 0 å·å¸§å’Œ 1 å·å¸§ã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/original_frames.png" alt="åŸå§‹å¸§" title="åŸå§‹å¸§"></p>
<p>æˆ‘ä»¬å¯ä»¥åšä¸ªå‡æ³•ï¼Œæˆ‘ä»¬ç®€å•åœ°<strong>ç”¨ 0 å·å¸§å‡å» 1 å·å¸§</strong>ï¼Œå¾—åˆ°æ®‹å·®ï¼Œè¿™æ ·æˆ‘ä»¬å°±åªéœ€è¦<strong>å¯¹æ®‹å·®è¿›è¡Œç¼–ç </strong>ã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/difference_frames.png" alt="æ®‹å·®å¸§" title="æ®‹å·®å¸§"></p>
<p>ä½†æˆ‘ä»¬æœ‰ä¸€ä¸ª<strong>æ›´å¥½çš„æ–¹æ³•</strong>æ¥èŠ‚çœæ•°æ®é‡ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å°†<code>0 å·å¸§</code> è§†ä¸ºä¸€ä¸ªä¸ªåˆ†å—çš„é›†åˆï¼Œç„¶åæˆ‘ä»¬å°†å°è¯•å°† <code>å¸§ 1</code> å’Œ <code>å¸§ 0</code> ä¸Šçš„å—ç›¸åŒ¹é…ã€‚æˆ‘ä»¬å¯ä»¥å°†è¿™çœ‹ä½œæ˜¯<strong>è¿åŠ¨é¢„æµ‹</strong>ã€‚</p>
<blockquote>
<h3 id="ç»´åŸºç™¾ç§‘-å—è¿åŠ¨è¡¥å¿">ç»´åŸºç™¾ç§‘â€”å—è¿åŠ¨è¡¥å¿</h3>
<p>â€œè¿åŠ¨è¡¥å¿æ˜¯ä¸€ç§æè¿°ç›¸é‚»å¸§ï¼ˆç›¸é‚»åœ¨è¿™é‡Œè¡¨ç¤ºåœ¨ç¼–ç å…³ç³»ä¸Šç›¸é‚»ï¼Œåœ¨æ’­æ”¾é¡ºåºä¸Šä¸¤å¸§æœªå¿…ç›¸é‚»ï¼‰å·®åˆ«çš„æ–¹æ³•ï¼Œå…·ä½“æ¥è¯´æ˜¯æè¿°å‰é¢ä¸€å¸§ï¼ˆç›¸é‚»åœ¨è¿™é‡Œè¡¨ç¤ºåœ¨ç¼–ç å…³ç³»ä¸Šçš„å‰é¢ï¼Œåœ¨æ’­æ”¾é¡ºåºä¸Šæœªå¿…åœ¨å½“å‰å¸§å‰é¢ï¼‰çš„æ¯ä¸ªå°å—æ€æ ·ç§»åŠ¨åˆ°å½“å‰å¸§ä¸­çš„æŸä¸ªä½ç½®å»ã€‚â€</p>
</blockquote>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/original_frames_motion_estimation.png" alt="åŸå§‹å¸§è¿åŠ¨é¢„æµ‹" title="åŸå§‹å¸§è¿åŠ¨é¢„æµ‹"></p>
<p>æˆ‘ä»¬é¢„è®¡é‚£ä¸ªçƒä¼šä» <code>x=0, y=25</code> ç§»åŠ¨åˆ° <code>x=6, y=26</code>ï¼Œ<strong>x</strong> å’Œ <strong>y</strong> çš„å€¼å°±æ˜¯<strong>è¿åŠ¨å‘é‡</strong>ã€‚<strong>è¿›ä¸€æ­¥</strong>èŠ‚çœæ•°æ®é‡çš„æ–¹æ³•æ˜¯ï¼Œåªç¼–ç è¿™ä¸¤è€…è¿åŠ¨å‘é‡çš„å·®ã€‚æ‰€ä»¥ï¼Œæœ€ç»ˆè¿åŠ¨å‘é‡å°±æ˜¯ <code>x=6 (6-0), y=1 (26-25)</code>ã€‚</p>
<blockquote>
<p>å®é™…æƒ…å†µä¸‹ï¼Œè¿™ä¸ªçƒä¼šè¢«åˆ‡æˆ n ä¸ªåˆ†åŒºï¼Œä½†å¤„ç†è¿‡ç¨‹æ˜¯ç›¸åŒçš„ã€‚</p>
</blockquote>
<p>å¸§ä¸Šçš„ç‰©ä½“<strong>ä»¥ä¸‰ç»´æ–¹å¼ç§»åŠ¨</strong>ï¼Œå½“çƒç§»åŠ¨åˆ°èƒŒæ™¯æ—¶ä¼šå˜å°ã€‚å½“æˆ‘ä»¬å°è¯•å¯»æ‰¾åŒ¹é…çš„å—ï¼Œ<strong>æ‰¾ä¸åˆ°å®Œç¾åŒ¹é…çš„å—</strong>æ˜¯æ­£å¸¸çš„ã€‚è¿™æ˜¯ä¸€å¼ è¿åŠ¨é¢„æµ‹ä¸å®é™…å€¼ç›¸å åŠ çš„å›¾ç‰‡ã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/motion_estimation.png" alt="è¿åŠ¨é¢„æµ‹" title="è¿åŠ¨é¢„æµ‹"></p>
<p>ä½†æˆ‘ä»¬èƒ½çœ‹åˆ°å½“æˆ‘ä»¬ä½¿ç”¨<strong>è¿åŠ¨é¢„æµ‹</strong>æ—¶ï¼Œ<strong>ç¼–ç çš„æ•°æ®é‡å°‘äº</strong>ä½¿ç”¨ç®€å•çš„æ®‹å·®å¸§æŠ€æœ¯ã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/comparison_delta_vs_motion_estimation.png" alt="è¿åŠ¨é¢„æµ‹ vs æ®‹å·® " title="è¿åŠ¨é¢„æµ‹ vs æ®‹å·®"></p>
<p>ä½ å¯ä»¥<a href="https://gitee.com/wangwei1237/wangwei1237/blob/master/2020/02/28/Introduction-to-digital-video-technology/py/frame_difference_vs_motion_estimation_plus_residual.ipynb">ä½¿ç”¨ jupyter ç©è½¬è¿™äº›æ¦‚å¿µ</a>ã€‚</p>
<blockquote>
<h3 id="è‡ªå·±åŠ¨æ‰‹ï¼šæŸ¥çœ‹è¿åŠ¨å‘é‡">è‡ªå·±åŠ¨æ‰‹ï¼šæŸ¥çœ‹è¿åŠ¨å‘é‡</h3>
<p>æˆ‘ä»¬å¯ä»¥<a href="https://github.com/leandromoreira/digital_video_introduction/blob/master/encoding_pratical_examples.md#generate-debug-video">ä½¿ç”¨ ffmpeg ç”ŸæˆåŒ…å«å¸§é—´é¢„æµ‹ï¼ˆè¿åŠ¨å‘é‡ï¼‰çš„è§†é¢‘</a>ã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/motion_vectors_ffmpeg.png" alt="ffmpeg å¸§é—´é¢„æµ‹ï¼ˆè¿åŠ¨å‘é‡ï¼‰" title="ffmpeg å¸§é—´é¢„æµ‹ï¼ˆè¿åŠ¨å‘é‡ï¼‰"></p>
<p>æˆ–è€…æˆ‘ä»¬ä¹Ÿå¯ä½¿ç”¨ <a href="https://software.intel.com/en-us/intel-video-pro-analyzer">IntelÂ® Video Pro Analyzer</a>ï¼ˆéœ€è¦ä»˜è´¹ï¼Œä½†ä¹Ÿæœ‰åªèƒ½æŸ¥çœ‹å‰ 10 å¸§çš„å…è´¹è¯•ç”¨ç‰ˆï¼‰ã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/inter_prediction_intel_video_pro_analyzer.png" alt="IntelÂ® Video Pro Analyzer ä½¿ç”¨å¸§é—´é¢„æµ‹" title="inter prediction intel video pro analyzer"></p>
</blockquote>
<h2 id="ç©ºé—´å†—ä½™-å¸§å†…é¢„æµ‹">ç©ºé—´å†—ä½™ï¼ˆå¸§å†…é¢„æµ‹ï¼‰</h2>
<p>å¦‚æœæˆ‘ä»¬åˆ†æä¸€ä¸ªè§†é¢‘é‡Œçš„<strong>æ¯ä¸€å¸§</strong>ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°æœ‰<strong>è®¸å¤šåŒºåŸŸæ˜¯ç›¸äº’å…³è”çš„</strong>ã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/repetitions_in_space.png" alt="ç©ºé—´å†…é‡å¤" title="ç©ºé—´å†…é‡å¤"></p>
<p>è®©æˆ‘ä»¬ä¸¾ä¸€ä¸ªä¾‹å­ã€‚è¿™ä¸ªåœºæ™¯å¤§éƒ¨åˆ†ç”±è“è‰²å’Œç™½è‰²ç»„æˆã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/smw_bg.png" alt="smw èƒŒæ™¯" title="smw èƒŒæ™¯"></p>
<p>è¿™æ˜¯ä¸€ä¸ª <code>I å¸§</code>ï¼Œæˆ‘ä»¬<strong>ä¸èƒ½ä½¿ç”¨å‰é¢çš„å¸§æ¥é¢„æµ‹</strong>ï¼Œä½†æˆ‘ä»¬ä»ç„¶å¯ä»¥å‹ç¼©å®ƒã€‚æˆ‘ä»¬å°†ç¼–ç æˆ‘ä»¬é€‰æ‹©çš„é‚£å—çº¢è‰²åŒºåŸŸã€‚å¦‚æœæˆ‘ä»¬<strong>çœ‹çœ‹å®ƒçš„å‘¨å›´</strong>ï¼Œæˆ‘ä»¬å¯ä»¥<strong>ä¼°è®¡å®ƒå‘¨å›´é¢œè‰²çš„å˜åŒ–</strong>ã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/smw_bg_block.png" alt="smw èƒŒæ™¯å—" title="smw èƒŒæ™¯å—"></p>
<p>æˆ‘ä»¬é¢„æµ‹:å¸§ä¸­çš„é¢œè‰²åœ¨å‚ç›´æ–¹å‘ä¸Šä¿æŒä¸€è‡´ï¼Œè¿™æ„å‘³ç€<strong>æœªçŸ¥åƒç´ çš„é¢œè‰²ä¸ä¸´è¿‘çš„åƒç´ ç›¸åŒ</strong>ã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/smw_bg_prediction.png" alt="smw èƒŒæ™¯é¢„æµ‹" title="smw èƒŒæ™¯é¢„æµ‹"></p>
<p>æˆ‘ä»¬çš„<strong>é¢„æµ‹ä¼šå‡ºé”™</strong>ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å…ˆåˆ©ç”¨è¿™é¡¹æŠ€æœ¯ï¼ˆ<strong>å¸§å†…é¢„æµ‹</strong>ï¼‰ï¼Œç„¶å<strong>å‡å»å®é™…å€¼</strong>ï¼Œç®—å‡ºæ®‹å·®ï¼Œå¾—å‡ºçš„çŸ©é˜µæ¯”åŸå§‹æ•°æ®æ›´å®¹æ˜“å‹ç¼©ã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/smw_residual.png" alt="smw æ®‹å·®" title="smw æ®‹å·®"></p>
<blockquote>
<h3 id="è‡ªå·±åŠ¨æ‰‹ï¼šæŸ¥çœ‹å¸§å†…é¢„æµ‹">è‡ªå·±åŠ¨æ‰‹ï¼šæŸ¥çœ‹å¸§å†…é¢„æµ‹</h3>
<p>ä½ å¯ä»¥<a href="https://github.com/leandromoreira/digital_video_introduction/blob/master/encoding_pratical_examples.md#generate-debug-video">ä½¿ç”¨ ffmpeg ç”ŸæˆåŒ…å«å®å—åŠé¢„æµ‹çš„è§†é¢‘</a>ã€‚è¯·æŸ¥çœ‹ ffmpeg æ–‡æ¡£ä»¥äº†è§£<a href="https://trac.ffmpeg.org/wiki/Debug/MacroblocksAndMotionVectors">æ¯ä¸ªå—é¢œè‰²çš„å«ä¹‰</a>ã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/macro_blocks_ffmpeg.png" alt="ffmpeg å¸§å†…é¢„æµ‹ï¼ˆå®å—ï¼‰" title="ffmpeg å¸§å†…é¢„æµ‹ï¼ˆå®å—ï¼‰"></p>
<p>æˆ–è€…æˆ‘ä»¬ä¹Ÿå¯ä½¿ç”¨ <a href="https://software.intel.com/en-us/intel-video-pro-analyzer">IntelÂ® Video Pro Analyzer</a>ï¼ˆéœ€è¦ä»˜è´¹ï¼Œä½†ä¹Ÿæœ‰åªèƒ½æŸ¥çœ‹å‰ 10 å¸§çš„å…è´¹è¯•ç”¨ç‰ˆï¼‰ã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/intra_prediction_intel_video_pro_analyzer.png" alt="IntelÂ® Video Pro Analyzer å¸§å†…é¢„æµ‹" title="IntelÂ® Video Pro Analyzer å¸§å†…é¢„æµ‹"></p>
</blockquote>
<h1>è§†é¢‘ç¼–è§£ç å™¨æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ</h1>
<h2 id="æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆï¼Ÿæ€ä¹ˆåšï¼Ÿ">æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆï¼Ÿæ€ä¹ˆåšï¼Ÿ</h2>
<p><strong>æ˜¯ä»€ä¹ˆï¼Ÿ</strong> å°±æ˜¯ç”¨äºå‹ç¼©æˆ–è§£å‹æ•°å­—è§†é¢‘çš„è½¯ä»¶æˆ–ç¡¬ä»¶ã€‚<strong>ä¸ºä»€ä¹ˆï¼Ÿ</strong> äººä»¬éœ€è¦åœ¨æœ‰é™å¸¦å®½æˆ–å­˜å‚¨ç©ºé—´ä¸‹æé«˜è§†é¢‘çš„è´¨é‡ã€‚è¿˜è®°å¾—å½“æˆ‘ä»¬è®¡ç®—æ¯ç§’ 30 å¸§ï¼Œæ¯åƒç´  24 bitï¼Œåˆ†è¾¨ç‡æ˜¯ 480x240 çš„è§†é¢‘<a href="#%E5%9F%BA%E6%9C%AC%E6%9C%AF%E8%AF%AD">éœ€è¦å¤šå°‘å¸¦å®½</a>å—ï¼Ÿæ²¡æœ‰å‹ç¼©æ—¶æ˜¯ <strong>82.944 Mbps</strong>ã€‚ç”µè§†æˆ–äº’è”ç½‘æä¾› HD/FullHD/4K åªèƒ½é è§†é¢‘ç¼–è§£ç å™¨ã€‚<strong>æ€ä¹ˆåšï¼Ÿ</strong> æˆ‘ä»¬å°†ç®€å•ä»‹ç»ä¸€ä¸‹ä¸»è¦çš„æŠ€æœ¯ã€‚</p>
<blockquote>
<p>è§†é¢‘ç¼–è§£ç  vs å®¹å™¨</p>
<p>åˆå­¦è€…ä¸€ä¸ªå¸¸è§çš„é”™è¯¯æ˜¯æ··æ·†æ•°å­—è§†é¢‘ç¼–è§£ç å™¨å’Œ<a href="https://en.wikipedia.org/wiki/Digital_container_format">æ•°å­—è§†é¢‘å®¹å™¨</a>ã€‚æˆ‘ä»¬å¯ä»¥å°†<strong>å®¹å™¨</strong>è§†ä¸ºåŒ…å«è§†é¢‘ï¼ˆä¹Ÿå¾ˆå¯èƒ½åŒ…å«éŸ³é¢‘ï¼‰å…ƒæ•°æ®çš„åŒ…è£…æ ¼å¼ï¼Œ<strong>å‹ç¼©è¿‡çš„è§†é¢‘</strong>å¯ä»¥çœ‹æˆæ˜¯å®ƒæ‰¿è½½çš„å†…å®¹ã€‚</p>
<p>é€šå¸¸ï¼Œè§†é¢‘æ–‡ä»¶çš„æ ¼å¼å®šä¹‰å…¶è§†é¢‘å®¹å™¨ã€‚ä¾‹å¦‚ï¼Œæ–‡ä»¶ <code>video.mp4</code> å¯èƒ½æ˜¯ <a href="https://en.wikipedia.org/wiki/MPEG-4_Part_14">MPEG-4 Part 14</a> å®¹å™¨ï¼Œä¸€ä¸ªå« <code>video.mkv</code> çš„æ–‡ä»¶å¯èƒ½æ˜¯ <a href="https://en.wikipedia.org/wiki/Matroska">matroska</a>ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <a href="https://github.com/leandromoreira/digital_video_introduction/blob/master/encoding_pratical_examples.md#inspect-stream">ffmpeg æˆ– mediainfo</a> æ¥å®Œå…¨ç¡®å®šç¼–è§£ç å™¨å’Œå®¹å™¨æ ¼å¼ã€‚</p>
</blockquote>
<h2 id="å†å²">å†å²</h2>
<p>åœ¨æˆ‘ä»¬è·³è¿›é€šç”¨ç¼–è§£ç å™¨å†…éƒ¨å·¥ä½œä¹‹å‰ï¼Œè®©æˆ‘ä»¬å›å¤´äº†è§£ä¸€äº›æ—§çš„è§†é¢‘ç¼–è§£ç å™¨ã€‚</p>
<p>è§†é¢‘ç¼–è§£ç å™¨ <a href="https://en.wikipedia.org/wiki/H.261">H.261</a> è¯ç”Ÿåœ¨ 1990ï¼ˆæŠ€æœ¯ä¸Šæ˜¯ 1988ï¼‰ï¼Œè¢«è®¾è®¡ä¸ºä»¥ <strong>64 kbit/s çš„æ•°æ®é€Ÿç‡</strong>å·¥ä½œã€‚å®ƒå·²ç»ä½¿ç”¨å¦‚è‰²åº¦å­é‡‡æ ·ã€å®å—ï¼Œç­‰ç­‰ç†å¿µã€‚åœ¨ 1995 å¹´ï¼Œ<strong>H.263</strong> è§†é¢‘ç¼–è§£ç å™¨æ ‡å‡†è¢«å‘å¸ƒï¼Œå¹¶ç»§ç»­å»¶ç»­åˆ° 2001 å¹´ã€‚</p>
<p>åœ¨ 2003 å¹´ <strong>H.264/AVC</strong> çš„ç¬¬ä¸€ç‰ˆè¢«å®Œæˆã€‚åœ¨åŒä¸€å¹´ï¼Œä¸€å®¶å«åš <strong>TrueMotion</strong> çš„å…¬å¸å‘å¸ƒäº†ä»–ä»¬çš„<strong>å…ç‰ˆç¨</strong>æœ‰æŸè§†é¢‘å‹ç¼©çš„è§†é¢‘ç¼–è§£ç å™¨ï¼Œç§°ä¸º <strong>VP3</strong>ã€‚åœ¨ 2008 å¹´ï¼Œ<strong>Google æ”¶è´­äº†</strong>è¿™å®¶å…¬å¸ï¼Œåœ¨åŒä¸€å¹´å‘å¸ƒ <strong>VP8</strong>ã€‚åœ¨ 2012 å¹´ 12 æœˆï¼ŒGoogle å‘å¸ƒäº† <strong>VP9</strong>ï¼Œ<strong>å¸‚é¢ä¸Šå¤§çº¦æœ‰ 3/4 çš„æµè§ˆå™¨</strong>ï¼ˆåŒ…æ‹¬æ‰‹æœºï¼‰æ”¯æŒã€‚</p>
<p><a href="https://en.wikipedia.org/wiki/AOMedia_Video_1">AV1</a> æ˜¯ç”± <strong>Google, Mozilla, Microsoft, Amazon, Netflix, AMD, ARM, NVidia, Intel, Cisco</strong> ç­‰å…¬å¸ç»„æˆçš„<a href="http://aomedia.org/">å¼€æ”¾åª’ä½“è”ç›Ÿï¼ˆAOMediaï¼‰</a>è®¾è®¡çš„ä¸€ç§æ–°çš„è§†é¢‘ç¼–è§£ç å™¨ï¼Œå…ç‰ˆç¨ï¼Œå¼€æºã€‚<strong>ç¬¬ä¸€ç‰ˆ</strong> 0.1.0 å‚è€ƒç¼–è§£ç å™¨<strong>å‘å¸ƒäº 2016 å¹´ 4 æœˆ 7 å·</strong>ã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/codec_history_timeline.png" alt="ç¼–è§£ç å™¨å†å²çº¿è·¯å›¾" title="ç¼–è§£ç å™¨å†å²çº¿è·¯å›¾"></p>
<blockquote>
<h3 id="av1-çš„è¯ç”Ÿ">AV1 çš„è¯ç”Ÿ</h3>
<p>2015 å¹´æ—©æœŸï¼ŒGoogle æ­£åœ¨ VP10 ä¸Šå·¥ä½œï¼ŒXiph (Mozilla) æ­£åœ¨ Daala ä¸Šå·¥ä½œï¼ŒCisco å¼€æºäº†å®ƒçš„ç§°ä¸º Thor çš„å…ç‰ˆç¨è§†é¢‘ç¼–è§£ç å™¨ã€‚</p>
<p>æ¥ç€ MPEG LA å®£å¸ƒäº† HEVC (H.265) æ¯å¹´ç‰ˆç¨çš„çš„ä¸Šé™ï¼Œæ¯” H.264 é«˜ 8 å€ï¼Œä½†å¾ˆå¿«ä»–ä»¬åˆå†æ¬¡æ”¹å˜äº†æ¡æ¬¾ï¼š</p>
<ul>
<li><strong>ä¸è®¾å¹´åº¦æ”¶è´¹ä¸Šé™</strong></li>
<li><strong>æ”¶å–å†…å®¹è´¹</strong>ï¼ˆæ”¶å…¥çš„ 0.5%ï¼‰</li>
<li><strong>æ¯å•ä½è´¹ç”¨é«˜äº h264 çš„ 10 å€</strong></li>
</ul>
<p><a href="http://aomedia.org/about-us/">å¼€æ”¾åª’ä½“è”ç›Ÿ</a>ç”±ç¡¬ä»¶å‚å•†ï¼ˆIntel, AMD, ARM , Nvidia, Ciscoï¼‰ï¼Œå†…å®¹åˆ†å‘å•†ï¼ˆGoogle, Netflix, Amazonï¼‰ï¼Œæµè§ˆå™¨ç»´æŠ¤è€…ï¼ˆGoogle, Mozillaï¼‰ï¼Œç­‰å…¬å¸åˆ›å»ºã€‚</p>
<p>è¿™äº›å…¬å¸æœ‰ä¸€ä¸ªå…±åŒç›®æ ‡ï¼Œä¸€ä¸ªå…ç‰ˆç¨çš„è§†é¢‘ç¼–è§£ç å™¨ï¼Œæ‰€ä»¥ AV1 è¯ç”Ÿæ—¶ä½¿ç”¨äº†ä¸€ä¸ªæ›´<a href="http://aomedia.org/license/patent/">ç®€å•çš„ä¸“åˆ©è®¸å¯è¯</a>ã€‚<strong>Timothy B. Terriberry</strong> åšäº†ä¸€ä¸ªç²¾å½©çš„ä»‹ç»ï¼Œ<a href="https://www.youtube.com/watch?v=lzPaldsmJbk">å…³äº AV1 çš„æ¦‚å¿µï¼Œè®¸å¯è¯æ¨¡å¼å’Œå®ƒå½“å‰çš„çŠ¶æ€</a>ï¼Œå°±æ˜¯æœ¬èŠ‚çš„æ¥æºã€‚</p>
<p>å‰å¾€ <a href="http://aomanalyzer.org/">http://aomanalyzer.org/</a>ï¼Œ ä½ ä¼šæƒŠè®¶äº<strong>ä½¿ç”¨ä½ çš„æµè§ˆå™¨å°±å¯ä»¥åˆ†æ AV1 ç¼–è§£ç å™¨</strong>ã€‚<br>
<img src="/2020/02/28/Introduction-to-digital-video-technology/av1_browser_analyzer.png" alt="av1 æµè§ˆå™¨åˆ†æå™¨" title="æµè§ˆå™¨åˆ†æå™¨"></p>
<p>é™„ï¼šå¦‚æœä½ æƒ³äº†è§£æ›´å¤šç¼–è§£ç å™¨çš„å†å²ï¼Œä½ éœ€è¦äº†è§£<a href="https://www.vcodex.com/video-compression-patents/">è§†é¢‘å‹ç¼©ä¸“åˆ©</a>èƒŒåçš„åŸºæœ¬çŸ¥è¯†ã€‚</p>
</blockquote>
<h2 id="é€šç”¨ç¼–è§£ç å™¨">é€šç”¨ç¼–è§£ç å™¨</h2>
<p>æˆ‘ä»¬æ¥ä¸‹æ¥è¦ä»‹ç»<strong>é€šç”¨è§†é¢‘ç¼–è§£ç å™¨èƒŒåçš„ä¸»è¦æœºåˆ¶</strong>ï¼Œå¤§å¤šæ•°æ¦‚å¿µéƒ½å¾ˆå®ç”¨ï¼Œå¹¶è¢«ç°ä»£ç¼–è§£ç å™¨å¦‚ VP9, AV1 å’Œ HEVC ä½¿ç”¨ã€‚éœ€è¦æ³¨æ„ï¼šæˆ‘ä»¬å°†ç®€åŒ–è®¸å¤šå†…å®¹ã€‚æœ‰æ—¶æˆ‘ä»¬ä¼šä½¿ç”¨çœŸå®çš„ä¾‹å­ï¼ˆä¸»è¦æ˜¯ H.264ï¼‰æ¥æ¼”ç¤ºæŠ€æœ¯ã€‚</p>
<h2 id="ç¬¬ä¸€æ­¥-å›¾ç‰‡åˆ†åŒº">ç¬¬ä¸€æ­¥ - å›¾ç‰‡åˆ†åŒº</h2>
<p>ç¬¬ä¸€æ­¥æ˜¯<strong>å°†å¸§</strong>åˆ†æˆå‡ ä¸ª<strong>åˆ†åŒº</strong>ï¼Œ<strong>å­åˆ†åŒº</strong>ç”šè‡³æ›´å¤šã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/picture_partitioning.png" alt="å›¾ç‰‡åˆ†åŒº" title="å›¾ç‰‡åˆ†åŒº"></p>
<p>**ä½†æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ**æœ‰è®¸å¤šåŸå› ï¼Œæ¯”å¦‚ï¼Œå½“æˆ‘ä»¬åˆ†å‰²å›¾ç‰‡æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥æ›´ç²¾ç¡®çš„å¤„ç†é¢„æµ‹ï¼Œåœ¨å¾®å°ç§»åŠ¨çš„éƒ¨åˆ†ä½¿ç”¨è¾ƒå°çš„åˆ†åŒºï¼Œè€Œåœ¨é™æ€èƒŒæ™¯ä¸Šä½¿ç”¨è¾ƒå¤§çš„åˆ†åŒºã€‚</p>
<p>é€šå¸¸ï¼Œç¼–è§£ç å™¨<strong>å°†è¿™äº›åˆ†åŒºç»„ç»‡</strong>æˆåˆ‡ç‰‡ï¼ˆæˆ–ç“¦ç‰‡ï¼‰ï¼Œå®ï¼ˆæˆ–ç¼–ç æ ‘å•å…ƒï¼‰å’Œè®¸å¤šå­åˆ†åŒºã€‚è¿™äº›åˆ†åŒºçš„æœ€å¤§å¤§å°æœ‰æ‰€ä¸åŒï¼ŒHEVC è®¾ç½®æˆ 64x64ï¼Œè€Œ AVC ä½¿ç”¨ 16x16ï¼Œä½†å­åˆ†åŒºå¯ä»¥è¾¾åˆ° 4x4 çš„å¤§å°ã€‚</p>
<p>è¿˜è®°å¾—æˆ‘ä»¬å­¦è¿‡çš„<strong>å¸§çš„åˆ†ç±»</strong>å—ï¼Ÿä½ ä¹Ÿå¯ä»¥<strong>æŠŠè¿™äº›æ¦‚å¿µåº”ç”¨åˆ°å—</strong>ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æœ‰ I åˆ‡ç‰‡ï¼ŒB åˆ‡ç‰‡ï¼ŒI å®å—ç­‰ç­‰ã€‚</p>
<blockquote>
<h3 id="è‡ªå·±åŠ¨æ‰‹ï¼šæŸ¥çœ‹åˆ†åŒº">è‡ªå·±åŠ¨æ‰‹ï¼šæŸ¥çœ‹åˆ†åŒº</h3>
<p>æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ <a href="https://software.intel.com/en-us/intel-video-pro-analyzer">IntelÂ® Video Pro Analyzer</a>ï¼ˆéœ€è¦ä»˜è´¹ï¼Œä½†ä¹Ÿæœ‰åªèƒ½æŸ¥çœ‹å‰ 10 å¸§çš„å…è´¹è¯•ç”¨ç‰ˆï¼‰ã€‚è¿™æ˜¯ <a href="https://github.com/leandromoreira/digital_video_introduction/blob/master/encoding_pratical_examples.md#transcoding">VP9 åˆ†åŒº</a>çš„åˆ†æã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/paritions_view_intel_video_pro_analyzer.png" alt="IntelÂ® Video Pro Analyzer VP9 åˆ†åŒºè§†å›¾ " title="IntelÂ® Video Pro Analyzer VP9 åˆ†åŒºè§†å›¾"></p>
</blockquote>
<h2 id="ç¬¬äºŒæ­¥-é¢„æµ‹">ç¬¬äºŒæ­¥ - é¢„æµ‹</h2>
<p>ä¸€æ—¦æˆ‘ä»¬æœ‰äº†åˆ†åŒºï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨å®ƒä»¬ä¹‹ä¸Šåšå‡ºé¢„æµ‹ã€‚å¯¹äº<a href="#%E6%97%B6%E9%97%B4%E5%86%97%E4%BD%99%EF%BC%88%E5%B8%A7%E9%97%B4%E9%A2%84%E6%B5%8B%EF%BC%89">å¸§é—´é¢„æµ‹</a>ï¼Œæˆ‘ä»¬éœ€è¦<strong>å‘é€è¿åŠ¨å‘é‡å’Œæ®‹å·®</strong>ï¼›è‡³äº<a href="#%E7%A9%BA%E9%97%B4%E5%86%97%E4%BD%99%EF%BC%88%E5%B8%A7%E5%86%85%E9%A2%84%E6%B5%8B%EF%BC%89">å¸§å†…é¢„æµ‹</a>ï¼Œæˆ‘ä»¬éœ€è¦<strong>å‘é€é¢„æµ‹æ–¹å‘å’Œæ®‹å·®</strong>ã€‚</p>
<h2 id="ç¬¬ä¸‰æ­¥-è½¬æ¢">ç¬¬ä¸‰æ­¥ - è½¬æ¢</h2>
<p>åœ¨æˆ‘ä»¬å¾—åˆ°æ®‹å·®å—ï¼ˆ<code>é¢„æµ‹åˆ†åŒº-çœŸå®åˆ†åŒº</code>ï¼‰ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€ç§æ–¹å¼<strong>å˜æ¢</strong>å®ƒï¼Œè¿™æ ·æˆ‘ä»¬å°±çŸ¥é“<strong>å“ªäº›åƒç´ æˆ‘ä»¬åº”è¯¥ä¸¢å¼ƒ</strong>ï¼Œè¿˜ä¾ç„¶èƒ½ä¿æŒ<strong>æ•´ä½“è´¨é‡</strong>ã€‚è¿™ä¸ªç¡®åˆ‡çš„è¡Œä¸ºæœ‰å‡ ç§å˜æ¢æ–¹å¼ã€‚</p>
<p>å°½ç®¡æœ‰<a href="https://en.wikipedia.org/wiki/List_of_Fourier-related_transforms#Discrete_transforms">å…¶å®ƒçš„å˜æ¢æ–¹å¼</a>ï¼Œä½†æˆ‘ä»¬é‡ç‚¹å…³æ³¨ç¦»æ•£ä½™å¼¦å˜æ¢ï¼ˆDCTï¼‰ã€‚<a href="https://en.wikipedia.org/wiki/Discrete_cosine_transform">DCT</a> çš„ä¸»è¦åŠŸèƒ½æœ‰ï¼š</p>
<ul>
<li>å°†<strong>åƒç´ </strong>å—<strong>è½¬æ¢</strong>ä¸ºç›¸åŒå¤§å°çš„<strong>é¢‘ç‡ç³»æ•°å—</strong>ã€‚</li>
<li><strong>å‹ç¼©</strong>èƒ½é‡ï¼Œæ›´å®¹æ˜“æ¶ˆé™¤ç©ºé—´å†—ä½™ã€‚</li>
<li><strong>å¯é€†çš„</strong>ï¼Œä¹Ÿæ„å‘³ç€ä½ å¯ä»¥è¿˜åŸå›åƒç´ ã€‚</li>
</ul>
<blockquote>
<p>2017 å¹´ 2 æœˆ 2 å·ï¼ŒF. M. Bayer å’Œ R. J. Cintra å‘è¡¨äº†ä»–ä»¬çš„è®ºæ–‡ï¼š<a href="https://arxiv.org/abs/1702.00817">å›¾åƒå‹ç¼©çš„ DCT ç±»å˜æ¢åªéœ€è¦ 14 ä¸ªåŠ æ³•</a>ã€‚</p>
</blockquote>
<p>å¦‚æœä½ ä¸ç†è§£æ¯ä¸ªè¦ç‚¹çš„å¥½å¤„ï¼Œä¸ç”¨æ‹…å¿ƒï¼Œæˆ‘ä»¬ä¼šå°è¯•è¿›è¡Œä¸€äº›å®éªŒï¼Œä»¥ä¾¿ä»ä¸­çœ‹åˆ°çœŸæ­£çš„ä»·å€¼ã€‚</p>
<p>æˆ‘ä»¬æ¥çœ‹ä¸‹é¢çš„<strong>åƒç´ å—</strong>ï¼ˆ8x8ï¼‰ï¼š</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/pixel_matrice.png" alt="åƒç´ å€¼çŸ©å½¢" title="åƒç´ å€¼çŸ©å½¢"></p>
<p>ä¸‹é¢æ˜¯å…¶æ¸²æŸ“çš„å—å›¾åƒï¼ˆ8x8ï¼‰ï¼š</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/gray_image.png" alt="åƒç´ å€¼çŸ©å½¢" title="åƒç´ å€¼çŸ©å½¢"></p>
<p>å½“æˆ‘ä»¬å¯¹è¿™ä¸ªåƒç´ å—<strong>åº”ç”¨ DCT</strong> æ—¶ï¼Œ å¾—åˆ°å¦‚ä¸‹<strong>ç³»æ•°å—</strong>ï¼ˆ8x8ï¼‰ï¼š</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/dct_coefficient_values.png" alt="ç³»æ•°å€¼ values" title="ç³»æ•°å€¼"></p>
<p>æ¥ç€å¦‚æœæˆ‘ä»¬æ¸²æŸ“è¿™ä¸ªç³»æ•°å—ï¼Œå°±ä¼šå¾—åˆ°è¿™å¼ å›¾ç‰‡ï¼š</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/dct_coefficient_image.png" alt="dct ç³»æ•°å›¾ç‰‡" title="dct ç³»æ•°å›¾ç‰‡"></p>
<p>å¦‚ä½ æ‰€è§å®ƒçœ‹èµ·æ¥å®Œå…¨ä¸åƒåŸå›¾åƒï¼Œæˆ‘ä»¬å¯èƒ½ä¼šæ³¨æ„åˆ°<strong>ç¬¬ä¸€ä¸ªç³»æ•°</strong>ä¸å…¶å®ƒç³»æ•°éå¸¸ä¸åŒã€‚ç¬¬ä¸€ä¸ªç³»æ•°è¢«ç§°ä¸ºç›´æµåˆ†é‡ï¼Œä»£è¡¨äº†è¾“å…¥æ•°ç»„ä¸­çš„<strong>æ‰€æœ‰æ ·æœ¬</strong>ï¼Œæœ‰ç‚¹<strong>ç±»ä¼¼äºå¹³å‡å€¼</strong>ã€‚</p>
<p>è¿™ä¸ªç³»æ•°å—æœ‰ä¸€ä¸ªæœ‰è¶£çš„å±æ€§ï¼šé«˜é¢‘éƒ¨åˆ†å’Œä½é¢‘éƒ¨åˆ†æ˜¯åˆ†ç¦»çš„ã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/dctfrequ.jpg" alt="dct é¢‘ç‡ç³»æ•°å±æ€§" title="dct é¢‘ç‡ç³»æ•°å±æ€§"></p>
<p>åœ¨ä¸€å¼ å›¾åƒä¸­ï¼Œ<strong>å¤§å¤šæ•°èƒ½é‡</strong>ä¼šé›†ä¸­åœ¨<a href="https://www.iem.thm.de/telekom-labor/zinke/mk/mpeg2beg/whatisit.htm">ä½é¢‘éƒ¨åˆ†</a>ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬å°†å›¾åƒè½¬æ¢æˆé¢‘ç‡ç³»æ•°ï¼Œå¹¶<strong>ä¸¢æ‰é«˜é¢‘ç³»æ•°</strong>ï¼Œæˆ‘ä»¬å°±èƒ½<strong>å‡å°‘æè¿°å›¾åƒæ‰€éœ€çš„æ•°æ®é‡</strong>ï¼Œè€Œä¸ä¼šç‰ºç‰²å¤ªå¤šçš„å›¾åƒè´¨é‡ã€‚</p>
<blockquote>
<p>é¢‘ç‡æ˜¯æŒ‡ä¿¡å·å˜åŒ–çš„é€Ÿåº¦ã€‚</p>
</blockquote>
<p>è®©æˆ‘ä»¬é€šè¿‡å®éªŒå­¦ä¹ è¿™ç‚¹ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ DCT æŠŠåŸå§‹å›¾åƒè½¬æ¢ä¸ºé¢‘ç‡ï¼ˆç³»æ•°å—ï¼‰ï¼Œç„¶åä¸¢æ‰æœ€ä¸é‡è¦çš„ç³»æ•°ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬å°†å®ƒè½¬æ¢ä¸ºå…¶<strong>é¢‘åŸŸ</strong>ã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/dct_coefficient_values.png" alt="ç³»æ•°å€¼" title="ç³»æ•°å€¼"></p>
<p>ç„¶åæˆ‘ä»¬ä¸¢å¼ƒéƒ¨åˆ†ï¼ˆ67%ï¼‰ç³»æ•°ï¼Œä¸»è¦æ˜¯å®ƒçš„å³ä¸‹è§’éƒ¨åˆ†ã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/dct_coefficient_zeroed.png" alt="ç³»æ•°æ¸…é›¶" title="ç³»æ•°æ¸…é›¶"></p>
<p>ç„¶åæˆ‘ä»¬ä»ä¸¢å¼ƒçš„ç³»æ•°å—é‡æ„å›¾åƒï¼ˆè®°ä½ï¼Œè¿™éœ€è¦å¯é€†ï¼‰ï¼Œå¹¶ä¸åŸå§‹å›¾åƒç›¸æ¯”è¾ƒã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/original_vs_quantized.png" alt="åŸå§‹ vs é‡åŒ–" title="åŸå§‹ vs é‡åŒ–"></p>
<p>å¦‚æˆ‘ä»¬æ‰€è§å®ƒé…·ä¼¼åŸå§‹å›¾åƒï¼Œä½†å®ƒå¼•å…¥äº†è®¸å¤šä¸åŸæ¥çš„ä¸åŒï¼Œæˆ‘ä»¬<strong>ä¸¢å¼ƒäº†67.1875%</strong>ï¼Œä½†æˆ‘ä»¬ä»ç„¶å¾—åˆ°è‡³å°‘ç±»ä¼¼äºåŸæ¥çš„ä¸œè¥¿ã€‚æˆ‘ä»¬å¯ä»¥æ›´åŠ æ™ºèƒ½çš„ä¸¢å¼ƒç³»æ•°å»å¾—åˆ°æ›´å¥½çš„å›¾åƒè´¨é‡ï¼Œä½†è¿™æ˜¯ä¸‹ä¸€ä¸ªä¸»é¢˜ã€‚</p>
<blockquote>
<h3 id="ä½¿ç”¨å…¨éƒ¨åƒç´ å½¢æˆæ¯ä¸ªç³»æ•°">ä½¿ç”¨å…¨éƒ¨åƒç´ å½¢æˆæ¯ä¸ªç³»æ•°</h3>
<p>é‡è¦çš„æ˜¯è¦æ³¨æ„ï¼Œæ¯ä¸ªç³»æ•°å¹¶ä¸ç›´æ¥æ˜ å°„åˆ°å•ä¸ªåƒç´ ï¼Œä½†å®ƒæ˜¯æ‰€æœ‰åƒç´ çš„åŠ æƒå’Œã€‚è¿™ä¸ªç¥å¥‡çš„å›¾å½¢å±•ç¤ºäº†å¦‚ä½•è®¡ç®—å‡ºç¬¬ä¸€å’Œç¬¬äºŒä¸ªç³»æ•°ï¼Œä½¿ç”¨æ¯ä¸ªå”¯ä¸€çš„ç´¢å¼•åšæƒé‡ã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/applicat.jpg" alt="dct è®¡ç®—" title="dct è®¡ç®—"></p>
<p>æ¥æºï¼š<a href="https://web.archive.org/web/20150129171151/https://www.iem.thm.de/telekom-labor/zinke/mk/mpeg2beg/whatisit.htm">https://web.archive.org/web/20150129171151/https://www.iem.thm.de/telekom-labor/zinke/mk/mpeg2beg/whatisit.htm</a></p>
<p>ä½ ä¹Ÿå¯ä»¥å°è¯•<a href="https://gitee.com/wangwei1237/wangwei1237/blob/master/2020/02/28/Introduction-to-digital-video-technology/py/dct_better_explained.ipynb">é€šè¿‡æŸ¥çœ‹åœ¨ DCT åŸºç¡€ä¸Šå½¢æˆçš„ç®€å•å›¾ç‰‡æ¥å¯è§†åŒ– DCT</a>ã€‚ä¾‹å¦‚ï¼Œè¿™æ˜¯ä½¿ç”¨æ¯ä¸ªç³»æ•°æƒé‡<a href="https://en.wikipedia.org/wiki/Discrete_cosine_transform#Example_of_IDCT">å½¢æˆçš„å­—ç¬¦ A</a>ã€‚</p>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/5/5e/Idct-animation.gif" alt></p>
</blockquote>
<br>
<blockquote>
<h3 id="è‡ªå·±åŠ¨æ‰‹ï¼šä¸¢å¼ƒä¸åŒçš„ç³»æ•°">è‡ªå·±åŠ¨æ‰‹ï¼šä¸¢å¼ƒä¸åŒçš„ç³»æ•°</h3>
<p>ä½ å¯ä»¥ç©è½¬ <a href="https://gitee.com/wangwei1237/wangwei1237/blob/master/2020/02/28/Introduction-to-digital-video-technology/py/uniform_quantization_experience.ipynb">DCT å˜æ¢</a></p>
</blockquote>
<h2 id="ç¬¬å››æ­¥-é‡åŒ–">ç¬¬å››æ­¥ - é‡åŒ–</h2>
<p>å½“æˆ‘ä»¬ä¸¢å¼ƒä¸€äº›ç³»æ•°æ—¶ï¼Œåœ¨æœ€åä¸€æ­¥ï¼ˆå˜æ¢ï¼‰ï¼Œæˆ‘ä»¬åšäº†ä¸€äº›å½¢å¼çš„é‡åŒ–ã€‚è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬é€‰æ‹©æ€§åœ°å‰”é™¤ä¿¡æ¯ï¼ˆ<strong>æœ‰æŸéƒ¨åˆ†</strong>ï¼‰æˆ–è€…ç®€å•æ¥è¯´ï¼Œæˆ‘ä»¬å°†<strong>é‡åŒ–ç³»æ•°ä»¥å®ç°å‹ç¼©</strong>ã€‚</p>
<p>æˆ‘ä»¬å¦‚ä½•é‡åŒ–ä¸€ä¸ªç³»æ•°å—ï¼Ÿä¸€ä¸ªç®€å•çš„æ–¹æ³•æ˜¯å‡åŒ€é‡åŒ–ï¼Œæˆ‘ä»¬å–ä¸€ä¸ªå—å¹¶<strong>å°†å…¶é™¤ä»¥å•ä¸ªçš„å€¼</strong>ï¼ˆ10ï¼‰ï¼Œå¹¶èˆå…¥å€¼ã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/quantize.png" alt="é‡åŒ–" title="é‡åŒ–"></p>
<p>æˆ‘ä»¬å¦‚ä½•<strong>é€†è½¬</strong>ï¼ˆé‡æ–°é‡åŒ–ï¼‰è¿™ä¸ªç³»æ•°å—ï¼Ÿæˆ‘ä»¬å¯ä»¥é€šè¿‡<strong>ä¹˜ä»¥æˆ‘ä»¬å…ˆå‰é™¤ä»¥çš„ç›¸åŒçš„å€¼</strong>ï¼ˆ10ï¼‰æ¥åšåˆ°ã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/re-quantize.png" alt="é€†è½¬é‡åŒ–" title="é€†è½¬é‡åŒ–"></p>
<p>è¿™<strong>ä¸æ˜¯æœ€å¥½çš„æ–¹æ³•</strong>ï¼Œå› ä¸ºå®ƒæ²¡æœ‰è€ƒè™‘åˆ°æ¯ä¸ªç³»æ•°çš„é‡è¦æ€§ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ª<strong>é‡åŒ–çŸ©é˜µ</strong>æ¥ä»£æ›¿å•ä¸ªå€¼ï¼Œè¿™ä¸ªçŸ©é˜µå¯ä»¥åˆ©ç”¨ DCT çš„å±æ€§ï¼Œå¤šé‡åŒ–å³ä¸‹éƒ¨ï¼Œè€Œå°‘ï¼ˆé‡åŒ–ï¼‰å·¦ä¸Šéƒ¨ï¼Œ<a href="https://www.hdm-stuttgart.de/~maucher/Python/MMCodecs/html/jpegUpToQuant.html">JPEG ä½¿ç”¨äº†ç±»ä¼¼çš„æ–¹æ³•</a>ï¼Œä½ å¯ä»¥é€šè¿‡<a href="https://github.com/google/guetzli/blob/master/guetzli/jpeg_data.h#L40">æŸ¥çœ‹æºç çœ‹çœ‹è¿™ä¸ªçŸ©é˜µ</a>ã€‚</p>
<blockquote>
<h3 id="è‡ªå·±åŠ¨æ‰‹ï¼šé‡åŒ–">è‡ªå·±åŠ¨æ‰‹ï¼šé‡åŒ–</h3>
<p>ä½ å¯ä»¥ç©è½¬<a href="https://gitee.com/wangwei1237/wangwei1237/blob/master/2020/02/28/Introduction-to-digital-video-technology/py/dct_experiences.ipynb">é‡åŒ–</a></p>
</blockquote>
<h2 id="ç¬¬äº”æ­¥-ç†µç¼–ç ">ç¬¬äº”æ­¥ - ç†µç¼–ç </h2>
<p>åœ¨æˆ‘ä»¬é‡åŒ–æ•°æ®ï¼ˆå›¾åƒå—ï¼åˆ‡ç‰‡ï¼å¸§ï¼‰ä¹‹åï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥ä»¥æ— æŸçš„æ–¹å¼æ¥å‹ç¼©å®ƒã€‚æœ‰è®¸å¤šæ–¹æ³•ï¼ˆç®—æ³•ï¼‰å¯ç”¨æ¥å‹ç¼©æ•°æ®ã€‚æˆ‘ä»¬å°†ç®€å•ä½“éªŒå…¶ä¸­å‡ ä¸ªï¼Œä½ å¯ä»¥é˜…è¯»è¿™æœ¬å¾ˆæ£’çš„ä¹¦å»æ·±å…¥ç†è§£ï¼š<a href="https://www.amazon.com/Understanding-Compression-Data-Modern-Developers/dp/1491961538/">Understanding Compression: Data Compression for Modern Developers</a>ã€‚</p>
<h3 id="vlc-ç¼–ç ï¼š">VLC ç¼–ç ï¼š</h3>
<p>è®©æˆ‘ä»¬å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç¬¦å·æµï¼š<strong>a</strong>, <strong>e</strong>, <strong>r</strong> å’Œ <strong>t</strong>ï¼Œå®ƒä»¬çš„æ¦‚ç‡ï¼ˆä»0åˆ°1ï¼‰ç”±ä¸‹è¡¨æ‰€ç¤ºã€‚</p>
<table>
<thead>
<tr>
<th></th>
<th>a</th>
<th>e</th>
<th>r</th>
<th>t</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ¦‚ç‡</td>
<td>0.3</td>
<td>0.3</td>
<td>0.2</td>
<td>0.2</td>
</tr>
</tbody>
</table>
<p>æˆ‘ä»¬å¯ä»¥åˆ†é…ä¸åŒçš„äºŒè¿›åˆ¶ç ï¼Œï¼ˆæœ€å¥½æ˜¯ï¼‰å°çš„ç ç»™æœ€å¯èƒ½ï¼ˆå‡ºç°çš„å­—ç¬¦ï¼‰ï¼Œå¤§äº›çš„ç ç»™æœ€å°‘å¯èƒ½ï¼ˆå‡ºç°çš„å­—ç¬¦ï¼‰ã€‚</p>
<table>
<thead>
<tr>
<th></th>
<th>a</th>
<th>e</th>
<th>r</th>
<th>t</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ¦‚ç‡</td>
<td>0.3</td>
<td>0.3</td>
<td>0.2</td>
<td>0.2</td>
</tr>
<tr>
<td>äºŒè¿›åˆ¶ç </td>
<td>0</td>
<td>10</td>
<td>110</td>
<td>1110</td>
</tr>
</tbody>
</table>
<p>è®©æˆ‘ä»¬å‹ç¼© <strong>eat</strong> æµï¼Œå‡è®¾æˆ‘ä»¬ä¸ºæ¯ä¸ªå­—ç¬¦èŠ±è´¹ 8 bitï¼Œåœ¨æ²¡æœ‰åšä»»ä½•å‹ç¼©æ—¶æˆ‘ä»¬å°†èŠ±è´¹ <strong>24 bit</strong>ã€‚ä½†æ˜¯åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨å„è‡ªçš„ä»£ç æ¥æ›¿æ¢æ¯ä¸ªå­—ç¬¦ï¼Œæˆ‘ä»¬å°±èƒ½èŠ‚çœç©ºé—´ã€‚</p>
<p>ç¬¬ä¸€æ­¥æ˜¯ç¼–ç å­—ç¬¦ <strong>e</strong> ä¸º <code>10</code>ï¼Œç¬¬äºŒä¸ªå­—ç¬¦æ˜¯ <strong>a</strong>ï¼Œè¿½åŠ ï¼ˆä¸æ˜¯æ•°å­¦åŠ æ³•ï¼‰åæ˜¯ <code>[10][0]</code>ï¼Œæœ€åæ˜¯ç¬¬ä¸‰ä¸ªå­—ç¬¦ <strong>t</strong>ï¼Œæœ€ç»ˆç»„æˆå·²å‹ç¼©çš„æ¯”ç‰¹æµ <code>[10][0][1110]</code> æˆ– <code>1001110</code>ï¼Œè¿™åªéœ€ <strong>7 bit</strong>ï¼ˆæ¯”åŸæ¥çš„ç©ºé—´å°‘ 3.4 å€ï¼‰ã€‚</p>
<p>è¯·æ³¨æ„æ¯ä¸ªä»£ç å¿…é¡»æ˜¯å”¯ä¸€çš„å‰ç¼€ç ï¼Œ<a href="https://en.wikipedia.org/wiki/Huffman_coding">Huffman èƒ½å¸®ä½ æ‰¾åˆ°è¿™äº›æ•°å­—</a>ã€‚è™½ç„¶å®ƒæœ‰ä¸€äº›é—®é¢˜ï¼Œä½†æ˜¯<a href="https://en.wikipedia.org/wiki/Context-adaptive_variable-length_coding">è§†é¢‘ç¼–è§£ç å™¨ä»ç„¶æä¾›è¯¥æ–¹æ³•</a>ï¼Œå®ƒä¹Ÿæ˜¯å¾ˆå¤šåº”ç”¨ç¨‹åºçš„å‹ç¼©ç®—æ³•ã€‚</p>
<p>ç¼–ç å™¨å’Œè§£ç å™¨éƒ½<strong>å¿…é¡»çŸ¥é“</strong>è¿™ä¸ªï¼ˆåŒ…å«ç¼–ç çš„ï¼‰å­—ç¬¦è¡¨ï¼Œå› æ­¤ï¼Œä½ ä¹Ÿéœ€è¦ä¼ é€è¿™ä¸ªè¡¨ã€‚</p>
<h3 id="ç®—æœ¯ç¼–ç ">ç®—æœ¯ç¼–ç </h3>
<p>è®©æˆ‘ä»¬å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç¬¦å·æµï¼š<strong>a</strong>, <strong>e</strong>, <strong>r</strong>, <strong>s</strong> å’Œ <strong>t</strong>ï¼Œå®ƒä»¬çš„æ¦‚ç‡ç”±ä¸‹è¡¨æ‰€ç¤ºã€‚</p>
<table>
<thead>
<tr>
<th></th>
<th>a</th>
<th>e</th>
<th>r</th>
<th>s</th>
<th>t</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ¦‚ç‡</td>
<td>0.3</td>
<td>0.3</td>
<td>0.15</td>
<td>0.05</td>
<td>0.2</td>
</tr>
</tbody>
</table>
<p>è€ƒè™‘åˆ°è¿™ä¸ªè¡¨ï¼Œæˆ‘ä»¬å¯ä»¥æ„å»ºä¸€ä¸ªåŒºé—´ï¼ŒåŒºé—´åŒ…å«äº†æ‰€æœ‰å¯èƒ½çš„å­—ç¬¦ï¼Œå­—ç¬¦æŒ‰å‡ºç°æ¦‚ç‡æ’åºã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/range.png" alt="åˆå§‹ç®—æ³•åŒºé—´" title="åˆå§‹ç®—æ³•åŒºé—´"></p>
<p>è®©æˆ‘ä»¬ç¼–ç  <strong>eat</strong> æµï¼Œæˆ‘ä»¬é€‰æ‹©ç¬¬ä¸€ä¸ªå­—ç¬¦ <strong>e</strong> ä½äº <strong>0.3 åˆ° 0.6</strong> ï¼ˆä½†ä¸åŒ…æ‹¬ 0.6ï¼‰çš„å­åŒºé—´ï¼Œæˆ‘ä»¬é€‰æ‹©è¿™ä¸ªå­åŒºé—´ï¼ŒæŒ‰ç…§ä¹‹å‰åŒç­‰çš„æ¯”ä¾‹å†æ¬¡åˆ†å‰²ã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/second_subrange.png" alt="ç¬¬äºŒä¸ªå­åŒºé—´" title="ç¬¬äºŒä¸ªå­åŒºé—´"></p>
<p>è®©æˆ‘ä»¬ç»§ç»­ç¼–ç æˆ‘ä»¬çš„æµ <strong>eat</strong>ï¼Œç°åœ¨ä½¿ç¬¬äºŒä¸ª <strong>a</strong> å­—ç¬¦ä½äº <strong>0.3 åˆ° 0.39</strong> çš„åŒºé—´é‡Œï¼Œæ¥ç€å†æ¬¡ç”¨åŒæ ·çš„æ–¹æ³•ç¼–ç æœ€åçš„å­—ç¬¦ <strong>t</strong>ï¼Œå¾—åˆ°æœ€åçš„å­åŒºé—´ <strong>0.354 åˆ° 0.372</strong>ã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/arithimetic_range.png" alt="æœ€ç»ˆç®—æ³•åŒºé—´" title="æœ€ç»ˆç®—æ³•åŒºé—´"></p>
<p>æˆ‘ä»¬åªéœ€ä»æœ€åçš„å­åŒºé—´ 0.354 åˆ° 0.372 é‡Œé€‰æ‹©ä¸€ä¸ªæ•°ï¼Œè®©æˆ‘ä»¬é€‰æ‹© 0.36ï¼Œä¸è¿‡æˆ‘ä»¬å¯ä»¥é€‰æ‹©è¿™ä¸ªå­åŒºé—´é‡Œçš„ä»»ä½•æ•°ã€‚ä»…é è¿™ä¸ªæ•°ï¼Œæˆ‘ä»¬å°†å¯ä»¥æ¢å¤åŸå§‹æµ <strong>eat</strong>ã€‚å°±åƒæˆ‘ä»¬åœ¨åŒºé—´çš„åŒºé—´é‡Œç”»äº†ä¸€æ ¹çº¿æ¥ç¼–ç æˆ‘ä»¬çš„æµã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/range_show.png" alt="æœ€ç»ˆåŒºé—´æ¨ªæ–­é¢" title="æœ€ç»ˆåŒºé—´æ¨ªæ–­é¢"></p>
<p><strong>åå‘è¿‡ç¨‹</strong>ï¼ˆåˆåè§£ç ï¼‰ä¸€æ ·ç®€å•ï¼Œç”¨æ•°å­— <strong>0.36</strong> å’Œæˆ‘ä»¬åŸå§‹åŒºé—´ï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡ŒåŒæ ·çš„æ“ä½œï¼Œä¸è¿‡ç°åœ¨æ˜¯ä½¿ç”¨è¿™ä¸ªæ•°å­—æ¥è¿˜åŸè¢«ç¼–ç çš„æµã€‚</p>
<p>åœ¨ç¬¬ä¸€ä¸ªåŒºé—´ï¼Œæˆ‘ä»¬å‘ç°æ•°å­—è½å…¥äº†ä¸€ä¸ªå­åŒºé—´ï¼Œå› æ­¤ï¼Œè¿™ä¸ªå­åŒºé—´æ˜¯æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ï¼Œç°åœ¨æˆ‘ä»¬å†æ¬¡åˆ‡åˆ†è¿™ä¸ªå­åŒºé—´ï¼Œåƒä¹‹å‰ä¸€æ ·åšåŒæ ·çš„è¿‡ç¨‹ã€‚æˆ‘ä»¬ä¼šæ³¨æ„åˆ° <strong>0.36</strong> è½å…¥äº† <strong>a</strong> çš„åŒºé—´ï¼Œç„¶åæˆ‘ä»¬é‡å¤è¿™ä¸€è¿‡ç¨‹ç›´åˆ°å¾—åˆ°æœ€åä¸€ä¸ªå­—ç¬¦ <strong>t</strong>ï¼ˆå½¢æˆæˆ‘ä»¬åŸå§‹ç¼–ç è¿‡çš„æµ eatï¼‰ã€‚</p>
<p>ç¼–ç å™¨å’Œè§£ç å™¨éƒ½<strong>å¿…é¡»çŸ¥é“</strong>å­—ç¬¦æ¦‚ç‡è¡¨ï¼Œå› æ­¤ï¼Œä½ ä¹Ÿéœ€è¦ä¼ é€è¿™ä¸ªè¡¨ã€‚</p>
<p>éå¸¸å·§å¦™ï¼Œä¸æ˜¯å—ï¼Ÿäººä»¬èƒ½æƒ³å‡ºè¿™æ ·çš„è§£å†³æ–¹æ¡ˆå®åœ¨æ˜¯å¤ªèªæ˜äº†ï¼Œä¸€äº›<a href="https://en.wikipedia.org/wiki/Context-adaptive_binary_arithmetic_coding">è§†é¢‘ç¼–è§£ç å™¨ä½¿ç”¨</a>è¿™é¡¹æŠ€æœ¯ï¼ˆæˆ–è‡³å°‘æä¾›è¿™ä¸€é€‰æ‹©ï¼‰ã€‚</p>
<p>å…³äºæ— æŸå‹ç¼©é‡åŒ–æ¯”ç‰¹æµçš„åŠæ³•ï¼Œè¿™ç¯‡æ–‡ç« æ— ç–‘ç¼ºå°‘äº†å¾ˆå¤šç»†èŠ‚ã€åŸå› ã€æƒè¡¡ç­‰ç­‰ã€‚ä½œä¸ºä¸€ä¸ªå¼€å‘è€…ä½ <a href="https://www.amazon.com/Understanding-Compression-Data-Modern-Developers/dp/1491961538/">åº”è¯¥å­¦ä¹ æ›´å¤š</a>ã€‚åˆšå…¥é—¨è§†é¢‘ç¼–ç çš„äººå¯ä»¥å°è¯•ä½¿ç”¨ä¸åŒçš„<a href="https://en.wikipedia.org/wiki/Asymmetric_Numeral_Systems">ç†µç¼–ç ç®—æ³•ï¼Œå¦‚ANS</a>ã€‚</p>
<blockquote>
<h3 id="è‡ªå·±åŠ¨æ‰‹ï¼šcabac-vs-cavlc">è‡ªå·±åŠ¨æ‰‹ï¼šCABAC vs CAVLC</h3>
<p>ä½ å¯ä»¥<a href="https://github.com/leandromoreira/introduction_video_technology/blob/master/encoding_pratical_examples.md#cabac-vs-cavlc">ç”Ÿæˆä¸¤ä¸ªæµï¼Œä¸€ä¸ªä½¿ç”¨ CABACï¼Œå¦ä¸€ä¸ªä½¿ç”¨ CAVLC</a>ï¼Œå¹¶æ¯”è¾ƒç”Ÿæˆæ¯ä¸€ä¸ªçš„æ—¶é—´ä»¥åŠæœ€ç»ˆçš„å¤§å°ã€‚</p>
</blockquote>
<h2 id="ç¬¬å…­æ­¥-æ¯”ç‰¹æµæ ¼å¼">ç¬¬å…­æ­¥ - æ¯”ç‰¹æµæ ¼å¼</h2>
<p>å®Œæˆæ‰€æœ‰è¿™äº›æ­¥ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦å°†<strong>å‹ç¼©è¿‡çš„å¸§å’Œå†…å®¹æ‰“åŒ…è¿›å»</strong>ã€‚éœ€è¦æ˜ç¡®å‘ŠçŸ¥è§£ç å™¨<strong>ç¼–ç å®šä¹‰</strong>ï¼Œå¦‚é¢œè‰²æ·±åº¦ï¼Œé¢œè‰²ç©ºé—´ï¼Œåˆ†è¾¨ç‡ï¼Œé¢„æµ‹ä¿¡æ¯ï¼ˆè¿åŠ¨å‘é‡ï¼Œå¸§å†…é¢„æµ‹æ–¹å‘ï¼‰ï¼Œé…ç½®<sup>*</sup>ï¼Œå±‚çº§<sup>*</sup>ï¼Œå¸§ç‡ï¼Œå¸§ç±»å‹ï¼Œå¸§å·ç­‰ç­‰æ›´å¤šä¿¡æ¯ã€‚</p>
<blockquote>
<p><sup>*</sup> è¯‘æ³¨ï¼šåŸæ–‡ä¸º profile å’Œ levelï¼Œæ²¡æœ‰é€šç”¨çš„è¯‘å</p>
</blockquote>
<p>æˆ‘ä»¬å°†ç®€å•åœ°å­¦ä¹  H.264 æ¯”ç‰¹æµã€‚ç¬¬ä¸€æ­¥æ˜¯<a href="https://github.com/leandromoreira/introduction_video_technology/blob/master/encoding_pratical_examples.md#generate-a-single-frame-h264-bitstream">ç”Ÿæˆä¸€ä¸ªå°çš„ H.264<sup>*</sup> æ¯”ç‰¹æµ</a>ï¼Œå¯ä»¥ä½¿ç”¨æœ¬ repo å’Œ <a href="http://ffmpeg.org/">ffmpeg</a> æ¥åšã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.&#x2F;s&#x2F;ffmpeg -i &#x2F;files&#x2F;i&#x2F;minimal.png -pix_fmt yuv420p &#x2F;files&#x2F;v&#x2F;minimal_yuv420.h264</span><br></pre></td></tr></table></figure>
<blockquote>
<p><sup>*</sup> ffmpeg é»˜è®¤å°†æ‰€æœ‰å‚æ•°æ·»åŠ ä¸º <strong>SEI NAL</strong>ï¼Œå¾ˆå¿«æˆ‘ä»¬ä¼šå®šä¹‰ä»€ä¹ˆæ˜¯ NALã€‚</p>
</blockquote>
<p>è¿™ä¸ªå‘½ä»¤ä¼šä½¿ç”¨ä¸‹é¢çš„å›¾ç‰‡ä½œä¸ºå¸§ï¼Œç”Ÿæˆä¸€ä¸ªå…·æœ‰<strong>å•ä¸ªå¸§</strong>ï¼Œ64x64 å’Œé¢œè‰²ç©ºé—´ä¸º yuv420 çš„åŸå§‹ h264 æ¯”ç‰¹æµã€‚</p>
<blockquote>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/minimal.png" alt="ä½¿ç”¨å¸§æ¥ç”Ÿæˆæç®€ h264 æ¯”ç‰¹æµ" title="ä½¿ç”¨å¸§æ¥ç”Ÿæˆæç®€ h264 æ¯”ç‰¹æµ"></p>
</blockquote>
<h3 id="h-264-æ¯”ç‰¹æµ">H.264 æ¯”ç‰¹æµ</h3>
<p>AVC (H.264) æ ‡å‡†è§„å®šä¿¡æ¯å°†åœ¨å®å¸§ï¼ˆç½‘ç»œæ¦‚å¿µä¸Šçš„ï¼‰å†…ä¼ è¾“ï¼Œç§°ä¸º <a href="https://en.wikipedia.org/wiki/Network_Abstraction_Layer">NAL</a>ï¼ˆç½‘ç»œæŠ½è±¡å±‚ï¼‰ã€‚NAL çš„ä¸»è¦ç›®æ ‡æ˜¯æä¾›â€œç½‘ç»œå‹å¥½â€çš„è§†é¢‘å‘ˆç°æ–¹å¼ï¼Œè¯¥æ ‡å‡†å¿…é¡»é€‚ç”¨äºç”µè§†ï¼ˆåŸºäºæµï¼‰ï¼Œäº’è”ç½‘ï¼ˆåŸºäºæ•°æ®åŒ…ï¼‰ç­‰ã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/nal_units.png" alt="H.264 NAL å•å…ƒ" title="H.264 NAL å•å…ƒ"></p>
<p><a href="https://en.wikipedia.org/wiki/Frame_synchronization">åŒæ­¥æ ‡è®°</a>ç”¨æ¥å®šä¹‰ NAL å•å…ƒçš„è¾¹ç•Œã€‚æ¯ä¸ªåŒæ­¥æ ‡è®°çš„å€¼å›ºå®šä¸º  <code>0x00 0x00 0x01</code> ï¼Œæœ€å¼€å¤´çš„æ ‡è®°ä¾‹å¤–ï¼Œå®ƒçš„å€¼æ˜¯  <code>0x00 0x00 0x00 0x01</code> ã€‚å¦‚æœæˆ‘ä»¬åœ¨ç”Ÿæˆçš„ h264 æ¯”ç‰¹æµä¸Šè¿è¡Œ <strong>hexdump</strong>ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ–‡ä»¶çš„å¼€å¤´è¯†åˆ«è‡³å°‘ä¸‰ä¸ª NALã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/minimal_yuv420_hex.png" alt="NAL å•å…ƒä¸Šçš„åŒæ­¥æ ‡è®°" title="NAL å•å…ƒä¸Šçš„åŒæ­¥æ ‡è®°"></p>
<p>æˆ‘ä»¬ä¹‹å‰è¯´è¿‡ï¼Œè§£ç å™¨éœ€è¦çŸ¥é“ä¸ä»…ä»…æ˜¯å›¾ç‰‡æ•°æ®ï¼Œè¿˜æœ‰è§†é¢‘çš„è¯¦ç»†ä¿¡æ¯ï¼Œå¦‚ï¼šå¸§ã€é¢œè‰²ã€ä½¿ç”¨çš„å‚æ•°ç­‰ã€‚æ¯ä¸ª NAL çš„<strong>ç¬¬ä¸€ä½</strong>å®šä¹‰äº†å…¶åˆ†ç±»å’Œ<strong>ç±»å‹</strong>ã€‚</p>
<table>
<thead>
<tr>
<th>NAL type id</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>Undefined</td>
</tr>
<tr>
<td>1</td>
<td>Coded slice of a non-IDR picture</td>
</tr>
<tr>
<td>2</td>
<td>Coded slice data partition A</td>
</tr>
<tr>
<td>3</td>
<td>Coded slice data partition B</td>
</tr>
<tr>
<td>4</td>
<td>Coded slice data partition C</td>
</tr>
<tr>
<td>5</td>
<td><strong>IDR</strong> Coded slice of an IDR picture</td>
</tr>
<tr>
<td>6</td>
<td><strong>SEI</strong> Supplemental enhancement information</td>
</tr>
<tr>
<td>7</td>
<td><strong>SPS</strong> Sequence parameter set</td>
</tr>
<tr>
<td>8</td>
<td><strong>PPS</strong> Picture parameter set</td>
</tr>
<tr>
<td>9</td>
<td>Access unit delimiter</td>
</tr>
<tr>
<td>10</td>
<td>End of sequence</td>
</tr>
<tr>
<td>11</td>
<td>End of stream</td>
</tr>
<tr>
<td>â€¦</td>
<td>â€¦</td>
</tr>
</tbody>
</table>
<p>é€šå¸¸ï¼Œæ¯”ç‰¹æµçš„ç¬¬ä¸€ä¸ª NAL æ˜¯ <strong>SPS</strong>ï¼Œè¿™ä¸ªç±»å‹çš„ NAL è´Ÿè´£ä¼ è¾¾é€šç”¨ç¼–ç å‚æ•°ï¼Œå¦‚<strong>é…ç½®ï¼Œå±‚çº§ï¼Œåˆ†è¾¨ç‡</strong>ç­‰ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬è·³è¿‡ç¬¬ä¸€ä¸ªåŒæ­¥æ ‡è®°ï¼Œå°±å¯ä»¥é€šè¿‡è§£ç <strong>ç¬¬ä¸€ä¸ªå­—èŠ‚</strong>æ¥äº†è§£ç¬¬ä¸€ä¸ª <strong>NAL çš„ç±»å‹</strong>ã€‚</p>
<p>ä¾‹å¦‚åŒæ­¥æ ‡è®°ä¹‹åçš„ç¬¬ä¸€ä¸ªå­—èŠ‚æ˜¯ <code>01100111</code>ï¼Œç¬¬ä¸€ä½ï¼ˆ<code>0</code>ï¼‰æ˜¯ <strong>forbidden_zero_bit</strong> å­—æ®µï¼Œæ¥ä¸‹æ¥çš„ä¸¤ä½ï¼ˆ<code>11</code>ï¼‰å‘Šè¯‰æˆ‘ä»¬æ˜¯ <strong>nal_ref_idc</strong> å­—æ®µï¼Œå…¶è¡¨ç¤ºè¯¥ NAL æ˜¯å¦æ˜¯å‚è€ƒå­—æ®µï¼Œå…¶ä½™ 5 ä½ï¼ˆ<code>00111</code>ï¼‰å‘Šè¯‰æˆ‘ä»¬æ˜¯ <strong>nal_unit_type</strong> å­—æ®µï¼Œåœ¨è¿™ä¸ªä¾‹å­é‡Œæ˜¯ NAL å•å…ƒ <strong>SPS</strong> (7)ã€‚</p>
<p>SPS NAL çš„ç¬¬ 2 ä½ (<code>binary=01100100, hex=0x64, dec=100</code>) æ˜¯ <strong>profile_idc</strong> å­—æ®µï¼Œæ˜¾ç¤ºç¼–ç å™¨ä½¿ç”¨çš„é…ç½®ï¼Œåœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨<a href="https://en.wikipedia.org/wiki/H.264/MPEG-4_AVC#Profiles">å—é™é«˜é…ç½®</a>ï¼Œä¸€ç§æ²¡æœ‰ Bï¼ˆåŒå‘é¢„æµ‹ï¼‰ åˆ‡ç‰‡æ”¯æŒçš„é«˜é…ç½®ã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/minimal_yuv420_bin.png" alt="SPS äºŒè¿›åˆ¶è§†å›¾" title="SPS äºŒè¿›åˆ¶è§†å›¾"></p>
<p>å½“æˆ‘ä»¬é˜…è¯» SPS NAL çš„ H.264 æ¯”ç‰¹æµè§„èŒƒæ—¶ï¼Œä¼šä¸º<strong>å‚æ•°åç§°</strong>ï¼Œ<strong>åˆ†ç±»</strong>å’Œ<strong>æè¿°</strong>æ‰¾åˆ°è®¸å¤šå€¼ï¼Œä¾‹å¦‚ï¼Œçœ‹çœ‹å­—æ®µ <code>pic_width_in_mbs_minus_1</code> å’Œ <code>pic_height_in_map_units_minus_1</code>ã€‚</p>
<table>
<thead>
<tr>
<th>å‚æ•°åç§°</th>
<th>åˆ†ç±»</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td>pic_width_in_mbs_minus_1</td>
<td>0</td>
<td>ue(v)</td>
</tr>
<tr>
<td>pic_height_in_map_units_minus_1</td>
<td>0</td>
<td>ue(v)</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>ue(v)</strong>: æ— ç¬¦å·æ•´å½¢ <a href="https://pythonhosted.org/bitstring/exp-golomb.html">Exp-Golomb-coded</a></p>
</blockquote>
<p>å¦‚æœæˆ‘ä»¬å¯¹è¿™äº›å­—æ®µçš„å€¼è¿›è¡Œä¸€äº›è®¡ç®—ï¼Œå°†æœ€ç»ˆå¾—å‡º<strong>åˆ†è¾¨ç‡</strong>ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å€¼ä¸º <code>119ï¼ˆ (119 + 1) * macroblock_size = 120 * 16 = 1920ï¼‰</code>çš„ <code>pic_width_in_mbs_minus_1</code> è¡¨ç¤º <code>1920 x 1080</code>ï¼Œå†æ¬¡ä¸ºäº†å‡å°‘ç©ºé—´ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>119</code> æ¥ä»£æ›¿ç¼–ç  <code>1920</code>ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬å†æ¬¡ä½¿ç”¨äºŒè¿›åˆ¶è§†å›¾æ£€æŸ¥æˆ‘ä»¬åˆ›å»ºçš„è§†é¢‘ (ex: <code>xxd -b -c 11 v/minimal_yuv420.h264</code>)ï¼Œå¯ä»¥è·³åˆ°å¸§è‡ªèº«ä¸Šä¸€ä¸ª NALã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/slice_nal_idr_bin.png" alt="h264 idr åˆ‡ç‰‡å¤´" title="h264 idr åˆ‡ç‰‡å¤´"></p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ€å¼€å§‹çš„ 6 ä¸ªå­—èŠ‚ï¼š<code>01100101 10001000 10000100 00000000 00100001 11111111</code>ã€‚æˆ‘ä»¬å·²ç»çŸ¥é“ç¬¬ä¸€ä¸ªå­—èŠ‚å‘Šè¯‰æˆ‘ä»¬ NAL çš„ç±»å‹ï¼Œåœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œ (<code>00101</code>) æ˜¯ <strong>IDR åˆ‡ç‰‡ (5)</strong>ï¼Œå¯ä»¥è¿›ä¸€æ­¥æ£€æŸ¥å®ƒï¼š</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/slice_header.png" alt="h264 åˆ‡ç‰‡å¤´è§„æ ¼" title="h264 åˆ‡ç‰‡å¤´è§„æ ¼"></p>
<p>å¯¹ç…§è§„èŒƒï¼Œæˆ‘ä»¬èƒ½è§£ç åˆ‡ç‰‡çš„ç±»å‹ï¼ˆ<strong>slice_type</strong>ï¼‰ï¼Œå¸§å·ï¼ˆ<strong>frame_num</strong>ï¼‰ç­‰é‡è¦å­—æ®µã€‚</p>
<p>ä¸ºäº†è·å¾—ä¸€äº›å­—æ®µï¼ˆ<code>ue(v), me(v), se(v) æˆ– te(v)</code>ï¼‰çš„å€¼ï¼Œæˆ‘ä»¬éœ€è¦ç§°ä¸º <a href="https://pythonhosted.org/bitstring/exp-golomb.html">Exponential-Golomb</a> çš„ç‰¹å®šè§£ç å™¨æ¥è§£ç å®ƒã€‚å½“å­˜åœ¨å¾ˆå¤šé»˜è®¤å€¼æ—¶ï¼Œè¿™ä¸ªæ–¹æ³•ç¼–ç å˜é‡å€¼ç‰¹åˆ«é«˜æ•ˆã€‚</p>
<blockquote>
<p>è¿™ä¸ªè§†é¢‘é‡Œ <strong>slice_type</strong> å’Œ <strong>frame_num</strong> çš„å€¼æ˜¯ 7ï¼ˆI åˆ‡ç‰‡ï¼‰å’Œ 0ï¼ˆç¬¬ä¸€å¸§ï¼‰ã€‚</p>
</blockquote>
<p>æˆ‘ä»¬å¯ä»¥å°†<strong>æ¯”ç‰¹æµè§†ä¸ºä¸€ä¸ªåè®®</strong>ï¼Œå¦‚æœä½ æƒ³å­¦ä¹ æ›´å¤šå…³äºæ¯”ç‰¹æµçš„å†…å®¹ï¼Œè¯·å‚è€ƒ <a href="http://www.itu.int/rec/T-REC-H.264-201610-I">ITU H.264 è§„èŒƒ</a>ã€‚è¿™ä¸ªå®è§‚å›¾å±•ç¤ºäº†å›¾ç‰‡æ•°æ®ï¼ˆå‹ç¼©è¿‡çš„ YUVï¼‰æ‰€åœ¨çš„ä½ç½®ã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/h264_bitstream_macro_diagram.png" alt="h264 æ¯”ç‰¹æµå®è§‚å›¾" title="h264 æ¯”ç‰¹æµå®è§‚å›¾"></p>
<p>æˆ‘ä»¬å¯ä»¥æ¢ç©¶å…¶å®ƒæ¯”ç‰¹æµï¼Œå¦‚ <a href="https://storage.googleapis.com/downloads.webmproject.org/docs/vp9/vp9-bitstream-specification-v0.6-20160331-draft.pdf">VP9 æ¯”ç‰¹æµ</a>ï¼Œ<a href="http://handle.itu.int/11.1002/1000/11885-en?locatt=format:pdf">H.265ï¼ˆHEVCï¼‰</a>æˆ–æ˜¯æˆ‘ä»¬çš„æ–°æœ‹å‹ <a href="https://medium.com/@mbebenita/av1-bitstream-analyzer-d25f1c27072b#.d5a89oxz8">AV1 æ¯”ç‰¹æµ</a>ï¼Œ<a href="http://www.gpac-licensing.com/2016/07/12/vp9-av1-bitstream-format/">ä»–ä»¬å¾ˆç›¸ä¼¼å—ï¼Ÿä¸</a>ï¼Œä½†åªè¦å­¦ä¹ äº†å…¶ä¸­ä¹‹ä¸€ï¼Œå­¦ä¹ å…¶ä»–çš„å°±ç®€å•å¤šäº†ã€‚</p>
<blockquote>
<h3 id="è‡ªå·±åŠ¨æ‰‹ï¼šæ£€æŸ¥-h-264-æ¯”ç‰¹æµ">è‡ªå·±åŠ¨æ‰‹ï¼šæ£€æŸ¥ H.264 æ¯”ç‰¹æµ</h3>
<p>æˆ‘ä»¬å¯ä»¥<a href="https://github.com/leandromoreira/introduction_video_technology/blob/master/encoding_pratical_examples.md#generate-a-single-frame-video">ç”Ÿæˆä¸€ä¸ªå•å¸§è§†é¢‘</a>ï¼Œä½¿ç”¨ <a href="https://en.wikipedia.org/wiki/MediaInfo">mediainfo</a> æ£€æŸ¥å®ƒçš„ H.264 æ¯”ç‰¹æµã€‚äº‹å®ä¸Šï¼Œä½ ç”šè‡³å¯ä»¥æŸ¥çœ‹<a href="https://github.com/MediaArea/MediaInfoLib/blob/master/Source/MediaInfo/Video/File_Avc.cpp">è§£æ h264(AVC) è§†é¢‘æµçš„æºä»£ç </a>ã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/mediainfo_details_1.png" alt="mediainfo h264 æ¯”ç‰¹æµçš„è¯¦æƒ… " title="mediainfo h264 æ¯”ç‰¹æµçš„è¯¦æƒ…"></p>
<p>æˆ‘ä»¬ä¹Ÿå¯ä½¿ç”¨ <a href="https://software.intel.com/en-us/intel-video-pro-analyzer">IntelÂ® Video Pro Analyzer</a>ï¼Œéœ€è¦ä»˜è´¹ï¼Œä½†ä¹Ÿæœ‰åªèƒ½æŸ¥çœ‹å‰ 10 å¸§çš„å…è´¹è¯•ç”¨ç‰ˆï¼Œè¿™å·²ç»å¤Ÿè¾¾æˆå­¦ä¹ ç›®çš„äº†ã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/intel-video-pro-analyzer.png" alt="IntelÂ® Video Pro Analyzer h264 æ¯”ç‰¹æµçš„è¯¦æƒ…" title="IntelÂ® Video Pro Analyzer h264 æ¯”ç‰¹æµçš„è¯¦æƒ…"></p>
</blockquote>
<blockquote>
<h3 id="å…³äºh264-æˆ‘ä»¬è¿˜éœ€è¦äº†è§£ä»€ä¹ˆï¼Ÿ">å…³äºH264ï¼Œæˆ‘ä»¬è¿˜éœ€è¦äº†è§£ä»€ä¹ˆï¼Ÿ</h3>
<p>é™¤äº†å¦‚ä¸Šå¯¹H264ç æµçš„ä»‹ç»å¤–ï¼ŒH264è¿˜æœ‰å¾ˆå¤šå…¶ä»–çš„å†…å®¹éœ€è¦äº†è§£ï¼Œä¾‹å¦‚ï¼šX264å’ŒH264ä¹‹é—´çš„å…³ç³»æ˜¯ä»€ä¹ˆï¼ŸH264æœªæ¥ä¼šè¢«å…¶ä»–çš„æ–°å‹ç¼–è§£ç å™¨æ‰€ä»£æ›¿å—ï¼Ÿâ€¦â€¦å…³äºè¿™äº›ä¿¡æ¯å¯ä»¥å‚è€ƒï¼š<a href="https://www.videoproc.com/resource/h264-codec.htm">https://www.videoproc.com/resource/h264-codec.htm</a>ã€‚</p>
</blockquote>
<h2 id="å›é¡¾">å›é¡¾</h2>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å­¦äº†è®¸å¤š<strong>ä½¿ç”¨ç›¸åŒæ¨¡å‹çš„ç°ä»£ç¼–è§£ç å™¨</strong>ã€‚äº‹å®ä¸Šï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ Thor è§†é¢‘ç¼–è§£ç å™¨æ¡†å›¾ï¼Œå®ƒåŒ…å«æ‰€æœ‰æˆ‘ä»¬å­¦è¿‡çš„æ­¥éª¤ã€‚ä½ ç°åœ¨åº”è¯¥èƒ½æ›´å¥½åœ°ç†è§£æ•°å­—è§†é¢‘é¢†åŸŸå†…çš„åˆ›æ–°å’Œè®ºæ–‡ã€‚<br>
<img src="/2020/02/28/Introduction-to-digital-video-technology/thor_codec_block_diagram.png" alt="thor ç¼–è§£ç å™¨å—å›¾" title="thor ç¼–è§£ç å™¨å—å›¾"></p>
<p>ä¹‹å‰æˆ‘ä»¬è®¡ç®—è¿‡æˆ‘ä»¬<a href="#%E8%89%B2%E5%BA%A6%E5%AD%90%E9%87%87%E6%A0%B7">éœ€è¦ 139GB æ¥ä¿å­˜ä¸€ä¸ªä¸€å°æ—¶ï¼Œ720p åˆ†è¾¨ç‡å’Œ30fpsçš„è§†é¢‘æ–‡ä»¶</a>ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨åœ¨è¿™é‡Œå­¦è¿‡çš„æŠ€æœ¯ï¼Œå¦‚<strong>å¸§é—´å’Œå¸§å†…é¢„æµ‹ï¼Œè½¬æ¢ï¼Œé‡åŒ–ï¼Œç†µç¼–ç å’Œå…¶å®ƒ</strong>æˆ‘ä»¬èƒ½å®ç°â€”â€”å‡è®¾æˆ‘ä»¬<strong>æ¯åƒç´ èŠ±è´¹ 0.031 bit</strong>â€”â€”åŒæ ·è§‚æ„Ÿè´¨é‡çš„è§†é¢‘ï¼Œ<strong>å¯¹æ¯” 139GB çš„å­˜å‚¨ï¼Œåªéœ€ 367.82MB</strong>ã€‚</p>
<blockquote>
<p>æˆ‘ä»¬æ ¹æ®è¿™é‡Œæä¾›çš„ç¤ºä¾‹è§†é¢‘é€‰æ‹©<strong>æ¯åƒç´ ä½¿ç”¨ 0.031 bit</strong>ã€‚</p>
</blockquote>
<h2 id="h-265-å¦‚ä½•å®ç°æ¯”-h-264-æ›´å¥½çš„å‹ç¼©ç‡">H.265 å¦‚ä½•å®ç°æ¯” H.264 æ›´å¥½çš„å‹ç¼©ç‡</h2>
<p>æˆ‘ä»¬å·²ç»æ›´å¤šåœ°äº†è§£äº†ç¼–è§£ç å™¨çš„å·¥ä½œåŸç†ï¼Œé‚£ä¹ˆå°±å®¹æ˜“ç†è§£æ–°çš„ç¼–è§£ç å™¨å¦‚ä½•ä½¿ç”¨æ›´å°‘çš„æ•°æ®é‡ä¼ è¾“æ›´é«˜åˆ†è¾¨ç‡çš„è§†é¢‘ã€‚</p>
<p>æˆ‘ä»¬å°†æ¯”è¾ƒ AVC å’Œ HEVCï¼Œè¦è®°ä½çš„æ˜¯ï¼šæˆ‘ä»¬å‡ ä¹æ€»æ˜¯è¦åœ¨å‹ç¼©ç‡å’Œæ›´å¤šçš„ CPU å‘¨æœŸï¼ˆå¤æ‚åº¦ï¼‰ä¹‹é—´ä½œæƒè¡¡ã€‚</p>
<p>HEVC æ¯” AVC æœ‰æ›´å¤§å’Œæ›´å¤šçš„<strong>åˆ†åŒº</strong>ï¼ˆå’Œ<strong>å­åˆ†åŒº</strong>ï¼‰é€‰é¡¹ï¼Œæ›´å¤š<strong>å¸§å†…é¢„æµ‹æ–¹å‘</strong>ï¼Œ<strong>æ”¹è¿›çš„ç†µç¼–ç </strong>ç­‰ï¼Œæ‰€æœ‰è¿™äº›æ”¹è¿›ä½¿å¾— H.265 æ¯” H.264 çš„å‹ç¼©ç‡æå‡ 50%ã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/avc_vs_hevc.png" alt="h264 vs h265" title="H.264 vs H.265"></p>
<h1>åœ¨çº¿æµåª’ä½“</h1>
<h2 id="é€šç”¨æ¶æ„">é€šç”¨æ¶æ„</h2>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/general_architecture.png" alt="general_architecture"></p>
<p>[TODO]</p>
<h2 id="æ¸è¿›å¼ä¸‹è½½å’Œè‡ªé€‚åº”æµ">æ¸è¿›å¼ä¸‹è½½å’Œè‡ªé€‚åº”æµ</h2>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/progressive_download.png" alt="progressive_download"></p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/adaptive_streaming.png" alt="adaptive_streaming"></p>
<p>[TODO]</p>
<h2 id="å†…å®¹ä¿æŠ¤">å†…å®¹ä¿æŠ¤</h2>
<p>æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªç®€å•çš„ä»¤ç‰Œè®¤è¯ç³»ç»Ÿæ¥ä¿æŠ¤è§†é¢‘ã€‚ç”¨æˆ·éœ€è¦æ‹¥æœ‰ä¸€ä¸ªæœ‰æ•ˆçš„ä»¤ç‰Œæ‰å¯ä»¥æ’­æ”¾è§†é¢‘ï¼ŒCDN ä¼šæ‹’ç»æ²¡æœ‰ä»¤ç‰Œçš„ç”¨æˆ·çš„è¯·æ±‚ã€‚å®ƒä¸å¤§å¤šæ•°ç½‘ç«™çš„èº«ä»½è®¤è¯ç³»ç»Ÿéå¸¸ç›¸ä¼¼ã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/token_protection.png" alt="token_protection"></p>
<p>ä»…ä»…ä½¿ç”¨ä»¤ç‰Œè®¤è¯ç³»ç»Ÿï¼Œç”¨æˆ·ä»ç„¶å¯ä»¥ä¸‹è½½å¹¶é‡æ–°åˆ†å‘è§†é¢‘ã€‚DRM ç³»ç»Ÿå¯ä»¥ç”¨æ¥é¿å…è¿™ç§æƒ…å†µã€‚</p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/drm.png" alt="drm"></p>
<p>å®é™…æƒ…å†µä¸‹ï¼Œäººä»¬é€šå¸¸åŒæ—¶ä½¿ç”¨è¿™ä¸¤ç§æŠ€æœ¯æä¾›æˆæƒå’Œè®¤è¯ã€‚</p>
<h3 id="drm">DRM</h3>
<h4 id="ä¸»è¦ç³»ç»Ÿ">ä¸»è¦ç³»ç»Ÿ</h4>
<ul>
<li>FPS - <a href="https://developer.apple.com/streaming/fps/"><strong>FairPlay Streaming</strong></a></li>
<li>PR - <a href="https://www.microsoft.com/playready/"><strong>PlayReady</strong></a></li>
<li>WV - <a href="http://www.widevine.com/"><strong>Widevine</strong></a></li>
</ul>
<h4 id="æ˜¯ä»€ä¹ˆ">æ˜¯ä»€ä¹ˆ</h4>
<p>DRM æŒ‡çš„æ˜¯æ•°å­—ç‰ˆæƒç®¡ç†ï¼Œæ˜¯ä¸€ç§<strong>ä¸ºæ•°å­—åª’ä½“æä¾›ç‰ˆæƒä¿æŠ¤</strong>çš„æ–¹æ³•ï¼Œä¾‹å¦‚æ•°å­—è§†é¢‘å’ŒéŸ³é¢‘ã€‚å°½ç®¡ç”¨åœ¨äº†å¾ˆå¤šåœºåˆï¼Œä½†å®ƒå¹¶<a href="https://en.wikipedia.org/wiki/Digital_rights_management#DRM-free_works">æ²¡æœ‰è¢«æ™®éæ¥å—</a>.</p>
<h4 id="ä¸ºä»€ä¹ˆ">ä¸ºä»€ä¹ˆ</h4>
<p>å†…å®¹çš„åˆ›ä½œè€…ï¼ˆå¤§å¤šæ˜¯å·¥ä½œå®¤/åˆ¶ç‰‡å‚ï¼‰å¸Œæœ›ä¿æŠ¤ä»–ä»¬çš„çŸ¥è¯†äº§æƒï¼Œä½¿ä»–ä»¬çš„æ•°å­—åª’ä½“å…é­æœªç»æˆæƒçš„åˆ†å‘ã€‚</p>
<h4 id="æ€ä¹ˆåš">æ€ä¹ˆåš</h4>
<p>æˆ‘ä»¬å°†ç”¨ä¸€ç§ç®€å•çš„ã€æŠ½è±¡çš„æ–¹å¼æè¿° DRM</p>
<p>ç°æœ‰ä¸€ä»½<strong>å†…å®¹ C1</strong>ï¼ˆå¦‚ HLS æˆ– DASH è§†é¢‘æµï¼‰ï¼Œä¸€ä¸ª<strong>æ’­æ”¾å™¨ P1</strong>ï¼ˆå¦‚ shaka-clappr, exo-player æˆ– iOSï¼‰ï¼Œè£…åœ¨<strong>è®¾å¤‡ D1</strong>ï¼ˆå¦‚æ™ºèƒ½æ‰‹æœºã€ç”µè§†æˆ–å°å¼æœº/ç¬”è®°æœ¬ï¼‰ä¸Šï¼Œä½¿ç”¨ <strong>DRM ç³»ç»Ÿ DRM1</strong>ï¼ˆå¦‚ FairPlay Streaming, PlayReady, Widevineï¼‰</p>
<p>å†…å®¹ C1 ç”± DRM1 ç”¨ä¸€ä¸ª<strong>å¯¹ç§°å¯†é’¥ K1</strong> åŠ å¯†ï¼Œç”Ÿæˆ<strong>åŠ å¯†å†…å®¹ Câ€™1</strong></p>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/drm_general_flow.jpeg" alt="DRM ä¸€èˆ¬æµç¨‹" title="DRM ä¸€èˆ¬æµç¨‹"></p>
<p>è®¾å¤‡ D1 ä¸Šçš„æ’­æ”¾å™¨ P1 æœ‰ä¸€ä¸ªéå¯¹ç§°å¯†é’¥å¯¹ï¼Œå¯†é’¥å¯¹åŒ…å«ä¸€ä¸ª<strong>ç§é’¥ PRK1</strong>ï¼ˆè¿™ä¸ªå¯†é’¥æ˜¯å—ä¿æŠ¤çš„<sup>1</sup>ï¼Œåªæœ‰ <strong>D1</strong> çŸ¥é“å¯†é’¥å†…å®¹ï¼‰ï¼Œå’Œä¸€ä¸ª<strong>å…¬é’¥ PUK1</strong></p>
<blockquote>
<p><strong><sup>1</sup>å—ä¿æŠ¤çš„</strong>: è¿™ç§ä¿æŠ¤å¯ä»¥<strong>é€šè¿‡ç¡¬ä»¶</strong>è¿›è¡Œä¿æŠ¤ï¼Œä¾‹å¦‚, å°†è¿™ä¸ªå¯†é’¥å­˜å‚¨åœ¨ä¸€ä¸ªç‰¹æ®Šçš„èŠ¯ç‰‡ï¼ˆåªè¯»ï¼‰ä¸­ï¼ŒèŠ¯ç‰‡çš„å·¥ä½œæ–¹å¼å°±åƒä¸€ä¸ªç”¨æ¥è§£å¯†çš„[é»‘ç®±]ã€‚ æˆ–<strong>é€šè¿‡è½¯ä»¶</strong>è¿›è¡Œä¿æŠ¤ï¼ˆè¾ƒä½çš„å®‰å…¨ç³»æ•°ï¼‰ã€‚DRM ç³»ç»Ÿæä¾›äº†è¯†åˆ«è®¾å¤‡æ‰€ä½¿ç”¨çš„ä¿æŠ¤ç±»å‹çš„æ–¹æ³•ã€‚</p>
</blockquote>
<p>å½“ <strong>æ’­æ”¾å™¨ P1 å¸Œæœ›æ’­æ”¾****åŠ å¯†å†…å®¹ Câ€™1</strong> æ—¶ï¼Œå®ƒéœ€è¦ä¸ <strong>DRM1</strong> åå•†ï¼Œå°†å…¬é’¥ <strong>PUK1</strong> å‘é€ç»™ DRM1, DRM1 ä¼šè¿”å›ä¸€ä¸ªè¢«å…¬é’¥ <strong>PUK1</strong> <strong>åŠ å¯†è¿‡çš„ K1</strong>ã€‚æŒ‰ç…§æ¨è®ºï¼Œç»“æœå°±æ˜¯<strong>åªæœ‰ D1 èƒ½å¤Ÿè§£å¯†</strong>ã€‚</p>
<p><code>K1P1D1 = enc(K1, PUK1)</code></p>
<p><strong>P1</strong> ä½¿ç”¨å®ƒçš„æœ¬åœ° DRM ç³»ç»Ÿï¼ˆè¿™å¯ä»¥ä½¿ç”¨ <a href="https://zh.wikipedia.org/wiki/%E7%B3%BB%E7%BB%9F%E8%8A%AF%E7%89%87">SoC</a> ï¼Œä¸€ä¸ªä¸“é—¨çš„ç¡¬ä»¶å’Œè½¯ä»¶ï¼Œè¿™ä¸ªç³»ç»Ÿå¯ä»¥ä½¿ç”¨å®ƒçš„ç§é’¥ PRK1 ç”¨æ¥<strong>è§£å¯†</strong>å†…å®¹ï¼Œå®ƒå¯ä»¥è§£å¯†è¢«åŠ å¯†è¿‡çš„<strong>K1P1D1 çš„å¯¹ç§°å¯†é’¥ K1</strong>ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œå¯†é’¥ä¸ä¼šè¢«å¯¼å‡ºåˆ°å†…å­˜ä»¥å¤–çš„åœ°æ–¹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">K1 &#x3D; dec(K1P1D1, PRK1)</span><br><span class="line"></span><br><span class="line">P1.play(dec(C&#39;1, K1))</span><br></pre></td></tr></table></figure>
<p><img src="/2020/02/28/Introduction-to-digital-video-technology/drm_decoder_flow.jpeg" alt="DRM è§£ç æµç¨‹" title="DRM è§£ç æµç¨‹"></p>
<h1>å¦‚ä½•ä½¿ç”¨ jupyter</h1>
<p>ç¡®ä¿ä½ å·²å®‰è£… dockerï¼Œåªéœ€è¿è¡Œ <code>./s/start_jupyter.sh</code>ï¼Œç„¶åæŒ‰ç…§æ§åˆ¶å°çš„è¯´æ˜è¿›è¡Œæ“ä½œã€‚</p>
<h1>ä¼šè®®</h1>
<ul>
<li><a href="https://demuxed.com/">DEMUXED</a> - æ‚¨å¯ä»¥<a href="https://www.youtube.com/channel/UCIc_DkRxo9UgUSTvWVNCmpA">æŸ¥çœ‹æœ€è¿‘çš„2ä¸ªæ´»åŠ¨æ¼”ç¤º</a>ã€‚</li>
</ul>
<h1>å‚è€ƒ</h1>
<p>è¿™é‡Œæœ‰æœ€ä¸°å¯Œçš„èµ„æºï¼Œè¿™ç¯‡æ–‡æ¡£åŒ…å«çš„ä¿¡æ¯ï¼Œå‡æ‘˜å½•ã€ä¾æ®æˆ–å—å®ƒä»¬å¯å‘ã€‚ä½ å¯ä»¥ç”¨è¿™äº›ç²¾å½©çš„é“¾æ¥ï¼Œä¹¦ç±ï¼Œè§†é¢‘ç­‰æ·±åŒ–ä½ çš„çŸ¥è¯†ã€‚</p>
<p>åœ¨çº¿è¯¾ç¨‹å’Œæ•™ç¨‹ï¼š</p>
<ul>
<li><a href="https://www.coursera.org/learn/digital/">https://www.coursera.org/learn/digital/</a></li>
<li><a href="https://people.xiph.org/~tterribe/pubs/lca2012/auckland/intro_to_video1.pdf">https://people.xiph.org/~tterribe/pubs/lca2012/auckland/intro_to_video1.pdf</a></li>
<li><a href="https://xiph.org/video/vid1.shtml">https://xiph.org/video/vid1.shtml</a></li>
<li><a href="https://xiph.org/video/vid2.shtml">https://xiph.org/video/vid2.shtml</a></li>
<li><a href="http://slhck.info/ffmpeg-encoding-course">http://slhck.info/ffmpeg-encoding-course</a></li>
<li><a href="http://www.cambridgeincolour.com/tutorials/camera-sensors.htm">http://www.cambridgeincolour.com/tutorials/camera-sensors.htm</a></li>
<li><a href="http://www.slideshare.net/vcodex/a-short-history-of-video-coding">http://www.slideshare.net/vcodex/a-short-history-of-video-coding</a></li>
<li><a href="http://www.slideshare.net/vcodex/introduction-to-video-compression-13394338">http://www.slideshare.net/vcodex/introduction-to-video-compression-1339433</a></li>
<li><a href="https://developer.android.com/guide/topics/media/media-formats.html">https://developer.android.com/guide/topics/media/media-formats.html</a></li>
<li><a href="http://www.slideshare.net/MadhawaKasun/audio-compression-23398426">http://www.slideshare.net/MadhawaKasun/audio-compression-23398426</a></li>
<li><a href="http://inst.eecs.berkeley.edu/~ee290t/sp04/lectures/02-Motion_Compensation_girod.pdf">http://inst.eecs.berkeley.edu/~ee290t/sp04/lectures/02-Motion_Compensation_girod.pdf</a></li>
</ul>
<p>ä¹¦ç±:</p>
<ul>
<li><a href="https://www.amazon.com/Understanding-Compression-Data-Modern-Developers/dp/1491961538/ref=sr_1_1?s=books&amp;ie=UTF8&amp;qid=1486395327&amp;sr=1-1">https://www.amazon.com/Understanding-Compression-Data-Modern-Developers/dp/1491961538/ref=sr_1_1?s=books&amp;ie=UTF8&amp;qid=1486395327&amp;sr=1-1</a></li>
<li><a href="https://www.amazon.com/H-264-Advanced-Video-Compression-Standard/dp/0470516925">https://www.amazon.com/H-264-Advanced-Video-Compression-Standard/dp/0470516925</a></li>
<li><a href="https://www.amazon.com/Practical-Guide-Video-Audio-Compression/dp/0240806301/ref=sr_1_3?s=books&amp;ie=UTF8&amp;qid=1486396914&amp;sr=1-3&amp;keywords=A+PRACTICAL+GUIDE+TO+VIDEO+AUDIO">https://www.amazon.com/Practical-Guide-Video-Audio-Compression/dp/0240806301/ref=sr_1_3?s=books&amp;ie=UTF8&amp;qid=1486396914&amp;sr=1-3&amp;keywords=A+PRACTICAL+GUIDE+TO+VIDEO+AUDIO</a></li>
<li><a href="https://www.amazon.com/Video-Encoding-Numbers-Eliminate-Guesswork/dp/0998453005/ref=sr_1_1?s=books&amp;ie=UTF8&amp;qid=1486396940&amp;sr=1-1&amp;keywords=jan+ozer">https://www.amazon.com/Video-Encoding-Numbers-Eliminate-Guesswork/dp/0998453005/ref=sr_1_1?s=books&amp;ie=UTF8&amp;qid=1486396940&amp;sr=1-1&amp;keywords=jan+ozer</a></li>
</ul>
<p>æ¯”ç‰¹æµè§„èŒƒ:</p>
<ul>
<li><a href="http://www.itu.int/rec/T-REC-H.264-201610-I">http://www.itu.int/rec/T-REC-H.264-201610-I</a></li>
<li><a href="http://www.itu.int/ITU-T/recommendations/rec.aspx?rec=12904&amp;lang=en">http://www.itu.int/ITU-T/recommendations/rec.aspx?rec=12904&amp;lang=en</a></li>
<li><a href="https://storage.googleapis.com/downloads.webmproject.org/docs/vp9/vp9-bitstream-specification-v0.6-20160331-draft.pdf">https://storage.googleapis.com/downloads.webmproject.org/docs/vp9/vp9-bitstream-specification-v0.6-20160331-draft.pdf</a></li>
<li><a href="http://iphome.hhi.de/wiegand/assets/pdfs/2012_12_IEEE-HEVC-Overview.pdf">http://iphome.hhi.de/wiegand/assets/pdfs/2012_12_IEEE-HEVC-Overview.pdf</a></li>
<li><a href="http://phenix.int-evry.fr/jct/doc_end_user/current_document.php?id=7243">http://phenix.int-evry.fr/jct/doc_end_user/current_document.php?id=7243</a></li>
<li><a href="http://gentlelogic.blogspot.com.br/2011/11/exploring-h264-part-2-h264-bitstream.html">http://gentlelogic.blogspot.com.br/2011/11/exploring-h264-part-2-h264-bitstream.html</a></li>
</ul>
<p>è½¯ä»¶:</p>
<ul>
<li><a href="https://ffmpeg.org/">https://ffmpeg.org/</a></li>
<li><a href="https://ffmpeg.org/ffmpeg-all.html">https://ffmpeg.org/ffmpeg-all.html</a></li>
<li><a href="https://ffmpeg.org/ffprobe.html">https://ffmpeg.org/ffprobe.html</a></li>
<li><a href="https://trac.ffmpeg.org/wiki/">https://trac.ffmpeg.org/wiki/</a></li>
<li><a href="https://software.intel.com/en-us/intel-video-pro-analyzer">https://software.intel.com/en-us/intel-video-pro-analyzer</a></li>
<li><a href="https://medium.com/@mbebenita/av1-bitstream-analyzer-d25f1c27072b#.d5a89oxz8">https://medium.com/@mbebenita/av1-bitstream-analyzer-d25f1c27072b#.d5a89oxz8</a></li>
</ul>
<p>é-ITU ç¼–è§£ç å™¨:</p>
<ul>
<li><a href="https://aomedia.googlesource.com/">https://aomedia.googlesource.com/</a></li>
<li><a href="https://github.com/webmproject/libvpx/tree/master/vp9">https://github.com/webmproject/libvpx/tree/master/vp9</a></li>
<li><a href="https://people.xiph.org/~xiphmont/demo/daala/demo1.shtml">https://people.xiph.org/~xiphmont/demo/daala/demo1.shtml</a></li>
<li><a href="https://people.xiph.org/~jm/daala/revisiting/">https://people.xiph.org/~jm/daala/revisiting/</a></li>
<li><a href="https://www.youtube.com/watch?v=lzPaldsmJbk">https://www.youtube.com/watch?v=lzPaldsmJbk</a></li>
<li><a href="https://fosdem.org/2017/schedule/event/om_av1/">https://fosdem.org/2017/schedule/event/om_av1/</a></li>
</ul>
<p>ç¼–ç æ¦‚å¿µ:</p>
<ul>
<li><a href="http://x265.org/hevc-h265/">http://x265.org/hevc-h265/</a></li>
<li><a href="http://slhck.info/video/2017/03/01/rate-control.html">http://slhck.info/video/2017/03/01/rate-control.html</a></li>
<li><a href="http://slhck.info/video/2017/02/24/vbr-settings.html">http://slhck.info/video/2017/02/24/vbr-settings.html</a></li>
<li><a href="http://slhck.info/video/2017/02/24/crf-guide.html">http://slhck.info/video/2017/02/24/crf-guide.html</a></li>
<li><a href="https://arxiv.org/pdf/1702.00817v1.pdf">https://arxiv.org/pdf/1702.00817v1.pdf</a></li>
<li><a href="https://trac.ffmpeg.org/wiki/Debug/MacroblocksAndMotionVectors">https://trac.ffmpeg.org/wiki/Debug/MacroblocksAndMotionVectors</a></li>
<li><a href="http://web.ece.ucdavis.edu/cerl/ReliableJPEG/Cung/jpeg.html">http://web.ece.ucdavis.edu/cerl/ReliableJPEG/Cung/jpeg.html</a></li>
<li><a href="http://www.adobe.com/devnet/adobe-media-server/articles/h264_encoding.html">http://www.adobe.com/devnet/adobe-media-server/articles/h264_encoding.html</a></li>
<li><a href="https://prezi.com/8m7thtvl4ywr/mp3-and-aac-explained/">https://prezi.com/8m7thtvl4ywr/mp3-and-aac-explained/</a></li>
</ul>
<p>æµ‹è¯•ç”¨è§†é¢‘åºåˆ—:</p>
<ul>
<li><a href="http://bbb3d.renderfarming.net/download.html">http://bbb3d.renderfarming.net/download.html</a></li>
<li><a href="https://www.its.bldrdoc.gov/vqeg/video-datasets-and-organizations.aspx">https://www.its.bldrdoc.gov/vqeg/video-datasets-and-organizations.aspx</a></li>
</ul>
<p>æ‚é¡¹:</p>
<ul>
<li><a href="http://stackoverflow.com/a/24890903">http://stackoverflow.com/a/24890903</a></li>
<li><a href="http://stackoverflow.com/questions/38094302/how-to-understand-header-of-h264">http://stackoverflow.com/questions/38094302/how-to-understand-header-of-h264</a></li>
<li><a href="http://techblog.netflix.com/2016/08/a-large-scale-comparison-of-x264-x265.html">http://techblog.netflix.com/2016/08/a-large-scale-comparison-of-x264-x265.html</a></li>
<li><a href="http://vanseodesign.com/web-design/color-luminance/">http://vanseodesign.com/web-design/color-luminance/</a></li>
<li><a href="http://www.biologymad.com/nervoussystem/eyenotes.htm">http://www.biologymad.com/nervoussystem/eyenotes.htm</a></li>
<li><a href="http://www.compression.ru/video/codec_comparison/h264_2012/mpeg4_avc_h264_video_codecs_comparison.pdf">http://www.compression.ru/video/codec_comparison/h264_2012/mpeg4_avc_h264_video_codecs_comparison.pdf</a></li>
<li><a href="http://www.csc.villanova.edu/~rschumey/csc4800/dct.html">http://www.csc.villanova.edu/~rschumey/csc4800/dct.html</a></li>
<li><a href="http://www.explainthatstuff.com/digitalcameras.html">http://www.explainthatstuff.com/digitalcameras.html</a></li>
<li><a href="http://www.hkvstar.com">http://www.hkvstar.com</a></li>
<li><a href="http://www.hometheatersound.com/">http://www.hometheatersound.com/</a></li>
<li><a href="http://www.lighterra.com/papers/videoencodingh264/">http://www.lighterra.com/papers/videoencodingh264/</a></li>
<li><a href="http://www.red.com/learn/red-101/video-chroma-subsampling">http://www.red.com/learn/red-101/video-chroma-subsampling</a></li>
<li><a href="http://www.slideshare.net/ManoharKuse/hevc-intra-coding">http://www.slideshare.net/ManoharKuse/hevc-intra-coding</a></li>
<li><a href="http://www.slideshare.net/mwalendo/h264vs-hevc">http://www.slideshare.net/mwalendo/h264vs-hevc</a></li>
<li><a href="http://www.slideshare.net/rvarun7777/final-seminar-46117193">http://www.slideshare.net/rvarun7777/final-seminar-46117193</a></li>
<li><a href="http://www.springer.com/cda/content/document/cda_downloaddocument/9783642147029-c1.pdf">http://www.springer.com/cda/content/document/cda_downloaddocument/9783642147029-c1.pdf</a></li>
<li><a href="http://www.streamingmedia.com/Articles/Editorial/Featured-Articles/A-Progress-Report-The-Alliance-for-Open-Media-and-the-AV1-Codec-110383.aspx">http://www.streamingmedia.com/Articles/Editorial/Featured-Articles/A-Progress-Report-The-Alliance-for-Open-Media-and-the-AV1-Codec-110383.aspx</a></li>
<li><a href="http://www.streamingmediaglobal.com/Articles/ReadArticle.aspx?ArticleID=116505&amp;PageNum=1">http://www.streamingmediaglobal.com/Articles/ReadArticle.aspx?ArticleID=116505&amp;PageNum=1</a></li>
<li><a href="http://yumichan.net/video-processing/video-compression/introduction-to-h264-nal-unit/">http://yumichan.net/video-processing/video-compression/introduction-to-h264-nal-unit/</a></li>
<li><a href="https://cardinalpeak.com/blog/the-h-264-sequence-parameter-set/">https://cardinalpeak.com/blog/the-h-264-sequence-parameter-set/</a></li>
<li><a href="https://cardinalpeak.com/blog/worlds-smallest-h-264-encoder/">https://cardinalpeak.com/blog/worlds-smallest-h-264-encoder/</a></li>
<li><a href="https://codesequoia.wordpress.com/category/video/">https://codesequoia.wordpress.com/category/video/</a></li>
<li><a href="https://developer.apple.com/library/content/technotes/tn2224/_index.html">https://developer.apple.com/library/content/technotes/tn2224/_index.html</a></li>
<li><a href="https://en.wikibooks.org/wiki/MeGUI/x264_Settings">https://en.wikibooks.org/wiki/MeGUI/x264_Settings</a></li>
<li><a href="https://en.wikipedia.org/wiki/Adaptive_bitrate_streaming">https://en.wikipedia.org/wiki/Adaptive_bitrate_streaming</a></li>
<li><a href="https://en.wikipedia.org/wiki/AOMedia_Video_1">https://en.wikipedia.org/wiki/AOMedia_Video_1</a></li>
<li><a href="https://en.wikipedia.org/wiki/Chroma_subsampling#/media/File:Colorcomp.jpg">https://en.wikipedia.org/wiki/Chroma_subsampling#/media/File:Colorcomp.jpg</a></li>
<li><a href="https://en.wikipedia.org/wiki/Cone_cell">https://en.wikipedia.org/wiki/Cone_cell</a></li>
<li><a href="https://en.wikipedia.org/wiki/File:H.264_block_diagram_with_quality_score.jpg">https://en.wikipedia.org/wiki/File:H.264_block_diagram_with_quality_score.jpg</a></li>
<li><a href="https://en.wikipedia.org/wiki/Inter_frame">https://en.wikipedia.org/wiki/Inter_frame</a></li>
<li><a href="https://en.wikipedia.org/wiki/Intra-frame_coding">https://en.wikipedia.org/wiki/Intra-frame_coding</a></li>
<li><a href="https://en.wikipedia.org/wiki/Photoreceptor_cell">https://en.wikipedia.org/wiki/Photoreceptor_cell</a></li>
<li><a href="https://en.wikipedia.org/wiki/Pixel_aspect_ratio">https://en.wikipedia.org/wiki/Pixel_aspect_ratio</a></li>
<li><a href="https://en.wikipedia.org/wiki/Presentation_timestamp">https://en.wikipedia.org/wiki/Presentation_timestamp</a></li>
<li><a href="https://en.wikipedia.org/wiki/Rod_cell">https://en.wikipedia.org/wiki/Rod_cell</a></li>
<li><a href="https://it.wikipedia.org/wiki/File:Pixel_geometry_01_Pengo.jpg">https://it.wikipedia.org/wiki/File:Pixel_geometry_01_Pengo.jpg</a></li>
<li><a href="https://leandromoreira.com.br/2016/10/09/how-to-measure-video-quality-perception/">https://leandromoreira.com.br/2016/10/09/how-to-measure-video-quality-perception/</a></li>
<li><a href="https://sites.google.com/site/linuxencoding/x264-ffmpeg-mapping">https://sites.google.com/site/linuxencoding/x264-ffmpeg-mapping</a></li>
<li><a href="https://softwaredevelopmentperestroika.wordpress.com/2014/02/11/image-processing-with-python-numpy-scipy-image-convolution/">https://softwaredevelopmentperestroika.wordpress.com/2014/02/11/image-processing-with-python-numpy-scipy-image-convolution/</a></li>
<li><a href="https://tools.ietf.org/html/draft-fuldseth-netvc-thor-03">https://tools.ietf.org/html/draft-fuldseth-netvc-thor-03</a></li>
<li><a href="https://www.encoding.com/android/">https://www.encoding.com/android/</a></li>
<li><a href="https://www.encoding.com/http-live-streaming-hls/">https://www.encoding.com/http-live-streaming-hls/</a></li>
<li><a href="https://www.iem.thm.de/telekom-labor/zinke/mk/mpeg2beg/whatisit.htm">https://www.iem.thm.de/telekom-labor/zinke/mk/mpeg2beg/whatisit.htm</a></li>
<li><a href="https://www.lifewire.com/cmos-image-sensor-493271">https://www.lifewire.com/cmos-image-sensor-493271</a></li>
<li><a href="https://www.linkedin.com/pulse/brief-history-video-codecs-yoav-nativ">https://www.linkedin.com/pulse/brief-history-video-codecs-yoav-nativ</a></li>
<li><a href="https://www.linkedin.com/pulse/video-streaming-methodology-reema-majumdar">https://www.linkedin.com/pulse/video-streaming-methodology-reema-majumdar</a></li>
<li><a href="https://www.vcodex.com/h264avc-intra-precition/">https://www.vcodex.com/h264avc-intra-precition/</a></li>
<li><a href="https://www.youtube.com/watch?v=9vgtJJ2wwMA">https://www.youtube.com/watch?v=9vgtJJ2wwMA</a></li>
<li><a href="https://www.youtube.com/watch?v=LFXN9PiOGtY">https://www.youtube.com/watch?v=LFXN9PiOGtY</a></li>
<li><a href="https://www.youtube.com/watch?v=Lto-ajuqW3w&amp;list=PLzH6n4zXuckpKAj1_88VS-8Z6yn9zX_P6">https://www.youtube.com/watch?v=Lto-ajuqW3w&amp;list=PLzH6n4zXuckpKAj1_88VS-8Z6yn9zX_P6</a></li>
<li><a href="https://www.youtube.com/watch?v=LWxu4rkZBLw">https://www.youtube.com/watch?v=LWxu4rkZBLw</a></li>
</ul>
<p>å…¶ä»–èµ„æºï¼š</p>
<ul>
<li><a href="https://www.videoproc.com/resource/h264-codec.htm">https://www.videoproc.com/resource/h264-codec.htm</a></li>
</ul>
]]></content>
      <categories>
        <category>è§†é¢‘æŠ€æœ¯</category>
      </categories>
      <tags>
        <tag>æ•°å­—è§†é¢‘</tag>
      </tags>
  </entry>
  <entry>
    <title>å¦‚ä½•è®¡ç®—MS-SSIM</title>
    <url>/2020/02/25/how-to-calculate-the-MS-SSIM/</url>
    <content><![CDATA[<h2 id="ssimçš„æœ¬è´¨åŠå…¶ç¼ºç‚¹">SSIMçš„æœ¬è´¨åŠå…¶ç¼ºç‚¹</h2>
<p>åœ¨<a href="/2020/02/15/how-to-calculate-the-SSIM-in-FFMpeg/">FFmpegå¦‚ä½•è®¡ç®—å›¾åƒçš„SSIM</a>ä¸­ï¼Œè¯¦ç»†ä»‹ç»äº†<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">SSIM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>çš„ç›¸å…³æ¦‚å¿µï¼Œå¹¶å¯¹FFmpegä¸­çš„<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">SSIM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>å®ç°åšäº†è¯¦ç»†çš„åˆ†æã€‚<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">SSIM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>ç®—æ³•åŸºäºHVSæ›´æ“…é•¿ä»å›¾åƒä¸­æå–ç»“æ„ä¿¡æ¯çš„äº‹å®ï¼Œå¹¶ä¸”åˆ©ç”¨ç»“æ„ç›¸ä¼¼åº¦æ¥è®¡ç®—å›¾åƒçš„æ„ŸçŸ¥è´¨é‡ã€‚åœ¨Z. Wangç­‰äººçš„è®ºæ–‡<strong>Multi-scale structural similarity for image quality assessment</strong>ä¸­ä¹Ÿæåˆ°ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">SSIM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>ç®—æ³•è¦å¥½äºå½“æ—¶çš„å…¶å®ƒçš„æ„ŸçŸ¥å›¾åƒè´¨é‡æŒ‡æ ‡ã€‚</p>
<p>å°±å…¶æœ¬è´¨è€Œè¨€ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">SSIM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>æ˜¯ä¸€ç§å•å°ºåº¦çš„ç®—æ³•ï¼Œä½†æ˜¯å®é™…ä¸Šæ­£ç¡®çš„å›¾åƒå°ºåº¦å–å†³äºç”¨æˆ·çš„è§‚çœ‹æ¡ä»¶ï¼Œä¾‹å¦‚æ˜¾ç¤ºè®¾å¤‡çš„åˆ†è¾¨ç‡ï¼Œç”¨æˆ·çš„è§‚çœ‹è·ç¦»ç­‰ã€‚å› æ­¤ï¼Œç”¨å•å°ºåº¦çš„<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">SSIM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>ç®—æ³•æ¥è¯„ä¼°å›¾åƒçš„æ„ŸçŸ¥è´¨é‡ä¹Ÿå­˜åœ¨å…¶ç¼ºç‚¹ã€‚</p>
<span id="more"></span>
<h2 id="ms-ssimçš„åŸºæœ¬æ¦‚å¿µ">MS-SSIMçš„åŸºæœ¬æ¦‚å¿µ</h2>
<p>å›¾åƒç»†èŠ‚çš„å¯æ„ŸçŸ¥æ€§å–å†³äºï¼š</p>
<ul>
<li>å›¾åƒä¿¡å·çš„é‡‡æ ·å¯†åº¦</li>
<li>ç”¨æˆ·çš„è§‚çœ‹è·ç¦»</li>
<li>HVSçš„æ„ŸçŸ¥èƒ½åŠ›</li>
</ul>
<p>å½“å¦‚ä¸Šçš„å› ç´ å‘ç”Ÿå˜åŒ–æ—¶ï¼Œåˆ™å¯¹ç»™å®šå›¾åƒçš„ä¸»è§‚è¯„ä¼°ä¹Ÿä¼šéšä¹‹å‘ç”Ÿå˜åŒ–ã€‚å•å°ºåº¦çš„SSIMç®—æ³•å¯èƒ½ä»…é€‚ç”¨äºæŸä¸ªç‰¹å®šçš„é…ç½®ã€‚ä¸ºäº†è§£å†³è¯¥é—®é¢˜ï¼Œè®ºæ–‡<strong>Multi-scale structural similarity for image quality assessment</strong>åœ¨<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">SSIM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>ç®—æ³•çš„åŸºç¡€ä¸Šæå‡ºäº†å¦‚å›¾1æ‰€ç¤ºçš„å¤šå°ºåº¦çš„ç»“æ„ç›¸ä¼¼æ€§è¯„ä¼°ç®—æ³•ï¼Œå³<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mo>âˆ’</mo><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">MS-SSIM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>ç®—æ³•ã€‚</p>
<p><img src="/2020/02/25/how-to-calculate-the-MS-SSIM/1.jpg" alt="å›¾1. MS-SSIMç®—æ³•"></p>
<p>å›¾1. MS-SSIMç®—æ³•ï¼ŒL è¡¨ç¤ºä½é€šæ»¤æ³¢å™¨ï¼Œ2â†“ è¡¨ç¤ºé‡‡æ ·é—´éš”ä¸º2çš„ä¸‹é‡‡æ ·</p>
<p>å› æ­¤ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mo>âˆ’</mo><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">MS-SSIM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>å®é™…ä¸Šæ˜¯ä¸€ç§ä»¥ä¸åŒåˆ†è¾¨ç‡åˆå¹¶å›¾åƒç»†èŠ‚çš„å›¾åƒè´¨é‡è¯„ä¼°æ–¹æ³•ã€‚å¯¹äº<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mo>âˆ’</mo><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">MS-SSIM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>ï¼ŒåŸå§‹å›¾åƒçš„<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>c</mi><mi>a</mi><mi>l</mi><mi>e</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">scale=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>ï¼Œå›¾åƒçš„æœ€å¤§<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>c</mi><mi>a</mi><mi>l</mi><mi>e</mi><mo>=</mo><mi>M</mi></mrow><annotation encoding="application/x-tex">scale=M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>ã€‚å¯¹<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>c</mi><mi>a</mi><mi>l</mi><mi>e</mi><mo>=</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">scale=j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span></span></span></span>çš„å°ºåº¦è€Œè¨€ï¼Œå…¶äº®åº¦ã€å¯¹æ¯”åº¦ã€ç»“æ„çš„ç›¸ä¼¼æ€§åˆ†åˆ«è¡¨ç¤ºä¸ºï¼š</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>l</mi><mi>j</mi></msub><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">l_j(X,Y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>j</mi></msub><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">c_j(X,Y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>j</mi></msub><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">s_j(X,Y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span></span></span></span></li>
</ul>
<p>å› æ­¤ï¼Œæ ¹æ®å›¾1å¯ä»¥å¾—åˆ°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mo>âˆ’</mo><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">MS-SSIM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>çš„è®¡ç®—æ–¹å¼ã€‚</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mo>âˆ’</mo><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo stretchy="false">)</mo><mo>=</mo><mo fence="false">[</mo><msub><mi>l</mi><mi>M</mi></msub><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo stretchy="false">)</mo><msup><mo fence="false">]</mo><msub><mi>Î±</mi><mi>M</mi></msub></msup><mo>â‹…</mo><munderover><mo>âˆ</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>M</mi></munderover><mrow><mo fence="false">[</mo><msub><mi>c</mi><mi>j</mi></msub><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo stretchy="false">)</mo><msup><mo fence="false">]</mo><msub><mi>Î²</mi><mi>j</mi></msub></msup><mo fence="false">[</mo><msub><mi>s</mi><mi>j</mi></msub><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo stretchy="false">)</mo><msup><mo fence="false">]</mo><msub><mi>Î³</mi><mi>j</mi></msub></msup></mrow></mrow><annotation encoding="application/x-tex">MS-SSIM(X,Y)=\big[l_M(X,Y)\big]^{\alpha_M} \cdot \prod _{j=1}^{M}  {\big[c_j(X,Y)\big]^{\beta_j}\big[s_j(X,Y)\big]^{\gamma_j}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.254302em;vertical-align:-0.35001em;"></span><span class="mord"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">M</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span><span class="mord"><span class="mord"><span class="delimsizing size1">]</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.904292em;"><span style="top:-3.3029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.0037em;">Î±</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-left:-0.0037em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">M</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.14329285714285717em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:3.2421130000000007em;vertical-align:-1.4137769999999998em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000006em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">M</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span><span class="mord"><span class="mord"><span class="delimsizing size1">]</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.089008em;"><span style="top:-3.3029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05278em;">Î²</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.05278em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2818857142857143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span><span class="mord"><span class="mord"><span class="delimsizing size1">]</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.904292em;"><span style="top:-3.3029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05556em;">Î³</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.05556em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2818857142857143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>ä¸€èˆ¬ï¼Œä»¤<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î±</mi><mi>j</mi></msub><mo>=</mo><msub><mi>Î²</mi><mi>j</mi></msub><mo>=</mo><msub><mi>Î³</mi><mi>j</mi></msub><mtext>Â Â </mtext><mo separator="true">,</mo><mtext>Â </mtext><mi>j</mi><mo>âˆˆ</mo><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mi>M</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\alpha_j=\beta_j=\gamma_j \ \ , \ j \in [1, M]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.0037em;">Î±</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05278em;">Î²</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.9456279999999999em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05556em;">Î³</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace">Â </span><span class="mspace">Â </span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace">Â </span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mclose">]</span></span></span></span>ï¼Œæˆ‘ä»¬å¾—åˆ°ï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mo>âˆ’</mo><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo stretchy="false">)</mo><mo>=</mo><mo fence="false">[</mo><msub><mi>l</mi><mi>M</mi></msub><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo stretchy="false">)</mo><msup><mo fence="false">]</mo><msub><mi>Î±</mi><mi>M</mi></msub></msup><mo>â‹…</mo><munderover><mo>âˆ</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>M</mi></munderover><mrow><mo fence="false">[</mo><msub><mi>c</mi><mi>j</mi></msub><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo stretchy="false">)</mo><mo>â‹…</mo><msub><mi>s</mi><mi>j</mi></msub><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo stretchy="false">)</mo><msup><mo fence="false">]</mo><msub><mi>Î±</mi><mi>j</mi></msub></msup></mrow></mrow><annotation encoding="application/x-tex">MS-SSIM(X,Y)=\big[l_M(X,Y)\big]^{\alpha_M} \cdot \prod _{j=1}^{M}  {\big[c_j(X,Y) \cdot s_j(X,Y)\big]^{\alpha_j}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.254302em;vertical-align:-0.35001em;"></span><span class="mord"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">M</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span><span class="mord"><span class="mord"><span class="delimsizing size1">]</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.904292em;"><span style="top:-3.3029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.0037em;">Î±</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-left:-0.0037em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">M</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.14329285714285717em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:3.2421130000000007em;vertical-align:-1.4137769999999998em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000006em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">M</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span><span class="mord"><span class="mord"><span class="delimsizing size1">]</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.904292em;"><span style="top:-3.3029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.0037em;">Î±</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.0037em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2818857142857143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><strong>Multi-scale structural similarity for image quality assessment</strong>ç»™å‡ºäº†ä¸€ç§è®¡ç®—å„å°ºåº¦å‚æ•°çš„æ–¹æ³•ï¼Œå¹¶åŒæ—¶ç»™å‡ºä¸åŒå°ºåº¦çš„å‚æ•°å€¼ï¼š</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î±</mi><mn>1</mn></msub><mo>=</mo><mn>0.0448</mn></mrow><annotation encoding="application/x-tex">\alpha_1=0.0448</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.0037em;">Î±</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">4</span><span class="mord">4</span><span class="mord">8</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î±</mi><mn>2</mn></msub><mo>=</mo><mn>0.2856</mn></mrow><annotation encoding="application/x-tex">\alpha_2=0.2856</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.0037em;">Î±</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">2</span><span class="mord">8</span><span class="mord">5</span><span class="mord">6</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î±</mi><mn>3</mn></msub><mo>=</mo><mn>0.3001</mn></mrow><annotation encoding="application/x-tex">\alpha_3=0.3001</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.0037em;">Î±</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">3</span><span class="mord">0</span><span class="mord">0</span><span class="mord">1</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î±</mi><mn>4</mn></msub><mo>=</mo><mn>0.2363</mn></mrow><annotation encoding="application/x-tex">\alpha_4=0.2363</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.0037em;">Î±</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">2</span><span class="mord">3</span><span class="mord">6</span><span class="mord">3</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î±</mi><mn>5</mn></msub><mo>=</mo><mn>0.1333</mn></mrow><annotation encoding="application/x-tex">\alpha_5=0.1333</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.0037em;">Î±</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span><span class="mord">3</span><span class="mord">3</span><span class="mord">3</span></span></span></span></li>
</ul>
<h2 id="ms-ssimç®—æ³•çš„å®ç°">MS-SSIMç®—æ³•çš„å®ç°</h2>
<p>é‡‡ç”¨FFmpegä¸­çš„<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">SSIM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>çš„å®ç°æ–¹å¼æ¥å®ç°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mo>âˆ’</mo><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">MS-SSIM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>ã€‚æ ¹æ®<a href="/2020/02/15/how-to-calculate-the-SSIM-in-FFmpeg/">FFmpegå¦‚ä½•è®¡ç®—å›¾åƒçš„SSIM</a>çš„ä»‹ç»ï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mo>âˆ’</mo><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo stretchy="false">)</mo><mo>=</mo><mo fence="false">(</mo><mfrac><mrow><mn>2</mn><mi>s</mi><mn>1</mn><mo>â‹…</mo><mi>s</mi><mn>2</mn><mo>+</mo><mi>s</mi><mi>s</mi><mi>i</mi><mi>m</mi><msub><mi>C</mi><mn>1</mn></msub></mrow><mrow><mi>s</mi><msup><mn>1</mn><mn>2</mn></msup><mo>+</mo><mi>s</mi><msup><mn>2</mn><mn>2</mn></msup><mo>+</mo><mi>s</mi><mi>s</mi><mi>i</mi><mi>m</mi><msub><mi>C</mi><mn>1</mn></msub></mrow></mfrac><msup><mo fence="false">)</mo><msub><mi>Î±</mi><mi>M</mi></msub></msup><mo>â‹…</mo><munderover><mo>âˆ</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>M</mi></munderover><mo fence="false">(</mo><mfrac><mrow><mn>2</mn><mi>c</mi><mi>o</mi><mi>v</mi><mi>a</mi><mi>r</mi><mo>+</mo><mi>s</mi><mi>s</mi><mi>i</mi><mi>m</mi><msub><mi>C</mi><mn>2</mn></msub></mrow><mrow><mi>v</mi><mi>a</mi><mi>r</mi><mi>s</mi><mo>+</mo><mi>s</mi><mi>s</mi><mi>i</mi><mi>m</mi><msub><mi>C</mi><mn>2</mn></msub></mrow></mfrac><msup><mo fence="false">)</mo><msub><mi>Î±</mi><mi>j</mi></msub></msup></mrow><annotation encoding="application/x-tex">MS-SSIM(X,Y)=\bigg(\frac{2s1 \cdot s2 + ssimC_{1}}{s1^2+s2^2+ssimC_{1}}\bigg)^{\alpha_{M}} \cdot \prod _{j=1}^{M}\bigg(\frac{2covar + ssimC_2}{vars + ssimC_2}\bigg)^{\alpha_j}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.454322em;vertical-align:-0.95003em;"></span><span class="mord"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.3139999999999996em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">s</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">m</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord mathdefault">s</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">s</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">m</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.8360000000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord"><span class="delimsizing size3">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.504292em;"><span style="top:-3.9029000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.0037em;">Î±</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-left:-0.0037em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">M</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.14329285714285717em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:3.2421130000000007em;vertical-align:-1.4137769999999998em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000006em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">M</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.3139999999999996em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">m</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">m</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.8360000000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord"><span class="delimsizing size3">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.5042920000000002em;"><span style="top:-3.9029000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.0037em;">Î±</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.0037em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2818857142857143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>å¯¹äºå›¾åƒé‡‡æ ·è€Œè¨€ï¼Œé‡‡ç”¨ç®€å•çš„<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>Ã—</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">2 \times 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span>çš„å·ç§¯æ ¸æ‰§è¡Œå›¾åƒçš„ä¸‹é‡‡æ ·ï¼Œï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mn>1</mn><mn>4</mn></mfrac></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mn>1</mn><mn>4</mn></mfrac></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mn>1</mn><mn>4</mn></mfrac></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mn>1</mn><mn>4</mn></mfrac></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><annotation encoding="application/x-tex">\begin{bmatrix}
\frac{1}{4} &amp; \frac{1}{4} \\\\
\frac{1}{4} &amp; \frac{1}{4} \\\\
\end{bmatrix}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.8102160000000005em;vertical-align:-2.1551080000000002em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6529999999999996em;"><span style="top:-1.6499900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.79999em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.3959900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-3.4119800000000002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¢</span></span></span><span style="top:-4.653em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6551080000000002em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-2.404892em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-1.2048919999999999em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1551080000000002em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6551080000000002em;"><span style="top:-4.8100000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-2.4048920000000003em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.9551079999999996em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6529999999999996em;"><span style="top:-1.6499900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.79999em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.3959900000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-3.4119800000000002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¥</span></span></span><span style="top:-4.653em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>å…·ä½“çš„é‡‡æ ·ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">void downsample_2x2_mean(pixel *input, int width, int height, pixel *output) &#123;</span><br><span class="line">    int downsample_width &#x3D;  width &gt;&gt; 1;</span><br><span class="line">    int downsample_height &#x3D; height &gt;&gt; 1;</span><br><span class="line"></span><br><span class="line">    for (int y &#x3D; 0; y &lt; downsample_height; y++) &#123;</span><br><span class="line">        for (int x &#x3D;0; x &lt; downsample_width; x++) &#123;</span><br><span class="line">            output[y * downsample_width + x] &#x3D; (input[2 * y * width + 2 * x] +</span><br><span class="line">                                                input[2 * y * width + 2 * x + 1] +</span><br><span class="line">                                                input[(2 * y + 1) * width + 2 * x] +</span><br><span class="line">                                                input[(2 * y + 1) * width + 2 * x + 1]) &#x2F; 4;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶ååˆ©ç”¨<a href="https://github.com/FFmpeg/FFmpeg/blob/master/tests/tiny_ssim.c">tiny_ssim</a>ä¸­çš„<code>ssim_plane()</code>è¿­ä»£è®¡ç®—<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mo>âˆ’</mo><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">MS-SSIM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">float ms_ssim_plane(pixel *pix1, pixel *pix2, int width, int height, int scale) &#123;</span><br><span class="line">    for (int i &#x3D; 0; i &lt; w * h; i++) &#123;</span><br><span class="line">        ori_img1[i] &#x3D; pix1[i];</span><br><span class="line">        ori_img2[i] &#x3D; pix2[i];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; è®¡ç®—æ¯ä¸ªå°ºåº¦çš„ssimå€¼.</span><br><span class="line">    for (int i &#x3D; 1; i &lt;&#x3D; scale; i++) &#123;</span><br><span class="line">        if (i !&#x3D; 1) &#123;</span><br><span class="line">            downsample_2x2_mean(ori_img1, w, h, sample_img1);</span><br><span class="line">            downsample_2x2_mean(ori_img2, w, h, sample_img2);</span><br><span class="line">            w &#x3D; w &gt;&gt; 1;</span><br><span class="line">            h &#x3D; h &gt;&gt; 1;</span><br><span class="line">            for (int j &#x3D; 0; j &lt; w * h; j++) &#123;</span><br><span class="line">                ori_img1[j] &#x3D; sample_img1[j];</span><br><span class="line">                ori_img2[j] &#x3D; sample_img2[j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        value &#x3D; ssim_plane(ori_img1, w, ori_img2, w, w, h, temp, NULL);</span><br><span class="line">        result *&#x3D; pow(value.C_S, WEIGHT[i-1]);</span><br><span class="line">        luminance_value[i-1] &#x3D; value.L;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    result *&#x3D; pow(luminance_value[scale-1], WEIGHT[scale-1]);</span><br><span class="line">    return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å®Œæ•´çš„ä»£ç å¯ä»¥å‚è€ƒ<a href="https://gitee.com/wangwei1237/wangwei1237/blob/master/2020/02/25/how-to-calculate-the-MS-SSIM/test_msssim.cpp">test_msssim.cpp</a>ã€‚ä»£ç çš„å¾ˆå¤§éƒ¨åˆ†æ˜¯ç”±æˆ‘çš„åŒäº‹<em>è´¤æ°</em>(github: <a href="https://github.com/bodhisatan">@bodhisatan</a>)å®ç°çš„ï¼Œåœ¨æ­¤ä¸€å¹¶è¡¨ç¤ºæ„Ÿè°¢ã€‚</p>
]]></content>
      <categories>
        <category>IVQA</category>
      </categories>
      <tags>
        <tag>SSIM</tag>
        <tag>MS-SSIM</tag>
      </tags>
  </entry>
  <entry>
    <title>The Proof of the ssim_end1() in FFmpeg</title>
    <url>/2020/02/18/the-proof-of-the-SSIM-in-FFMpeg/</url>
    <content><![CDATA[<p>è¿™ç¯‡æ–‡ç« æ˜¯å¯¹<a href="https://github.com/FFmpeg/FFmpeg/blob/master/tests/tiny_ssim.c">FFmpegä¸­è®¡ç®—SSIMç®—æ³•</a>ä¸­ç”¨åˆ°çš„å…¬å¼çš„è¯æ˜ã€‚å…¶ä¸­çš„<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mi>s</mi><mn>1</mn></mrow><annotation encoding="application/x-tex">fs1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">s</span><span class="mord">1</span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mi>s</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">fs2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">s</span><span class="mord">2</span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mi>s</mi><mn>12</mn></mrow><annotation encoding="application/x-tex">fs12</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">s</span><span class="mord">1</span><span class="mord">2</span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mi>s</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">fss</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span></span></span></span>çš„å«ä¹‰å’ŒFFmpegä¿æŒä¸€è‡´ï¼Œå…·ä½“å¯ä»¥å‚è€ƒ<a href="/2020/02/15/how-to-calculate-the-SSIM-in-FFmpeg/">FFmpegå¦‚ä½•è®¡ç®—å›¾åƒçš„SSIM</a>ä¸­çš„è¯´æ˜ã€‚</p>
<span id="more"></span>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mrow><mo stretchy="false">(</mo><mn>2</mn><msub><mi>Î¼</mi><mi>a</mi></msub><msub><mi>Î¼</mi><mi>b</mi></msub><mo>+</mo><msub><mi>C</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mn>2</mn><msub><mi>Ïƒ</mi><mrow><mi>a</mi><mi>b</mi></mrow></msub><mo>+</mo><msub><mi>C</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><mrow><mo stretchy="false">(</mo><msubsup><mi>Î¼</mi><mi>a</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>Î¼</mi><mi>b</mi><mn>2</mn></msubsup><mo>+</mo><msub><mi>C</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msubsup><mi>Ïƒ</mi><mi>a</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>Ïƒ</mi><mi>b</mi><mn>2</mn></msubsup><mo>+</mo><msub><mi>C</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>Î¼</mi><mi>a</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mn>1</mn><mn>64</mn></mfrac><mi>f</mi><mi>s</mi><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>Î¼</mi><mi>b</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mn>1</mn><mn>64</mn></mfrac><mi>f</mi><mi>s</mi><mn>2</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msubsup><mi>Ïƒ</mi><mi>a</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>Ïƒ</mi><mi>b</mi><mn>2</mn></msubsup></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mn>1</mn><mn>63</mn></mfrac><mo stretchy="false">(</mo><munder><mo>âˆ‘</mo><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></munder><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>âˆ’</mo><msub><mi>Î¼</mi><mi>a</mi></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>+</mo><munder><mo>âˆ‘</mo><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></munder><mo stretchy="false">(</mo><mi>b</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>âˆ’</mo><msub><mi>Î¼</mi><mi>b</mi></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mn>1</mn><mn>63</mn></mfrac><munder><mo>âˆ‘</mo><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></munder><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>+</mo><msubsup><mi>Î¼</mi><mi>a</mi><mn>2</mn></msubsup><mo>âˆ’</mo><mn>2</mn><mo>â‹…</mo><mi>a</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>â‹…</mo><msub><mi>Î¼</mi><mi>a</mi></msub><mo>+</mo><mi>b</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>+</mo><msubsup><mi>Î¼</mi><mi>b</mi><mn>2</mn></msubsup><mo>âˆ’</mo><mn>2</mn><mo>â‹…</mo><mi>b</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>â‹…</mo><msub><mi>Î¼</mi><mi>b</mi></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mn>1</mn><mn>63</mn></mfrac><mo stretchy="false">(</mo><munder><mo>âˆ‘</mo><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></munder><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>+</mo><mi>b</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo stretchy="false">)</mo><mo>âˆ’</mo><mn>2</mn><mo stretchy="false">(</mo><msub><mi>Î¼</mi><mi>a</mi></msub><munder><mo>âˆ‘</mo><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></munder><mi>a</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>+</mo><msub><mi>Î¼</mi><mi>b</mi></msub><munder><mo>âˆ‘</mo><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></munder><mi>b</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>+</mo><munder><mo>âˆ‘</mo><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></munder><mo stretchy="false">(</mo><msubsup><mi>Î¼</mi><mi>a</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>Î¼</mi><mi>b</mi><mn>2</mn></msubsup><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mn>1</mn><mn>63</mn></mfrac><mo stretchy="false">(</mo><mi>f</mi><mi>s</mi><mi>s</mi><mo>âˆ’</mo><mn>2</mn><mo>â‹…</mo><mfrac><mn>1</mn><mn>64</mn></mfrac><mo stretchy="false">(</mo><mi>f</mi><mi>s</mi><msup><mn>1</mn><mn>2</mn></msup><mo>+</mo><mi>f</mi><mi>s</mi><msup><mn>2</mn><mn>2</mn></msup><mo stretchy="false">)</mo><mo>+</mo><mfrac><mn>1</mn><mn>64</mn></mfrac><mo stretchy="false">(</mo><mi>f</mi><mi>s</mi><msup><mn>1</mn><mn>2</mn></msup><mo>+</mo><mi>f</mi><mi>s</mi><msup><mn>2</mn><mn>2</mn></msup><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mn>1</mn><mn>63</mn></mfrac><mo stretchy="false">(</mo><mi>f</mi><mi>s</mi><mi>s</mi><mo>âˆ’</mo><mfrac><mn>1</mn><mn>64</mn></mfrac><mo stretchy="false">(</mo><mi>f</mi><mi>s</mi><msup><mn>1</mn><mn>2</mn></msup><mo>+</mo><mi>f</mi><mi>s</mi><msup><mn>2</mn><mn>2</mn></msup><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mn>1</mn><mn>63</mn></mfrac><mfrac><mn>1</mn><mn>64</mn></mfrac><mo stretchy="false">(</mo><mn>64</mn><mi>f</mi><mi>s</mi><mi>s</mi><mo>âˆ’</mo><mi>f</mi><mi>s</mi><msup><mn>1</mn><mn>2</mn></msup><mo>âˆ’</mo><mi>f</mi><mi>s</mi><msup><mn>2</mn><mn>2</mn></msup><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>Ïƒ</mi><mrow><mi>a</mi><mi>b</mi></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mn>1</mn><mn>63</mn></mfrac><munder><mo>âˆ‘</mo><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></munder><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>âˆ’</mo><msub><mi>Î¼</mi><mi>a</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>b</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>âˆ’</mo><msub><mi>Î¼</mi><mi>b</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mn>1</mn><mn>63</mn></mfrac><munder><mo>âˆ‘</mo><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></munder><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>â‹…</mo><mi>b</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>âˆ’</mo><mi>a</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo><msub><mi>Î¼</mi><mi>b</mi></msub><mo>âˆ’</mo><mi>b</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo><msub><mi>Î¼</mi><mi>a</mi></msub><mo>+</mo><msub><mi>Î¼</mi><mi>a</mi></msub><mo>â‹…</mo><msub><mi>Î¼</mi><mi>b</mi></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mn>1</mn><mn>63</mn></mfrac><mo stretchy="false">(</mo><mi>f</mi><mi>s</mi><mn>12</mn><mo>âˆ’</mo><mi>f</mi><mi>s</mi><mn>1</mn><mo>â‹…</mo><msub><mi>Î¼</mi><mi>b</mi></msub><mo>âˆ’</mo><mi>f</mi><mi>s</mi><mn>2</mn><mo>â‹…</mo><msub><mi>Î¼</mi><mi>a</mi></msub><mo>+</mo><mi>f</mi><mi>s</mi><mn>1</mn><mo>â‹…</mo><msub><mi>Î¼</mi><mi>b</mi></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mn>1</mn><mn>63</mn></mfrac><mo stretchy="false">(</mo><mi>f</mi><mi>s</mi><mn>12</mn><mo>âˆ’</mo><mfrac><mn>1</mn><mn>64</mn></mfrac><mi>f</mi><mi>s</mi><mn>1</mn><mo>â‹…</mo><mi>f</mi><mi>s</mi><mn>2</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mn>1</mn><mn>63</mn></mfrac><mfrac><mn>1</mn><mn>64</mn></mfrac><mo stretchy="false">(</mo><mn>64</mn><mi>f</mi><mi>s</mi><mn>12</mn><mo>âˆ’</mo><mi>f</mi><mi>s</mi><mn>1</mn><mo>â‹…</mo><mi>f</mi><mi>s</mi><mn>2</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mo>âˆ´</mo><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mrow><mo stretchy="false">(</mo><mn>2</mn><mi>f</mi><mi>s</mi><mn>1</mn><mo>â‹…</mo><mi>f</mi><mi>s</mi><mn>2</mn><mo>+</mo><mn>6</mn><msup><mn>4</mn><mn>2</mn></msup><msub><mi>C</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mn>2</mn><mo>â‹…</mo><mn>64</mn><mi>f</mi><mi>s</mi><mn>12</mn><mo>âˆ’</mo><mn>2</mn><mi>f</mi><mi>s</mi><mn>1</mn><mi>f</mi><mi>s</mi><mn>2</mn><mo>+</mo><mn>63</mn><mo>â‹…</mo><mn>64</mn><msub><mi>C</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><mrow><mo stretchy="false">(</mo><mi>f</mi><mi>s</mi><msup><mn>1</mn><mn>2</mn></msup><mo>+</mo><mi>f</mi><mi>s</mi><msup><mn>2</mn><mn>2</mn></msup><mo>+</mo><mn>6</mn><msup><mn>4</mn><mn>2</mn></msup><msub><mi>C</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mn>64</mn><mi>f</mi><mi>s</mi><mi>s</mi><mo>âˆ’</mo><mi>f</mi><mi>s</mi><msup><mn>1</mn><mn>2</mn></msup><mo>âˆ’</mo><mi>f</mi><mi>s</mi><msup><mn>2</mn><mn>2</mn></msup><mo>+</mo><mn>63</mn><mo>â‹…</mo><mn>64</mn><msub><mi>C</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow></mfrac></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}

SSIM(a,b)&amp;=\frac{(2\mu_a\mu_b+C_1)(2\sigma_{ab}+C_2)}{(\mu_a^2+\mu_b^2+C_1)(\sigma_a^2+\sigma_b^2+C_2)} \\

\mu_a&amp;=\frac{1}{64}fs1 \\

\mu_b&amp;=\frac{1}{64}fs2 \\

\sigma_a^2+\sigma_b^2&amp;=\frac{1}{63}(\sum_{i,j}(a(i,j)-\mu_a)^2 + \sum_{i,j}(b(i,j)-\mu_b)^2) \\

&amp;=\frac{1}{63}\sum_{i,j}(a(i,j)^2+\mu_a^2-2 \cdot a(i,j) \cdot \mu_a+b(i,j)^2+\mu_b^2-2 \cdot b(i,j) \cdot \mu_b) \\

&amp;=\frac{1}{63}(\sum_{i,j}(a(i,j)^2+b(i,j)^2)-2(\mu_a\sum_{i,j}a(i,j)+\mu_b\sum_{i,j}b(i,j))+\sum_{i,j}
(\mu_a^2+\mu_b^2)) \\

&amp;=\frac{1}{63}(fss-2 \cdot \frac{1}{64}(fs1^2+fs2^2)+\frac{1}{64}(fs1^2+fs2^2) \\

&amp;=\frac{1}{63}(fss-\frac{1}{64}(fs1^2+fs2^2)) \\

&amp;=\frac{1}{63}\frac{1}{64}(64fss-fs1^2-fs2^2) \\

\sigma_{ab}&amp;=\frac{1}{63}\sum_{i,j}((a(i,j)-\mu_a)(b(i,j)-\mu_b)) \\

&amp;=\frac{1}{63}\sum_{i,j}(a(i,j) \cdot b(i,j)-a(i,j)\mu_b-b(i,j)\mu_a+\mu_a \cdot \mu_b) \\

&amp;=\frac{1}{63}(fs12-fs1 \cdot \mu_b-fs2 \cdot \mu_a+fs1 \cdot \mu_b) \\

&amp;=\frac{1}{63}(fs12-\frac{1}{64}fs1 \cdot fs2) \\

&amp;=\frac{1}{63}\frac{1}{64}(64fs12-fs1 \cdot fs2) \\

\therefore SSIM(a,b)&amp;=\frac{(2fs1 \cdot fs2+64^2C_1)(2 \cdot 64fs12-2fs1fs2+63 \cdot 64C_2)}{(fs1^2+fs2^2+64^2C_1)(64fss-fs1^2-fs2^2+63 \cdot 64C_2)}

\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:39.07702099999999em;vertical-align:-19.288510499999994em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:19.788510499999994em;"><span style="top:-21.852618499999995em;"><span class="pstrut" style="height:3.491108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span><span class="mclose">)</span></span></span><span style="top:-19.243870499999993em;"><span class="pstrut" style="height:3.491108em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-16.936430499999997em;"><span class="pstrut" style="height:3.491108em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-14.628990499999997em;"><span class="pstrut" style="height:3.491108em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span><span style="top:-11.593773499999994em;"><span class="pstrut" style="height:3.491108em;"></span><span class="mord"></span></span><span style="top:-8.558556499999995em;"><span class="pstrut" style="height:3.491108em;"></span><span class="mord"></span></span><span style="top:-5.523339499999996em;"><span class="pstrut" style="height:3.491108em;"></span><span class="mord"></span></span><span style="top:-3.215899499999997em;"><span class="pstrut" style="height:3.491108em;"></span><span class="mord"></span></span><span style="top:-0.9084594999999974em;"><span class="pstrut" style="height:3.491108em;"></span><span class="mord"></span></span><span style="top:1.398980500000001em;"><span class="pstrut" style="height:3.491108em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">b</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:4.4341975em;"><span class="pstrut" style="height:3.491108em;"></span><span class="mord"></span></span><span style="top:7.4694145em;"><span class="pstrut" style="height:3.491108em;"></span><span class="mord"></span></span><span style="top:9.776854499999999em;"><span class="pstrut" style="height:3.491108em;"></span><span class="mord"></span></span><span style="top:12.084294499999999em;"><span class="pstrut" style="height:3.491108em;"></span><span class="mord"></span></span><span style="top:14.561402499999993em;"><span class="pstrut" style="height:3.491108em;"></span><span class="mord"><span class="mrel amsrm">âˆ´</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:19.288510499999994em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:19.788510499999994em;"><span style="top:-21.852618499999995em;"><span class="pstrut" style="height:3.491108em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7959079999999998em;"><span style="top:-2.398692em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span><span style="top:-3.0448em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.30130799999999996em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7959079999999998em;"><span style="top:-2.398692em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span><span style="top:-3.0448em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.30130799999999996em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord">2</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">b</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.9873080000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-19.243870499999993em;"><span class="pstrut" style="height:3.491108em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">6</span><span class="mord">4</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">s</span><span class="mord">1</span></span></span><span style="top:-16.936430499999997em;"><span class="pstrut" style="height:3.491108em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">6</span><span class="mord">4</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">s</span><span class="mord">2</span></span></span><span style="top:-14.628990499999997em;"><span class="pstrut" style="height:3.491108em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">6</span><span class="mord">3</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8723309999999997em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.413777em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8723309999999997em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.413777em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">b</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-11.593773499999994em;"><span class="pstrut" style="height:3.491108em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">6</span><span class="mord">3</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8723309999999997em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.413777em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">a</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">b</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">b</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-8.558556499999995em;"><span class="pstrut" style="height:3.491108em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">6</span><span class="mord">3</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8723309999999997em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.413777em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">b</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8723309999999997em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.413777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">a</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8723309999999997em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.413777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8723309999999997em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.413777em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span></span></span><span style="top:-5.523339499999996em;"><span class="pstrut" style="height:3.491108em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">6</span><span class="mord">3</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">6</span><span class="mord">4</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">s</span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">s</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">6</span><span class="mord">4</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">s</span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">s</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.215899499999997em;"><span class="pstrut" style="height:3.491108em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">6</span><span class="mord">3</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">6</span><span class="mord">4</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">s</span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">s</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span></span></span><span style="top:-0.9084594999999974em;"><span class="pstrut" style="height:3.491108em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">6</span><span class="mord">3</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">6</span><span class="mord">4</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord">6</span><span class="mord">4</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">s</span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">s</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:1.398980500000001em;"><span class="pstrut" style="height:3.491108em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">6</span><span class="mord">3</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8723309999999997em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.413777em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathdefault">b</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span></span></span><span style="top:4.4341975em;"><span class="pstrut" style="height:3.491108em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">6</span><span class="mord">3</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8723309999999997em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.413777em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">b</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">a</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">b</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:7.4694145em;"><span class="pstrut" style="height:3.491108em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">6</span><span class="mord">3</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">s</span><span class="mord">1</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">s</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">s</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">s</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:9.776854499999999em;"><span class="pstrut" style="height:3.491108em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">6</span><span class="mord">3</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">s</span><span class="mord">1</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">6</span><span class="mord">4</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">s</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">s</span><span class="mord">2</span><span class="mclose">)</span></span></span><span style="top:12.084294499999999em;"><span class="pstrut" style="height:3.491108em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">6</span><span class="mord">3</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">6</span><span class="mord">4</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord">6</span><span class="mord">4</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">s</span><span class="mord">1</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">s</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">s</span><span class="mord">2</span><span class="mclose">)</span></span></span><span style="top:14.561402499999993em;"><span class="pstrut" style="height:3.491108em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.491108em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">s</span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">s</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">6</span><span class="mord"><span class="mord">4</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord">6</span><span class="mord">4</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">s</span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">s</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">6</span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">6</span><span class="mord">4</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">2</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">s</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">s</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">6</span><span class="mord"><span class="mord">4</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">6</span><span class="mord">4</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">s</span><span class="mord">1</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">s</span><span class="mord">1</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">s</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">6</span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">6</span><span class="mord">4</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:19.288510499999994em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
]]></content>
      <categories>
        <category>IVQA</category>
      </categories>
      <tags>
        <tag>FFmpeg</tag>
        <tag>SSIM</tag>
      </tags>
  </entry>
  <entry>
    <title>FFmpegå¦‚ä½•è®¡ç®—å›¾åƒçš„SSIM</title>
    <url>/2020/02/15/how-to-calculate-the-SSIM-in-FFMpeg/</url>
    <content><![CDATA[<h2 id="ssimåŸºæœ¬æ¦‚å¿µ">SSIMåŸºæœ¬æ¦‚å¿µ</h2>
<p>å…³äº<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">SSIM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>çš„å…·ä½“è§£é‡Šï¼Œæ­¤å¤„ä¸å†ä»‹ç»ï¼Œå…·ä½“å¯ä»¥å‚è§<a href="https://wangwei1237.gitee.io/digital-video-concept/">æ•°å­—è§†é¢‘ç›¸å…³æ¦‚å¿µ</a>ä¸­çš„<a href="https://wangwei1237.gitee.io/digital-video-concept/docs/4_2_2_3_StructuralSimilarityBasedApproaches.html">SSIMç®—æ³•</a>ä¸€èŠ‚çš„ä»‹ç»ã€‚</p>
<p>ç›´æ¥ç»™å‡º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">SSIM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>çš„è®¡ç®—æ–¹æ³•ï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mo stretchy="false">(</mo><mn>2</mn><msub><mi>Î¼</mi><mi>x</mi></msub><msub><mi>Î¼</mi><mi>y</mi></msub><mo>+</mo><msub><mi>C</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mn>2</mn><msub><mi>Ïƒ</mi><mrow><mi>x</mi><mi>y</mi></mrow></msub><mo>+</mo><msub><mi>C</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><mrow><mo stretchy="false">(</mo><msubsup><mi>Î¼</mi><mi>x</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>Î¼</mi><mi>y</mi><mn>2</mn></msubsup><mo>+</mo><msub><mi>C</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msubsup><mi>Ïƒ</mi><mi>x</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>Ïƒ</mi><mi>y</mi><mn>2</mn></msubsup><mo>+</mo><msub><mi>C</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">SSIM(x,y)=\frac{(2\mu_x\mu_y+C_1)(2\sigma_{xy}+C_2)}{(\mu_x^2+\mu_y^2+C_1)(\sigma_x^2+\sigma_y^2+C_2)}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.496108em;vertical-align:-1.069108em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7401079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.383108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7401079999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.383108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord">2</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.069108em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mn>1</mn></msub><mo>=</mo><mo stretchy="false">(</mo><msub><mi>K</mi><mn>1</mn></msub><mi>L</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo separator="true">,</mo><msub><mi>C</mi><mn>2</mn></msub><mo>=</mo><mo stretchy="false">(</mo><msub><mi>K</mi><mn>2</mn></msub><mi>L</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">C_1=(K_1L)^2, C_2=(K_2L)^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault">L</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault">L</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>ã€‚<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mn>1</mn></msub><mo>â‰ª</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">K_1\ll1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰ª</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mn>2</mn></msub><mo>â‰ª</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">K_2\ll1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰ª</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>å‡ä¸ºå¸¸æ•°ï¼Œè®¡ç®—æ—¶ï¼Œä¸€èˆ¬<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mn>1</mn></msub><mo>=</mo><mn>0.01</mn></mrow><annotation encoding="application/x-tex">K_1=0.01</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">1</span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mn>2</mn></msub><mo>=</mo><mn>0.03</mn></mrow><annotation encoding="application/x-tex">K_2=0.03</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">3</span></span></span></span>ã€‚<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">L</span></span></span></span>æ˜¯ç°åº¦çš„åŠ¨æ€èŒƒå›´ï¼Œç”±å›¾åƒçš„æ•°æ®ç±»å‹å†³å®šï¼Œå¦‚æœæ•°æ®ä¸º<em>uint8</em>ï¼Œåˆ™<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo>=</mo><mn>255</mn></mrow><annotation encoding="application/x-tex">L=255</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">L</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord">5</span><span class="mord">5</span></span></span></span>ã€‚</p>
<span id="more"></span>
<h2 id="ssimè®¡ç®—ä¸­çš„å›¾åƒåˆ†å‰²">SSIMè®¡ç®—ä¸­çš„å›¾åƒåˆ†å‰²</h2>
<p>åœ¨æ•´å¹…å›¾ç‰‡çš„è·¨åº¦ä¸Šï¼Œå›¾åƒäº®åº¦çš„å‡å€¼å’Œæ–¹å·®å˜åŒ–è¾ƒä¸ºå‰§çƒˆï¼›å¹¶ä¸”å›¾åƒä¸Šä¸åŒåŒºå—çš„å¤±çœŸç¨‹åº¦ä¹Ÿæœ‰å¯èƒ½ä¸åŒï¼›å†è€…äººçœ¼ç›æ¯æ¬¡åªèƒ½èšç„¦äºä¸€å¤„ï¼Œæ›´å…³æ³¨å±€éƒ¨æ•°æ®è€Œéå…¨å±€æ•°æ®ã€‚å› æ­¤å¦‚ä¸Šçš„<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">SSIM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>ç®—æ³•ä¸èƒ½ç›´æ¥ä½œç”¨äºä¸€æ•´å‰¯å›¾åƒã€‚</p>
<p>åœ¨è®ºæ–‡<strong>Image quality assessment: From error visibility to structural similarity</strong>ä¸­ï¼Œä½œè€…é‡‡ç”¨<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>11</mn><mo>Ã—</mo><mn>11</mn></mrow><annotation encoding="application/x-tex">11 \times 11</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">1</span></span></span></span>çš„æ»‘åŠ¨çª—å£å°†æ•´å‰¯å›¾åƒåˆ†å‰²ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span>ä¸ªpatchï¼Œç„¶åè®¡ç®—æ¯ä¸€ä¸ªpatchçš„<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">SSIM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>ï¼Œæœ€åè®¡ç®—æ‰€æœ‰patchçš„<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">SSIM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>å€¼çš„å¹³å‡æ•°ï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>e</mi><mi>a</mi><mi>n</mi><mtext>Â Â </mtext><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi><mo>:</mo><mi>M</mi><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">Mean \ \ SSIM:MSSIM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault">e</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mspace">Â </span><span class="mspace">Â </span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>ï¼‰ä½œä¸ºæ•´å‰¯å›¾åƒçš„<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">SSIM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>ã€‚ä¸ºäº†é¿å…æ»‘åŠ¨çª—å£å¸¦æ¥çš„å—æ•ˆåº”ï¼Œåœ¨è®¡ç®—æ¯ä¸ªpatchçš„å‡å€¼<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¼</mi></mrow><annotation encoding="application/x-tex">\mu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">Î¼</span></span></span></span>å’Œæ–¹å·®<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Ïƒ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\sigma^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>æ—¶ï¼Œä½œè€…é‡‡ç”¨äº†<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ïƒ</mi><mo>=</mo><mn>1.5</mn></mrow><annotation encoding="application/x-tex">\sigma=1.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">Ïƒ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">5</span></span></span></span>çš„é«˜æ–¯å·ç§¯æ ¸ä½œåŠ æƒå¹³å‡ã€‚</p>
<p>å¦‚æœæ•´å‰¯å›¾åƒæœ‰<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span>ä¸ªpatchï¼Œåˆ™<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">MSSIM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>çš„è®¡ç®—æ–¹å¼ä¸ºï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">MSSIM(X,Y) = \frac{1}{N}\sum_{i=1}^{N}{SSIM(x_i, y_i)}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.106005em;vertical-align:-1.277669em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span></p>
<p>å…¶ä¸­ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">SSIM(x_i, y_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>ä¸ºç¬¬<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span>ä¸ªpatchçš„<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">SSIM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>ã€‚</p>
<h2 id="ffmpegä¸­è®¡ç®—ssimçš„ç®—æ³•">FFmpegä¸­è®¡ç®—SSIMçš„ç®—æ³•</h2>
<p>åœ¨FFmpegä¸­ï¼Œä¹Ÿæä¾›äº†è®¡ç®—<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">SSIM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>çš„å®ç°ï¼š<a href="https://github.com/FFmpeg/FFmpeg/blob/master/tests/tiny_ssim.c">tiny_ssim</a>ã€‚ä»ä»£ç çš„æ³¨é‡Šä¸­å¯ä»¥çœ‹åˆ°ï¼šä¸ºäº†æå‡ç®—æ³•çš„æ€§èƒ½ï¼Œæ²¡æœ‰é‡‡ç”¨è®ºæ–‡ä¸­çš„é«˜æ–¯åŠ æƒæ–¹å¼è®¡ç®—æ¯ä¸ªpatchçš„<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">SSIM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>ï¼Œè€Œæ˜¯é‡‡ç”¨äº†ä¸€ä¸ª<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>8</mn><mo>Ã—</mo><mn>8</mn></mrow><annotation encoding="application/x-tex">8 \times 8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">8</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">8</span></span></span></span>çš„å—æ¥è®¡ç®—æ¯ä¸ªpatchçš„<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">SSIM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line"> * tiny_ssim.c</span><br><span class="line"> * Computes the Structural Similarity Metric between two rawYV12 video files.</span><br><span class="line"> * original algorithm:</span><br><span class="line"> * Z. Wang, A. C. Bovik, H. R. Sheikh and E. P. Simoncelli,</span><br><span class="line"> *   &quot;Image quality assessment: From error visibility to structural similarity,&quot;</span><br><span class="line"> *   IEEE Transactions on Image Processing, vol. 13, no. 4, pp. 600-612, Apr. 2004.</span><br><span class="line"> *</span><br><span class="line"> * To improve speed, this implementation uses the standard approximation of</span><br><span class="line"> * overlapped 8x8 block sums, rather than the original gaussian weights.</span><br><span class="line"> *&#x2F;</span><br></pre></td></tr></table></figure>
<h3 id="standard-approximation-of-overlapped-8x8-block-sums">standard approximation of overlapped 8x8 block sums</h3>
<p>æ¥ä¸‹æ¥å°±è§£é‡Šä¸€ä¸‹æ³¨é‡Šä¸­çš„<em>standard approximation of overlapped 8x8 block sums</em>ç©¶ç«Ÿæ˜¯ä»€ä¹ˆå«ä¹‰ã€‚åœ¨è§£é‡Šçš„è¿‡ç¨‹ä¸­ä¼šåˆ†è§£æˆä¸¤ä¸ªéƒ¨åˆ†æ¥è§£é‡Šï¼š<em>overlapped 8x8 block</em>å’Œ<em>sums</em>ã€‚</p>
<h3 id="overlapped-8x8-blockçš„å«ä¹‰">overlapped 8x8 blockçš„å«ä¹‰</h3>
<p>FFmpegåœ¨è®¡ç®—å›¾åƒ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">SSIM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>æ—¶ï¼Œé¦–å…ˆä»¥<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn><mo>Ã—</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">4 \times 4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">4</span></span></span></span>çš„å—å¤§å°æŠŠ<strong>å›¾1</strong>æ‰€ç¤ºçš„åˆ†è¾¨ç‡ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mo>Ã—</mo><mi>H</mi></mrow><annotation encoding="application/x-tex">W \times H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span></span></span></span>çš„å›¾åƒï¼š<br>
<img src="/2020/02/15/how-to-calculate-the-SSIM-in-FFMpeg/1.jpg" alt="å›¾1"><br>
å›¾1ï¼šåŸå§‹å›¾åƒ</p>
<p>åˆ†å‰²ä¸º<strong>å›¾2</strong>çš„æ ·å¼ã€‚<br>
<img src="/2020/02/15/how-to-calculate-the-SSIM-in-FFMpeg/2.jpg" alt="å›¾2"></p>
<p>å›¾2ï¼šåˆ†å‰²åçš„å›¾åƒ</p>
<p>å¯¹äº<strong>å›¾2</strong>ä¸­çš„æ¯ä¸€å—ç”¨<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mi>l</mi><mi>o</mi><mi>c</mi><mi>k</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">block(i,j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span>æ¥è¡¨ç¤ºï¼ˆ<em>å›¾2ä¸­çš„çº¢è‰²å—</em>ï¼‰ï¼ŒFFmpegä½¿ç”¨<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mi>l</mi><mi>o</mi><mi>c</mi><mi>k</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">block(i,j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span>åŠå…¶<strong>ä¸Šã€å³ã€å³ä¸Šå—</strong>ï¼ˆ<em>å›¾2ä¸­çš„ç»¿è‰²å—</em>ï¼‰æ¥è®¡ç®—å…¶<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi><mo>:</mo><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo separator="true">,</mo><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">SSIM:SSIM(x_{ij},y_{ij})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>ã€‚</p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mi>l</mi><mi>o</mi><mi>c</mi><mi>k</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">block(i,j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span>åŠå…¶<strong>ä¸Šã€å³ã€å³ä¸Šå—</strong>æ„æˆä¸€ä¸ª<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>8</mn><mo>Ã—</mo><mn>8</mn></mrow><annotation encoding="application/x-tex">8\times8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">8</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">8</span></span></span></span>çš„åƒç´ å—ï¼Œå¹¶ä¸”è¯¥<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>8</mn><mo>Ã—</mo><mn>8</mn></mrow><annotation encoding="application/x-tex">8\times8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">8</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">8</span></span></span></span>çš„å—å’Œè®¡ç®—<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mi>l</mi><mi>o</mi><mi>c</mi><mi>k</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">block(i,j+1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span>çš„<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">SSIM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>ç”¨åˆ°çš„<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>8</mn><mo>Ã—</mo><mn>8</mn></mrow><annotation encoding="application/x-tex">8\times8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">8</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">8</span></span></span></span>çš„å—å­˜åœ¨é‡åˆåƒç´ ï¼Œè¿™å°±æ˜¯æ³¨é‡Šä¸­çš„<strong>overlapped 8x8 block</strong>çš„çœŸæ­£å«ä¹‰ã€‚</p>
<p>å› æ­¤ï¼Œæ ¹æ®å¦‚ä¸Šè§„åˆ™ï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>âˆˆ</mo><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mfrac><mi>H</mi><mn>4</mn></mfrac><mo stretchy="false">]</mo><mo separator="true">,</mo><mi>j</mi><mo>âˆˆ</mo><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mfrac><mi>W</mi><mn>4</mn></mfrac><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">i \in [1,\frac{H}{4}],j \in [0,\frac{W}{4}-1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69862em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.217331em;vertical-align:-0.345em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.872331em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.08125em;">H</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.217331em;vertical-align:-0.345em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.872331em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">W</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼šç¬¬0è¡Œå’Œæœ€åä¸€åˆ—çš„å—ä¸ä¼šè®¡ç®—<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">SSIM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>ã€‚</p>
<p>æœ€åå¾—åˆ°FFmpegä¸­çš„<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">SSIM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>è®¡ç®—æ–¹å¼ä¸ºï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi><mo>=</mo><mi>M</mi><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mfrac><mi>H</mi><mn>4</mn></mfrac></munderover><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>0</mn></mrow><mrow><mfrac><mi>W</mi><mn>4</mn></mfrac><mo>âˆ’</mo><mn>1</mn></mrow></munderover><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo separator="true">,</mo><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">SSIM = MSSIM(X,Y) = \frac{1}{N}\sum_{i=1}^{\frac{H}{4}}\sum_{j=0}^{\frac{W}{4}-1}{SSIM(x_{ij}, y_{ij})}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.526047em;vertical-align:-1.4137769999999998em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.11227em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.451805em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8720928571428572em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span><span style="top:-3.2255000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.08125em;">H</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.1122700000000005em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.451805em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8720928571428572em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span><span style="top:-3.2255000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">W</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span></p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mo stretchy="false">(</mo><mfrac><mi>H</mi><mn>4</mn></mfrac><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mfrac><mi>W</mi><mn>4</mn></mfrac><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">N=(\frac{H}{4}-1)(\frac{W}{4}-1)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.04633em;vertical-align:-0.686em;"></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.08125em;">H</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.04633em;vertical-align:-0.686em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">W</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span></p>
<h3 id="sumsçš„å«ä¹‰">sumsçš„å«ä¹‰</h3>
<p>å¦‚å‰æ‰€è¿°ï¼Œæˆ‘ä»¬åˆ†æäº†FFmpegè®¡ç®—å›¾åƒçš„<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">SSIM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>çš„æ•´ä½“æ€è·¯ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ç»§ç»­åˆ†æFFmpegæ˜¯å¦‚ä½•è®¡ç®—<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mi>l</mi><mi>o</mi><mi>c</mi><mi>k</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">block(i,j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span>çš„<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo separator="true">,</mo><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">SSIM(x_{ij},y_{ij})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>çš„ã€‚</p>
<p>é¦–å…ˆåˆ©ç”¨å‡½æ•°<code>ssim_4x4x2_core()</code>æ¥è®¡ç®—<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mi>l</mi><mi>o</mi><mi>c</mi><mi>k</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">block(i,j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span>å—çš„ç»“æ„ç›¸ä¼¼æ€§æŒ‡æ ‡ï¼Œä¸»è¦æ˜¯å¦‚ä¸‹çš„4ä¸ªæŒ‡æ ‡ï¼š</p>
<ul>
<li><em>s1</em>ï¼šå‚è€ƒå›¾åƒåœ¨<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mi>l</mi><mi>o</mi><mi>c</mi><mi>k</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">block(i,j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span>å—çš„åƒç´ ä¹‹å’Œ</li>
<li><em>s2</em>ï¼šå—æŸå›¾åƒåœ¨<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mi>l</mi><mi>o</mi><mi>c</mi><mi>k</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">block(i,j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span>å—çš„åƒç´ ä¹‹å’Œ</li>
<li><em>ss</em>ï¼šå‚è€ƒå›¾åƒå’Œå—æŸå›¾åƒåœ¨<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mi>l</mi><mi>o</mi><mi>c</mi><mi>k</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">block(i,j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span>å—çš„åƒç´ å¹³æ–¹ä¹‹å’Œ</li>
<li><em>s12</em>ï¼šå‚è€ƒå›¾åƒå’Œå—æŸå›¾åƒåœ¨<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mi>l</mi><mi>o</mi><mi>c</mi><mi>k</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">block(i,j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span>å—çš„å¯¹åº”åƒç´ ä¹˜ç§¯ä¹‹å’Œ</li>
</ul>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mn>1</mn><mo>=</mo><msubsup><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mn>3</mn></msubsup><msubsup><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>0</mn></mrow><mn>3</mn></msubsup><mrow><mi>x</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">s1=\sum_{i=0}^{3}\sum_{j=0}^{3}{x(i,j)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathdefault">s</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.389826em;vertical-align:-0.43581800000000004em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.954008em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.954008em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.43581800000000004em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mn>2</mn><mo>=</mo><msubsup><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mn>3</mn></msubsup><msubsup><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>0</mn></mrow><mn>3</mn></msubsup><mrow><mi>y</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">s2=\sum_{i=0}^{3}\sum_{j=0}^{3}{y(i,j)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathdefault">s</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.389826em;vertical-align:-0.43581800000000004em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.954008em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.954008em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.43581800000000004em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>s</mi><mo>=</mo><msubsup><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mn>3</mn></msubsup><msubsup><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>0</mn></mrow><mn>3</mn></msubsup><mrow><mo fence="false">(</mo><mo fence="false">(</mo><mi>x</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo><msup><mo fence="false">)</mo><mn>2</mn></msup><mo>+</mo><mo fence="false">(</mo><mi>y</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo><msup><mo fence="false">)</mo><mn>2</mn></msup><mo fence="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">ss=\sum_{i=0}^{3}\sum_{j=0}^{3}{\Big(\big(x(i,j)\big)^2+\big(y(i,j)\big)^2\Big)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.80002em;vertical-align:-0.65002em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.954008em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.954008em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.43581800000000004em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="delimsizing size2">(</span></span><span class="mord"><span class="delimsizing size1">(</span></span><span class="mord mathdefault">x</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mord"><span class="mord"><span class="delimsizing size1">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.054008em;"><span style="top:-3.3029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="delimsizing size1">(</span></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mord"><span class="mord"><span class="delimsizing size1">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.054008em;"><span style="top:-3.3029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size2">)</span></span></span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mn>12</mn><mo>=</mo><msubsup><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mn>3</mn></msubsup><msubsup><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>0</mn></mrow><mn>3</mn></msubsup><mrow><mo fence="false">(</mo><mi>x</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>â‹…</mo><mi>y</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo><mo fence="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">s12=\sum_{i=0}^{3}\sum_{j=0}^{3}{\big(x(i,j) \cdot y(i,j)\big)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathdefault">s</span><span class="mord">1</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.389826em;vertical-align:-0.43581800000000004em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.954008em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.954008em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.43581800000000004em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="delimsizing size1">(</span></span><span class="mord mathdefault">x</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mord"><span class="delimsizing size1">)</span></span></span></span></span></span></p>
<p>å¦‚ä¸Šçš„4ä¸ªæŒ‡æ ‡å°±æ˜¯æˆ‘ä»¬åç»­ä¼šç”¨åˆ°çš„sumsï¼Œè¯¥sumsä¹Ÿå°±æ˜¯<em>overlapped 8x8 block sums</em>ä¸­çš„<em>sums</em>çš„æ¦‚å¿µã€‚</p>
<h3 id="åˆ©ç”¨sumsè®¡ç®—å„å—çš„ssim">åˆ©ç”¨sumsè®¡ç®—å„å—çš„SSIM</h3>
<p>æ¥ä¸‹æ¥åˆ©ç”¨è¯¥sumså€¼è®¡ç®—<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">SSIM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>ã€‚</p>
<p>ä¸ºäº†æå‡æ•ˆç‡ï¼ŒFFmpegä¼šæŒ‰ç…§è¡Œæ¥è®¡ç®—æ¯ä¸€è¡Œçš„å„ä¸ªå—çš„sumsæ•°æ®ï¼Œå¹¶å°†æ¯ä¸ªè¡Œå—çš„sumsæ•°æ®å­˜å‚¨åœ¨é•¿åº¦ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mi>W</mi><mn>4</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{W}{4}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.217331em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.872331em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">W</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>çš„æ•°ç»„æŒ‡é’ˆsumï¼ˆ<code>(int(*)[4])</code>ï¼‰ä¸­ã€‚</p>
<p>å…¶ä¸­sumæŒ‡é’ˆæœ‰ä¸¤ç§ï¼š</p>
<ul>
<li>sum0ï¼šå­˜å‚¨å½“å‰è¡Œçš„å„å—çš„sumsç»“æœ</li>
<li>sum1ï¼šå­˜å‚¨å½“å‰è¡Œçš„ä¸Šä¸€è¡Œçš„sumsç»“æœ</li>
</ul>
<p>å…ˆè®¡ç®—ç¬¬<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.74285em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>è¡Œå—å’Œç¬¬<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span>è¡Œå—çš„sumsç»“æœï¼Œå¹¶åˆ†åˆ«å­˜å…¥<code>sum1</code>å’Œ<code>sum0</code>ä¸­ã€‚ç„¶åéå†ç¬¬<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span>è¡Œå—çš„æ¯ä¸€ä¸ªå—ï¼Œå¹¶åˆ©ç”¨<code>sum1</code>å’Œ<code>sum0</code>ä¸­è®¡ç®—çš„ç»“æœæ¥è®¡ç®—æ¯ä¸€å—çš„<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">SSIM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>ã€‚</p>
<p>å‡½æ•°<code>ssim_end4()</code>å±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mi>l</mi><mi>o</mi><mi>c</mi><mi>k</mi><mo stretchy="false">(</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">block(i-1,j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mi>l</mi><mi>o</mi><mi>c</mi><mi>k</mi><mo stretchy="false">(</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo separator="true">,</mo><mi>j</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">block(i-1,j+1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mi>l</mi><mi>o</mi><mi>c</mi><mi>k</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">block(i,j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mi>l</mi><mi>o</mi><mi>c</mi><mi>k</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">block(i,j+1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span>çš„sumsä¿¡æ¯æ¥è®¡ç®—<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo separator="true">,</mo><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">SSIM(x_{ij},y_{ij})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>ï¼š</p>
<ul>
<li>å…ˆå¯¹4ä¸ªå—çš„sumsç»“æœè¿›è¡ŒåŠ å’Œå¤„ç†ï¼Œå¾—åˆ°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>8</mn><mo>Ã—</mo><mn>8</mn></mrow><annotation encoding="application/x-tex">8\times8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">8</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">8</span></span></span></span>å—çš„sumsç»“æœ</li>
<li>ç„¶ååˆ©ç”¨è¯¥<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>8</mn><mo>Ã—</mo><mn>8</mn></mrow><annotation encoding="application/x-tex">8\times8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">8</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">8</span></span></span></span>å—çš„sumsæ¥è®¡ç®—<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mi>l</mi><mi>o</mi><mi>c</mi><mi>k</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">block(i,j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span>çš„<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">SSIM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span></li>
</ul>
<p>å‡½æ•°<code>ssim_end1()</code>å°±å±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>8</mn><mo>Ã—</mo><mn>8</mn></mrow><annotation encoding="application/x-tex">8\times8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">8</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">8</span></span></span></span>å—çš„sumsä¿¡æ¯æ¥è®¡ç®—<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">SSIM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>ã€‚å…·ä½“çš„è®¡ç®—æ–¹æ³•å¦‚ä¸‹ã€‚</p>
<p>å°†çº¢è‰²åŒºå—<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mi>l</mi><mi>o</mi><mi>c</mi><mi>k</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">block(i,j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span>çš„å›¾åƒæ”¾å¤§ä¸€ç‚¹ï¼Œå¦‚å›¾3æ‰€ç¤ºã€‚æˆ‘ä»¬æ¥ä¸‹æ¥è®¡ç®—å…¶<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">SSIM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>ã€‚<br>
<img src="/2020/02/15/how-to-calculate-the-SSIM-in-FFMpeg/3.jpg" alt="å›¾3"><br>
å›¾3ï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mi>l</mi><mi>o</mi><mi>c</mi><mi>k</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">block(i,j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span>çš„ç¤ºæ„å›¾</p>
<p>åœ¨è®¡ç®—æ—¶ï¼Œé¦–å…ˆå°†4ä¸ªåŒºå—çš„sumså€¼æ±‚å’Œï¼Œå¾—åˆ°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>8</mn><mo>Ã—</mo><mn>8</mn></mrow><annotation encoding="application/x-tex">8\times8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">8</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">8</span></span></span></span>åŒºå—çš„sumså€¼ï¼Œåˆ†åˆ«ä¸ºï¼š</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mn>1</mn><mo>=</mo><msubsup><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mn>63</mn></msubsup><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">s1=\sum_{i=0}^{63}{x_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathdefault">s</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.253718em;vertical-align:-0.29971000000000003em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.954008em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mn>2</mn><mo>=</mo><msubsup><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mn>63</mn></msubsup><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">s2=\sum_{i=0}^{63}{y_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathdefault">s</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.253718em;vertical-align:-0.29971000000000003em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.954008em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>s</mi><mo>=</mo><msubsup><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mn>63</mn></msubsup><mrow><mo stretchy="false">(</mo><msubsup><mi>x</mi><mi>i</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>y</mi><mi>i</mi><mn>2</mn></msubsup><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">ss=\sum_{i=0}^{63}{(x_i^2+y_i^2)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.253718em;vertical-align:-0.29971000000000003em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.954008em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.441336em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.258664em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.441336em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.258664em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mn>12</mn><mo>=</mo><msubsup><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mn>63</mn></msubsup><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>â‹…</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">s12=\sum_{i=0}^{63}{(x_i \cdot y_i)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathdefault">s</span><span class="mord">1</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.253718em;vertical-align:-0.29971000000000003em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.954008em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></li>
</ul>
<p>æ ¹æ®å¦‚ä¸Šçš„è®¡ç®—ï¼Œå¯ä»¥å¾—åˆ°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î¼</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">\mu_x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î¼</mi><mi>y</mi></msub></mrow><annotation encoding="application/x-tex">\mu_y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î¼</mi><mi>x</mi></msub><msub><mi>Î¼</mi><mi>y</mi></msub></mrow><annotation encoding="application/x-tex">\mu_x\mu_y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>Î¼</mi><mi>x</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>Î¼</mi><mi>y</mi><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\mu_x^2+\mu_y^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.061108em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.197216em;vertical-align:-0.383108em;"></span><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.383108em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>Ïƒ</mi><mi>x</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>Ïƒ</mi><mi>y</mi><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\sigma_x^2+\sigma_y^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.061108em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.197216em;vertical-align:-0.383108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.383108em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Ïƒ</mi><mrow><mi>x</mi><mi>y</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\sigma_{xy}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>ï¼š</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î¼</mi><mi>x</mi></msub><mo>=</mo><mfrac><mn>1</mn><mn>64</mn></mfrac><mo>â‹…</mo><mi>s</mi><mn>1</mn></mrow><annotation encoding="application/x-tex">\mu_x=\frac{1}{64} \cdot s1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span><span class="mord mtight">4</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathdefault">s</span><span class="mord">1</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î¼</mi><mi>y</mi></msub><mo>=</mo><mfrac><mn>1</mn><mn>64</mn></mfrac><mo>â‹…</mo><mi>s</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">\mu_y=\frac{1}{64} \cdot s2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span><span class="mord mtight">4</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathdefault">s</span><span class="mord">2</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î¼</mi><mi>x</mi></msub><msub><mi>Î¼</mi><mi>y</mi></msub><mo>=</mo><mfrac><mn>1</mn><mrow><mn>64</mn><mo>â‹…</mo><mn>64</mn></mrow></mfrac><mo stretchy="false">(</mo><mi>s</mi><mn>1</mn><mo>â‹…</mo><mi>s</mi><mn>2</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mu_x\mu_y=\frac{1}{64 \cdot 64}(s1 \cdot s2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span><span class="mord mtight">4</span><span class="mbin mtight">â‹…</span><span class="mord mtight">6</span><span class="mord mtight">4</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mord">2</span><span class="mclose">)</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>Î¼</mi><mi>x</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>Î¼</mi><mi>y</mi><mn>2</mn></msubsup><mo>=</mo><mfrac><mn>1</mn><mrow><mn>64</mn><mo>â‹…</mo><mn>64</mn></mrow></mfrac><mo fence="false">(</mo><mo stretchy="false">(</mo><mi>s</mi><mn>1</mn><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>+</mo><mo stretchy="false">(</mo><mi>s</mi><mn>2</mn><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo fence="false">)</mo></mrow><annotation encoding="application/x-tex">\mu_x^2+\mu_y^2=\frac{1}{64 \cdot 64}\big((s1)^2+(s2)^2\big)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.061108em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.197216em;vertical-align:-0.383108em;"></span><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.383108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.20001em;vertical-align:-0.35001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span><span class="mord mtight">4</span><span class="mbin mtight">â‹…</span><span class="mord mtight">6</span><span class="mord mtight">4</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="delimsizing size1">(</span></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mord">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.20001em;vertical-align:-0.35001em;"></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mord">2</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size1">)</span></span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>Ïƒ</mi><mi>x</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>Ïƒ</mi><mi>y</mi><mn>2</mn></msubsup><mo>=</mo><mfrac><mn>1</mn><mrow><mn>64</mn><mo>â‹…</mo><mn>63</mn></mrow></mfrac><mo fence="false">(</mo><mn>64</mn><mo>â‹…</mo><mi>s</mi><mi>s</mi><mo>âˆ’</mo><mo stretchy="false">(</mo><mi>s</mi><mn>1</mn><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>âˆ’</mo><mo stretchy="false">(</mo><mi>s</mi><mn>2</mn><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo fence="false">)</mo></mrow><annotation encoding="application/x-tex">\sigma_x^2+\sigma_y^2=\frac{1}{64 \cdot 63}\big(64 \cdot ss-(s1)^2- (s2)^2\big)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.061108em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.197216em;vertical-align:-0.383108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.383108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.20001em;vertical-align:-0.35001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span><span class="mord mtight">4</span><span class="mbin mtight">â‹…</span><span class="mord mtight">6</span><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="delimsizing size1">(</span></span><span class="mord">6</span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mord">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.20001em;vertical-align:-0.35001em;"></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mord">2</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size1">)</span></span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Ïƒ</mi><mrow><mi>x</mi><mi>y</mi></mrow></msub><mo>=</mo><mfrac><mn>1</mn><mrow><mn>64</mn><mo>â‹…</mo><mn>63</mn></mrow></mfrac><mo stretchy="false">(</mo><mn>64</mn><mo>â‹…</mo><mi>s</mi><mn>12</mn><mo>âˆ’</mo><mi>s</mi><mn>1</mn><mo>â‹…</mo><mi>s</mi><mn>2</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\sigma_{xy}=\frac{1}{64 \cdot 63}(64 \cdot s12 - s1 \cdot s2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span><span class="mord mtight">4</span><span class="mbin mtight">â‹…</span><span class="mord mtight">6</span><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord">6</span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">s</span><span class="mord">1</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathdefault">s</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mord">2</span><span class="mclose">)</span></span></span></span></li>
</ul>
<p>åˆ©ç”¨å¦‚ä¸Šçš„å…¬å¼ï¼ˆå…·ä½“æ¨å¯¼å¯ä»¥å‚è€ƒ<a href="/2020/02/18/the-proof-of-the-SSIM-in-FFmpeg/">ssim_end1()çš„æ¨å¯¼</a>ï¼‰å¯¹<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">SSIM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>çš„å…¬å¼è¿›è¡Œè®¡ç®—å¯ä»¥å¾—åˆ°ï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mo stretchy="false">(</mo><mn>2</mn><msub><mi>Î¼</mi><mi>x</mi></msub><msub><mi>Î¼</mi><mi>y</mi></msub><mo>+</mo><msub><mi>C</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mn>2</mn><msub><mi>Ïƒ</mi><mrow><mi>x</mi><mi>y</mi></mrow></msub><mo>+</mo><msub><mi>C</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><mrow><mo stretchy="false">(</mo><msubsup><mi>Î¼</mi><mi>x</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>Î¼</mi><mi>y</mi><mn>2</mn></msubsup><mo>+</mo><msub><mi>C</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msubsup><mi>Ïƒ</mi><mi>x</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>Ïƒ</mi><mi>y</mi><mn>2</mn></msubsup><mo>+</mo><msub><mi>C</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">SSIM(x,y)=\frac{(2\mu_x\mu_y+C_1)(2\sigma_{xy}+C_2)}{(\mu_x^2+\mu_y^2+C_1)(\sigma_x^2+\sigma_y^2+C_2)}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.496108em;vertical-align:-1.069108em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7401079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.383108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7401079999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.383108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord">2</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.069108em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mfrac><mrow><mo stretchy="false">(</mo><mn>2</mn><mi>s</mi><mn>1</mn><mi>s</mi><mn>2</mn><mo>+</mo><mn>6</mn><msup><mn>4</mn><mn>2</mn></msup><msub><mi>C</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mn>2</mn><mo>â‹…</mo><mn>64</mn><mi>s</mi><mn>12</mn><mo>âˆ’</mo><mn>2</mn><mi>s</mi><mn>1</mn><mi>s</mi><mn>2</mn><mo>+</mo><mn>64</mn><mo>â‹…</mo><mn>63</mn><msub><mi>C</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><mrow><mo stretchy="false">(</mo><mi>s</mi><msup><mn>1</mn><mn>2</mn></msup><mo>+</mo><mi>s</mi><msup><mn>2</mn><mn>2</mn></msup><mo>+</mo><mn>6</mn><msup><mn>4</mn><mn>2</mn></msup><msub><mi>C</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mn>64</mn><mi>s</mi><mi>s</mi><mo>âˆ’</mo><mi>s</mi><msup><mn>1</mn><mn>2</mn></msup><mo>âˆ’</mo><mi>s</mi><msup><mn>2</mn><mn>2</mn></msup><mo>+</mo><mn>64</mn><mo>â‹…</mo><mn>63</mn><msub><mi>C</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">=\frac{(2s1s2+64^2C_1)(2\cdot64s12-2s1s2+64\cdot63C_2)}{(s1^2+s2^2+64^2C_1)(64ss-s1^2-s2^2+64\cdot63C_2)}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.427108em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.491108em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">s</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">6</span><span class="mord"><span class="mord">4</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord">6</span><span class="mord">4</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">s</span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">s</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">6</span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">6</span><span class="mord">3</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">2</span><span class="mord mathdefault">s</span><span class="mord">1</span><span class="mord mathdefault">s</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">6</span><span class="mord"><span class="mord">4</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">6</span><span class="mord">4</span><span class="mord mathdefault">s</span><span class="mord">1</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord mathdefault">s</span><span class="mord">1</span><span class="mord mathdefault">s</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">6</span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">6</span><span class="mord">3</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>FFmpegä¸­ï¼Œå¯¹<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">C_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>å’Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">C_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>çš„å®šä¹‰ä¸­çš„å› å­<strong>64</strong>æˆ–<strong>63</strong>ä¹Ÿæ˜¯æ ¹æ®ä¸Šé¢çš„å…¬å¼ï¼Œä½†æ˜¯ä»å…¬å¼çœ‹ï¼Œ<a href="https://trac.ffmpeg.org/ticket/8529"><strong>FFmpegå¯¹<code>ssim_c1</code>çš„è®¡ç®—å°‘ä¹˜äº†64</strong></a>ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ssim_c1 &#x3D; 0.01 * 0.01 * 255 * 255 * 64 + 0.5</span><br><span class="line">ssim_c2 &#x3D; 0.03 * 0.03 * 255 * 255 * 64 * 63 + 0.5</span><br></pre></td></tr></table></figure>
<p>å½“ç„¶ï¼Œä¸ºäº†ç®€åŒ–å¤„ç†ï¼ŒFFmpegè¿˜åšäº†å¦‚ä¸‹çš„å®šä¹‰ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">vars  &#x3D; ss  * 64 - s1 * s1 - s2 * s2;</span><br><span class="line">covar &#x3D; s12 * 64 - s1 * s2;</span><br></pre></td></tr></table></figure>
<p>å› æ­¤ï¼Œæœ€ç»ˆåœ¨FFmpegä¸­ï¼Œè®¡ç®—<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">SSIM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>çš„å…¬å¼ä¸ºï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mo stretchy="false">(</mo><mn>2</mn><mi>s</mi><mn>1</mn><mi>s</mi><mn>2</mn><mo>+</mo><mi>s</mi><mi>s</mi><mi>i</mi><mi>m</mi><msub><mi>C</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mn>2</mn><mi>c</mi><mi>o</mi><mi>v</mi><mi>a</mi><mi>r</mi><mo>+</mo><mi>s</mi><mi>s</mi><mi>i</mi><mi>m</mi><msub><mi>C</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><mrow><mo stretchy="false">(</mo><mi>s</mi><msup><mn>1</mn><mn>2</mn></msup><mo>+</mo><mi>s</mi><msup><mn>2</mn><mn>2</mn></msup><mo>+</mo><mi>s</mi><mi>s</mi><mi>i</mi><mi>m</mi><msub><mi>C</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>v</mi><mi>a</mi><mi>r</mi><mi>s</mi><mo>+</mo><mi>s</mi><mi>s</mi><mi>i</mi><mi>m</mi><msub><mi>C</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">SSIM(x,y)=\frac{(2s1s2+ssimC_1)(2covar+ssimC_2)}{(s1^2+s2^2+ssimC_1)(vars + ssimC_2)}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">s</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">m</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">m</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">2</span><span class="mord mathdefault">s</span><span class="mord">1</span><span class="mord mathdefault">s</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">m</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord">2</span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">m</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>å¦‚ä¸Šçš„å…¬å¼å°±æ˜¯å‡½æ•°<code>ssim_end1()</code>ä¸­æœ€ç»ˆçš„è®¡ç®—æ–¹å¼ã€‚</p>
<h3 id="åˆ©ç”¨å„å—çš„ssimè®¡ç®—å›¾åƒçš„ssim">åˆ©ç”¨å„å—çš„SSIMè®¡ç®—å›¾åƒçš„SSIM</h3>
<p>è®¡ç®—å®Œæ‰€æœ‰å—çš„<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">SSIM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>ä¹‹åï¼Œå°±å¯ä»¥è®¡ç®—æ‰€æœ‰å—çš„å¹³å‡<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">SSIM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>å¹¶ä½œä¸ºè¯¥å›¾åƒçš„<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">SSIM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>ï¼š</p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mfrac><mi>H</mi><mn>4</mn></mfrac></munderover><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>0</mn></mrow><mrow><mfrac><mi>W</mi><mn>4</mn></mfrac><mo>âˆ’</mo><mn>1</mn></mrow></munderover><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo separator="true">,</mo><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">SSIM(X,Y)= \frac{1}{N}\sum_{i=1}^{\frac{H}{4}}\sum_{j=0}^{\frac{W}{4}-1}{SSIM(x_{ij}, y_{ij})}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.526047em;vertical-align:-1.4137769999999998em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.11227em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.451805em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8720928571428572em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span><span style="top:-3.2255000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.08125em;">H</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.1122700000000005em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.451805em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8720928571428572em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span><span style="top:-3.2255000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">W</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span></p>
<p class="katex-block has-jax"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mo stretchy="false">(</mo><mfrac><mi>H</mi><mn>4</mn></mfrac><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mfrac><mi>W</mi><mn>4</mn></mfrac><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">N=(\frac{H}{4}-1)(\frac{W}{4}-1)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.04633em;vertical-align:-0.686em;"></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.08125em;">H</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.04633em;vertical-align:-0.686em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">W</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span></p>
<h3 id="ç¼–ç è¿‡ç¨‹ä¸­çš„æŠ€å·§">ç¼–ç è¿‡ç¨‹ä¸­çš„æŠ€å·§</h3>
<p>åœ¨FFmpegè®¡ç®—<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">SSIM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>çš„ç®—æ³•å®ç°ä¸­ï¼Œä¸ºäº†æå‡æ•ˆç‡å’ŒæŠ½è±¡ä»£ç é€»è¾‘ï¼Œä¹Ÿåˆ©ç”¨äº†å¾ˆå¤šçš„ç¼–ç¨‹æŠ€å·§ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>è®¡ç®—YUVå„åˆ†é‡å›¾åƒå®½åº¦æ—¶ç”¨<code>w &gt;&gt; !!i</code></li>
<li>ä¸ºäº†é¿å…å¯¹ç¬¬0è¡Œçš„ç‰¹æ®Šå¤„ç†ï¼Œé‡‡ç”¨ä¸¤å±‚å¾ªç¯æ¥å¤„ç†</li>
<li>è®¡ç®—æ¯ä¸€è¡Œçš„å„å—çš„sumsä¿¡æ¯æ—¶ï¼Œä¸ºäº†é™ä½å¾ªç¯æ¬¡æ•°ï¼Œæ¯æ¬¡å¾ªç¯è®¡ç®—2ä¸ªå—çš„sumsç»“æœï¼Œ<code>ssim_4x4x2_core</code>çš„å‡½æ•°åå¯èƒ½å°±æ˜¯è¿™ä¹ˆæ¥çš„ã€‚</li>
<li>è®¡ç®—æ¯ä¸€è¡Œçš„å„å—çš„<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">SSIM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>æ—¶ï¼Œä¸ºäº†é™ä½å¾ªç¯æ¬¡æ•°ï¼Œæ¯æ¬¡å¾ªç¯è®¡ç®—4ä¸ªå—çš„<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>I</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">SSIM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>ï¼Œ<code>ssim_end4</code>çš„å‡½æ•°åå¯èƒ½å°±æ˜¯è¿™ä¹ˆæ¥çš„ã€‚</li>
</ul>
<h2 id="æ„Ÿè°¢">æ„Ÿè°¢</h2>
<p>åˆ†æè¿‡ç¨‹ç¦»ä¸å¼€å’Œè´¤æ°(github: <a href="https://github.com/bodhisatan">@bodhisatan</a>)çš„ä¸æ–­è®¨è®ºå’Œäº¤æµï¼Œæ„Ÿè°¢@è´¤æ°åœ¨ç¹å¿™çš„å·¥ä½œä¹‹ä½™æŠ½å‡ºæ—¶é—´æ¥ä¸€èµ·åˆ†æFFmpegä¸­SSIMç®—æ³•çš„å®ç°åŸç†ã€‚</p>
]]></content>
      <categories>
        <category>IVQA</category>
      </categories>
      <tags>
        <tag>FFmpeg</tag>
        <tag>SSIM</tag>
      </tags>
  </entry>
  <entry>
    <title>è§£å†³hexo-asset-imageçš„å›¾ç‰‡åœ°å€é”™è¯¯é—®é¢˜</title>
    <url>/2020/02/05/handle-the-bug-of-hexo-asset-image-plugin/</url>
    <content><![CDATA[<p>ç”±äº<code>hexo-asset-image</code>æ’ä»¶å­˜åœ¨bugï¼Œä¼šå¯¼è‡´åšæ–‡ä¸­å¼•ç”¨å›¾ç‰‡æ—¶æ— æ³•ç”Ÿæˆæ­£ç¡®çš„é“¾æ¥åœ°å€ï¼Œè¿›è€Œå¯¼è‡´å›¾ç‰‡æ— æ³•è®¿é—®çš„ç°è±¡ã€‚<br>
å…·ä½“è§£å†³æ–¹æ¡ˆä¸ºå°†æ–‡ä»¶<code>node_modules/hexo-asset-image/index.js</code>æ›¿æ¢ä¸ºå¦‚ä¸‹çš„å†…å®¹ï¼š</p>
<span id="more"></span>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"><span class="keyword">var</span> cheerio = <span class="built_in">require</span>(<span class="string">&#x27;cheerio&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// http://stackoverflow.com/questions/14480345/how-to-get-the-nth-occurrence-in-a-string</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getPosition</span>(<span class="params">str, m, i</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> str.split(m, i).join(m).length;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> version = <span class="built_in">String</span>(hexo.version).split(<span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">hexo.extend.filter.register(<span class="string">&#x27;after_post_render&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> config = hexo.config;</span><br><span class="line">  <span class="keyword">if</span>(config.post_asset_folder)&#123;</span><br><span class="line">    	<span class="keyword">var</span> link = data.permalink;</span><br><span class="line">	<span class="keyword">if</span>(version.length &gt; <span class="number">0</span> &amp;&amp; <span class="built_in">Number</span>(version[<span class="number">0</span>]) == <span class="number">3</span>)</span><br><span class="line">	   <span class="keyword">var</span> beginPos = getPosition(link, <span class="string">&#x27;/&#x27;</span>, <span class="number">1</span>) + <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	   <span class="keyword">var</span> beginPos = getPosition(link, <span class="string">&#x27;/&#x27;</span>, <span class="number">3</span>) + <span class="number">1</span>;</span><br><span class="line">	<span class="comment">// In hexo 3.1.1, the permalink of &quot;about&quot; page is like &quot;.../about/index.html&quot;.</span></span><br><span class="line">	<span class="keyword">var</span> endPos = link.lastIndexOf(<span class="string">&#x27;/&#x27;</span>) + <span class="number">1</span>;</span><br><span class="line">    link = link.substring(beginPos, endPos);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> toprocess = [<span class="string">&#x27;excerpt&#x27;</span>, <span class="string">&#x27;more&#x27;</span>, <span class="string">&#x27;content&#x27;</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; toprocess.length; i++)&#123;</span><br><span class="line">      <span class="keyword">var</span> key = toprocess[i];</span><br><span class="line"> </span><br><span class="line">      <span class="keyword">var</span> $ = cheerio.load(data[key], &#123;</span><br><span class="line">        ignoreWhitespace: <span class="literal">false</span>,</span><br><span class="line">        xmlMode: <span class="literal">false</span>,</span><br><span class="line">        lowerCaseTags: <span class="literal">false</span>,</span><br><span class="line">        decodeEntities: <span class="literal">false</span></span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      $(<span class="string">&#x27;img&#x27;</span>).each(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="keyword">if</span> ($(<span class="built_in">this</span>).attr(<span class="string">&#x27;src&#x27;</span>))&#123;</span><br><span class="line">			<span class="comment">// For windows style path, we replace &#x27;\&#x27; to &#x27;/&#x27;.</span></span><br><span class="line">			<span class="keyword">var</span> src = $(<span class="built_in">this</span>).attr(<span class="string">&#x27;src&#x27;</span>).replace(<span class="string">&#x27;\\&#x27;</span>, <span class="string">&#x27;/&#x27;</span>);</span><br><span class="line">			<span class="keyword">if</span>(!<span class="regexp">/http[s]*.*|\/\/.*/</span>.test(src) &amp;&amp;</span><br><span class="line">			   !<span class="regexp">/^\s*\//</span>.test(src)) &#123;</span><br><span class="line">			  <span class="comment">// For &quot;about&quot; page, the first part of &quot;src&quot; can&#x27;t be removed.</span></span><br><span class="line">			  <span class="comment">// In addition, to support multi-level local directory.</span></span><br><span class="line">			  <span class="keyword">var</span> linkArray = link.split(<span class="string">&#x27;/&#x27;</span>).filter(<span class="function"><span class="keyword">function</span>(<span class="params">elem</span>)</span>&#123;</span><br><span class="line">				<span class="keyword">return</span> elem != <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">			  &#125;);</span><br><span class="line">			  <span class="keyword">var</span> srcArray = src.split(<span class="string">&#x27;/&#x27;</span>).filter(<span class="function"><span class="keyword">function</span>(<span class="params">elem</span>)</span>&#123;</span><br><span class="line">				<span class="keyword">return</span> elem != <span class="string">&#x27;&#x27;</span> &amp;&amp; elem != <span class="string">&#x27;.&#x27;</span>;</span><br><span class="line">			  &#125;);</span><br><span class="line">			  <span class="keyword">if</span>(srcArray.length &gt; <span class="number">1</span>)</span><br><span class="line">				srcArray.shift();</span><br><span class="line">			  src = srcArray.join(<span class="string">&#x27;/&#x27;</span>);</span><br><span class="line">			  $(<span class="built_in">this</span>).attr(<span class="string">&#x27;src&#x27;</span>, config.root + link + src);</span><br><span class="line">			  <span class="built_in">console</span>.info&amp;&amp;<span class="built_in">console</span>.info(<span class="string">&quot;update link as:--&gt;&quot;</span>+config.root + link + src);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="built_in">console</span>.info&amp;&amp;<span class="built_in">console</span>.info(<span class="string">&quot;no src attr, skipped...&quot;</span>);</span><br><span class="line">			<span class="built_in">console</span>.info&amp;&amp;<span class="built_in">console</span>.info($(<span class="built_in">this</span>));</span><br><span class="line">		&#125;</span><br><span class="line">      &#125;);</span><br><span class="line">      data[key] = $.html();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>æŠ€æœ¯</category>
      </categories>
      <tags>
        <tag>hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½¿ç”¨hexoå’Œgithubæ­å»ºä¸ªäººåšå®¢</title>
    <url>/2020/02/05/use-hexo-and-github-for-blog/</url>
    <content><![CDATA[<h2 id="åˆ›å»ºgithubä»“åº“">åˆ›å»ºgithubä»“åº“</h2>
<p>é¦–å…ˆæ‰“å¼€<a href="https://github.com/">github</a>ï¼Œç‚¹å‡»<code>New repository</code>ï¼Œåˆ›å»ºä¸€ä¸ªæ–°ä»“åº“ç”¨äºå­˜å‚¨åšå®¢çš„æ‰€æœ‰å†…å®¹ã€‚</p>
<p>ä»“åº“åå¿…é¡»ä¸ºï¼š<code>è´¦æˆ·å.github.io</code>ï¼Œå¹¶ä¸”éœ€è¦å‹¾é€‰<strong>Initialize this repository with a README</strong>ã€‚</p>
<p>åœ¨å»ºå¥½çš„ä»“åº“å³ä¾§æœ‰ä¸ª<strong>settings</strong>æŒ‰é’®ï¼Œç‚¹å‡»<strong>settings</strong>ï¼Œå‘ä¸‹æ»‘åŠ¨åˆ°<strong>GitHub Pages</strong>ï¼Œä¼šå‘ç°æœ‰ä¸ªç½‘å€ï¼Œgithubä¼šæŠŠè¯¥ä»“åº“ä¸­çš„é¡¹ç›®éƒ¨ç½²åˆ°è¯¥ç½‘å€ä¸‹ï¼Œè¯¥ç½‘å€ä¹Ÿæ˜¯åšå®¢çš„é»˜è®¤åœ°å€ã€‚å½“ç„¶ä¹Ÿå¯ä»¥è´­ä¹°åŸŸåï¼Œå°†å…¶æ¢æˆå–œæ¬¢çš„åœ°å€ã€‚</p>
<span id="more"></span>
<p><img src="/2020/02/05/use-hexo-and-github-for-blog/1.jpg" alt></p>
<p><img src="/2020/02/05/use-hexo-and-github-for-blog/2.jpg" alt></p>
<h2 id="å‡†å¤‡node-jsç¯å¢ƒ">å‡†å¤‡node.jsç¯å¢ƒ</h2>
<p>ç”±äºhexoæ˜¯åŸºäº<a href="https://nodejs.org/en/">node.js</a>å¼€å‘çš„ï¼Œå› æ­¤åœ¨å®‰è£…hexoä¹‹å‰ï¼Œéœ€è¦å…ˆå®‰è£…node.jså¹¶é…ç½®å“åº”çš„node.jsç¯å¢ƒã€‚å…·ä½“å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="/2020/02/05/use-hexo-and-github-for-blog/3.jpg" alt></p>
<h2 id="å‡†å¤‡hexoç¯å¢ƒ">å‡†å¤‡hexoç¯å¢ƒ</h2>
<p>æ ¹æ®<a href="https://hexo.io/">hexoå®˜ç½‘</a>çš„æç¤ºï¼Œå®‰è£…hexoã€‚å…·ä½“å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ npm install hexo-cli -g</span><br><span class="line">$ hexo init blog</span><br><span class="line">$ cd blog</span><br><span class="line">$ npm install</span><br><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>æ­¤æ—¶hexoä¼šåœ¨4000ç«¯å£å¯åŠ¨ä¸€ä¸ªwebserverï¼Œç”¨æµè§ˆå™¨è®¿é—®<code>localhost:4000</code>åˆ™ä¼šçœ‹åˆ°åˆå§‹åŒ–ä¹‹åé»˜è®¤çš„ç«™ç‚¹ã€‚</p>
<h2 id="å®‰è£…hexoæ’ä»¶">å®‰è£…hexoæ’ä»¶</h2>
<h3 id="hexo-generator-category">hexo-generator-category</h3>
<p>è¯¥æ’ä»¶ç”¨äºè‡ªåŠ¨ç”Ÿæˆcategoryï¼Œå…·ä½“å®‰è£…æ–¹å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ npm install hexo-generator-category --save</span><br><span class="line">$ hexo new page categories</span><br></pre></td></tr></table></figure>
<p>ç„¶åä¿®æ”¹<code>source/categories/index.md</code>çš„å†…å®¹ä¸ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: categories</span><br><span class="line">date: 2020-02-05 11:53:35</span><br><span class="line">type: &quot;categories&quot;</span><br><span class="line">layout: &quot;categories&quot;</span><br><span class="line">comments: false</span><br><span class="line">---</span><br></pre></td></tr></table></figure>
<h3 id="hexo-generator-tag">hexo-generator-tag</h3>
<p>è¯¥æ’ä»¶ç”¨äºè‡ªåŠ¨ç”Ÿæˆtagsï¼Œå…·ä½“å®‰è£…æ–¹å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ npm install hexo-generator-tag --save</span><br><span class="line">$ hexo new page tags</span><br></pre></td></tr></table></figure>
<p>ç„¶åä¿®æ”¹<code>source/tags/index.md</code>çš„å†…å®¹ä¸ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: tags</span><br><span class="line">date: 2020-02-05 11:53:58</span><br><span class="line">type: &quot;tags&quot;</span><br><span class="line">layout: &quot;tags&quot;</span><br><span class="line">comments: false</span><br><span class="line">---</span><br></pre></td></tr></table></figure>
<h3 id="hexo-asset-image">hexo-asset-image</h3>
<p>è¯¥æ’ä»¶ä¸»è¦ç”¨äºè§£å†³åœ¨æ–‡ç« ä¸­å¼•ç”¨å›¾ç‰‡çš„åœºæ™¯ï¼Œå…·ä½“å®‰è£…æ–¹å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ npm install hexo-asset-image --save</span><br></pre></td></tr></table></figure>
<p>å®‰è£…è¯¥æ’ä»¶åï¼Œåˆ©ç”¨<code>hexo new post 'test'</code>ç”Ÿæˆæ–°æ–‡ç« å†…å®¹æ—¶ï¼Œä¼šåœ¨<code>source/_posts</code>ç›®å½•ä¸‹åŒæ—¶ç”Ÿæˆ<code>test.md</code>å’Œ<code>testç›®å½•</code>ï¼Œ<code>test.md</code>ä¸­éœ€è¦çš„å›¾ç‰‡å¯ä»¥å­˜å‚¨åœ¨<code>testç›®å½•</code>ä¸‹ã€‚åœ¨æ–‡æ¡£ä¸­ï¼Œé‡‡ç”¨å¦‚ä¸‹çš„æ–¹å¼æ¥å¼•ç”¨å›¾ç‰‡ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">![å›¾ç‰‡çš„æè¿°ä¿¡æ¯](1.jpg)</span><br></pre></td></tr></table></figure>
<p>å…³äºhexo-asset-imageç”Ÿæˆå›¾ç‰‡çš„bugï¼Œå¯ä»¥å‚è€ƒæ–‡ç« ï¼š<a href="/2020/02/05/handle-the-bug-of-hexo-asset-image-plugin/">è§£å†³hexo-asset-imageçš„å›¾ç‰‡åœ°å€é”™è¯¯é—®é¢˜</a></p>
<h3 id="hexo-deployer-git">hexo-deployer-git</h3>
<p>è¯¥æ’ä»¶ç”¨äºå°†ç¼–è¯‘åç”Ÿæˆçš„ç«™ç‚¹å†…å®¹å‘å¸ƒåˆ°ç¬¬ä¸€æ­¥åˆ›å»ºçš„githubä»“åº“ä¸­ï¼Œä»è€Œå®ç°å†…å®¹æ›´æ–°ã€‚å…·ä½“å®‰è£…æ–¹å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ npm add hexo-deployer-git</span><br></pre></td></tr></table></figure>
<p>ç„¶åé…ç½®_config.ymlä¸­çš„<code>url</code>å’Œ<code>deploy</code>é…ç½®ï¼Œä»¥ä¾¿å¯ä»¥é€šè¿‡è¯¥æ’ä»¶è‡ªåŠ¨éƒ¨ç½²é¡¹ç›®ã€‚å…·ä½“é…ç½®å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">url:</span> <span class="string">https://wangwei1237.github.io/</span></span><br><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">https://github.com/wangwei1237/wangwei1237.github.io</span></span><br></pre></td></tr></table></figure>
<p>é…ç½®å®Œæ¯•ä¹‹åï¼Œå¦‚æœé¡¹ç›®å†…å®¹å‘ç”Ÿä¿®æ”¹ï¼Œåˆ™åˆ©ç”¨å¦‚ä¸‹çš„å‘½ä»¤å°±å¯ä»¥å®Œæˆè‡ªåŠ¨å‘å¸ƒï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ hexo clean</span><br><span class="line">$ hexo generate</span><br><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>æŠ€æœ¯</category>
      </categories>
      <tags>
        <tag>hexo</tag>
        <tag>github</tag>
        <tag>å»ºç«™</tag>
      </tags>
  </entry>
  <entry>
    <title>å‡¡æ‰€è¿‡å¾€ï¼Œçš†æ˜¯åºç« </title>
    <url>/2020/02/05/where-of-what-is-past-is-prologue/</url>
    <content><![CDATA[<p>å‡¡æ‰€è¿‡å¾€ï¼Œçš†æ˜¯åºç« ï¼Œæ–°çš„ä¸€å¹´ï¼Œç”¨4ä¸ªå…³é”®è¯æ¥è®²ä¸€è®²2019å¹´è‡ªå·±å¿ƒä¸­çš„è¿‡å¾€å’Œåºç« ã€‚</p>
<p><img src="/2020/02/05/where-of-what-is-past-is-prologue/1.jpg" alt></p>
<span id="more"></span>
<h2 id="å˜åŒ–">å˜åŒ–</h2>
<p>å¦‚æœè¦ç”¨1ä¸ªè¯æ¥å½¢å®¹2019å¹´çš„è¯ï¼Œæˆ‘è§‰å¾—å°±æ˜¯ å˜åŒ–äº†ã€‚æ— è®ºå†…éƒ¨ï¼Œè¿˜æ˜¯å¤–éƒ¨ï¼Œéƒ½åœ¨å‘ç”Ÿç€ç¿»å¤©è¦†åœ°çš„å˜åŒ–ã€‚å˜åŒ–è¿™ç§æ»‹å‘³èµ·åˆå¾ˆç—›è‹¦ï¼Œä½†æ˜¯å´è•´å«ç€æ— é™çš„æœºä¼šã€‚</p>
<p>æœªæ¥ï¼Œå˜åŒ–ä¼šæ˜¯å¸¸æ€ã€‚å·¥ä½œæ–¹å¼è¦å˜ï¼Œå·¥å…·å¹³å°è¦å˜ï¼Œå¼€å‘è¯­è¨€è¦å˜â€¦â€¦æ‰€æœ‰çš„äº‹æƒ…éƒ½åœ¨å‘ç€å¥½çš„æ–¹å‘å˜åŒ–ã€å‘å±•ã€‚</p>
<p>åœ¨è¿™ä¸ªå˜åŒ–çš„è¿‡ç¨‹ä¸­ï¼Œä¸èƒ½éšæ³¢é€æµï¼Œä¹Ÿä¸èƒ½å›ºå®ˆå·±è§ã€‚éœ€è¦é¡ºåº”å˜åŒ–ï¼Œæ‰¾åˆ°å…¶ä¸­çš„æœºä¼šï¼Œé¡ºåŠ¿è€Œä¸ºï¼Œä¹˜é£è€Œèµ·ã€‚</p>
<h2 id="å­¦ä¹ ">å­¦ä¹ </h2>
<p>åœ¨å¿«é€Ÿçš„å˜åŒ–ä¸­ï¼Œæ€ä¹ˆæ‰èƒ½ä¹˜é£è€Œèµ·ï¼Ÿç§˜è¯€ä¹Ÿå°±æ˜¯ å­¦ä¹ äº†ã€‚</p>
<p>2019å¹´ï¼Œæˆ‘å­¦ä¹ äº†openglï¼Œkotlinï¼›</p>
<p>2019å¹´ï¼Œå­¦ä¹ äº†æ•°å­—è§†é¢‘ï¼Œffmpegï¼Œopencvï¼›</p>
<p>2019å¹´ï¼Œå­¦ä¹ äº†Androidçš„ç›¸æœºç³»ç»Ÿï¼Œå­¦ä¹ äº†é€†å‘ç ´è§£ï¼›</p>
<p>2019å¹´ï¼Œå­¦ä¹ äº†å¦‚ä½•å†™ä½œï¼Œå­¦ä¹ äº†å¦‚ä½•æ¼”è®²ï¼Œå­¦ä¹ äº†å¦‚ä½•ç³»ç»ŸåŒ–æ€è€ƒâ€¦â€¦</p>
<p>åœ¨å­¦æ ¡çš„æ—¶å€™ï¼Œä¸ºäº†å·¥ä½œè€Œå­¦ä¹ ã€‚ç°åœ¨æˆ–è€…æœªæ¥ï¼Œè¦ä¸ºäº†å­¦ä¹ è€Œå·¥ä½œï¼Œä¸æ–­å­¦ä¹ æ–°çš„æŠ€èƒ½ã€‚</p>
<p>å­¦ä¹ æ˜¯åº”å¯¹å„ç§å˜åŒ–çš„ä¸äºŒæ³•é—¨ã€‚å­¦ä¹ ï¼Œåœ¨è·¯ä¸Šâ€¦â€¦</p>
<h2 id="åˆ›æ–°">åˆ›æ–°</h2>
<p>åˆ›æ–°è¿™ä¸ªè¯å‘¢ï¼Œæ€»ä¼šå’Œ é€ è½®å­è¿™ä¸ªè¯å…³è”èµ·æ¥ã€‚</p>
<p>2019å¹´ï¼Œ é€ è½®å­è¿™ä¸ªè¯å¾ˆé¢‘ç¹ï¼Œé¢‘ç¹çš„æœ‰ç‚¹ä»¤æˆ‘ä¸çŸ¥æ‰€æªã€‚å®é™…ä¸Šï¼Œæˆ‘ä¸ªäººä¸åå¯¹é€ è½®å­ï¼Œä½†æ˜¯åå¯¹ ä¸ºäº†é€ è½®å­è€Œé€ è½®å­ã€‚æ¯ç§æŠ€æœ¯éƒ½æœ‰ä»–çš„èƒ½åŠ›è¾¹ç•Œï¼Œåœ¨ é€ è½®å­çš„æ—¶å€™ï¼Œè¦é¦–å…ˆè¯†åˆ«åˆ°èƒ½åŠ›çš„è¾¹ç•Œï¼Œç„¶åæ‰¾åˆ°ä¸€ç§å¿«é€Ÿæœ‰æ•ˆçš„æ–¹å¼æ¥è§£å†³æˆ‘ä»¬çš„é—®é¢˜ï¼Œè¿™æ‰æ˜¯åˆ›æ–°ã€‚</p>
<p>æŠ€æœ¯çš„è¿›æ­¥å°±æ˜¯ä¸€ä¸ªé€ è½®å­çš„è¿‡ç¨‹ã€‚ä¸ºä»€ä¹ˆæœ‰äº†c++è¿˜ä¼šæœ‰javaï¼Œæœ‰äº†javaè¿˜ä¼šæœ‰kotlinï¼Ÿä¸ºä»€ä¹ˆæœ‰äº†è‹¹æœè¿˜ä¼šæœ‰å®‰å“ï¼Ÿä¸ºä»€ä¹ˆæœ‰äº†å¿«æ‰‹è¿˜ä¼šæœ‰æŠ–éŸ³ï¼Ÿâ€¦â€¦</p>
<p>æœªæ¥ï¼Œåœ¨åˆ›æ–°çš„è·¯ä¸Šï¼Œéœ€è¦æ›´å¤šçš„è·µè¡Œwork smarter not work harderã€‚</p>
<p><img src="/2020/02/05/where-of-what-is-past-is-prologue/2.jpg" alt></p>
<h2 id="çªç ´">çªç ´</h2>
<p>æ¯«æ— ç–‘é—®ï¼Œæœªæ¥è‚¯å®šæ˜¯æ–°äººçš„å¤©ä¸‹ã€‚</p>
<p>æœªæ¥éœ€è¦æ›´å¤šçš„æƒ³ï¼Œæ€ä¹ˆèƒ½å¤Ÿè®©æ–°äººå¯ä»¥ç«™åœ¨å·¨äººçš„è‚©è†€ä¸Šæˆé•¿ï¼›ä¹Ÿè¦æ›´å¤šçš„æƒ³ï¼Œæ€ä»¬æ ·æ‰èƒ½å¤Ÿè®©è‡ªå·±æˆä¸ºäººè€å¿ƒä¸è€çš„è€æ–°äººã€‚</p>
<p>å·¥ä½œä¸­ï¼Œæ›´æ— é¡»ç»™è‡ªå·±è®¾é™ï¼Œè¿™ä¸ªæˆ‘å¯èƒ½ä¸è¡Œå‘¢ï¼Œé‚£ä¸ªæˆ‘å¯èƒ½ä¹Ÿæä¸å®šå‘€ï¼Œè¿™ä¸ªæˆ‘æ²¡æ¥è§¦è¿‡å‘€ï¼Œé‚£ä¸ªæˆ‘æ²¡å­¦è¿‡å‘€ã€‚æ€•ä»€ä¹ˆå‘¢ï¼Œä¸è¯•è¯•æ€ä»¬çŸ¥é“ä¸è¡Œï¼Œä¸æä¸€ææ€ä¹ˆçŸ¥é“æä¸å®šï¼Œæ²¡æ¥è§¦è¿‡å°±æ¥è§¦å˜›ï¼Œæ²¡å­¦è¿‡å°±å­¦èµ·æ¥å˜›ï¼Œæ²¡æœ‰ä»€ä¹ˆå¤§ä¸äº†çš„ã€‚</p>
<p>å·¥ç¨‹å¸ˆä¸å°±æ˜¯è¦é€¢å±±å¼€è·¯é‡æ°´æ­æ¡¥å—ï¼Ÿè¦åšä¿¡ï¼Œåœ¨æˆ‘ä»¬å¯ä»¥æƒ³è±¡çš„èŒƒå›´å†…ï¼Œæ²¡æœ‰æŠ€æœ¯è§£å†³ä¸äº†çš„é—®é¢˜ã€‚</p>
<p>å†²ç ´ç‰¢ç¬¼ï¼Œæ–¹å¾—å§‹ç»ˆã€‚</p>
<p>åŠ å‹’æ¯”æµ·ç›—ä¸­æœ‰ä¸ªæ¡¥æ®µï¼š</p>
<blockquote>
<p>èˆ¹é•¿ï¼šæ‰¬å¸†ï¼èµ·èˆªï¼<br>
æ°´æ‰‹ï¼šä»€ä¹ˆæ–¹å‘ï¼Ÿ<br>
èˆ¹é•¿ï¼šæµ·ç›—éœ€è¦ä»€ä¹ˆæ–¹å‘ï¼Ÿèµ·èˆªï¼</p>
</blockquote>
<p>2020ï¼Œæ‰¬å¸†ï¼Œèµ·èˆªï¼ä¹˜ç€æ¢¦æƒ³ä¹‹é£ï¼Œå‘ç€æ˜Ÿå…‰çš„æ–¹å‘ï¼Œæ‰¾åˆ°æœ€å¥½çš„è‡ªå·±ã€‚</p>
]]></content>
      <categories>
        <category>æ€»ç»“</category>
      </categories>
      <tags>
        <tag>æµ‹è¯•å·¥ä½œ</tag>
      </tags>
  </entry>
  <entry>
    <title>å¯¹QAçš„æ€è€ƒâ€”â€”æˆ‘çš„è¿™äº›å¹´</title>
    <url>/2020/02/05/thinking-about-QA-my-years-for-work-as-a-QA/</url>
    <content><![CDATA[<p>2012å¹´æ¯•ä¸šåæ€€ç€ä¸€é¢—å¿å¿‘çš„å¿ƒå¼€å§‹äº†æµ‹è¯•å·¥ä½œçš„èŒä¸šç”Ÿæ¶¯ï¼Œåˆ°ç°åœ¨ä¹Ÿæœ‰7å¹´å•¦ã€‚ç»å†è¿‡å¥‹æ–—å’Œæ¿€æƒ…ï¼Œä¹Ÿç»å†è¿‡å¾˜å¾Šå’Œè¿·èŒ«ï¼Œå‹¤æ³å´ä¸åº¸ç¢Œã€‚è™½ç„¶å¯¹æµ‹è¯•ä¹Ÿæœ‰æ‹…å¿§ï¼Œä½†æ˜¯å¯¹è¿™ä¸ªè¡Œä¸šå§‹ç»ˆä¿æŒç€ä¸€ç§æ¿€æƒ…ã€‚</p>
<p>æ¥ä¸‹æ¥ç»“åˆè‡ªå·±çš„å·¥ä½œè°ˆä¸€ä¸‹å¯¹æµ‹è¯•çš„ä¸€äº›æ€è€ƒï¼Œä¹Ÿå›é¡¾ä¸‹è‡ªå·±è¿‡å»çš„æµ‹è¯•å·¥ä½œä¸­éµå¾ªçš„ä¸€äº›å·¥ä½œåŸåˆ™ã€‚</p>
<p><img src="/2020/02/05/thinking-about-QA-my-years-for-work-as-a-QA/1.jpg" alt></p>
<span id="more"></span>
<h2 id="åŸåˆ™1ï¼šæ­£ç¡®çš„è®¤è¯†è‡ªå·±">åŸåˆ™1ï¼šæ­£ç¡®çš„è®¤è¯†è‡ªå·±</h2>
<p>å¥½å¤šäººï¼Œè‡ªè§†ç”šé«˜ï¼Œå‚²è§†ä¸€åˆ‡ã€‚ä½†æ˜¯ï¼Œå®é™…ä¸Šï¼Œç‰›äººå¾ˆå¤šã€‚æˆ‘ä»¬èƒ½åšæˆä¸€ä»¶äº‹æƒ…ï¼Œèƒ½åŠ›æ˜¯ä¸€ä¸ªæ–¹é¢ï¼Œä½†èƒ½åŠ›ç»å¯¹ä¸æ˜¯å…¨éƒ¨å› ç´ ã€‚æ²¡æœ‰ä¸Šçº§çš„æ”¯æŒï¼Œæ²¡æœ‰åŒäº‹çš„åä½œå’Œé…åˆï¼Œæ²¡æœ‰å…¬å¸æä¾›çš„èµ„æºï¼Œæˆ‘ä»¬æ˜¯ä»€ä¹ˆäº‹æƒ…ä¹Ÿåšä¸æˆçš„ã€‚ä¸èƒ½å› ä¸ºè‡ªå·±çš„å·¥ä½œæ—¶é—´é•¿ï¼Œå¯¹ä¸šåŠ¡äº†è§£çš„æ·±ï¼Œå°±å¯¹åˆ«äººæ¨ªåŠ æŒ‡è´£ï¼Œä¹Ÿä¸èƒ½å› ä¸ºè‡ªå·±èŒç§°é«˜å°±ç»™åˆ«äººä»¥å‹åŠ›ã€‚</p>
<p><img src="/2020/02/05/thinking-about-QA-my-years-for-work-as-a-QA/2.png" alt></p>
<h2 id="åŸåˆ™2ï¼šå…ˆæˆå°±åˆ«äºº-å†æˆå°±è‡ªå·±">åŸåˆ™2ï¼šå…ˆæˆå°±åˆ«äººï¼Œå†æˆå°±è‡ªå·±</h2>
<p>æˆ‘ä»¬ç»å¸¸é—®QAçš„ä»·å€¼æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p>å®é™…ä¸Šæœ‰äº›ä¸œè¥¿æ˜¯å¾ˆéš¾è®²æ¸…æ¥šçš„ã€‚å¥½å¤šQAä¸ºäº†è¯æ˜è‡ªå·±çš„æŠ€æœ¯èƒ½åŠ›ã€æŠ€æœ¯ä»·å€¼ï¼Œåšäº†å¾ˆå¤šçœ‹ä¼¼é«˜è¶…ï¼Œä½†æ˜¯å®é™…ä¸Šå¯¹ä¸šåŠ¡å¿«é€Ÿè¿­ä»£å¹¶æ²¡æœ‰ç”¨çš„äº‹æƒ…ã€‚</p>
<p>æˆ‘æ€»è§‰å¾—ï¼Œè‡ªå·±çš„ä»·å€¼ä¸æ˜¯ç”±è‡ªå·±ä½“ç°çš„ï¼Œè€Œæ˜¯ç”±åˆ«äººæ¥ä½“ç°çš„ã€‚åªæœ‰å…ˆæˆå°±åˆ«äººï¼Œæ‰èƒ½æœ€ç»ˆæˆå°±è‡ªå·±ã€‚è¿™å°±æ˜¯æˆ‘å·¥ä½œä»¥æ¥ä¸€ç›´éµå¾ªçš„ä¸€ä¸ªå·¥ä½œåŸåˆ™ã€‚ä¸äº‰ï¼Œä¸æŠ¢ï¼Œè®¤çœŸåšäº‹ï¼Œè®¤çœŸå¸®åˆ«äººåšäº‹ï¼Œè®¤çœŸçš„å¸®ä¸šåŠ¡åšäº‹æƒ…ï¼Œå¸®åŠ©RDåˆ†æçº¿ä¸Šé—®é¢˜ï¼Œè§£å†³BUGã€‚åˆ°äº†åæ¥ï¼Œä¹Ÿé¢‡æœ‰ç‚¹ï¼šæ¡ƒæä¸è¨€ï¼Œä¸‹è‡ªæˆè¹Šçš„å‘³é“ã€‚</p>
<p>å¥½å¤šäººä¹Ÿä¼šè¯´ï¼Œåœ¨è¿™ä¸ªæ—¶ä»£ï¼Œé…’é¦™ä¹Ÿæ€•å··å­æ·±ã€‚å¦‚æœä¸ä¸»åŠ¨å®£ä¼ è‡ªå·±çš„ä»·å€¼ï¼Œå®£ä¼ è‡ªå·±çš„å½±å“åŠ›ï¼Œåˆ«äººæ˜¯ä¸ä¼šçŸ¥é“çš„ã€‚ä½†æ˜¯ï¼Œå®é™…ä¸Šï¼Œå½±å“åŠ›å’Œä»·å€¼æ˜¯ç”±åˆ«äººæ¥è¯„ä¼°çš„ï¼Œå†å²äº¤ç”±åäººè¯„å°±æ˜¯è¿™ä¸ªé“ç†ã€‚å¹¶ä¸”ï¼Œå½±å“åŠ›æ˜¯å¤„äºæŸä¸ªåœˆå±‚çš„ï¼Œå¹¶é€šè¿‡åœˆå±‚è€Œæ‰©æ•£ã€‚æˆ‘ä»¬é¦–å…ˆåœ¨å›¢é˜Ÿçš„åœˆå±‚å†…åšåˆ°å½±å“åŠ›ï¼Œæ‰æœ‰å¯èƒ½é€šè¿‡åœˆå±‚çš„æ‰©æ•£è€Œæ‰©æ•£è‡ªå·±çš„ä»·å€¼ã€‚</p>
<p><img src="/2020/02/05/thinking-about-QA-my-years-for-work-as-a-QA/3.jpg" alt></p>
<h2 id="åŸåˆ™3ï¼šæ–¹ä¾¿åˆ«äºº-æ–¹ä¾¿è‡ªå·±">åŸåˆ™3ï¼šæ–¹ä¾¿åˆ«äººï¼Œæ–¹ä¾¿è‡ªå·±</h2>
<p>åšæµ‹è¯•çš„åŒå­¦ï¼Œæ¯å¤©ä¼šå†™å¾ˆå¤šæµ‹è¯•caseï¼Œæ¯å¤©ä¹Ÿä¼šå‘å¾ˆå¤šæµ‹è¯•æŠ¥å‘Šï¼Œä½†æ˜¯å¦‚æœæ‰“å¼€è¿™äº›é‚®ä»¶ï¼Œç»å¸¸å‘ç°è¿™äº›caseå¾ˆéš¾è®©äººç†è§£ï¼Œè¿™äº›æµ‹è¯•æŠ¥å‘Šè™½ç„¶ç¯‡å¹…å¾ˆå¤§ï¼Œä½†æ˜¯å¦‚æœè¦ä»ä¸­æ‰¾åˆ°æ¥ä¸‹æ¥RDè¦åšä»€ä¹ˆï¼Œè¿˜æ˜¯è¦èŠ±è´¹ä¸€ç‚¹æ—¶é—´çš„ã€‚</p>
<p>åœ¨æµ‹è¯•å·¥ä½œè¿‡ç¨‹ä¸­ï¼Œæ— è®ºæ˜¯æµ‹è¯•æŠ¥å‘Šï¼Œè¿˜æ˜¯é£é™©é€šæŠ¥ï¼Œé¦–å…ˆè¦äº†è§£åˆ°è¿™äº›å†…å®¹çš„æ¥æ”¶è€…åˆ°åº•æ˜¯è°ï¼Œç„¶åéœ€è¦æ€è€ƒï¼Œè¦ä»¥ä»€ä¹ˆæ ·çš„æè¿°å’Œç»„ç»‡æ‰èƒ½æ–¹ä¾¿å¯¹æ–¹å¿«é€Ÿäº†è§£åˆ°å†…å®¹çš„å«ä¹‰ï¼Œä¹Ÿå°±æ˜¯è¦åšåˆ°ï¼šåˆ°ä»€ä¹ˆå±±å¤´ï¼Œå”±ä»€ä¹ˆæ­Œã€‚</p>
<p>æˆ‘åˆšå…¥èŒçš„æ—¶å€™ï¼Œå› ä¸ºä¹‹å‰æ²¡æœ‰åšè¿‡æµ‹è¯•ï¼Œä¹Ÿä¸çŸ¥é“æµ‹è¯•æŠ¥å‘Šè¦ä»¥ä»€ä¹ˆæ ·çš„æ ¼å¼æ¥å‘ï¼Œæ‰€ä»¥å¾ˆå®³æ€•å‘æµ‹è¯•æŠ¥å‘Šã€‚è™½ç„¶å­¦ä¹ äº†å…¶ä»–å‰è¾ˆçš„æµ‹è¯•æŠ¥å‘Šå’Œå‰è¾ˆä»¬çš„æµ‹è¯•æŠ¥å‘ŠèŒƒå¼ï¼Œä½†æ˜¯æ€»æ„Ÿè§‰è¿˜æ˜¯å®³æ€•ã€‚å› ä¸ºï¼Œä»RDçš„è§’åº¦æ¥çœ‹ï¼Œé˜…è¯»é‚£äº›æµ‹è¯•æŠ¥å‘Šçš„æˆæœ¬è¿˜æ˜¯å¾ˆå¤§çš„ã€‚</p>
<p>ç„¶åï¼Œæˆ‘ç«™åœ¨RDçš„è§’åº¦ä¸Šæƒ³ï¼Œæ€ä¹ˆç»„ç»‡æµ‹è¯•æŠ¥å‘Šï¼Œæ‰èƒ½è®©RDä¸€çœ¼å°±çŸ¥é“è‡ªå·±æ¥ä¸‹æ¥è¦åšä»€ä¹ˆå‘¢ï¼Ÿç„¶åæˆ‘é‡æ–°ç»„ç»‡äº†ä¹‹å‰æµ‹æµ‹è¯•æŠ¥å‘Šï¼Œåœ¨æŠ¥å‘Šçš„æœ€å¼€å§‹ç”¨1å¥è¯æ¦‚æ‹¬é¡¹ç›®çš„æµ‹è¯•ç»“è®ºï¼šè¯¥é¡¹ç›®æµ‹è¯•æ˜¯å¦é€šè¿‡ï¼ŒåŸå› æ˜¯ä»€ä¹ˆï¼Ÿå…·ä½“çš„BUGé‡æ˜¯å¤šå°‘ï¼Ÿç„¶åæ¥ä¸‹æ¥æ˜¯è¯¦ç»†çš„æµ‹è¯•æ¸…å•ï¼Œæ¸…å•ä¸­æ˜ç¡®è¡¨æ˜æ¯ä¸€ä¸ªcaseçš„æµ‹è¯•ç‚¹ï¼Œå‰ç½®ï¼Œé¢„æœŸç»“æœï¼Œå®é™…æµ‹è¯•ç»“æœï¼Œæ˜¯å¦é€šè¿‡ç­‰ä¿¡æ¯ã€‚å¯¹äºæµ‹è¯•é€šè¿‡çš„caseï¼Œç”¨ç»¿è‰²æ¥æ ‡æ³¨ï¼›å¯¹äºæµ‹è¯•å¤±è´¥çš„caseï¼Œç”¨çº¢è‰²æ ‡æ³¨ï¼›å¯¹äºæœ‰ç–‘é—®çš„caseï¼Œæ¯”å¦‚å»ºè®®ç­‰ï¼Œç”¨é»„è‰²æ ‡æ³¨ã€‚RDæ”¶åˆ°æµ‹è¯•æŠ¥å‘Šä¹‹åï¼Œå…ˆçœ‹ç»“è®ºï¼Œç„¶åçœ‹éç»¿è‰²çš„æµ‹è¯•caseä¿®å¤BUGã€‚</p>
<h2 id="åŸåˆ™4ï¼šæ¶ˆé™¤é—¨æ§›-è€Œä¸æ˜¯æå‡é—¨æ§›">åŸåˆ™4ï¼šæ¶ˆé™¤é—¨æ§›ï¼Œè€Œä¸æ˜¯æå‡é—¨æ§›</h2>
<p>å¤§ç¦¹æ²»æ°´ä¹‹æ‰€ä»¥æˆåŠŸï¼Œæœ€é‡è¦çš„æ€æƒ³å°±æ˜¯ï¼šæ”¹â€œå µâ€ä¸ºâ€œç–â€ã€‚</p>
<p>ä½†æ˜¯çœŸæ­£çš„æµ‹è¯•è¿‡ç¨‹ä¸­ï¼Œç»å¸¸ä¼šå‘ç°å¦‚ä¸‹çš„ç°è±¡ï¼šé¢†å¯¼è´¨ç–‘QAçš„æµ‹è¯•æ—¶é—´å¤ªé•¿ï¼ŒQAè´¨ç–‘RDçš„ææµ‹è´¨é‡å¤ªå·®ï¼Œç„¶åQAå¢åŠ äº†å‡†å…¥æ‰“å›çš„æµç¨‹ï¼Œå¯¹äºRDææµ‹çš„ã€æ²¡æœ‰é€šè¿‡å‡†å…¥çš„é¡¹ç›®ä¸äºˆæµ‹è¯•ã€‚</p>
<p>å®é™…ä¸Šï¼Œè¿™ç§ç°è±¡å°±æ˜¯QAåœ¨é¡¹ç›®çš„æµ‹è¯•ç¯èŠ‚è®¾ç½®äº†ä¸€ä¸ªé—¨æ§›ï¼Œè€Œå¦‚æœè¿™ç§é—¨æ§›è®¾ç½®çš„è¶Šæ¥è¶Šå¤šï¼Œé‚£ä¹ˆå¯¹äºä¸šåŠ¡è€Œè¨€ä¹Ÿä¼šå‘ç”Ÿâ€œæ´ªæ¶ç¾å®³â€ã€‚å•ä»æµ‹è¯•å›¢é˜Ÿçš„è§’åº¦çœ‹ï¼Œç¡®å®å¢åŠ è¿™ä¸ªé—¨æ§›ï¼Œæµ‹è¯•æ•ˆç‡æå‡äº†ï¼Œæµ‹è¯•æ—¶é—´é™ä½äº†ï¼Œä½†æ˜¯å¦‚æœä»æ•´ä¸ªä¸šåŠ¡çš„è¿­ä»£æ¥çœ‹ï¼Œæ•ˆç‡å¹¶æ²¡æœ‰æå‡ã€‚</p>
<p>æˆ‘ä»¬æäº†é—¨æ§›ï¼Œå‘äº†å‡†å…¥caseï¼Œå¢åŠ äº†æµç¨‹ï¼Œè¿™ä¸€ç‚¹ä¹Ÿä¸èƒ½è¯´ä¸å¥½ã€‚ä½†æ˜¯æˆ‘ä»¬æœ‰æ²¡æœ‰æƒ³è¿‡ï¼šè¿™äº›å‡†å…¥caseåˆ«äººçœ‹çš„æ‡‚å—ï¼Ÿæˆ‘ä»¬æ€ä¹ˆè®¾è®¡caseèƒ½å¤Ÿä½¿å¾—RDè‡ªæµ‹çš„æ—¶å€™æ›´åŠ æ–¹ä¾¿å‘¢ï¼Ÿå³ä¾¿çœ‹æ‡‚äº†ï¼Œæˆ‘ä»¬æ€ä¹ˆä¿è¯RDç¡®å®æ‰§è¡Œäº†å‘¢ï¼Ÿæˆ‘ä»¬æ€ä¹ˆä¿è¯å¢åŠ çš„è¿™ä¸ªæµç¨‹æ¯æ¬¡éƒ½è´¯å½»è½å®äº†å‘¢ï¼Ÿ</p>
<p>QAä¸åº”è¯¥æ˜¯ä¸€ä¸ªé—¨æ§›è®¾ç½®è€…ï¼Œè€Œåº”è¯¥æ˜¯ä¸€ç§æœ‰æ•ˆçš„æ­¦å™¨ã€‚ä¸èƒ½ç”¨çœ‹ä¼¼åˆç†çš„å„ç§æ ‡å‡†å’Œè¦æ±‚å¡ä½äº‹æƒ…ï¼Œè€Œåº”è¯¥æˆä¸ºå¸®åŠ©å›¢é˜Ÿè§£å†³é—®é¢˜çš„ç§˜å¯†æ­¦å™¨ã€‚</p>
<p>QAä¸èƒ½åªæŠ¥é—®é¢˜ï¼Œåªè¯´ç°è±¡ï¼Œåªè¯´RDä¸é è°±ï¼Œä¸Šçº¿ä¸æ£€æŸ¥ã€‚QAéœ€è¦æ€è€ƒï¼š</p>
<ul>
<li>æˆ‘ä»¬èƒ½ä¸ºå¿«é€Ÿè¿­ä»£åšäº›ä»€ä¹ˆï¼Ÿ</li>
<li>æˆ‘ä»¬èƒ½åšäº›ä»€ä¹ˆå¯ä»¥å¸®åŠ©RDå¿«é€Ÿå‘ç°è‡ªå·±çš„ä»£ç é—®é¢˜ï¼Ÿ</li>
<li>æˆ‘ä»¬èƒ½åšä»€ä¹ˆå¯ä»¥å¸®åŠ©RDå¿«é€Ÿå‘ç°ä¸Šçº¿è¿‡ç¨‹å¼‚å¸¸äº†ï¼Ÿ</li>
</ul>
<h2 id="åŸåˆ™5ï¼šä¸æ–­å­¦ä¹ -ä¸åšä¼ªå­¦ä¹ è€…">åŸåˆ™5ï¼šä¸æ–­å­¦ä¹ ï¼Œä¸åšä¼ªå­¦ä¹ è€…</h2>
<p>ç°åœ¨ï¼ŒæŠ€æœ¯æ›´æ–°æ¢ä»£çš„é¢‘ç‡å¾ˆå¿«ï¼Œæ‰€ä»¥ä¸€å®šè¦ä¸æ–­çš„å­¦ä¹ ï¼ŒæŒç»­çš„å­¦ä¹ ã€‚è¿˜è®°å¾—åˆšå…¥èŒçš„æ—¶å€™ï¼Œé‚£æ—¶å€™å°±ä¼šc/c++ï¼Œjavaã€‚ç°åœ¨çœ‹çœ‹è‡ªå·±çš„githubå’Œå†…ç½‘çš„æäº¤è®°å½•ï¼Œå‘ç°è¯­è¨€å±‚é¢åŸºæœ¬ä¸Šæ¶µç›–äº†ï¼šc/c++ï¼Œjavaï¼Œphpï¼Œpythonï¼Œgoï¼Œjavascriptï¼Œshellï¼Œobject-cï¼Œswiftï¼Œluaã€‚é¡¹ç›®ç±»å‹è¦†ç›–äº†æœåŠ¡ç«¯ï¼Œç­–ç•¥ç«¯ï¼ŒiOSï¼ŒAndroidï¼Œè‡ªåŠ¨åŒ–ç­‰ä¸åŒçš„æ–¹å‘ã€‚ä»åŸæ¥åªä¼šç”¨IISçš„å°ç™½ï¼Œåˆ°ä»Šå¤©äº†è§£Apacheï¼ŒLighttpdï¼ŒNginxç­‰å„ç§webæœåŠ¡å™¨ã€‚ä»åŸæ¥çš„æœåŠ¡ç«¯ï¼Œåˆ°æ…¢æ…¢äº†è§£å‰ç«¯ï¼Œäº†è§£ç­–ç•¥ç«¯ï¼Œäº†è§£å®¢æˆ·ç«¯ã€‚</p>
<p>å‚åŠ è¿‡å¥½å¤šä¼šï¼Œå’Œå¥½å¤šäººæ²Ÿé€šè¿‡ï¼Œå¤§å®¶éƒ½å¸Œæœ›ç»„ç»‡æä¾›å­¦ä¹ çš„æœºä¼šï¼Œæä¾›åˆ†äº«çš„æœºä¼šï¼Œå¸Œæœ›ç»„ç»‡èƒ½æä¾›è‡ªå·±æŠ€æœ¯æˆé•¿çš„æœºä¼šã€‚ä½†æ˜¯ï¼Œå®é™…ä¸Šï¼Œæˆé•¿æ˜¯è‡ªå·±çš„äº‹ï¼Œå­¦ä¹ æ˜¯ä¸ªäººçš„äº‹ï¼Œä¸ºä»€ä¹ˆè¦æ±‚ç»„ç»‡ç»™æä¾›è¿™äº›æœºä¼šå‘¢ï¼Ÿæˆ‘ç»„ç»‡è¿‡å¾ˆé•¿æ—¶é—´çš„åˆ†äº«ï¼Œæˆ‘ä¹Ÿæœ€åå¯¹ç»„ç»‡å¤§è§„æ¨¡çš„æŠ€æœ¯å­¦ä¹ å’Œåˆ†äº«ï¼Œå› ä¸ºè®©å¤ªå¤šçš„ä¼ªå­¦ä¹ è€…è¿›å…¥ä¹‹åï¼Œæ•ˆæœå¹¶ä¸ç†æƒ³ã€‚ç›¸åï¼Œè§„æ¨¡è¾ƒå°çš„æ²™é¾™å’Œè®¨è®ºå¯¹ä¸ªäººçš„æŠ€æœ¯æˆé•¿æ•ˆæœæ›´ä¸ºæ˜æ˜¾ã€‚ä¼ªå­¦ä¹ è€…åªæ˜¯æƒ³å­¦ä¹ è€Œå·²ï¼Œåªæ˜¯æƒ³è®©ç»„ç»‡æä¾›å­¦ä¹ æœºä¼šè€Œå·²ï¼Œä»…æ­¤è€Œå·²ã€‚</p>
<p>å­¦ä¹ æ˜¯è‡ªå·±çš„äº‹æƒ…ï¼Œç™½å¤©æ±‚ç”Ÿå­˜ï¼Œæ™šä¸Šæ±‚å‘å±•ã€‚å‡Œæ™¨2ç‚¹çš„æ—¶å€™ï¼Œä¹Ÿæ›¾åœ¨ç¯ä¸‹å•ƒè¿‡Nginxçš„æºç ï¼Œåˆ†æä¸€ä¸ªä¸ªçš„çº¿ä¸Šé—®é¢˜ï¼Œæ²¡æœ‰è¿™äº›ä¸ªå‡Œæ™¨2ç‚¹å°±ä¸ä¼šæœ‰ã€ŠNginxæ²‰æ€å½•ã€‹ï¼Œã€ŠNginxæ´—å†¤å½•ã€‹ç­‰ä¸€ç³»åˆ—çš„æ€»ç»“ã€‚</p>
<p><img src="/2020/02/05/thinking-about-QA-my-years-for-work-as-a-QA/4.jpg" alt></p>
<h2 id="åŸåˆ™6ï¼šåšç§¯æçš„æŠ±æ€¨è€…-ä¸åšæ¶ˆæçš„æŠ±æ€¨è€…">åŸåˆ™6ï¼šåšç§¯æçš„æŠ±æ€¨è€…ï¼Œä¸åšæ¶ˆæçš„æŠ±æ€¨è€…</h2>
<p>æ²¡æœ‰â€œæŠ±æ€¨â€å°±ä¸ä¼šæœ‰æŠ€æœ¯çš„è¿›æ­¥ï¼Œä½†æ˜¯åè¿‡æ¥è¯´æ²¡æœ‰â€œæŠ±æ€¨â€å°±ä¸ä¼šå­˜åœ¨é‚£ä¹ˆå¤šçš„å¤±è´¥ï¼Œä¸€æ— æ˜¯å¤„ï¼Œåº¸åº¸ç¢Œç¢Œã€‚å…³é”®æ˜¯è¦çœ‹å¾…æˆ‘ä»¬å¯¹å¾…â€œæŠ±æ€¨â€çš„æ€åº¦ã€‚å½“â€œæŠ±æ€¨â€è¿˜ä»…ä»…æ˜¯åœç•™åœ¨å˜´ä¸Šï¼Œåœç•™åœ¨æ€æƒ³ä¸Šï¼Œè¢«â€œæŠ±æ€¨â€æ‰€æ§åˆ¶æ—¶ï¼ŒåŸºæœ¬ä¸Šä¹Ÿå°±ç¦»ç¢Œç¢Œæ— ä¸ºä¸è¿œäº†ã€‚å½“æˆ‘ä»¬å¼€å§‹å’Œâ€œæŠ±æ€¨â€å¯¹æŠ—æ—¶ï¼Œåˆ©ç”¨ä¸€åˆ‡æŠ€æœ¯æ‰‹æ®µå’ŒåŠªåŠ›æ¶ˆç­â€œæŠ±æ€¨â€æ—¶ï¼ŒæŠ€æœ¯å°±å¼€å§‹è¿›æ­¥äº†ã€‚æ‰€ä»¥ï¼Œæˆ‘ä¸€èˆ¬ä¸åå¯¹æŠ±æ€¨ï¼Œå¹¶ä¸€ç›´é¼“åŠ±å¤§å®¶æŠ±æ€¨ï¼Œä½†æ˜¯æ¥ä¸‹æ¥æˆ‘ä¼šä»”ç»†åˆ†ææŠ±æ€¨çš„åŸå› æ˜¯ä»€ä¹ˆï¼ŸæŠ€æœ¯ä¸Šéœ€è¦ä»€ä¹ˆæ¢ç´¢æ‰èƒ½æ¶ˆç­è¿™äº›æŠ±æ€¨ï¼Ÿ</p>
<p>æ¯ä¸€ä¸ªâ€œæŠ±æ€¨â€éƒ½æ˜¯ä¸€æ¬¡æœºä¼šï¼Œéƒ½æ˜¯ä¸€ä¸ªæœºé‡ï¼Œéƒ½æ˜¯ä¸€æ¬¡æˆé•¿ã€‚é€¢å±±å¼€è·¯ï¼Œé‡æ°´æ­æ¡¥ï¼Œå‹‡å¾€ç›´å‰ã€‚</p>
<p><img src="/2020/02/05/thinking-about-QA-my-years-for-work-as-a-QA/5.jpg" alt></p>
<h2 id="åŸåˆ™7ï¼šæ­£ç¡®è®¤è¯†qaå’Œrdçš„å¼‚åŒ">åŸåˆ™7ï¼šæ­£ç¡®è®¤è¯†QAå’ŒRDçš„å¼‚åŒ</h2>
<p>å¤©åˆ†æ—¥å¤œé»‘ç™½ï¼Œå­£èŠ‚æœ‰æ˜¥å¤ç§‹å†¬ï¼Œè™½ç„¶å…¨æ ˆæ¨¡å¼æœ‰ä»–çš„ä¼˜ç‚¹ï¼Œä½†æ˜¯å››å­£ä¹Ÿæœ‰å››å­£çš„ç¾ã€‚æ–‡èƒ½æç¬”å®‰å¤©ä¸‹ï¼Œæ­¦èƒ½ä¸Šé©¬å®šä¹¾å¤ã€‚å…³é”®æ˜¯ï¼Œæˆ‘ä»¬éœ€è¦å¯¹QAå’ŒRDæœ‰æ­£ç¡®çš„è®¤è¯†ã€‚</p>
<p>æˆ‘ä»¬ä¸èƒ½æŒ‰ç…§ä¸€ä¸ªåŸåˆ™æ¥è¯„å®šäº‹æƒ…ã€‚æ¯”å¦‚ï¼šè€é©´æ‹‰ç£¨ï¼Œå§‹ç»ˆèµ°ä¸å‡ºé‚£ä¸ªåœˆåœˆã€‚å’Œæ—¥è¡Œåƒé‡Œçš„è‰¯é©¬ç›¸æ¯”ï¼Œå½“ç„¶è€é©´è¦ç¾æ„§äº†ã€‚ä½†æ˜¯å¦‚æœæ¢ä¸ªè§’åº¦ï¼Œæ‹‰ç£¨ä¸€å¤©ï¼Œäº§é¢åƒæ–¤ã€‚è‰¯é©¬å†èƒ½è·‘ï¼Œä¹Ÿè·‘ä¸å‡ºåƒæ–¤é¢ã€‚</p>
<p>QAå’ŒRDè™½ç„¶éƒ½æ˜¯ç ”å‘å²—ï¼Œéƒ½æ˜¯æŠ€æœ¯ä½“ç³»ï¼Œé‚£ä»–ä»¬çš„å·®å¼‚åœ¨å“ªå‘¢ï¼Ÿ</p>
<p>æˆ‘è§‰å¾—æœ‰ä»¥ä¸‹å‡ ç‚¹å§ï¼š</p>
<ul>
<li>ä»å·¥ä½œå…³ç³»ä¸Šè®²ï¼ŒQAæ˜¯RDçš„ä¸‹æ¸¸ï¼ŒRDæ˜¯QAçš„å®¢æˆ·ã€‚</li>
<li>ä»å·¥ä½œé‡ç‚¹ä¸Šè®²ï¼ŒQAæ³¨é‡åˆ†æï¼Œè€ŒRDæ³¨é‡å®è·µã€‚RDè¦åšçš„æ˜¯è§£å†³é—®é¢˜ï¼Œé‡‡ç”¨ä»»ä½•å¯èƒ½çš„æ–¹æ³•ï¼Œå¿«é€Ÿå®ç°éœ€æ±‚ï¼Œå¿«é€Ÿä¸Šçº¿ã€‚è€ŒQAæ²¡æœ‰å¤ªå¤§çš„ä¸šåŠ¡å‹åŠ›ï¼Œå¯ä»¥æœ‰æ›´å¤šçš„æ—¶é—´æ¥æ€è€ƒæ¯ä¸€ç§æŠ€æœ¯çš„ä¼˜åŠ¿å’ŒåŠ£åŠ¿ï¼Œæœ‰æ›´å¤šçš„æ—¶é—´æ¥ä»”ç»†åˆ†æå’Œè¿½æŸ¥æ¯ä¸€ä¸ªbugçš„æ·±å±‚åŸå› ï¼Œå¸®åŠ©RDåœ¨å¿«é€Ÿè§£å†³é—®é¢˜åå¯ä»¥å½»åº•è§£å†³é—®é¢˜ï¼Œé”¦ä¸Šæ·»èŠ±ã€‚</li>
<li>ä»æ¶µç›–ä¸šåŠ¡ä¸Šè®²ï¼ŒQAå…³æ³¨çš„ä¸šåŠ¡å¹¿åº¦è¾ƒé«˜ï¼Œè€ŒRDå…³æ³¨ä¸šåŠ¡çš„æ·±åº¦æ›´é«˜ã€‚</li>
</ul>
<p>å®é™…ä¸Šï¼ŒæŠ€æœ¯æ˜¯ä¸€ä¸ªå¾ˆå¹¿æ³›çš„æ¦‚å¿µï¼Œä¸èƒ½è®¤ä¸ºåªæœ‰å†™ä»£ç ï¼Œè®¾è®¡æ¶æ„æ‰æ˜¯æŠ€æœ¯ï¼Œæˆ‘ä»¬çš„æ€ç»´æœ¬èº«å°±æ˜¯ä¸€ç§æŠ€æœ¯ã€‚å…³é”®æ˜¯ï¼Œæˆ‘ä»¬çš„æŠ€æœ¯è¦ä¸ºä¸šåŠ¡çš„å‘å±•è€Œå­˜åœ¨ï¼Œè€Œä¸æ˜¯å­¤ç«‹çš„å­˜åœ¨ã€‚</p>
<p><img src="/2020/02/05/thinking-about-QA-my-years-for-work-as-a-QA/6.jpg" alt></p>
]]></content>
      <categories>
        <category>æ€»ç»“</category>
      </categories>
      <tags>
        <tag>æµ‹è¯•å·¥ä½œ</tag>
      </tags>
  </entry>
</search>
